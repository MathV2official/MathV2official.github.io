/*!
 * bowser@2.11.0 (MIT)
 *   author: Dustin Diaz <dustin@dustindiaz.com> (http://dustindiaz.com)
 *   url: git+https://github.com/lancedikson/bowser.git
 *   contributors:
 *     Denis Demchenko (http://twitter.com/lancedikson)
 *
 *   Copyright 2015, Dustin Diaz (the "Original Author")
 *   All rights reserved.
 *
 *   MIT License
 *
 *   Permission is hereby granted, free of charge, to any person
 *   obtaining a copy of this software and associated documentation
 *   files (the "Software"), to deal in the Software without
 *   restriction, including without limitation the rights to use,
 *   copy, modify, merge, publish, distribute, sublicense, and/or sell
 *   copies of the Software, and to permit persons to whom the
 *   Software is furnished to do so, subject to the following
 *   conditions:
 *
 *   The above copyright notice and this permission notice shall be
 *   included in all copies or substantial portions of the Software.
 *
 *   Distributions of all or part of the Software intended to be used
 *   by the recipients as they would use the unmodified Software,
 *   containing modifications that substantially alter, remove, or
 *   disable functionality of the Software, outside of the documented
 *   configuration mechanisms provided by the Software, shall be
 *   modified such that the Original Author's bug reporting email
 *   addresses and urls are either replaced with the contact information
 *   of the parties responsible for the changes, or removed entirely.
 *
 *   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 *   EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 *   OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 *   NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 *   HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 *   WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 *   FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 *   OTHER DEALINGS IN THE SOFTWARE.
 *
 *
 *   Except where noted, this license applies to any and all software
 *   programs and associated documentation files created by the
 *   Original Author, when distributed with the Software.
 *
 *
 *
 * core-js@3.22.5 (MIT)
 *   url: https://github.com/zloirock/core-js.git
 *
 *   Copyright (c) 2014-2022 Denis Pushkarev
 *
 *   Permission is hereby granted, free of charge, to any person obtaining a copy
 *   of this software and associated documentation files (the "Software"), to deal
 *   in the Software without restriction, including without limitation the rights
 *   to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 *   copies of the Software, and to permit persons to whom the Software is
 *   furnished to do so, subject to the following conditions:
 *
 *   The above copyright notice and this permission notice shall be included in
 *   all copies or substantial portions of the Software.
 *
 *   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *   IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *   FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *   AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *   LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *   OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 *   THE SOFTWARE.
 *
 *
 *
 * detect-node@2.1.0 (MIT)
 *   author: Ilya Kantor
 *   url: https://github.com/iliakan/detect-node
 *
 *   MIT License
 *
 *   Copyright (c) 2017 Ilya Kantor
 *
 *   Permission is hereby granted, free of charge, to any person obtaining a copy
 *   of this software and associated documentation files (the "Software"), to deal
 *   in the Software without restriction, including without limitation the rights
 *   to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 *   copies of the Software, and to permit persons to whom the Software is
 *   furnished to do so, subject to the following conditions:
 *
 *   The above copyright notice and this permission notice shall be included in all
 *   copies or substantial portions of the Software.
 *
 *   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *   IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *   FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *   AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *   LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *   OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 *   SOFTWARE.
 *
 *
 *
 * fast-copy@2.1.3 (MIT)
 *   author: tony_quetano@planttheidea.com
 *   url: git+https://github.com/planttheidea/fast-copy.git
 *   contributors:
 *     Dariusz Rzepka <rzepkadarek@gmail.com>
 *
 *   MIT License
 *
 *   Copyright (c) 2018 Tony Quetano
 *
 *   Permission is hereby granted, free of charge, to any person obtaining a copy
 *   of this software and associated documentation files (the "Software"), to deal
 *   in the Software without restriction, including without limitation the rights
 *   to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 *   copies of the Software, and to permit persons to whom the Software is
 *   furnished to do so, subject to the following conditions:
 *
 *   The above copyright notice and this permission notice shall be included in all
 *   copies or substantial portions of the Software.
 *
 *   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *   IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *   FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *   AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *   LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *   OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 *   SOFTWARE.
 *
 *
 *
 * is-electron@2.2.1 (MIT)
 *   author: Cheton Wu <cheton@gmail.com>
 *   url: git@github.com:cheton/is-electron.git
 *
 *   The MIT License (MIT)
 *
 *   Copyright (c) 2016-2018 Cheton Wu
 *
 *   Permission is hereby granted, free of charge, to any person obtaining a copy
 *   of this software and associated documentation files (the "Software"), to deal
 *   in the Software without restriction, including without limitation the rights
 *   to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 *   copies of the Software, and to permit persons to whom the Software is
 *   furnished to do so, subject to the following conditions:
 *
 *   The above copyright notice and this permission notice shall be included in all
 *   copies or substantial portions of the Software.
 *
 *   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *   IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *   FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *   AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *   LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *   OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 *   SOFTWARE.
 *
 *
 *
 * is-mobile@3.1.1 (MIT)
 *   author: Julian Gruber (http://juliangruber.com)
 *   url: git://github.com/juliangruber/is-mobile.git
 *
 *
 */
/*!
 * vrg@0.27.0
 * license:proprietary
 * (c) 2022 latel88 All rights reserved
*/(()=>{var e,t,n,i,r=[(e,t,n)=>{var i=function(e){return e&&e.Math==Math&&e};e.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},(e,t,n)=>{"use strict";var i=n(54),r=n(109),o=n(56),a=n(25),s=n(17).f,l=n(118),c=n(22),u=n(11),d="Array Iterator",h=a.set,f=a.getterFor(d);e.exports=l(Array,"Array",(function(e,t){h(this,{type:d,target:i(e),index:0,kind:t})}),(function(){var e=f(this),t=e.target,n=e.kind,i=e.index++;return!t||i>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:i,done:!1}:"values"==n?{value:t[i],done:!1}:{value:[i,t[i]],done:!1}}),"values");var g=o.Arguments=o.Array;if(r("keys"),r("values"),r("entries"),!c&&u&&"values"!==g.name)try{s(g,"name",{value:"values"})}catch(e){}},(e,t,n)=>{var i=n(0),r=n(123),o=n(124),a=n(1),s=n(19),l=n(7),c=l("iterator"),u=l("toStringTag"),d=a.values,h=function(e,t){if(e){if(e[c]!==d)try{s(e,c,d)}catch(t){e[c]=d}if(e[u]||s(e,u,t),r[t])for(var n in a)if(e[n]!==a[n])try{s(e,n,a[n])}catch(t){e[n]=a[n]}}};for(var f in r)h(i[f]&&i[f].prototype,f);h(o,"DOMTokenList")},(e,t,n)=>{var i=n(67),r=Function.prototype,o=r.bind,a=r.call,s=i&&o.bind(a,a);e.exports=i?function(e){return e&&s(e)}:function(e){return e&&function(){return a.apply(e,arguments)}}},e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},e=>{e.exports=function(e){return"function"==typeof e}},(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>s,c:()=>l,d:()=>M,e:()=>L,f:()=>O,g:()=>T,h:()=>R,i:()=>S,j:()=>y,k:()=>b,l:()=>g,m:()=>p,n:()=>d,o:()=>_,p:()=>v,q:()=>w,r:()=>A,s:()=>c});n(1),n(2);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const r=2*Math.PI,o=(Math.PI,Math.PI/2),a=Math.PI/4;class s{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;i(this,"x",void 0),i(this,"y",void 0),this.x=e,this.y=t}}class l{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;i(this,"x",void 0),i(this,"y",void 0),i(this,"z",void 0),this.x=e,this.y=t,this.z=n}}function c(e,t,n,i){return[e-n,t-i]}function u(e,t,n,i,r,o){return[e-i,t-r,n-o]}function d(e,t,n,i){return e*n+t*i}function h(e,t,n,i,r,o){return e*i+t*r+n*o}function f(e,t,n,i,r,o){return[t*o-r*n,n*i-o*e,e*r-i*t]}function g(e,t,n,i){const[r,o]=c(e,t,n,i);return Math.sqrt(d(r,o,r,o))}function p(e,t,n,i,r,o){const[a,s,l]=u(e,t,n,i,r,o);return Math.sqrt(h(a,s,l,a,s,l))}function m(e){return[Math.cos(w(e)),Math.sin(w(e))]}function v(e,t){const n=Math.sin(w(t)),i=Math.cos(w(t)),r=Math.sin(w(e)),o=Math.cos(w(e)),a=Math.abs(i);return[o*a,-n,r*a]}function _(e,t,n,i,r){let a=0,s=0,l=0;const[c,u]=m(e-o);if(a+=n*c,l+=n*u,t>0){const[n,r,c]=v(e,t-o);a+=i*n,s+=i*r,l+=i*c}else{const[n,r,c]=v(e,t+o);a-=i*n,s-=i*r,l-=i*c}const[d,h,f]=v(e,t);return a+=r*d,s+=r*h,l+=r*f,[a,s,l]}function y(e,t,n,i){const[r,o]=c(e,t,n,i);return Math.atan2(o,r)}function b(e,t,n,i,r,o){const[a,s,l]=u(e,t,n,i,r,o);return[Math.atan2(l,a),-Math.atan2(s,Math.sqrt(a*a+l*l))]}function w(e){return(e%=r)<0&&(e+=r),6123233995736766e-32===e?0:e}function E(e,t,n){let i=e*e+t*t+n*n;return i>0&&(i=1/Math.sqrt(i)),[e*i,t*i,n*i]}function x(e,t){let n=(e=w(e))-(t=w(t));return n-=Math.floor(n/r)*r,n-=n>Math.PI?r:0,n}function O(e,t,n,i){const[r,s]=function(e,t,n,i){const r=x(e,n);return[r,x(Math.abs(r)<3*a?t:o*(t/Math.abs(t))-t+o*(t/Math.abs(t)),i)]}(e,t,n,i);return[Math.abs(r),Math.abs(s)]}function T(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const a=Math.cos(e),s=Math.sin(e),l=Math.cos(t-o),c=Math.sin(t-o),u=i-.5,d=r-.5,h=n,f=h*l+d*c;return E(f*a-u*s,d*l-h*c,u*a+f*s)}function R(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const o=Math.cos(e),a=Math.sin(e),s=Math.cos(t),l=Math.sin(t),c=i-.5,u=r-.5,d=n,h=d*s+u*l;return E(h*o-c*a,u*s-d*l,c*o+h*a)}function S(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const[o,a,s]=T(e,t,n,i,r),[l,c,u]=R(e,t,n,i,r),[d,h,g]=f(l,c,u,o,a,s);return[d,h,g,o,a,s,l,c,u]}function A(e,t,n,i,r,o,a,s,l,c,u,d,f,p,m,v){let _=arguments.length>16&&void 0!==arguments[16]?arguments[16]:0,y=arguments.length>17&&void 0!==arguments[17]?arguments[17]:1;const b=i-e,w=r-t,E=o-n,x=h(b,w,E,s,l,c),O=h(b,w,E,u,d,f),T=h(b,w,E,p,m,v),R=2*y,S=x/T*R,A=O/T*R,L=a*g(0,0,1,1)/T*R,M=Math.sin(-_),P=Math.cos(-_);return[P*S-M*A,M*S+P*A,L]}function L(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=1/e*2,r=1/t*2;let o=0;for(let a=0,s=0|t;a<s;a=a+1|0)for(let t=0,s=0|e;t<s;t=t+1|0){let e=t*i+i/2,s=a*r+r/2;n[2*o]=e-1,n[2*o+1]=s-1,o++}return[n,i,r]}function M(e){return 90/e/(e/90*2)}},(e,t,n)=>{var i=n(0),r=n(86),o=n(12),a=n(89),s=n(110),l=n(111),c=r("wks"),u=i.Symbol,d=u&&u.for,h=l?u:u&&u.withoutSetter||a;e.exports=function(e){if(!o(c,e)||!s&&"string"!=typeof c[e]){var t="Symbol."+e;s&&o(u,e)?c[e]=u[e]:c[e]=l&&d?d(t):h(t)}return c[e]}},(e,t,n)=>{var i=n(67),r=Function.prototype.call;e.exports=i?r.bind(r):function(){return r.apply(r,arguments)}},(e,t,n)=>{var i=n(0),r=n(94).f,o=n(19),a=n(18),s=n(88),l=n(120),c=n(96);e.exports=function(e,t){var n,u,d,h,f,g=e.target,p=e.global,m=e.stat;if(n=p?i:m?i[g]||s(g,{}):(i[g]||{}).prototype)for(u in t){if(h=t[u],d=e.noTargetGet?(f=r(n,u))&&f.value:n[u],!c(p?u:g+(m?".":"#")+u,e.forced)&&void 0!==d){if(typeof h==typeof d)continue;l(h,d)}(e.sham||d&&d.sham)&&o(h,"sham",!0),a(n,u,h,e)}}},(e,t,n)=>{var i=n(0),r=n(15),o=i.String,a=i.TypeError;e.exports=function(e){if(r(e))return e;throw a(o(e)+" is not an object")}},(e,t,n)=>{var i=n(4);e.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},(e,t,n)=>{var i=n(3),r=n(23),o=i({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(r(e),t)}},(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>u,c:()=>c,d:()=>d});n(1),n(2),n(20),n(21),n(14);var i=n(82);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const o=new WeakMap;class a{constructor(e,t){r(this,"type",void 0),r(this,"timestamp",void 0),r(this,"target",void 0),this.type=t,this.timestamp=performance.now(),this.target=e}on(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=o.get(this.target)||null;null===n&&o.set(this.target,n=new Map),n.has(this.type)||n.set(this.type,new Array);const i=n.get(this.type)||null;null!==i&&(t?i.unshift(e):i.push(e))}off(e){const t=o.get(this.target)||null;if(null===t||!t.has(this.type))return;const n=t.get(this.type)||null;null!==n&&n.includes(e)&&n.splice(n.indexOf(e),1)}trigger(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=o.get(this.target)||null,n=this.target["on".concat(this.type)],r=n instanceof Function;if(null===t&&!r)return;for(const t in e)this[t]=e[t];r&&n.call(this.target,this);const a=null!==t&&t.get(this.type)||null;if(null!==a){const e=(0,i.a)(a);for(let t=0,n=0|e.length;t<n;t=t+1|0)e[t].call(this.target,this)}}async triggerAsync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=o.get(this.target)||null,n=this.target["on".concat(this.type)],r=n instanceof Function;if(null===t&&!r)return;for(const t in e)this[t]=e[t];if(r){const e=n.call(this.target,this);e instanceof Promise&&await e}const a=null!==t&&t.get(this.type)||null;if(null!==a){const e=(0,i.a)(a);for(let t=0,n=0|e.length;t<n;t=t+1|0){const n=e[t].call(this.target,this);n instanceof Promise&&await n}}}}const s=new WeakMap,l=new Array;function c(){for(;l.length>0;){const e=l.shift()||null;if(null===e)continue;const t=s.get(e)||new Array;for(;t.length>0;){const n=t.shift()||null;null!==n&&e.removeEventListener(n.type,n.handler)}s.delete(e)}}function u(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.addEventListener(t,n,i);let r=s.get(e)||null;null===r&&s.set(e,r=new Array),r.some((e=>e.type===t&&e.handler===n))||r.push({type:t,handler:n})}function d(e,t,n){e.removeEventListener(t,n);const i=s.get(e)||null;if(null===i)return;const r=i.filter((e=>e.type===t&&e.handler===n));for(;r.length>0;){const e=r.shift()||null;null!==e&&i.splice(i.indexOf(e),1)}i.length<=0&&(s.delete(e),l.splice(l.indexOf(e),1))}},(e,t,n)=>{n(216),n(217),n(218),n(219),n(220),n(221)},(e,t,n)=>{var i=n(5);e.exports=function(e){return"object"==typeof e?null!==e:i(e)}},(e,t,n)=>{var i=n(0),r=n(44),o=i.String;e.exports=function(e){if("Symbol"===r(e))throw TypeError("Cannot convert a Symbol value to a string");return o(e)}},(e,t,n)=>{var i=n(0),r=n(11),o=n(113),a=n(112),s=n(10),l=n(70),c=i.TypeError,u=Object.defineProperty,d=Object.getOwnPropertyDescriptor,h="enumerable",f="configurable",g="writable";t.f=r?a?function(e,t,n){if(s(e),t=l(t),s(n),"function"==typeof e&&"prototype"===t&&"value"in n&&g in n&&!n.writable){var i=d(e,t);i&&i.writable&&(e[t]=n.value,n={configurable:f in n?n.configurable:i.configurable,enumerable:h in n?n.enumerable:i.enumerable,writable:!1})}return u(e,t,n)}:u:function(e,t,n){if(s(e),t=l(t),s(n),o)try{return u(e,t,n)}catch(e){}if("get"in n||"set"in n)throw c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},(e,t,n)=>{var i=n(0),r=n(5),o=n(19),a=n(119),s=n(88);e.exports=function(e,t,n,l){var c=!!l&&!!l.unsafe,u=!!l&&!!l.enumerable,d=!!l&&!!l.noTargetGet,h=l&&void 0!==l.name?l.name:t;return r(n)&&a(n,h,l),e===i?(u?e[t]=n:s(t,n),e):(c?!d&&e[t]&&(u=!0):delete e[t],u?e[t]=n:o(e,t,n),e)}},(e,t,n)=>{var i=n(11),r=n(17),o=n(41);e.exports=i?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},(e,t,n)=>{"use strict";var i=n(9),r=n(116).includes,o=n(4),a=n(109);i({target:"Array",proto:!0,forced:o((function(){return!Array(1).includes()}))},{includes:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),a("includes")},(e,t,n)=>{"use strict";var i=n(9),r=n(3),o=n(179),a=n(29),s=n(16),l=n(180),c=r("".indexOf);i({target:"String",proto:!0,forced:!l("includes")},{includes:function(e){return!!~c(s(a(this)),s(o(e)),arguments.length>1?arguments[1]:void 0)}})},e=>{e.exports=!1},(e,t,n)=>{var i=n(0),r=n(29),o=i.Object;e.exports=function(e){return o(r(e))}},(e,t,n)=>{var i=n(0),r=n(5),o=n(55),a=i.TypeError;e.exports=function(e){if(r(e))return e;throw a(o(e)+" is not a function")}},(e,t,n)=>{var i,r,o,a=n(163),s=n(0),l=n(3),c=n(15),u=n(19),d=n(12),h=n(87),f=n(93),g=n(91),p="Object already initialized",m=s.TypeError,v=s.WeakMap;if(a||h.state){var _=h.state||(h.state=new v),y=l(_.get),b=l(_.has),w=l(_.set);i=function(e,t){if(b(_,e))throw new m(p);return t.facade=e,w(_,e,t),t},r=function(e){return y(_,e)||{}},o=function(e){return b(_,e)}}else{var E=f("state");g[E]=!0,i=function(e,t){if(d(e,E))throw new m(p);return t.facade=e,u(e,E,t),t},r=function(e){return d(e,E)?e[E]:{}},o=function(e){return d(e,E)}}e.exports={set:i,get:r,has:o,enforce:function(e){return o(e)?r(e):i(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=r(t)).type!==e)throw m("Incompatible receiver, "+e+" required");return n}}}},(e,t,n)=>{"use strict";var i=n(9),r=n(0),o=n(8),a=n(11),s=n(183),l=n(48),c=n(102),u=n(58),d=n(41),h=n(19),f=n(184),g=n(31),p=n(141),m=n(143),v=n(70),_=n(12),y=n(44),b=n(15),w=n(90),E=n(39),x=n(30),O=n(43),T=n(95).f,R=n(186),S=n(134).forEach,A=n(75),L=n(17),M=n(94),P=n(25),I=n(144),F=P.get,C=P.set,D=L.f,N=M.f,k=Math.round,B=r.RangeError,U=c.ArrayBuffer,z=U.prototype,G=c.DataView,X=l.NATIVE_ARRAY_BUFFER_VIEWS,H=l.TYPED_ARRAY_CONSTRUCTOR,V=l.TYPED_ARRAY_TAG,Y=l.TypedArray,j=l.TypedArrayPrototype,W=l.aTypedArrayConstructor,q=l.isTypedArray,Z="BYTES_PER_ELEMENT",K="Wrong length",J=function(e,t){W(e);for(var n=0,i=t.length,r=new e(i);i>n;)r[n]=t[n++];return r},Q=function(e,t){D(e,t,{get:function(){return F(this)[t]}})},$=function(e){var t;return x(z,e)||"ArrayBuffer"==(t=y(e))||"SharedArrayBuffer"==t},ee=function(e,t){return q(e)&&!w(t)&&t in e&&f(+t)&&t>=0},te=function(e,t){return t=v(t),ee(e,t)?d(2,e[t]):N(e,t)},ne=function(e,t,n){return t=v(t),!(ee(e,t)&&b(n)&&_(n,"value"))||_(n,"get")||_(n,"set")||n.configurable||_(n,"writable")&&!n.writable||_(n,"enumerable")&&!n.enumerable?D(e,t,n):(e[t]=n.value,e)};a?(X||(M.f=te,L.f=ne,Q(j,"buffer"),Q(j,"byteOffset"),Q(j,"byteLength"),Q(j,"length")),i({target:"Object",stat:!0,forced:!X},{getOwnPropertyDescriptor:te,defineProperty:ne}),e.exports=function(e,t,n){var a=e.match(/\d+$/)[0]/8,l=e+(n?"Clamped":"")+"Array",c="get"+e,d="set"+e,f=r[l],v=f,_=v&&v.prototype,y={},w=function(e,t){D(e,t,{get:function(){return function(e,t){var n=F(e);return n.view[c](t*a+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,i){var r=F(e);n&&(i=(i=k(i))<0?0:i>255?255:255&i),r.view[d](t*a+r.byteOffset,i,!0)}(this,t,e)},enumerable:!0})};X?s&&(v=t((function(e,t,n,i){return u(e,_),I(b(t)?$(t)?void 0!==i?new f(t,m(n,a),i):void 0!==n?new f(t,m(n,a)):new f(t):q(t)?J(v,t):o(R,v,t):new f(p(t)),e,v)})),O&&O(v,Y),S(T(f),(function(e){e in v||h(v,e,f[e])})),v.prototype=_):(v=t((function(e,t,n,i){u(e,_);var r,s,l,c=0,d=0;if(b(t)){if(!$(t))return q(t)?J(v,t):o(R,v,t);r=t,d=m(n,a);var h=t.byteLength;if(void 0===i){if(h%a)throw B(K);if((s=h-d)<0)throw B(K)}else if((s=g(i)*a)+d>h)throw B(K);l=s/a}else l=p(t),r=new U(s=l*a);for(C(e,{buffer:r,byteOffset:d,byteLength:s,length:l,view:new G(r)});c<l;)w(e,c++)})),O&&O(v,Y),_=v.prototype=E(j)),_.constructor!==v&&h(_,"constructor",v),h(_,H,v),V&&h(_,V,l);var x=v!=f;y[l]=v,i({global:!0,constructor:!0,forced:x,sham:!X},y),Z in v||h(v,Z,a),Z in _||h(_,Z,a),A(l)}):e.exports=function(){}},(e,t,n)=>{var i=n(0),r=n(5),o=function(e){return r(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?o(i[e]):i[e]&&i[e][t]}},(e,t,n)=>{var i=n(31);e.exports=function(e){return i(e.length)}},(e,t,n)=>{var i=n(0).TypeError;e.exports=function(e){if(null==e)throw i("Can't call method on "+e);return e}},(e,t,n)=>{var i=n(3);e.exports=i({}.isPrototypeOf)},(e,t,n)=>{var i=n(37),r=Math.min;e.exports=function(e){return e>0?r(i(e),9007199254740991):0}},(e,t,n)=>{var i=n(3),r=n(24),o=n(67),a=i(i.bind);e.exports=function(e,t){return r(e),void 0===t?e:o?a(e,t):function(){return e.apply(t,arguments)}}},(e,t,n)=>{var i=n(0),r=n(123),o=n(124),a=n(175),s=n(19),l=function(e){if(e&&e.forEach!==a)try{s(e,"forEach",a)}catch(t){e.forEach=a}};for(var c in r)r[c]&&l(i[c]&&i[c].prototype);l(o)},(e,t,n)=>{"use strict";var i=n(9),r=n(83);i({target:"RegExp",proto:!0,forced:/./.exec!==r},{exec:r})},(e,t,n)=>{"use strict";n.d(t,{a:()=>v,b:()=>_,c:()=>m});n(1),n(2),n(47),n(107),n(49),n(50),n(51);var i=function(e){return function(t,n,i){return e(t,n,i)*i}},r=function(e,t){if(e)throw Error("Invalid sort config: "+t)},o=function(e){var t=e||{},n=t.asc,o=t.desc,a=n?1:-1,s=n||o;return r(!s,"Expected `asc` or `desc` property"),r(n&&o,"Ambiguous object with `asc` and `desc` config properties"),{order:a,sortBy:s,comparer:e.comparer&&i(e.comparer)}};function a(e,t,n){if(void 0===e||!0===e)return function(e,i){return t(e,i,n)};if("string"==typeof e)return r(e.includes("."),"String syntax not allowed for nested properties."),function(i,r){return t(i[e],r[e],n)};if("function"==typeof e)return function(i,r){return t(e(i),e(r),n)};if(Array.isArray(e)){var i=function(e){return function t(n,i,r,a,s,l,c){var u,d;if("string"==typeof n)u=l[n],d=c[n];else{if("function"!=typeof n){var h=o(n);return t(h.sortBy,i,r,h.order,h.comparer||e,l,c)}u=n(l),d=n(c)}var f=s(u,d,a);return(0===f||null==u&&null==d)&&i.length>r?t(i[r],i,r+1,a,s,l,c):f}}(t);return function(r,o){return i(e[0],e,1,n,t,r,o)}}var s=o(e);return a(s.sortBy,s.comparer||t,s.order)}var s=function(e,t,n,i){return Array.isArray(t)?(Array.isArray(n)&&n.length<2&&(n=n[0]),t.sort(a(n,i,e))):t};function l(e){var t=i(e.comparer);return function(n){var i=Array.isArray(n)&&!e.inPlaceSorting?n.slice():n;return{asc:function(e){return s(1,i,e,t)},desc:function(e){return s(-1,i,e,t)},by:function(e){return s(1,i,e,t)}}}}var c=function(e,t,n){return null==e?n:null==t?-n:e<t?-1:e>t?1:0},u=(l({comparer:c}),l({comparer:c,inPlaceSorting:!0})),d=n(152);const h=self.navigator.userAgent.length>0?(0,d.getParser)(self.navigator.userAgent):null,f=(h&&h.isBrowser("chrome"),h&&h.getOS().name,h&&h.isBrowser("firefox"));h&&h.isBrowser("safari");function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class p{constructor(e){g(this,"sorter",null),this.sorter=u(e)}asc(e){this.sorter.asc(e)}desc(e){this.sorter.desc(e)}}function m(e){return new p(e)}function v(e){if(!(e.length<=0))if(f)for(;e.length>0;)e.pop();else e.length=0}function _(e){for(let t=e.length-1|0,n=0;t>n;t--){const n=Math.floor(Math.random()*(t+1)),i=e[t];e[t]=e[n],e[n]=i}}new Uint8Array(512)},(e,t,n)=>{var i=n(27);e.exports=i("navigator","userAgent")||""},e=>{var t=Math.ceil,n=Math.floor;e.exports=function(e){var i=+e;return i!=i||0===i?0:(i>0?n:t)(i)}},(e,t,n)=>{var i=n(3),r=i({}.toString),o=i("".slice);e.exports=function(e){return o(r(e),8,-1)}},(e,t,n)=>{var i,r=n(10),o=n(215),a=n(92),s=n(91),l=n(117),c=n(69),u=n(93),d=u("IE_PROTO"),h=function(){},f=function(e){return"<script>"+e+"</"+"script>"},g=function(e){e.write(f("")),e.close();var t=e.parentWindow.Object;return e=null,t},p=function(){try{i=new ActiveXObject("htmlfile")}catch(e){}var e,t;p="undefined"!=typeof document?document.domain&&i?g(i):((t=c("iframe")).style.display="none",l.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(f("document.F=Object")),e.close(),e.F):g(i);for(var n=a.length;n--;)delete p.prototype[a[n]];return p()};s[d]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(h.prototype=r(e),n=new h,h.prototype=null,n[d]=e):n=p(),void 0===t?n:o.f(n,t)}},(e,t,n)=>{var i=n(24);e.exports=function(e,t){var n=e[t];return null==n?void 0:i(n)}},e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},(e,t,n)=>{var i=n(17).f,r=n(12),o=n(7)("toStringTag");e.exports=function(e,t,n){e&&!n&&(e=e.prototype),e&&!r(e,o)&&i(e,o,{configurable:!0,value:t})}},(e,t,n)=>{var i=n(3),r=n(10),o=n(168);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=i(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,i){return r(n),o(i),t?e(n,i):n.__proto__=i,n}}():void 0)},(e,t,n)=>{var i=n(0),r=n(169),o=n(5),a=n(38),s=n(7)("toStringTag"),l=i.Object,c="Arguments"==a(function(){return arguments}());e.exports=r?a:function(e){var t,n,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=l(e),s))?n:c?a(t):"Object"==(i=a(t))&&o(t.callee)?"Arguments":i}},(e,t,n)=>{var i=n(0);e.exports=i.Promise},(e,t,n)=>{"use strict";n.a(e,(async(e,i)=>{try{n.d(t,{a:()=>d,b:()=>s});n(34),n(1),n(2),n(14),n(47),n(61),n(49),n(50),n(51);var r=n(224),o=n(158),a=(n(234),e([o]));o=(a.then?(await a)():a)[0];const s="OffscreenCanvas"in self,l=(d(0,0).getContext("2d"),d(0,0).getContext("webgl"),d(0,0).getContext("webgl2"),new r.a(Worker,(function(){postMessage("OffscreenCanvas"in self&&null!==new OffscreenCanvas(1,1).getContext("2d"))}))),c=new r.a(Worker,(function(){postMessage("OffscreenCanvas"in self&&null!==new OffscreenCanvas(1,1).getContext("webgl"))})),u=new r.a(Worker,(function(){postMessage("OffscreenCanvas"in self&&null!==new OffscreenCanvas(1,1).getContext("webgl2"))}));await l.exec(),await c.exec(),await u.exec();l.terminate(),c.terminate(),u.terminate();new WeakMap,new WeakMap;function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"OffscreenCanvas"in self?new OffscreenCanvas(e,t):(()=>{const n=document.createElement("canvas");return n.width=0|e,n.height=0|t,n})()}i()}catch(h){i(h)}}),1)},(e,t,n)=>{"use strict";var i=n(9),r=n(3),o=n(4),a=n(102),s=n(10),l=n(71),c=n(31),u=n(76),d=a.ArrayBuffer,h=a.DataView,f=h.prototype,g=r(d.prototype.slice),p=r(f.getUint8),m=r(f.setUint8);i({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:o((function(){return!new d(2).slice(1,void 0).byteLength}))},{slice:function(e,t){if(g&&void 0===t)return g(s(this),e);for(var n=s(this).byteLength,i=l(e,n),r=l(void 0===t?n:t,n),o=new(u(this,d))(c(r-i)),a=new h(this),f=new h(o),v=0;i<r;)m(f,v++,p(a,i++));return o}})},(e,t,n)=>{"use strict";var i,r,o,a=n(139),s=n(11),l=n(0),c=n(5),u=n(15),d=n(12),h=n(44),f=n(55),g=n(19),p=n(18),m=n(17).f,v=n(30),_=n(74),y=n(43),b=n(7),w=n(89),E=l.Int8Array,x=E&&E.prototype,O=l.Uint8ClampedArray,T=O&&O.prototype,R=E&&_(E),S=x&&_(x),A=Object.prototype,L=l.TypeError,M=b("toStringTag"),P=w("TYPED_ARRAY_TAG"),I=w("TYPED_ARRAY_CONSTRUCTOR"),F=a&&!!y&&"Opera"!==h(l.opera),C=!1,D={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},N={BigInt64Array:8,BigUint64Array:8},k=function(e){if(!u(e))return!1;var t=h(e);return d(D,t)||d(N,t)};for(i in D)(o=(r=l[i])&&r.prototype)?g(o,I,r):F=!1;for(i in N)(o=(r=l[i])&&r.prototype)&&g(o,I,r);if((!F||!c(R)||R===Function.prototype)&&(R=function(){throw L("Incorrect invocation")},F))for(i in D)l[i]&&y(l[i],R);if((!F||!S||S===A)&&(S=R.prototype,F))for(i in D)l[i]&&y(l[i].prototype,S);if(F&&_(T)!==S&&y(T,S),s&&!d(S,M))for(i in C=!0,m(S,M,{get:function(){return u(this)?this[P]:void 0}}),D)l[i]&&g(l[i],P,i);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:F,TYPED_ARRAY_CONSTRUCTOR:I,TYPED_ARRAY_TAG:C&&P,aTypedArray:function(e){if(k(e))return e;throw L("Target is not a typed array")},aTypedArrayConstructor:function(e){if(c(e)&&(!y||v(R,e)))return e;throw L(f(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n,i){if(s){if(n)for(var r in D){var o=l[r];if(o&&d(o.prototype,e))try{delete o.prototype[e]}catch(n){try{o.prototype[e]=t}catch(e){}}}S[e]&&!n||p(S,e,n?t:F&&x[e]||t,i)}},exportTypedArrayStaticMethod:function(e,t,n){var i,r;if(s){if(y){if(n)for(i in D)if((r=l[i])&&d(r,e))try{delete r[e]}catch(e){}if(R[e]&&!n)return;try{return p(R,e,n?t:F&&R[e]||t)}catch(e){}}for(i in D)!(r=l[i])||r[e]&&!n||p(r,e,t)}},isView:function(e){if(!u(e))return!1;var t=h(e);return"DataView"===t||d(D,t)||d(N,t)},isTypedArray:k,TypedArray:R,TypedArrayPrototype:S}},(e,t,n)=>{"use strict";var i=n(0),r=n(8),o=n(48),a=n(28),s=n(143),l=n(23),c=n(4),u=i.RangeError,d=i.Int8Array,h=d&&d.prototype,f=h&&h.set,g=o.aTypedArray,p=o.exportTypedArrayMethod,m=!c((function(){var e=new Uint8ClampedArray(2);return r(f,e,{length:1,0:3},1),3!==e[1]})),v=m&&o.NATIVE_ARRAY_BUFFER_VIEWS&&c((function(){var e=new d(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));p("set",(function(e){g(this);var t=s(arguments.length>1?arguments[1]:void 0,1),n=l(e);if(m)return r(f,this,n,t);var i=this.length,o=a(n),c=0;if(o+t>i)throw u("Wrong length");for(;c<o;)this[t+c]=n[c++]}),!m||v)},(e,t,n)=>{"use strict";var i=n(0),r=n(3),o=n(4),a=n(24),s=n(145),l=n(48),c=n(187),u=n(188),d=n(68),h=n(189),f=l.aTypedArray,g=l.exportTypedArrayMethod,p=i.Uint16Array,m=p&&r(p.prototype.sort),v=!(!m||o((function(){m(new p(2),null)}))&&o((function(){m(new p(2),{})}))),_=!!m&&!o((function(){if(d)return d<74;if(c)return c<67;if(u)return!0;if(h)return h<602;var e,t,n=new p(516),i=Array(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,i[e]=e-2*t+3;for(m(n,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==i[e])return!0}));g("sort",(function(e){return void 0!==e&&a(e),_?m(this,e):s(f(this),function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!=n?-1:t!=t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}}(e))}),!_||v)},(e,t,n)=>{"use strict";var i=n(0),r=n(78),o=n(48),a=n(4),s=n(126),l=i.Int8Array,c=o.aTypedArray,u=o.exportTypedArrayMethod,d=[].toLocaleString,h=!!l&&a((function(){d.call(new l(1))}));u("toLocaleString",(function(){return r(d,h?s(c(this)):c(this),s(arguments))}),a((function(){return[1,2].toLocaleString()!=new l([1,2]).toLocaleString()}))||!a((function(){l.prototype.toLocaleString.call([1,2])})))},(e,t,n)=>{"use strict";n.d(t,{a:()=>ee,b:()=>ne,c:()=>re,d:()=>$,e:()=>te,f:()=>ie});n(228),n(20),n(21),n(229),n(1),n(2),n(33),n(14),n(34),n(157);Promise.resolve(!1);var i=Promise.resolve(!0),r=Promise.resolve();function o(e,t){return e||(e=0),new Promise((function(n){return setTimeout((function(){return n(t)}),e)}))}function a(){return Math.random().toString(36).substring(2)}var s=0,l=0;function c(){var e=(new Date).getTime();return e===s?1e3*e+ ++l:(s=e,l=0,1e3*e)}var u="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0);const d={create:function(e){var t={messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(e){t.messagesCallback&&t.messagesCallback(e.data)},t},close:function(e){e.bc.close(),e.subFns=[]},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){try{return e.bc.postMessage(t,!1),r}catch(e){return Promise.reject(e)}},canBeUsed:function(){if(u&&"undefined"==typeof window)return!1;if("function"==typeof BroadcastChannel){if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0}return!1},type:"native",averageResponseTime:function(){return 150},microSeconds:c};var h=function(){function e(e){this.ttl=e,this.map=new Map,this._to=!1}return e.prototype.has=function(e){return this.map.has(e)},e.prototype.add=function(e){var t=this;this.map.set(e,f()),this._to||(this._to=!0,setTimeout((function(){t._to=!1,function(e){var t=f()-e.ttl,n=e.map[Symbol.iterator]();for(;;){var i=n.next().value;if(!i)return;var r=i[0];if(!(i[1]<t))return;e.map.delete(r)}}(t)}),0))},e.prototype.clear=function(){this.map.clear()},e}();function f(){return(new Date).getTime()}function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return void 0===t.webWorkerSupport&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=45e3),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&"function"==typeof e.idb.onclose&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=6e4),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=12e4),t.node.maxParallelWrites||(t.node.maxParallelWrites=2048),void 0===t.node.useFastPath&&(t.node.useFastPath=!0),t}var p="messages",m={durability:"relaxed"};function v(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof window){if(void 0!==window.mozIndexedDB)return window.mozIndexedDB;if(void 0!==window.webkitIndexedDB)return window.webkitIndexedDB;if(void 0!==window.msIndexedDB)return window.msIndexedDB}return!1}function _(e){e.commit&&e.commit()}function y(e,t){var n=e.transaction(p,"readonly",m),i=n.objectStore(p),r=[],o=IDBKeyRange.bound(t+1,1/0);if(i.getAll){var a=i.getAll(o);return new Promise((function(e,t){a.onerror=function(e){return t(e)},a.onsuccess=function(t){e(t.target.result)}}))}return new Promise((function(e,a){var s=function(){try{return o=IDBKeyRange.bound(t+1,1/0),i.openCursor(o)}catch(e){return i.openCursor()}}();s.onerror=function(e){return a(e)},s.onsuccess=function(i){var o=i.target.result;o?o.value.id<t+1?o.continue(t+1):(r.push(o.value),o.continue()):(_(n),e(r))}}))}function b(e,t){return function(e,t){var n=(new Date).getTime()-t,i=e.transaction(p,"readonly",m),r=i.objectStore(p),o=[];return new Promise((function(e){r.openCursor().onsuccess=function(t){var r=t.target.result;if(r){var a=r.value;if(!(a.time<n))return _(i),void e(o);o.push(a),r.continue()}else e(o)}}))}(e,t).then((function(t){return function(e,t){var n=e.transaction([p],"readwrite",m).objectStore(p);return Promise.all(t.map((function(e){var t=n.delete(e);return new Promise((function(e){t.onsuccess=function(){return e()}}))})))}(e,t.map((function(e){return e.id})))}))}function w(e){e.closed||E(e).then((function(){return o(e.options.idb.fallbackInterval)})).then((function(){return w(e)}))}function E(e){return e.closed?r:e.messagesCallback?y(e.db,e.lastCursorId).then((function(t){var n=t.filter((function(e){return!!e})).map((function(t){return t.id>e.lastCursorId&&(e.lastCursorId=t.id),t})).filter((function(t){return function(e,t){return!(e.uuid===t.uuid||t.eMIs.has(e.id)||e.data.time<t.messagesCallbackTime)}(t,e)})).sort((function(e,t){return e.time-t.time}));return n.forEach((function(t){e.messagesCallback&&(e.eMIs.add(t.id),e.messagesCallback(t.data))})),r})):r}const x={create:function(e,t){return t=g(t),function(e){var t="pubkey.broadcast-channel-0-"+e,n=v().open(t);return n.onupgradeneeded=function(e){e.target.result.createObjectStore(p,{keyPath:"id",autoIncrement:!0})},new Promise((function(e,t){n.onerror=function(e){return t(e)},n.onsuccess=function(){e(n.result)}}))}(e).then((function(n){var i={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:a(),eMIs:new h(2*t.idb.ttl),writeBlockPromise:r,messagesCallback:null,readQueuePromises:[],db:n};return n.onclose=function(){i.closed=!0,t.idb.onclose&&t.idb.onclose()},w(i),i}))},close:function(e){e.closed=!0,e.db.close()},onMessage:function(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t,E(e)},postMessage:function(e,t){return e.writeBlockPromise=e.writeBlockPromise.then((function(){return function(e,t,n){var i={uuid:t,time:(new Date).getTime(),data:n},r=e.transaction([p],"readwrite",m);return new Promise((function(e,t){r.oncomplete=function(){return e()},r.onerror=function(e){return t(e)},r.objectStore(p).add(i),_(r)}))}(e.db,e.uuid,t)})).then((function(){var t,n;0===(t=0,n=10,Math.floor(Math.random()*(n-t+1)+t))&&b(e.db,e.options.idb.ttl)})),e.writeBlockPromise},canBeUsed:function(){return!u&&!!v()},type:"idb",averageResponseTime:function(e){return 2*e.idb.fallbackInterval},microSeconds:c};function O(){var e;if("undefined"==typeof window)return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch(e){}return e}function T(e){return"pubkey.broadcastChannel-"+e}function R(){if(u)return!1;var e=O();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch(e){return!1}return!0}const S={create:function(e,t){if(t=g(t),!R())throw new Error("BroadcastChannel: localstorage cannot be used");var n=a(),i=new h(t.localstorage.removeTimeout),r={channelName:e,uuid:n,eMIs:i};return r.listener=function(e,t){var n=T(e),i=function(e){e.key===n&&t(JSON.parse(e.newValue))};return window.addEventListener("storage",i),i}(e,(function(e){r.messagesCallback&&e.uuid!==n&&e.token&&!i.has(e.token)&&(e.data.time&&e.data.time<r.messagesCallbackTime||(i.add(e.token),r.messagesCallback(e.data)))})),r},close:function(e){var t;t=e.listener,window.removeEventListener("storage",t)},onMessage:function(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(n){o().then((function(){var i=T(e.channelName),r={token:a(),time:(new Date).getTime(),data:t,uuid:e.uuid},o=JSON.stringify(r);O().setItem(i,o);var s=document.createEvent("Event");s.initEvent("storage",!0,!0),s.key=i,s.newValue=o,window.dispatchEvent(s),n()}))}))},canBeUsed:R,type:"localstorage",averageResponseTime:function(){var e=navigator.userAgent.toLowerCase();return e.includes("safari")&&!e.includes("chrome")?240:120},microSeconds:c};var A=c,L=new Set;const M={create:function(e){var t={name:e,messagesCallback:null};return L.add(t),t},close:function(e){L.delete(e)},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(n){return setTimeout((function(){Array.from(L).filter((function(t){return t.name===e.name})).filter((function(t){return t!==e})).filter((function(e){return!!e.messagesCallback})).forEach((function(e){return e.messagesCallback(t)})),n()}),5)}))},canBeUsed:function(){return!0},type:"simulate",averageResponseTime:function(){return 5},microSeconds:A};var P=[d,x,S];var I,F=new Set,C=0,D=function(e,t){var n,i,r;this.id=C++,F.add(this),this.name=e,I&&(t=I),this.options=g(t),this.method=function(e){var t=[].concat(e.methods,P).filter(Boolean);if(e.type){if("simulate"===e.type)return M;var n=t.find((function(t){return t.type===e.type}));if(n)return n;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||u||(t=t.filter((function(e){return"idb"!==e.type})));var i=t.find((function(e){return e.canBeUsed()}));if(i)return i;throw new Error("No useable method found in "+JSON.stringify(P.map((function(e){return e.type}))))}(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,i=(n=this).method.create(n.name,n.options),(r=i)&&"function"==typeof r.then?(n._prepP=i,i.then((function(e){n._state=e}))):n._state=i};function N(e,t,n){var i={time:e.method.microSeconds(),type:t,data:n};return(e._prepP?e._prepP:r).then((function(){var t=e.method.postMessage(e._state,i);return e._uMP.add(t),t.catch().then((function(){return e._uMP.delete(t)})),t}))}function k(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function B(e,t,n){e._addEL[t].push(n),function(e){if(!e._iL&&k(e)){var t=function(t){e._addEL[t.type].forEach((function(e){var n=1e5,i=e.time-n;t.time>=i&&e.fn(t.data)}))},n=e.method.microSeconds();e._prepP?e._prepP.then((function(){e._iL=!0,e.method.onMessage(e._state,t,n)})):(e._iL=!0,e.method.onMessage(e._state,t,n))}}(e)}function U(e,t,n){e._addEL[t]=e._addEL[t].filter((function(e){return e!==n})),function(e){if(e._iL&&!k(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}(e)}D._pubkey=!0,D.prototype={postMessage:function(e){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed "+JSON.stringify(e));return N(this,"message",e)},postInternal:function(e){return N(this,"internal",e)},set onmessage(e){var t={time:this.method.microSeconds(),fn:e};U(this,"message",this._onML),e&&"function"==typeof e?(this._onML=t,B(this,"message",t)):this._onML=null},addEventListener:function(e,t){B(this,e,{time:this.method.microSeconds(),fn:t})},removeEventListener:function(e,t){U(this,e,this._addEL[e].find((function(e){return e.fn===t})))},close:function(){var e=this;if(!this.closed){F.delete(this),this.closed=!0;var t=this._prepP?this._prepP:r;return this._onML=null,this._addEL.message=[],t.then((function(){return Promise.all(Array.from(e._uMP))})).then((function(){return Promise.all(e._befC.map((function(e){return e()})))})).then((function(){return e.method.close(e._state)}))}},get type(){return this.method.type},get isClosed(){return this.closed}};var z=n(200),G=n.n(z);const X={add:function(e){if("function"==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope);else{if("function"!=typeof window.addEventListener)return;window.addEventListener("beforeunload",(function(){e()}),!0),window.addEventListener("unload",(function(){e()}),!0)}}};var H=n(232),V=n.n(H),Y=G()?V():X,j=new Set,W=!1;function q(e){if(W||(W=!0,Y.add(Z)),"function"!=typeof e)throw new Error("Listener is no function");return j.add(e),{remove:function(){return j.delete(e)},run:function(){return j.delete(e),e()}}}function Z(){var e=[];return j.forEach((function(t){e.push(t()),j.delete(t)})),Promise.all(e)}var K=function(e,t){var n=this;this.broadcastChannel=e,this._options=t,this.isLeader=!1,this.hasLeader=!1,this.isDead=!1,this.token=a(),this._aplQ=r,this._aplQC=0,this._unl=[],this._lstns=[],this._dpL=function(){},this._dpLC=!1;var i=function(e){"leader"===e.context&&("death"===e.action&&(n.hasLeader=!1),"tell"===e.action&&(n.hasLeader=!0))};this.broadcastChannel.addEventListener("internal",i),this._lstns.push(i)};function J(e,t){var n={context:"leader",action:t,token:e.token};return e.broadcastChannel.postInternal(n)}K.prototype={applyOnce:function(e){var t=this;if(this.isLeader)return o(0,!0);if(this.isDead)return o(0,!1);if(this._aplQC>1)return this._aplQ;var n=function(){if(t.isLeader)return i;var n,r=!1,a=new Promise((function(e){n=function(){r=!0,e()}})),s=[],l=function(e){"leader"===e.context&&e.token!=t.token&&(s.push(e),"apply"===e.action&&e.token>t.token&&n(),"tell"===e.action&&(n(),t.hasLeader=!0))};t.broadcastChannel.addEventListener("internal",l);var c=e?4*t._options.responseTime:t._options.responseTime;return J(t,"apply").then((function(){return Promise.race([o(c),a.then((function(){return Promise.reject(new Error)}))])})).then((function(){return J(t,"apply")})).then((function(){return Promise.race([o(c),a.then((function(){return Promise.reject(new Error)}))])})).catch((function(){})).then((function(){return t.broadcastChannel.removeEventListener("internal",l),!r&&function(e){e.isLeader=!0,e.hasLeader=!0;var t=q((function(){return e.die()}));e._unl.push(t);var n=function(t){"leader"===t.context&&"apply"===t.action&&J(e,"tell"),"leader"!==t.context||"tell"!==t.action||e._dpLC||(e._dpLC=!0,e._dpL(),J(e,"tell"))};return e.broadcastChannel.addEventListener("internal",n),e._lstns.push(n),J(e,"tell")}(t).then((function(){return!0}))}))};return this._aplQC=this._aplQC+1,this._aplQ=this._aplQ.then((function(){return n()})).then((function(){t._aplQC=t._aplQC-1})),this._aplQ.then((function(){return t.isLeader}))},awaitLeadership:function(){return this._aLP||(this._aLP=function(e){if(e.isLeader)return r;return new Promise((function(t){var n=!1;function i(){n||(n=!0,e.broadcastChannel.removeEventListener("internal",r),t(!0))}e.applyOnce().then((function(){e.isLeader&&i()})),function t(){return o(e._options.fallbackInterval).then((function(){if(!e.isDead&&!n)return e.isLeader?void i():e.applyOnce(!0).then((function(){e.isLeader?i():t()}))}))}();var r=function(t){"leader"===t.context&&"death"===t.action&&(e.hasLeader=!1,e.applyOnce().then((function(){e.isLeader&&i()})))};e.broadcastChannel.addEventListener("internal",r),e._lstns.push(r)}))}(this)),this._aLP},set onduplicate(e){this._dpL=e},die:function(){var e=this;return this._lstns.forEach((function(t){return e.broadcastChannel.removeEventListener("internal",t)})),this._lstns=[],this._unl.forEach((function(e){return e.remove()})),this._unl=[],this.isLeader&&(this.hasLeader=!1,this.isLeader=!1),this.isDead=!0,J(this,"death")}};n(13);new Array,new Array;new Array,new Array;let Q=null;function $(){if(null===Q)try{Q=scope}catch(e){Q=self}return Q}const ee="BroadcastChannel"in self?self.BroadcastChannel:class extends D{addEventListener(e,t){super.addEventListener(e,(n=>{t(new MessageEvent(e,{data:n}))}))}};function te(e){return"requestAnimationFrame"in self?self.requestAnimationFrame(e):setTimeout(e,0)}function ne(e){"cancelAnimationFrame"in self?self.cancelAnimationFrame(e):clearTimeout(e)}function ie(e){return setTimeout(e,0)}function re(e){clearTimeout(e)}},(e,t,n)=>{"use strict";n.d(t,{a:()=>u,b:()=>d,c:()=>h,d:()=>l,e:()=>v,f:()=>m,g:()=>c,h:()=>a,i:()=>s,j:()=>p,k:()=>g});n(1),n(2);var i=n(159),r=n(85),o=n(6);const a=[[1,0,0],[0,0,1],[-1,0,0],[0,0,-1],[1,0,1],[-1,0,-1],[1,0,-1],[-1,0,1]],s=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1],[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[0,1,1],[0,-1,1],[0,1,-1],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[1,-1,-1],[-1,1,1],[1,-1,1],[1,1,-1],[-1,-1,1],[1,-1,-1],[-1,1,-1],[-1,-1,-1],[1,1,1]];function l(e,t,n,i){const[r,o,a]=e.getSize();return t<=0||t>=r-1||n<=0||n>=o-1||i<=0||i>=a-1}function c(e,t,n,i,r,o,a,s){return((0|r)*a*o+(0|i)*o+(0|n))*e+t}function u(e,t){const n=t/2,i=Math.ceil(e-n),r=Math.ceil(e+n);if(!(i^r-1))return[i];const o=new Array;for(let t=0|i,a=0|r;t<a;t=t+1|0){const i=t+.5,r=Math.abs(i-e);Math.sqrt(r*r)>n||o.push(t)}return o}function d(e,t,n){const i=n/2,r=Math.floor(e-i),o=Math.floor(t-i),a=Math.ceil(e+i),s=Math.ceil(t+i);if(!(r^a-1|o^s-1))return[r,o];const l=new Array;for(let e=0|r,t=0|a;e<t;e=e+1|0)for(let t=0|o,n=0|s;t<n;t=t+1|0)l.push(e,t);return l}function h(e,t,n,r,o){const a=r/2,s=o,l=Math.floor(e-a),c=Math.floor(t),u=Math.floor(n-a),d=Math.ceil(e+a),h=Math.ceil(t+s),f=Math.ceil(n+a);if(!(l^d-1|c^h-1|u^f-1))return[l,c,u];const g=new Array;for(let a=0|l,s=0|d;a<s;a=a+1|0)for(let s=0|u,l=0|f;s<l;s=s+1|0)for(let l=0|c,u=0|h;l<u;l=l+1|0)(0,i.d)(a,l,s,e,t,n,r,o)&&g.push(a,l,s);return g}function f(e,t,n,i){switch(e){case 0:return t>0?0:1;case 1:return n<0?2:3;case 2:return i>0?4:5}return-1}function g(e,t,n,i,r,a,s,l,c){return function(e,t,n,i,r){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0,s=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,c=arguments.length>8?arguments[8]:void 0;const[u,d,h]=(0,o.h)(e,t);let g=1/u,p=1/d,m=1/h,v=Math.floor(n),_=Math.floor(i),y=Math.floor(r),b=0,w=0,E=0,x=0,O=0,T=0;g>0?(b=1,x=(v+1-n)*g):(g*=-1,b=-1,x=(n-v)*g),p>0?(w=1,O=(_+1-i)*p):(p*=-1,w=-1,O=(i-_)*p),m>0?(E=1,T=(y+1-r)*m):(m*=-1,E=-1,T=(r-y)*m);let R=x<O?x<T?x:T:O<T?O:T,S=x<O?x<T?0:2:O<T?1:2;do{const e=0>v||s[0]<=v||0>_||s[1]<=_||0>y||s[2]<=y||l(v,_,y,R,S,x,O,T,g,p,m,b,w,E);if(e){let t=n+R/g*b,o=i+R/p*w,a=r+R/m*E;switch(S){case 0:t=Math.round(t);break;case 1:o=Math.round(o);break;case 2:a=Math.round(a)}if(c&&c(v,_,y,t,o,a,e,R,S,x,O,T,g,p,m,b,w,E))break;return[t,o,a,R,f(S,b,w,E)]}{const e=x<O?x<T?x:T:O<T?O:T;let t=n+e/g*b,o=i+e/p*w,a=r+e/m*E;switch(x<O?x<T?0:2:O<T?1:2){case 0:t=Math.round(t);break;case 1:o=Math.round(o);break;case 2:a=Math.round(a)}if(c&&c(v,_,y,t,o,a,!1,R,S,x,O,T,g,p,m,b,w,E))break}x<O?x<T?(v+=b,R=x,x+=g,S=0):(y+=E,R=T,T+=m,S=2):O<T?(_+=w,R=O,O+=p,S=1):(y+=E,R=T,T+=m,S=2)}while(R<a);return[-1,-1,-1,-1,f(S,b,w,E)]}((0,o.q)(e),(0,o.q)(t),n,i,r,a,s,l,c)}function p(e,t,n,i,a,s,l,c){const u=(0,o.q)(e),d=(0,o.q)(t);return function(e,t,n,i,a){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0,l=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0;const[u,d,h]=(0,o.h)(e,t),g=1/u,p=1/d,m=1/h,v=Math.sign(u),_=Math.sign(d),y=Math.sign(h),b=v*g,w=_*p,E=y*m,x=Math.abs(g),O=Math.abs(p),T=Math.abs(m);let R=Math.floor(n),S=Math.floor(i),A=Math.floor(a),L=1/u,M=1/d,P=1/h,I=0,F=0,C=0,D=0,N=0,k=0,B=-1;L>0?(I=1,D=(R+1-n)*L,B=0):(L*=-1,I=-1,D=(n-R)*L,B=1),M>0?(F=1,N=(S+1-i)*M,B=2):(M*=-1,F=-1,N=(i-S)*M,B=3),P>0?(C=1,k=(A+1-a)*P,B=4):(P*=-1,C=-1,k=(a-A)*P,B=5);let U=D<N?D<k?D:k:N<k?N:k,z=D<N?D<k?0:2:N<k?1:2;do{const e=0>R||l[0]<=R||0>S||l[1]<=S||0>A||l[2]<=A?0:c(R,S,A);if(e<=0){let e=n+U/L*I,t=i+U/M*F,r=a+U/P*C;switch(z){case 0:e=Math.round(e);break;case 1:t=Math.round(t);break;case 2:r=Math.round(r)}return[e,t,r,U,f(z,I,F,C)]}const t=Math.floor((0,r.b)(Math.max(0,e-1)/x,0)),o=Math.floor((0,r.b)(Math.max(0,e-1)/O,0)),s=Math.floor((0,r.b)(Math.max(0,e-1)/T,0));D+=t*b,N+=o*w,k+=s*E,R+=t*v,S+=o*_,A+=s*y,D<N?D<k?(R+=I,U=D,D+=L,z=0):(A+=C,U=k,k+=P,z=2):N<k?(S+=F,U=N,N+=M,z=1):(A+=C,U=k,k+=P,z=2)}while(U<s);return[-1,-1,-1,-1,f(z,I,F,C)]}(u<Number.EPSILON&&u>-Number.EPSILON?Number.EPSILON:u,d<Number.EPSILON&&d>-Number.EPSILON?-Number.EPSILON:d,n,i,a,s,l,c)}function m(e,t,n,i,r,a,s,l,c){return function(e,t,n,i,r){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0,s=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,c=arguments.length>8?arguments[8]:void 0;const[u,d,h]=(0,o.h)(e,t);let f=1/u,g=1/d,p=1/h,m=Math.floor(n),v=Math.floor(i),_=Math.floor(r),y=0,b=0,w=0,E=0,x=0,O=0;f>0?(y=1,E=(m+1-n)*f):(f*=-1,y=-1,E=(n-m)*f),g>0?(b=1,x=(v+1-i)*g):(g*=-1,b=-1,x=(i-v)*g),p>0?(w=1,O=(_+1-r)*p):(p*=-1,w=-1,O=(r-_)*p);let T=E<x?E<O?E:O:x<O?x:O,R=E<x?E<O?0:2:x<O?1:2;do{const e=0>m||s[0]<=m||0>v||s[1]<=v||0>_||s[2]<=_||l(m,v,_,T,R,E,x,O,f,g,p,y,b,w);if(e){let t=n+T/f*y,o=i+T/g*b,a=r+T/p*w;switch(R){case 0:t=Math.round(t);break;case 1:o=Math.round(o);break;case 2:a=Math.round(a)}if(c&&c(m,v,_,t,o,a,e,T,R,E,x,O,f,g,p,y,b,w))break;return!0}{const e=E<x?E<O?E:O:x<O?x:O;let t=n+e/f*y,o=i+e/g*b,a=r+e/p*w;switch(E<x?E<O?0:2:x<O?1:2){case 0:t=Math.round(t);break;case 1:o=Math.round(o);break;case 2:a=Math.round(a)}if(c&&c(m,v,_,t,o,a,!1,T,R,E,x,O,f,g,p,y,b,w))break}E<x?E<O?(m+=y,T=E,E+=f,R=0):(_+=w,T=O,O+=p,R=2):x<O?(v+=b,T=x,x+=g,R=1):(_+=w,T=O,O+=p,R=2)}while(T<a);return!1}((0,o.q)(e),(0,o.q)(t),n,i,r,a,s,l,c)}function v(e,t,n,i,a,s,l,c){const u=(0,o.q)(e),d=(0,o.q)(t);return function(e,t,n,i,a){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0,l=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0;const[u,d,h]=(0,o.h)(e,t),f=1/u,g=1/d,p=1/h,m=Math.sign(u),v=Math.sign(d),_=Math.sign(h),y=m*f,b=v*g,w=_*p,E=Math.abs(f),x=Math.abs(g),O=Math.abs(p);let T=Math.floor(n),R=Math.floor(i),S=Math.floor(a),A=1/u,L=1/d,M=1/h,P=0,I=0,F=0,C=0,D=0,N=0;A>0?(P=1,C=(T+1-n)*A):(A*=-1,P=-1,C=(n-T)*A),L>0?(I=1,D=(R+1-i)*L):(L*=-1,I=-1,D=(i-R)*L),M>0?(F=1,N=(S+1-a)*M):(M*=-1,F=-1,N=(a-S)*M);let k=C<D?C<N?C:N:D<N?D:N,B=C<D?C<N?0:2:D<N?1:2;do{const e=0>T||l[0]<=T||0>R||l[1]<=R||0>S||l[2]<=S?0:c(T,R,S);if(e<=0)return!0;const t=Math.floor((0,r.b)(Math.max(0,e-1)/E,0)),n=Math.floor((0,r.b)(Math.max(0,e-1)/x,0)),i=Math.floor((0,r.b)(Math.max(0,e-1)/O,0));C+=t*y,D+=n*b,N+=i*w,T+=t*m,R+=n*v,S+=i*_,C<D?C<N?(T+=P,k=C,C+=A,B=0):(S+=F,k=N,N+=M,B=2):D<N?(R+=I,k=D,D+=L,B=1):(S+=F,k=N,N+=M,B=2)}while(k<s);return!1}(u<Number.EPSILON&&u>-Number.EPSILON?Number.EPSILON:u,d<Number.EPSILON&&d>-Number.EPSILON?-Number.EPSILON:d,n,i,a,s,l,c)}},(e,t,n)=>{var i=n(66),r=n(29);e.exports=function(e){return i(r(e))}},(e,t,n)=>{var i=n(0).String;e.exports=function(e){try{return i(e)}catch(e){return"Object"}}},e=>{e.exports={}},(e,t,n)=>{var i=n(38),r=n(0);e.exports="process"==i(r.process)},(e,t,n)=>{var i=n(0),r=n(30),o=i.TypeError;e.exports=function(e,t){if(r(t,e))return e;throw o("Incorrect invocation")}},(e,t,n)=>{var i=n(0),r=n(45),o=n(5),a=n(96),s=n(72),l=n(7),c=n(174),u=n(22),d=n(68),h=r&&r.prototype,f=l("species"),g=!1,p=o(i.PromiseRejectionEvent),m=a("Promise",(function(){var e=s(r),t=e!==String(r);if(!t&&66===d)return!0;if(u&&(!h.catch||!h.finally))return!0;if(d>=51&&/native code/.test(e))return!1;var n=new r((function(e){e(1)})),i=function(e){e((function(){}),(function(){}))};return(n.constructor={})[f]=i,!(g=n.then((function(){}))instanceof i)||!t&&c&&!p}));e.exports={CONSTRUCTOR:m,REJECTION_EVENT:p,SUBCLASSING:g}},(e,t,n)=>{var i=n(44),r=n(40),o=n(56),a=n(7)("iterator");e.exports=function(e){if(null!=e)return r(e,a)||r(e,"@@iterator")||o[i(e)]}},(e,t,n)=>{n(26)("Float32",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},(e,t,n)=>{"use strict";n.d(t,{a:()=>i});n(34),n(196),n(146);function i(){const e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".split("");for(let t=0,n=0|e.length;t<n;t=t+1|0)switch(e[t]){case"x":e[t]=Math.floor(16*Math.random()).toString(16);break;case"y":e[t]=(Math.floor(4*Math.random())+8).toString(16)}return e.join("")}},(e,t,n)=>{"use strict";n.d(t,{a:()=>_,b:()=>v});var i=n(197),r=n.n(i),o=n(198),a=n.n(o),s=(n(14),n(1),n(2),n(13)),l=n(64),c=n(35);const u=new Array;async function d(){await Promise.all(u.map((e=>e())).filter((e=>e instanceof Promise))),(0,c.a)(u)}v()&&(0,s.b)(l.d,"message",(e=>{const{data:t}=e;if(t instanceof Object&&"ready"===t.method)d()}));const h={electron:r()(),mobile:!1,steam:!1,steam_overlay:!1};function f(e,t){!!h[t]!==e&&(h[t]=e,l.e.postMessage({method:"change",type:t,value:e}))}let g=v()?0:-1;function p(){g=setTimeout(p,0),f(a()(),"mobile"),f(r()(),"electron"),f("electron"in self&&self.electron.hasSteam(),"steam"),f("electron"in self&&self.electron.hasOpenSteamOverlay(),"steam_overlay")}var m;function v(){if(!v.init){let e=self;try{e=scope}catch(e){}v.isWorker="postMessage"in e&&e.postMessage instanceof Function&&"importScripts"in e&&e.importScripts instanceof Function}return v.init=!0,!!v.isWorker}function _(){return!!h.electron}v()?(0,s.b)(l.e,"message",(e=>{const{data:t}=e;if(t instanceof Object&&"change"===t.method)h[t.type]=!!t.value})):(m=function(){-1===g&&(g=setTimeout(p,0))},document.body?setTimeout((()=>u.push(m))):document.addEventListener("DOMContentLoaded",(()=>u.push(m)),!1))},(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>o,c:()=>l,d:()=>r,e:()=>c,f:()=>s});var i=n(52);const r=new i.a("main"),o=new i.a("http"),a=new i.a("file"),s=(new i.a("stylesheet"),new i.a("pointer-lock"),new i.a("screen")),l=new i.a("local-storage"),c=(new i.a("device"),new i.a("platform"))},(e,t,n)=>{"use strict";n.d(t,{a:()=>l,b:()=>o,c:()=>c,d:()=>a,e:()=>u});n(1),n(2),n(34),n(47),n(241),n(49),n(50),n(51),n(242),n(209),n(107),n(243),n(244),n(245),n(61),n(246),n(247);const i=new Map;function r(e,t){let n;const i=e.toLowerCase();switch(!0){case/^int[0-9]+$/.test(i):switch(i){case"int8":n=new Int8Array(t);break;case"int16":n=new Int16Array(t);break;case"int32":n=new Int32Array(t)}break;case/^uint[0-9]+$/.test(i):switch(i){case"uint8":n=new Uint8Array(t);break;case"uint16":n=new Uint16Array(t);break;case"uint32":n=new Uint32Array(t)}break;case"uint8clamped"===i:n=new Uint8ClampedArray(t);break;case/^float[0-9]+$/.test(i):switch(i){case"float32":n=new Float32Array(t);break;case"float64":n=new Float64Array(t)}}if(!n)throw new Error("Not found array type was ".concat(e));return n}function o(e,t){const n=i.has(e)?i.get(e):l(e,1,!0);return n?(i.set(e,n),n[0]=t,n[0]):t}function a(){return"SharedArrayBuffer"in self}function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=r(e,t).byteLength;return!n&&a()?new SharedArrayBuffer(i):new ArrayBuffer(i)}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r(e,s(e,t,n))}function c(e,t,n,i){return e[t*n+i]}function u(e,t,n,i,r){e[t*n+i]=r}},(e,t,n)=>{var i=n(0),r=n(3),o=n(4),a=n(38),s=i.Object,l=r("".split);e.exports=o((function(){return!s("z").propertyIsEnumerable(0)}))?function(e){return"String"==a(e)?l(e,""):s(e)}:s},(e,t,n)=>{var i=n(4);e.exports=!i((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},(e,t,n)=>{var i,r,o=n(0),a=n(36),s=o.process,l=o.Deno,c=s&&s.versions||l&&l.version,u=c&&c.v8;u&&(r=(i=u.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!r&&a&&(!(i=a.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=a.match(/Chrome\/(\d+)/))&&(r=+i[1]),e.exports=r},(e,t,n)=>{var i=n(0),r=n(15),o=i.document,a=r(o)&&r(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},(e,t,n)=>{var i=n(161),r=n(90);e.exports=function(e){var t=i(e,"string");return r(t)?t:t+""}},(e,t,n)=>{var i=n(37),r=Math.max,o=Math.min;e.exports=function(e,t){var n=i(e);return n<0?r(n+t,0):o(n,t)}},(e,t,n)=>{var i=n(3),r=n(5),o=n(87),a=i(Function.toString);r(o.inspectSource)||(o.inspectSource=function(e){return a(e)}),e.exports=o.inspectSource},(e,t,n)=>{var i=n(11),r=n(12),o=Function.prototype,a=i&&Object.getOwnPropertyDescriptor,s=r(o,"name"),l=s&&"something"===function(){}.name,c=s&&(!i||i&&a(o,"name").configurable);e.exports={EXISTS:s,PROPER:l,CONFIGURABLE:c}},(e,t,n)=>{var i=n(0),r=n(12),o=n(5),a=n(23),s=n(93),l=n(167),c=s("IE_PROTO"),u=i.Object,d=u.prototype;e.exports=l?u.getPrototypeOf:function(e){var t=a(e);if(r(t,c))return t[c];var n=t.constructor;return o(n)&&t instanceof n?n.prototype:t instanceof u?d:null}},(e,t,n)=>{"use strict";var i=n(27),r=n(17),o=n(7),a=n(11),s=o("species");e.exports=function(e){var t=i(e),n=r.f;a&&t&&!t[s]&&n(t,s,{configurable:!0,get:function(){return this}})}},(e,t,n)=>{var i=n(10),r=n(125),o=n(7)("species");e.exports=function(e,t){var n,a=i(e).constructor;return void 0===a||null==(n=i(a)[o])?t:r(n)}},(e,t,n)=>{var i,r,o,a,s=n(0),l=n(78),c=n(32),u=n(5),d=n(12),h=n(4),f=n(117),g=n(126),p=n(69),m=n(79),v=n(127),_=n(57),y=s.setImmediate,b=s.clearImmediate,w=s.process,E=s.Dispatch,x=s.Function,O=s.MessageChannel,T=s.String,R=0,S={},A="onreadystatechange";try{i=s.location}catch(e){}var L=function(e){if(d(S,e)){var t=S[e];delete S[e],t()}},M=function(e){return function(){L(e)}},P=function(e){L(e.data)},I=function(e){s.postMessage(T(e),i.protocol+"//"+i.host)};y&&b||(y=function(e){m(arguments.length,1);var t=u(e)?e:x(e),n=g(arguments,1);return S[++R]=function(){l(t,void 0,n)},r(R),R},b=function(e){delete S[e]},_?r=function(e){w.nextTick(M(e))}:E&&E.now?r=function(e){E.now(M(e))}:O&&!v?(a=(o=new O).port2,o.port1.onmessage=P,r=c(a.postMessage,a)):s.addEventListener&&u(s.postMessage)&&!s.importScripts&&i&&"file:"!==i.protocol&&!h(I)?(r=I,s.addEventListener("message",P,!1)):r=A in p("script")?function(e){f.appendChild(p("script")).onreadystatechange=function(){f.removeChild(this),L(e)}}:function(e){setTimeout(M(e),0)}),e.exports={set:y,clear:b}},(e,t,n)=>{var i=n(67),r=Function.prototype,o=r.apply,a=r.call;e.exports="object"==typeof Reflect&&Reflect.apply||(i?a.bind(o):function(){return a.apply(o,arguments)})},(e,t,n)=>{var i=n(0).TypeError;e.exports=function(e,t){if(e<t)throw i("Not enough arguments");return e}},(e,t,n)=>{"use strict";var i=n(24),r=function(e){var t,n;this.promise=new e((function(e,i){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=i})),this.resolve=i(t),this.reject=i(n)};e.exports.f=function(e){return new r(e)}},(e,t,n)=>{var i=n(0),r=n(8),o=n(24),a=n(10),s=n(55),l=n(60),c=i.TypeError;e.exports=function(e,t){var n=arguments.length<2?l(e):t;if(o(n))return a(r(n,e));throw c(s(e)+" is not iterable")}},(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var i=n(156),r=n.n(i);function o(e){return r()(e)}},(e,t,n)=>{"use strict";var i,r,o=n(8),a=n(3),s=n(16),l=n(136),c=n(101),u=n(86),d=n(39),h=n(25).get,f=n(137),g=n(138),p=u("native-string-replace",String.prototype.replace),m=RegExp.prototype.exec,v=m,_=a("".charAt),y=a("".indexOf),b=a("".replace),w=a("".slice),E=(r=/b*/g,o(m,i=/a/,"a"),o(m,r,"a"),0!==i.lastIndex||0!==r.lastIndex),x=c.BROKEN_CARET,O=void 0!==/()??/.exec("")[1];(E||O||x||f||g)&&(v=function(e){var t,n,i,r,a,c,u,f=this,g=h(f),T=s(e),R=g.raw;if(R)return R.lastIndex=f.lastIndex,t=o(v,R,T),f.lastIndex=R.lastIndex,t;var S=g.groups,A=x&&f.sticky,L=o(l,f),M=f.source,P=0,I=T;if(A&&(L=b(L,"y",""),-1===y(L,"g")&&(L+="g"),I=w(T,f.lastIndex),f.lastIndex>0&&(!f.multiline||f.multiline&&"\n"!==_(T,f.lastIndex-1))&&(M="(?: "+M+")",I=" "+I,P++),n=new RegExp("^(?:"+M+")",L)),O&&(n=new RegExp("^"+M+"$(?!\\s)",L)),E&&(i=f.lastIndex),r=o(m,A?n:f,I),A?r?(r.input=w(r.input,P),r[0]=w(r[0],P),r.index=f.lastIndex,f.lastIndex+=r[0].length):f.lastIndex=0:E&&r&&(f.lastIndex=f.global?r.index+r[0].length:i),O&&r&&r.length>1&&o(p,r[0],n,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(r[a]=void 0)})),r&&S)for(r.groups=c=d(null),a=0;a<S.length;a++)c[(u=S[a])[0]]=r[u[1]];return r}),e.exports=v},(e,t,n)=>{var i=n(0),r=n(71),o=n(28),a=n(142),s=i.Array,l=Math.max;e.exports=function(e,t,n){for(var i=o(e),c=r(t,i),u=r(void 0===n?i:n,i),d=s(l(u-c,0)),h=0;c<u;c++,h++)a(d,h,e[c]);return d.length=h,d}},(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>i,c:()=>o});n(1),n(47),n(107),n(49),n(50),n(51),n(61);function i(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.floor;return isNaN(e)||e===1/0?t:-1===n?e:i(Math.abs(e)*n)/n*Math.sign(e)}function r(e,t,n){return Math.min(n,Math.max(t,e))}function o(e){return r(e,0,1)}},(e,t,n)=>{var i=n(22),r=n(87);(e.exports=function(e,t){return r[e]||(r[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.22.5",mode:i?"pure":"global",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.22.5/LICENSE",source:"https://github.com/zloirock/core-js"})},(e,t,n)=>{var i=n(0),r=n(88),o="__core-js_shared__",a=i[o]||r(o,{});e.exports=a},(e,t,n)=>{var i=n(0),r=Object.defineProperty;e.exports=function(e,t){try{r(i,e,{value:t,configurable:!0,writable:!0})}catch(n){i[e]=t}return t}},(e,t,n)=>{var i=n(3),r=0,o=Math.random(),a=i(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++r+o,36)}},(e,t,n)=>{var i=n(0),r=n(27),o=n(5),a=n(30),s=n(111),l=i.Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return o(t)&&a(t.prototype,l(e))}},e=>{e.exports={}},e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},(e,t,n)=>{var i=n(86),r=n(89),o=i("keys");e.exports=function(e){return o[e]||(o[e]=r(e))}},(e,t,n)=>{var i=n(11),r=n(8),o=n(164),a=n(41),s=n(54),l=n(70),c=n(12),u=n(113),d=Object.getOwnPropertyDescriptor;t.f=i?d:function(e,t){if(e=s(e),t=l(t),u)try{return d(e,t)}catch(e){}if(c(e,t))return a(!r(o.f,e,t),e[t])}},(e,t,n)=>{var i=n(115),r=n(92).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,r)}},(e,t,n)=>{var i=n(4),r=n(5),o=/#|\.prototype\./,a=function(e,t){var n=l[s(e)];return n==u||n!=c&&(r(t)?i(t):!!t)},s=a.normalize=function(e){return String(e).replace(o,".").toLowerCase()},l=a.data={},c=a.NATIVE="N",u=a.POLYFILL="P";e.exports=a},(e,t,n)=>{var i=n(3),r=n(4),o=n(5),a=n(44),s=n(27),l=n(72),c=function(){},u=[],d=s("Reflect","construct"),h=/^\s*(?:class|function)\b/,f=i(h.exec),g=!h.exec(c),p=function(e){if(!o(e))return!1;try{return d(c,u,e),!0}catch(e){return!1}},m=function(e){if(!o(e))return!1;switch(a(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return g||!!f(h,l(e))}catch(e){return!0}};m.sham=!0,e.exports=!d||r((function(){var e;return p(p.call)||!p(Object)||!p((function(){e=!0}))||e}))?m:p},e=>{e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},(e,t,n)=>{var i=n(7),r=n(56),o=i("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||a[o]===e)}},(e,t,n)=>{var i=n(15),r=n(38),o=n(7)("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==r(e))}},(e,t,n)=>{var i=n(4),r=n(0).RegExp,o=i((function(){var e=r("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),a=o||i((function(){return!r("a","y").sticky})),s=o||i((function(){var e=r("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:s,MISSED_STICKY:a,UNSUPPORTED_Y:o}},(e,t,n)=>{"use strict";var i=n(0),r=n(3),o=n(11),a=n(139),s=n(73),l=n(19),c=n(140),u=n(4),d=n(58),h=n(37),f=n(31),g=n(141),p=n(181),m=n(74),v=n(43),_=n(95).f,y=n(17).f,b=n(182),w=n(84),E=n(42),x=n(25),O=s.PROPER,T=s.CONFIGURABLE,R=x.get,S=x.set,A="ArrayBuffer",L="DataView",M="Wrong index",P=i.ArrayBuffer,I=P,F=I&&I.prototype,C=i.DataView,D=C&&C.prototype,N=Object.prototype,k=i.Array,B=i.RangeError,U=r(b),z=r([].reverse),G=p.pack,X=p.unpack,H=function(e){return[255&e]},V=function(e){return[255&e,e>>8&255]},Y=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},j=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},W=function(e){return G(e,23,4)},q=function(e){return G(e,52,8)},Z=function(e,t){y(e.prototype,t,{get:function(){return R(this)[t]}})},K=function(e,t,n,i){var r=g(n),o=R(e);if(r+t>o.byteLength)throw B(M);var a=R(o.buffer).bytes,s=r+o.byteOffset,l=w(a,s,s+t);return i?l:z(l)},J=function(e,t,n,i,r,o){var a=g(n),s=R(e);if(a+t>s.byteLength)throw B(M);for(var l=R(s.buffer).bytes,c=a+s.byteOffset,u=i(+r),d=0;d<t;d++)l[c+d]=u[o?d:t-d-1]};if(a){var Q=O&&P.name!==A;if(u((function(){P(1)}))&&u((function(){new P(-1)}))&&!u((function(){return new P,new P(1.5),new P(NaN),Q&&!T})))Q&&T&&l(P,"name",A);else{(I=function(e){return d(this,F),new P(g(e))}).prototype=F;for(var $,ee=_(P),te=0;ee.length>te;)($=ee[te++])in I||l(I,$,P[$]);F.constructor=I}v&&m(D)!==N&&v(D,N);var ne=new C(new I(2)),ie=r(D.setInt8);ne.setInt8(0,2147483648),ne.setInt8(1,2147483649),!ne.getInt8(0)&&ne.getInt8(1)||c(D,{setInt8:function(e,t){ie(this,e,t<<24>>24)},setUint8:function(e,t){ie(this,e,t<<24>>24)}},{unsafe:!0})}else F=(I=function(e){d(this,F);var t=g(e);S(this,{bytes:U(k(t),0),byteLength:t}),o||(this.byteLength=t)}).prototype,D=(C=function(e,t,n){d(this,D),d(e,F);var i=R(e).byteLength,r=h(t);if(r<0||r>i)throw B("Wrong offset");if(r+(n=void 0===n?i-r:f(n))>i)throw B("Wrong length");S(this,{buffer:e,byteLength:n,byteOffset:r}),o||(this.buffer=e,this.byteLength=n,this.byteOffset=r)}).prototype,o&&(Z(I,"byteLength"),Z(C,"buffer"),Z(C,"byteLength"),Z(C,"byteOffset")),c(D,{getInt8:function(e){return K(this,1,e)[0]<<24>>24},getUint8:function(e){return K(this,1,e)[0]},getInt16:function(e){var t=K(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=K(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return j(K(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return j(K(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return X(K(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return X(K(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){J(this,1,e,H,t)},setUint8:function(e,t){J(this,1,e,H,t)},setInt16:function(e,t){J(this,2,e,V,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){J(this,2,e,V,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){J(this,4,e,Y,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){J(this,4,e,Y,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){J(this,4,e,W,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){J(this,8,e,q,t,arguments.length>2?arguments[2]:void 0)}});E(I,A),E(C,L),e.exports={ArrayBuffer:I,DataView:C}},(e,t,n)=>{"use strict";n(34);var i=n(3),r=n(18),o=n(83),a=n(4),s=n(7),l=n(19),c=s("species"),u=RegExp.prototype;e.exports=function(e,t,n,d){var h=s(e),f=!a((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),g=f&&!a((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return t=!0,null},n[h](""),!t}));if(!f||!g||n){var p=i(/./[h]),m=t(h,""[e],(function(e,t,n,r,a){var s=i(e),l=t.exec;return l===o||l===u.exec?f&&!a?{done:!0,value:p(t,n,r)}:{done:!0,value:s(n,t,r)}:{done:!1}}));r(String.prototype,e,m[0]),r(u,h,m[1])}d&&l(u[h],"sham",!0)}},(e,t,n)=>{"use strict";var i=n(105).charAt;e.exports=function(e,t,n){return t+(n?i(e,t).length:1)}},(e,t,n)=>{var i=n(3),r=n(37),o=n(16),a=n(29),s=i("".charAt),l=i("".charCodeAt),c=i("".slice),u=function(e){return function(t,n){var i,u,d=o(a(t)),h=r(n),f=d.length;return h<0||h>=f?e?"":void 0:(i=l(d,h))<55296||i>56319||h+1===f||(u=l(d,h+1))<56320||u>57343?e?s(d,h):i:e?c(d,h,h+2):u-56320+(i-55296<<10)+65536}};e.exports={codeAt:u(!1),charAt:u(!0)}},(e,t,n)=>{var i=n(0),r=n(8),o=n(10),a=n(5),s=n(38),l=n(83),c=i.TypeError;e.exports=function(e,t){var n=e.exec;if(a(n)){var i=r(n,e,t);return null!==i&&o(i),i}if("RegExp"===s(e))return r(l,e,t);throw c("RegExp#exec called on incompatible receiver")}},(e,t,n)=>{n(26)("Uint8",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},(e,t,n)=>{"use strict";n.d(t,{a:()=>g});n(14),n(201),n(1),n(2),n(148),n(151),n(34),n(233),n(146),n(157),n(190);function i(e){return btoa(unescape(encodeURIComponent(e)))}var r=n(227),o=n(63),a=n(62),s=n(64),l=n(13),c=n(52);function u(e,t){switch(e.toLowerCase()){case"text":return t.text();case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json();case"xml":return t.text().then((e=>(new DOMParser).parseFromString(e,"text/xml")));case"html":return t.text().then((e=>(new DOMParser).parseFromString(e,"text/html")))}return null}async function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{method:"GET",mode:"cors",cache:"no-store",credentials:"same-origin"};const i=await(0,r.a)(e,n).then((async e=>e.ok?await u(t,e):null)).catch((e=>(console.error(e),null)));return i}async function h(e){let t=null;0;try{const n=prompt(e);null!==n&&(t=await d(n,"text"))}catch(e){console.error(e)}finally{0}return t}async function f(e,t,n,r,o){let a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const s=a?e:"".concat(prompt("enter file name")||e).concat(n?"."+n[0]:"");switch(r){case"text":o="data:".concat(t?t[0]:"",";charset=utf-8;base64,").concat(i(o));break;case"blob":o=URL.createObjectURL(new Blob([o],{type:t[0]}))}const u=document.createElement("a");u.href=o,u.download=s,document.body.appendChild(u),u.click(),u.remove(),"blob"===r&&URL.revokeObjectURL(o),await new Promise((e=>{const t=()=>{(0,l.d)((0,c.d)(),"focus",t),e(null)};(0,l.b)((0,c.d)(),"focus",t)}))}async function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text",n=arguments.length>2?arguments[2]:void 0,i=e;if(/^(data|blob):/.test(e)||new RegExp("^".concat(location.origin)).test(e))i=e;else if("file:"!==location.protocol){const t=/^http:\/\/[^\/]+\/$|^file:\/\/[^\/]+\/$|^http:\/\/$|^file:\/\/$/.test(location.origin)?location.origin.substring(0,location.origin.length-1):location.origin,n=(/^http:\/\/|^file:\/\//.test(location.pathname)||0===location.pathname.length?"/":location.pathname).replace(/\/[^\/]+$/,"/");i="".concat(t).concat(n).concat(e.replace(/^\.\/|^\//,""))}const r=await d(i,t,n);if(null===r)throw new Error("Not found file is ".concat(e));return{source:r,src:i}}(0,o.b)()||(0,l.b)(s.a,"message",(async e=>{const{data:t}=e;if(!(t instanceof Object))return;let n=null;switch(t.method){case"open":n=await async function(e,t,n){return(0,o.b)()?await new Promise((i=>{const r=(0,a.a)(),o=e=>{const{data:t}=e;if(t instanceof Object&&r===t.key&&"return"===t.method)(0,l.d)(s.a,"message",o),t.value&&i(t.value)};(0,l.b)(s.a,"message",o),s.a.postMessage({method:"open",description:e,mimeTypes:t,extensions:n,key:r})})):"showOpenFilePicker"in window&&self.isSecureContext?await async function(e,t,n){let i=null;0;try{if("electron"in self)i=await self.electron.openFile(e,n);else{const r=(await showOpenFilePicker({types:[{description:e,accept:(()=>{const e={};return e[t[0]]=n.map((e=>".".concat(e))),e})()}]}))[0];if("granted"===await r.requestPermission({mode:"read"})){const e=await r.getFile();i=await e.text()}else h(e)}}catch(e){console.error(e.message)}finally{0}return i}(e,t,n):h(e)}(t.description,t.mimeTypes,t.extensions);break;case"save":await async function(e,t,n,i,r){(0,o.b)()?await new Promise((o=>{const c=(0,a.a)(),u=e=>{const{data:t}=e;if(t instanceof Object&&c===t.key&&"return"===t.method)(0,l.d)(s.a,"message",u),o(null)};(0,l.b)(s.a,"message",u),s.a.postMessage({method:"save",description:e,mimeTypes:t,extensions:n,type:i,text:r,key:c})})):"showSaveFilePicker"in self&&self.isSecureContext?await async function(e,t,n,i,r){let o="boxengine-file".concat(n?"."+n[0]:""),a=null;0;try{if("electron"in self)await self.electron.saveFile(r,e,n);else{const i=await self.showSaveFilePicker({excludeAcceptAllOption:!1,types:[{description:e,accept:(()=>{const e={};return e[t[0]]=n.map((e=>".".concat(e))),e})()}]});if(o=i.name,"granted"!==await i.requestPermission({mode:"readwrite"}))throw"can't save file.";a=await i.createWritable(),await a.write(r)}}catch(e){console.error(e),await f(o,t,n,i,r instanceof Function?r():r,!0)}finally{null!==a&&await a.close()}}(e,t,n,i,r):f("boxengine-file",t,n,i,r instanceof Function?r():r)}(t.description,t.mimeTypes,t.extensions,t.type,t.text)}s.a.postMessage({method:"return",value:n,key:t.key})}))},(e,t,n)=>{var i=n(7),r=n(39),o=n(17),a=i("unscopables"),s=Array.prototype;null==s[a]&&o.f(s,a,{configurable:!0,value:r(null)}),e.exports=function(e){s[a][e]=!0}},(e,t,n)=>{var i=n(68),r=n(4);e.exports=!!Object.getOwnPropertySymbols&&!r((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},(e,t,n)=>{var i=n(110);e.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},(e,t,n)=>{var i=n(11),r=n(4);e.exports=i&&r((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},(e,t,n)=>{var i=n(11),r=n(4),o=n(69);e.exports=!i&&!r((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},(e,t,n)=>{var i=n(115),r=n(92);e.exports=Object.keys||function(e){return i(e,r)}},(e,t,n)=>{var i=n(3),r=n(12),o=n(54),a=n(116).indexOf,s=n(91),l=i([].push);e.exports=function(e,t){var n,i=o(e),c=0,u=[];for(n in i)!r(s,n)&&r(i,n)&&l(u,n);for(;t.length>c;)r(i,n=t[c++])&&(~a(u,n)||l(u,n));return u}},(e,t,n)=>{var i=n(54),r=n(71),o=n(28),a=function(e){return function(t,n,a){var s,l=i(t),c=o(l),u=r(a,c);if(e&&n!=n){for(;c>u;)if((s=l[u++])!=s)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},(e,t,n)=>{var i=n(27);e.exports=i("document","documentElement")},(e,t,n)=>{"use strict";var i=n(9),r=n(8),o=n(22),a=n(73),s=n(5),l=n(121),c=n(74),u=n(43),d=n(42),h=n(19),f=n(18),g=n(7),p=n(56),m=n(122),v=a.PROPER,_=a.CONFIGURABLE,y=m.IteratorPrototype,b=m.BUGGY_SAFARI_ITERATORS,w=g("iterator"),E="keys",x="values",O="entries",T=function(){return this};e.exports=function(e,t,n,a,g,m,R){l(n,t,a);var S,A,L,M=function(e){if(e===g&&D)return D;if(!b&&e in F)return F[e];switch(e){case E:case x:case O:return function(){return new n(this,e)}}return function(){return new n(this)}},P=t+" Iterator",I=!1,F=e.prototype,C=F[w]||F["@@iterator"]||g&&F[g],D=!b&&C||M(g),N="Array"==t&&F.entries||C;if(N&&(S=c(N.call(new e)))!==Object.prototype&&S.next&&(o||c(S)===y||(u?u(S,y):s(S[w])||f(S,w,T)),d(S,P,!0,!0),o&&(p[P]=T)),v&&g==x&&C&&C.name!==x&&(!o&&_?h(F,"name",x):(I=!0,D=function(){return r(C,this)})),g)if(A={values:M(x),keys:m?D:M(E),entries:M(O)},R)for(L in A)(b||I||!(L in F))&&f(F,L,A[L]);else i({target:t,proto:!0,forced:b||I},A);return o&&!R||F[w]===D||f(F,w,D,{name:g}),p[t]=D,A}},(e,t,n)=>{var i=n(4),r=n(5),o=n(12),a=n(11),s=n(73).CONFIGURABLE,l=n(72),c=n(25),u=c.enforce,d=c.get,h=Object.defineProperty,f=a&&!i((function(){return 8!==h((function(){}),"length",{value:8}).length})),g=String(String).split("String"),p=e.exports=function(e,t,n){if("Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!o(e,"name")||s&&e.name!==t)&&h(e,"name",{value:t,configurable:!0}),f&&n&&o(n,"arity")&&e.length!==n.arity&&h(e,"length",{value:n.arity}),n&&o(n,"constructor")&&n.constructor){if(a)try{h(e,"prototype",{writable:!1})}catch(e){}}else e.prototype=void 0;var i=u(e);return o(i,"source")||(i.source=g.join("string"==typeof t?t:"")),e};Function.prototype.toString=p((function(){return r(this)&&d(this).source||l(this)}),"toString")},(e,t,n)=>{var i=n(12),r=n(165),o=n(94),a=n(17);e.exports=function(e,t,n){for(var s=r(t),l=a.f,c=o.f,u=0;u<s.length;u++){var d=s[u];i(e,d)||n&&i(n,d)||l(e,d,c(t,d))}}},(e,t,n)=>{"use strict";var i=n(122).IteratorPrototype,r=n(39),o=n(41),a=n(42),s=n(56),l=function(){return this};e.exports=function(e,t,n,c){var u=t+" Iterator";return e.prototype=r(i,{next:o(+!c,n)}),a(e,u,!1,!0),s[u]=l,e}},(e,t,n)=>{"use strict";var i,r,o,a=n(4),s=n(5),l=n(39),c=n(74),u=n(18),d=n(7),h=n(22),f=d("iterator"),g=!1;[].keys&&("next"in(o=[].keys())?(r=c(c(o)))!==Object.prototype&&(i=r):g=!0),null==i||a((function(){var e={};return i[f].call(e)!==e}))?i={}:h&&(i=l(i)),s(i[f])||u(i,f,(function(){return this})),e.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:g}},e=>{e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},(e,t,n)=>{var i=n(69)("span").classList,r=i&&i.constructor&&i.constructor.prototype;e.exports=r===Object.prototype?void 0:r},(e,t,n)=>{var i=n(0),r=n(97),o=n(55),a=i.TypeError;e.exports=function(e){if(r(e))return e;throw a(o(e)+" is not a constructor")}},(e,t,n)=>{var i=n(3);e.exports=i([].slice)},(e,t,n)=>{var i=n(36);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(i)},(e,t,n)=>{var i,r,o,a,s,l,c,u,d=n(0),h=n(32),f=n(94).f,g=n(77).set,p=n(127),m=n(170),v=n(171),_=n(57),y=d.MutationObserver||d.WebKitMutationObserver,b=d.document,w=d.process,E=d.Promise,x=f(d,"queueMicrotask"),O=x&&x.value;O||(i=function(){var e,t;for(_&&(e=w.domain)&&e.exit();r;){t=r.fn,r=r.next;try{t()}catch(e){throw r?a():o=void 0,e}}o=void 0,e&&e.enter()},p||_||v||!y||!b?!m&&E&&E.resolve?((c=E.resolve(void 0)).constructor=E,u=h(c.then,c),a=function(){u(i)}):_?a=function(){w.nextTick(i)}:(g=h(g,d),a=function(){g(i)}):(s=!0,l=b.createTextNode(""),new y(i).observe(l,{characterData:!0}),a=function(){l.data=s=!s})),e.exports=O||function(e){var t={fn:e,next:void 0};o&&(o.next=t),r||(r=t,a()),o=t}},(e,t,n)=>{var i=n(0),r=n(32),o=n(8),a=n(10),s=n(55),l=n(99),c=n(28),u=n(30),d=n(81),h=n(60),f=n(130),g=i.TypeError,p=function(e,t){this.stopped=e,this.result=t},m=p.prototype;e.exports=function(e,t,n){var i,v,_,y,b,w,E,x=n&&n.that,O=!(!n||!n.AS_ENTRIES),T=!(!n||!n.IS_ITERATOR),R=!(!n||!n.INTERRUPTED),S=r(t,x),A=function(e){return i&&f(i,"normal",e),new p(!0,e)},L=function(e){return O?(a(e),R?S(e[0],e[1],A):S(e[0],e[1])):R?S(e,A):S(e)};if(T)i=e;else{if(!(v=h(e)))throw g(s(e)+" is not iterable");if(l(v)){for(_=0,y=c(e);y>_;_++)if((b=L(e[_]))&&u(m,b))return b;return new p(!1)}i=d(e,v)}for(w=i.next;!(E=o(w,i)).done;){try{b=L(E.value)}catch(e){f(i,"throw",e)}if("object"==typeof b&&b&&u(m,b))return b}return new p(!1)}},(e,t,n)=>{var i=n(8),r=n(10),o=n(40);e.exports=function(e,t,n){var a,s;r(e);try{if(!(a=o(e,"return"))){if("throw"===t)throw n;return n}a=i(a,e)}catch(e){s=!0,a=e}if("throw"===t)throw n;if(s)throw a;return r(a),n}},(e,t,n)=>{var i=n(45),r=n(132),o=n(59).CONSTRUCTOR;e.exports=o||!r((function(e){i.all(e).then(void 0,(function(){}))}))},(e,t,n)=>{var i=n(7)("iterator"),r=!1;try{var o=0,a={next:function(){return{done:!!o++}},return:function(){r=!0}};a[i]=function(){return this},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!r)return!1;var n=!1;try{var o={};o[i]=function(){return{next:function(){return{done:n=!0}}}},e(o)}catch(e){}return n}},(e,t,n)=>{var i=n(10),r=n(15),o=n(80);e.exports=function(e,t){if(i(e),r(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},(e,t,n)=>{var i=n(32),r=n(3),o=n(66),a=n(23),s=n(28),l=n(176),c=r([].push),u=function(e){var t=1==e,n=2==e,r=3==e,u=4==e,d=6==e,h=7==e,f=5==e||d;return function(g,p,m,v){for(var _,y,b=a(g),w=o(b),E=i(p,m),x=s(w),O=0,T=v||l,R=t?T(g,x):n||h?T(g,0):void 0;x>O;O++)if((f||O in w)&&(y=E(_=w[O],O,b),e))if(t)R[O]=y;else if(y)switch(e){case 3:return!0;case 5:return _;case 6:return O;case 2:c(R,_)}else switch(e){case 4:return!1;case 7:c(R,_)}return d?-1:r||u?u:R}};e.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}},(e,t,n)=>{"use strict";var i=n(4);e.exports=function(e,t){var n=[][e];return!!n&&i((function(){n.call(null,t||function(){return 1},1)}))}},(e,t,n)=>{"use strict";var i=n(10);e.exports=function(){var e=i(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},(e,t,n)=>{var i=n(4),r=n(0).RegExp;e.exports=i((function(){var e=r(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},(e,t,n)=>{var i=n(4),r=n(0).RegExp;e.exports=i((function(){var e=r("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},e=>{e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},(e,t,n)=>{var i=n(18);e.exports=function(e,t,n){for(var r in t)i(e,r,t[r],n);return e}},(e,t,n)=>{var i=n(0),r=n(37),o=n(31),a=i.RangeError;e.exports=function(e){if(void 0===e)return 0;var t=r(e),n=o(t);if(t!==n)throw a("Wrong length or index");return n}},(e,t,n)=>{"use strict";var i=n(70),r=n(17),o=n(41);e.exports=function(e,t,n){var a=i(t);a in e?r.f(e,a,o(0,n)):e[a]=n}},(e,t,n)=>{var i=n(0),r=n(185),o=i.RangeError;e.exports=function(e,t){var n=r(e);if(n%t)throw o("Wrong offset");return n}},(e,t,n)=>{var i=n(5),r=n(15),o=n(43);e.exports=function(e,t,n){var a,s;return o&&i(a=t.constructor)&&a!==n&&r(s=a.prototype)&&s!==n.prototype&&o(e,s),e}},(e,t,n)=>{var i=n(84),r=Math.floor,o=function(e,t){var n=e.length,l=r(n/2);return n<8?a(e,t):s(e,o(i(e,0,l),t),o(i(e,l),t),t)},a=function(e,t){for(var n,i,r=e.length,o=1;o<r;){for(i=o,n=e[o];i&&t(e[i-1],n)>0;)e[i]=e[--i];i!==o++&&(e[i]=n)}return e},s=function(e,t,n,i){for(var r=t.length,o=n.length,a=0,s=0;a<r||s<o;)e[a+s]=a<r&&s<o?i(t[a],n[s])<=0?t[a++]:n[s++]:a<r?t[a++]:n[s++];return e};e.exports=o},(e,t,n)=>{"use strict";var i=n(73).PROPER,r=n(18),o=n(10),a=n(16),s=n(4),l=n(147),c="toString",u=RegExp.prototype.toString,d=s((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),h=i&&u.name!=c;(d||h)&&r(RegExp.prototype,c,(function(){var e=o(this);return"/"+a(e.source)+"/"+a(l(e))}),{unsafe:!0})},(e,t,n)=>{var i=n(8),r=n(12),o=n(30),a=n(136),s=RegExp.prototype;e.exports=function(e){var t=e.flags;return void 0!==t||"flags"in s||r(e,"flags")||!o(s,e)?t:i(a,e)}},(e,t,n)=>{n(225)},(e,t,n)=>{var i=n(4),r=n(7),o=n(22),a=r("iterator");e.exports=!i((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,i){t.delete("b"),n+=i+e})),o&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://").host||"#%D0%B1"!==new URL("http://a#").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},(e,t,n)=>{"use strict";n(1);var i=n(9),r=n(0),o=n(8),a=n(3),s=n(11),l=n(149),c=n(18),u=n(140),d=n(42),h=n(121),f=n(25),g=n(58),p=n(5),m=n(12),v=n(32),_=n(44),y=n(10),b=n(15),w=n(16),E=n(39),x=n(41),O=n(81),T=n(60),R=n(79),S=n(7),A=n(145),L=S("iterator"),M="URLSearchParams",P="URLSearchParamsIterator",I=f.set,F=f.getterFor(M),C=f.getterFor(P),D=Object.getOwnPropertyDescriptor,N=function(e){if(!s)return r[e];var t=D(r,e);return t&&t.value},k=N("fetch"),B=N("Request"),U=N("Headers"),z=B&&B.prototype,G=U&&U.prototype,X=r.RegExp,H=r.TypeError,V=r.decodeURIComponent,Y=r.encodeURIComponent,j=a("".charAt),W=a([].join),q=a([].push),Z=a("".replace),K=a([].shift),J=a([].splice),Q=a("".split),$=a("".slice),ee=/\+/g,te=Array(4),ne=function(e){return te[e-1]||(te[e-1]=X("((?:%[\\da-f]{2}){"+e+"})","gi"))},ie=function(e){try{return V(e)}catch(t){return e}},re=function(e){var t=Z(e,ee," "),n=4;try{return V(t)}catch(e){for(;n;)t=Z(t,ne(n--),ie);return t}},oe=/[!'()~]|%20/g,ae={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},se=function(e){return ae[e]},le=function(e){return Z(Y(e),oe,se)},ce=h((function(e,t){I(this,{type:P,iterator:O(F(e).entries),kind:t})}),"Iterator",(function(){var e=C(this),t=e.kind,n=e.iterator.next(),i=n.value;return n.done||(n.value="keys"===t?i.key:"values"===t?i.value:[i.key,i.value]),n}),!0),ue=function(e){this.entries=[],this.url=null,void 0!==e&&(b(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===j(e,0)?$(e,1):e:w(e)))};ue.prototype={type:M,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,i,r,a,s,l,c=T(e);if(c)for(n=(t=O(e,c)).next;!(i=o(n,t)).done;){if(a=(r=O(y(i.value))).next,(s=o(a,r)).done||(l=o(a,r)).done||!o(a,r).done)throw H("Expected sequence with length 2");q(this.entries,{key:w(s.value),value:w(l.value)})}else for(var u in e)m(e,u)&&q(this.entries,{key:u,value:w(e[u])})},parseQuery:function(e){if(e)for(var t,n,i=Q(e,"&"),r=0;r<i.length;)(t=i[r++]).length&&(n=Q(t,"="),q(this.entries,{key:re(K(n)),value:re(W(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],i=0;i<t.length;)e=t[i++],q(n,le(e.key)+"="+le(e.value));return W(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var de=function(){g(this,he);var e=arguments.length>0?arguments[0]:void 0;I(this,new ue(e))},he=de.prototype;if(u(he,{append:function(e,t){R(arguments.length,2);var n=F(this);q(n.entries,{key:w(e),value:w(t)}),n.updateURL()},delete:function(e){R(arguments.length,1);for(var t=F(this),n=t.entries,i=w(e),r=0;r<n.length;)n[r].key===i?J(n,r,1):r++;t.updateURL()},get:function(e){R(arguments.length,1);for(var t=F(this).entries,n=w(e),i=0;i<t.length;i++)if(t[i].key===n)return t[i].value;return null},getAll:function(e){R(arguments.length,1);for(var t=F(this).entries,n=w(e),i=[],r=0;r<t.length;r++)t[r].key===n&&q(i,t[r].value);return i},has:function(e){R(arguments.length,1);for(var t=F(this).entries,n=w(e),i=0;i<t.length;)if(t[i++].key===n)return!0;return!1},set:function(e,t){R(arguments.length,1);for(var n,i=F(this),r=i.entries,o=!1,a=w(e),s=w(t),l=0;l<r.length;l++)(n=r[l]).key===a&&(o?J(r,l--,1):(o=!0,n.value=s));o||q(r,{key:a,value:s}),i.updateURL()},sort:function(){var e=F(this);A(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=F(this).entries,i=v(e,arguments.length>1?arguments[1]:void 0),r=0;r<n.length;)i((t=n[r++]).value,t.key,this)},keys:function(){return new ce(this,"keys")},values:function(){return new ce(this,"values")},entries:function(){return new ce(this,"entries")}},{enumerable:!0}),c(he,L,he.entries,{name:"entries"}),c(he,"toString",(function(){return F(this).serialize()}),{enumerable:!0}),d(de,M),i({global:!0,constructor:!0,forced:!l},{URLSearchParams:de}),!l&&p(U)){var fe=a(G.has),ge=a(G.set),pe=function(e){if(b(e)){var t,n=e.body;if(_(n)===M)return t=e.headers?new U(e.headers):new U,fe(t,"content-type")||ge(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),E(e,{body:x(0,w(n)),headers:x(0,t)})}return e};if(p(k)&&i({global:!0,enumerable:!0,noTargetGet:!0,forced:!0},{fetch:function(e){return k(e,arguments.length>1?pe(arguments[1]):{})}}),p(B)){var me=function(e){return g(this,z),new B(e,arguments.length>1?pe(arguments[1]):{})};z.constructor=me,me.prototype=z,i({global:!0,constructor:!0,noTargetGet:!0,forced:!0},{Request:me})}}e.exports={URLSearchParams:de,getState:F}},(e,t,n)=>{n(150)},function(e){e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}({17:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var i=n(18),r=function(){function e(){}return e.getFirstMatch=function(e,t){var n=t.match(e);return n&&n.length>0&&n[1]||""},e.getSecondMatch=function(e,t){var n=t.match(e);return n&&n.length>1&&n[2]||""},e.matchAndReturnConst=function(e,t,n){if(e.test(t))return n},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,n,i){void 0===i&&(i=!1);var r=e.getVersionPrecision(t),o=e.getVersionPrecision(n),a=Math.max(r,o),s=0,l=e.map([t,n],(function(t){var n=a-e.getVersionPrecision(t),i=t+new Array(n+1).join(".0");return e.map(i.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(i&&(s=a-Math.min(r,o)),a-=1;a>=s;){if(l[0][a]>l[1][a])return 1;if(l[0][a]===l[1][a]){if(a===s)return 0;a-=1}else if(l[0][a]<l[1][a])return-1}},e.map=function(e,t){var n,i=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)i.push(t(e[n]));return i},e.find=function(e,t){var n,i;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(n=0,i=e.length;n<i;n+=1){var r=e[n];if(t(r,n))return r}},e.assign=function(e){for(var t,n,i=e,r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];if(Object.assign)return Object.assign.apply(Object,[e].concat(o));var s=function(){var e=o[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){i[t]=e[t]}))};for(t=0,n=o.length;t<n;t+=1)s();return e},e.getBrowserAlias=function(e){return i.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return i.BROWSER_MAP[e]||""},e}();t.default=r,e.exports=t.default},18:function(e,t,n){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var i,r=(i=n(91))&&i.__esModule?i:{default:i},o=n(18);function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(){}var t,n,i;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new r.default(e,t)},e.parse=function(e){return new r.default(e).getResult()},t=e,i=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}],(n=null)&&a(t.prototype,n),i&&a(t,i),e}();t.default=s,e.exports=t.default},91:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var i=l(n(92)),r=l(n(93)),o=l(n(94)),a=l(n(95)),s=l(n(17));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=s.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=s.default.find(r.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=s.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=s.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return s.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,n={},i=0,r={},o=0;if(Object.keys(e).forEach((function(t){var a=e[t];"string"==typeof a?(r[t]=a,o+=1):"object"==typeof a&&(n[t]=a,i+=1)})),i>0){var a=Object.keys(n),l=s.default.find(a,(function(e){return t.isOS(e)}));if(l){var c=this.satisfies(n[l]);if(void 0!==c)return c}var u=s.default.find(a,(function(e){return t.isPlatform(e)}));if(u){var d=this.satisfies(n[u]);if(void 0!==d)return d}}if(o>0){var h=Object.keys(r),f=s.default.find(h,(function(e){return t.isBrowser(e,!0)}));if(void 0!==f)return this.compareVersion(r[f])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var n=this.getBrowserName().toLowerCase(),i=e.toLowerCase(),r=s.default.getBrowserTypeByAlias(i);return t&&r&&(i=r.toLowerCase()),i===n},t.compareVersion=function(e){var t=[0],n=e,i=!1,r=this.getBrowserVersion();if("string"==typeof r)return">"===e[0]||"<"===e[0]?(n=e.substr(1),"="===e[1]?(i=!0,n=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?n=e.substr(1):"~"===e[0]&&(i=!0,n=e.substr(1)),t.indexOf(s.default.compareVersions(r,n,i))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=c,e.exports=t.default},92:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var i,r=(i=n(17))&&i.__esModule?i:{default:i},o=/version\/(\d+(\.?_?\d+)+)/i,a=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},n=r.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||r.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},n=r.default.getFirstMatch(o,e)||r.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},n=r.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||r.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},n=r.default.getFirstMatch(o,e)||r.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},n=r.default.getFirstMatch(o,e)||r.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},n=r.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||r.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},n=r.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||r.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},n=r.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||r.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},n=r.default.getFirstMatch(o,e)||r.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},n=r.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||r.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},n=r.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||r.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},n=r.default.getFirstMatch(o,e)||r.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},n=r.default.getFirstMatch(o,e)||r.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},n=r.default.getFirstMatch(o,e)||r.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},n=r.default.getFirstMatch(o,e)||r.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},n=r.default.getFirstMatch(o,e)||r.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},n=r.default.getFirstMatch(o,e)||r.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},n=r.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||r.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=r.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||r.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},n=r.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},n=r.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},n=r.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},n=r.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},n=r.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},n=r.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},n=r.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},n=r.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},n=r.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},n=r.default.getFirstMatch(o,e)||r.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},n=r.default.getFirstMatch(o,e)||r.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},n=r.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},n=r.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||r.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},n=r.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||r.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},n=r.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},n=r.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},n=r.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},n=r.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||r.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},n=r.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},n=r.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t={name:"Android Browser"},n=r.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},n=r.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},n=r.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:r.default.getFirstMatch(t,e),version:r.default.getSecondMatch(t,e)}}}];t.default=a,e.exports=t.default},93:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var i,r=(i=n(17))&&i.__esModule?i:{default:i},o=n(18),a=[{test:[/Roku\/DVP/],describe:function(e){var t=r.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:o.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=r.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=r.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=r.default.getWindowsVersionName(t);return{name:o.OS_MAP.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:o.OS_MAP.iOS},n=r.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe:function(e){var t=r.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=r.default.getMacOSVersionName(t),i={name:o.OS_MAP.MacOS,version:t};return n&&(i.versionName=n),i}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=r.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t=r.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=r.default.getAndroidVersionName(t),i={name:o.OS_MAP.Android,version:t};return n&&(i.versionName=n),i}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=r.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:o.OS_MAP.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=r.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||r.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||r.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:o.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=r.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=r.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=r.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.PlayStation4,version:t}}}];t.default=a,e.exports=t.default},94:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var i,r=(i=n(17))&&i.__esModule?i:{default:i},o=n(18),a=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=r.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe:function(e){var t=r.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];t.default=a,e.exports=t.default},95:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var i,r=(i=n(17))&&i.__esModule?i:{default:i},o=n(18),a=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:o.ENGINE_MAP.Blink};var t=r.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:o.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:o.ENGINE_MAP.Trident},n=r.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:o.ENGINE_MAP.Presto},n=r.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe:function(e){var t={name:o.ENGINE_MAP.Gecko},n=r.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:o.ENGINE_MAP.WebKit},n=r.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}];t.default=a,e.exports=t.default}})},e=>{e.exports="\t\n\v\f\r  \u2028\u2029\ufeff"},(e,t,n)=>{"use strict";n.a(e,(async(e,i)=>{try{n.d(t,{a:()=>s,b:()=>u});n(14);var r=n(46),o=n(108),a=e([r]);async function s(e){if("string"==typeof e){if("createImageBitmap"in self){const t=(await(0,o.a)(e,"blob")).source;return await self.createImageBitmap(t)}if("Image"in self){if(Image.prototype.decode){const e=new Image;return await e.decode(),e}return await new Promise((t=>{const n=new Image;n.onload=()=>{t(n)},n.onerror=()=>{throw new Error("Not found image to ".concat(e))},n.src=e}))}}else{if(0===e.width||0===e.height)return null;if("OffscreenCanvas"in self&&e instanceof self.OffscreenCanvas)return e.transferToImageBitmap();if("HTMLCanvasElement"in self&&e instanceof self.HTMLCanvasElement){const t=await new Promise((t=>{e.toBlob((e=>{e instanceof Blob&&t(e)}))}));return await self.createImageBitmap(t)}}return null}const l=(0,(r=(a.then?(await a)():a)[0]).a)(0,0),c=l.getContext("2d");function u(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(0===e.width||0===e.height)return null;if("OffscreenCanvas"in self&&e instanceof OffscreenCanvas){if(!t)try{return e.transferToImageBitmap()}catch(e){}if(l instanceof OffscreenCanvas&&null!==c)return l.width===e.width&&l.height===e.height||(l.width=e.width,l.height=e.height),c.drawImage(e,0,0),l.transferToImageBitmap()}return e}i()}catch(d){i(d)}}))},(e,t,n)=>{"use strict";n.d(t,{a:()=>y,b:()=>E,c:()=>w,d:()=>b});n(1),n(2),n(47),n(61),n(49),n(50),n(51),n(240);var i=n(269),r=n(6);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class a{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];o(this,"position",void 0),o(this,"fix",new r.c(0,0,0)),o(this,"scale",void 0),o(this,"rotate",void 0),o(this,"isFixRotate",void 0),this.position=new r.c(e,t,n),this.scale=i,this.rotate=a,this.isFixRotate=s}}var s=n(268);class l{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;var t,n,i;i=void 0,(n="value")in(t=this)?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,this.value=e}}var c=n(35),u=n(82),d=n(65);function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class f{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;h(this,"data",void 0),h(this,"width",void 0),h(this,"height",void 0),h(this,"depth",void 0),this.data=e,this.width=0|t,this.height=0|n,this.depth=0|i}}class g{constructor(e){h(this,"maxTextureSize",void 0),h(this,"buffers",{}),this.maxTextureSize=e}get(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.buffers[e];return(0,d.d)()&&n.data.buffer instanceof self.SharedArrayBuffer||!t?n:new f((0,u.a)(n.data),n.width,n.height,n.depth)}has(e){return this.buffers.hasOwnProperty(e)}require(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const[o,a,s]=function(e,t){return[e%t,Math.max(1,Math.floor(e/t))%t,Math.min(t,Math.max(1,Math.floor(Math.floor(e/t)/t)))]}(n,this.maxTextureSize),l=o*a*s*i;return this.buffers.hasOwnProperty(e)&&this.buffers[e].data.length===l||(this.buffers[e]=new f((0,d.a)(t,l,r),o,a,s)),this.buffers[e]}}var p=n(159);function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){return e[t]}const _=16,y=14,b=21;class w{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;m(this,"setting",void 0),m(this,"buffers",void 0),m(this,"maxDrawDistance",void 0),m(this,"oldScene",null),this.setting=e,this.buffers=new g(t),this.maxDrawDistance=n}getClusterResolution(){return 16}lightCullingData(e,t){const n=e.getCamera(),o=e.getSun(),c=e.getMaterialManager().getMaterials(),u=new Array;let h=0;for(let e=0,o=0|t.length;e<o;e=e+1|0){var f;const o=t[e]||null;if(null===o)continue;const{position:g}=o,p=o.getComponent(s.a),m=c.indexOf(p.material)||0;if(m<=0)continue;let v=!1,y=0;const b=o.getComponent(a)||null;if(null!==b){if(!o.hasComponent(l))continue;const e=o.getComponent(a);if(o.getComponent(l).value!==n)continue;g.x=e.position.x*(e.position.z/n.hudFov),g.y=e.position.y*(e.position.z/n.hudFov),g.z=e.position.z,e.fix.x=e.position.x*(e.position.z/n.fov),e.fix.y=e.position.y*(e.position.z/n.fov),e.fix.z=e.position.z,p.scale=e.scale*(e.position.z/n.hudFov);const t=e.position.x*Math.abs(Math.sin(e.position.y*r.a));y=e.isFixRotate?(0,r.q)((Math.sin(t)+r.a*Math.sign(e.position.x)*(Math.abs(Math.max(0,.5-n.hudFov))/.25))*(Math.PI/16+Math.abs(Math.max(0,n.hudFov-.5))/.25*16)*(Math.abs(t)/.25)):0,p.rotate=e.rotate,v=!0}const w=o.getComponent(i.a),E=w.bottom*p.scale,x=g.x,O=g.y,T=g.z,[R,S,A]=v?(0,r.o)(n.direction.x,n.direction.y,x,O,T):[x,O,T],L=R+(v?n.position.x:0),M=S+(v?n.position.y:0)+E,P=A+(v?n.position.z:0),I=v?o.getComponent(a).position.z:(0,r.m)(L,M,P,n.position.x,n.position.y,n.position.z);if(I>this.maxDrawDistance)continue;const[F,C]=(0,r.k)(L,M,P,n.position.x,n.position.y,n.position.z),[D,N]=(0,r.f)(F,C,n.direction.x,n.direction.y);D>r.a&&N>r.a||((0,d.e)(u,_,h,0,I),(0,d.e)(u,_,h,1,g.x),(0,d.e)(u,_,h,2,g.y),(0,d.e)(u,_,h,3,g.z),(0,d.e)(u,_,h,4,E),(0,d.e)(u,_,h,5,p.scale),(0,d.e)(u,_,h,6,(null===(f=p.material)||void 0===f?void 0:f.bounding)||0),(0,d.e)(u,_,h,7,null!==b?b.fix.x:w.axes.x?1:0),(0,d.e)(u,_,h,8,null!==b?b.fix.y:w.axes.y?1:0),(0,d.e)(u,_,h,9,null!==b?b.fix.z:w.axes.z?1:0),(0,d.e)(u,_,h,10,(0,r.q)(p.rotate)),(0,d.e)(u,_,h,11,p.flip.x?-1:1),(0,d.e)(u,_,h,12,p.flip.y?-1:1),(0,d.e)(u,_,h,13,v?1:0),(0,d.e)(u,_,h,14,v?y:0),(0,d.e)(u,_,h,15,m),h++)}return{billboard_datas:new Float32Array(u),billboard_length:h,camera:{position:{x:n.position.x,y:n.position.y,z:n.position.z},direction:{x:n.direction.x,y:n.direction.y,z:n.direction.z},fov:n.fov,hudFov:n.hudFov,zoom:n.zoom,light:n.light},sun:{direction:{x:o.direction.x,y:o.direction.y}}}}buildMaterials(e,t,n){if(!n&&this.buffers.has("materials")&&!e.checkUpdate()&&!t.checkUpdate())return{materials:null};const i=[],r=t.getMaterials();for(const t in r){const n=Number(t);if(isNaN(n))continue;const o=r[n];i[n]=e.getBufferLocation(o.src,o.index)}const o=this.buffers.require("materials","int32",Math.max(1,i.length),1,!0);for(let e=0,t=0|i.length;e<t;e=e+1|0)o.data[e]=i[e]||0;return{materials:o}}buildVoxels(e,t,n){if(!n&&!t.checkUpdate()&&this.buffers.has("voxels"))return{voxels:null};const i=[],r=t.getVoxels();for(const t in r){const n=Number(t);if(isNaN(n))continue;const o=r[n];if(null===o)for(let e=0,t=0|b;e<t;e=e+1|0)i[n*b+e]=0;else{const t=e.getTileSet(),r=e.getMaterials();(0,d.e)(i,b,n,0,o.position.x),(0,d.e)(i,b,n,1,o.position.y),(0,d.e)(i,b,n,2,o.position.z),null!==t?((0,d.e)(i,b,n,3,Object.values(r).indexOf(v(t,o.front))),(0,d.e)(i,b,n,4,Object.values(r).indexOf(v(t,o.back))),(0,d.e)(i,b,n,5,Object.values(r).indexOf(v(t,o.right))),(0,d.e)(i,b,n,6,Object.values(r).indexOf(v(t,o.left))),(0,d.e)(i,b,n,7,Object.values(r).indexOf(v(t,o.top))),(0,d.e)(i,b,n,8,Object.values(r).indexOf(v(t,o.bottom)))):((0,d.e)(i,b,n,3,Object.values(r).indexOf(r.NONE)),(0,d.e)(i,b,n,4,Object.values(r).indexOf(r.NONE)),(0,d.e)(i,b,n,5,Object.values(r).indexOf(r.NONE)),(0,d.e)(i,b,n,6,Object.values(r).indexOf(r.NONE)),(0,d.e)(i,b,n,7,Object.values(r).indexOf(r.NONE)),(0,d.e)(i,b,n,8,Object.values(r).indexOf(r.NONE))),(0,d.e)(i,b,n,9,o.flipXFront?-1:1),(0,d.e)(i,b,n,10,o.flipYFront?-1:1),(0,d.e)(i,b,n,11,o.flipXBack?-1:1),(0,d.e)(i,b,n,12,o.flipYBack?-1:1),(0,d.e)(i,b,n,13,o.flipXRight?-1:1),(0,d.e)(i,b,n,14,o.flipYRight?-1:1),(0,d.e)(i,b,n,15,o.flipXLeft?-1:1),(0,d.e)(i,b,n,16,o.flipYLeft?-1:1),(0,d.e)(i,b,n,17,o.flipXTop?-1:1),(0,d.e)(i,b,n,18,o.flipYTop?-1:1),(0,d.e)(i,b,n,19,o.flipXBottom?-1:1),(0,d.e)(i,b,n,20,o.flipYBottom?-1:1)}}const o=this.buffers.require("voxels","float32",Math.max(b,i.length),1,!0);for(let e=0,t=0|i.length;e<t;e=e+1|0)o.data[e]=i[e]||0;return{voxels:o}}getMaxDrawDistance(){return this.maxDrawDistance}setMaxDrawDistance(e){this.maxDrawDistance=e}createData(e,t,n,i){const r=e.getRendererManager(),o=e.getMaterialManager(),a=e.getVoxelManager(),s=this.oldScene!==e.getName()||i;this.oldScene=e.getName();const l=e.getMap(),c=e.getLateTime(),[u,h]=r.getSize(),[f,g]=[this.getClusterResolution(),this.getClusterResolution()];let p=null,m=null,v=null,_=0;const y=[];if(n){const{camera:n,sun:i,billboard_datas:r,billboard_length:o}=this.lightCullingData(e,t);p=n,m=i,v=r,_=o,y.push(r.buffer)}const{materials:b}=this.buildMaterials(e.getAssetManager(),o,s),{voxels:w}=this.buildVoxels(e,a,s),E=e.getBackground(),x=l.checkUpdate(),O=l.getVoxelField(),T=l.getDistanceField();return(0,d.d)()||(null!==b&&y.push(b.data.buffer),null!==w&&y.push(w.data.buffer)),[{camera:p,sun:m,voxel_field:{width:l.getSize()[0],height:l.getSize()[1],depth:l.getSize()[2],distance:l.getWorldDistance(),data:x||s?O:null},distance_field:{width:l.getSize()[0],height:l.getSize()[1],depth:l.getSize()[2],data:x||s?T:null},materials:b,voxels:w,resolution:{width:u,height:h},cluster_resolution:{width:f,height:g},billboard_datas:v,billboard_length:_,background:E,lateTime:c},y]}}class E{constructor(e){m(this,"buffers",void 0),m(this,"clusterAABBs",new Array),m(this,"clusterBoxX",0),m(this,"clusterBoxY",0),m(this,"clusterWidth",0),m(this,"clusterHeight",0),this.buffers=new g(e)}frustumCullingData(e,t,n,i,o){const{clusterWidth:a,clusterHeight:s,clusterAABBs:l,clusterBoxX:u,clusterBoxY:h}=this,f=e/Math.min(e,t),g=t/Math.min(e,t),m=n.fov*n.zoom,v=n.hudFov*n.zoom,y=[...new Array(a*s)].map((()=>[])),b=new Array,w=u*f,E=h*g,[x,O,T,R,S,A,L,M,P]=(0,r.i)(n.direction.x,n.direction.y,m);let I=0;const F=new Array;for(let e=0,t=0|o;e<t;e=e+1|0){const t=(0,d.c)(i,_,e,0),n=(0,d.c)(i,_,e,1),r=(0,d.c)(i,_,e,2),o=(0,d.c)(i,_,e,3),a=(0,d.c)(i,_,e,4),s=(0,d.c)(i,_,e,5),l=(0,d.c)(i,_,e,6),c=(0,d.c)(i,_,e,7),u=(0,d.c)(i,_,e,8),h=(0,d.c)(i,_,e,9),f=(0,d.c)(i,_,e,10),g=(0,d.c)(i,_,e,11),p=(0,d.c)(i,_,e,12),m=!!(0,d.c)(i,_,e,13),v=(0,d.c)(i,_,e,14),y=(0,d.c)(i,_,e,15);F.push({distance:t,entity:{x:n,y:r,z:o,spriteY:a,scale:s,bounding:l,axesX:c,axesY:u,axesZ:h,rotate:f,flipX:g,flipY:p,isHUD:m,fixRotate:v,material:y}})}F.length>1&&(0,c.c)(F).asc((e=>e.distance));for(let e=0,t=0|F.length;e<t;e=e+1|0){const t=F[e]&&F[e].entity||null;if(null===t)continue;const{x:i,y:o,z:c,spriteY:u,scale:d,bounding:h,axesX:_,axesY:C,axesZ:D,rotate:N,flipX:k,flipY:B,isHUD:U,fixRotate:z,material:G}=t,[X,H,V]=U?(0,r.o)(n.direction.x,n.direction.y,i,o,c):[i,o,c],Y=X+(U?n.position.x:0),j=H+(U?n.position.y:0)+u,W=V+(U?n.position.z:0),[q,Z,K]=(0,r.r)(n.position.x,n.position.y,n.position.z,Y,j,W,d*h,x,O,T,R,S,A,L,M,P,n.direction.z,U?v:m),J=Math.floor(Math.min(a*w,Math.max(0,q+a*w/2-K))/w),Q=Math.floor(Math.min(s*E,Math.max(0,Z+s*E/2-K))/E),$=Math.floor(Math.min(a*w,Math.max(0,q+a*w/2+K))/w),ee=Math.floor(Math.min(s*E,Math.max(0,Z+s*E/2+K))/E),te=Math.min(J,$),ne=Math.min(Q,ee),ie=Math.max(J,$),re=Math.max(Q,ee);if(ie<0||re<0||te>=a||ne>=s)continue;let oe=!1;for(let e=0|ne,t=re+1|0;e<t;e=e+1|0)for(let t=0|te,n=ie+1|0;t<n;t=t+1|0){if(t<0||e<0||t>=a||e>=s)continue;const n=e*a+t|0,i=l[2*n]*f,r=l[2*n+1]*g;if(!(0,p.e)(q,Z,K,i,r,w,E))continue;const o=y[n]||null;null!==o&&(o.push(I),oe=!0)}oe&&(b.push(i,o+u,c,d,h,_,C,D,N,k,B,U?1:0,z,G),I++)}return{bind_entitys:b,cullings:y}}buildEntitys(e){const t=this.buffers.require("billboard_transfer_parameters","float32",Math.max(y,e.length),1,!0);return t.data.set(e),{billboard_parameters:t}}buildCullingData(e){const t=this.buffers.require("cluster_list","int32",Math.max(1,e.length),1,!0),n=this.buffers.require("item_list","int32",Math.max(1,e.reduce(((e,t)=>e+t.length),0)),1,!0);for(let i=0,r=0|e.length;i<r;i=i+1|0){const r=e[i],o=i>0?t.data[i-1]:0;t.data[i]=o+r.length;for(let e=0,t=0|r.length;e<t;e=e+1|0)n.data[o+e]=r[e]}return{cluster_list:t,item_list:n}}createData(e){const{width:t,height:n}=e.resolution,{width:i,height:o}=e.cluster_resolution;if(this.clusterWidth!==i||this.clusterWidth!==o){const[e,t,n]=(0,r.e)(i,o,this.buffers.require("frustum","float32",i,2*o).data);this.clusterAABBs=e,this.clusterBoxX=t,this.clusterBoxY=n,this.clusterWidth=i,this.clusterHeight=o}let a=null,s=null,l=null;if(null!==e.camera&&null!==e.billboard_datas){const{bind_entitys:i,cullings:r}=this.frustumCullingData(t,n,e.camera,e.billboard_datas,e.billboard_length),{billboard_parameters:o}=this.buildEntitys(i),{cluster_list:c,item_list:u}=this.buildCullingData(r);a=o,s=c,l=u}return{billboard_parameters:a,cluster_list:s,item_list:l}}}},function(e,t,n){e.exports=function(){"use strict";var e=Function.prototype.toString,t=Object.create,i=Object.defineProperty,r=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,a=Object.getOwnPropertySymbols,s=Object.getPrototypeOf,l=Object.prototype,c=l.hasOwnProperty,u=l.propertyIsEnumerable,d="function"==typeof a,h="function"==typeof WeakMap,f=function(){if(h)return function(){return new WeakMap};var e=function(){function e(){this._keys=[],this._values=[]}return e.prototype.has=function(e){return!!~this._keys.indexOf(e)},e.prototype.get=function(e){return this._values[this._keys.indexOf(e)]},e.prototype.set=function(e,t){this._keys.push(e),this._values.push(t)},e}();return function(){return new e}}(),g=function(n,i){var r=n.__proto__||s(n);if(!r)return t(null);var o=r.constructor;if(o===i.Object)return r===i.Object.prototype?{}:t(r);if(~e.call(o).indexOf("[native code]"))try{return new o}catch(e){}return t(r)},p=function(e,t,n,i){var r=g(e,t);for(var o in i.set(e,r),e)c.call(e,o)&&(r[o]=n(e[o],i));if(d)for(var s=a(e),l=0,h=s.length,f=void 0;l<h;++l)f=s[l],u.call(e,f)&&(r[f]=n(e[f],i));return r},m=function(e,t,n,s){var l=g(e,t);s.set(e,l);for(var c=d?o(e).concat(a(e)):o(e),u=0,h=c.length,f=void 0,p=void 0;u<h;++u)if("callee"!==(f=c[u])&&"caller"!==f)if(p=r(e,f)){p.get||p.set||(p.value=n(e[f],s));try{i(l,f,p)}catch(e){l[f]=p.value}}else l[f]=n(e[f],s);return l},v=function(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},_=Array.isArray,y=Object.getPrototypeOf,b=function(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:(console&&console.error&&console.error('Unable to locate global object, returning "this".'),this)}();function w(e,t){var n=!(!t||!t.isStrict),i=t&&t.realm||b,r=n?m:p,o=function(e,t){if(!e||"object"!=typeof e)return e;if(t.has(e))return t.get(e);var a,s=e.__proto__||y(e),l=s&&s.constructor;if(!l||l===i.Object)return r(e,i,o,t);if(_(e)){if(n)return m(e,i,o,t);a=new l,t.set(e,a);for(var c=0,u=e.length;c<u;++c)a[c]=o(e[c],t);return a}if(e instanceof i.Date)return new l(e.getTime());if(e instanceof i.RegExp)return(a=new l(e.source,e.flags||v(e))).lastIndex=e.lastIndex,a;if(i.Map&&e instanceof i.Map)return a=new l,t.set(e,a),e.forEach((function(e,n){a.set(n,o(e,t))})),a;if(i.Set&&e instanceof i.Set)return a=new l,t.set(e,a),e.forEach((function(e){a.add(o(e,t))})),a;if(i.Blob&&e instanceof i.Blob)return e.slice(0,e.size,e.type);if(i.Buffer&&i.Buffer.isBuffer(e))return a=i.Buffer.allocUnsafe?i.Buffer.allocUnsafe(e.length):new l(e.length),t.set(e,a),e.copy(a),a;if(i.ArrayBuffer){if(i.ArrayBuffer.isView(e))return a=new l(e.buffer.slice(0)),t.set(e,a),a;if(e instanceof i.ArrayBuffer)return a=e.slice(0),t.set(e,a),a}return"function"==typeof e.then||e instanceof Error||i.WeakMap&&e instanceof i.WeakMap||i.WeakSet&&e instanceof i.WeakSet?e:r(e,i,o,t)};return o(e,f())}return w.default=w,w.strict=function(e,t){return w(e,{isStrict:!0,realm:t?t.realm:void 0})},w}()},(e,t,n)=>{"use strict";var i=n(78),r=n(8),o=n(3),a=n(103),s=n(4),l=n(10),c=n(5),u=n(37),d=n(31),h=n(16),f=n(29),g=n(104),p=n(40),m=n(199),v=n(106),_=n(7)("replace"),y=Math.max,b=Math.min,w=o([].concat),E=o([].push),x=o("".indexOf),O=o("".slice),T="$0"==="a".replace(/./,"$0"),R=!!/./[_]&&""===/./[_]("a","$0");a("replace",(function(e,t,n){var o=R?"$":"$0";return[function(e,n){var i=f(this),o=null==e?void 0:p(e,_);return o?r(o,e,i,n):r(t,h(i),e,n)},function(e,r){var a=l(this),s=h(e);if("string"==typeof r&&-1===x(r,o)&&-1===x(r,"$<")){var f=n(t,a,s,r);if(f.done)return f.value}var p=c(r);p||(r=h(r));var _=a.global;if(_){var T=a.unicode;a.lastIndex=0}for(var R=[];;){var S=v(a,s);if(null===S)break;if(E(R,S),!_)break;""===h(S[0])&&(a.lastIndex=g(s,d(a.lastIndex),T))}for(var A,L="",M=0,P=0;P<R.length;P++){for(var I=h((S=R[P])[0]),F=y(b(u(S.index),s.length),0),C=[],D=1;D<S.length;D++)E(C,void 0===(A=S[D])?A:String(A));var N=S.groups;if(p){var k=w([I],C,F,s);void 0!==N&&E(k,N);var B=h(i(r,void 0,k))}else B=m(I,s,F,C,N,r);F>=M&&(L+=O(s,M,F)+B,M=F+I.length)}return L+O(s,M)}]}),!!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!T||R)},(e,t,n)=>{"use strict";n.a(e,(async(e,i)=>{try{n.d(t,{a:()=>h,b:()=>f,c:()=>g,d:()=>x,e:()=>T,f:()=>O,g:()=>w});n(20),n(21),n(203),n(1),n(2);var r=n(46),o=n(206),a=e([r]);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}r=(a.then?(await a)():a)[0];const l=(0,r.a)(0,0).getContext("webgl2"),c=null===l?null:l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic");class u{constructor(e,t){s(this,"init",!1),s(this,"old_width",0),s(this,"old_height",0),s(this,"old_depth",0),s(this,"old_attachment",{}),s(this,"color_buller_float",null),s(this,"level",0),s(this,"auto_resolution_fix",void 0),s(this,"dimension",void 0),s(this,"texture_type",void 0),s(this,"texture",void 0),s(this,"tex",void 0),s(this,"iformat",void 0),s(this,"format",void 0),s(this,"type",void 0);const n=t.width,i=t.hasOwnProperty("height")?t.height||0:null,r=t.hasOwnProperty("depth")?t.depth||0:null;let o=!1,a=0,l=null;if(t.hasOwnProperty("attachment"))a=2,l=e.TEXTURE_2D,null!==n&&null!==i||(o=!0);else switch(!0){case null===i:a=1,l=e.TEXTURE_1D;break;case null===r:a=2,l=e.TEXTURE_2D;break;default:a=3,l=e.TEXTURE_2D_ARRAY}let c=null,u=null,d=null;switch(t.format){case 1:switch(t.type){case"8i":c=e.INT,u=e.R8I,d=e.RED_INTEGER;break;case"8ui":c=e.UNSIGNED_BYTE,u=e.R8UI,d=e.RED_INTEGER;break;case"16i":c=e.INT,u=e.R16I,d=e.RED_INTEGER;break;case"16ui":c=e.UNSIGNED_BYTE,u=e.R16UI,d=e.RED_INTEGER;break;case"16f":c=e.HALF_FLOAT,u=e.R16F,d=e.RED;break;case"32i":c=e.INT,u=e.R32I,d=e.RED_INTEGER;break;case"32ui":c=e.UNSIGNED_BYTE,u=e.R32UI,d=e.RED_INTEGER;break;case"32f":c=e.FLOAT,u=e.R32F,d=e.RED;break;case"int":c=e.INT,u=e.RED,d=e.RED;break;default:case"uint":c=e.UNSIGNED_BYTE,u=e.RED,d=e.RED;break;case"float":c=e.FLOAT,u=e.RED,d=e.RED}break;case 2:switch(t.type){case"8i":c=e.INT,u=e.RG8I,d=e.RG_INTEGER;break;case"8ui":c=e.UNSIGNED_BYTE,u=e.RG8UI,d=e.RG_INTEGER;break;case"16i":c=e.INT,u=e.RG16I,d=e.RG_INTEGER;break;case"16ui":c=e.UNSIGNED_BYTE,u=e.RG16UI,d=e.RG_INTEGER;break;case"16f":c=e.HALF_FLOAT,u=e.RG16F,d=e.RG;break;case"32i":c=e.INT,u=e.RG32I,d=e.RG_INTEGER;break;case"32ui":c=e.UNSIGNED_BYTE,u=e.RG32UI,d=e.RG_INTEGER;break;case"32f":c=e.FLOAT,u=e.RG32F,d=e.RG;break;case"int":c=e.INT,u=e.RG,d=e.RG;break;default:case"uint":c=e.UNSIGNED_BYTE,u=e.RG,d=e.RG;break;case"float":c=e.FLOAT,u=e.RG,d=e.RG}break;case 3:switch(t.type){case"8i":c=e.INT,u=e.RGB8I,d=e.RGB_INTEGER;break;case"8ui":c=e.UNSIGNED_BYTE,u=e.RGB8UI,d=e.RGB_INTEGER;break;case"16i":c=e.INT,u=e.RGB16I,d=e.RGB_INTEGER;break;case"16ui":c=e.UNSIGNED_BYTE,u=e.RGB16UI,d=e.RGB_INTEGER;break;case"16f":c=e.HALF_FLOAT,u=e.RGB16F,d=e.RGB;break;case"32i":c=e.INT,u=e.RGB32I,d=e.RGB_INTEGER;break;case"32ui":c=e.UNSIGNED_BYTE,u=e.RGB32UI,d=e.RGB_INTEGER;break;case"32f":c=e.FLOAT,u=e.RGB32F,d=e.RGB;break;case"int":c=e.INT,u=e.RGB,d=e.RGB;break;default:case"uint":c=e.UNSIGNED_BYTE,u=e.RGB,d=e.RGB;break;case"float":c=e.FLOAT,u=e.RGB,d=e.RGB}break;default:switch(t.type){case"8i":c=e.INT,u=e.RGBA8I,d=e.RGBA_INTEGER;break;case"8ui":c=e.UNSIGNED_BYTE,u=e.RGBA8UI,d=e.RGBA_INTEGER;break;case"16i":c=e.INT,u=e.RGBA16I,d=e.RGBA_INTEGER;break;case"16ui":c=e.UNSIGNED_BYTE,u=e.RGBA16UI,d=e.RGBA_INTEGER;break;case"16f":c=e.HALF_FLOAT,u=e.RGBA16F,d=e.RGBA;break;case"32i":c=e.INT,u=e.RGBA32I,d=e.RGBA_INTEGER;break;case"32ui":c=e.UNSIGNED_BYTE,u=e.RGBA32UI,d=e.RGBA_INTEGER;break;case"32f":c=e.FLOAT,u=e.RGBA32F,d=e.RGBA;break;case"int":c=e.INT,u=e.RGBA,d=e.RGBA;break;default:case"uint":c=e.UNSIGNED_BYTE,u=e.RGBA,d=e.RGBA;break;case"float":c=e.FLOAT,u=e.RGBA,d=e.RGBA}}const h=t.data instanceof WebGLTexture?t.data:e.createTexture();if(null===h)throw new Error("");this.auto_resolution_fix=o,this.dimension=a,this.texture_type=l,this.texture=h,this.tex=t,this.iformat=u,this.format=d,this.type=c}}class d{constructor(e,t,n){s(this,"id",void 0),s(this,"buffer",void 0),s(this,"screen",void 0),s(this,"resolution",void 0),s(this,"viewport",void 0),s(this,"textures",new Array),s(this,"attachs",new Array),s(this,"width",-1),s(this,"height",-1),s(this,"screen_texture",null),s(this,"attachScreenUniform",!1),s(this,"isScreenBuffer",!1),this.id=t,this.buffer=e.createFramebuffer(),e.useProgram(n),this.screen=e.getUniformLocation(n,"screen"),this.resolution=e.getUniformLocation(n,"resolution"),this.viewport=e.getUniformLocation(n,"viewport"),e.useProgram(null)}}const h=null===l?0:l.MAX_TEXTURE_SIZE,f=null===l?0:l.MAX_3D_TEXTURE_SIZE;null===l||l.MAX_COLOR_ATTACHMENTS,null!==l&&null!==c&&l.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT);class g{constructor(e,t,n){s(this,"id",void 0),s(this,"vertex",void 0),s(this,"fragment",void 0),s(this,"textureMipMapGeneraters",new Array),s(this,"has_init",!1),s(this,"program",null),s(this,"frame",null),s(this,"uniforms",null),s(this,"gl",null),this.id=e,this.vertex=t,this.fragment=n}initProgram(e){const{vertex:t,fragment:n}=this;this.program=y(e,t,n)}init(e,t){this.program&&(this.has_init=!0,this.gl=e,this.frame=new d(e,this.id,this.program),this.uniforms=b(e,this.program,t))}hasInit(){return this.has_init}getID(){return this.id}getProgram(){if(null===this.program)throw new Error("");return this.program}getFrame(){if(null===this.frame)throw new Error("");return this.frame}getUniforms(){if(null===this.uniforms)throw new Error("");return this.uniforms}addTextureMipMapGenerater(e){this.textureMipMapGeneraters.push(e)}execTextureMipMapGenerators(){for(;this.textureMipMapGeneraters.length>0;){var e;null===(e=this.textureMipMapGeneraters.shift())||void 0===e||e.call(null)}}destroy(){const{gl:e,program:t,frame:n}=this;if(null!==e){if(null!==n){e.deleteFramebuffer(n.buffer),null!==n.screen_texture&&e.deleteTexture(n.screen_texture);for(let t=0,i=0|n.textures.length;t<i;t=t+1|0)e.deleteTexture(n.textures[t])}t&&e.deleteProgram(t)}}}function p(e){const t=e.createProgram();if(null===t)throw new Error("");return t}function m(e,t,n,i){const r=e.createShader(n);if(null===r)throw new Error("Can't create shader.");if(e.shaderSource(r,i),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){const t=e.getShaderInfoLog(r);throw e.deleteShader(r),t}return e.attachShader(t,r),e.deleteShader(r),r}function v(e,t,n){return m(e,t,e.VERTEX_SHADER,n)}function _(e,t,n){return m(e,t,e.FRAGMENT_SHADER,n)}function y(e,t,n){const i=p(e),r=v(e,i,t),o=_(e,i,n);if(e.linkProgram(i),!e.getProgramParameter(i,e.LINK_STATUS)){const t=e.getProgramInfoLog(i);throw e.deleteShader(r),e.deleteShader(o),e.deleteProgram(i),t}return i}function b(e,t,n){const i={};e.useProgram(t);for(let r in n){const n=e.getUniformLocation(t,r);null!==n&&(i[r]={location:n})}return e.useProgram(null),i}function w(e,t){const n={};for(const i in t){const r=t[i];n[i]=new u(e,r)}return n}function E(e,t,n,i,r){const{old_width:o,old_height:a,old_depth:s,auto_resolution_fix:l,dimension:c,texture_type:u,iformat:d,format:h,type:f}=n;let{texture:g}=n,p=t.width,m=t.hasOwnProperty("height")?t.height||0:null,v=t.hasOwnProperty("depth")?t.depth||0:null;t.data instanceof WebGLTexture&&(g=t.data);const _=!!t.data&&!t.data.hasOwnProperty("length")&&t.data!==t.old_data,y=!n.init||!!t.sync||!!t.generateMipmap||_;if(t.old_data=t.data,e.bindTexture(u,g),y||l){l&&(p=0|e.canvas.width,m=0|e.canvas.height);const b=p!==o||null!==m&&m!==a||null!==v&&v!==s;if(y||!l||b){if(!(t.data instanceof WebGLTexture)){e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flip_y||!1),e.pixelStorei(e.UNPACK_ALIGNMENT,t.aligment||1);const i=t.level||0;if(!n.init||b||_)switch(c){case 1:e.texImage2D(u,i,d,p,1,0,h,f,t.data||null);break;case 2:null!==m&&e.texImage2D(u,i,d,p,m,0,h,f,t.data||null);break;case 3:null!==m&&null!==v&&e.texImage3D(u,i,d,p,m,v,0,h,f,t.data||null)}else if(t.data)switch(c){case 1:e.texSubImage2D(u,i,0,0,p,1,h,f,t.data||null);break;case 2:null!==m&&e.texSubImage2D(u,i,0,0,p,m,h,f,t.data||null);break;case 3:null!==m&&null!==v&&e.texSubImage3D(u,i,0,0,0,p,m,v,h,f,t.data||null)}let r=e.CLAMP_TO_EDGE;switch(t.wrap){case"clamp":r=e.CLAMP_TO_EDGE;break;case"repeat":r=e.REPEAT;break;case"mirror":r=e.MIRRORED_REPEAT}e.texParameteri(u,e.TEXTURE_WRAP_S,r),e.texParameteri(u,e.TEXTURE_WRAP_T,r);let o=!1;if(t.anisotropic){const n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");n&&(e.texParameterf(e.TEXTURE_2D,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT),t.anisotropic)),o=!0)}if(!o){let n=e.NEAREST;switch(t.mag){case"nearest":n=e.NEAREST;break;case"linear":n=e.LINEAR}let i=t.mipmap?e.NEAREST_MIPMAP_LINEAR:e.NEAREST;switch(t.min){case"nearest":i=t.mipmap?"linear"===t.mag?e.LINEAR_MIPMAP_NEAREST:e.NEAREST_MIPMAP_NEAREST:e.NEAREST;break;case"linear":i=t.mipmap?"linear"===t.mag?e.LINEAR_MIPMAP_LINEAR:e.NEAREST_MIPMAP_LINEAR:e.LINEAR}e.texParameteri(u,e.TEXTURE_MAG_FILTER,n),e.texParameteri(u,e.TEXTURE_MIN_FILTER,i)}}if(t.hasOwnProperty("attachment"))for(let o=0,a=0|i.length;o<a;o=o+1|0){const a=i[o]||null;if(null===a)continue;const s=a.getID(),l=(null==t?void 0:t.attachment)||{},c=l.hasOwnProperty(s)?l[s]||0:null;if(null===c)continue;const d=a.getFrame();0===c&&(d.isScreenBuffer=!1,n.init=!1);const h=e["COLOR_ATTACHMENT".concat(c)],{buffer:v,attachs:_,textures:y}=d,b=r[s]||{width:p,height:m};if(null===n.color_buller_float&&(f===e.FLOAT||f===e.HALF_FLOAT)&&(n.color_buller_float=e.getExtension("EXT_color_buffer_float")||null,null===n.color_buller_float))throw new Error("Not supported color buffer float.");e.bindFramebuffer(e.FRAMEBUFFER,v),n.init||(e.framebufferTexture2D(e.FRAMEBUFFER,h,u,g,0),_.includes(h)||_.push(h),y.push(g)),null!==m&&(e.viewport(0,0,b.width||p,b.height||m),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT)),e.bindFramebuffer(e.FRAMEBUFFER,null)}}e.bindTexture(u,null),n.init=!0,n.old_width=0|p,n.old_height=0|(m||1),n.old_depth=0|(v||1)}function b(){if(e.bindTexture(u,g),t.mipmap&&t.generateMipmap){if(null===n.color_buller_float&&(f===e.FLOAT||f===e.HALF_FLOAT)&&(n.color_buller_float=e.getExtension("EXT_color_buffer_float")||null,null===n.color_buller_float))throw new Error("Not supported color buffer float.");e.generateMipmap(u)}e.bindTexture(u,null)}let w=!1;if(t.attachment&&t.generateMipmap){const e=Object.keys(t.attachment);for(let t=0,n=0|i.length;t<n;t=t+1|0){const n=i[t];e.includes(n.getID())&&(n.addTextureMipMapGenerater(b),w=!0)}}return w||b(),!0}function x(e,t,n,i,r){for(const o in n){E(e,t[parseInt(o)],n[o],i,r)}}function O(e,t,n){for(var i=arguments.length,r=new Array(i>3?i-3:0),o=3;o<i;o++)r[o-3]=arguments[o];e["uniform".concat(n)](t,...r)}function T(e,t,n,i,r,a){let s=0;for(const l in t){const{location:c}=t[l],u=n[l],d=i[l];if(void 0!==u&&(!u.program||u.program.includes(a))&&c)if(u.hasOwnProperty("unit")){if(!r.hasOwnProperty(u.unit))continue;const{texture:t,texture_type:n}=r[u.unit];e.activeTexture(e["TEXTURE".concat(s)]),e.bindTexture(n,t),O(e,c,"1i",s),s++}else(void 0===d||(0,o.a)(u.value,d.value))&&O(e,c,u.type,...u.value)}return s}i()}catch(R){i(R)}}))},(e,t,n)=>{"use strict";n.d(t,{a:()=>h,b:()=>l,c:()=>s,d:()=>o,e:()=>a});n(1),n(2);var i=n(53),r=n(6);function o(e,t,n,i,o,a,s,l){if(e|=0,n|=0,o+l>(t|=0)&&o<t+1){const t=s/2;if((i+t>e||i-t<e+1)&&(a+t>n||a-t<n+1)){const o=e,s=n,l=e+1,c=n,u=e,d=n+1,h=e+1,f=n+1;return i<o&&a<s?(0,r.l)(i,a,o,s)<t:i>l&&a<c?(0,r.l)(i,a,l,c)<t:i<u&&a>d?(0,r.l)(i,a,u,d)<t:!(i>h&&a>f)||(0,r.l)(i,a,h,f)<t}}return!1}function a(e,t,n,i,o,a,s){const l=Math.max(0,Math.abs(e-i)-a/2),c=Math.max(0,Math.abs(t-o)-s/2);return(0,r.n)(l,c,l,c)<=n*n}function s(e,t,n,i,o,a,s,l,c,u){const[d,h,f,g,p,m]=function(e,t,n,i,o,a,s,l,c,u){if(t<s+u&&t+o>s||s<t+o&&s+u>t){const[d,h,f,g]=function(e,t,n,i,o,a){let[s,l]=(0,r.s)(e,t,i,o),c=Math.sqrt(s*s+l*l);let u=n/2+a/2-c;if(u<=0)return[0,0,0,0];c>0&&(c=1/c);return s*=c,l*=c,u/=2,[s*u,l*u,-s*u,-l*u]}(e,n,i,a,l,c),p=0!==d||0!==h||0!==f||0!==g?s-t>u/.5?t-(s+u):s-(t+o):0;return[d,p/2,h,f,-p/2,g]}return[0,0,0,0,0,0]}(e,t,n,i,o,a,s,l,c,u);return 0!==d||0!==h||0!==f||0!==g||0!==p||0!==m}function l(e,t,n,r,o){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:()=>!1;const s=(0,i.c)(e,t,n,r,o);for(let e=0,t=0|s.length;e<t;e=e+3|0){if(a("type",s[e],s[e+1],s[e+2]))return!0}return!1}function c(e,t,n,i,r,o,a,s,l){return(e-i)*(a-i)+(t-r)*(s-r)+(n-o)*(l-o)}function u(e,t,n,i,o,a,s,l,c,u){let d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:new r.c(0,0,0),h=arguments.length>11&&void 0!==arguments[11]?arguments[11]:new r.c(0,0,0);const f=i*i+o*o+a*a,g=i*(s-=e)+o*(l-=t)+a*(c-=n),p=s*s+l*l+c*c-u*u;if(0===f)return!1;let m=g*g-f*p;if(m<0)return!1;m=Math.sqrt(m);const v=(g-m)/f,_=(g+m)/f;return!(v<0||_<0)&&(d.x=e+v*i,d.y=t+v*o,d.z=n+v*a,h.x=e+_*i,h.y=t+_*o,h.z=n+_*a,!0)}function d(e,t,n,i,o,a,s,l,c,u,d,h,f){let g=arguments.length>13&&void 0!==arguments[13]?arguments[13]:new r.c(0,0,0),p=arguments.length>14&&void 0!==arguments[14]?arguments[14]:new r.c(0,0,0);const m=s-e,v=l-t,_=c-n,y=(u-=e)-m,b=(d-=t)-v,w=(h-=n)-_,E=i*i+o*o+a*a,x=y*i+b*o+w*a,O=m*i+v*o+_*a,T=y*y+b*b+w*w,R=m*y+v*b+_*w,S=m*m+v*v+_*_,A=f*f;if(0===T)return!1;const L=E-x*x/T,M=O-R*x/T,P=S-R*R/T-A;if(0===L)return!1;let I=M*M-L*P;if(I<0)return!1;I=Math.sqrt(I);const F=(M-I)/L,C=(M+I)/L;return g.x=e+F*i,g.y=t+F*o,g.z=n+F*a,p.x=e+C*i,p.y=t+C*o,p.z=n+C*a,!0}function h(e,t,n,i,o,a,s,l,h,f,g,p){const[m,v,_]=(0,r.p)(i,o),y=new r.c(-1,-1,-1),b=new r.c(-1,-1,-1);f-=p/=2;let w=!1,E=!1,x=!1;if(!0===u(e,t,n,m,v,_,a,s+=p,l,p,y,b)&&c(h,f,g,a,s,l,y.x,y.y,y.z)<=0)w=!0;else if(!0===u(e,t,n,m,v,_,h,f,g,p,y,b)&&c(a,s,l,h,f,g,y.x,y.y,y.z)<=0)E=!0;else{if(!(!0===d(e,t,n,m,v,_,a,s,l,h,f,g,p,y,b)&&c(a,s,l,h,f,g,y.x,y.y,y.z)>0&&c(h,f,g,a,s,l,y.x,y.y,y.z)>0))return[-1,-1,-1,-1,-1,-1];x=!0}const O=new r.c(0,0,0);return w&&c(h,f,g,a,s,l,b.x,b.y,b.z)<=0||E&&c(a,s,l,h,f,g,b.x,b.y,b.z)<=0||x&&c(a,s,l,h,f,g,b.x,b.y,b.z)>0&&c(h,f,g,a,s,l,b.x,b.y,b.z)>0||!0===u(e,t,n,m,v,_,a,s,l,p,O,b)&&c(h,f,g,a,s,l,b.x,b.y,b.z)<=0||!0===u(e,t,n,m,v,_,h,f,g,p,O,b)&&c(a,s,l,h,f,g,b.x,b.y,b.z)<=0||d(e,t,n,m,v,_,a,s,l,h,f,g,p,O,b),[y.x,y.y,y.z,b.x,b.y,b.z]}},(e,t,n)=>{"use strict";n.a(e,(async(e,i)=>{try{n.d(t,{a:()=>d,b:()=>g,c:()=>f});var r=n(278),o=n(207),a=n(249),s=n(208),l=n(250),c=n(279),u=e([o,s]);[o,s]=u.then?(await u)():u;new s.a("./asset/font.png"),new s.a("./asset/icon.png"),new s.a("./asset/key.png"),new s.a("./asset/horde_badge.png"),new s.a("./asset/title-prod.png"),new s.a("./asset/title-demo.png"),new s.a("./asset/how_to_play_keyboard.png"),new s.a("./asset/how_to_play_gamepad.png"),new s.a("./asset/memberscard/members.png"),new s.a("./asset/memberscard/silver.png"),new s.a("./asset/memberscard/gold.png"),new s.a("./asset/memberscard/platinum.png"),new s.a("./asset/memberscard/diamond.png");const d=[new o.a("./asset/wall/metal.albedo.png","./asset/wall/metal.pbr.png","./asset/wall/metal.normal.png"),new o.a("./asset/wall/ruins.albedo.png","./asset/wall/ruins.pbr.png","./asset/wall/ruins.normal.png"),new o.a("./asset/hud/hand.albedo.png","./asset/hud/hand.pbr.png","./asset/hud/hand.normal.png"),new o.a("./asset/hud/foot.albedo.png","./asset/hud/foot.pbr.png","./asset/hud/foot.normal.png"),new o.a("./asset/hud/slowball.albedo.png","./asset/hud/slowball.pbr.png","./asset/hud/slowball.normal.png"),new o.a("./asset/hud/monocular.albedo.png","./asset/hud/monocular.pbr.png","./asset/hud/monocular.normal.png"),new o.a("./asset/hud/energyshield.albedo.png","./asset/hud/energyshield.pbr.png","./asset/hud/energyshield.normal.png"),new o.a("./asset/hud/combobooster.albedo.png","./asset/hud/combobooster.pbr.png","./asset/hud/combobooster.normal.png"),new o.a("./asset/hud/hookshot.albedo.png","./asset/hud/hookshot.pbr.png","./asset/hud/hookshot.normal.png"),new o.a("./asset/hud/pistol.albedo.png","./asset/hud/pistol.pbr.png","./asset/hud/pistol.normal.png"),new o.a("./asset/hud/handcannon.albedo.png","./asset/hud/handcannon.pbr.png","./asset/hud/handcannon.normal.png"),new o.a("./asset/hud/machingun.albedo.png","./asset/hud/machingun.pbr.png","./asset/hud/machingun.normal.png"),new o.a("./asset/hud/chainshotgun.albedo.png","./asset/hud/chainshotgun.pbr.png","./asset/hud/chainshotgun.normal.png"),new o.a("./asset/hud/shotgun.albedo.png","./asset/hud/shotgun.pbr.png","./asset/hud/shotgun.normal.png"),new o.a("./asset/hud/heavycannon.albedo.png","./asset/hud/heavycannon.pbr.png","./asset/hud/heavycannon.normal.png"),new o.a("./asset/hud/launcher.albedo.png","./asset/hud/launcher.pbr.png","./asset/hud/launcher.normal.png"),new o.a("./asset/hud/clusterbow.albedo.png","./asset/hud/clusterbow.pbr.png","./asset/hud/clusterbow.normal.png"),new o.a("./asset/hud/plasmagun.albedo.png","./asset/hud/plasmagun.pbr.png","./asset/hud/plasmagun.normal.png"),new o.a("./asset/hud/plasmasmg.albedo.png","./asset/hud/plasmasmg.pbr.png","./asset/hud/plasmasmg.normal.png"),new o.a("./asset/entity/debug.albedo.png","./asset/entity/debug.pbr.png","./asset/entity/debug.normal.png"),new o.a("./asset/entity/ui.albedo.png","./asset/entity/ui.pbr.png","./asset/entity/ui.normal.png"),new o.a("./asset/entity/bullet.albedo.png","./asset/entity/bullet.pbr.png","./asset/entity/bullet.normal.png"),new o.a("./asset/entity/blood.albedo.png","./asset/entity/blood.pbr.png","./asset/entity/blood.normal.png"),new o.a("./asset/entity/acid.albedo.png","./asset/entity/acid.pbr.png","./asset/entity/acid.normal.png"),new o.a("./asset/entity/gib.albedo.png","./asset/entity/gib.pbr.png","./asset/entity/gib.normal.png"),new o.a("./asset/entity/hit.albedo.png","./asset/entity/hit.pbr.png","./asset/entity/hit.normal.png"),new o.a("./asset/entity/ring.albedo.png","./asset/entity/ring.pbr.png","./asset/entity/ring.normal.png"),new o.a("./asset/entity/stuff.albedo.png","./asset/entity/stuff.pbr.png","./asset/entity/stuff.normal.png"),new o.a("./asset/entity/spark.albedo.png","./asset/entity/spark.pbr.png","./asset/entity/spark.normal.png"),new o.a("./asset/entity/explode.albedo.png","./asset/entity/explode.pbr.png","./asset/entity/explode.normal.png"),new o.a("./asset/entity/muzzleflash.albedo.png","./asset/entity/muzzleflash.pbr.png","./asset/entity/muzzleflash.normal.png"),new o.a("./asset/entity/flame.albedo.png","./asset/entity/flame.pbr.png","./asset/entity/flame.normal.png"),new o.a("./asset/entity/enemy-guy.albedo.png","./asset/entity/enemy-guy.pbr.png","./asset/entity/enemy-guy.normal.png"),new o.a("./asset/entity/helmet.albedo.png","./asset/entity/helmet.pbr.png","./asset/entity/helmet.normal.png"),new o.a("./asset/entity/enemy-armor.albedo.png","./asset/entity/enemy-armor.pbr.png","./asset/entity/enemy-armor.normal.png"),new o.a("./asset/entity/object.albedo.png","./asset/entity/object.pbr.png","./asset/entity/object.normal.png"),new o.a("./asset/entity/checkpoint.albedo.png","./asset/entity/checkpoint.pbr.png","./asset/entity/checkpoint.normal.png"),new o.a("./asset/entity/spawner.albedo.png","./asset/entity/spawner.pbr.png","./asset/entity/spawner.normal.png"),new o.a("./asset/entity/gauge.albedo.png","./asset/entity/gauge.pbr.png","./asset/entity/gauge.normal.png"),new o.a("./asset/entity/meat.albedo.png","./asset/entity/meat.pbr.png","./asset/entity/meat.normal.png"),new o.a("./asset/entity/health.albedo.png","./asset/entity/health.pbr.png","./asset/entity/health.normal.png"),new o.a("./asset/entity/armor.albedo.png","./asset/entity/armor.pbr.png","./asset/entity/armor.normal.png"),new o.a("./asset/entity/stamina.albedo.png","./asset/entity/stamina.pbr.png","./asset/entity/stamina.normal.png"),new o.a("./asset/entity/ammo.albedo.png","./asset/entity/ammo.pbr.png","./asset/entity/ammo.normal.png"),new o.a("./asset/entity/weapon.albedo.png","./asset/entity/weapon.pbr.png","./asset/entity/weapon.normal.png"),new o.a("./asset/entity/key.albedo.png","./asset/entity/key.pbr.png","./asset/entity/key.normal.png")],h=(new l.a("./asset/sound/menu/press.mp3"),new l.a("./asset/sound/menu/cancel.mp3"),new l.a("./asset/sound/menu/scroll.mp3"),new l.a("./asset/sound/menu/move.mp3"),new l.a("./asset/sound/menu/buy.mp3"),new l.a("./asset/sound/effect/explode.mp3"),new l.a("./asset/sound/effect/corrosive.mp3"),new l.a("./asset/sound/effect/ice-explode.mp3"),new l.a("./asset/sound/effect/splash.mp3"),new l.a("./asset/sound/effect/ice-break-1.mp3"),new l.a("./asset/sound/effect/ice-break-2.mp3"),new l.a("./asset/sound/effect/ice-break-3.mp3"),new l.a("./asset/sound/effect/head-shot.mp3"),new l.a("./asset/sound/effect/bullet-wall-spark.mp3"),new l.a("./asset/sound/effect/mine-drop.mp3"),new l.a("./asset/sound/effect/damage-ammo.mp3"),new l.a("./asset/sound/effect/damage-melee.mp3"),new l.a("./asset/sound/effect/damage-magic.mp3"),new l.a("./asset/sound/effect/damage-slash.mp3"),new l.a("./asset/sound/effect/damage-flame.mp3"),new l.a("./asset/sound/effect/damage-corrosive1.mp3"),new l.a("./asset/sound/effect/damage-corrosive2.mp3"),new l.a("./asset/sound/weapon/punch-fire.mp3"),new l.a("./asset/sound/weapon/punch-fire-charge.mp3"),new l.a("./asset/sound/weapon/combobooster-fire.mp3"),new l.a("./asset/sound/weapon/combobooster-loop.mp3"),new l.a("./asset/sound/weapon/pistol-fire.mp3"),new l.a("./asset/sound/weapon/hook-fire.mp3"),new l.a("./asset/sound/weapon/hook-bullet.mp3"),new l.a("./asset/sound/weapon/machingun-fire.mp3"),new l.a("./asset/sound/weapon/chainshotgun-fire.mp3"),new l.a("./asset/sound/weapon/chainshotgun-start.mp3"),new l.a("./asset/sound/weapon/chainshotgun-loop.mp3"),new l.a("./asset/sound/weapon/chainshotgun-end.mp3"),new l.a("./asset/sound/weapon/heavycannon-fire.mp3"),new l.a("./asset/sound/weapon/heavycannon-fire-charge.mp3"),new l.a("./asset/sound/weapon/heavycannon-pump.mp3"),new l.a("./asset/sound/weapon/shotgun-fire.mp3"),new l.a("./asset/sound/weapon/shotgun-pump.mp3"),new l.a("./asset/sound/weapon/launcher-fire.mp3"),new l.a("./asset/sound/weapon/launcher-pump.mp3"),new l.a("./asset/sound/weapon/clusterbow-fire.mp3"),new l.a("./asset/sound/weapon/plasmagun-fire.mp3"),new l.a("./asset/sound/weapon/plasmasmg-fire.mp3"),new l.a("./asset/sound/weapon/out-of-ammo.mp3"),new l.a("./asset/sound/weapon/charge-loop.mp3"),new l.a("./asset/sound/weapon/charge-complete.mp3"),new l.a("./asset/sound/combo/up.mp3"),new l.a("./asset/sound/combo/down.mp3"),new l.a("./asset/sound/item/ammo.mp3"),new l.a("./asset/sound/item/weapon.mp3"),new l.a("./asset/sound/item/key.mp3"),new l.a("./asset/sound/item/meat-1.mp3"),new l.a("./asset/sound/item/meat-2.mp3"),new l.a("./asset/sound/item/meat-3.mp3"),new l.a("./asset/sound/item/ice-1.mp3"),new l.a("./asset/sound/item/ice-2.mp3"),new l.a("./asset/sound/item/ice-3.mp3"),new l.a("./asset/sound/item/meat-mute.mp3"),new l.a("./asset/sound/item/armor.mp3"),new l.a("./asset/sound/item/energy.mp3"),new l.a("./asset/sound/item/checkpoint.mp3"),new l.a("./asset/sound/item/spawn.mp3"),new l.a("./asset/sound/player/step-1.mp3"),new l.a("./asset/sound/player/step-2.mp3"),new l.a("./asset/sound/player/step-3.mp3"),new l.a("./asset/sound/player/step-4.mp3"),new l.a("./asset/sound/player/landing.mp3"),new l.a("./asset/sound/player/grab.mp3"),new l.a("./asset/sound/player/climb.mp3"),new l.a("./asset/sound/player/sliding.mp3"),new l.a("./asset/sound/player/wallrun.mp3"),new l.a("./asset/sound/player/open.mp3"),new l.a("./asset/sound/player/lock1.mp3"),new l.a("./asset/sound/player/lock2.mp3"),new l.a("./asset/sound/player/lock3.mp3"),new l.a("./asset/sound/enemy/no-damage.mp3"),new l.a("./asset/sound/enemy/find-pistol-1.mp3"),new l.a("./asset/sound/enemy/find-pistol-2.mp3"),new l.a("./asset/sound/enemy/find-pistol-3.mp3"),new l.a("./asset/sound/enemy/find-pistol-4.mp3"),new l.a("./asset/sound/enemy/find-shotgun-1.mp3"),new l.a("./asset/sound/enemy/find-shotgun-2.mp3"),new l.a("./asset/sound/enemy/find-shotgun-3.mp3"),new l.a("./asset/sound/enemy/find-shotgun-4.mp3"),new l.a("./asset/sound/enemy/find-shotgun-5.mp3"),new l.a("./asset/sound/enemy/find-machingun-1.mp3"),new l.a("./asset/sound/enemy/find-machingun-2.mp3"),new l.a("./asset/sound/enemy/find-machingun-3.mp3"),new l.a("./asset/sound/enemy/find-melee-1.mp3"),new l.a("./asset/sound/enemy/find-melee-2.mp3"),new l.a("./asset/sound/enemy/find-melee-3.mp3"),new l.a("./asset/sound/enemy/pain-pistol-1.mp3"),new l.a("./asset/sound/enemy/pain-pistol-2.mp3"),new l.a("./asset/sound/enemy/pain-shotgun-1.mp3"),new l.a("./asset/sound/enemy/pain-shotgun-2.mp3"),new l.a("./asset/sound/enemy/pain-machingun-1.mp3"),new l.a("./asset/sound/enemy/pain-machingun-2.mp3"),new l.a("./asset/sound/enemy/pain-melee-1.mp3"),new l.a("./asset/sound/enemy/pain-melee-2.mp3"),new l.a("./asset/sound/enemy/death-pistol-1.mp3"),new l.a("./asset/sound/enemy/death-shotgun-1.mp3"),new l.a("./asset/sound/enemy/death-machingun-1.mp3"),new l.a("./asset/sound/enemy/death-melee-1.mp3"),new l.a("./asset/sound/enemy/death-armor.mp3"),new l.a("./asset/sound/enemy/fire-melee.mp3"),new l.a("./asset/sound/enemy/fire-magic.mp3"),new l.a("./asset/sound/system/help.mp3"),{NONE:new r.a("./asset/wall/metal.albedo.png",1,0),METAL_DOOR_DEFAULT:new r.a("./asset/wall/metal.albedo.png",1,1),METAL_DOOR_RED:new r.a("./asset/wall/metal.albedo.png",1,2),METAL_DOOR_BLUE:new r.a("./asset/wall/metal.albedo.png",1,3),METAL_DOOR_YELLOW:new r.a("./asset/wall/metal.albedo.png",1,4),METAL_GOLE:new r.a("./asset/wall/metal.albedo.png",1,5),METAL_SECRET:new r.a("./asset/wall/metal.albedo.png",1,6),METAL_GRAB:new r.a("./asset/wall/metal.albedo.png",1,7),METAL_ASSIST_GRAB:new r.a("./asset/wall/metal.albedo.png",1,8),METAL_WALLRUN:new r.a("./asset/wall/metal.albedo.png",1,9),METAL_DOOR_SLIDING:new r.a("./asset/wall/metal.albedo.png",1,10),METAL_IMPORTANT:new r.a("./asset/wall/metal.albedo.png",1,11),METAL_EDIT_ZONE:new r.a("./asset/wall/metal.albedo.png",1,12),METAL_EDIT_BLOCK:new r.a("./asset/wall/metal.albedo.png",1,13),METAL_TILE1:new r.a("./asset/wall/metal.albedo.png",1,14),METAL_TILE2:new r.a("./asset/wall/metal.albedo.png",1,15),METAL_TILE3:new r.a("./asset/wall/metal.albedo.png",1,16),METAL_TILE4:new r.a("./asset/wall/metal.albedo.png",1,17),METAL_TILE5:new r.a("./asset/wall/metal.albedo.png",1,18),METAL_TILE6:new r.a("./asset/wall/metal.albedo.png",1,19),METAL_TILE7:new r.a("./asset/wall/metal.albedo.png",1,20),RUINS_DOOR_DEFAULT:new r.a("./asset/wall/ruins.albedo.png",1,1),RUINS_DOOR_RED:new r.a("./asset/wall/ruins.albedo.png",1,2),RUINS_DOOR_BLUE:new r.a("./asset/wall/ruins.albedo.png",1,3),RUINS_DOOR_YELLOW:new r.a("./asset/wall/ruins.albedo.png",1,4),RUINS_GOLE:new r.a("./asset/wall/ruins.albedo.png",1,5),RUINS_SECRET:new r.a("./asset/wall/ruins.albedo.png",1,6),RUINS_GRAB:new r.a("./asset/wall/ruins.albedo.png",1,7),RUINS_ASSIST_GRAB:new r.a("./asset/wall/ruins.albedo.png",1,8),RUINS_WALLRUN:new r.a("./asset/wall/ruins.albedo.png",1,9),RUINS_EDIT_ZONE:new r.a("./asset/wall/ruins.albedo.png",1,12),RUINS_EDIT_BLOCK:new r.a("./asset/wall/ruins.albedo.png",1,13),RUINS_TILE1:new r.a("./asset/wall/ruins.albedo.png",1,14),RUINS_TILE2:new r.a("./asset/wall/ruins.albedo.png",1,15),RUINS_TILE3:new r.a("./asset/wall/ruins.albedo.png",1,16),HUD_HAND_GRIP:new r.a("./asset/hud/hand.albedo.png",1,0),HUD_HAND_STILL:new r.a("./asset/hud/hand.albedo.png",1,1),HUD_HAND_FIRE:new r.a("./asset/hud/hand.albedo.png",1,2),HUD_HAND_JUMP:new r.a("./asset/hud/hand.albedo.png",1,3),HUD_HAND_SPRINT:new r.a("./asset/hud/hand.albedo.png",1,4),HUD_HAND_AIR:new r.a("./asset/hud/hand.albedo.png",1,5),HUD_HAND_CHARGE:new r.a("./asset/hud/hand.albedo.png",1,6),HUD_HAND_ATTACK:new r.a("./asset/hud/hand.albedo.png",1,7),HUD_FOOT_SLIDING:new r.a("./asset/hud/foot.albedo.png",1,0),HUD_FOOT_COIL_HAND:new r.a("./asset/hud/foot.albedo.png",1,1),HUD_FOOT_COIL_NO_HAND:new r.a("./asset/hud/foot.albedo.png",1,2),HUD_SLOWBALL_STILL:new r.a("./asset/hud/slowball.albedo.png",1,0),HUD_SLOWBALL_FIRE:new r.a("./asset/hud/slowball.albedo.png",1,1),HUD_BINOCULARS_STILL:new r.a("./asset/hud/monocular.albedo.png",1,0),HUD_ENERGYSHIELD_STILL:new r.a("./asset/hud/energyshield.albedo.png",1,0),HUD_ENERGYSHIELD_EMPTY:new r.a("./asset/hud/energyshield.albedo.png",1,1),HUD_ENERGYSHIELD_FIRE:new r.a("./asset/hud/energyshield.albedo.png",1,2),HUD_COMBO_BOOSTER_STILL:new r.a("./asset/hud/combobooster.albedo.png",1,0),HUD_COMBO_BOOSTER_FIRE:new r.a("./asset/hud/combobooster.albedo.png",1,1),HUD_HOOKSHOT_STILL:new r.a("./asset/hud/hookshot.albedo.png",1,0),HUD_PISTOL_STILL:new r.a("./asset/hud/pistol.albedo.png",1,0),HUD_PISTOL_COCKING:new r.a("./asset/hud/pistol.albedo.png",1,1),HUD_HANDCANNON_STILL:new r.a("./asset/hud/handcannon.albedo.png",1,0),HUD_HANDCANNON_COCKING:new r.a("./asset/hud/handcannon.albedo.png",1,1),HUD_MACHINGUN_STILL:new r.a("./asset/hud/machingun.albedo.png",1,0),HUD_MACHINGUN_COCKING:new r.a("./asset/hud/machingun.albedo.png",1,1),HUD_CHAINSHOTGUN_STILL:new r.a("./asset/hud/chainshotgun.albedo.png",1,0),HUD_CHAINSHOTGUN_COCKING:new r.a("./asset/hud/chainshotgun.albedo.png",1,1),HUD_SHOTGUN_STILL:new r.a("./asset/hud/shotgun.albedo.png",1,0),HUD_SHOTGUN_COCKING:new r.a("./asset/hud/shotgun.albedo.png",1,1),HUD_HEAVYCANNON_STILL:new r.a("./asset/hud/heavycannon.albedo.png",1,0),HUD_HEAVYCANNON_COCKING:new r.a("./asset/hud/heavycannon.albedo.png",1,1),HUD_LAUNCHER_STILL:new r.a("./asset/hud/launcher.albedo.png",1,0),HUD_LAUNCHER_COCKING:new r.a("./asset/hud/launcher.albedo.png",1,1),HUD_CLUSTERBOW_STILL:new r.a("./asset/hud/clusterbow.albedo.png",1,0),HUD_CLUSTERBOW_COCKING:new r.a("./asset/hud/clusterbow.albedo.png",1,1),HUD_PLASMAGUN_STILL:new r.a("./asset/hud/plasmagun.albedo.png",1,0),HUD_PLASMAGUN_COCKING:new r.a("./asset/hud/plasmagun.albedo.png",1,1),HUD_PLASMASMG_STILL:new r.a("./asset/hud/plasmasmg.albedo.png",1,0),HUD_PLASMASMG_COCKING:new r.a("./asset/hud/plasmasmg.albedo.png",1,1),DEGUB_TARGET:new r.a("./asset/entity/debug.albedo.png",1,0),UI_START_POINT:new r.a("./asset/entity/ui.albedo.png",1,0),UI_GOLE_POINT:new r.a("./asset/entity/ui.albedo.png",1,1),UI_SECRET_POINT:new r.a("./asset/entity/ui.albedo.png",1,2),UI_HELP_POINT:new r.a("./asset/entity/ui.albedo.png",1,3),UI_HORDE_GROUND_SPAWN_POINT:new r.a("./asset/entity/ui.albedo.png",1,4),UI_HORDE_SNIPER_SPAWN_POINT:new r.a("./asset/entity/ui.albedo.png",1,5),UI_HORDE_SKY_SPAWN_POINT:new r.a("./asset/entity/ui.albedo.png",1,6),UI_ANGLE:new r.a("./asset/entity/ui.albedo.png",1,7),EFFECT_BULLET_AMMO_TRAIL:new r.a("./asset/entity/bullet.albedo.png",.1,0),EFFECT_BULLET_PLASMA_BALL:new r.a("./asset/entity/bullet.albedo.png",.1,1),EFFECT_BULLET_HOOK_HEAD:new r.a("./asset/entity/bullet.albedo.png",.25,2),EFFECT_BULLET_HOOK_CHAIN:new r.a("./asset/entity/bullet.albedo.png",.1,3),EFFECT_BULLET_GRENADE:new r.a("./asset/entity/bullet.albedo.png",.1,3),EFFECT_BULLET_ARM_GRANADE:new r.a("./asset/entity/bullet.albedo.png",.375,4),EFFECT_BULLET_RAIL_TRAIL:new r.a("./asset/entity/bullet.albedo.png",.1,5),EFFECT_BULLET_LASER_TRAIL:new r.a("./asset/entity/bullet.albedo.png",.1,6),EFFECT_BULLET_PLASMA_TRAIL:new r.a("./asset/entity/bullet.albedo.png",.1,7),EFFECT_BULLET_MAGINC_MISSILE_TRAIL:new r.a("./asset/entity/bullet.albedo.png",.1,8),EFFECT_BULLET_DEATH_BOMB:new r.a("./asset/entity/bullet.albedo.png",.25,9),EFFECT_BLOOD_RED1:new r.a("./asset/entity/blood.albedo.png",.75,0),EFFECT_BLOOD_RED2:new r.a("./asset/entity/blood.albedo.png",.75,1),EFFECT_BLOOD_RED3:new r.a("./asset/entity/blood.albedo.png",.75,2),EFFECT_BLOOD_GREEN1:new r.a("./asset/entity/blood.albedo.png",.75,3),EFFECT_BLOOD_GREEN2:new r.a("./asset/entity/blood.albedo.png",.75,4),EFFECT_BLOOD_GREEN3:new r.a("./asset/entity/blood.albedo.png",.75,5),EFFECT_ACID_RED1:new r.a("./asset/entity/acid.albedo.png",.75,0),EFFECT_ACID_RED2:new r.a("./asset/entity/acid.albedo.png",.75,1),EFFECT_ACID_GREEN:new r.a("./asset/entity/acid.albedo.png",.75,2),EFFECT_ACID_BLUE:new r.a("./asset/entity/acid.albedo.png",.75,4),EFFECT_GIB1:new r.a("./asset/entity/gib.albedo.png",.25,0),EFFECT_GIB2:new r.a("./asset/entity/gib.albedo.png",.25,1),EFFECT_GIB3:new r.a("./asset/entity/gib.albedo.png",.25,2),EFFECT_GIB4:new r.a("./asset/entity/gib.albedo.png",.25,3),EFFECT_ICE_GIB1:new r.a("./asset/entity/gib.albedo.png",.25,4),EFFECT_ICE_GIB2:new r.a("./asset/entity/gib.albedo.png",.25,5),EFFECT_ICE_GIB3:new r.a("./asset/entity/gib.albedo.png",.25,6),EFFECT_ICE_GIB4:new r.a("./asset/entity/gib.albedo.png",.25,7),EFFECT_HIT_WALL1:new r.a("./asset/entity/hit.albedo.png",1,0),EFFECT_HIT_WALL2:new r.a("./asset/entity/hit.albedo.png",1,1),EFFECT_HIT_WALL3:new r.a("./asset/entity/hit.albedo.png",1,2),EFFECT_HIT_BLOOD1:new r.a("./asset/entity/hit.albedo.png",1,3),EFFECT_HIT_BLOOD2:new r.a("./asset/entity/hit.albedo.png",1,4),EFFECT_HIT_BLOOD3:new r.a("./asset/entity/hit.albedo.png",1,5),EFFECT_HEADSHOT1:new r.a("./asset/entity/ring.albedo.png",1,0),EFFECT_HEADSHOT2:new r.a("./asset/entity/ring.albedo.png",1,1),EFFECT_HEADSHOT3:new r.a("./asset/entity/ring.albedo.png",1,2),EFFECT_HEADSHOT4:new r.a("./asset/entity/ring.albedo.png",1,3),EFFECT_HEADSHOT5:new r.a("./asset/entity/ring.albedo.png",1,4),EFFECT_HEADSHOT6:new r.a("./asset/entity/ring.albedo.png",1,5),EFFECT_ARMORBREAK1:new r.a("./asset/entity/ring.albedo.png",1,6),EFFECT_ARMORBREAK2:new r.a("./asset/entity/ring.albedo.png",1,7),EFFECT_ARMORBREAK3:new r.a("./asset/entity/ring.albedo.png",1,8),EFFECT_ARMORBREAK4:new r.a("./asset/entity/ring.albedo.png",1,9),EFFECT_ARMORBREAK5:new r.a("./asset/entity/ring.albedo.png",1,10),EFFECT_ARMORBREAK6:new r.a("./asset/entity/ring.albedo.png",1,11),EFFECT_STUFF:new r.a("./asset/entity/stuff.albedo.png",1,0),EFFECT_SPARK_MISSILE1:new r.a("./asset/entity/spark.albedo.png",1,0),EFFECT_SPARK_MISSILE2:new r.a("./asset/entity/spark.albedo.png",1,1),EFFECT_SPARK_MISSILE3:new r.a("./asset/entity/spark.albedo.png",1,2),EFFECT_SPARK_MISSILE4:new r.a("./asset/entity/spark.albedo.png",1,3),EFFECT_DEFAULT_EXPLODE1:new r.a("./asset/entity/explode.albedo.png",1,0),EFFECT_DEFAULT_EXPLODE2:new r.a("./asset/entity/explode.albedo.png",1,1),EFFECT_DEFAULT_EXPLODE3:new r.a("./asset/entity/explode.albedo.png",1,2),EFFECT_DEFAULT_EXPLODE4:new r.a("./asset/entity/explode.albedo.png",1,3),EFFECT_DEFAULT_EXPLODE5:new r.a("./asset/entity/explode.albedo.png",1,4),EFFECT_DEFAULT_EXPLODE6:new r.a("./asset/entity/explode.albedo.png",1,5),EFFECT_DEFAULT_EXPLODE7:new r.a("./asset/entity/explode.albedo.png",1,6),EFFECT_DEFAULT_EXPLODE8:new r.a("./asset/entity/explode.albedo.png",1,7),EFFECT_DEFAULT_EXPLODE9:new r.a("./asset/entity/explode.albedo.png",1,8),EFFECT_DEFAULT_EXPLODE10:new r.a("./asset/entity/explode.albedo.png",1,9),EFFECT_DEFAULT_EXPLODE11:new r.a("./asset/entity/explode.albedo.png",1,10),EFFECT_DEFAULT_EXPLODE12:new r.a("./asset/entity/explode.albedo.png",1,11),EFFECT_DEFAULT_EXPLODE13:new r.a("./asset/entity/explode.albedo.png",1,12),EFFECT_DEFAULT_EXPLODE14:new r.a("./asset/entity/explode.albedo.png",1,13),EFFECT_CORROSIVE_EXPLODE1:new r.a("./asset/entity/explode.albedo.png",1,14),EFFECT_CORROSIVE_EXPLODE2:new r.a("./asset/entity/explode.albedo.png",1,15),EFFECT_CORROSIVE_EXPLODE3:new r.a("./asset/entity/explode.albedo.png",1,16),EFFECT_CORROSIVE_EXPLODE4:new r.a("./asset/entity/explode.albedo.png",1,17),EFFECT_CORROSIVE_EXPLODE5:new r.a("./asset/entity/explode.albedo.png",1,18),EFFECT_CORROSIVE_EXPLODE6:new r.a("./asset/entity/explode.albedo.png",1,19),EFFECT_CORROSIVE_EXPLODE7:new r.a("./asset/entity/explode.albedo.png",1,20),EFFECT_CORROSIVE_EXPLODE8:new r.a("./asset/entity/explode.albedo.png",1,21),EFFECT_CORROSIVE_EXPLODE9:new r.a("./asset/entity/explode.albedo.png",1,22),EFFECT_CORROSIVE_EXPLODE10:new r.a("./asset/entity/explode.albedo.png",1,23),EFFECT_CORROSIVE_EXPLODE11:new r.a("./asset/entity/explode.albedo.png",1,24),EFFECT_CORROSIVE_EXPLODE12:new r.a("./asset/entity/explode.albedo.png",1,25),EFFECT_CORROSIVE_EXPLODE13:new r.a("./asset/entity/explode.albedo.png",1,26),EFFECT_CORROSIVE_EXPLODE14:new r.a("./asset/entity/explode.albedo.png",1,27),EFFECT_FLAME1:new r.a("./asset/entity/flame.albedo.png",1,0),EFFECT_FLAME2:new r.a("./asset/entity/flame.albedo.png",1,1),EFFECT_FLAME3:new r.a("./asset/entity/flame.albedo.png",1,2),EFFECT_FLAME4:new r.a("./asset/entity/flame.albedo.png",1,3),EFFECT_FLAME5:new r.a("./asset/entity/flame.albedo.png",1,4),EFFECT_MUZZLE_FLASH_AMMO_1:new r.a("./asset/entity/muzzleflash.albedo.png",1,0),EFFECT_MUZZLE_FLASH_AMMO_2:new r.a("./asset/entity/muzzleflash.albedo.png",1,1),EFFECT_MUZZLE_FLASH_AMMO_3:new r.a("./asset/entity/muzzleflash.albedo.png",1,2),EFFECT_MUZZLE_FLASH_CELL_1:new r.a("./asset/entity/muzzleflash.albedo.png",1,3),EFFECT_MUZZLE_FLASH_CELL_2:new r.a("./asset/entity/muzzleflash.albedo.png",1,4),EFFECT_MUZZLE_FLASH_CELL_3:new r.a("./asset/entity/muzzleflash.albedo.png",1,5),EFFECT_MUZZLE_FLASH_HAVYCANNON1:new r.a("./asset/entity/muzzleflash.albedo.png",1,6),EFFECT_MUZZLE_FLASH_HAVYCANNON2:new r.a("./asset/entity/muzzleflash.albedo.png",1,7),EFFECT_MUZZLE_FLASH_HAVYCANNON3:new r.a("./asset/entity/muzzleflash.albedo.png",1,8),ENEMY_TARGET_STILL:new r.a("./asset/entity/enemy-guy.albedo.png",1,0),ENEMY_TARGET_PAIN:new r.a("./asset/entity/enemy-guy.albedo.png",1,2),ENEMY_TARGET_BLOW:new r.a("./asset/entity/enemy-guy.albedo.png",1,3),ENEMY_TARGET_DOWN:new r.a("./asset/entity/enemy-guy.albedo.png",1,4),ENEMY_TARGET_FREEZE:new r.a("./asset/entity/enemy-guy.albedo.png",1,5),ENEMY_GUY_PISTOL_STILL:new r.a("./asset/entity/enemy-guy.albedo.png",1,6),ENEMY_GUY_PISTOL_AIM:new r.a("./asset/entity/enemy-guy.albedo.png",1,7),ENEMY_GUY_PISTOL_PAIN:new r.a("./asset/entity/enemy-guy.albedo.png",1,8),ENEMY_GUY_PISTOL_BLOW:new r.a("./asset/entity/enemy-guy.albedo.png",1,9),ENEMY_GUY_PISTOL_DOWN:new r.a("./asset/entity/enemy-guy.albedo.png",1,10),ENEMY_GUY_PISTOL_FREEZE:new r.a("./asset/entity/enemy-guy.albedo.png",1,11),ENEMY_GUY_SHOTGUN_STILL:new r.a("./asset/entity/enemy-guy.albedo.png",1,12),ENEMY_GUY_SHOTGUN_AIM:new r.a("./asset/entity/enemy-guy.albedo.png",1,13),ENEMY_GUY_SHOTGUN_PAIN:new r.a("./asset/entity/enemy-guy.albedo.png",1,14),ENEMY_GUY_SHOTGUN_BLOW:new r.a("./asset/entity/enemy-guy.albedo.png",1,15),ENEMY_GUY_SHOTGUN_DOWN:new r.a("./asset/entity/enemy-guy.albedo.png",1,16),ENEMY_GUY_SHOTGUN_FREEZE:new r.a("./asset/entity/enemy-guy.albedo.png",1,17),ENEMY_GUY_MACHINGUN_STILL:new r.a("./asset/entity/enemy-guy.albedo.png",1,18),ENEMY_GUY_MACHINGUN_AIM:new r.a("./asset/entity/enemy-guy.albedo.png",1,19),ENEMY_GUY_MACHINGUN_PAIN:new r.a("./asset/entity/enemy-guy.albedo.png",1,20),ENEMY_GUY_MACHINGUN_BLOW:new r.a("./asset/entity/enemy-guy.albedo.png",1,21),ENEMY_GUY_MACHINGUN_DOWN:new r.a("./asset/entity/enemy-guy.albedo.png",1,22),ENEMY_GUY_MACHINGUN_FREEZE:new r.a("./asset/entity/enemy-guy.albedo.png",1,23),ENEMY_GUY_MELEE_STILL:new r.a("./asset/entity/enemy-guy.albedo.png",1,24),ENEMY_GUY_MELEE_AIM:new r.a("./asset/entity/enemy-guy.albedo.png",1,25),ENEMY_GUY_MELEE_PAIN:new r.a("./asset/entity/enemy-guy.albedo.png",1,26),ENEMY_GUY_MELEE_BLOW:new r.a("./asset/entity/enemy-guy.albedo.png",1,27),ENEMY_GUY_MELEE_DOWN:new r.a("./asset/entity/enemy-guy.albedo.png",1,28),ENEMY_GUY_MELEE_FREEZE:new r.a("./asset/entity/enemy-guy.albedo.png",1,29),ENEMY_GUY_PISTOL_ARMOR_STILL:new r.a("./asset/entity/enemy-guy.albedo.png",1,30),ENEMY_GUY_PISTOL_ARMOR_AIM:new r.a("./asset/entity/enemy-guy.albedo.png",1,31),ENEMY_GUY_PISTOL_ARMOR_PAIN:new r.a("./asset/entity/enemy-guy.albedo.png",1,32),ENEMY_GUY_PISTOL_ARMOR_FREEZE:new r.a("./asset/entity/enemy-guy.albedo.png",1,35),ENEMY_GUY_SHOTGUN_ARMOR_STILL:new r.a("./asset/entity/enemy-guy.albedo.png",1,36),ENEMY_GUY_SHOTGUN_ARMOR_AIM:new r.a("./asset/entity/enemy-guy.albedo.png",1,37),ENEMY_GUY_SHOTGUN_ARMOR_PAIN:new r.a("./asset/entity/enemy-guy.albedo.png",1,38),ENEMY_GUY_SHOTGUN_ARMOR_FREEZE:new r.a("./asset/entity/enemy-guy.albedo.png",1,41),ENEMY_GUY_MACHINGUN_ARMOR_STILL:new r.a("./asset/entity/enemy-guy.albedo.png",1,42),ENEMY_GUY_MACHINGUN_ARMOR_AIM:new r.a("./asset/entity/enemy-guy.albedo.png",1,43),ENEMY_GUY_MACHINGUN_ARMOR_PAIN:new r.a("./asset/entity/enemy-guy.albedo.png",1,44),ENEMY_GUY_MACHINGUN_ARMOR_FREEZE:new r.a("./asset/entity/enemy-guy.albedo.png",1,47),ENEMY_GUY_MELEE_ARMOR_STILL:new r.a("./asset/entity/enemy-guy.albedo.png",1,48),ENEMY_GUY_MELEE_ARMOR_AIM:new r.a("./asset/entity/enemy-guy.albedo.png",1,49),ENEMY_GUY_MELEE_ARMOR_PAIN:new r.a("./asset/entity/enemy-guy.albedo.png",1,50),ENEMY_GUY_MELEE_ARMOR_FREEZE:new r.a("./asset/entity/enemy-guy.albedo.png",1,53),ENEMY_GUY_MISSILE_STILL:new r.a("./asset/entity/enemy-guy.albedo.png",1,54),ENEMY_GUY_MISSILE_AIM:new r.a("./asset/entity/enemy-guy.albedo.png",1,55),ENEMY_GUY_MISSILE_PAIN:new r.a("./asset/entity/enemy-guy.albedo.png",1,56),ENEMY_GUY_MISSILE_FREEZE:new r.a("./asset/entity/enemy-guy.albedo.png",1,59),ENEMY_TANK_BALL_STILL:new r.a("./asset/entity/enemy-guy.albedo.png",1,60),ENEMY_TANK_BALL_AIM:new r.a("./asset/entity/enemy-guy.albedo.png",1,61),ENEMY_TANK_BALL_PAIN:new r.a("./asset/entity/enemy-guy.albedo.png",1,62),ENEMY_TANK_BALL_FREEZE:new r.a("./asset/entity/enemy-guy.albedo.png",1,65),ENEMY_GUY_HELMET_STILL:new r.a("./asset/entity/helmet.albedo.png",1,0),ENEMY_GUY_HELMET_PAIN:new r.a("./asset/entity/helmet.albedo.png",1,1),ENEMY_GUY_ARMOR_HELMET:new r.a("./asset/entity/enemy-armor.albedo.png",1,0),ENEMY_GUY_ARMOR_SHOULDER:new r.a("./asset/entity/enemy-armor.albedo.png",1,1),ENEMY_GUY_ARMOR_ARM:new r.a("./asset/entity/enemy-armor.albedo.png",1,2),ENEMY_GUY_ARMOR_BODY:new r.a("./asset/entity/enemy-armor.albedo.png",1,3),ENEMY_GUY_ARMOR_WAIST:new r.a("./asset/entity/enemy-armor.albedo.png",1,4),OBJECT_SHOP:new r.a("./asset/entity/object.albedo.png",1,0),OBJECT_SHOP_SALE:new r.a("./asset/entity/object.albedo.png",1,1),OBJECT_EDITOR:new r.a("./asset/entity/object.albedo.png",1,2),OBJECT_DRUM:new r.a("./asset/entity/object.albedo.png",1,3),OBJECT_CHECKPOINT_DISABLE:new r.a("./asset/entity/checkpoint.albedo.png",1,0),OBJECT_CHECKPOINT_ACTIVE:new r.a("./asset/entity/checkpoint.albedo.png",1,1),OBJECT_SPAWNER_HEALTH:new r.a("./asset/entity/spawner.albedo.png",1,0),OBJECT_SPAWNER_ARMOR:new r.a("./asset/entity/spawner.albedo.png",1,1),OBJECT_SPAWNER_AMMO:new r.a("./asset/entity/spawner.albedo.png",1,2),OBJECT_SPAWNER_OTHER:new r.a("./asset/entity/spawner.albedo.png",1,3),EFFECT_SPAWNER_GAUGE1:new r.a("./asset/entity/gauge.albedo.png",1,0),EFFECT_SPAWNER_GAUGE2:new r.a("./asset/entity/gauge.albedo.png",1,1),EFFECT_SPAWNER_GAUGE3:new r.a("./asset/entity/gauge.albedo.png",1,2),EFFECT_SPAWNER_GAUGE4:new r.a("./asset/entity/gauge.albedo.png",1,3),EFFECT_SPAWNER_GAUGE5:new r.a("./asset/entity/gauge.albedo.png",1,4),EFFECT_SPAWNER_GAUGE6:new r.a("./asset/entity/gauge.albedo.png",1,5),EFFECT_SPAWNER_GAUGE7:new r.a("./asset/entity/gauge.albedo.png",1,6),EFFECT_SPAWNER_GAUGE8:new r.a("./asset/entity/gauge.albedo.png",1,7),EFFECT_SPAWNER_GAUGE9:new r.a("./asset/entity/gauge.albedo.png",1,8),EFFECT_SPAWNER_GAUGE10:new r.a("./asset/entity/gauge.albedo.png",1,9),EFFECT_SPAWNER_GAUGE11:new r.a("./asset/entity/gauge.albedo.png",1,10),EFFECT_SPAWNER_GAUGE12:new r.a("./asset/entity/gauge.albedo.png",1,11),EFFECT_SPAWNER_GAUGE13:new r.a("./asset/entity/gauge.albedo.png",1,12),EFFECT_SPAWNER_GAUGE14:new r.a("./asset/entity/gauge.albedo.png",1,13),EFFECT_SPAWNER_GAUGE15:new r.a("./asset/entity/gauge.albedo.png",1,14),EFFECT_SPAWNER_GAUGE16:new r.a("./asset/entity/gauge.albedo.png",1,15),ITEM_MEAT_STIM:new r.a("./asset/entity/meat.albedo.png",1,0),ITEM_MEAT_MEDIKIT:new r.a("./asset/entity/meat.albedo.png",1,1),ITEM_MEAT_ELIXIR:new r.a("./asset/entity/meat.albedo.png",1,2),ITEM_HEALTH_ELIXIR:new r.a("./asset/entity/health.albedo.png",1,2),ITEM_ARMOR_ELIXIR:new r.a("./asset/entity/armor.albedo.png",1,0),ITEM_ENERGY_ELIXIR:new r.a("./asset/entity/stamina.albedo.png",1,0),ITEM_AMMO_CLIP:new r.a("./asset/entity/ammo.albedo.png",1,0),ITEM_AMMO_MAGAZINE:new r.a("./asset/entity/ammo.albedo.png",1,1),ITEM_AMMO_SHELL:new r.a("./asset/entity/ammo.albedo.png",1,2),ITEM_AMMO_ROCKET:new r.a("./asset/entity/ammo.albedo.png",1,3),ITEM_AMMO_CELL:new r.a("./asset/entity/ammo.albedo.png",1,4),ITEM_WEAPON_PUNCH:new r.a("./asset/entity/weapon.albedo.png",1,0),ITEM_WEAPON_SLOWBALL:new r.a("./asset/entity/weapon.albedo.png",1,6),ITEM_WEAPON_BINOCULARS:new r.a("./asset/entity/weapon.albedo.png",1,12),ITEM_WEAPON_ENERGYSHIELD:new r.a("./asset/entity/weapon.albedo.png",1,18),ITEM_WEAPON_COMBOBOOSTER:new r.a("./asset/entity/weapon.albedo.png",1,24),ITEM_WEAPON_FROZEN_GRENADE:new r.a("./asset/entity/weapon.albedo.png",1,30),ITEM_WEAPON_HOOKSHOT:new r.a("./asset/entity/weapon.albedo.png",1,36),ITEM_WEAPON_PISTOL:new r.a("./asset/entity/weapon.albedo.png",1,1),ITEM_WEAPON_HANDCANNON:new r.a("./asset/entity/weapon.albedo.png",1,7),ITEM_WEAPON_MACHINGUN:new r.a("./asset/entity/weapon.albedo.png",1,2),ITEM_WEAPON_CHAINSHOTGUN:new r.a("./asset/entity/weapon.albedo.png",1,8),ITEM_WEAPON_SHOTGUN:new r.a("./asset/entity/weapon.albedo.png",1,3),ITEM_WEAPON_HEAVYCANNON:new r.a("./asset/entity/weapon.albedo.png",1,9),ITEM_WEAPON_LAUNCHER:new r.a("./asset/entity/weapon.albedo.png",1,4),ITEM_WEAPON_CLUSTERBOW:new r.a("./asset/entity/weapon.albedo.png",1,10),ITEM_WEAPON_PLASMAGUN:new r.a("./asset/entity/weapon.albedo.png",1,5),ITEM_WEAPON_PLASMASMG:new r.a("./asset/entity/weapon.albedo.png",1,11),ITEM_KEY_RED:new r.a("./asset/entity/key.albedo.png",1,0),ITEM_KEY_BLUE:new r.a("./asset/entity/key.albedo.png",1,1),ITEM_KEY_YELLOW:new r.a("./asset/entity/key.albedo.png",1,2),ITEM_KEY_RANDOM:new r.a("./asset/entity/key.albedo.png",1,3)}),f=(h.EFFECT_FLAME1,h.EFFECT_FLAME2,h.EFFECT_FLAME3,h.EFFECT_FLAME4,h.EFFECT_FLAME5,h.NONE,h.METAL_DOOR_DEFAULT,h.METAL_DOOR_RED,h.METAL_DOOR_BLUE,h.METAL_DOOR_YELLOW,h.METAL_GOLE,h.METAL_SECRET,h.METAL_GRAB,h.METAL_ASSIST_GRAB,h.METAL_WALLRUN,h.METAL_DOOR_SLIDING,h.METAL_IMPORTANT,h.METAL_EDIT_ZONE,h.METAL_EDIT_BLOCK,h.METAL_TILE1,h.METAL_TILE2,h.METAL_TILE3,h.METAL_TILE4,h.METAL_TILE5,h.METAL_TILE6,h.METAL_TILE7,h.NONE,h.RUINS_DOOR_DEFAULT,h.RUINS_DOOR_RED,h.RUINS_DOOR_BLUE,h.RUINS_DOOR_YELLOW,h.RUINS_GOLE,h.RUINS_SECRET,h.RUINS_GRAB,h.RUINS_ASSIST_GRAB,h.RUINS_WALLRUN,h.NONE,h.NONE,h.RUINS_EDIT_ZONE,h.RUINS_EDIT_BLOCK,h.RUINS_TILE1,h.RUINS_TILE2,h.RUINS_TILE3,h.NONE,h.NONE,h.NONE,h.NONE,new a.a(.5,.5,.5,"NONE","NONE","NONE","NONE","NONE","NONE"));new a.a(.5,.5,.5,"WALL","WALL","WALL","WALL","CEIL","FLOOR"),new a.a(.5,.5,.5,"DOOR_DEFAULT","DOOR_DEFAULT","DOOR_DEFAULT","DOOR_DEFAULT","DOOR_DEFAULT","DOOR_DEFAULT"),new a.a(.5,.5,.5,"DOOR_RED","DOOR_RED","DOOR_RED","DOOR_RED","DOOR_RED","DOOR_RED"),new a.a(.5,.5,.5,"DOOR_BLUE","DOOR_BLUE","DOOR_BLUE","DOOR_BLUE","DOOR_BLUE","DOOR_BLUE"),new a.a(.5,.5,.5,"DOOR_YELLOW","DOOR_YELLOW","DOOR_YELLOW","DOOR_YELLOW","DOOR_YELLOW","DOOR_YELLOW"),new a.a(.5,.5,.5,"EDIT_BLOCK","EDIT_BLOCK","EDIT_BLOCK","EDIT_BLOCK","EDIT_BLOCK","EDIT_BLOCK");const g={PROJEKT:new c.a([1,0,0]),MATCHA:new c.a([0,1,0]),NAKUKORONI:new c.a([0,0,1]),PIKAPIKA:new c.a([1,1,0]),TOTTOKO:new c.a([1,.5,0]),LATEL:new c.a([1,0,1])};i()}catch(e){i(e)}}))},(e,t,n)=>{var i=n(0),r=n(8),o=n(15),a=n(90),s=n(40),l=n(162),c=n(7),u=i.TypeError,d=c("toPrimitive");e.exports=function(e,t){if(!o(e)||a(e))return e;var n,i=s(e,d);if(i){if(void 0===t&&(t="default"),n=r(i,e,t),!o(n)||a(n))return n;throw u("Can't convert object to primitive value")}return void 0===t&&(t="number"),l(e,t)}},(e,t,n)=>{var i=n(0),r=n(8),o=n(5),a=n(15),s=i.TypeError;e.exports=function(e,t){var n,i;if("string"===t&&o(n=e.toString)&&!a(i=r(n,e)))return i;if(o(n=e.valueOf)&&!a(i=r(n,e)))return i;if("string"!==t&&o(n=e.toString)&&!a(i=r(n,e)))return i;throw s("Can't convert object to primitive value")}},(e,t,n)=>{var i=n(0),r=n(5),o=n(72),a=i.WeakMap;e.exports=r(a)&&/native code/.test(o(a))},(e,t)=>{"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,r=i&&!n.call({1:2},1);t.f=r?function(e){var t=i(this,e);return!!t&&t.enumerable}:n},(e,t,n)=>{var i=n(27),r=n(3),o=n(95),a=n(166),s=n(10),l=r([].concat);e.exports=i("Reflect","ownKeys")||function(e){var t=o.f(s(e)),n=a.f;return n?l(t,n(e)):t}},(e,t)=>{t.f=Object.getOwnPropertySymbols},(e,t,n)=>{var i=n(4);e.exports=!i((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},(e,t,n)=>{var i=n(0),r=n(5),o=i.String,a=i.TypeError;e.exports=function(e){if("object"==typeof e||r(e))return e;throw a("Can't set "+o(e)+" as a prototype")}},(e,t,n)=>{var i={};i[n(7)("toStringTag")]="z",e.exports="[object z]"===String(i)},(e,t,n)=>{var i=n(36),r=n(0);e.exports=/ipad|iphone|ipod/i.test(i)&&void 0!==r.Pebble},(e,t,n)=>{var i=n(36);e.exports=/web0s(?!.*chrome)/i.test(i)},(e,t,n)=>{var i=n(0);e.exports=function(e,t){var n=i.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))}},e=>{var t=function(){this.head=null,this.tail=null};t.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}},e.exports=t},e=>{e.exports="object"==typeof window&&"object"!=typeof Deno},(e,t,n)=>{"use strict";var i=n(134).forEach,r=n(135)("forEach");e.exports=r?[].forEach:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}},(e,t,n)=>{var i=n(177);e.exports=function(e,t){return new(i(e))(0===t?0:t)}},(e,t,n)=>{var i=n(0),r=n(178),o=n(97),a=n(15),s=n(7)("species"),l=i.Array;e.exports=function(e){var t;return r(e)&&(t=e.constructor,(o(t)&&(t===l||r(t.prototype))||a(t)&&null===(t=t[s]))&&(t=void 0)),void 0===t?l:t}},(e,t,n)=>{var i=n(38);e.exports=Array.isArray||function(e){return"Array"==i(e)}},(e,t,n)=>{var i=n(0),r=n(100),o=i.TypeError;e.exports=function(e){if(r(e))throw o("The method doesn't accept regular expressions");return e}},(e,t,n)=>{var i=n(7)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[i]=!1,"/./"[e](t)}catch(e){}}return!1}},(e,t,n)=>{var i=n(0).Array,r=Math.abs,o=Math.pow,a=Math.floor,s=Math.log,l=Math.LN2;e.exports={pack:function(e,t,n){var c,u,d,h=i(n),f=8*n-t-1,g=(1<<f)-1,p=g>>1,m=23===t?o(2,-24)-o(2,-77):0,v=e<0||0===e&&1/e<0?1:0,_=0;for((e=r(e))!=e||e===1/0?(u=e!=e?1:0,c=g):(c=a(s(e)/l),e*(d=o(2,-c))<1&&(c--,d*=2),(e+=c+p>=1?m/d:m*o(2,1-p))*d>=2&&(c++,d/=2),c+p>=g?(u=0,c=g):c+p>=1?(u=(e*d-1)*o(2,t),c+=p):(u=e*o(2,p-1)*o(2,t),c=0));t>=8;)h[_++]=255&u,u/=256,t-=8;for(c=c<<t|u,f+=t;f>0;)h[_++]=255&c,c/=256,f-=8;return h[--_]|=128*v,h},unpack:function(e,t){var n,i=e.length,r=8*i-t-1,a=(1<<r)-1,s=a>>1,l=r-7,c=i-1,u=e[c--],d=127&u;for(u>>=7;l>0;)d=256*d+e[c--],l-=8;for(n=d&(1<<-l)-1,d>>=-l,l+=t;l>0;)n=256*n+e[c--],l-=8;if(0===d)d=1-s;else{if(d===a)return n?NaN:u?-1/0:1/0;n+=o(2,t),d-=s}return(u?-1:1)*n*o(2,d-t)}}},(e,t,n)=>{"use strict";var i=n(23),r=n(71),o=n(28);e.exports=function(e){for(var t=i(this),n=o(t),a=arguments.length,s=r(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,c=void 0===l?n:r(l,n);c>s;)t[s++]=e;return t}},(e,t,n)=>{var i=n(0),r=n(4),o=n(132),a=n(48).NATIVE_ARRAY_BUFFER_VIEWS,s=i.ArrayBuffer,l=i.Int8Array;e.exports=!a||!r((function(){l(1)}))||!r((function(){new l(-1)}))||!o((function(e){new l,new l(null),new l(1.5),new l(e)}),!0)||r((function(){return 1!==new l(new s(2),1,void 0).length}))},(e,t,n)=>{var i=n(15),r=Math.floor;e.exports=Number.isInteger||function(e){return!i(e)&&isFinite(e)&&r(e)===e}},(e,t,n)=>{var i=n(0),r=n(37),o=i.RangeError;e.exports=function(e){var t=r(e);if(t<0)throw o("The argument can't be less than 0");return t}},(e,t,n)=>{var i=n(32),r=n(8),o=n(125),a=n(23),s=n(28),l=n(81),c=n(60),u=n(99),d=n(48).aTypedArrayConstructor;e.exports=function(e){var t,n,h,f,g,p,m=o(this),v=a(e),_=arguments.length,y=_>1?arguments[1]:void 0,b=void 0!==y,w=c(v);if(w&&!u(w))for(p=(g=l(v,w)).next,v=[];!(f=r(p,g)).done;)v.push(f.value);for(b&&_>2&&(y=i(y,arguments[2])),n=s(v),h=new(d(m))(n),t=0;n>t;t++)h[t]=b?y(v[t],t):v[t];return h}},(e,t,n)=>{var i=n(36).match(/firefox\/(\d+)/i);e.exports=!!i&&+i[1]},(e,t,n)=>{var i=n(36);e.exports=/MSIE|Trident/.test(i)},(e,t,n)=>{var i=n(36).match(/AppleWebKit\/(\d+)\./);e.exports=!!i&&+i[1]},(e,t,n)=>{"use strict";var i=n(8),r=n(103),o=n(10),a=n(31),s=n(16),l=n(29),c=n(40),u=n(104),d=n(106);r("match",(function(e,t,n){return[function(t){var n=l(this),r=null==t?void 0:c(t,e);return r?i(r,t,n):new RegExp(t)[e](s(n))},function(e){var i=o(this),r=s(e),l=n(t,i,r);if(l.done)return l.value;if(!i.global)return d(i,r);var c=i.unicode;i.lastIndex=0;for(var h,f=[],g=0;null!==(h=d(i,r));){var p=s(h[0]);f[g]=p,""===p&&(i.lastIndex=u(r,a(i.lastIndex),c)),g++}return 0===g?null:f}]}))},(e,t,n)=>{var i=n(119),r=n(17);e.exports=function(e,t,n){return n.get&&i(n.get,t,{getter:!0}),n.set&&i(n.set,t,{setter:!0}),r.f(e,t,n)}},(e,t,n)=>{"use strict";var i=n(11),r=n(3),o=n(8),a=n(4),s=n(114),l=n(166),c=n(164),u=n(23),d=n(66),h=Object.assign,f=Object.defineProperty,g=r([].concat);e.exports=!h||a((function(){if(i&&1!==h({b:1},h(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=h({},e)[n]||s(h({},t)).join("")!=r}))?function(e,t){for(var n=u(e),r=arguments.length,a=1,h=l.f,f=c.f;r>a;)for(var p,m=d(arguments[a++]),v=h?g(s(m),h(m)):s(m),_=v.length,y=0;_>y;)p=v[y++],i&&!o(f,m,p)||(n[p]=m[p]);return n}:h},(e,t,n)=>{"use strict";var i=n(0),r=n(32),o=n(8),a=n(23),s=n(194),l=n(99),c=n(97),u=n(28),d=n(142),h=n(81),f=n(60),g=i.Array;e.exports=function(e){var t=a(e),n=c(this),i=arguments.length,p=i>1?arguments[1]:void 0,m=void 0!==p;m&&(p=r(p,i>2?arguments[2]:void 0));var v,_,y,b,w,E,x=f(t),O=0;if(!x||this==g&&l(x))for(v=u(t),_=n?new this(v):g(v);v>O;O++)E=m?p(t[O],O):t[O],d(_,O,E);else for(w=(b=h(t,x)).next,_=n?new this:[];!(y=o(w,b)).done;O++)E=m?s(b,p,[y.value,O],!0):y.value,d(_,O,E);return _.length=O,_}},(e,t,n)=>{var i=n(10),r=n(130);e.exports=function(e,t,n,o){try{return o?t(i(n)[0],n[1]):t(n)}catch(t){r(e,"throw",t)}}},(e,t,n)=>{"use strict";var i=n(0),r=n(3),o=2147483647,a=/[^\0-\u007E]/,s=/[.\u3002\uFF0E\uFF61]/g,l="Overflow: input needs wider integers to process",c=i.RangeError,u=r(s.exec),d=Math.floor,h=String.fromCharCode,f=r("".charCodeAt),g=r([].join),p=r([].push),m=r("".replace),v=r("".split),_=r("".toLowerCase),y=function(e){return e+22+75*(e<26)},b=function(e,t,n){var i=0;for(e=n?d(e/700):e>>1,e+=d(e/t);e>455;)e=d(e/35),i+=36;return d(i+36*e/(e+38))},w=function(e){var t=[];e=function(e){for(var t=[],n=0,i=e.length;n<i;){var r=f(e,n++);if(r>=55296&&r<=56319&&n<i){var o=f(e,n++);56320==(64512&o)?p(t,((1023&r)<<10)+(1023&o)+65536):(p(t,r),n--)}else p(t,r)}return t}(e);var n,i,r=e.length,a=128,s=0,u=72;for(n=0;n<e.length;n++)(i=e[n])<128&&p(t,h(i));var m=t.length,v=m;for(m&&p(t,"-");v<r;){var _=o;for(n=0;n<e.length;n++)(i=e[n])>=a&&i<_&&(_=i);var w=v+1;if(_-a>d((o-s)/w))throw c(l);for(s+=(_-a)*w,a=_,n=0;n<e.length;n++){if((i=e[n])<a&&++s>o)throw c(l);if(i==a){for(var E=s,x=36;;){var O=x<=u?1:x>=u+26?26:x-u;if(E<O)break;var T=E-O,R=36-O;p(t,h(y(O+T%R))),E=d(T/R),x+=36}p(t,h(y(E))),u=b(s,w,v==m),s=0,v++}}s++,a++}return g(t,"")};e.exports=function(e){var t,n,i=[],r=v(m(_(e),s,"."),".");for(t=0;t<r.length;t++)n=r[t],p(i,u(a,n)?"xn--"+w(n):n);return g(i,".")}},(e,t,n)=>{"use strict";var i=n(78),r=n(8),o=n(3),a=n(103),s=n(100),l=n(10),c=n(29),u=n(76),d=n(104),h=n(31),f=n(16),g=n(40),p=n(84),m=n(106),v=n(83),_=n(101),y=n(4),b=_.UNSUPPORTED_Y,w=4294967295,E=Math.min,x=[].push,O=o(/./.exec),T=o(x),R=o("".slice);a("split",(function(e,t,n){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var o=f(c(this)),a=void 0===n?w:n>>>0;if(0===a)return[];if(void 0===e)return[o];if(!s(e))return r(t,o,e,a);for(var l,u,d,h=[],g=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),m=0,_=new RegExp(e.source,g+"g");(l=r(v,_,o))&&!((u=_.lastIndex)>m&&(T(h,R(o,m,l.index)),l.length>1&&l.index<o.length&&i(x,h,p(l,1)),d=l[0].length,m=u,h.length>=a));)_.lastIndex===l.index&&_.lastIndex++;return m===o.length?!d&&O(_,"")||T(h,""):T(h,R(o,m)),h.length>a?p(h,0,a):h}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:r(t,this,e,n)}:t,[function(t,n){var i=c(this),a=null==t?void 0:g(t,e);return a?r(a,t,i,n):r(o,f(i),t,n)},function(e,i){var r=l(this),a=f(e),s=n(o,r,a,i,o!==t);if(s.done)return s.value;var c=u(r,RegExp),g=r.unicode,p=(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.unicode?"u":"")+(b?"g":"y"),v=new c(b?"^(?:"+r.source+")":r,p),_=void 0===i?w:i>>>0;if(0===_)return[];if(0===a.length)return null===m(v,a)?[a]:[];for(var y=0,x=0,O=[];x<a.length;){v.lastIndex=b?0:x;var S,A=m(v,b?R(a,x):a);if(null===A||(S=E(h(v.lastIndex+(b?x:0)),a.length))===y)x=d(a,x,g);else{if(T(O,R(a,y,x)),O.length===_)return O;for(var L=1;L<=A.length-1;L++)if(T(O,A[L]),O.length===_)return O;x=y=S}}return T(O,R(a,y)),O}]}),!!y((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),b)},e=>{e.exports=function(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||(!("undefined"==typeof process||"object"!=typeof process.versions||!process.versions.electron)||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}},e=>{"use strict";e.exports=r,e.exports.isMobile=r,e.exports.default=r;const t=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,n=/CrOS/,i=/android|ipad|playbook|silk/i;function r(e){e||(e={});let r=e.ua;if(r||"undefined"==typeof navigator||(r=navigator.userAgent),r&&r.headers&&"string"==typeof r.headers["user-agent"]&&(r=r.headers["user-agent"]),"string"!=typeof r)return!1;let o=t.test(r)&&!n.test(r)||!!e.tablet&&i.test(r);return!o&&e.tablet&&e.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==r.indexOf("Macintosh")&&-1!==r.indexOf("Safari")&&(o=!0),o}},(e,t,n)=>{var i=n(3),r=n(23),o=Math.floor,a=i("".charAt),s=i("".replace),l=i("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,i,d,h){var f=n+e.length,g=i.length,p=u;return void 0!==d&&(d=r(d),p=c),s(h,p,(function(r,s){var c;switch(a(s,0)){case"$":return"$";case"&":return e;case"`":return l(t,0,n);case"'":return l(t,f);case"<":c=d[l(s,1,-1)];break;default:var u=+s;if(0===u)return r;if(u>g){var h=o(u/10);return 0===h?r:h<=g?void 0===i[h-1]?a(s,1):i[h-1]+a(s,1):r}c=i[u-1]}return void 0===c?"":c}))}},e=>{e.exports=!1},(e,t,n)=>{"use strict";var i=n(9),r=n(11),o=n(0),a=n(3),s=n(12),l=n(5),c=n(30),u=n(16),d=n(17).f,h=n(120),f=o.Symbol,g=f&&f.prototype;if(r&&l(f)&&(!("description"in g)||void 0!==f().description)){var p={},m=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:u(arguments[0]),t=c(g,this)?new f(e):void 0===e?f():f(e);return""===e&&(p[t]=!0),t};h(m,f),m.prototype=g,g.constructor=m;var v="Symbol(test)"==String(f("test")),_=a(g.toString),y=a(g.valueOf),b=/^Symbol\((.*)\)[^)]+$/,w=a("".replace),E=a("".slice);d(g,"description",{configurable:!0,get:function(){var e=y(this),t=_(e);if(s(p,e))return"";var n=v?E(t,7,-1):w(t,b,"$1");return""===n?void 0:n}}),i({global:!0,constructor:!0,forced:!0},{Symbol:m})}},(e,t,n)=>{var i=n(17).f;e.exports=function(e,t,n){n in e||i(e,n,{configurable:!0,get:function(){return t[n]},set:function(e){t[n]=e}})}},(e,t,n)=>{var i=n(9),r=n(204);i({global:!0,forced:parseInt!=r},{parseInt:r})},(e,t,n)=>{var i=n(0),r=n(4),o=n(3),a=n(16),s=n(205).trim,l=n(153),c=i.parseInt,u=i.Symbol,d=u&&u.iterator,h=/^[+-]?0x/i,f=o(h.exec),g=8!==c(l+"08")||22!==c(l+"0x16")||d&&!r((function(){c(Object(d))}));e.exports=g?function(e,t){var n=s(a(e));return c(n,t>>>0||(f(h,n)?16:10))}:c},(e,t,n)=>{var i=n(3),r=n(29),o=n(16),a=n(153),s=i("".replace),l="["+a+"]",c=RegExp("^"+l+l+"*"),u=RegExp(l+l+"*$"),d=function(e){return function(t){var n=o(r(t));return 1&e&&(n=s(n,c,"")),2&e&&(n=s(n,u,"")),n}};e.exports={start:d(1),end:d(2),trim:d(3)}},(e,t,n)=>{"use strict";n.d(t,{a:()=>N});var i={};n.r(i),n.d(i,{JsonPatchError:()=>v,_areEquals:()=>S,applyOperation:()=>E,applyPatch:()=>x,applyReducer:()=>O,deepClone:()=>_,getValueByPointer:()=>w,validate:()=>R,validator:()=>T});var r={};n.r(r),n.d(r,{compare:()=>D,generate:()=>F,observe:()=>I,unobserve:()=>P});
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */
var o,a=(o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},o(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=Object.prototype.hasOwnProperty;function l(e,t){return s.call(e,t)}function c(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var i=[];for(var r in e)l(e,r)&&i.push(r);return i}function u(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function d(e){for(var t,n=0,i=e.length;n<i;){if(!((t=e.charCodeAt(n))>=48&&t<=57))return!1;n++}return!0}function h(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function f(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function g(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(g(e[t]))return!0}else if("object"==typeof e)for(var i=c(e),r=i.length,o=0;o<r;o++)if(g(e[i[o]]))return!0;return!1}function p(e,t){var n=[e];for(var i in t){var r="object"==typeof t[i]?JSON.stringify(t[i],null,2):t[i];void 0!==r&&n.push(i+": "+r)}return n.join("\n")}var m=function(e){function t(t,n,i,r,o){var a=this.constructor,s=e.call(this,p(t,{name:n,index:i,operation:r,tree:o}))||this;return s.name=n,s.index=i,s.operation=r,s.tree=o,Object.setPrototypeOf(s,a.prototype),s.message=p(t,{name:n,index:i,operation:r,tree:o}),s}return a(t,e),t}(Error),v=m,_=u,y={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=w(n,this.path);i&&(i=u(i));var r=E(n,{op:"remove",path:this.from}).removed;return E(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=w(n,this.from);return E(n,{op:"add",path:this.path,value:u(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:S(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},b={add:function(e,t,n){return d(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:y.move,copy:y.copy,test:y.test,_get:y._get};function w(e,t){if(""==t)return e;var n={op:"_get",path:t};return E(e,n),n.value}function E(e,t,n,i,r,o){if(void 0===n&&(n=!1),void 0===i&&(i=!0),void 0===r&&(r=!0),void 0===o&&(o=0),n&&("function"==typeof n?n(t,0,e,t.path):T(t,0)),""===t.path){var a={newDocument:e};if("add"===t.op)return a.newDocument=t.value,a;if("replace"===t.op)return a.newDocument=t.value,a.removed=e,a;if("move"===t.op||"copy"===t.op)return a.newDocument=w(e,t.from),"move"===t.op&&(a.removed=e),a;if("test"===t.op){if(a.test=S(e,t.value),!1===a.test)throw new v("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a.newDocument=e,a}if("remove"===t.op)return a.removed=e,a.newDocument=null,a;if("_get"===t.op)return t.value=e,a;if(n)throw new v("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return a}i||(e=u(e));var s=(t.path||"").split("/"),l=e,c=1,h=s.length,g=void 0,p=void 0,m=void 0;for(m="function"==typeof n?n:T;;){if((p=s[c])&&-1!=p.indexOf("~")&&(p=f(p)),r&&("__proto__"==p||"prototype"==p&&c>0&&"constructor"==s[c-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===g&&(void 0===l[p]?g=s.slice(0,c).join("/"):c==h-1&&(g=t.path),void 0!==g&&m(t,0,e,g)),c++,Array.isArray(l)){if("-"===p)p=l.length;else{if(n&&!d(p))throw new v("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);d(p)&&(p=~~p)}if(c>=h){if(n&&"add"===t.op&&p>l.length)throw new v("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);if(!1===(a=b[t.op].call(t,l,p,e)).test)throw new v("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}}else if(c>=h){if(!1===(a=y[t.op].call(t,l,p,e)).test)throw new v("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}if(l=l[p],n&&c<h&&(!l||"object"!=typeof l))throw new v("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}function x(e,t,n,i,r){if(void 0===i&&(i=!0),void 0===r&&(r=!0),n&&!Array.isArray(t))throw new v("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=u(e));for(var o=new Array(t.length),a=0,s=t.length;a<s;a++)o[a]=E(e,t[a],n,!0,r,a),e=o[a].newDocument;return o.newDocument=e,o}function O(e,t,n){var i=E(e,t);if(!1===i.test)throw new v("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function T(e,t,n,i){if("object"!=typeof e||null===e||Array.isArray(e))throw new v("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!y[e.op])throw new v("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new v("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new v('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new v("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new v("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&g(e.value))throw new v("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var r=e.path.split("/").length,o=i.split("/").length;if(r!==o+1&&r!==o)throw new v("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==i)throw new v("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var a=R([{op:"_get",path:e.from,value:void 0}],n);if(a&&"OPERATION_PATH_UNRESOLVABLE"===a.name)throw new v("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function R(e,t,n){try{if(!Array.isArray(e))throw new v("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)x(u(t),u(e),n||!0);else{n=n||T;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(e){if(e instanceof v)return e;throw e}}function S(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,i,r,o=Array.isArray(e),a=Array.isArray(t);if(o&&a){if((i=e.length)!=t.length)return!1;for(n=i;0!=n--;)if(!S(e[n],t[n]))return!1;return!0}if(o!=a)return!1;var s=Object.keys(e);if((i=s.length)!==Object.keys(t).length)return!1;for(n=i;0!=n--;)if(!t.hasOwnProperty(s[n]))return!1;for(n=i;0!=n--;)if(!S(e[r=s[n]],t[r]))return!1;return!0}return e!=e&&t!=t}
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */
var A=new WeakMap,L=function(e){this.observers=new Map,this.obj=e},M=function(e,t){this.callback=e,this.observer=t};function P(e,t){t.unobserve()}function I(e,t){var n,i=function(e){return A.get(e)}(e);if(i){var r=function(e,t){return e.observers.get(t)}(i,t);n=r&&r.observer}else i=new L(e),A.set(e,i);if(n)return n;if(n={},i.value=u(e),t){n.callback=t,n.next=null;var o=function(){F(n)},a=function(){clearTimeout(n.next),n.next=setTimeout(o)};"undefined"!=typeof window&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return n.patches=[],n.object=e,n.unobserve=function(){F(n),clearTimeout(n.next),function(e,t){e.observers.delete(t.callback)}(i,n),"undefined"!=typeof window&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},i.observers.set(t,new M(t,n)),n}function F(e,t){void 0===t&&(t=!1);var n=A.get(e.object);C(n.value,e.object,e.patches,"",t),e.patches.length&&x(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function C(e,t,n,i,r){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var o=c(t),a=c(e),s=!1,d=a.length-1;d>=0;d--){var f=e[p=a[d]];if(!l(t,p)||void 0===t[p]&&void 0!==f&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+h(p),value:u(f)}),n.push({op:"remove",path:i+"/"+h(p)}),s=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}),!0);else{var g=t[p];"object"==typeof f&&null!=f&&"object"==typeof g&&null!=g&&Array.isArray(f)===Array.isArray(g)?C(f,g,n,i+"/"+h(p),r):f!==g&&(!0,r&&n.push({op:"test",path:i+"/"+h(p),value:u(f)}),n.push({op:"replace",path:i+"/"+h(p),value:u(g)}))}}if(s||o.length!=a.length)for(d=0;d<o.length;d++){var p;l(e,p=o[d])||void 0===t[p]||n.push({op:"add",path:i+"/"+h(p),value:u(t[p])})}}}function D(e,t,n){void 0===n&&(n=!1);var i=[];return C(e,t,i,"",n),i}Object.assign({},i,r,{JsonPatchError:m,deepClone:u,escapePathComponent:h,unescapePathComponent:f});function N(e,t){return e.length!==t.length||e.some(((e,n)=>e!==t[n]))}},(e,t,n)=>{"use strict";n.a(e,(async(e,i)=>{try{n.d(t,{a:()=>a});var r=n(208),o=e([r]);r=(o.then?(await o)():o)[0];class a extends r.a{}i()}catch(e){i(e)}}))},(e,t,n)=>{"use strict";n.a(e,(async(e,i)=>{try{n.d(t,{a:()=>s});n(14),n(1),n(2);var r=n(235),o=n(154),a=e([o]);o=(a.then?(await a)():a)[0];class s extends r.a{async load(){const e=this.getDatas();0===e.length&&e.push(...await Promise.all(this.getUrls().map((async e=>await(0,o.a)(e)))))}}i()}catch(e){i(e)}}))},(e,t,n)=>{n(26)("Int32",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},(e,t,n)=>{var i=n(0),r=n(24),o=n(23),a=n(66),s=n(28),l=i.TypeError,c=function(e){return function(t,n,i,c){r(n);var u=o(t),d=a(u),h=s(u),f=e?h-1:0,g=e?-1:1;if(i<2)for(;;){if(f in d){c=d[f],f+=g;break}if(f+=g,e?f<0:h<=f)throw l("Reduce of empty array with no initial value")}for(;e?f>=0:h>f;f+=g)f in d&&(c=n(c,d[f],f,u));return c}};e.exports={left:c(!1),right:c(!0)}},(e,t,n)=>{"use strict";n.d(t,{a:()=>h,b:()=>f});n(201),n(14);var i=n(62),r=n(63),o=n(64),a=n(13);const s={};(0,r.b)()?(0,a.b)(o.c,"message",(e=>{const{data:t}=e;if(t instanceof Object&&"save"===t.method){const e=s[t.name]||{};for(const t in e)delete e[t];for(const n in t.value)e[n]=t.value[n];s[t.name]=e}})):(0,a.b)(o.c,"message",(e=>{const{data:t}=e;if(t instanceof Object)switch(t.method){case"load":h(t.name,t.forceLocalStorage).then((e=>{o.c.postMessage({method:"load",name:t.name,value:e,key:t.key})}));break;case"save":h(t.name).then((e=>{for(const n in t.value)e[n]=t.value[n];f(t.name,t.forceLocalStorage).then((e=>{o.c.postMessage({method:"save",name:t.name,value:t.value,key:t.key})}))}));break;case"delete":(async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,r.b)()){if(!s.hasOwnProperty(e))return;let n=(0,i.a)();return await new Promise((i=>{function r(t){const{data:l}=t;if(l instanceof Object&&l.key===n&&"delete"===l.method)(0,a.d)(o.c,"message",r),delete s[e],n=null,i(l.value)}(0,a.b)(o.c,"message",r),o.c.postMessage({method:"delete",name:e,forceLocalStorage:t,key:n})}))}delete(await h(e))[e],await f(e,t)})(t.name,t.forceLocalStorage).then((()=>{o.c.postMessage({method:"delete",name:t.name,key:t.key})}))}}));const l=function(e,t){switch(!0){case void 0===t:return{__extendData__:!0,type:"undefined",value:""};case null===t:return{__extendData__:!0,type:"null",value:""};case Number.isNaN(t):return{__extendData__:!0,type:"number",value:"NaN"};case Number.POSITIVE_INFINITY===t:return{__extendData__:!0,type:"number",value:"Infinity"};case Number.NEGATIVE_INFINITY===t:return{__extendData__:!0,type:"number",value:"-Infinity"};case t instanceof Date:return{__extendData__:!0,type:"date",value:t.toISOString()};case"symbol"==typeof t:return{__extendData__:!0,type:"symbol",value:Symbol.keyFor(t)}}return t},c=function(e,t){if("object"!=typeof t||!t.__extendData__)return t;switch(t.type){case"undefined":return;case"null":return null;case"number":switch(t.value){case"NaN":return Number.NaN;case"Infinity":case"+Infinity":return Number.POSITIVE_INFINITY;case"-Infinity":return Number.NEGATIVE_INFINITY}case"date":return new Date(t.value);case"symbol":return Symbol.for(t.value)}};async function u(e,t){let n={};try{if(!t&&"electron"in self)n=JSON.parse(JSON.stringify(await self.electron.loadStorage(e),c));else{const t=localStorage.getItem(e)||"";t&&t.length>0&&(n=JSON.parse(t,c))}}catch(n){await async function(e,t){!t&&"electron"in self?await self.electron.deleteStorage(e):localStorage.removeItem(e)}(e,t)}return n}async function d(e,t,n){try{!n&&"electron"in self?await self.electron.saveStorage(e,JSON.parse(JSON.stringify(t,l))):localStorage.setItem(e,JSON.stringify(t,l))}catch(t){console.error('"'.concat(e,'" is define local storage.'))}}async function h(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};if((0,r.b)()){if(s.hasOwnProperty(e))return s[e];let r=(0,i.a)();n=await new Promise((n=>{const i=e=>{const{data:t}=e;if(t instanceof Object&&t.key===r&&"load"===t.method)(0,a.d)(o.c,"message",i),s[t.name]=t.value,n(t.value)};(0,a.b)(o.c,"message",i),o.c.postMessage({method:"load",name:e,forceLocalStorage:t,key:r})}))}else s.hasOwnProperty(e)||(s[e]=await u(e,t)),n=s[e];return n}async function f(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,r.b)()){if(!s.hasOwnProperty(e))return;let n=(0,i.a)();await new Promise((i=>{const r=e=>{const{data:t}=e;if(t instanceof Object&&t.key===n&&"save"===t.method)(0,a.d)(o.c,"message",r),n=null,i(null)};(0,a.b)(o.c,"message",r),o.c.postMessage({method:"save",name:e,value:s[e],forceLocalStorage:t,key:n})}))}else s.hasOwnProperty(e)&&await d(e,s[e],t)}},(e,t,n)=>{"use strict";n.d(t,{a:()=>u,b:()=>h});n(1),n(2),n(34),n(196),n(20),n(21),n(33);var i=n(62),r=n(13),o=n(85),a=n(52);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const c=new WeakMap;class u{constructor(e){l(this,"id",(0,i.a)()),l(this,"names",void 0),l(this,"components",new WeakMap),l(this,"live",!0),l(this,"isUpdate",!0);for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.setComponents(...n),this.names="".concat(e.length>0?"".concat(e," "):"").concat(this.id).split(" ")}getID(){return this.id}getNames(){return[...this.names]}addNames(){for(let e=0,t=0|arguments.length;e<t;e=e+1|0){const t=e<0||arguments.length<=e?void 0:arguments[e];this.names.includes(t)||(this.names.push(t),this.isUpdate=!0)}}removeNames(){for(let e=0,t=0|arguments.length;e<t;e=e+1|0){const t=e<0||arguments.length<=e?void 0:arguments[e];this.names.includes(t)&&(this.names.splice(this.names.indexOf(t),1),this.isUpdate=!0)}}setComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((e=>{if(!e)return;let t=e;do{this.components.set(t.constructor,e)}while(null!==(t=t.constructor.prototype.__proto__));this.isUpdate=!0}))}getComponent(e){return this.components.get(e)}hasComponent(e){return this.components.has(e)}removeComponent(e){this.components.has(e)&&(this.components.delete(e),this.isUpdate=!0)}checkUpdate(){const{isUpdate:e}=this;return this.isUpdate=!1,e}hasUpdate(){return this.isUpdate}hasLive(){return this.live}remove(){this.live=!1}destroy(){}}class d{constructor(e){l(this,"id",(0,i.a)()),l(this,"entity",void 0),l(this,"components",new Array),this.entity=e;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.components.push(...n)}hasEntity(e){return e instanceof this.entity&&!this.components.some((t=>!e.hasComponent(t)))}additional(e,t,n){}movable(e,t,n){}physical(e,t,n){}offset(e,t,n){}preadditional(e,t){}premovable(e,t){}prephysical(e,t){}preoffset(e,t){}ended(e,t){}preended(e){}rendering(e,t){}destructor(e,t){}}class h extends class{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];s(this,"maxFrameSkipCount",20),s(this,"speed",1),s(this,"framerate",60),s(this,"updateCount",0),s(this,"tickFps",60),s(this,"paintFps",60),s(this,"reqAnim",-1),s(this,"timeout",-1),s(this,"updateTime",-1),s(this,"nextGameTick",-1),s(this,"paintTime",-1),s(this,"skipFrameCount",-1),s(this,"oldTime",-1),s(this,"stackTick",0),s(this,"isSleep",!1),s(this,"isError",!1),s(this,"isUpdateDefault",!1),s(this,"isPaintDefault",!1),s(this,"useAnimationFrame",void 0),(0,r.b)((0,a.d)(),"error",(()=>{this.error()})),this.useAnimationFrame=e}reset(){let e=!1;return-1!==this.reqAnim&&((0,a.b)(this.reqAnim),e=!0),this.updateTime=-1,this.nextGameTick=-1,this.paintTime=-1,this.reqAnim=-1,this.oldTime=-1,e}error(){this.isError=!0,this.stop(),new r.a(this,"error").trigger()}sleep(){this.isSleep=!0,new r.a(this,"sleep").trigger({})}unsleep(){this.isSleep=!1,new r.a(this,"unsleep").trigger()}updateDefault(){this.isUpdateDefault=!0}paintDefault(){this.isPaintDefault=!0}getFramerate(){return this.framerate}getTickFramerate(){return this.tickFps}getPaintFramerate(){return this.paintFps}setTickFramerate(e){this.tickFps=e}setPaintFramerate(e){this.paintFps=e}tickFunc(e){this.requestTick();const t=Math.min(240,this.getTickFramerate()),n=Math.min(240,this.getPaintFramerate()),i=1e3/n;if(-1===this.updateTime&&(this.updateTime=e),-1===this.nextGameTick&&(this.nextGameTick=e),-1===this.paintTime&&(this.paintTime=e),-1===this.oldTime&&(this.oldTime=e),this.isSleep)return this.updateTime=e,this.paintTime=e,this.nextGameTick=e,void(this.oldTime=e);const s=Math.max(0,e-this.updateTime);this.updateTime=e;const l=(0,o.b)(1e3/s,t);let c=0;if(this.isPaintDefault||0===c&&this.updateCount>0){if(Math.max(0,e-this.paintTime)>=i){const t=(0,o.b)(i,n);if(this.framerate=Math.min(t,n),this.useAnimationFrame){if(-1===this.reqAnim){const o=()=>{this.isPaintDefault?this.reqAnim=(0,a.e)(o):this.reqAnim=-1,new r.a(this,"paint").trigger({now:e,framerate:t,fps:n})};this.reqAnim=(0,a.e)(o),this.isPaintDefault=!1,this.paintTime+=i}}else new r.a(this,"paint").trigger({now:e,framerate:t,fps:n}),this.isPaintDefault=!1,this.paintTime+=i}else this.isPaintDefault=!0}let u=this.oldTime;do{const t=c<=0?e:performance.now(),n=t-u+this.stackTick,i=60/(1e3/n/(1e3/60)),o=n/(1e3/60)*this.speed;if(0===c&&new r.a(this,"updatebegin").trigger({now:e,framerate:l,fps:this.getTickFramerate(),updateCount:this.updateCount}),new r.a(this,"update").trigger({time:o,now:e,framerate:i,fps:this.getTickFramerate(),updateIndex:c}),this.nextGameTick+=n,this.stackTick=0,u=t,c++,this.nextGameTick>e){this.skipFrameCount=Math.min(this.maxFrameSkipCount,this.skipFrameCount+.5);break}if(c>=this.skipFrameCount){this.skipFrameCount=Math.max(1,this.skipFrameCount-1|0),this.stackTick=e-this.nextGameTick;break}}while(this.nextGameTick<=e);this.oldTime=u;const d=Math.max(0,s-(performance.now()-e));(c>0||this.isUpdateDefault)&&(this.isUpdateDefault=!1,new r.a(this,"updateend").trigger({time:d/(1e3/60),now:e,framerate:l,fps:this.getTickFramerate(),updateCount:c})),this.updateCount=c}requestTick(){-1===this.timeout&&(this.timeout=(0,a.f)((()=>{const e=performance.now();this.timeout=-1,this.tickFunc(e)})))}cancelTick(){return-1!==this.timeout&&((0,a.c)(this.timeout),this.timeout=-1,!0)}run(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!(this.isError||this.hasRun()||this.isSleep&&!e)&&(this.reset(),this.isSleep=!1,this.requestTick(),!0)}stop(){return!this.hasRun()||(this.reset(),this.cancelTick())}getNowFramerate(){return this.framerate}hasRun(){return-1!==this.timeout}hasSleep(){return this.isSleep}getSpeed(){return this.speed}setSpeed(e){this.speed=e}clear(){this.setSpeed(1)}}{constructor(){super(...arguments),l(this,"id",(0,i.a)()),l(this,"additionals",new Array),l(this,"movables",new Array),l(this,"physicals",new Array),l(this,"offsets",new Array),l(this,"preadditionals",new Array),l(this,"premovables",new Array),l(this,"prephysicals",new Array),l(this,"preoffsets",new Array),l(this,"preendeds",new Array),l(this,"endeds",new Array),l(this,"renderings",new Array),l(this,"destructors",new Array),l(this,"heapSystem",new WeakMap),l(this,"entitys",new Array),l(this,"stands",new Array),l(this,"entitysID",{}),l(this,"entitysName",{})}getID(){return this.id}addSystems(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((e=>{e.additional!==d.prototype.additional&&this.additionals.push(e),e.movable!==d.prototype.movable&&this.movables.push(e),e.physical!==d.prototype.physical&&this.physicals.push(e),e.offset!==d.prototype.offset&&this.offsets.push(e),e.preadditional!==d.prototype.preadditional&&this.preadditionals.push(e),e.premovable!==d.prototype.premovable&&this.premovables.push(e),e.prephysical!==d.prototype.prephysical&&this.prephysicals.push(e),e.preoffset!==d.prototype.preoffset&&this.preoffsets.push(e),e.ended!==d.prototype.ended&&this.endeds.push(e),e.preended!==d.prototype.preended&&this.preendeds.push(e),e.rendering!==d.prototype.rendering&&this.renderings.push(e),e.destructor!==d.prototype.destructor&&this.destructors.push(e)}))}checkEntitys(){for(;this.stands.length>0;){const e=this.stands.shift()||null;null!==e&&(this.entitys.push(e),this.entitysID[e.getID()]=e)}}syncEntitys(){const e=[...this.additionals,...this.movables,...this.physicals,...this.offsets,...this.renderings,...this.destructors];for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(let t=0,i=0|n.length;t<i;t=t+1|0){const i=n[t],r=i.getNames();for(let e=0,t=0|r.length;e<t;e=e+1|0){const t=r[e];this.entitysName.hasOwnProperty(t)||(this.entitysName[t]=new Array);const n=this.entitysName[t]||null;null===n||n.includes(i)||n.push(i)}const o=c.get(i)||[];for(let e=0,t=0|o.length;e<t;e=e+1|0){const t=o[e],n=this.entitysName[t]||null;null!==n&&n.includes(i)&&(n.splice(n.indexOf(i),1),0===n.length&&delete this.entitysName[t])}c.set(i,r);for(let t=0,n=0|e.length;t<n;t=t+1|0){const n=e[t];this.heapSystem.has(n)||this.heapSystem.set(n,new Array);const r=this.heapSystem.get(n)||[];n.hasEntity(i)?r.includes(i)||r.push(i):r.includes(i)&&r.splice(r.indexOf(i),1)}}new r.a(this,"syncentity").trigger({entitys:n})}addEntitys(){for(let e=0,t=0|arguments.length;e<t;e=e+1|0){const t=e<0||arguments.length<=e?void 0:arguments[e];this.entitys.includes(t)||this.stands.includes(t)||this.stands.push(t)}}removeEntitys(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=[...this.additionals,...this.movables,...this.physicals,...this.offsets];for(let e=0,n=0|this.destructors.length;e<n;e=e+1|0){const n=this.destructors[e],i=(this.heapSystem.get(n)||[]).slice().filter((e=>t.includes(e)));for(let e=0,t=0|i.length;e<t;e=e+1|0){const t=i[e];(!t.hasUpdate()||n.hasEntity(t))&&n.destructor(t,this)}}for(let e=0,n=0|t.length;e<n;e=e+1|0){const n=t[e];this.entitys.splice(this.entitys.indexOf(n),1),delete this.entitysID[n.getID()];const r=n.getNames();for(let e=0,t=0|r.length;e<t;e=e+1|0){const t=r[e],i=this.entitysName[t]||null;null!==i&&i.includes(n)&&(i.splice(i.indexOf(n),1),0===i.length&&delete this.entitysName[t])}n.destroy();for(let e=0,t=0|i.length;e<t;e=e+1|0){const t=i[e],r=this.heapSystem.get(t)||[];r.includes(n)&&r.splice(r.indexOf(n),1)}}new r.a(this,"removeentity").trigger({entitys:t})}hasEntity(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some((e=>e.hasLive()&&-1!==Object.keys(this.entitys).indexOf(e.getID())))}getEntitys(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>!0;return this.entitys.filter((t=>t.hasLive()&&e(t)))}getEntityOfID(e){if(!this.entitysID.hasOwnProperty(e))return null;const t=this.entitysID[e];return t.hasLive()?t:null}getEntitysOfName(){const e=new Array;for(let t=0,n=0|arguments.length;t<n;t=t+1|0){const n=t<0||arguments.length<=t?void 0:arguments[t];this.entitysName.hasOwnProperty(n)&&e.push(...this.entitysName[n].filter((t=>t.hasLive()&&!e.includes(t))))}return e}clear(){for(let e=0,t=0|this.stands.length;e<t;e=e+1|0)this.stands[e].remove();for(let e=0,t=0|this.entitys.length;e<t;e=e+1|0)this.entitys[e].remove();super.clear()}onupdate(e){const{time:t,now:n,framerate:i,fps:o}=e;new r.a(this,"ecsbegin").trigger({time:t,now:n,framerate:i,fps:o});const a=new Array,s=new Array;for(let e=0,t=0|this.entitys.length;e<t;e=e+1|0){const t=this.entitys[e];if(t.hasLive()){if(!t.checkUpdate())continue;a.push(t)}else s.push(t)}a.length>0&&this.syncEntitys(...a),s.length>0&&this.removeEntitys(...s);for(let e=0,n=0|this.preadditionals.length;e<n;e=e+1|0){this.preadditionals[e].preadditional(t,this)}for(let e=0,n=0|this.additionals.length;e<n;e=e+1|0){const n=this.additionals[e],i=(this.heapSystem.get(n)||[]).slice();for(let e=0,r=0|i.length;e<r;e=e+1|0){const r=i[e];r.hasLive()&&(!r.hasUpdate()||n.hasEntity(r))&&n.additional(t,r,this)}}for(let e=0,n=0|this.premovables.length;e<n;e=e+1|0){this.premovables[e].premovable(t,this)}for(let e=0,n=0|this.movables.length;e<n;e=e+1|0){const n=this.movables[e],i=(this.heapSystem.get(n)||[]).slice();for(let e=0,r=0|i.length;e<r;e=e+1|0){const r=i[e];r.hasLive()&&(!r.hasUpdate()||n.hasEntity(r))&&n.movable(t,r,this)}}for(let e=0,n=0|this.prephysicals.length;e<n;e=e+1|0){this.prephysicals[e].prephysical(t,this)}for(let e=0,n=0|this.physicals.length;e<n;e=e+1|0){const n=this.physicals[e],i=(this.heapSystem.get(n)||[]).slice();for(let e=0,r=0|i.length;e<r;e=e+1|0){const r=i[e];r.hasLive()&&(!r.hasUpdate()||n.hasEntity(r))&&n.physical(t,r,this)}}for(let e=0,n=0|this.preoffsets.length;e<n;e=e+1|0){this.preoffsets[e].preoffset(t,this)}for(let e=0,n=0|this.offsets.length;e<n;e=e+1|0){const n=this.offsets[e],i=(this.heapSystem.get(n)||[]).slice();for(let e=0,r=0|i.length;e<r;e=e+1|0){const r=i[e];r.hasLive()&&(!r.hasUpdate()||n.hasEntity(r))&&n.offset(t,r,this)}}for(let e=0,t=0|this.preendeds.length;e<t;e=e+1|0){this.preendeds[e].preended(this)}for(let e=0,t=0|this.endeds.length;e<t;e=e+1|0){const t=this.endeds[e],n=(this.heapSystem.get(t)||[]).slice();for(let e=0,i=0|n.length;e<i;e=e+1|0){const i=n[e];i.hasLive()&&(!i.hasUpdate()||t.hasEntity(i))&&t.ended(i,this)}}this.checkEntitys(),new r.a(this,"ecsend").trigger({time:t,now:n,framerate:i,fps:o})}onpaint(e){for(let e=0,t=0|this.renderings.length;e<t;e=e+1|0){const t=this.renderings[e],n=(this.heapSystem.get(t)||[]).slice();for(let e=0,i=0|n.length;e<i;e=e+1|0){const i=n[e];i.hasLive()&&(!i.hasUpdate()||t.hasEntity(i))&&t.rendering(i,this)}}}}},(e,t,n)=>{"use strict";function i(){return"localhost"===location.hostname}n.d(t,{a:()=>i})},(e,t,n)=>{"use strict";n.a(e,(async(e,t)=>{try{n(1),n(2),n(14);var i=n(222),r=n(236),o=n(13),a=n(211),s=n(52),l=n(248),c=n(160),u=n(251),d=n(252),h=n(46),f=n(65),g=n(155),p=e([i,r,c,d,h]);[i,r,c,d,h]=p.then?(await p)():p;const m=new i.a(c.a,64);let v=null,_=null,y=null;const b=(0,h.a)(0,0);let w=null,E=null,x=null,O=-1,T=-1,R=!1,S=!1,A=!1,L=0,M=0,P=0,I=new Array,F=!1,C=!1,D=!1,N=!1,k={camera:{position:{x:0,y:0,z:0},direction:{x:0,y:0,z:0},fov:1,hudFov:1,zoom:1,light:0},sun:{direction:{x:0,y:0}},voxel_field:{width:1,height:1,depth:1,distance:1/0,data:(0,f.a)("int32",1)},distance_field:{width:1,height:1,depth:1,data:(0,f.a)("int32",1)},materials:{width:0,height:0,depth:0,data:(0,f.a)("int32",1)},voxels:{width:g.d,height:1,depth:1,data:(0,f.a)("float32",g.d)},resolution:{width:1,height:1},cluster_resolution:{width:1,height:1},billboard_datas:(0,f.a)("float32",g.a),billboard_length:1,background:{theme:0,rise_up_color:[0,0,0],night_up_color:[0,0,0],rise_down_color:[0,0,0],night_down_color:[0,0,0],material_up:[0,0,0],material_down:[0,0,0],noise_size:0,noise_length:0},lateTime:0};function B(){S=!0,V()}function U(e){D&&(z(),D=!1),I.push(e),C=!1}function z(){if(C||!v)return!1;const e={assets:m.createTransferData()};return v.postMessage({method:"apply-render-data",update:e,fps:P}),C=!0,!0}function G(){-1===T&&(T=(0,s.f)((()=>{T=-1,Z()})))}function X(){-1===O&&(O=(0,s.e)((e=>{O=-1,K(e)})))}function H(){!S&&R||(R=!0,G(),X())}function V(){R&&(R=!1,(0,s.c)(T),(0,s.b)(O),T=-1,O=-1)}function Y(){if(N){if(A){var e;const n=(null===(t=w)||void 0===t?void 0:t.getImageBitmapSync(!0))||null,i=[];("ImageBitmap"in self&&n instanceof ImageBitmap||"OffscreenCanvas"in self&&n instanceof self.OffscreenCanvas)&&i.push(n),null===(e=_)||void 0===e||e.postMessage({method:"transfer-render-bitmap",value:n},i)}var t;N=!1}}function j(){var e,t;if(null!==(e=x)&&void 0!==e&&e.hasCRT())null===(t=w)||void 0===t||t.setScreen(b);else if(null!==y){var n;null===(n=w)||void 0===n||n.setScreen(y)}}function W(){var e;j(),null===(e=w)||void 0===e||e.rendering(k,m)}function q(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const n=!(null===(e=x)||void 0===e||!e.hasCRT());A!==n&&(t?j():(0,s.d)().postMessage({method:"recompile"})),A=n}function Z(){G(),Y()}function K(e){if(X(),Y(),null!==x){var t;const[e,n]=(0,u.b)(x,u.a);null===(t=w)||void 0===t||t.setScreenSize(e,n)}if(q(),!(I.length<=0)){for(z()||(D=!0),e-L>1e3&&(L=e,P=M,M=0);I.length>0;){var n;const e=I.shift()||null;null!==e&&(null===(n=w)||void 0===n||n.rendering(e,m))}N=!0,M++}}async function J(e){E=await(0,a.a)("setting"),x=new d.a(E),y=e.screen,q(!0),w=new r.a(E,y,e.maxTextureSize,1/0),new o.a(w,"recompile").on((()=>{(0,s.d)().postMessage({method:"paintwait"}),null===l.a||void 0===l.a||l.a.postMessage({method:"paintwait"});const e=setInterval((()=>{var t;null!==(t=w)&&void 0!==t&&t.hasFinish()&&(clearInterval(e),(0,s.d)().postMessage({method:"unlockpaintwait"}),null===l.a||void 0===l.a||l.a.postMessage({method:"unlockpaintwait"}))}))})),new o.a(w,"lostcontext").on((()=>{(0,s.d)().postMessage({method:"lostcontext"}),l.a.postMessage({method:"lostcontext"})})),new o.a(w,"contextrestored").on((()=>{var e;(0,s.d)().postMessage({method:"contextrestored"}),l.a.postMessage({method:"contextrestored"}),null===(e=w)||void 0===e||e.destroy()}))}(0,o.b)((0,s.d)(),"error",(e=>{B(),(0,s.d)().postMessage({method:"error"}),l.b.postMessage({method:"error"}),l.a.postMessage({method:"error"})})),(0,o.b)(l.a,"message",(e=>{var t;const{data:n}=e;if("loadstart"===n.method||n instanceof Object&&F)switch(n.method){case"run":case"unsleep":case"unlockpaintwait":H();break;case"stop":case"sleep":case"paintwait":V();break;case"error":B();break;case"contextrestored":null===(t=w)||void 0===t||t.destroy();break;case"loadstart":m.load((()=>l.a.postMessage({method:"loadcount"})))}})),(0,o.b)((0,s.d)(),"message",(e=>{var t,n,i;const{data:r}=e;if(r instanceof Object)switch(r.method){case"portready":v=r.RaycastChannel,_=r.RaycastScreenChannel,null!==v&&(0,o.b)(v,"message",(e=>{const{data:t}=e;if(t instanceof Object&&"transfer-render"===t.method)U(t.value)})),(0,s.d)().postMessage({method:"portready"});break;case"portstart":null===(t=v)||void 0===t||t.start(),null===(n=_)||void 0===n||n.start(),(0,s.d)().postMessage({method:"portstart"});break;case"init":J(r.value).then((()=>(0,s.d)().postMessage({method:"ready"})));break;case"start":F=!0,W(),H();break;case"recompile":W();break;case"close":V(),m.destroy(),null===(i=w)||void 0===i||i.destroy(),(0,o.c)(),(0,s.d)().postMessage({method:"terminate"})}})),(0,s.d)().postMessage({method:"standby"}),t()}catch(Q){t(Q)}}))},(e,t,n)=>{var i=n(11),r=n(112),o=n(17),a=n(10),s=n(54),l=n(114);t.f=i&&!r?Object.defineProperties:function(e,t){a(e);for(var n,i=s(t),r=l(t),c=r.length,u=0;c>u;)o.f(e,n=r[u++],i[n]);return e}},(e,t,n)=>{"use strict";var i,r,o,a=n(9),s=n(22),l=n(57),c=n(0),u=n(8),d=n(18),h=n(43),f=n(42),g=n(75),p=n(24),m=n(5),v=n(15),_=n(58),y=n(76),b=n(77).set,w=n(128),E=n(172),x=n(98),O=n(173),T=n(25),R=n(45),S=n(59),A=n(80),L="Promise",M=S.CONSTRUCTOR,P=S.REJECTION_EVENT,I=S.SUBCLASSING,F=T.getterFor(L),C=T.set,D=R&&R.prototype,N=R,k=D,B=c.TypeError,U=c.document,z=c.process,G=A.f,X=G,H=!!(U&&U.createEvent&&c.dispatchEvent),V="unhandledrejection",Y=function(e){var t;return!(!v(e)||!m(t=e.then))&&t},j=function(e,t){var n,i,r,o=t.value,a=1==t.state,s=a?e.ok:e.fail,l=e.resolve,c=e.reject,d=e.domain;try{s?(a||(2===t.rejection&&J(t),t.rejection=1),!0===s?n=o:(d&&d.enter(),n=s(o),d&&(d.exit(),r=!0)),n===e.promise?c(B("Promise-chain cycle")):(i=Y(n))?u(i,n,l,c):l(n)):c(o)}catch(e){d&&!r&&d.exit(),c(e)}},W=function(e,t){e.notified||(e.notified=!0,w((function(){for(var n,i=e.reactions;n=i.get();)j(n,e);e.notified=!1,t&&!e.rejection&&Z(e)})))},q=function(e,t,n){var i,r;H?((i=U.createEvent("Event")).promise=t,i.reason=n,i.initEvent(e,!1,!0),c.dispatchEvent(i)):i={promise:t,reason:n},!P&&(r=c["on"+e])?r(i):e===V&&E("Unhandled promise rejection",n)},Z=function(e){u(b,c,(function(){var t,n=e.facade,i=e.value;if(K(e)&&(t=x((function(){l?z.emit("unhandledRejection",i,n):q(V,n,i)})),e.rejection=l||K(e)?2:1,t.error))throw t.value}))},K=function(e){return 1!==e.rejection&&!e.parent},J=function(e){u(b,c,(function(){var t=e.facade;l?z.emit("rejectionHandled",t):q("rejectionhandled",t,e.value)}))},Q=function(e,t,n){return function(i){e(t,i,n)}},$=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,W(e,!0))},ee=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw B("Promise can't be resolved itself");var i=Y(t);i?w((function(){var n={done:!1};try{u(i,t,Q(ee,n,e),Q($,n,e))}catch(t){$(n,t,e)}})):(e.value=t,e.state=1,W(e,!1))}catch(t){$({done:!1},t,e)}}};if(M&&(k=(N=function(e){_(this,k),p(e),u(i,this);var t=F(this);try{e(Q(ee,t),Q($,t))}catch(e){$(t,e)}}).prototype,(i=function(e){C(this,{type:L,done:!1,notified:!1,parent:!1,reactions:new O,rejection:!1,state:0,value:void 0})}).prototype=d(k,"then",(function(e,t){var n=F(this),i=G(y(this,N));return n.parent=!0,i.ok=!m(e)||e,i.fail=m(t)&&t,i.domain=l?z.domain:void 0,0==n.state?n.reactions.add(i):w((function(){j(i,n)})),i.promise})),r=function(){var e=new i,t=F(e);this.promise=e,this.resolve=Q(ee,t),this.reject=Q($,t)},A.f=G=function(e){return e===N||undefined===e?new r(e):X(e)},!s&&m(R)&&D!==Object.prototype)){o=D.then,I||d(D,"then",(function(e,t){var n=this;return new N((function(e,t){u(o,n,e,t)})).then(e,t)}),{unsafe:!0});try{delete D.constructor}catch(e){}h&&h(D,k)}a({global:!0,constructor:!0,wrap:!0,forced:M},{Promise:N}),f(N,L,!1,!0),g(L)},(e,t,n)=>{"use strict";var i=n(9),r=n(8),o=n(24),a=n(80),s=n(98),l=n(129);i({target:"Promise",stat:!0,forced:n(131)},{all:function(e){var t=this,n=a.f(t),i=n.resolve,c=n.reject,u=s((function(){var n=o(t.resolve),a=[],s=0,u=1;l(e,(function(e){var o=s++,l=!1;u++,r(n,t,e).then((function(e){l||(l=!0,a[o]=e,--u||i(a))}),c)})),--u||i(a)}));return u.error&&c(u.value),n.promise}})},(e,t,n)=>{"use strict";var i=n(9),r=n(22),o=n(59).CONSTRUCTOR,a=n(45),s=n(27),l=n(5),c=n(18),u=a&&a.prototype;if(i({target:"Promise",proto:!0,forced:o,real:!0},{catch:function(e){return this.then(void 0,e)}}),!r&&l(a)){var d=s("Promise").prototype.catch;u.catch!==d&&c(u,"catch",d,{unsafe:!0})}},(e,t,n)=>{"use strict";var i=n(9),r=n(8),o=n(24),a=n(80),s=n(98),l=n(129);i({target:"Promise",stat:!0,forced:n(131)},{race:function(e){var t=this,n=a.f(t),i=n.reject,c=s((function(){var a=o(t.resolve);l(e,(function(e){r(a,t,e).then(n.resolve,i)}))}));return c.error&&i(c.value),n.promise}})},(e,t,n)=>{"use strict";var i=n(9),r=n(8),o=n(80);i({target:"Promise",stat:!0,forced:n(59).CONSTRUCTOR},{reject:function(e){var t=o.f(this);return r(t.reject,void 0,e),t.promise}})},(e,t,n)=>{"use strict";var i=n(9),r=n(27),o=n(22),a=n(45),s=n(59).CONSTRUCTOR,l=n(133),c=r("Promise"),u=o&&!s;i({target:"Promise",stat:!0,forced:o||s},{resolve:function(e){return l(u&&this===c?a:this,e)}})},(e,t,n)=>{"use strict";n.a(e,(async(e,i)=>{try{n.d(t,{a:()=>u});n(33),n(14),n(1),n(2);var r=n(13),o=n(223),a=n(35),s=n(207),l=e([o,s]);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}[o,s]=l.then?(await l)():l;class u{constructor(e,t){c(this,"texture",void 0),c(this,"assets",{}),c(this,"isUpdate",!0),this.texture=t?new o.a(t):null,e.forEach((e=>e.getUrls().forEach((t=>this.assets[t.toLowerCase()]=e))))}getTexture(){return this.texture}getBufferLocation(e,t){const n=this.getAssetSource(e);if(null===n)return 0;const i=n.locations[t]||null,r=null!==i&&i[0]||null;return null===r?0:r.id}getAssetSource(e){return this.assets.hasOwnProperty(e)&&this.assets[e].getDatas()[0]||null}hasAsset(e){return this.assets.hasOwnProperty(e)}getAssetLenght(){return Object.keys(this.assets).length}async load(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};const t=Object.keys(this.assets);await Promise.all(t.map((t=>this.assets[t].load().then(e))));for(const e in this.assets){const t=this.assets[e];if(null!==this.texture&&t instanceof s.a){const e=t.getLocations(),n=t.getDatas();e.push(...this.texture.load(n[0],n[1],n[2]))}}this.isUpdate=!0}unload(){for(const e in this.assets){const t=this.assets[e],n=t.getLocations();null!==this.texture&&t instanceof s.a&&this.texture.unload(...n),(0,a.a)(n)}this.isUpdate=!0}checkUpdate(){const{isUpdate:e}=this;return this.isUpdate=!1,e}createTransferData(){const e={};for(const t in this.assets){const n=this.assets[t];n.hasTransfer()||(e[t]=n.createTransferData())}return{assets:e,isUpdate:this.checkUpdate()}}destroy(){this.unload(),new r.a(this,"destroy").trigger(this)}}i()}catch(d){i(d)}}))},(e,t,n)=>{"use strict";n.a(e,(async(e,i)=>{try{n.d(t,{a:()=>f});n(14),n(33),n(1),n(2);var r=n(267),o=n(6),a=n(46),s=n(154),l=n(35),c=e([a,s]);function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}[a,s]=c.then?(await c)():c;class d{constructor(e,t){u(this,"buffer",void 0),this.buffer=(0,a.a)(e,t)}get width(){return this.buffer.width}set width(e){this.buffer.width=0|e}get height(){return this.buffer.height}set height(e){this.buffer.height=0|e}getContext(){return this.buffer.getContext("2d")}async toDataURL(){const e=this.buffer;let t;return 0===e.width||0===e.height?"data:,":(a.b&&e instanceof OffscreenCanvas?t=await e.convertToBlob():e instanceof HTMLCanvasElement&&(t=await new Promise((t=>e.toBlob((e=>{e instanceof Blob&&t(e)}))))),await new Promise((e=>{const n=new FileReader;n.onload=()=>{const t=n.result;"string"==typeof t&&e(t)},n.readAsDataURL(t)})))}async transferToImageBitmap(){const e=this.buffer;return a.b&&e instanceof OffscreenCanvas?e.transferToImageBitmap():await(0,s.a)(await this.toDataURL())}getBuffer(){return this.buffer}}class h{constructor(e,t,n){u(this,"id",void 0),u(this,"position",void 0),this.id=e,this.position=new o.b(t,n)}}class f{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:64;u(this,"bufferIDCount",0),u(this,"isUpdate",!0),u(this,"albedoBuffer",new d(0,0)),u(this,"pbrBuffer",new d(0,0)),u(this,"normalBuffer",new d(0,0)),u(this,"unloadBufferIDCache",new Array),u(this,"tile_size",64),this.tile_size=e}getID(){(0,l.c)(this.unloadBufferIDCache).asc();let e=this.unloadBufferIDCache.shift();return void 0===e&&(e=this.bufferIDCount++),e}unloadID(e){this.unloadBufferIDCache.push(e)}getSize(){return[this.albedoBuffer.width,this.albedoBuffer.height]}getTileSize(){return this.tile_size}getBuffer(){return{albedo:this.albedoBuffer.getBuffer(),pbr:this.pbrBuffer.getBuffer(),normal:this.normalBuffer.getBuffer()}}checkUpdate(){const e=this.isUpdate;return this.isUpdate=!1,e}load(e,t,n){const i=new Array,o=new Array,a=new Array;[...new Array(e.width/this.tile_size*e.height/this.tile_size).fill(null)].forEach((()=>{const e=this.getID(),[t,n]=(0,r.a)(e);i.push(e),o.push(t*this.tile_size),a.push(n*this.tile_size)}));const s=i.map(((i,r)=>[{source:e,buffer:this.albedoBuffer},{source:t,buffer:this.pbrBuffer},{source:n,buffer:this.normalBuffer}].map((e=>{let{source:t,buffer:n}=e;const s=o[r],l=a[r],c=Math.max(...o),u=Math.max(...a),f=Math.max(t.width,c+this.tile_size,t.height,u+this.tile_size);if(0===n.width||0===n.height)n.width=f,n.height=f;else if(f>n.width||f>n.height){const e=new d(f,f),t=e.getContext();null!==t&&(t.imageSmoothingEnabled=!1,t.drawImage(n.getBuffer(),0,0)),n.width=0|f,n.height=0|f;const i=n.getContext();null!==i&&(i.imageSmoothingEnabled=!0,i.clearRect(0,0,n.width,n.height),i.drawImage(e.getBuffer(),0,0))}let g,p;t.width<=r*this.tile_size?(g=this.tile_size*r%t.width,p=Math.floor(this.tile_size*r/t.width)*this.tile_size):(g=r*this.tile_size,p=0);const m=n.getContext();return null!==m&&(m.imageSmoothingEnabled=!1,m.drawImage(t,g,p,this.tile_size,this.tile_size,s,l,this.tile_size,this.tile_size)),new h(i,s,l)}))));return this.isUpdate=!0,s}unload(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];[this.albedoBuffer,this.pbrBuffer,this.normalBuffer].forEach((e=>{t.forEach((t=>{const n=new Array,i=new Array;t.forEach((e=>{n.push(e.position.x),i.push(e.position.y),this.unloadID(e.id)}));const r=0===n.length?0:Math.min(...n),o=0===i.length?0:Math.min(...i),a=Math.max(Math.min(e.width,r),Math.min(e.height,o));if(0===a||0===a)e.width=0,e.height=0;else if(a<e.width||a<e.height){const t=new d(a,a),n=t.getContext();null!==n&&(n.imageSmoothingEnabled=!1,n.drawImage(e.getBuffer(),0,0)),e.width=0|t.width,e.height=0|t.height;const i=e.getContext();null!==i&&(i.imageSmoothingEnabled=!0,i.clearRect(0,0,e.width,e.height),i.drawImage(t.getBuffer(),0,0))}this.isUpdate=!0,0!==e.width&&0!==e.height&&t.forEach((t=>{const n=t.position.x,i=t.position.y;if(n<e.width&&i<e.height){const t=e.getContext();null!==t&&(t.imageSmoothingEnabled=!1,t.clearRect(n,i,this.tile_size,this.tile_size))}}))}))}))}}i()}catch(g){i(g)}}))},(e,t,n)=>{"use strict";n.d(t,{a:()=>a});n(34),n(190),n(146),n(14),n(1),n(2),n(148),n(151);var i=n(13),r=n(227);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class a{constructor(e,t){o(this,"worker",void 0),o(this,"source",void 0);const n=t.toString().match(/^function\s*\w*\s*\([\w\s,]*\)\s*{([\w\W]*?)}$/),i=(0,r.b)("text/javascript",null!==n?n.length>2?"\n\t\t\tonmessage = (".concat(n[1],") => {\n\t\t\t\t").concat(n[2],"\n\t\t\t};\n\t\t"):"\n\t\t\tonmessage = () => {\n\t\t\t\t".concat(n[1],"\n\t\t\t};\n\t\t"):"");this.source=i,this.worker=new e(i)}exec(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Promise(((t,n)=>{const r=e=>{(0,i.d)(this.worker,"message",r),(0,i.d)(this.worker,"error",o),t(e.data)},o=e=>{(0,i.d)(this.worker,"message",r),(0,i.d)(this.worker,"error",o),n(e)};(0,i.b)(this.worker,"message",r),(0,i.b)(this.worker,"error",o),this.worker.postMessage(e)}))}terminate(){URL.revokeObjectURL(this.source),this.worker.terminate()}}},(e,t,n)=>{"use strict";n(226);var i,r=n(9),o=n(11),a=n(149),s=n(0),l=n(32),c=n(3),u=n(18),d=n(191),h=n(58),f=n(12),g=n(192),p=n(193),m=n(84),v=n(105).codeAt,_=n(195),y=n(16),b=n(42),w=n(79),E=n(150),x=n(25),O=x.set,T=x.getterFor("URL"),R=E.URLSearchParams,S=E.getState,A=s.URL,L=s.TypeError,M=s.parseInt,P=Math.floor,I=Math.pow,F=c("".charAt),C=c(/./.exec),D=c([].join),N=c(1..toString),k=c([].pop),B=c([].push),U=c("".replace),z=c([].shift),G=c("".split),X=c("".slice),H=c("".toLowerCase),V=c([].unshift),Y="Invalid scheme",j="Invalid host",W="Invalid port",q=/[a-z]/i,Z=/[\d+-.a-z]/i,K=/\d/,J=/^0x/i,Q=/^[0-7]+$/,$=/^\d+$/,ee=/^[\da-f]+$/i,te=/[\0\t\n\r #%/:<>?@[\\\]^|]/,ne=/[\0\t\n\r #/:<>?@[\\\]^|]/,ie=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,re=/[\t\n\r]/g,oe=function(e){var t,n,i,r;if("number"==typeof e){for(t=[],n=0;n<4;n++)V(t,e%256),e=P(e/256);return D(t,".")}if("object"==typeof e){for(t="",i=function(e){for(var t=null,n=1,i=null,r=0,o=0;o<8;o++)0!==e[o]?(r>n&&(t=i,n=r),i=null,r=0):(null===i&&(i=o),++r);return r>n&&(t=i,n=r),t}(e),n=0;n<8;n++)r&&0===e[n]||(r&&(r=!1),i===n?(t+=n?":":"::",r=!0):(t+=N(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},ae={},se=g({},ae,{" ":1,'"':1,"<":1,">":1,"`":1}),le=g({},se,{"#":1,"?":1,"{":1,"}":1}),ce=g({},le,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),ue=function(e,t){var n=v(e,0);return n>32&&n<127&&!f(t,e)?e:encodeURIComponent(e)},de={ftp:21,file:null,http:80,https:443,ws:80,wss:443},he=function(e,t){var n;return 2==e.length&&C(q,F(e,0))&&(":"==(n=F(e,1))||!t&&"|"==n)},fe=function(e){var t;return e.length>1&&he(X(e,0,2))&&(2==e.length||"/"===(t=F(e,2))||"\\"===t||"?"===t||"#"===t)},ge=function(e){return"."===e||"%2e"===H(e)},pe={},me={},ve={},_e={},ye={},be={},we={},Ee={},xe={},Oe={},Te={},Re={},Se={},Ae={},Le={},Me={},Pe={},Ie={},Fe={},Ce={},De={},Ne=function(e,t,n){var i,r,o,a=y(e);if(t){if(r=this.parse(a))throw L(r);this.searchParams=null}else{if(void 0!==n&&(i=new Ne(n,!0)),r=this.parse(a,null,i))throw L(r);(o=S(new R)).bindURL(this),this.searchParams=o}};Ne.prototype={type:"URL",parse:function(e,t,n){var r,o,a,s,l,c=this,u=t||pe,d=0,h="",g=!1,v=!1,_=!1;for(e=y(e),t||(c.scheme="",c.username="",c.password="",c.host=null,c.port=null,c.path=[],c.query=null,c.fragment=null,c.cannotBeABaseURL=!1,e=U(e,ie,"")),e=U(e,re,""),r=p(e);d<=r.length;){switch(o=r[d],u){case pe:if(!o||!C(q,o)){if(t)return Y;u=ve;continue}h+=H(o),u=me;break;case me:if(o&&(C(Z,o)||"+"==o||"-"==o||"."==o))h+=H(o);else{if(":"!=o){if(t)return Y;h="",u=ve,d=0;continue}if(t&&(c.isSpecial()!=f(de,h)||"file"==h&&(c.includesCredentials()||null!==c.port)||"file"==c.scheme&&!c.host))return;if(c.scheme=h,t)return void(c.isSpecial()&&de[c.scheme]==c.port&&(c.port=null));h="","file"==c.scheme?u=Ae:c.isSpecial()&&n&&n.scheme==c.scheme?u=_e:c.isSpecial()?u=Ee:"/"==r[d+1]?(u=ye,d++):(c.cannotBeABaseURL=!0,B(c.path,""),u=Fe)}break;case ve:if(!n||n.cannotBeABaseURL&&"#"!=o)return Y;if(n.cannotBeABaseURL&&"#"==o){c.scheme=n.scheme,c.path=m(n.path),c.query=n.query,c.fragment="",c.cannotBeABaseURL=!0,u=De;break}u="file"==n.scheme?Ae:be;continue;case _e:if("/"!=o||"/"!=r[d+1]){u=be;continue}u=xe,d++;break;case ye:if("/"==o){u=Oe;break}u=Ie;continue;case be:if(c.scheme=n.scheme,o==i)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=m(n.path),c.query=n.query;else if("/"==o||"\\"==o&&c.isSpecial())u=we;else if("?"==o)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=m(n.path),c.query="",u=Ce;else{if("#"!=o){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=m(n.path),c.path.length--,u=Ie;continue}c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=m(n.path),c.query=n.query,c.fragment="",u=De}break;case we:if(!c.isSpecial()||"/"!=o&&"\\"!=o){if("/"!=o){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,u=Ie;continue}u=Oe}else u=xe;break;case Ee:if(u=xe,"/"!=o||"/"!=F(h,d+1))continue;d++;break;case xe:if("/"!=o&&"\\"!=o){u=Oe;continue}break;case Oe:if("@"==o){g&&(h="%40"+h),g=!0,a=p(h);for(var b=0;b<a.length;b++){var w=a[b];if(":"!=w||_){var E=ue(w,ce);_?c.password+=E:c.username+=E}else _=!0}h=""}else if(o==i||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()){if(g&&""==h)return"Invalid authority";d-=p(h).length+1,h="",u=Te}else h+=o;break;case Te:case Re:if(t&&"file"==c.scheme){u=Me;continue}if(":"!=o||v){if(o==i||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()){if(c.isSpecial()&&""==h)return j;if(t&&""==h&&(c.includesCredentials()||null!==c.port))return;if(s=c.parseHost(h))return s;if(h="",u=Pe,t)return;continue}"["==o?v=!0:"]"==o&&(v=!1),h+=o}else{if(""==h)return j;if(s=c.parseHost(h))return s;if(h="",u=Se,t==Re)return}break;case Se:if(!C(K,o)){if(o==i||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()||t){if(""!=h){var x=M(h,10);if(x>65535)return W;c.port=c.isSpecial()&&x===de[c.scheme]?null:x,h=""}if(t)return;u=Pe;continue}return W}h+=o;break;case Ae:if(c.scheme="file","/"==o||"\\"==o)u=Le;else{if(!n||"file"!=n.scheme){u=Ie;continue}if(o==i)c.host=n.host,c.path=m(n.path),c.query=n.query;else if("?"==o)c.host=n.host,c.path=m(n.path),c.query="",u=Ce;else{if("#"!=o){fe(D(m(r,d),""))||(c.host=n.host,c.path=m(n.path),c.shortenPath()),u=Ie;continue}c.host=n.host,c.path=m(n.path),c.query=n.query,c.fragment="",u=De}}break;case Le:if("/"==o||"\\"==o){u=Me;break}n&&"file"==n.scheme&&!fe(D(m(r,d),""))&&(he(n.path[0],!0)?B(c.path,n.path[0]):c.host=n.host),u=Ie;continue;case Me:if(o==i||"/"==o||"\\"==o||"?"==o||"#"==o){if(!t&&he(h))u=Ie;else if(""==h){if(c.host="",t)return;u=Pe}else{if(s=c.parseHost(h))return s;if("localhost"==c.host&&(c.host=""),t)return;h="",u=Pe}continue}h+=o;break;case Pe:if(c.isSpecial()){if(u=Ie,"/"!=o&&"\\"!=o)continue}else if(t||"?"!=o)if(t||"#"!=o){if(o!=i&&(u=Ie,"/"!=o))continue}else c.fragment="",u=De;else c.query="",u=Ce;break;case Ie:if(o==i||"/"==o||"\\"==o&&c.isSpecial()||!t&&("?"==o||"#"==o)){if(".."===(l=H(l=h))||"%2e."===l||".%2e"===l||"%2e%2e"===l?(c.shortenPath(),"/"==o||"\\"==o&&c.isSpecial()||B(c.path,"")):ge(h)?"/"==o||"\\"==o&&c.isSpecial()||B(c.path,""):("file"==c.scheme&&!c.path.length&&he(h)&&(c.host&&(c.host=""),h=F(h,0)+":"),B(c.path,h)),h="","file"==c.scheme&&(o==i||"?"==o||"#"==o))for(;c.path.length>1&&""===c.path[0];)z(c.path);"?"==o?(c.query="",u=Ce):"#"==o&&(c.fragment="",u=De)}else h+=ue(o,le);break;case Fe:"?"==o?(c.query="",u=Ce):"#"==o?(c.fragment="",u=De):o!=i&&(c.path[0]+=ue(o,ae));break;case Ce:t||"#"!=o?o!=i&&("'"==o&&c.isSpecial()?c.query+="%27":c.query+="#"==o?"%23":ue(o,ae)):(c.fragment="",u=De);break;case De:o!=i&&(c.fragment+=ue(o,se))}d++}},parseHost:function(e){var t,n,i;if("["==F(e,0)){if("]"!=F(e,e.length-1))return j;if(t=function(e){var t,n,i,r,o,a,s,l=[0,0,0,0,0,0,0,0],c=0,u=null,d=0,h=function(){return F(e,d)};if(":"==h()){if(":"!=F(e,1))return;d+=2,u=++c}for(;h();){if(8==c)return;if(":"!=h()){for(t=n=0;n<4&&C(ee,h());)t=16*t+M(h(),16),d++,n++;if("."==h()){if(0==n)return;if(d-=n,c>6)return;for(i=0;h();){if(r=null,i>0){if(!("."==h()&&i<4))return;d++}if(!C(K,h()))return;for(;C(K,h());){if(o=M(h(),10),null===r)r=o;else{if(0==r)return;r=10*r+o}if(r>255)return;d++}l[c]=256*l[c]+r,2!=++i&&4!=i||c++}if(4!=i)return;break}if(":"==h()){if(d++,!h())return}else if(h())return;l[c++]=t}else{if(null!==u)return;d++,u=++c}}if(null!==u)for(a=c-u,c=7;0!=c&&a>0;)s=l[c],l[c--]=l[u+a-1],l[u+--a]=s;else if(8!=c)return;return l}(X(e,1,-1)),!t)return j;this.host=t}else if(this.isSpecial()){if(e=_(e),C(te,e))return j;if(t=function(e){var t,n,i,r,o,a,s,l=G(e,".");if(l.length&&""==l[l.length-1]&&l.length--,(t=l.length)>4)return e;for(n=[],i=0;i<t;i++){if(""==(r=l[i]))return e;if(o=10,r.length>1&&"0"==F(r,0)&&(o=C(J,r)?16:8,r=X(r,8==o?1:2)),""===r)a=0;else{if(!C(10==o?$:8==o?Q:ee,r))return e;a=M(r,o)}B(n,a)}for(i=0;i<t;i++)if(a=n[i],i==t-1){if(a>=I(256,5-t))return null}else if(a>255)return null;for(s=k(n),i=0;i<n.length;i++)s+=n[i]*I(256,3-i);return s}(e),null===t)return j;this.host=t}else{if(C(ne,e))return j;for(t="",n=p(e),i=0;i<n.length;i++)t+=ue(n[i],ae);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return f(de,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&he(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,i=e.password,r=e.host,o=e.port,a=e.path,s=e.query,l=e.fragment,c=t+":";return null!==r?(c+="//",e.includesCredentials()&&(c+=n+(i?":"+i:"")+"@"),c+=oe(r),null!==o&&(c+=":"+o)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?a[0]:a.length?"/"+D(a,"/"):"",null!==s&&(c+="?"+s),null!==l&&(c+="#"+l),c},setHref:function(e){var t=this.parse(e);if(t)throw L(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new ke(e.path[0]).origin}catch(e){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+oe(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(y(e)+":",pe)},getUsername:function(){return this.username},setUsername:function(e){var t=p(y(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=ue(t[n],ce)}},getPassword:function(){return this.password},setPassword:function(e){var t=p(y(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=ue(t[n],ce)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?oe(e):oe(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Te)},getHostname:function(){var e=this.host;return null===e?"":oe(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Re)},getPort:function(){var e=this.port;return null===e?"":y(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=y(e))?this.port=null:this.parse(e,Se))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+D(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Pe))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=y(e))?this.query=null:("?"==F(e,0)&&(e=X(e,1)),this.query="",this.parse(e,Ce)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=y(e))?("#"==F(e,0)&&(e=X(e,1)),this.fragment="",this.parse(e,De)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var ke=function(e){var t=h(this,Be),n=w(arguments.length,1)>1?arguments[1]:void 0,i=O(t,new Ne(e,!1,n));o||(t.href=i.serialize(),t.origin=i.getOrigin(),t.protocol=i.getProtocol(),t.username=i.getUsername(),t.password=i.getPassword(),t.host=i.getHost(),t.hostname=i.getHostname(),t.port=i.getPort(),t.pathname=i.getPathname(),t.search=i.getSearch(),t.searchParams=i.getSearchParams(),t.hash=i.getHash())},Be=ke.prototype,Ue=function(e,t){return{get:function(){return T(this)[e]()},set:t&&function(e){return T(this)[t](e)},configurable:!0,enumerable:!0}};if(o&&(d(Be,"href",Ue("serialize","setHref")),d(Be,"origin",Ue("getOrigin")),d(Be,"protocol",Ue("getProtocol","setProtocol")),d(Be,"username",Ue("getUsername","setUsername")),d(Be,"password",Ue("getPassword","setPassword")),d(Be,"host",Ue("getHost","setHost")),d(Be,"hostname",Ue("getHostname","setHostname")),d(Be,"port",Ue("getPort","setPort")),d(Be,"pathname",Ue("getPathname","setPathname")),d(Be,"search",Ue("getSearch","setSearch")),d(Be,"searchParams",Ue("getSearchParams")),d(Be,"hash",Ue("getHash","setHash"))),u(Be,"toJSON",(function(){return T(this).serialize()}),{enumerable:!0}),u(Be,"toString",(function(){return T(this).serialize()}),{enumerable:!0}),A){var ze=A.createObjectURL,Ge=A.revokeObjectURL;ze&&u(ke,"createObjectURL",l(ze,A)),Ge&&u(ke,"revokeObjectURL",l(Ge,A))}b(ke,"URL"),r({global:!0,constructor:!0,forced:!a,sham:!o},{URL:ke})},(e,t,n)=>{"use strict";var i=n(105).charAt,r=n(16),o=n(25),a=n(118),s="String Iterator",l=o.set,c=o.getterFor(s);a(String,"String",(function(e){l(this,{type:s,string:r(e),index:0})}),(function(){var e,t=c(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=i(n,r),t.index+=e.length,{value:e,done:!1})}))},(e,t,n)=>{"use strict";n.d(t,{a:()=>u,b:()=>d});n(14),n(1),n(2),n(148),n(151);var i=n(213),r=n(62),o=n(63),a=n(64),s=n(108),l=n(13);let c=self.fetch;function u(e,t){let n=c;return(0,o.b)()||!(0,o.a)()||(0,i.a)()||(n=async function(e,t){const n="electron"in self?await("GET"===t.method?self.electron.requestHTTP(e):self.electron.existsHTTP(e)):null;return new Response(n,{status:n?200:404})}),n(e,t)}function d(e,t){return URL.createObjectURL(new Blob([t],{type:e}))}(0,o.b)()?c=async function(e,t){return new Promise(((n,i)=>{const o=(0,r.a)(),s=e=>{const{data:t}=e;if(t instanceof Object&&o===t.key&&"return"===t.method)(0,l.d)(a.b,"message",s),t.error?i():n(new Response(t.value,{status:200}))};(0,l.b)(a.b,"message",s),a.b.postMessage({method:"fetch",type:"arraybuffer",options:t,url:e,key:o})}))}:(0,l.b)(a.b,"message",(e=>{const{data:t}=e;if(t instanceof Object&&"fetch"===t.method)(0,s.a)(t.url,t.type,t.options).then((e=>a.b.postMessage({method:"return",error:!1,value:e.source,key:t.key}))).catch((()=>a.b.postMessage({method:"return",error:!0,value:null,key:t.key})))}))},(e,t,n)=>{var i=n(9),r=n(0),o=n(128),a=n(24),s=n(79),l=n(57),c=r.process;i({global:!0,enumerable:!0,noTargetGet:!0},{queueMicrotask:function(e){s(arguments.length,1),a(e);var t=l&&c.domain;o(t?t.bind(e):e)}})},(e,t,n)=>{n(230),n(231)},(e,t,n)=>{var i=n(9),r=n(0),o=n(77).clear;i({global:!0,bind:!0,enumerable:!0,forced:r.clearImmediate!==o},{clearImmediate:o})},(e,t,n)=>{var i=n(9),r=n(0),o=n(77).set;i({global:!0,bind:!0,enumerable:!0,forced:r.setImmediate!==o},{setImmediate:o})},()=>{},(e,t,n)=>{var i=n(11),r=n(0),o=n(3),a=n(96),s=n(144),l=n(19),c=n(95).f,u=n(30),d=n(100),h=n(16),f=n(147),g=n(101),p=n(202),m=n(18),v=n(4),_=n(12),y=n(25).enforce,b=n(75),w=n(7),E=n(137),x=n(138),O=w("match"),T=r.RegExp,R=T.prototype,S=r.SyntaxError,A=o(R.exec),L=o("".charAt),M=o("".replace),P=o("".indexOf),I=o("".slice),F=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,C=/a/g,D=/a/g,N=new T(C)!==C,k=g.MISSED_STICKY,B=g.UNSUPPORTED_Y,U=i&&(!N||k||E||x||v((function(){return D[O]=!1,T(C)!=C||T(D)==D||"/a/i"!=T(C,"i")})));if(a("RegExp",U)){for(var z=function(e,t){var n,i,r,o,a,c,g=u(R,this),p=d(e),m=void 0===t,v=[],b=e;if(!g&&p&&m&&e.constructor===z)return e;if((p||u(R,e))&&(e=e.source,m&&(t=f(b))),e=void 0===e?"":h(e),t=void 0===t?"":h(t),b=e,E&&"dotAll"in C&&(i=!!t&&P(t,"s")>-1)&&(t=M(t,/s/g,"")),n=t,k&&"sticky"in C&&(r=!!t&&P(t,"y")>-1)&&B&&(t=M(t,/y/g,"")),x&&(o=function(e){for(var t,n=e.length,i=0,r="",o=[],a={},s=!1,l=!1,c=0,u="";i<=n;i++){if("\\"===(t=L(e,i)))t+=L(e,++i);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:A(F,I(e,i+1))&&(i+=2,l=!0),r+=t,c++;continue;case">"===t&&l:if(""===u||_(a,u))throw new S("Invalid capture group name");a[u]=!0,o[o.length]=[u,c],l=!1,u="";continue}l?u+=t:r+=t}return[r,o]}(e),e=o[0],v=o[1]),a=s(T(e,t),g?this:R,z),(i||r||v.length)&&(c=y(a),i&&(c.dotAll=!0,c.raw=z(function(e){for(var t,n=e.length,i=0,r="",o=!1;i<=n;i++)"\\"!==(t=L(e,i))?o||"."!==t?("["===t?o=!0:"]"===t&&(o=!1),r+=t):r+="[\\s\\S]":r+=t+L(e,++i);return r}(e),n)),r&&(c.sticky=!0),v.length&&(c.groups=v)),e!==b)try{l(a,"source",""===b?"(?:)":b)}catch(e){}return a},G=c(T),X=0;G.length>X;)p(z,T,G[X++]);R.constructor=z,z.prototype=R,m(r,"RegExp",z,{constructor:!0})}b("RegExp")},(e,t,n)=>{"use strict";n(1),n(47),n(61),n(49),n(50),n(51);Float32Array},(e,t,n)=>{"use strict";n.d(t,{a:()=>a});n(1),n(2),n(33),n(20),n(21),n(14);var i=n(108);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const o=new Map;new Array;class a{constructor(){r(this,"urls",void 0),r(this,"datas",Array()),r(this,"locations",new Array),r(this,"isTransfer",!1);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.urls=t}async load(){this.datas.length>0||this.datas.push(...await Promise.all(this.urls.map((async e=>(o.has(e)||o.set(e,(await(0,i.a)(e)).source),o.get(e))))))}getUrls(){return this.urls}getDatas(){return this.datas}getLocations(){return this.locations}hasTransfer(){return this.isTransfer}createTransferData(){const{urls:e,locations:t}=this;return this.isTransfer=!0,{urls:e,locations:t}}}},(e,t,n)=>{"use strict";n.a(e,(async(e,i)=>{try{n.d(t,{a:()=>E});n(1),n(2),n(33);var r=n(237),o=n(158),a=n(6),s=n(239),l=n(46),c=n(155),u=n(270),d=n(271),h=n(272),f=n(273),g=n(274),p=n(275),m=n(276),v=n(277),_=e([r,o,l]);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}[r,o,l]=_.then?(await _)():_;class E extends r.a{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,l.a)(0,0),n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;super("voxel",u.a,{raycast:d.a,lighting:h.a,stackLighting:f.a,blurLighting:g.a,stackBloom:p.a,blurBloom:m.a,composite:v.a},t),w(this,"setting",void 0),w(this,"frustum",void 0),w(this,"maxDrawDistance",void 0),w(this,"oldTextureWidth",0),w(this,"oldTextureHeight",0),w(this,"oldScreen",null),w(this,"ctx",null),this.setting=e,this.frustum=new c.b(n),this.maxDrawDistance=i}getContrast(){return this.setting.contrast}getBrightness(){return this.setting.brightness}hasCRT(){return!!this.setting.isCRT}getBlurDotScale(){return this.hasCRT()?1:this.setting.blurDotScale||1}hasShadow(){return!!this.setting.isShadow}hasSoftShadow(){return!!this.setting.isSoftShadow}hasRoughness(){return!!this.setting.isRoughness}getBloom(){return this.setting.bloom}getReflectionCount(){return this.setting.reflectionCount||0}hasMuzzleFlash(){return!!this.setting.isMuzzleFlash}calcGlobalSunLight(e){const t=a.a,n=a.a+.025*a.a,i=3*a.a-.025*a.a,r=3*a.a,o=(0,a.q)(e);return n<=o&&i>=o?1:i<o&&r>o?Math.cos((o-i)/(r-i)*a.a):t<o&&n>o?1-Math.cos((o-t)/(n-t)*a.a):0}calcGlobalMoonLight(e){const t=a.a-.025*a.a,n=a.a,i=3*a.a,r=3*a.a+.025*a.a,o=(0,a.q)(e);return n<=o&&i>=o?0:i<o&&r>o?1-Math.cos((o-i)/(r-i)*a.a):t<o&&n>o?Math.cos((o-t)/(n-t)*a.a):1}createBuffer(e){return{raycast:{width:e.canvas.width/2,height:e.canvas.height},lighting:{width:e.canvas.width/2,height:e.canvas.height},blurLighting:{width:e.canvas.width/2,height:e.canvas.height},stackLighting:{width:e.canvas.width,height:e.canvas.height},blurBloom:{width:e.canvas.width/2,height:e.canvas.height},stackBloom:{width:e.canvas.width,height:e.canvas.height},composite:{width:e.canvas.width,height:e.canvas.height}}}createTexture(e,t,n){const{voxel_field:i,distance_field:r,materials:o,voxels:a}=t,{billboard_parameters:s,cluster_list:l,item_list:c}=this.frustum.createData(t),{oldTextureWidth:u,oldTextureHeight:d}=this,h=n.getTexture();if(null===h)return{};const f=e.canvas.width,g=e.canvas.height;let p=!1;f===u&&g===d||(p=!0),this.oldTextureWidth=f,this.oldTextureHeight=g;const{albedo:m,pbr:v,normal:_}=h.getBuffer(),y=h.checkUpdate();return{0:b(b({type:"32i",format:1},i),{},{sync:null!==i.data}),1:b(b({type:"32i",format:1},r),{},{sync:null!==r.data}),2:{format:4,data:m,width:h.getSize()[0],height:h.getSize()[1],sync:y},3:{format:4,data:v,width:h.getSize()[0],height:h.getSize()[1],sync:y},4:{format:4,data:_,width:h.getSize()[0],height:h.getSize()[1],sync:y},5:b(b({type:"32i",format:1},o||{width:0}),{},{sync:null!==o}),6:b(b({type:"32f",format:1},a||{width:0}),{},{sync:null!==a}),7:b(b({type:"32f",format:1},s||{width:0}),{},{sync:null!==s}),8:b(b({type:"32i",format:1},l||{width:0}),{},{sync:null!==l}),9:b(b({type:"32i",format:1},c||{width:0}),{},{sync:null!==c}),10:{attachment:{raycast:0},format:4,width:e.canvas.width/2,height:e.canvas.height,sync:p},11:{attachment:{raycast:1},format:4,width:e.canvas.width/2,height:e.canvas.height,sync:p},12:{attachment:{raycast:2},type:"32f",format:4,width:e.canvas.width/2,height:e.canvas.height,sync:p},13:{attachment:{raycast:3},type:"32f",format:4,width:e.canvas.width/2,height:e.canvas.height,sync:p},14:{attachment:{raycast:4},type:"32f",format:4,width:e.canvas.width/2,height:e.canvas.height,sync:p},15:{attachment:{raycast:5},type:"32f",format:4,width:e.canvas.width/2,height:e.canvas.height,sync:p},16:{attachment:{lighting:0},type:"32f",format:4,width:e.canvas.width/2,height:e.canvas.height,sync:p},17:{attachment:{lighting:1},type:"32f",format:4,width:e.canvas.width/2,height:e.canvas.height,sync:p},18:{attachment:{lighting:2},type:"32f",format:4,width:e.canvas.width/2,height:e.canvas.height,sync:p},19:{attachment:{lighting:3},type:"32f",format:4,width:e.canvas.width/2,height:e.canvas.height,sync:p},20:{attachment:{lighting:4},format:4,width:e.canvas.width/2,height:e.canvas.height,sync:p},21:{attachment:{lighting:5},type:"32f",format:4,width:e.canvas.width/2,height:e.canvas.height,sync:p},22:{attachment:{lighting:6},type:"32f",format:4,width:e.canvas.width/2,height:e.canvas.height,sync:p},23:{attachment:{stackLighting:0},type:"16f",format:4,mipmap:!0,min:"linear",mag:"linear",width:e.canvas.width,height:e.canvas.height,generateMipmap:!0,sync:p},24:{attachment:{stackLighting:1},type:"16f",format:4,mipmap:!0,min:"linear",mag:"linear",width:e.canvas.width,height:e.canvas.height,generateMipmap:!0,sync:p},25:{attachment:{stackLighting:2},type:"16f",format:4,mipmap:!0,min:"linear",mag:"linear",width:e.canvas.width,height:e.canvas.height,generateMipmap:!0,sync:p},26:{attachment:{stackLighting:3},type:"16f",format:4,mipmap:!0,min:"linear",mag:"linear",width:e.canvas.width,height:e.canvas.height,generateMipmap:!0,sync:p},27:{attachment:{blurLighting:0},type:"32f",format:4,width:e.canvas.width/2,height:e.canvas.height,generateMipmap:!0,sync:p},28:{attachment:{blurLighting:1},type:"32f",format:4,width:e.canvas.width/2,height:e.canvas.height,generateMipmap:!0,sync:p},29:{attachment:{blurLighting:2},type:"32f",format:4,width:e.canvas.width/2,height:e.canvas.height,sync:p},30:{attachment:{blurLighting:3},type:"32f",format:4,width:e.canvas.width/2,height:e.canvas.height,sync:p},31:{attachment:{blurLighting:4},format:4,width:e.canvas.width/2,height:e.canvas.height,sync:p},32:{attachment:{stackBloom:0},format:4,mipmap:!0,min:"linear",mag:"linear",width:e.canvas.width,height:e.canvas.height,generateMipmap:!0,sync:p},33:{attachment:{blurBloom:0},format:4,width:e.canvas.width/2,height:e.canvas.height,sync:p}}}createUniform(e,t,n){const{camera:i,sun:r,voxel_field:l,cluster_resolution:c,background:u,lateTime:d}=t,h=n.getTexture();if(null===h)return{};const f=Math.min(l.distance,this.maxDrawDistance),[g,p]=this.getScreenSize(),m=(0,s.a)(r?r.direction.y:0);return{MAX_2D_TEXTURE_SIZE:{type:"1i",value:[o.a]},MAX_3D_TEXTURE_SIZE:{type:"1i",value:[o.b]},MAX_MIPMAP_LEVEL:{type:"1i",value:[Math.log2(Math.max(g,p))]},map_size:{type:"3i",value:[l.width,l.height,l.depth]},max_draw_distance:{type:"1f",value:[f]},reflection_count:{type:"1i",value:[this.getReflectionCount()]},tile_resolution:{program:["raycast","lighting","stackBloom","composite"],type:"1i",value:[h.getTileSize()]},cluster_resolution:{program:["raycast"],type:"2i",value:[c.width,c.height]},map_data:{program:["raycast","lighting"],unit:0},distance_field:{program:["raycast","lighting"],unit:1},texture_albedo_data:{program:["raycast","lighting"],unit:2},texture_pbr_data:{program:["raycast","lighting"],unit:3},texture_normal_data:{program:["raycast","lighting"],unit:4},material_data:{program:["raycast","lighting"],unit:5},voxel_data:{program:["raycast","lighting"],unit:6},billboard_data:{program:["raycast","lighting"],unit:7},cluster_list:{program:["raycast"],unit:8},item_list:{program:["raycast"],unit:9},buffer_resolution:{type:"2f",value:[e.canvas.width/2,e.canvas.height]},lighting_resolution:{type:"2f",value:[e.canvas.width/2,e.canvas.height]},time:{type:"1f",value:[d]},hour:{type:"1f",value:[r?r.direction.y:0]},position:{type:"3f",value:null!==i?[i.position.x,i.position.y,i.position.z]:[0,0,0]},direction:{type:"3f",value:null!==i?[i.direction.x,i.direction.y,i.direction.z]:[0,0,0]},ray_dir_y:{type:"3f",value:null!==i?(0,a.g)(i.direction.x,i.direction.y):[0,0,0]},ray_dir_z:{type:"3f",value:null!==i?(0,a.h)(i.direction.x,i.direction.y):[0,0,0]},fov:{type:"1f",value:null!==i?[i.fov*i.zoom]:[1]},fov_hud:{type:"1f",value:null!==i?[i.hudFov*i.zoom]:[1]},Albedo:{unit:10},Normal:{unit:11},World:{unit:12},Material:{unit:13},Location:{unit:14},Mask:{unit:15},Lighting:{unit:16},LightingParam:{unit:17},ClipAlbedo:{unit:18},ClipLighting:{unit:19},ClipSkybox:{unit:20},Reflection:{unit:21},ClipReflection:{unit:22},StackLighting:{unit:23},StackReflection:{unit:24},StackClipLighting:{unit:25},StackClipReflection:{unit:26},SoftShadow:{unit:this.hasShadow()&&this.hasSoftShadow()?27:16},SoftShadowParam:{unit:this.hasShadow()&&this.hasSoftShadow()?28:17},Roughness:{unit:this.getReflectionCount()>0&&this.hasRoughness()?29:21},ClipSoftShadow:{unit:this.hasShadow()&&this.hasSoftShadow()?30:19},ClipRoughness:{unit:this.getReflectionCount()>0&&this.hasRoughness()?31:22},StackBloom:{unit:32},Bloom:{unit:33},contrast:{type:"1f",value:[this.getContrast()]},brightness:{type:"1f",value:[this.getBrightness()]},sun_direction:{type:"3f",value:r?(0,a.h)(r.direction.x,r.direction.y):[0,0,0]},global_sun_light:{type:"1f",value:[null!==r?this.calcGlobalSunLight(m):0]},global_moon_light:{type:"1f",value:[null!==r?this.calcGlobalMoonLight(m):0]},sun_light_force:{type:"1f",value:[3.75]},moon_light_force:{type:"1f",value:[3.75]},is_shadow:{type:"1i",value:[this.hasShadow()?1:0]},is_soft_shadow:{type:"1i",value:[this.hasSoftShadow()?1:0]},is_reflection:{type:"1i",value:[this.getReflectionCount()>0?1:0]},is_roughness:{type:"1i",value:[this.hasRoughness()?1:0]},is_dithering:{type:"1i",value:[0]},bloom_force:{type:"1f",value:[this.getBloom()]},background_theme:{type:"1i",program:["raycast","lighting"],value:[(null==u?void 0:u.theme)||0]},background_rise_up_color:{type:"3f",program:["raycast","lighting"],value:(null==u?void 0:u.rise_up_color)||[0,0,0]},backgorund_night_up_color:{type:"3f",program:["raycast","lighting"],value:(null==u?void 0:u.night_up_color)||[0,0,0]},background_rise_down_color:{type:"3f",program:["raycast","lighting"],value:(null==u?void 0:u.rise_down_color)||[0,0,0]},backgorund_night_down_color:{type:"3f",program:["raycast","lighting"],value:(null==u?void 0:u.night_down_color)||[0,0,0]},backgorund_material_up:{type:"3f",program:["raycast","lighting"],value:(null==u?void 0:u.material_up)||[0,0,0]},background_material_down:{type:"3f",program:["raycast","lighting"],value:(null==u?void 0:u.material_down)||[0,0,0]},background_noise_size:{type:"1f",program:["raycast","lighting"],value:[(null==u?void 0:u.noise_size)||0]},background_noise_length:{type:"1f",program:["raycast","lighting"],value:[(null==u?void 0:u.noise_length)||0]}}}getOrder(){return["raycast","lighting",...this.hasShadow()&&this.hasSoftShadow()||this.getReflectionCount()>0&&this.hasRoughness()?["stackLighting","blurLighting"]:[],...this.getBloom()>0?["stackBloom","blurBloom"]:[],"composite"]}rendering(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.ctx;const i=this.getScreen();if(i!==this.oldScreen&&(this.ctx=i.getContext("webgl2"),this.oldScreen=i,n=this.ctx),null===e||null===t||null===n||"CanvasRenderingContext2D"in self&&n instanceof CanvasRenderingContext2D||"OffscreenCanvasRenderingContext2D"in self&&n instanceof OffscreenCanvasRenderingContext2D||!("WebGL2RenderingContext"in self&&n instanceof WebGL2RenderingContext))return!1;const r=this.createBuffer(n),o=this.createTexture(n,e,t),a=this.createUniform(n,e,t);return this.renderingGL(n,r,o,a,this.getOrder())}}i()}catch(x){i(x)}}))},(e,t,n)=>{"use strict";n.a(e,(async(e,i)=>{try{n.d(t,{a:()=>_});n(1),n(47),n(61),n(49),n(50),n(51),n(20),n(21),n(107),n(209);var r=n(238),o=n(46),a=n(13),s=n(35),l=n(158),c=n(82),u=n(206),d=e([r,o,l]);function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}[r,o,l]=d.then?(await d)():d;const f="#version 300 es\n\tprecision highp float;\n\tprecision highp int;\n\n\tlayout(location = 0) in vec2 pos;\n\n\tvoid main()\n\t{\n\t\tgl_Position = vec4(pos, 0.0, 1.0);\n\t\t\n\t}\n";function g(e){const t=new Float32Array([-1,-1,1,-1,-1,1,1,1]),n=e.createBuffer();if(null===n)throw new Error("");e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null);const i=new Float32Array([0,1,1,1,0,0,1,0]),r=e.createBuffer();if(null===r)throw new Error("");e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null);const o=e.createVertexArray();if(null===o)throw new Error("");e.bindVertexArray(o),e.enableVertexAttribArray(0),e.bindBuffer(e.ARRAY_BUFFER,n),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,null);return e.enableVertexAttribArray(1),e.bindBuffer(e.ARRAY_BUFFER,r),e.vertexAttribPointer(1,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindVertexArray(null),{vertexArray:o,vertexPosBuffer:n,vertexTexBuffer:r}}function p(e,t,n,i,r,o){const{resolution:a,viewport:s}=t;null!==a&&e.uniform2f(a,n,i),null!==s&&e.uniform2f(s,r,o)}function m(e,t,n,i){const{screen:r}=n;if(!t||null===r||null===t.screen_texture)return;const{screen_texture:o}=t,a=e.TEXTURE_2D;e.activeTexture(e["TEXTURE".concat(i)]),e.bindTexture(a,o),(0,l.f)(e,r,"1i",i)}function v(e,t,n,i,r){const o=t.getFrame(),{buffer:a,attachs:s,textures:l,width:c,height:u,screen_texture:d}=o,h=e.TEXTURE_2D,f=e.UNSIGNED_BYTE,g=e.RGBA,p=e.RGBA,m=e.COLOR_ATTACHMENT0,v=r?d||e.createTexture():null;null===v||!r&&v?(e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,m,h,null,0),e.bindFramebuffer(e.FRAMEBUFFER,null),o.isScreenBuffer&&s.splice(s.indexOf(m),1),v&&l.splice(l.indexOf(v),1),o.isScreenBuffer=!1):-1===s.indexOf(m)?(e.bindTexture(h,v),e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.texImage2D(h,0,g,n,i,0,p,f,null),e.texParameteri(h,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(h,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(h,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(h,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,m,h,v,0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindTexture(h,null),o.isScreenBuffer=!0,s.push(m),l.push(v)):!d||n===c&&i===u||(e.bindTexture(h,v),e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.texImage2D(h,0,g,n,i,0,p,f,null),e.bindFramebuffer(e.FRAMEBUFFER,a),e.viewport(0,0,n,i),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindTexture(h,null)),o.screen_texture=v,o.width=0|n,o.height=0|i}class _ extends r.a{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(0,o.a)(0,0);super(e,i),h(this,"isInit",!1),h(this,"vertex",f),h(this,"sync",null),h(this,"sync_mode",!1),h(this,"kernel",null),h(this,"gl",null),h(this,"old_order",new Array),h(this,"old_order_init",new Array),h(this,"old_uniforms",{}),h(this,"triggerRecompile",!1),h(this,"programs",new Array),h(this,"fragments",{}),h(this,"handleLostContext",void 0),h(this,"handleContextRestored",void 0),this.vertex=t||this.vertex,this.fragments=n,this.handleLostContext=e=>{new a.a(this,"lostcontext").trigger({})},this.handleContextRestored=e=>{new a.a(this,"contextrestored").trigger({})};const r=i.getContext("webgl2");null!==r&&(this.initPrograms(r),this.gl=r)}_init(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0;if(null===e)return;let{old_order_init:r}=this;!this.isInit||null===this.gl||this.gl!==e&&this.gl.canvas!==e.canvas?(this.triggerRecompile=!0,null!==this.gl&&this.destroy(),this.init(e,t,n),this.isInit=!0):r.length>0&&(0,u.a)(i,r)&&(this.triggerRecompile=!0),this.old_order_init=(0,c.a)(i)}_rendering(e,t,n,i,r,o){if(!this.kernel)return!1;const{sync_mode:a,sync:s,kernel:c}=this,{vertexArray:{vertexArray:u},units:d}=c,{width:h,height:f}=e.canvas,g=new Array;for(let e=0,t=0|o.length;e<t;e=e+1|0){const t=o[e],n=this.programs.find((e=>e.getID()===t))||null;null!==n&&g.push(n)}for(let n=0,i=0|g.length;n<i;n=n+1|0){const i=g[n],r=g.indexOf(i),o=t[i.getID()]||{width:h,height:f},a=-1!==r&&!!g[r+1];v(e,i,o.width||h,o.height||f,a)}if((0,l.d)(e,n,d,g,t),a&&s&&!this.hasFinish())return!1;e.bindVertexArray(u);for(let n=0,o=0|g.length;n<o;n=n+1|0){const o=g[n],a=o.getUniforms(),s=o.getFrame(),c=t[o.getID()]||{width:h,height:f};e.viewport(0,0,c.width||h,c.height||f),s.attachs.length>0?(e.bindFramebuffer(e.FRAMEBUFFER,s.buffer),e.drawBuffers(s.attachs)):(e.bindFramebuffer(e.FRAMEBUFFER,null),e.drawBuffers([e.BACK]),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT)),e.useProgram(o.getProgram());const u=(0,l.e)(e,a,i,this.old_order.includes(o.getID())?r:{},d,o.getID()),v=g[n-1],_=v?v.getFrame():null;_&&m(e,_,s,u),p(e,s,h,f,c.width||h,c.height||f),e.drawArrays(e.TRIANGLE_STRIP,0,4),o.execTextureMipMapGenerators(),e.useProgram(null)}return e.bindVertexArray(null),!0}initPrograms(e){const{fragments:t,vertex:n}=this;(0,s.a)(this.programs);for(const i in t){const r=new l.c(i,n,t[i]);r.initProgram(e),this.programs.push(r)}}init(e,t,n){const i=(0,l.g)(e,t),r=g(e);this.kernel={vertexArray:r,units:i},(0,a.b)(e.canvas,"webglcontextlost",this.handleLostContext),(0,a.b)(e.canvas,"webglcontextrestored",this.handleContextRestored),this.gl===e&&this.gl.canvas===e.canvas||this.initPrograms(e),this.gl=e;for(let t=0,i=0|this.programs.length;t<i;t=t+1|0){this.programs[t].init(e,n)}e.enable(e.CULL_FACE),e.cullFace(e.BACK)}hasFinish(){const{gl:e,sync:t}=this;return!e||!t||e.getSyncParameter(t,e.SYNC_STATUS)===e.SIGNALED}getTexturePixelsFromUnit(e,t){if(!this.kernel)return null;const{units:n}=this.kernel;if(!n||!n.hasOwnProperty(t))return null;const{dimension:i,texture:r,format:o,type:a}=n[t],s=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,i,r,0);let l,c=0;switch(o){case e.RED:c=1;break;case e.RG:c=2;break;case e.RGB:c=3;break;case e.RGBA:c=4}switch(a){case e.UNSIGNED_BYTE:l=new Uint8Array(e.canvas.width*e.canvas.height*c);break;case e.INT:l=new Int32Array(e.canvas.width*e.canvas.height*c);break;case e.FLOAT:l=new Float32Array(e.canvas.width*e.canvas.height*c)}return l&&0!==l.length?(e.readPixels(0,0,e.canvas.width,e.canvas.height,o,a,l),e.bindFramebuffer(e.FRAMEBUFFER,null),l):null}getTexturePixelsFromUniform(e,t){const n=this.programs.find((e=>e.getUniforms().hasOwnProperty(t)))||null;if(null===n)return null;const{unit:i}=n.getUniforms()[t];return Number.isInteger(i)&&i?this.getTexturePixelsFromUnit(e,i):null}renderingGL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getScreen().getContext("webgl2"),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Array;if(null===e)return!1;const{width:o,height:s}=e.canvas;if(0===o||0===s)return!1;let{old_uniforms:l}=this;this._init(e,t,n,i,r),this.triggerRecompile&&(new a.a(this,"recompile").trigger(),this.triggerRecompile=!1);let u=!1;if(r=r&&r.length>0?r:Object.keys(this.fragments),this._rendering(e,t,n,i,l,r)){const{sync:t}=this;u=!0,(null===t||this.hasFinish())&&(null!==t&&e.deleteSync(t),this.sync=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0)),e.flush()}return this.gl=e,this.old_order=(0,c.a)(r),this.old_uniforms=(0,c.a)(i),u}destroy(){super.destroy();const{gl:e}=this;if(null!==e){if(e.CONTEXT_LOST_WEBGL!==e.getError()){if(null!==this.kernel){const{units:t,vertexArray:{vertexArray:n,vertexTexBuffer:i,vertexPosBuffer:r}}=this.kernel;for(const n in t){const{texture:i}=t[n];e.deleteTexture(i)}e.deleteVertexArray(n),e.deleteBuffer(i),e.deleteBuffer(r)}null!==this.sync&&(e.deleteSync(this.sync),this.sync=null)}(0,a.d)(e.canvas,"webglcontextlost",this.handleLostContext),(0,a.d)(e.canvas,"webglcontextrestored",this.handleContextRestored)}for(let e=0,t=0|this.programs.length;e<t;e=e+1|0){this.programs[e].destroy()}for(const e in this.old_uniforms)delete this.old_uniforms[e];(0,s.a)(this.programs),(0,s.a)(this.old_order),this.kernel=null,this.gl=null}}i()}catch(y){i(y)}}))},(e,t,n)=>{"use strict";n.a(e,(async(e,i)=>{try{n.d(t,{a:()=>c});n(1),n(2);var r=n(46),o=n(154),a=n(13),s=e([r,o]);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}[r,o]=s.then?(await s)():s;class c{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,r.a)(0,0);l(this,"name",void 0),l(this,"screen",void 0),this.name=e,this.screen=t}getName(){return this.name}getScreen(){return this.screen}getScreenSize(){const e=this.getScreen();return[e.width,e.height]}getImageBitmapAsync(){const e=this.getScreen();return(0,o.a)(e)}getImageBitmapSync(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.getScreen();return(0,o.b)(t,e)}setScreen(e){const t=this.getScreen();e.width=t.width,e.height=t.height,this.screen=e}setScreenSize(e,t){const[n,i]=this.getScreenSize();if(n!==e||i!==t){const n=this.getScreen();n.width=0|e,n.height=0|t}}destroy(){new a.a(this,"destroy").trigger({})}rendering(e,t,n){return!1}}i()}catch(u){i(u)}}))},(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var i=n(6);function r(e){return(0,i.q)(e+3*i.a)}},(e,t,n)=>{"use strict";var i=n(9),r=n(210).left,o=n(135),a=n(68),s=n(57);i({target:"Array",proto:!0,forced:!o("reduce")||!s&&a>79&&a<83},{reduce:function(e){var t=arguments.length;return r(this,e,t,t>1?arguments[1]:void 0)}})},(e,t,n)=>{n(26)("Int8",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},(e,t,n)=>{n(26)("Int16",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},(e,t,n)=>{n(26)("Uint16",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},(e,t,n)=>{n(26)("Uint32",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},(e,t,n)=>{n(26)("Uint8",(function(e){return function(t,n,i){return e(this,t,n,i)}}),!0)},(e,t,n)=>{n(26)("Float64",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},(e,t,n)=>{"use strict";var i=n(9),r=n(0),o=n(102),a=n(75),s="ArrayBuffer",l=o.ArrayBuffer;i({global:!0,constructor:!0,forced:r.ArrayBuffer!==l},{ArrayBuffer:l}),a(s)},(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>l});var i=n(52),r=n(13),o=n(63),a=n(213);const s=new i.a("window"),l=(new i.a("display-log"),new i.a("worker-tick")),c=new i.a("worker-paint");(0,o.b)()||(0,r.b)(s,"message",(e=>{const{data:t}=e;if(t instanceof Object)switch(t.method){case"shutdown":self.close();break;case"reload":!(0,a.a)()&&"electron"in self?self.electron.reboot():self.location.reload()}}))},(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var i=n(6);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class o{constructor(e,t,n,o,a,s,l,c,u){let d=arguments.length>9&&void 0!==arguments[9]&&arguments[9],h=arguments.length>10&&void 0!==arguments[10]&&arguments[10],f=arguments.length>11&&void 0!==arguments[11]&&arguments[11],g=arguments.length>12&&void 0!==arguments[12]&&arguments[12],p=arguments.length>13&&void 0!==arguments[13]&&arguments[13],m=arguments.length>14&&void 0!==arguments[14]&&arguments[14],v=arguments.length>15&&void 0!==arguments[15]&&arguments[15],_=arguments.length>16&&void 0!==arguments[16]&&arguments[16],y=arguments.length>17&&void 0!==arguments[17]&&arguments[17],b=arguments.length>18&&void 0!==arguments[18]&&arguments[18],w=arguments.length>19&&void 0!==arguments[19]&&arguments[19],E=arguments.length>20&&void 0!==arguments[20]&&arguments[20];r(this,"position",void 0),r(this,"front",void 0),r(this,"back",void 0),r(this,"right",void 0),r(this,"left",void 0),r(this,"top",void 0),r(this,"bottom",void 0),r(this,"flipXFront",!1),r(this,"flipYFront",!1),r(this,"flipXBack",!1),r(this,"flipYBack",!1),r(this,"flipXRight",!1),r(this,"flipYRight",!1),r(this,"flipXLeft",!1),r(this,"flipYLeft",!1),r(this,"flipXTop",!1),r(this,"flipYTop",!1),r(this,"flipXBottom",!1),r(this,"flipYBottom",!1),this.position=new i.c(e,t,n),this.front=o,this.back=a,this.right=s,this.left=l,this.top=c,this.bottom=u,this.flipXFront=d,this.flipYFront=h,this.flipXBack=f,this.flipYBack=g,this.flipXRight=p,this.flipYRight=m,this.flipXLeft=v,this.flipYLeft=_,this.flipXTop=y,this.flipYTop=b,this.flipXBottom=w,this.flipYBottom=E}}},(e,t,n)=>{"use strict";n.d(t,{a:()=>d});n(14),n(1),n(2);var i=n(235),r=n(13);const o=["touchstart","touchend","mousedown","keydown"],a=new WeakMap;function s(e){if(a.get(e)||"suspended"!==e.state)return e;const t=self.document.body;function n(){o.forEach((e=>(0,r.d)(t,e,i))),a.delete(e)}function i(){e.resume().then(n)}return o.forEach((e=>(0,r.b)(t,e,i))),a.set(e,!0),e}var l=n(108),c=n(52);let u=null;if("AudioContext"in self){u=new AudioContext;try{s(u)}catch(e){const t=()=>{(0,r.d)((0,c.d)(),"DOMContentLoaded",t),u&&s(u)};(0,r.b)((0,c.d)(),"DOMContentLoaded",t)}}class d extends i.a{async load(){const e=this.getDatas();0===e.length&&e.push(...await Promise.all(this.getUrls().map((async e=>u?u.decodeAudioData((await(0,l.a)(e,"arraybuffer")).source):null))))}}},(e,t,n)=>{"use strict";n.d(t,{a:()=>R,b:()=>L});n(1),n(2),n(33),n(20),n(21),n(14);var i=n(64),r=n(63),o=n(6),a=n(62),s=n(13),l=n(52);let c=!1,u=!1,d=!1,h=!1;const f=new Array,g=new o.b(0,0),p=new Array,m=new Array;let v=!1,_=1,y=-1;const b=()=>{-1===y&&(y=setTimeout((()=>{y=-1;const[e,t]=E();_=self.devicePixelRatio,p.forEach((e=>e.call(null))),i.f.postMessage({method:"resolution",width:e,height:t}),i.f.postMessage({method:"pixel-ratio",value:self.devicePixelRatio})}),100))};if((0,r.b)())(0,s.b)(i.f,"message",(e=>{const{data:t}=e;if(t instanceof Object)switch(t.method){case"resolution":g.x=t.width,g.y=t.height;break;case"pixel-ratio":_=t.value;break;case"focusChange":v=t.value;break;case"browser":d=t.value;break;case"hack":c=t.value;break;case"electron":u=t.value;break;case"success":f.includes(t.key)&&f.splice(f.indexOf(t.key),1)}}));else{function M(){if((0,s.b)((0,l.d)(),"resize",b),(0,s.b)((0,l.d)(),"fullscreenchange",b),(0,s.b)((0,l.d)(),"fullscreenerror",b),(0,s.b)((0,l.d)(),"blur",b),(0,s.b)((0,l.d)(),"focus",b),(0,s.b)((0,l.d)(),"orientationchange",b),"electron"in self&&(0,s.b)(self.electron,"focuschange",(e=>w(e.value))),(0,s.b)((0,l.d)(),"focus",(()=>w(!1))),(0,s.b)((0,l.d)(),"blur",(()=>w(!0))),(0,s.b)((0,l.d)(),"mousemove",(()=>w(!1))),document.body)b();else{const e=()=>{(0,s.d)((0,l.d)(),"load",e),b()};(0,s.b)((0,l.d)(),"load",e)}}(0,s.b)(i.f,"message",(async e=>{const{data:t}=e;if(t instanceof Object)switch(t.method){case"blur":v=t.value;break;case"exec":await(t.value?function(){const e=async t=>{if((0,r.b)()){const n=(0,a.a)(),o=e=>{const{data:r}=e;if(r instanceof Object&&r.key===n&&"success"===r.method)f.includes(r.key)&&f.splice(f.indexOf(r.key),1),(0,s.d)(i.f,"message",o),t(null)};h=!0,f.push(n),(0,s.b)(i.f,"message",o),i.f.postMessage({method:"exec",value:!0,key:n})}else if("electron"in self)u||(self.electron.setFullscreen(!0),u=!0,self.dispatchEvent(new UIEvent("resize")),i.f.postMessage({method:"electron",value:u})),t(null);else if(x(!(0,r.a)()))t(null);else if(null!==document.body){function c(){i.f.postMessage({method:"browser",value:x()}),t(null)}document.body.requestFullscreen().then(c).catch(c)}else{const d=()=>{(0,s.d)((0,l.d)(),"load",d),e(t)};(0,s.b)((0,l.d)(),"load",d)}};return new Promise(e)}():async function(){(0,r.b)()?await new Promise((e=>{const t=(0,a.a)(),n=r=>{const{data:o}=r;if(o instanceof Object&&o.key===t&&"success"===o.method)f.includes(o.key)&&f.splice(f.indexOf(o.key),1),(0,s.d)(i.f,"message",n),e(null)};h=!1,f.push(t),(0,s.b)(i.f,"message",n),i.f.postMessage({method:"exec",value:!1,key:t})})):x(!(0,r.a)())&&((0,r.a)()?u&&("electron"in self&&self.electron.setFullscreen(!1),u=!1,self.dispatchEvent(new UIEvent("resize")),i.f.postMessage({method:"electron",value:u})):x(!1)&&await document.exitFullscreen())}()),i.f.postMessage({method:"success",key:t.key})}})),(0,s.b)(document,"fullscreenchange",(()=>{d=!!document.fullscreenElement,i.f.postMessage({method:"browser",value:d})})),M()}function w(e){v!==e&&(v=e,m.forEach((e=>e(v))),i.f.postMessage({method:"blur",value:e}))}function E(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{x:n,y:i}=(0,r.b)()?g:new o.b(self.document.body.offsetWidth,self.document.body.offsetHeight);return[Math.floor(n*(e?_:1)),Math.floor(i/(t&&n<i?2:1)*(e?_:1))]}function x(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(0,r.b)()?f.length>0?h:(0,r.a)()?u:e?d||c:d:(0,r.a)()?u:null!==document.fullscreenElement||!!e&&O()}function O(){return(0,r.b)()?c:self.innerHeight>=self.outerHeight||self.innerHeight>=self.outerWidth}var T=n(85);const R=[[720,480],[854,480],[960,540],[1024,576],[1136,640],[1280,720],[1366,768],[1600,900],[1920,1080],[2048,1152],[2560,1440],[2880,1620],[3200,1800],[3840,2160],[7680,4320]];function S(e,t){return t[(0,T.a)(e.getResolutionIndex(),0,t.length-1)]}function A(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(x(!0)&&!e.hasAutomaticResolution()?S(e,t):null)||E(e.hasHighPixelRatio(),n)}function L(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const[i,r]=A(e,t,n);return[0|(e.hasCRT()?i/Math.max(e.getCRTSubPixel(),1):i),0|(e.hasCRT()?r/Math.max(e.getCRTSubPixel(),1):r)]}},(e,t,n)=>{"use strict";n.a(e,(async(e,i)=>{try{n.d(t,{a:()=>d});n(20),n(21),n(33);var r=n(211),o=n(63),a=n(6),s=n(253),l=n(280),c=n(160),u=e([s,c]);[s,c]=u.then?(await u)():u;class d{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;var n,i,r;r=void 0,(i="setting")in(n=this)?Object.defineProperty(n,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[i]=r,this.setting=e,this.init(t)}init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.setFramerate(this.setting.hasOwnProperty("framerateIndex")?this.setting.framerateIndex:1),this.setFOV(this.setting.hasOwnProperty("fov")?this.setting.fov:90,e),this.setStickInnerDeadzoneX(this.setting.hasOwnProperty("stickInnerDeadzoneX")?this.setting.stickInnerDeadzoneX:.1),this.setStickOuterDeadzoneX(this.setting.hasOwnProperty("stickOuterDeadzoneX")?this.setting.stickOuterDeadzoneX:0),this.setStickInnerDeadzoneY(this.setting.hasOwnProperty("stickInnerDeadzoneY")?this.setting.stickInnerDeadzoneY:.1),this.setStickOuterDeadzoneY(this.setting.hasOwnProperty("stickOuterDeadzoneY")?this.setting.stickOuterDeadzoneY:0),this.setWheelInnerDeadzone(this.setting.hasOwnProperty("wheelInnerDeadzone")?this.setting.wheelInnerDeadzone:.1),this.setWheelOuterDeadzone(this.setting.hasOwnProperty("wheelOuterDeadzone")?this.setting.wheelOuterDeadzone:0),this.setSoundVolume(this.setting.hasOwnProperty("soundVolume")?this.setting.soundVolume:1),this.setClusterResolution(this.setting.hasOwnProperty("clusterResolution")?this.setting.clusterResolution:16),this.setFullscreen(this.setting.hasOwnProperty("isFullscreen")?this.setting.isFullscreen:!!(0,o.a)()),this.setBrowserFullscreen(!!this.setting.hasOwnProperty("isBrowserFullscreen")&&this.setting.isBrowserFullscreen),this.setAutomaticResolution(!this.setting.hasOwnProperty("isAutomaticResolution")||this.setting.isAutomaticResolution),this.setResolutionIndex(this.setting.hasOwnProperty("resolutionIndex")?this.setting.resolutionIndex:0),this.setHighPixelRatio(!!this.setting.hasOwnProperty("isHighPixelRatio")&&this.setting.isHighPixelRatio),this.setReflectionCount(this.setting.hasOwnProperty("reflectionCount")?this.setting.reflectionCount:2),this.setShadow(!this.setting.hasOwnProperty("isShadow")||this.setting.isShadow),this.setSoftShadow(!this.setting.hasOwnProperty("isSoftShadow")||this.setting.isSoftShadow),this.setRoughness(!this.setting.hasOwnProperty("isRoughness")||this.setting.isRoughness),this.setDithering(!!this.setting.hasOwnProperty("isDithering")&&this.setting.isDithering),this.setBloom(this.setting.hasOwnProperty("bloom")?this.setting.bloom:1),this.setMuzzleFlash(!this.setting.hasOwnProperty("isMuzzleFlash")||this.setting.isMuzzleFlash),this.setBlurDotScale(this.setting.hasOwnProperty("blurDotScale")?this.setting.blurDotScale:4),this.setContrast(this.setting.hasOwnProperty("contrast")?this.setting.contrast:1),this.setBrightness(this.setting.hasOwnProperty("brightness")?this.setting.brightness:1),this.setCRTEnable(!!this.setting.hasOwnProperty("isCRT")&&this.setting.isCRT),this.setCRTSubPixel(this.setting.hasOwnProperty("crtSubPixel")?this.setting.crtSubPixel:3),this.setCRTLens(this.setting.hasOwnProperty("crtLens")?this.setting.crtLens:.075),this.setCRTDeep(this.setting.hasOwnProperty("crtDeep")?this.setting.crtDeep:.075),this.setCRTEdge(this.setting.hasOwnProperty("crtEdge")?this.setting.crtEdge:.025),this.setCRTVig(this.setting.hasOwnProperty("crtVig")?this.setting.crtVig:.175),this.setCRTShadowMask(!!this.setting.hasOwnProperty("isCRTShadowMask")&&this.setting.isCRTShadowMask),this.setCRTCenterFadeOut(this.setting.hasOwnProperty("crtCenterFadeOut")?this.setting.crtCenterFadeOut:1),this.setSensibility(this.setting.hasOwnProperty("sensibility")?this.setting.sensibility:50),this.setInvertX(!!this.setting.hasOwnProperty("invertX")&&this.setting.invertX),this.setInvertY(!!this.setting.hasOwnProperty("invertY")&&this.setting.invertY),this.setBob(!this.setting.hasOwnProperty("bob")||this.setting.bob),this.setToggleSprint(!this.setting.hasOwnProperty("toggleSprint")||this.setting.toggleSprint),this.setToggleCluch(!this.setting.hasOwnProperty("toggleCluch")||this.setting.toggleCluch),this.setWeaponChargeStandTime(this.setting.hasOwnProperty("weaponChargeStandTime")?this.setting.weaponChargeStandTime:180),this.setWeaponWheelStandTime(this.setting.hasOwnProperty("weaponWheelStandTime")?this.setting.weaponWheelStandTime:180),this.setEatSound(!this.setting.hasOwnProperty("eatSound")||this.setting.eatSound),this.setEnemyVoice(!this.setting.hasOwnProperty("enemyVoice")||this.setting.enemyVoice),this.setCheckPoint(!this.setting.hasOwnProperty("isCheckPoint")||this.setting.isCheckPoint),this.setPistolStart(!!this.setting.hasOwnProperty("isPistolStart")&&this.setting.isPistolStart),this.setPermaDeath(!!this.setting.hasOwnProperty("isPermaDeath")&&this.setting.isPermaDeath),this.setSSSSlowMo(!this.setting.hasOwnProperty("isSSSSlowMo")||this.setting.isSSSSlowMo),this.setDisplayPlayTime(!!this.setting.hasOwnProperty("isDisplayPlayTime")&&this.setting.isDisplayPlayTime),this.setHUD(!this.setting.hasOwnProperty("isHUD")||this.setting.isHUD),this.setTheme(this.setting.hasOwnProperty("theme")?Object.keys(c.b).includes(this.setting.theme)?this.setting.theme:Object.keys(c.b)[0]:"RED"),this.setDebugLog(!!this.setting.hasOwnProperty("isDebugLog")&&this.setting.isDebugLog)}reset(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;for(const e in this.setting)delete this.setting[e];this.init(e)}saveSetting(){(0,r.b)("setting")}setSensibility(e){this.setting.sensibility=e,this.saveSetting()}setInvertX(e){this.setting.invertX=e,this.saveSetting()}setInvertY(e){this.setting.invertY=e,this.saveSetting()}setBob(e){this.setting.bob=e,this.saveSetting()}setToggleSprint(e){this.setting.toggleSprint=e,this.saveSetting()}setToggleCluch(e){this.setting.toggleCluch=e,this.saveSetting()}setWeaponChargeStandTime(e){this.setting.weaponChargeStandTime=e,this.saveSetting()}setWeaponWheelStandTime(e){this.setting.weaponWheelStandTime=e,this.saveSetting()}setEatSound(e){this.setting.eatSound=e,this.saveSetting()}setEnemyVoice(e){this.setting.enemyVoice=e,this.saveSetting()}setCheckPoint(e){this.setting.isCheckPoint=e,this.saveSetting()}setPistolStart(e){this.setting.isPistolStart=e,this.saveSetting()}setPermaDeath(e){this.setting.isPermaDeath=e,this.saveSetting()}setSSSSlowMo(e){this.setting.isSSSSlowMo=e,this.saveSetting()}setFOV(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null!==t&&t.getScenes().forEach((t=>{if(!(t instanceof s.a))return;t.getCamera().fov=(0,a.d)(e)})),this.setting.fov=e,this.saveSetting()}setFramerate(e){e>=l.a.length&&(e=1),this.setting.framerateIndex=e,this.saveSetting()}setSoundVolume(e){this.setting.soundVolume=e,this.saveSetting()}setClusterResolution(e){this.setting.clusterResolution=e,this.saveSetting()}setFullscreen(e){this.setting.isFullscreen=e,this.saveSetting()}setBrowserFullscreen(e){this.setting.isBrowserFullscreen=e,this.saveSetting()}setAutomaticResolution(e){this.setting.isAutomaticResolution=e,this.saveSetting()}setResolutionIndex(e){this.setting.resolutionIndex=e,this.saveSetting()}setHighPixelRatio(e){this.setting.isHighPixelRatio=e,this.saveSetting()}setReflectionCount(e){this.setting.reflectionCount=e,this.saveSetting()}setShadow(e){this.setting.isShadow=e,this.saveSetting()}setSoftShadow(e){this.setting.isSoftShadow=e,this.saveSetting()}setRoughness(e){this.setting.isRoughness=e,this.saveSetting()}setDithering(e){this.setting.isDithering=e,this.saveSetting()}setBloom(e){this.setting.bloom=e,this.saveSetting()}setMuzzleFlash(e){this.setting.isMuzzleFlash=e,this.saveSetting()}setBlurDotScale(e){this.setting.blurDotScale=e,this.saveSetting()}setContrast(e){this.setting.contrast=e,this.saveSetting()}setBrightness(e){this.setting.brightness=e,this.saveSetting()}setCRTEnable(e){this.setting.isCRT=e,this.saveSetting()}setCRTDeep(e){this.setting.crtDeep=e,this.saveSetting()}setCRTSubPixel(e){this.setting.crtSubPixel=e,this.saveSetting()}setCRTLens(e){this.setting.crtLens=e,this.saveSetting()}setCRTEdge(e){this.setting.crtEdge=e,this.saveSetting()}setCRTVig(e){this.setting.crtVig=e,this.saveSetting()}setCRTShadowMask(e){this.setting.isCRTShadowMask=e,this.saveSetting()}setCRTCenterFadeOut(e){this.setting.crtCenterFadeOut=e,this.saveSetting()}setStickInnerDeadzoneX(e){this.setting.stickInnerDeadzoneX=e,this.saveSetting()}setStickOuterDeadzoneX(e){this.setting.stickOuterDeadzoneX=e,this.saveSetting()}setStickInnerDeadzoneY(e){this.setting.stickInnerDeadzoneY=e,this.saveSetting()}setStickOuterDeadzoneY(e){this.setting.stickOuterDeadzoneY=e,this.saveSetting()}setWheelInnerDeadzone(e){this.setting.wheelInnerDeadzone=e,this.saveSetting()}setWheelOuterDeadzone(e){this.setting.wheelOuterDeadzone=e,this.saveSetting()}setDisplayPlayTime(e){this.setting.isDisplayPlayTime=e,this.saveSetting()}setHUD(e){this.setting.isHUD=e,this.saveSetting()}setTheme(e){this.setting.theme=e,this.saveSetting()}setDebugLog(e){this.setting.isDebugLog=e,this.saveSetting()}hasBob(){return this.setting.bob}hasToggleSprint(){return this.setting.toggleSprint}hasToggleCluch(){return this.setting.toggleCluch}getWeaponChargeStandTime(){return this.setting.weaponChargeStandTime}getWeaponWheelStandTime(){return this.setting.weaponWheelStandTime}hasEatSound(){return this.setting.eatSound}hasEnemyVoice(){return this.setting.enemyVoice}hasCheckPoint(){return this.setting.isCheckPoint}hasPistolStart(){return this.setting.isPistolStart}hasPermaDeath(){return this.setting.isPermaDeath}hasSSSSlowMo(){return this.setting.isSSSSlowMo}hasDebugLog(){return this.setting.isDebugLog}getSoundVolume(){return this.setting.soundVolume}getReflectionCount(){return this.setting.reflectionCount}getBlurDotScale(){return this.hasCRT()?1:this.setting.blurDotScale}hasShadow(){return this.setting.isShadow}hasSoftShadow(){return this.setting.isSoftShadow}hasRoughness(){return this.setting.isRoughness}getBloom(){return this.setting.bloom}hasMuzzleFlash(){return this.setting.isMuzzleFlash}getContrast(){return this.setting.contrast}getBrightness(){return this.setting.brightness}hasCRT(){return this.setting.isCRT}getResolutionIndex(){return this.setting.resolutionIndex}hasHighPixelRatio(){return this.setting.isHighPixelRatio}hasFullscreen(){return this.setting.isFullscreen}hasBrowserFullscreen(){return this.setting.isBrowserFullscreen}hasAutomaticResolution(){return this.setting.isAutomaticResolution}getCRTSubPixel(){return this.setting.crtSubPixel}getCRTLens(){return this.setting.crtLens}getCRTDeep(){return this.setting.crtDeep}getCRTEdge(){return this.setting.crtEdge}getCRTVig(){return this.setting.crtVig}hasCRTShadowMask(){return this.setting.isCRTShadowMask}getCRTCenterFadeOut(){return this.setting.crtCenterFadeOut}getSensibility(){return this.setting.sensibility}hasInvertX(){return this.setting.invertX}hasInvertY(){return this.setting.invertY}getStickInnerDeadzoneX(){return this.setting.stickInnerDeadzoneX}getStickOuterDeadzoneX(){return this.setting.stickOuterDeadzoneX}getStickInnerDeadzoneY(){return this.setting.stickInnerDeadzoneY}getStickOuterDeadzoneY(){return this.setting.stickOuterDeadzoneY}getWheelInnerDeadzone(){return this.setting.wheelInnerDeadzone}getWheelOuterDeadzone(){return this.setting.wheelOuterDeadzone}getFramerate(){return(0,o.a)()?l.a[this.setting.framerateIndex]:1/0}getFramerateIndex(){return this.setting.framerateIndex}hasDisplayPlayTime(){return this.setting.isDisplayPlayTime}hasHUD(){return this.setting.isHUD}getTheme(){return this.setting.theme}getFOV(){return this.setting.fov}}i()}catch(e){i(e)}}))},(e,t,n)=>{"use strict";n.a(e,(async(e,i)=>{try{n.d(t,{a:()=>M});n(1),n(2),n(20),n(21);var r=n(254),o=n(255),a=n(256),s=n(257),l=n(159),c=n(53),u=n(6),d=n(258),h=n(259),f=n(260),g=n(160),p=n(262),m=n(263),v=n(85),_=n(35),y=n(155),b=n(268),w=n(269),E=n(264),x=n(265),O=n(266),T=n(82),R=e([g]);function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}g=(R.then?(await R)():R)[0];const A=[[1,0],[0,1],[-1,0],[0,-1]];function L(e,t){return e.top===t.top&&e.bottom===t.bottom&&e.right===t.right&&e.left===t.left&&e.front===t.front&&e.back===t.back}class M extends m.a{constructor(e,t,n,i,l,c,g,m,v,_,b,w,E,x,O,T,R){super(e,m,v,_,b,w),S(this,"margin",void 0),S(this,"isForceUpdate",!1),S(this,"materials",void 0),S(this,"voxels",void 0),S(this,"tileSet",null),S(this,"background",null),S(this,"mats",{}),S(this,"camera",void 0),S(this,"sun",void 0),S(this,"lateTime",0),S(this,"starttime",0),S(this,"map",void 0),S(this,"offset",void 0),S(this,"trees",{range:new o.a((e=>e instanceof a.a&&e.hasComponent(s.a)),(e=>{if(!(e instanceof a.a))return[-1,-1,-1,-1,-1];const t=e.getComponent(s.a),n=t.treeFix&&e.hasComponent(p.a)?e.getComponent(p.a).position:new u.c(0,0,0);return[e.position.x+n.x,e.position.y+n.y,e.position.z+n.z,t.size.x,t.size.y]})),hitbox:new o.a((e=>e instanceof a.a&&e.hasComponent(h.a)),(e=>{if(!(e instanceof a.a))return[-1,-1,-1,-1,-1];const t=e.getComponent(h.a),n=t.treeFix&&e.hasComponent(p.a)?e.getComponent(p.a).position:new u.c(0,0,0);return[e.position.x+n.x,e.position.y+n.y,e.position.z+n.z,t.size.x,t.size.y]})),collision:new o.a((e=>e instanceof a.a&&e.hasComponent(d.a)),(e=>{if(!(e instanceof a.a))return[-1,-1,-1,-1,-1];const t=e.getComponent(d.a),n=t.treeFix&&e.hasComponent(p.a)?e.getComponent(p.a).position:new u.c(0,0,0);return[e.position.x+n.x,e.position.y+n.y,e.position.z+n.z,t.size.x,t.size.y]}))}),S(this,"maxFramerate",void 0),S(this,"finder",new f.a),S(this,"transferDataBuilder",void 0),S(this,"renderEntitys",new Array),this.margin=l,this.materials=E,this.voxels=x,this.camera=T,this.sun=R,this.addEntitys(T,R),this.maxFramerate=g,this.transferDataBuilder=new y.c(O,c,1/0),this.offset={top:l,bottom:l,front:l,back:l,right:l,left:l},this.map=new r.a(t,n,i,"int32",1,0)}initTrees(e){for(const t in this.trees){const n=this.trees[t];n.hasEntity(e)&&n.initOldPosition(e)}}addEntitys(){for(let e=0,t=0|arguments.length;e<t;e=e+1|0){const t=e<0||arguments.length<=e?void 0:arguments[e];for(const e in this.trees){this.trees[e].add(t)}}super.addEntitys(...arguments)}getMaterialManager(){return this.materials}getVoxelManager(){return this.voxels}getMap(){return this.map}getWorldDistance(){return this.map.getWorldDistance()}getWorldSize(){return this.map.getSize()}getCamera(){return this.camera}getSun(){return this.sun}getMargin(){return this.margin}getOffset(){return this.offset}getVoxel(e,t,n){return this.getVoxelManager().getVoxel(this.getVoxelField(e,t,n))}getVoxelField(e,t,n){return this.map.get(0,e,t,n,this.map.getVoxelField(),this.map.getSize())}getDistanceField(e,t,n){return this.map.get(0,e,t,n,this.map.getDistanceField(),this.map.getSize())}getMortonField(e,t,n){return this.map.get(0,e,t,n,this.map.getMortonField(),this.map.getSize())}getMaterials(){return this.mats}getTileSet(){return this.tileSet}getBackground(){return this.background||{theme:0,rise_up_color:[50/255,125/255,50/255],night_up_color:[50/255,125/255,50/255],rise_down_color:[100/255,125/255,50/255],night_down_color:[100/255,125/255,50/255],material_up:[1,.625,.075],material_down:[1,.625,0],noise_size:5,noise_length:2}}getLateTime(){return this.lateTime}getTree(e){return this.trees[e]||null}setWorldSize(e,t,n,i,r,o,a,s,l){this.map.setSize(e,t,n),this.offset.top=i,this.offset.bottom=r,this.offset.front=o,this.offset.back=a,this.offset.right=s,this.offset.left=l}setWorldData(e){const{voxels:t,map:n,offset:i}=e;this.setWorldSize(n.size.width,n.size.height,n.size.depth,i.top,i.bottom,i.front,i.back,i.right,i.left);this.getVoxelManager().initData(t),this.map.initData(n.voxel_field,n.distance_field,n.morton_field,(0,T.a)(n.voxel_inserts),(0,T.a)(n.distance_inserts),(0,T.a)(n.morton_inserts))}setActorPosition(e,t,n,i){if(e.position.x=t,e.position.y=n,e.position.z=i,e.hasComponent(E.a)){const r=e.getComponent(E.a);r.old.x=t,r.old.y=n,r.old.z=i}if(e.hasComponent(d.a)){const r=e.getComponent(d.a);r.old.x=t,r.old.y=n,r.old.z=i}if(e.hasComponent(x.a)){const t=e.getComponent(x.a);t.value.x=0,t.value.y=0,t.value.z=0}if(e.hasComponent(O.a)){const t=e.getComponent(O.a);t.move.x=0,t.move.y=0,t.move.z=0,t.look.x=0,t.look.y=0}this.initTrees(e)}setCamera(e){this.camera=e}setSun(e){this.sun=e}setTileSet(e){this.tileSet!==e&&(this.isForceUpdate=!0),this.tileSet=e}setBackground(e){this.background=e}setMaterials(e){for(const t in e)this.mats[t]=e[t]}setVoxel(e,t,n,i){var r;let o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const s=this.getVoxelManager(),l=s.getVoxels(),c=this.map.get(0,e,t,n),u=s.getVoxel(c);c>0&&((null===(r=this.map.getVoxelInsertData(c))||void 0===r?void 0:r.count)||0)<=0&&s.removeVoxels(u);const d=L(i,g.c);let h=!1,f=null;if(d)h=!0,f=g.c;else for(let e=0,t=0|l.length;e<t;e=e+1|0){const t=l[e]||null;if(null!==t&&L(t,i)){h=!0,f=t;break}}if(h||(f=i,s.addVoxels(i)),null!==f){const i=d?0:l.indexOf(f);this.setVoxelField(e,t,n,i,o)}a&&(d?this.reductionPosition():this.expandPosition())}setVoxelField(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.map.set(0,e,t,n,i,r,this.map.getVoxelField()),!r&&i<=0&&this.setDistanceField(e,t,n,1)}setDistanceField(e,t,n,i){this.map.set(0,e,t,n,i,!1,this.map.getDistanceField())}setMortonField(e,t,n,i){this.map.set(0,e,t,n,i,!1,this.map.getMortonField())}hasOutOfWorld(e,t,n){return(0,c.d)(this.map,e,t,n)}clearMap(){const e=this.getMap();this.getVoxelManager();e.clear()}clearTree(){for(const e in this.trees){this.trees[e].clear()}}clearControl(){this.getControlManager().clear()}clear(){this.clearMap(),this.clearTree(),this.clearControl(),this.lateTime=0,super.clear()}getEntitysOfRange(e,t,n,i,r,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new Array;const s=new Array,d=this.trees[e],h=e=>a.includes(e),f=(0,c.c)(t,n-o/2,i,r,o);for(let e=0,a=0|f.length;e<a;e=e+3|0){const a=f[e],c=f[e+1],g=f[e+2],p=d.getPointCell(a,c,g);for(let e=0,a=0|p.length;e<a;e=e+1|0){const a=p[e],c=this.getEntityOfID(a);if(null===c||!c.hasLive()||h(a)||c.getNames().some(h))continue;const[f,g,m,_,y]=d.getEntityProperty(c);if(-1===f&&-1===g&&-1===m)continue;let[b,w,E,x,O]=d.getOldEntityProperty(c);b=-1===b?f:b,w=-1===w?g:w,E=-1===E?m:E,x=-1===x?_:x,O=-1===O?y:O;const T=f-b,R=g-w,S=m-E,[A,L]=(0,u.k)(T,R,S,0,0,0),[M,P,I]=(0,u.o)(A,L,0,0,1),F=Math.min((0,u.m)(T,R,S,0,0,0),this.getWorldDistance()),C=Math.min(F,Math.max(Math.min(_,y),Math.min(x,O))/2,.5);let D=0;for(;;){const e=b+D*M,a=w+D*P,u=E+D*I,d=(0,v.b)((0,v.c)(D/F),0),h=x+(_-x)*d,f=O+(y-O)*d;if((0,l.c)(t,n-o/2,i,r,o,e,a,u,h,f)){s.push(c);break}if(D>=F)break;if(D=(0,v.a)((0,v.b)(D+C,F,1e5,Math.ceil),0,F),D<=0)break}}}return s}hitScan(e,t,n,i,r,o,a){let s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];const d=new Array,h=this.trees[e],f=e=>s.includes(e);let p=!1;const[m,y,b,w]=(0,c.k)(t,n,i,r,o,a,this.getWorldSize(),((e,t,n)=>!L(this.getVoxel(e,t,n),g.c)),((e,a,s,c,g,m,_,y,b,w,E,x,O,T,R,S,A,L)=>{const M=h.getPointCell(e,a,s);for(let e=0,a=0|M.length;e<a;e=e+1|0){const a=M[e],s=this.getEntityOfID(a);if(null===s||!s.hasLive()||f(a)||s.getNames().some(f))continue;const[_,y,b,w,E]=h.getEntityProperty(s);if(-1===_&&-1===y&&-1===b)continue;let[x,O,T,R,S]=h.getOldEntityProperty(s);x=-1===x?_:x,O=-1===O?y:O,T=-1===T?b:T,R=R?w:R,S=S?E:S;const A=_-x,L=y-O,P=b-T,[I,F]=(0,u.k)(A,L,P,0,0,0),[C,D,N]=(0,u.o)(I,F,0,0,1),k=Math.min((0,u.m)(A,L,P,0,0,0),this.getWorldDistance()),B=Math.min(k,Math.max(Math.min(w,E),Math.min(R,S))/2,.5);let U=0;for(;;){const e=x+U*C,a=O+U*D,h=T+U*N,f=(0,v.b)((0,v.c)(U/k),0),_=R+(w-R)*f,y=S+(E-S)*f;if((i<c?i<e+_/2:c<e+_/2)&&(r<g?r<a+y:g<a+y)&&(o<m?o<h+_/2:m<h+_/2)&&(i>c?i>e-_/2:c>e-_/2)&&(r>g?r>a:g>a)&&(o>m?o>h-_/2:m>h-_/2)){const[c,f,g]=(0,l.a)(i,r,o,t,n,e,a,h,e,a+y,h,_);if(-1!==c&&-1!==f&&-1!==g){const e=(0,u.m)(c,f,g,i,r,o);d.push([c,f,g,e,s]),p=!0;break}}if(U>=k)break;if(U=(0,v.a)((0,v.b)(U+B,k,1e5,Math.ceil),0,k),U<=0)break}}return p}));return-1!==m&&-1!==m&&-1!==b&&d.push([m,y,b,w,null]),d.length>1&&(0,_.c)(d).asc((e=>e[3])),d[0]||[-1,-1,-1,-1,null]}hitScanVoxel(e,t,n,i,r,o){return(0,c.j)(e,t,n,i,r,o,this.getWorldSize(),((e,t,n)=>this.getDistanceField(e,t,n)))}hitScanActor(e,t,n,i,r,o,a){let s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];const d=new Array,h=this.trees[e],f=e=>s.includes(e);let p=!1;return(0,c.k)(t,n,i,r,o,a,this.getWorldSize(),((e,t,n)=>!L(this.getVoxel(e,t,n),g.c)),((e,a,s,c,g,m,_,y,b,w,E,x,O,T,R,S,A,L)=>{const M=h.getPointCell(e,a,s);for(let e=0,a=0|M.length;e<a;e=e+1|0){const a=M[e],s=this.getEntityOfID(a);if(null===s||!s.hasLive()||f(a)||s.getNames().some(f))continue;const[_,y,b,w,E]=h.getEntityProperty(s);if(-1===_&&-1===y&&-1===b)continue;let[x,O,T,R,S]=h.getOldEntityProperty(s);x=-1===x?_:x,O=-1===O?y:O,T=-1===T?b:T,R=R?w:R,S=S?E:S;const A=_-x,L=y-O,P=b-T,[I,F]=(0,u.k)(A,L,P,0,0,0),[C,D,N]=(0,u.o)(I,F,0,0,1),k=Math.min((0,u.m)(A,L,P,0,0,0),this.getWorldDistance()),B=Math.min(k,Math.max(Math.min(w,E),Math.min(R,S))/2,.5);let U=0;for(;;){const e=x+U*C,a=O+U*D,h=T+U*N,f=(0,v.b)((0,v.c)(U/k),0),_=R+(w-R)*f,y=S+(E-S)*f;if((i<c?i<e+_/2:c<e+_/2)&&(r<g?r<a+y:g<a+y)&&(o<m?o<h+_/2:m<h+_/2)&&(i>c?i>e-_/2:c>e-_/2)&&(r>g?r>a:g>a)&&(o>m?o>h-_/2:m>h-_/2)){const[c,f,g]=(0,l.a)(i,r,o,t,n,e,a,h,e,a+y,h,_);if(-1!==c&&-1!==f&&-1!==g){const e=(0,u.m)(c,f,g,i,r,o);return d.push([c,f,g,e,s]),p=!0,!0}}if(U>=k)break;if(U=(0,v.a)((0,v.b)(U+B,k,1e5,Math.ceil),0,k),U<=0)break}}return p})),d[0]||[-1,-1,-1,-1,null]}hitScanBold(e,t,n,i,r,o,a,s){let d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[];const h=new Array,f=e=>d.includes(e),g=this.trees[e],[p,m,y]=this.getWorldSize(),b=(0,u.m)(p,m,y,0,0,0);let[w,E,x,O]=this.hitScanVoxelBoldFindMin(t,n,i,r,o,a,b);const T=Math.min(s,O,(0,u.m)(p,m,y,0,0,0)),[R,S,A]=(0,u.o)(t,n,0,0,T),L=Math.min((0,u.m)(R,S,A,0,0,0),this.getWorldDistance());-1!==w&&-1!==E&&-1!==x&&h.push([w,E,x,O,null]);const[M,P]=(0,u.k)(R,S,A,0,0,0),[I,F,C]=(0,u.o)(M,P,0,0,1),D=Math.min(L,a/2,.5);Math.max(...this.getWorldSize());let N=0,k=!1;for(;;){const e=i+N*I,t=r+N*F,n=o+N*C,s=(0,c.c)(e,t-a/2,n,a,a);for(let c=0,d=0|s.length;c<d;c=c+3|0){const d=s[c+0],p=s[c+1],m=s[c+2],_=g.getPointCell(d,p,m);for(let s=0,c=0|_.length;s<c;s=s+1|0){const c=_[s],d=this.getEntityOfID(c);if(null===d||!d.hasLive()||f(c)||d.getNames().some(f))continue;const[p,m,y,b,w]=g.getEntityProperty(d);if(-1===p&&-1===m&&-1===y)continue;let[E,x,O,R,S]=g.getOldEntityProperty(d);E=-1===E?p:E,x=-1===x?m:x,O=-1===O?y:O,R=R?b:R,S=S?w:S;const A=p-E,L=m-x,M=y-O,[P,I]=(0,u.k)(A,L,M,0,0,0),[F,C,D]=(0,u.o)(P,I,0,0,1),N=Math.min((0,u.m)(A,L,M,0,0,0),this.getWorldDistance()),B=Math.min(N,Math.max(Math.min(b,w),Math.min(R,S))/2,.5);let U=0;for(;;){const s=E+U*F,c=x+U*C,f=O+U*D,g=(0,v.b)((0,v.c)(U/N),0),p=R+(b-R)*g,m=S+(w-S)*g;if((0,l.c)(e,t-a/2,n,a,a,s,c,f,p,m)){const a=(0,u.m)(e,t,n,i,r,o);if(a<T){h.push([e,t,n,a,d]),k=!0;break}}if(U>=N)break;if(U=(0,v.a)((0,v.b)(U+B,N,1e5,Math.ceil),0,N),U<=0)break}}}if(k||N>=L)break;N=(0,v.a)((0,v.b)(N+D,L,1e5,Math.ceil),0,L)}return h.length>1&&(0,_.c)(h).asc((e=>e[3])),h.length>0?h[0]:[-1,-1,-1,-1,null]}hitScanBoldFind(e,t,n,i,r,o,a,s){let d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[];const h=new Array,f=e=>d.includes(e),g=this.trees[e],[p,m,y]=this.getWorldSize(),b=(0,u.m)(p,m,y,0,0,0),[w,E,x,O]=this.hitScanVoxelBoldFindMax(t,n,i,r,o,a,b),T=Math.min(s,O,(0,u.m)(p,m,y,0,0,0)),[R,S,A]=(0,u.o)(t,n,0,0,T),L=Math.min((0,u.m)(R,S,A,0,0,0),this.getWorldDistance()),[M,P,I,F]=this.hitScanVoxelBoldFindMin(t,n,i,r,o,a,s);if(-1!==M&&-1!==P&&-1!==I&&h.push([M,P,I,F,null]),-1!==w&&-1!==E&&-1!==x){const[e,t]=(0,u.k)(R,S,A,0,0,0),[n,s,d]=(0,u.o)(e,t,0,0,1),p=Math.min(L,a/2,.5);Math.max(...this.getWorldSize());let m=0,_=!1;for(;;){const e=i+m*n,t=r+m*s,y=o+m*d,b=(0,c.c)(e,t-a/2,y,a,a);for(let n=0,s=0|b.length;n<s;n=n+3|0){const s=b[n+0],c=b[n+1],d=b[n+2],p=g.getPointCell(s,c,d);for(let n=0,s=0|p.length;n<s;n=n+1|0){const s=p[n],c=this.getEntityOfID(s);if(null===c||!c.hasLive()||f(s)||c.getNames().some(f))continue;const[d,m,b,w,E]=g.getEntityProperty(c);if(-1===d&&-1===m&&-1===b)continue;let[x,O,R,S,A]=g.getOldEntityProperty(c);x=-1===x?d:x,O=-1===O?m:O,R=-1===R?b:R,S=S?w:S,A=A?E:A;const L=d-x,M=m-O,P=b-R,[I,F]=(0,u.k)(L,M,P,0,0,0),[C,D,N]=(0,u.o)(I,F,0,0,1),k=Math.min((0,u.m)(L,M,P,0,0,0),this.getWorldDistance()),B=Math.min(k,Math.max(Math.min(w,E),Math.min(S,A))/2,.5);let U=0;for(;;){const n=x+U*C,s=O+U*D,d=R+U*N,f=(0,v.b)((0,v.c)(U/k),0),g=S+(w-S)*f,p=A+(E-A)*f;if((0,l.c)(e,t-a/2,y,a,a,n,s,d,g,p)){const n=(0,u.m)(e,t,y,i,r,o);if(n<T){h.push([e,t,y,n,c]),_=!0;break}}if(U>=k)break;if(U=(0,v.a)((0,v.b)(U+B,k,1e5,Math.ceil),0,k),U<=0)break}}}if(_||m>=L)break;m=(0,v.a)((0,v.b)(m+p,L,1e5,Math.ceil),0,L)}}return h.length>1&&(0,_.c)(h).asc((e=>e[3])),h.length>0?h[0]:[-1,-1,-1,-1,null]}hitScanVoxelBoldFindMin(e,t,n,i,r,o){let a=-1,s=-1,l=-1,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1/0;const d=o/2;let h=!1;for(let o=0,f=0|A.length;o<f;o=o+1|0){const f=(0,u.j)(A[o][0],A[o][1],0,0),g=Math.cos(f)*d,p=Math.sin(f)*d,[m,v,_]=(0,u.o)(e,t,g,p,0),[y,b,w,E]=this.hitScanVoxel(e,t,n+m,i+v,r+_,c);-1!==y&&-1!==b&&-1!==w&&E<c&&(a=y-m,s=b-v,l=w-_,c=E,h=!0)}return[a,s,l,h?c:-1]}hitScanVoxelBoldFindMax(e,t,n,i,r,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1/0,s=-1,l=-1,c=-1,d=0;const h=o/2;let f=!1;for(let o=0,g=0|A.length;o<g;o=o+1|0){const g=(0,u.j)(A[o][0],A[o][1],0,0),p=Math.cos(g)*h,m=Math.sin(g)*h,[v,_,y]=(0,u.o)(e,t,p,m,0),[b,w,E,x]=this.hitScanVoxel(e,t,n+v,i+_,r+y,a);-1!==b&&-1!==w&&-1!==E&&x>d&&(s=b-v,l=w-_,c=E-y,d=x,f=!0)}return[s,l,c,f?d:-1]}hitScanVoxelBold(e,t,n,i,r,o,a){const s=new Array,[l,d,h]=this.getWorldSize(),f=Math.min(a,(0,u.m)(l,d,h,0,0,0)),[g,p,m]=(0,u.o)(e,t,0,0,f),[y,b]=(0,u.k)(g,p,m,0,0,0),[w,E,x]=(0,u.o)(y,b,0,0,1),O=Math.min(f,o/2,.5);let T=0;const R=this.getMap();for(;;){const a=n+T*w,g=i+T*E,p=r+T*x,m=(0,c.c)(a,g-o/2,p,o,o);for(let o=0,c=0|m.length;o<c;o=o+3|0){const c=m[o+0],f=m[o+1],v=m[o+2];if(0>c||l<=c||0>f||d<=f||0>v||h<=v||R.get(0,c,f,v)>0){const[o,l]=(0,u.k)(c+.5,f+.5,v+.5,a,g,p),d=(0,u.m)(c+.5,f+.5,v+.5,a,g,p),h=Math.cos(o)+Math.sin(o),m=Math.sin(l)+Math.cos(l),[_,y,b]=(0,u.o)(e,t,0,0,d-Math.sqrt(Math.max(h*h,m*m))+(0,u.m)(a,g,p,n,i,r));s.push([_+n,y+i,b+r,(0,u.m)(_+n,y+i,b+r,n,i,r),null]);break}}if(T>=f)break;if(T=(0,v.a)((0,v.b)(T+O,f,1e5,Math.ceil),0,f),T<=0)break}return s.length>1&&(0,_.c)(s).asc((e=>e[3])),s[0]||[-1,-1,-1,-1,null]}hitScanBoldActor(e,t,n,i,r,o,a,s){let d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[];const h=new Array,f=e=>d.includes(e),g=this.trees[e],[p,m,y]=this.getWorldSize(),b=(Math.max(...this.getWorldSize()),Math.min(s,(0,u.m)(p,m,y,0,0,0))),[w,E,x]=(0,u.o)(t,n,0,0,b),[O,T]=(0,u.k)(w,E,x,0,0,0),[R,S,A]=(0,u.o)(O,T,0,0,1),L=Math.min(b,a/2,.5);let M=0,P=!1;for(;;){const e=i+M*R,t=r+M*S,n=o+M*A,s=(0,c.c)(e,t-a/2,n,a,a);for(let c=0,d=0|s.length;c<d;c=c+3|0){const d=s[c+0],p=s[c+1],m=s[c+2],_=g.getPointCell(d,p,m);for(let s=0,c=0|_.length;s<c;s=s+1|0){const c=_[s],d=this.getEntityOfID(c);if(null===d||!d.hasLive()||f(c)||d.getNames().some(f))continue;const[p,m,y,b,w]=g.getEntityProperty(d);if(-1===p&&-1===m&&-1===y)continue;let[E,x,O,T,R]=g.getOldEntityProperty(d);E=-1===E?p:E,x=-1===x?m:x,O=-1===O?y:O,T=T?b:T,R=R?w:R;const S=p-E,A=m-x,L=y-O,[M,I]=(0,u.k)(S,A,L,0,0,0),[F,C,D]=(0,u.o)(M,I,0,0,1),N=Math.min((0,u.m)(S,A,L,0,0,0),this.getWorldDistance()),k=Math.min(N,Math.max(Math.min(b,w),Math.min(T,R))/2,.5);let B=0;for(;;){const s=E+B*F,c=x+B*C,f=O+B*D,g=(0,v.b)((0,v.c)(B/N),0),p=T+(b-T)*g,m=R+(w-R)*g;if((0,l.c)(e,t-a/2,n,a,a,s,c,f,p,m)){const a=(0,u.m)(e,t,n,i,r,o);h.push([e,t,n,a,d]),P=!0;break}if(B>=N)break;if(B=(0,v.a)((0,v.b)(B+k,N,1e5,Math.ceil),0,N),B<=0)break}}}if(P||M>=b)break;M=(0,v.a)((0,v.b)(M+L,b,1e5,Math.ceil),0,b)}return h.length>1&&(0,_.c)(h).asc((e=>e[3])),h[0]||[-1,-1,-1,-1,null]}hasBlockScale(e,t,n,i,r,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new Array;if(this.hasBlockScaleVoxel(t,n,i,r,o))return!0;const s=this.trees[e],d=e=>a.includes(e),h=(0,c.c)(t,n,i,r,o);for(let e=0,a=0|h.length;e<a;e=e+3|0){const a=h[e],c=h[e+1],f=h[e+2],g=s.getPointCell(a,c,f);for(let e=0,a=0|g.length;e<a;e=e+1|0){const a=g[e],c=this.getEntityOfID(a);if(null===c||!c.hasLive()||d(a)||c.getNames().some(d))continue;const[h,f,p,m,_]=s.getEntityProperty(c);if(-1===h&&-1===f&&-1===p)continue;let[y,b,w,E,x]=s.getOldEntityProperty(c);y=-1===y?h:y,b=-1===b?f:b,w=-1===w?p:w,E=E?m:E,x=x?_:x;const O=h-y,T=f-b,R=p-w,[S,A]=(0,u.k)(O,T,R,0,0,0),[L,M,P]=(0,u.o)(S,A,0,0,1),I=Math.min((0,u.m)(O,T,R,0,0,0),this.getWorldDistance()),F=Math.min(I,Math.max(Math.min(m,_),Math.min(E,x))/2,.5);let C=0;for(;;){const e=y+C*L,a=b+C*M,s=w+C*P,c=(0,v.b)((0,v.c)(C/I),0),u=E+(m-E)*c,d=x+(_-x)*c;if((0,l.c)(t,n,i,r,o,e,a,s,u,d))return!0;if(C>=I)break;if(C=(0,v.a)((0,v.b)(C+F,I,1e5,Math.ceil),0,I),C<=0)break}}}return!1}hasBlockScaleVoxel(e,t,n,i,r){const o=this.getMap();return(0,l.b)(e,t,n,i,r,((e,t,n,i)=>o.get(0,t,n,i)>0))}hasHitScanVoxel(e,t,n,i,r,o){return(0,c.e)(e,t,n,i,r,o,this.getWorldSize(),((e,t,n)=>this.getDistanceField(e,t,n)))}hasHitScan(e,t,n,i,r,o,a){let s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];const d=this.trees[e],h=e=>s.includes(e);let f=!1;return(0,c.f)(t,n,i,r,o,a,this.getWorldSize(),((e,t,n)=>!L(this.getVoxel(e,t,n),g.c)),((e,a,s,c,g,p,m,_,y,b,w,E,x,O,T,R,S,A)=>{const L=d.getPointCell(e,a,s);for(let e=0,a=0|L.length;e<a;e=e+1|0){const a=L[e],s=this.getEntityOfID(a);if(null===s||!s.hasLive()||h(a)||s.getNames().some(h))continue;const[m,_,y,b,w]=d.getEntityProperty(s);if(-1===m&&-1===_&&-1===y)continue;let[E,x,O,T,R]=d.getOldEntityProperty(s);E=-1===E?m:E,x=-1===x?_:x,O=-1===O?y:O,T=T?b:T,R=R?w:R;const S=m-E,A=_-x,M=y-O,[P,I]=(0,u.k)(S,A,M,0,0,0),[F,C,D]=(0,u.o)(P,I,0,0,1),N=Math.min((0,u.m)(S,A,M,0,0,0),this.getWorldDistance()),k=Math.min(N,Math.max(Math.min(b,w),Math.min(T,R))/2,.5);let B=0;for(;;){const e=E+B*F,a=x+B*C,s=O+B*D,u=(0,v.b)((0,v.c)(B/N),0),d=T+(b-T)*u,h=R+(w-R)*u;if((i<c?i<e+d/2:c<e+d/2)&&(r<g?r<a+h:g<a+h)&&(o<p?o<s+d/2:p<s+d/2)&&(i>c?i>e-d/2:c>e-d/2)&&(r>g?r>a:g>a)&&(o>p?o>s-d/2:p>s-d/2)){const[c,u,g]=(0,l.a)(i,r,o,t,n,e,a,s,e,a+h,s,d);if(-1!==c&&-1!==u&&-1!==g)return f=!0,!0}if(B>=N)break;if(B=(0,v.a)((0,v.b)(B+k,N,1e5,Math.ceil),0,N),B<=0)break}}return!1}))||f}hasHitScanActor(e,t,n,i,r,o,a){let s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];const d=this.trees[e],h=e=>s.includes(e);let f=!1;return(0,c.f)(t,n,i,r,o,a,this.getWorldSize(),((e,t,n)=>!L(this.getVoxel(e,t,n),g.c)),((e,a,s,c,g,p,m,_,y,b,w,E,x,O,T,R,S,A)=>{const L=d.getPointCell(e,a,s);for(let e=0,a=0|L.length;e<a;e=e+1|0){const a=L[e],s=this.getEntityOfID(a);if(null===s||!s.hasLive()||h(a)||s.getNames().some(h))continue;const[m,_,y,b,w]=d.getEntityProperty(s);if(-1===m&&-1===_&&-1===y)continue;let[E,x,O,T,R]=d.getOldEntityProperty(s);E=-1===E?m:E,x=-1===x?_:x,O=-1===O?y:O,T=T?b:T,R=R?w:R;const S=m-E,A=_-x,M=y-O,[P,I]=(0,u.k)(S,A,M,0,0,0),[F,C,D]=(0,u.o)(P,I,0,0,1),N=Math.min((0,u.m)(S,A,M,0,0,0),this.getWorldDistance()),k=Math.min(N,Math.max(Math.min(b,w),Math.min(T,R))/2,.5);let B=0;for(;;){const e=E+B*F,a=x+B*C,s=O+B*D,u=(0,v.b)((0,v.c)(B/N),0),d=T+(b-T)*u,h=R+(w-R)*u;if((i<c?i<e+d/2:c<e+d/2)&&(r<g?r<a+h:g<a+h)&&(o<p?o<s+d/2:p<s+d/2)&&(i>c?i>e-d/2:c>e-d/2)&&(r>g?r>a:g>a)&&(o>p?o>s-d/2:p>s-d/2)){const[c,u,g]=(0,l.a)(i,r,o,t,n,e,a,s,e,a+h,s,d);if(-1!==c&&-1!==u&&-1!==g)return f=!0,!0}if(B>=N)break;if(B=(0,v.a)((0,v.b)(B+k,N,1e5,Math.ceil),0,N),B<=0)break}}return!1})),f}hasHitScanBold(e,t,n,i,r,o,a){let s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1/0,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:new Array;const h=e=>d.includes(e),f=this.trees[e],[g,p,m]=this.getWorldSize(),_=(0,u.m)(g,p,m,0,0,0);let[y,b,w,E]=this.hitScanVoxelBoldFindMin(t,n,i,r,o,a,_);const x=Math.min(s,E,(0,u.m)(g,p,m,0,0,0)),[O,T,R]=(0,u.o)(t,n,0,0,x),S=Math.min((0,u.m)(O,T,R,0,0,0),this.getWorldDistance());if(-1!==y&&-1!==b&&-1!==w){const[e,t]=(0,u.k)(O,T,R,0,0,0),[n,s,d]=(0,u.o)(e,t,0,0,1),g=Math.min(S,a/2,.5);Math.max(...this.getWorldSize());let p=0,m=!1;for(;;){const e=i+p*n,t=r+p*s,_=o+p*d,y=(0,c.c)(e,t-a/2,_,a,a);for(let n=0,s=0|y.length;n<s;n=n+3|0){const s=y[n+0],c=y[n+1],d=y[n+2],g=f.getPointCell(s,c,d);for(let n=0,s=0|g.length;n<s;n=n+1|0){const s=g[n],c=this.getEntityOfID(s);if(null===c||!c.hasLive()||h(s)||c.getNames().some(h))continue;const[d,p,m,y,b]=f.getEntityProperty(c);if(-1===d&&-1===p&&-1===m)continue;let[w,E,O,T,R]=f.getOldEntityProperty(c);w=-1===w?d:w,E=-1===E?p:E,O=-1===O?m:O,T=T?y:T,R=R?b:R;const S=d-w,A=p-E,L=m-O,[M,P]=(0,u.k)(S,A,L,0,0,0),[I,F,C]=(0,u.o)(M,P,0,0,1),D=Math.min((0,u.m)(S,A,L,0,0,0),this.getWorldDistance()),N=Math.min(D,Math.max(Math.min(y,b),Math.min(T,R))/2,.5);let k=0;for(;;){const n=w+k*I,s=E+k*F,c=O+k*C,d=(0,v.b)((0,v.c)(k/D),0),h=T+(y-T)*d,f=R+(b-R)*d;if((0,l.c)(e,t-a/2,_,a,a,n,s,c,h,f)){if((0,u.m)(e,t,_,i,r,o)<x)return!0}if(k>=D)break;if(k=(0,v.a)((0,v.b)(k+N,D,1e5,Math.ceil),0,D),k<=0)break}}}if(m||p>=S)break;p=(0,v.a)((0,v.b)(p+g,S,1e5,Math.ceil),0,S)}}return-1!==E&&E<=S}hasHitScanVoxelBold(e,t,n,i,r,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1/0;const[s,l,d]=this.getWorldSize(),h=Math.min(a,(0,u.m)(s,l,d,0,0,0)),[f,p,m]=(0,u.o)(e,t,0,0,h),[_,y]=(Math.max(...this.getWorldSize()),(0,u.k)(f,p,m,0,0,0)),[b,w,E]=(0,u.o)(_,y,0,0,1),x=Math.min(h,o/2,.5);let O=0;for(;;){const e=n+O*b,t=i+O*w,a=r+O*E,u=(0,c.c)(e,t-o/2,a,o,o);for(let e=0,t=0|u.length;e<t;e=e+3|0){const t=u[e+0],n=u[e+1],i=u[e+2];if(0>t||s<=t||0>n||l<=n||0>i||d<=i||!L(this.getVoxel(t,n,i),g.c))return!0}if(O>=h)break;if(O=(0,v.a)((0,v.b)(O+x,h,1e5,Math.ceil),0,h),O<=0)break}return!1}hasHitScanBoldActor(e,t,n,i,r,o,a,s){let d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[];const h=this.trees[e],f=e=>d.includes(e),[g,p,m]=this.getWorldSize(),_=Math.min(s,(0,u.m)(g,p,m,0,0,0)),[y,b,w]=(0,u.o)(t,n,0,0,_),[E,x]=(Math.max(...this.getWorldSize()),(0,u.k)(y,b,w,0,0,0)),[O,T,R]=(0,u.o)(E,x,0,0,1),S=Math.min(_,a/2,.5);let A=0;for(;;){const e=i+A*O,t=r+A*T,n=o+A*R,s=(0,c.c)(e,t-a/2,n,a,a);for(let i=0,r=0|s.length;i<r;i=i+3|0){const r=s[i+0],o=s[i+1],c=s[i+2],d=h.getPointCell(r,o,c);for(let i=0,r=0|d.length;i<r;i=i+1|0){const r=d[i],o=this.getEntityOfID(r);if(null===o||!o.hasLive()||f(r)||o.getNames().some(f))continue;const[s,c,g,p,m]=h.getEntityProperty(o);if(-1===s&&-1===c&&-1===g)continue;let[_,y,b,w,E]=h.getOldEntityProperty(o);_=-1===_?s:_,y=-1===y?c:y,b=-1===b?g:b,w=w?p:w,E=E?m:E;const x=s-_,O=c-y,T=g-b,[R,S]=(0,u.k)(x,O,T,0,0,0),[A,L,M]=(0,u.o)(R,S,0,0,1),P=Math.min((0,u.m)(x,O,T,0,0,0),this.getWorldDistance()),I=Math.min(P,Math.max(Math.min(p,m),Math.min(w,E))/2,.5);let F=0;for(;;){const i=_+F*A,r=y+F*L,o=b+F*M,s=(0,v.b)((0,v.c)(F/P),0),c=w+(p-w)*s,u=E+(m-E)*s;if((0,l.c)(e,t-a/2,n,a,a,i,r,o,c,u))return!0;if(F>=P)break;if(F=(0,v.a)((0,v.b)(F+I,P,1e5,Math.ceil),0,P),F<=0)break}}}if(A>=_)break;if(A=(0,v.a)((0,v.b)(A+S,_,1e5,Math.ceil),0,_),A<=0)break}return!1}expandPosition(){const[e,t,n]=this.getWorldSize(),i=this.getMargin();let r=0,o=0,s=0,l=e-1,c=t-1,u=n-1;const d=this.getMap();e:for(;r<e;){for(let e=0;e<n;e=e+1|0)for(let n=0;n<t;n=n+1|0){if(d.get(0,r,n,e)>0)break e}r+=1}e:for(;l>=0;){for(let e=0;e<n;e=e+1|0)for(let n=0;n<t;n=n+1|0){if(d.get(0,l,n,e)>0)break e}l+=-1}e:for(;o<t;){for(let t=0;t<e;t=t+1|0)for(let e=0;e<n;e=e+1|0){if(d.get(0,t,o,e)>0)break e}o+=1}e:for(;c>=0;){for(let t=0;t<e;t=t+1|0)for(let e=0;e<n;e=e+1|0){if(d.get(0,t,c,e)>0)break e}c+=-1}e:for(;s<n;){for(let n=0;n<e;n=n+1|0)for(let e=0;e<t;e=e+1|0){if(d.get(0,n,e,s)>0)break e}s+=1}e:for(;u>=0;){for(let n=0;n<e;n=n+1|0)for(let e=0;e<t;e=e+1|0){if(d.get(0,n,e,u)>0)break e}u+=-1}let h=0,f=0,g=0;this.offset.left=i,h+=Math.min(0,r-i),this.offset.right=l+i,h+=Math.max(0,l+i-(e-1)),this.offset.bottom=i,f+=Math.min(0,o-i),this.offset.top=c+i,f+=Math.max(0,c+i-(t-1)),this.offset.back=i,g+=Math.min(0,s-i),this.offset.front=u+i,g+=Math.max(0,u+i-(n-1)),this.map.expand(h,f,g);const p=this.getEntitys(),m=Math.abs(h<0?h:0),v=Math.abs(f<0?f:0),_=Math.abs(g<0?g:0);for(let e=0,t=0|p.length;e<t;e=e+1|0){const t=p[e];if(!(t instanceof a.a))continue;const{position:n}=t;n.x+=m,n.y+=v,n.z+=_}}reductionPosition(){const[e,t,n]=this.getWorldSize(),i=this.getMargin();let r=0,o=0,s=0,l=e-1,c=t-1,u=n-1;const d=this.getMap();e:for(;r<e;){for(let e=0;e<n;e=e+1|0)for(let n=0;n<t;n=n+1|0){if(d.get(0,r,n,e)>0)break e}r+=1}e:for(;l>=0;){for(let e=0;e<n;e=e+1|0)for(let n=0;n<t;n=n+1|0){if(d.get(0,l,n,e)>0)break e}l+=-1}e:for(;o<t;){for(let t=0;t<e;t=t+1|0)for(let e=0;e<n;e=e+1|0){if(d.get(0,t,o,e)>0)break e}o+=1}e:for(;c>=0;){for(let t=0;t<e;t=t+1|0)for(let e=0;e<n;e=e+1|0){if(d.get(0,t,c,e)>0)break e}c+=-1}e:for(;s<n;){for(let n=0;n<e;n=n+1|0)for(let e=0;e<t;e=e+1|0){if(d.get(0,n,e,s)>0)break e}s+=1}e:for(;u>=0;){for(let n=0;n<e;n=n+1|0)for(let e=0;e<t;e=e+1|0){if(d.get(0,n,e,u)>0)break e}u+=-1}let h=0,f=0,g=0;this.offset.left=i,h+=Math.min(0,i-r),this.offset.right=l+i,h+=Math.max(0,e-1-(l+i)),this.offset.bottom=i,f+=Math.min(0,i-o),this.offset.top=c+i,f+=Math.max(0,t-1-(c+i)),this.offset.back=i,g+=Math.min(0,i-s),this.offset.front=u+i,g+=Math.max(0,n-1-(u+i)),this.map.reduction(h,f,g);const p=this.getEntitys(),m=Math.abs(h<0?h:0),v=Math.abs(f<0?f:0),_=Math.abs(g<0?g:0);for(let e=0,t=0|p.length;e<t;e=e+1|0){const t=p[e];if(!(t instanceof a.a))continue;const{position:n}=t;n.x-=m,n.y-=v,n.z-=_}}findPath(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(e,t)=>{t.block=!0},o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e=>!0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e=>e.step,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:()=>!0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:()=>0;return this.finder.find(e,t,n,i,r,o,a,s,l)}createTransferVoxelData(e,t,n){return n=n||this.isForceUpdate,this.isForceUpdate=!1,this.transferDataBuilder.createData(e,this.renderEntitys,t,n)}onecsend(e){const[t,n,i]=this.getWorldSize();for(const e in this.trees){this.trees[e].update(t,n,i)}}onsyncentity(e){const{entitys:t}=e;for(let e=0,n=0|t.length;e<n;e=e+1|0){const n=t[e];n instanceof a.a&&(!this.renderEntitys.includes(n)||n.hasComponent(b.a)&&n.hasComponent(w.a)?n.hasComponent(b.a)&&n.hasComponent(w.a)&&!this.renderEntitys.includes(n)&&this.renderEntitys.push(n):this.renderEntitys.splice(this.renderEntitys.indexOf(n),1))}}onremoveentity(e){const{entitys:t}=e;for(let e=0,n=0|t.length;e<n;e=e+1|0){const n=t[e];for(const e in this.trees){this.trees[e].remove(n)}}for(let e=0,n=0|t.length;e<n;e=e+1|0){const n=t[e];n instanceof a.a&&(this.renderEntitys.includes(n)&&this.renderEntitys.splice(this.renderEntitys.indexOf(n),1))}}onupdatebegin(e){this.starttime=performance.now(),super.onupdatebegin(e),this.finder.begin()}onupdate(e){super.onupdate(e);const{time:t,framerate:n}=e;this.lateTime+=t,this.finder.update(t*(1e3/60),this.starttime,n,this.maxFramerate)}}i()}catch(P){i(P)}}))},(e,t,n)=>{"use strict";n.d(t,{a:()=>h});n(1),n(2),n(20),n(21),n(203);var i=n(65),r=n(53);function o(e,t,n,i,o,a,s){let[l,c,u]=s;const d=0|t,h=0|n,f=0|i;if(null===e||d<0||d>=l||h<0||h>=c||f<0||f>=u)return-1;return e[(0,r.g)(a,o,d,h,f,l,c,u)]}var a=n(267);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class l{constructor(e,t,n){s(this,"voxel_field",void 0),s(this,"distance_field",void 0),s(this,"morton_field",void 0),s(this,"fill_field",void 0),this.voxel_field=e,this.distance_field=t,this.morton_field=n,this.fill_field=(0,i.a)("int32",this.distance_field.length),this.fill_field.fill(1)}clearData(){this.distance_field.fill(-1),this.morton_field.fill(-1),this.fill_field.fill(0)}getReferenceMorton(e,t,n,i,o){const[a,s,l]=e,c=(0,r.g)(t,0,n,i,o,a,s,l);return this.morton_field[c]}findDistanceFind(e,t,n,i,s,l,c){const[u,d,h]=e,f=new Array,g={};let p=1/0,m=!1;const v=(i,s,l,v)=>{const _=(0,r.g)(t,0,s,l,v,u,d,h);if(s<0||l<0||v<0||s>u-1||l>d-1||v>h-1)return p=Math.min(p,i-1),m=!0,void(c&&(this.morton_field[_]=-1));const y=(0,a.e)(s,l,v);return g[y]?(p=Math.min(p,i-1),m=!0,void(c&&(this.morton_field[_]=this.getReferenceMorton(e,t,s,l,v)))):(g[y]=!0,o(this.voxel_field,s,l,v,0,t,e)!==n?(p=Math.min(p,i-1),m=!0,void(c&&(this.morton_field[_]=(0,a.e)(s,l,v)))):void f.push({count:i,x:s,y:l,z:v}))};v(1,i,s,l);e:for(;f.length>0;){const e=f.shift()||null;if(null===e)break;const{count:t,x:n,y:i,z:o}=e;for(let e=0,a=0|r.i.length;e<a;e=e+1|0){const[a,s,l]=r.i[e];if(v(t+1,n+a,i+s,o+l),m)break e}}return p===1/0?1:p}getDistanceFind(e,t,n,i,o,s,l,c,u,d,h,f,g,p){if(c<0||u<0||d<0||c>h-1||u>f-1||d>g-1)return-1;const m=p?-1:(0,a.e)(o,s,l);for(var v=arguments.length,_=new Array(v>14?v-14:0),y=14;y<v;y++)_[y-14]=arguments[y];if(-1!==m&&_.includes(m))return-1;const b=(0,r.g)(t,0,c,u,d,h,f,g),w=this.distance_field[b],E=0===this.fill_field[b],x=p?this.findDistanceFind(e,t,n,c,u,d,p):i;return E?(this.distance_field[b]=x,this.fill_field[b]=1):this.distance_field[b]=p?Math.max(0,Math.max(this.distance_field[b],x)):Math.max(0,Math.min(this.distance_field[b],x)),E&&(this.morton_field[b]=p?this.morton_field[b]:m),w===this.distance_field[b]?E?x:-1:x}buildPointFind(e,t,n,i,s,l){for(var c=arguments.length,u=new Array(c>6?c-6:0),d=6;d<c;d++)u[d-6]=arguments[d];const[h,f,g]=e,p=new Array,m={},v=o(this.voxel_field,i,s,l,0,n,e)===t,_=this.getDistanceFind(e,n,t,0,i,s,l,i,s,l,h,f,g,v,...u);if(-1===_)return;const y=(r,c,d,_)=>{if(c<0||d<0||_<0||c>h-1||d>f-1||_>g-1)return;const y=(0,a.e)(c,d,_);if(!m[y]&&(m[y]=!0,o(this.voxel_field,c,d,_,0,n,e)===t)){const o=this.getDistanceAll(e,n,t,r,i,s,l,c,d,_,h,f,g,v,...u);-1!==o&&p.push({count:o,x:c,y:d,z:_})}};if(v)y(_,i,s,l);else{const e=(0,a.e)(i,s,l);p.push({count:_,x:i,y:s,z:l}),m[e]=!0}for(;p.length>0;){const e=p.shift()||null;if(null===e)break;const{count:t,x:n,y:i,z:o}=e;for(let e=0,a=0|r.i.length;e<a;e=e+1|0){const[a,s,l]=r.i[e];y(t+1,n+a,i+s,o+l)}}}findDistanceAll(e,t,n,i,s,l){const[c,u,d]=e,h=new Array,f={};let g=1/0,p=!1;const m=(i,s,l,m)=>{if(s<0||l<0||m<0||s>c-1||l>u-1||m>d-1)return g=Math.min(g,i-1),void(p=!0);const v=(0,r.g)(t,0,s,l,m,c,u,d),_=this.distance_field[v];if(-1!==_)return g=Math.min(g,_),void(p=!0);const y=(0,a.e)(s,l,m);return f[y]?(g=Math.min(g,i-1),void(p=!0)):(f[y]=!0,o(this.voxel_field,s,l,m,0,t,e)!==n?(g=Math.min(g,i-1),void(p=!0)):void h.push({count:i,x:s,y:l,z:m}))};m(1,i,s,l);e:for(;h.length>0;){const e=h.shift()||null;if(null===e)break;const{count:t,x:n,y:i,z:o}=e;for(let e=0,a=0|r.i.length;e<a;e=e+1|0){const[a,s,l]=r.i[e];if(m(t+1,n+a,i+s,o+l),p)break e}}return g===1/0?1:g}getDistanceAll(e,t,n,i,o,s,l,c,u,d,h,f,g){let p=arguments.length>13&&void 0!==arguments[13]&&arguments[13];if(c<0||u<0||d<0||c>h-1||u>f-1||d>g-1)return-1;const m=(0,a.e)(o,s,l);for(var v=arguments.length,_=new Array(v>14?v-14:0),y=14;y<v;y++)_[y-14]=arguments[y];if(_.includes(m))return-1;const b=(0,r.g)(t,0,c,u,d,h,f,g),w=this.distance_field[b],E=0===this.fill_field[b],x=p?this.findDistanceAll(e,t,n,c,u,d):i;return E?(this.distance_field[b]=x,this.fill_field[b]=1):this.distance_field[b]=p?Math.max(0,Math.max(this.distance_field[b],x)):Math.max(0,Math.min(this.distance_field[b],x)),w===this.distance_field[b]?E?x:-1:(this.morton_field[b]=m,x)}buildPointAll(e,t,n,i,s,l){for(var c=arguments.length,u=new Array(c>6?c-6:0),d=6;d<c;d++)u[d-6]=arguments[d];const[h,f,g]=e,p=new Array,m={},v=(0,a.e)(i,s,l),_=o(this.voxel_field,i,s,l,0,n,e)===t,y=this.getDistanceAll(e,n,t,0,i,s,l,i,s,l,h,f,g,_,...u);if(-1===y)return;const b=(r,c,d,v)=>{if(c<0||d<0||v<0||c>h-1||d>f-1||v>g-1)return;const y=(0,a.e)(c,d,v);if(!m[y]&&(m[y]=!0,o(this.voxel_field,c,d,v,0,n,e)===t)){const o=this.getDistanceAll(e,n,t,r,i,s,l,c,d,v,h,f,g,_,...u);-1!==o&&p.push({count:o,x:c,y:d,z:v})}};for(b(y,i,s,l),p.push({count:y,x:i,y:s,z:l}),m[v]=!0;p.length>0;){const e=p.shift()||null;if(null===e)break;const{count:t,x:n,y:i,z:o}=e;for(let e=0,a=0|r.i.length;e<a;e=e+1|0){const[a,s,l]=r.i[e];b(t+1,n+a,i+s,o+l)}}}buildPoint(e,t,n,i,r,o,a){for(var s=arguments.length,l=new Array(s>7?s-7:0),c=7;c<s;c++)l[c-7]=arguments[c];return a?this.buildPointAll(e,t,n,i,r,o,...l):this.buildPointFind(e,t,n,i,r,o,...l)}find(e,t,n,i,r,a){const[s,l,c]=e;for(var u=arguments.length,d=new Array(u>6?u-6:0),h=6;h<u;h++)d[h-6]=arguments[h];o(this.voxel_field,i,r,a,0,n,e)===t&&d.includes(this.getReferenceMorton(e,n,i,r,a))&&this.getDistanceFind(e,n,t,0,i,r,a,i,r,a,s,l,c,!0,...d)}buildFind(e,t,n,i){for(var r=arguments.length,o=new Array(r>4?r-4:0),s=4;s<r;s++)o[s-4]=arguments[s];for(let r=0,s=0|i.length;r<s;r=r+1|0){const s=i[r],[l,c,u]=(0,a.b)(s);this.find(e,t,n,l,c,u,...o)}}buildAll(e,t,n,i){this.clearData();for(let r=0,o=0|i.length;r<o;r=r+1|0){const o=i[r],[s,l,c]=(0,a.b)(o);this.buildPointAll(e,t,n,s,l,c)}}}var c=n(6),u=n(35);function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class h{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"uint8",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1;d(this,"voxel_inserts",{}),d(this,"distance_inserts",{}),d(this,"morton_inserts",{}),d(this,"find_distance_fields",new Array),d(this,"build_distance_field",new Array),d(this,"buffer",null),d(this,"is_update",!0),d(this,"is_reflesh_distance_field",!1),d(this,"voxel_field",null),d(this,"distance_field",null),d(this,"morton_field",null),d(this,"distance_field_builder",null),d(this,"width",void 0),d(this,"height",void 0),d(this,"depth",void 0),d(this,"distance",void 0),d(this,"data_type",void 0),d(this,"length",void 0),d(this,"fill",void 0),this.width=0|e,this.height=0|t,this.depth=0|n,this.distance=(0,c.m)(0,0,0,e,t,n),this.data_type=i,this.length=r,this.fill=o,this.setSize(e,t,n)}clear(){this.setSize(1,1,1)}setSize(e,t,n){if(e===this.width&&t===this.height&&n===this.depth&&null!==this.buffer)return;const r=(0,i.a)(this.data_type,e*t*n*this.getLength()),o=(0,i.a)("int32",e*t*n),s=(0,i.a)("int32",e*t*n);this.distance_field_builder=new l(r,o,s),this.buffer=r.buffer,this.width=0|e,this.height=0|t,this.depth=0|n,this.distance=(0,c.m)(0,0,0,e,t,n),this.voxel_field=r,this.distance_field=o,this.morton_field=s,r.fill(this.getFill()),o.fill(1),s.fill(-1);for(const e in this.voxel_inserts)delete this.voxel_inserts[e];for(const e in this.distance_inserts)delete this.distance_inserts[e];for(const e in this.morton_inserts)delete this.morton_inserts[e];let u=0;const d=new Array;for(let i=0;i<e;i=i+1|0)for(let e=0;e<t;e=e+1|0)for(let t=0;t<n;t=t+1|0)u++,d.push((0,a.e)(i,e,t));this.voxel_inserts[0]={count:u,mortons:d},this.is_update=!0}initData(e,t,n,i,o,a){const[s,l,c]=this.getSize(),u=this.getLength(),d=this.getVoxelField(),h=this.getDistanceField(),f=this.getMortonField();if(null!==d&&null!==h&&null!==f){for(const e in this.voxel_inserts)delete this.voxel_inserts[e];for(const e in this.distance_inserts)delete this.distance_inserts[e];for(const e in this.morton_inserts)delete this.morton_inserts[e];for(const e in i)this.voxel_inserts[e]=i[e];for(const e in o)this.distance_inserts[e]=o[e];for(const e in a)this.morton_inserts[e]=a[e];for(let i=0,o=0|s;i<o;i=i+1|0)for(let o=0,a=0|l;o<a;o=o+1|0)for(let a=0,g=0|c;a<g;a=a+1|0){const g=(0,r.g)(u,0,i,o,a,s,l,c),p=(0,r.g)(1,0,i,o,a,s,l,c);d[g]=e[i][o][a],h[p]=t[i][o][a],f[p]=n[i][o][a]}}}getWorldDistance(){return this.distance}getSize(){const{width:e,height:t,depth:n}=this;return[e,t,n]}getFill(){return this.fill}getLength(){return this.length}getBuffer(){return this.buffer}getVoxelField(){return this.voxel_field}getDistanceField(){return this.distance_field}getMortonField(){return this.morton_field}getVoxelInsertDatas(){return this.voxel_inserts}getDistanceInsertDatas(){return this.distance_inserts}getMortonInsertDatas(){return this.morton_inserts}set(e,t,n,s,l){let c=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this.getVoxelField(),d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:this.getSize();if(null===u)return;const h=0|t,f=0|n,g=0|s,[p,m,v]=d;if(h<0||h>=p||f<0||f>=m||g<0||g>=v)return;const _=u===this.getVoxelField()?this.getLength():1,y=(0,r.g)(_,e,h,f,g,p,m,v),b=u[y];if(b===(0,i.b)(this.data_type,l))return;u[y]=l;let w=null,E=!1;switch(u){case this.getVoxelField():this.is_update=!0,w=this.voxel_inserts,E=!0;break;case this.getDistanceField():this.is_update=!0,w=this.distance_inserts;break;case this.getMortonField():w=this.morton_inserts}if(null!==w){const e=(0,a.e)(t,n,s);if(w[b]){const t=w[b];t.count--,t.mortons.splice(t.mortons.indexOf(e),1),t.count<=0&&delete w[b]}w[l]||(w[l]={count:0,mortons:new Array});const i=w[l];i.count++,i.mortons.push(e)}if(E&&c&&(this.build_distance_field.some((e=>{let[t,n,i]=e;return t===h&&n===f&&i===g}))||this.build_distance_field.push([h,f,g]),null!==this.voxel_field))if(l!==this.getFill())for(let t=0,n=0|r.i.length;t<n;t=t+1|0){const[n,i,s]=r.i[t],l=h+n,c=f+i,u=g+s,p=o(this.voxel_field,l,c,u,e,_,d);if(-1===p||p===this.getFill())continue;const m=(0,a.e)(l,c,u);this.find_distance_fields.includes(m)||this.find_distance_fields.push(m)}else{const e=(0,a.e)(h,f,g);this.find_distance_fields.includes(e)||this.find_distance_fields.push(e)}}get(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.getVoxelField(),a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.getSize();return null===r?-1:o(r,t,n,i,e,r===this.getVoxelField()?this.getLength():1,a)}getVoxelInsertData(e){return this.voxel_inserts.hasOwnProperty(e)?this.voxel_inserts[e]:null}getDistanceInsertData(e){return this.distance_inserts.hasOwnProperty(e)?this.distance_inserts[e]:null}getMortonInsertData(e){return this.morton_inserts.hasOwnProperty(e)?this.morton_inserts[e]:null}expand(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===e&&0===t&&0===n)return;const[i,r,o]=this.getSize(),s=this.getVoxelField(),l=this.getDistanceField(),c=this.getMortonField();this.setSize(i+Math.abs(e),r+Math.abs(t),o+Math.abs(n));const u=Math.abs(e<0?-e:0),d=Math.abs(t<0?-t:0),h=Math.abs(n<0?-n:0);for(let e=i-1|0;e>=0;e=e-1|0)for(let t=r-1|0;t>=0;t=t-1|0)for(let n=o-1|0;n>=0;n=n-1|0){const f=e+u,g=t+d,p=n+h;let m=this.get(0,e,t,n,l,[i,r,o]);m=-1===m?0:m,1!==m&&this.set(0,f,g,p,m,!1,this.getDistanceField());const v=this.getMortonField();let _=this.get(0,e,t,n,c,[i,r,o]);const[y,b,w]=(0,a.b)(_);_=-1===_?-1:(0,a.e)(y-u,b-d,w-h),-1!==_&&this.set(0,f,g,p,_,!1,v);for(let a=0,l=0|this.getLength();a<l;a=a+1|0){let l=this.get(a,e,t,n,s,[i,r,o]);l=-1===l?this.getFill():l,l!==this.getFill()&&this.set(a,f,g,p,l,!1,this.getVoxelField())}}}reduction(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===e&&0===t&&0===n)return;const[i,r,o]=this.getSize(),s=this.getVoxelField(),l=this.getDistanceField(),c=this.getMortonField();this.setSize(i-Math.abs(e),r-Math.abs(t),o-Math.abs(n));const u=Math.abs(e<0?-e:0),d=Math.abs(t<0?-t:0),h=Math.abs(n<0?-n:0);for(let e=i-1|0;e>=0;e=e-1|0)for(let t=r-1|0;t>=0;t=t-1|0)for(let n=o-1|0;n>=0;n=n-1|0){const f=e-u,g=t-d,p=n-h;let m=this.get(0,e,t,n,l,[i,r,o]);m=-1===m?0:m,1!==m&&this.set(0,f,g,p,m,!1,this.getDistanceField());const v=this.getMortonField();let _=this.get(0,e,t,n,c,[i,r,o]);const[y,b,w]=(0,a.b)(_);_=-1===_?-1:(0,a.e)(y+u,b+d,w+p),-1!==_&&this.set(0,f,g,p,_,!1,v);for(let a=0,l=0|this.getLength();a<l;a=a+1|0){let l=this.get(a,e,t,n,s,[i,r,o]);l=-1===l?this.getFill():l,l!==this.getFill()&&this.set(a,f,g,p,l,!1,this.getVoxelField())}}}requestRefleshDistanceField(){this.is_reflesh_distance_field=!0}cancelRefleshDistanceField(){this.is_reflesh_distance_field=!1}hasUpdate(){return this.is_update}checkUpdate(){let e=this.is_update;if(this.is_reflesh_distance_field){var t;const i=new Array,r=Object.keys(this.voxel_inserts);for(let e=0,t=0|r.length;e<t;e=e+1|0){const t=parseInt(r[e]);var n;if(!isNaN(t)&&t>0)i.push(...(null===(n=this.getVoxelInsertData(t))||void 0===n?void 0:n.mortons)||[])}null===(t=this.distance_field_builder)||void 0===t||t.buildAll(this.getSize(),this.getFill(),this.getLength(),i),(0,u.a)(this.build_distance_field),this.is_reflesh_distance_field=!1,e=!0}else for(;this.build_distance_field.length>0;){const t=this.build_distance_field.shift()||null;if(null!==t){var i;const[e,n,r]=t;null===(i=this.distance_field_builder)||void 0===i||i.buildPoint(this.getSize(),this.getFill(),this.getLength(),e,n,r,!1)}e=!0}var r,o;this.find_distance_fields.length>0&&(null===(r=this.distance_field_builder)||void 0===r||r.buildFind(this.getSize(),this.getFill(),this.getLength(),(null===(o=this.getVoxelInsertData(this.getFill()))||void 0===o?void 0:o.mortons)||[],...this.find_distance_fields),(0,u.a)(this.find_distance_fields),e=!0);return this.is_update=!1,e}}},(e,t,n)=>{"use strict";n.d(t,{a:()=>c});n(1),n(2),n(20),n(21),n(33);var i=n(53),r=n(267),o=n(6),a=n(35),s=n(85);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class c{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>[-1,-1,-1,-1,-1];l(this,"hasAdd",void 0),l(this,"paramGetter",void 0),l(this,"size",new o.c(1,1,1)),l(this,"data",{}),l(this,"entitys",new Array),l(this,"stands",new Array),l(this,"points",new Array),l(this,"oldPropertys",new WeakMap),l(this,"oldPoints",new WeakMap),this.hasAdd=e,this.paramGetter=t}hasOverPosition(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const[o,a,s]=this.getSize();return e+i/2<0||t+r<0||n+i/2<0||e-i/2>=o||t>=a||n-i/2>=s}getDimension(){const[,e,t]=this.getSize();switch(!0){case!(1^e):return 1;case!(1^t):return 2}return 3}calcMortonNumber(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!this.hasOverPosition(e,t,n))switch(this.getDimension()){case 1:return(0,r.c)(e);case 2:return(0,r.d)(e,n);case 3:return(0,r.e)(e,t,n)}return-1}setSize(e,t,n){this.size.x=e,this.size.y=t,this.size.z=n}getSize(){return[this.size.x,this.size.y,this.size.z]}getEntityProperty(e){return this.paramGetter(e)}getOldEntityProperty(e){const t=this.oldPropertys.get(e);return t?[t.x,t.y,t.z,t.rx,t.ry]:[-1,-1,-1,-1,-1]}add(e){this.hasAdd(e)&&!this.stands.includes(e)&&!this.entitys.includes(e)&&this.stands.push(e)}remove(e){if(this.entitys.includes(e)){this.entitys.splice(this.entitys.indexOf(e),1);const t=this.oldPoints.get(e)||null;null!==t&&this.appendCells(e,new Array,t),this.oldPropertys.delete(e),this.oldPoints.delete(e)}this.stands.includes(e)&&this.stands.splice(this.stands.indexOf(e),1)}hasEntity(e){return this.hasAdd(e)}clear(){this.size.x=0,this.size.y=0,this.size.z=0;for(const e in this.data)delete this.data[e];this.entitys.forEach((e=>{this.oldPropertys.delete(e),this.oldPoints.delete(e)})),(0,a.a)(this.points),(0,a.a)(this.entitys),(0,a.a)(this.stands)}getCell(e){return this.data[e]||new Array}getPointCell(e,t,n){const i=this.calcMortonNumber(e,t,n);return this.getCell(i)}getAppendPoints(){return this.points}setOldPosition(e){const t=this.oldPropertys.get(e)||null;if(null!==t){const[n,i,r,o,a]=this.getEntityProperty(e),s=Math.floor(n-o/2),l=Math.floor(i),c=Math.floor(r-o/2),u=Math.ceil(n+o/2),d=Math.ceil(i+a),h=Math.ceil(r+o/2);t.sx=s,t.sy=l,t.sz=c,t.ex=u,t.ey=d,t.ez=h,t.x=n,t.y=i,t.z=r,t.rx=o,t.ry=a}}initOldPosition(e){const t={x:-1,y:-1,z:-1,rx:-1,ry:-1,sx:-1,sy:-1,sz:-1,ex:-1,ey:-1,ez:-1};return this.oldPropertys.set(e,t),t}appendCells(e,t,n){const i=e.getID();for(let e=0,r=0|n.length;e<r;e=e+1|0){const r=n[e];if(t.includes(r))continue;const o=this.data[r]||null;null!==o&&(o.splice(o.indexOf(i),1),o.length<=0&&delete this.data[r])}for(let e=0,n=0|t.length;e<n;e=e+1|0){const n=t[e],r=this.data[n]||null;null===r?this.data[n]=[i]:r.includes(i)||(r.push(i),this.points.includes(n)||this.points.push(n))}}update(e,t,n){for(this.setSize(e,t,n);this.stands.length>0;){const e=this.stands.shift()||null;null!==e&&this.entitys.push(e)}for(let r=0,a=0|this.entitys.length;r<a;r=r+1|0){const a=this.entitys[r],[l,c,u,d,h]=this.getEntityProperty(a);let f=this.oldPropertys.get(a)||null;if(null===f&&(f=this.initOldPosition(a)),-1!==l&&-1!==c&&-1!==u&&!this.hasOverPosition(l,c,u,d,h)){let r=this.oldPoints.get(a)||null;null===r&&(r=new Array);const g=Math.floor(l-d/2),p=Math.floor(c),m=Math.floor(u-d/2),v=Math.floor(l+d/2),_=Math.floor(c+h),y=Math.floor(u+d/2);if(f.sx!==g||f.sy!==p||f.sz!==m||f.ex!==v||f.ey!==_||f.ez!==y){const b=-1===f.x?l:f.x,w=-1===f.y?c:f.y,E=-1===f.z?u:f.z,x=f.rx?d:f.rx,O=f.ry?h:f.ry,T=l-b,R=c-w,S=u-E,A=(0,o.m)(0,0,0,e,t,n),L=Math.min((0,o.m)(T,R,S,0,0,0),A),[M,P]=(0,o.k)(T,R,S,0,0,0),I=Math.min(L,Math.max(Math.min(d,h),Math.min(x,O))/2,.5),[F,C,D]=(0,o.o)(M,P,0,0,1),N=this.getDimension();let k=0;const B=new Array;for(;;){const n=b+k*F,r=w+k*C,o=E+k*D;let a=new Array;switch(N){case 1:a=(0,i.a)(n,d,e);break;case 2:a=(0,i.b)(n,o,d,Math.max(e,t));break;case 3:a=(0,i.c)(n,r,o,d,h)}for(let e=0,t=0|a.length;e<t;e=e+N|0){const t=a[e],n=a[e+1],i=a[e+2];let r=-1;switch(N){case 1:r=this.calcMortonNumber(t,0,0);break;case 2:r=this.calcMortonNumber(t,0,n);break;case 3:r=this.calcMortonNumber(t,n,i)}-1===r||B.includes(r)||B.push(r)}if(k>=L)break;if(k=(0,s.a)((0,s.b)(k+I,L,1e5,Math.ceil),0,L),k<=0)break}0===I&&(f.sx=g,f.sy=p,f.sz=m,f.ex=v,f.ey=_,f.ez=y),this.oldPoints.set(a,B),this.appendCells(a,B,r)}}f.x=l,f.y=c,f.z=u,f.rx=d,f.ry=h}}}},(e,t,n)=>{"use strict";n.d(t,{a:()=>a});n(1),n(2);var i=n(6),r=n(212);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class a extends r.a{constructor(){super(...arguments),o(this,"position",new i.c(0,0,0)),o(this,"direction",new i.c(0,0,0))}}},(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var i=n(6);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class o{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];r(this,"size",void 0),r(this,"treeFix",void 0),this.size=new i.b(e,t),this.treeFix=n}}},(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var i=n(6);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class o{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Array,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];r(this,"init",!1),r(this,"enable",!0),r(this,"isPush",!0),r(this,"old",new i.c(-1,-1,-1)),r(this,"targets",new Array),r(this,"size",void 0),r(this,"filter",void 0),r(this,"treeFix",void 0),this.size=new i.b(e,t),this.filter=n,this.treeFix=o}}},(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var i=n(6);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class o{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];r(this,"size",void 0),r(this,"treeFix",void 0),this.size=new i.b(e,t),this.treeFix=n}}},(e,t,n)=>{"use strict";n.d(t,{a:()=>d});n(1),n(2),n(14),n(261);var i=n(35),r=n(53),o=n(6),a=n(267),s=n(82);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const c=()=>0;class u{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;l(this,"x",void 0),l(this,"y",void 0),l(this,"z",void 0),l(this,"stepX",void 0),l(this,"stepY",void 0),l(this,"stepZ",void 0),l(this,"step",void 0),l(this,"prev",void 0),l(this,"cost",0),this.x=e,this.y=t,this.z=n,this.stepX=i,this.stepY=r,this.stepZ=o,this.step=null===a?0:a.step+1,this.prev=a}getCost(e,t,n){return(0,o.m)(e,t,n,this.x,this.y,this.z)+this.step}}class d{constructor(){l(this,"stacks",new Array),l(this,"queue",new Array),l(this,"sorts",new WeakMap),l(this,"block",{block:!1})}find(e,t,n,o){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e=>({block:!1}),d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e=>!0,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e=>e.step,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:()=>!0,g=arguments.length>8&&void 0!==arguments[8]?arguments[8]:c;const p=[];return new Promise(((c,m)=>{if(!e.hasFinish())return;const v=(0,s.a)(3===e.dimension?r.i:r.h),{block:_}=this;let y=0;e.begin(.5+(0|t),.5+(0|n),.5+(0|o)),(0,i.b)(v);const b=this;this.queue.push(function*(){do{yield g;const t=e.searchPoint.shift()||null;if(null===t||!f())break;if(d(t)){e.close(t),c(null);break}for(let n=0|v.length;y<n;y=y+1|0){const[n,i,r]=v[y],o=n+(0|t.x)|0,s=i+(0|t.y)|0,c=r+(0|t.z)|0;let d=b.stacks.shift()||null;null===d?d=new u(o+.5,s+.5,c+.5,n,i,r,t):(d.x=o+.5,d.y=s+.5,d.z=c+.5,d.stepX=n,d.stepY=i,d.stepZ=r,d.prev=t,d.cost=0),_.block=!1,delete _.label,l(d,_);let f=(0,a.e)(o,s,c);const g=_.label||null;if(null!==g&&(f="".concat(f,"-").concat(g)),!e.hasSearch[f]&&(e.hasSearch[f]=!0,!_.block)){d.cost=h(d);let t=!1;for(let n=0,i=0|e.searchPoint.length;n<i;n=n+1|0){if(e.searchPoint[n].cost>d.cost){e.searchPoint.splice(n,0,d),t=!0;break}}t||e.searchPoint.push(d)}}y=0,p.push(t)}while(e.searchPoint.length>0);return e.close(null),m(),!0}())})).finally((()=>{this.stacks.push(...p)}))}begin(){(0,i.c)(this.queue).asc((e=>(this.sorts.get(e)||c)()))}update(e,t,n,i){if(this.queue.length<=0)return;const r=Math.min(e,n===1/0?1e3/i:1e3/n);do{const e=this.queue.shift()||null;if(null===e)break;{const t=e.next();t.done||(this.sorts.set(e,t.value),this.queue.push(e))}}while(performance.now()-t<r&&this.queue.length>0)}}},(e,t,n)=>{"use strict";var i=n(9),r=n(22),o=n(45),a=n(4),s=n(27),l=n(5),c=n(76),u=n(133),d=n(18),h=o&&o.prototype;if(i({target:"Promise",proto:!0,real:!0,forced:!!o&&a((function(){h.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=c(this,s("Promise")),n=l(e);return this.then(n?function(n){return u(t,e()).then((function(){return n}))}:e,n?function(n){return u(t,e()).then((function(){throw n}))}:e)}}),!r&&l(o)){var f=s("Promise").prototype.finally;h.finally!==f&&d(h,"finally",f,{unsafe:!0})}},(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var i=n(6);class r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;var r,o,a;a=void 0,(o="position")in(r=this)?Object.defineProperty(r,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[o]=a,this.position=new i.c(e,t,n)}}},(e,t,n)=>{"use strict";n.d(t,{a:()=>l});var i=n(212),r=n(13),o=n(62);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class s extends i.b{constructor(e,t,n,i,r,o){super(!1),a(this,"name",void 0),a(this,"scenes",void 0),a(this,"renderers",void 0),a(this,"assets",void 0),a(this,"controls",void 0),a(this,"sounds",void 0),this.name=e,this.scenes=t,this.renderers=n,this.assets=i,this.controls=r,this.sounds=o}getName(){return this.name}getRendererManager(){return this.renderers}getAssetManager(){return this.assets}getControlManager(){return this.controls}getSoundManager(){return this.sounds}createSound(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.sounds.create(e,t,null===n?(0,o.a)():n)}getSound(e){return this.sounds.getSound(e)}hasSound(e){return this.sounds.hasSound(e)}getSceneManager(){return this.scenes}clear(){const e=this.getSoundManager(),t=this.getControlManager();e.clear(),t.clear(),super.clear()}destroy(){const e=this.getSceneManager(),t=this.getControlManager(),n=this.getAssetManager(),i=this.getSoundManager(),o=this.getRendererManager();e.destroy(),t.destroy(),n.destroy(),i.destroy(),o.destroy(),new r.a(this,"destroy").trigger()}oninactive(){this.getControlManager().clear()}onupdatebegin(e){const{time:t,now:n,framerate:i,fps:o,updateCount:a}=e;new r.a(this.getControlManager(),"update").trigger({time:t,now:n,framerate:i,fps:o,updateCount:a})}onupdateend(e){const{time:t,now:n,framerate:i,fps:o,updateCount:a}=e;new r.a(this.getSceneManager(),"update").trigger({time:t,now:n,framerate:i,fps:o,updateCount:a}),new r.a(this.getRendererManager(),"update").trigger({time:t,now:n,framerate:i,fps:o,updateCount:a}),new r.a(this.getSoundManager(),"update").trigger({time:t,now:n,framerate:i,fps:o,updateCount:a}),new r.a(this.getAssetManager(),"update").trigger({time:t,now:n,framerate:i,fps:o,updateCount:a})}}class l extends s{constructor(e,t,n,i,r,o){super(e,t,n,i,r,o)}createTransferUIData(e){return[]}}},(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var i=n(6);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class o{constructor(e,t){r(this,"init",!1),r(this,"enable",!0),r(this,"hit",{x:0,y:0,z:0,angle:{x:0,y:0}}),r(this,"old",new i.c(-1,-1,-1)),r(this,"size",void 0),this.size=new i.b(e,t)}}},(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var i=n(6);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class o{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;r(this,"value",new i.c(0,0,0)),r(this,"drift",void 0),r(this,"airDrift",void 0),r(this,"forceAir",!1),this.drift=new i.c(e,t,n),this.airDrift=o}}},(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var i=n(6);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class o{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;r(this,"move",new i.c(0,0,0)),r(this,"look",new i.b(0,0)),r(this,"force",1),r(this,"limit",!0),r(this,"speed",void 0),this.speed=e}}},(e,t,n)=>{"use strict";function i(e){let t=e;return t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),t}function r(e){let t=e;return t&=1023,t=4278190335&(t^t<<16),t=50393103&(t^t<<8),t=51130563&(t^t<<4),t=153391689&(t^t<<2),t}function o(e){let t=e;return t&=1431655765,t=858993459&(t|t>>1),t=252645135&(t|t>>2),t=16711935&(t|t>>4),t=65535&(t|t>>8),t}function a(e){let t=e;return t&=153391689,t=51130563&(t^t>>2),t=50393103&(t^t>>4),t=4278190335&(t^t>>8),t=1023&(t^t>>16),t}function s(e){return e}function l(e,t){return i(0|e)|i(0|t)<<1}function c(e,t,n){return r(0|e)|r(0|t)<<1|r(0|n)<<2}function u(e){return[o(e>>0),o(e>>1)]}function d(e){return[a(e>>0),a(e>>1),a(e>>2)]}n.d(t,{a:()=>u,b:()=>d,c:()=>s,d:()=>l,e:()=>c})},(e,t,n)=>{"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{a:()=>r});class r{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];i(this,"material",void 0),i(this,"scale",void 0),i(this,"rotate",void 0),i(this,"flip",void 0),this.material=e,this.scale=t,this.rotate=n,this.flip={x:r,y:o}}}},(e,t,n)=>{"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{a:()=>r});class r{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;i(this,"axes",void 0),i(this,"bottom",void 0),this.axes={x:e,y:t,z:n},this.bottom=r}}},(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i="#version 300 es\n#define EPSILON  0.00001\n#define FLT_MIN  1.175494351e-38\n#define FLT_MAX  3.402823466e38\n#define FADE_LENGTH  5.0\n#define MAX_LOOP  9999\n#define QUATER  0.7853981633974483\n#define HALF  1.5707963267948966\n#define PI  3.141592653589793\n#define CIRCLE  6.283185307179586\nprecision highp float;precision highp int;uniform vec2 viewport;uniform vec2 resolution;uniform vec3 direction;uniform float fov;uniform float zoom;layout(location=0)in vec2 pos;layout(location=1)in vec2 tex;out vec2 uv;out vec2 dirX;out vec2 dirY;out vec2 dirZ;out vec2 dirZI;out vec2 dirYY;out vec2 dir0X;out vec2 dir0Y;void main(){vec3 dir=vec3(direction.x<EPSILON&&direction.x>-EPSILON?EPSILON:direction.x,direction.y<EPSILON&&direction.y>-EPSILON?-EPSILON:direction.y,direction.z);uv=vec2(tex.x,1.-tex.y);dirX=vec2(cos(dir.x),sin(dir.x));dirY=vec2(cos(dir.y),sin(dir.y));dirZ=vec2(cos(dir.z),sin(dir.z));dirZI=vec2(cos(-dir.z),sin(-dir.z));dirYY=vec2(cos(dir.y-HALF),sin(dir.y-HALF));dir0X=vec2(cos(HALF),sin(HALF));dir0Y=vec2(cos(0.),sin(0.));gl_Position=vec4(pos,0.,1.);}"},(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i="#version 300 es\n#define EPSILON  0.00001\n#define FLT_MIN  1.175494351e-38\n#define FLT_MAX  3.402823466e38\n#define FADE_LENGTH  5.0\n#define MAX_LOOP  9999\n#define QUATER  0.7853981633974483\n#define HALF  1.5707963267948966\n#define PI  3.141592653589793\n#define CIRCLE  6.283185307179586\n#define sampler3D  sampler2DArray\n#define isampler3D  isampler2DArray\n#define usampler3D  usampler2DArray\n#define BILLBOARD_PROP_POSITION_X  0\n#define BILLBOARD_PROP_POSITION_Y  1\n#define BILLBOARD_PROP_POSITION_Z  2\n#define BILLBOARD_PROP_SCALE  3\n#define BILLBOARD_PROP_BOUNDING  4\n#define BILLBOARD_PROP_AXIS_X  5\n#define BILLBOARD_PROP_AXIS_Y  6\n#define BILLBOARD_PROP_AXIS_Z  7\n#define BILLBOARD_PROP_FIX_POSITION_X  5\n#define BILLBOARD_PROP_FIX_POSITION_Y  6\n#define BILLBOARD_PROP_FIX_POSITION_Z  7\n#define BILLBOARD_PROP_ROTATE  8\n#define BILLBOARD_PROP_FLIP_X  9\n#define BILLBOARD_PROP_FLIP_Y  10\n#define BILLBOARD_PROP_HUD_FIX  11\n#define BILLBOARD_PROP_HUD_ROTATE  12\n#define BILLBOARD_PROP_TILE  13\n#define BILLBOARD_PROP_LENGTH  14\n#define VOXEL_PROP_POSITION_X  0\n#define VOXEL_PROP_POSITION_Y  1\n#define VOXEL_PROP_POSITION_Z  2\n#define VOXEL_PROP_TEXTURE_FRONT  3\n#define VOXEL_PROP_TEXTURE_BACK  4\n#define VOXEL_PROP_TEXTURE_RIGHT  5\n#define VOXEL_PROP_TEXTURE_LEFT  6\n#define VOXEL_PROP_TEXTURE_TOP  7\n#define VOXEL_PROP_TEXTURE_BOTTOM  8\n#define VOXEL_PROP_TEXTURE_FLIP_X_FRONT  9\n#define VOXEL_PROP_TEXTURE_FLIP_Y_FRONT  10\n#define VOXEL_PROP_TEXTURE_FLIP_X_BACK  11\n#define VOXEL_PROP_TEXTURE_FLIP_Y_BACK  12\n#define VOXEL_PROP_TEXTURE_FLIP_X_RIGHT  13\n#define VOXEL_PROP_TEXTURE_FLIP_Y_RIGHT  14\n#define VOXEL_PROP_TEXTURE_FLIP_X_LEFT  15\n#define VOXEL_PROP_TEXTURE_FLIP_Y_LEFT  16\n#define VOXEL_PROP_TEXTURE_FLIP_X_TOP  17\n#define VOXEL_PROP_TEXTURE_FLIP_Y_TOP  18\n#define VOXEL_PROP_TEXTURE_FLIP_X_BOTTOM  19\n#define VOXEL_PROP_TEXTURE_FLIP_Y_BOTTOM  20\n#define VOXEL_PROP_LENGTH  21\n#define SURFACE_NONE  -1\n#define SURFACE_FRONT  0\n#define SURFACE_BACK  1\n#define SURFACE_RIGHT  2\n#define SURFACE_LEFT  3\n#define SURFACE_TOP  4\n#define SURFACE_BOTTOM  5\n#define DIMENSION_X  0\n#define DIMENSION_Y  1\n#define DIMENSION_Z  2\n#define OBJECT_NONE  0\n#define OBJECT_HIT_GROUND  1\n#define OBJECT_HIT_VOXEL  2\n#define OBJECT_HIT_BILLBOARD  3\n#define OBJECT_HIT_HUD  4\n#define WALL_NONE  0\n#define WALL_BLOCK  1\n#define WALL_WALLX  2\n#define WALL_WALLZ  3\n#define BACKGROUND_NOISE  0\n#define BACKGROUND_LIQUID  1\n#define VOXEL_EMPTY  0\n#define iSteps  3\n#define jSteps  1\n#define SHADOW  vec3(0.25)\n#define SLIGHT  vec3(1.0)\n#define NLIGHT  vec3(0.375, 0.375, 0.5)\n#define SKY_COLOR  vec3(0.000003, 0.0000075, 0.0000175)\n#define STARY_COLOR  vec3(0.000003, 0.0000075, 0.0000175)\nprecision highp int;precision highp float;precision highp sampler2D;precision highp isampler2D;precision highp usampler2D;precision highp sampler3D;precision highp isampler3D;precision highp usampler3D;uniform vec2 viewport;uniform vec2 resolution;uniform ivec3 map_size;uniform int MAX_2D_TEXTURE_SIZE;uniform int MAX_3D_TEXTURE_SIZE;uniform float max_draw_distance;uniform int tile_resolution;uniform ivec2 cluster_resolution;uniform isampler3D map_data;uniform isampler3D distance_field;uniform sampler2D texture_albedo_data;uniform sampler2D texture_pbr_data;uniform sampler2D texture_normal_data;uniform isampler3D material_data;uniform sampler3D voxel_data;uniform sampler3D billboard_data;uniform isampler3D cluster_list;uniform isampler3D item_list;uniform float time;uniform float hour;uniform vec3 position;uniform vec3 direction;uniform vec3 ray_dir_y;uniform vec3 ray_dir_z;uniform vec3 sun_direction;uniform float fov;uniform float fov_hud;uniform float global_sun_light;uniform float global_moon_light;uniform int background_theme;uniform vec3 background_rise_up_color;uniform vec3 backgorund_night_up_color;uniform vec3 background_rise_down_color;uniform vec3 backgorund_night_down_color;uniform vec3 backgorund_material_up;uniform vec3 background_material_down;uniform float background_noise_size;uniform float background_noise_length;in vec2 uv;in vec2 dirX;in vec2 dirY;in vec2 dirZ;in vec2 dirZI;in vec2 dir0X;in vec2 dir0Y;layout(location=0)out vec4 Albedo;layout(location=1)out vec4 Normal;layout(location=2)out vec4 World;layout(location=3)out vec4 Material;layout(location=4)out vec4 Location;layout(location=5)out vec4 Mask;ivec2 TEXTURE_RESOLUTION;int TILE_RESOLUTION;int CLUSTER_START;int BILLBOARD_LENGTH;\n#define collideBounding(rd,ro,pos,scale)(length(cross(rd,pos-ro))<scale)\n#define fixTexturePosition(index)ivec3(modI(float(index),float(MAX_3D_TEXTURE_SIZE)),modI(floor(float(index)/float(MAX_3D_TEXTURE_SIZE)),float(MAX_3D_TEXTURE_SIZE)),floor(floor(float(index)/float(MAX_3D_TEXTURE_SIZE))/float(MAX_3D_TEXTURE_SIZE)))\n#define hasInOfUV(uv)all(bvec4(greaterThanEqual(uv,vec2(0)),lessThan(uv,vec2(1))))\n#define hasInOfMap(map)all(bvec2(all(greaterThanEqual(map,ivec3(0))),all(lessThan(map,map_size))))\n#define saturate(x)clamp(x,0.,1.)\n#define getDimension(max)max.x<max.y?(max.x<max.z?DIMENSION_X:DIMENSION_Z):(max.y<max.z?DIMENSION_Y:DIMENSION_Z)\n#define getMapData(point)int(texelFetch(map_data,ivec3(point),0).r)\n#define getDistanceField(point)texelFetch(distance_field,ivec3(point),0).r\n#define getMaterialData(point)texelFetch(material_data,point,0)\n#define getVoxelData(point)texelFetch(voxel_data,point,0).r\n#define getClusterData(point)texelFetch(cluster_list,point,0).r\n#define getItemData(point)texelFetch(item_list,point,0).r\n#define getBillboardData(point)texelFetch(billboard_data,point,0).r\n#define getImageData(point)texelFetch(texture_albedo_data,point,0)\n#define getPBRData(point)texelFetch(texture_pbr_data,point,0).rgb\n#define getNormalData(point)texelFetch(texture_normal_data,point,0).rgb*2.-1.\n#define getMaterialID(tile)int(getMaterialData(fixTexturePosition(tile)).x)\n#define getVoxel(index,id)getVoxelData(fixTexturePosition(VOXEL_PROP_LENGTH*index+id))\n#define getClusterLength(cluster)getClusterData(fixTexturePosition(cluster))\n#define getBillboard(index,id)getBillboardData(fixTexturePosition(BILLBOARD_PROP_LENGTH*index+id))\n#define getBillboardPosition(index)vec3(getBillboard(index,BILLBOARD_PROP_POSITION_X),getBillboard(index,BILLBOARD_PROP_POSITION_Y),getBillboard(index,BILLBOARD_PROP_POSITION_Z))\n#define getBillboardScale(index)getBillboard(index,BILLBOARD_PROP_SCALE)\n#define getBillboardBounding(index)getBillboard(index,BILLBOARD_PROP_BOUNDING)\n#define getBillboardAxes(index)clamp(vec3(int(getBillboard(index,BILLBOARD_PROP_AXIS_X)),int(getBillboard(index,BILLBOARD_PROP_AXIS_Y)),int(getBillboard(index,BILLBOARD_PROP_AXIS_Z))),vec3(0.),vec3(1.))\n#define getBillboardFixPosition(index)vec3(getBillboard(index,BILLBOARD_PROP_FIX_POSITION_X),getBillboard(index,BILLBOARD_PROP_FIX_POSITION_Y),getBillboard(index,BILLBOARD_PROP_FIX_POSITION_Z))\n#define getBillboardRotate(index)getBillboard(index,BILLBOARD_PROP_ROTATE)\n#define getBillboardFlip(index)sign(vec2(getBillboard(index,BILLBOARD_PROP_FLIP_X),getBillboard(index,BILLBOARD_PROP_FLIP_Y)))\n#define getBillboardHUDRotate(index)getBillboard(index,BILLBOARD_PROP_HUD_ROTATE)\n#define getBillboardHUDFix(index)getBillboard(index,BILLBOARD_PROP_HUD_FIX)\n#define getBillboardImage(index)int(getBillboard(index,BILLBOARD_PROP_TILE))\n#define getVoxelPosition(index)vec3(getVoxel(index,VOXEL_PROP_POSITION_X),getVoxel(index,VOXEL_PROP_POSITION_Y),getVoxel(index,VOXEL_PROP_POSITION_Z))\n#define getVoxelFront(index)int(getVoxel(index,VOXEL_PROP_TEXTURE_FRONT))\n#define getVoxelBack(index)int(getVoxel(index,VOXEL_PROP_TEXTURE_BACK))\n#define getVoxelRight(index)int(getVoxel(index,VOXEL_PROP_TEXTURE_RIGHT))\n#define getVoxelLeft(index)int(getVoxel(index,VOXEL_PROP_TEXTURE_LEFT))\n#define getVoxelTop(index)int(getVoxel(index,VOXEL_PROP_TEXTURE_TOP))\n#define getVoxelBottom(index)int(getVoxel(index,VOXEL_PROP_TEXTURE_BOTTOM))\n#define getVoxelFlipFront(index)sign(vec2(getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_X_FRONT),getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_Y_FRONT)))\n#define getVoxelFlipBack(index)sign(vec2(-getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_X_BACK),getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_Y_BACK)))\n#define getVoxelFlipRight(index)sign(vec2(getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_X_RIGHT),getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_Y_RIGHT)))\n#define getVoxelFlipLeft(index)sign(vec2(-getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_X_LEFT),getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_Y_LEFT)))\n#define getVoxelFlipTop(index)sign(vec2(-getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_X_TOP),-getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_Y_TOP)))\n#define getVoxelFlipBottom(index)sign(vec2(getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_X_BOTTOM),-getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_Y_BOTTOM)))\nfloat rand(const in float co){return abs(cos(co*43758.5453));}float rand(const in vec2 co){return abs(sin(dot(co.yx,vec2(12.9898,78.233)))*43758.5453);}float rand(const in vec3 co){return abs(sin(dot(co.zxy,vec3(12.9898,78.233,25.3245)))*43758.5453);}vec2 g(const in vec2 n){return sin(n.x*n.y*vec2(12,17)+vec2(1,2));}float noise(const in vec2 uv,const in float scale){vec2 p=mod(uv,vec2(map_size.xz));vec2 i=floor(p);vec2 f=fract(p);f=f*f*(3.-2.*f);return(mix(mix(sin(scale*dot(p,g(i+vec2(0,0)))),sin(scale*dot(p,g(i+vec2(1,0)))),f.x),mix(sin(scale*dot(p,g(i+vec2(0,1)))),sin(scale*dot(p,g(i+vec2(1,1)))),f.x),f.y)+1.)/2.;}float modI(const in float a,const in float b){float m=a-floor((a+0.5)/b)*b;return floor(m+0.5);}vec2 modI(const in vec2 a,const in vec2 b){vec2 m=a-floor((a+0.5)/b)*b;return floor(m+0.5);}vec3 modI(const in vec3 a,const in vec3 b){vec3 m=a-floor((a+0.5)/b)*b;return floor(m+0.5);}vec4 modI(const in vec4 a,const in vec4 b){vec4 m=a-floor((a+0.5)/b)*b;return floor(m+0.5);}mat2 rotate(const in bool inv){float c=inv?dirZI.x:dirZ.x;float s=inv?dirZI.y:dirZ.y;return mat2(c,-s,s,c);}mat2 rotate(const in float angle){float c=cos(angle);float s=sin(angle);return mat2(c,-s,s,c);}mat3 rotate(const in vec3 axis,const in float angle){vec3 a=normalize(axis);float s=sin(angle);float c=cos(angle);float oc=1.-c;return mat3(oc*a.x*a.x+c,oc*a.x*a.y-a.z*s,oc*a.z*a.x+a.y*s,oc*a.x*a.y+a.z*s,oc*a.y*a.y+c,oc*a.y*a.z-a.x*s,oc*a.z*a.x-a.y*s,oc*a.y*a.z+a.x*s,oc*a.z*a.z+c);}mat3 rotate(const in vec3 r){float cx=cos(r.x);float sx=sin(r.x);float cy=cos(r.y);float sy=sin(r.y);float cz=cos(r.z);float sz=sin(r.z);return mat3(cy*cz,cx*sz+sx*sy*cz,sx*sz-cx*sy*cz,-cy*sz,cx*cz-sx*sy*sz,sx*cz+cx*sy*sz,sy,-sx*cy,cx*cy);}vec2 rotateUV(const in vec2 uv,const in vec2 viewport){vec2 u=(uv-0.5)*viewport/min(viewport.x,viewport.y);u*=rotate(false);u+=0.5;return u;}mat2 scale(const in vec2 size){return mat2(size.x,0.,0.,size.y);}float atan2(const in float y,const in float x){return x==0.?sign(y)*PI/2.:atan(y,x);}vec3 calcNormal(const in vec3 point){vec3 dx=normalize(dFdx(point));vec3 dy=normalize(dFdy(point));return normalize(cross(dx,dy));}float normalizeDirection1d(const in float direction){float dir=mod(direction,CIRCLE);return 0.>dir?dir+CIRCLE:dir;}float directionDiff2d(const in float direction1,const in float direction2){float dir1=normalizeDirection1d(direction1);float dir2=normalizeDirection1d(direction2);float diff=dir1-dir2;diff-=floor(diff/CIRCLE)*CIRCLE;diff-=mix(0.,CIRCLE,step(PI,diff));return diff;}vec2 direction3d(const in vec3 p1,const in vec3 p2){vec3 p=p1-p2;float directionX=atan2(p.z,p.x);float directionY=-atan2(p.y,sqrt(p.x*p.x+p.z*p.z));return vec2(directionX,directionY);}int combineBit2D32(const in int num){int n=num;n=n&0x55555555;n=(n|(n>>1))&0x33333333;n=(n|(n>>2))&0x0f0f0f0f;n=(n|(n>>4))&0x00ff00ff;n=(n|(n>>8))&0x0000ffff;return n;}ivec2 decodeMorton2d(const in int morton){return ivec2(combineBit2D32(morton>>0),combineBit2D32(morton>>1));}mat3 lookAt(const in vec3 origin,const in vec3 target,const in float roll){vec3 rr=vec3(sin(roll),cos(roll),0.);vec3 ww=normalize(target-origin);vec3 uu=normalize(cross(ww,rr));vec3 vv=normalize(cross(uu,ww));return mat3(uu,vv,ww);}mat4 lookAt(const in vec3 eye,const in vec3 center,const in vec3 up){vec3 w=normalize(eye-center);vec3 u=normalize(cross(up,w));vec3 v=normalize(cross(w,u));return mat4(u.x,v.x,w.x,0,u.y,v.y,w.y,0,u.z,v.z,w.z,0,-dot(u,eye),-dot(u,eye),-dot(w,eye),1);}mat4 perspective(const in float fov,const in float aspect,const in float near,const in float far){float v=1./tan(radians(fov/2.)),u=v/aspect,w=near-far;return mat4(u,0,0,0,0,v,0,0,0,0,(near+far)/w,-1,0,0,near*far*2./w,1);}vec3 ground(const in vec3 p,const in vec3 d,const in float depth){vec3 n=vec3(0.,depth,0.);float f=dot(-n*0.8-p,n)/dot(n,d);return p+d*f;}vec3 calcDirection(const in vec2 d){float xRotRads=-d.x-HALF;float yRotRads=-d.y;float cosY=cos(yRotRads);vec3 dir=vec3(sin(xRotRads)*cosY,-sin(yRotRads),cos(xRotRads)*cosY);return dir;}vec3 calcDirectionUV_Z(const in vec2 uv){float gggxd=uv.x-0.5;float ggyd=uv.y-0.5;float ggzd=fov;float gggzd=ggzd*dirY.x+ggyd*dirY.y;return normalize(vec3(gggzd*dirX.x-gggxd*dirX.y,ggyd*dirY.x-ggzd*dirY.y,gggxd*dirX.x+gggzd*dirX.y));}vec3 calcDirectionHUD_UV_Z(const in vec2 uv){float gggxd=uv.x-0.5;float ggyd=uv.y-0.5;float ggzd=fov_hud;float gggzd=ggzd*dir0Y.x+ggyd*dir0Y.y;return normalize(vec3(gggzd*dir0X.x-gggxd*dir0X.y,ggyd*dir0Y.x-ggzd*dir0Y.y,gggxd*dir0X.x+gggzd*dir0X.y));}vec2 aspectUV(const in vec2 uv,const in vec2 viewport){vec2 u=uv-0.5;u*=viewport/viewport.y;u*=rotate(false);return u+0.5;}bool hasGround(const in vec3 rd,const in vec3 ro,const in float height){float d=-(ro.y-height)/rd.y;d=min(100000.,d);return d>0.;}vec3 normalizeNormalBlock(const in vec3 material,const in vec3 world){vec3 m=material;m=mix(m,vec3(-material.x,material.y,material.z),max(0.,world.x));m=mix(m,vec3(material.x,-material.y,material.z),max(0.,-world.x));m=mix(m,vec3(material.x,material.y,material.z),max(0.,world.y));m=mix(m,vec3(material.x,-material.y,material.z),max(0.,-world.y));m=mix(m,vec3(material.x,material.y,material.z),max(0.,world.z));m=mix(m,vec3(-material.xy,material.z),max(0.,-world.z));return m;}vec3 normalizeNormalBillboard(const in vec3 material,const in vec3 world){vec3 m=material;m=mix(m,vec3(material.x,material.y,material.z),max(0.,world.x));m=mix(m,vec3(material.x,-material.y,material.z),max(0.,-world.x));m=mix(m,vec3(material.x,material.y,material.z),max(0.,world.y));m=mix(m,vec3(material.x,-material.y,material.z),max(0.,-world.y));m=mix(m,vec3(material.x,material.y,material.z),max(0.,world.z));m=mix(m,vec3(material.x,-material.y,material.z),max(0.,-world.z));return m;}vec3 blendNormal(const in vec3 n1,const in vec3 n2){vec3 world_n=normalize(n1);vec3 map_n=normalize(n2);vec3 t=cross(world_n,vec3(0.,1.,0.));if(length(t)==0.){t=cross(world_n,vec3(0.,0.,1.));}t=normalize(t);vec3 b=normalize(cross(world_n,t));mat3 tbn=mat3(t,b,world_n);return normalize(tbn*map_n);}const mat4x4 bayers=mat4x4(0.,8.,2.,10.,12.,4.,14.,6.,3.,11.,1.,9.,15.,7.,13.,5.)/16.;float getBayer(const in vec2 uv){int ix=int(uv.x)%4;int iy=int(uv.y)%4;return bayers[ix][iy];}bool hasBayer(const in vec2 uv,const in float alpha,inout int bayer){bool is=getBayer(uv*viewport.xy+vec2(decodeMorton2d(bayer)))>alpha;bayer=is?bayer:bayer+1;return is;}bool getTexture(const in vec2 u,const in vec2 uv,const in int id,inout int bayer,out vec4 col,out ivec2 pos){float tile=float(tile_resolution);ivec2 p=decodeMorton2d(id);pos=ivec2(uv*tile+vec2(p)*tile);col=getImageData(pos);int old=bayer;bool is=!(col.a<1.&&(col.a<=0.||!hasBayer(u,col.a,bayer)));bayer=is&&old!=bayer?bayer-1:bayer;return is;}int getClusterTile(const in vec2 uv){vec2 box=1./vec2(cluster_resolution);return int(uv.y/box.y)*cluster_resolution.x+int(uv.x/box.x);}bool rayBillboard(const in vec3 rd,const in vec3 fixRd,const in vec3 ro,const in vec3 pos,const in vec3 fixPos,const in float scale,const in bool isHUD,const in vec3 axes,const in vec3 up,out vec3 normal,out vec3 position,out vec2 uv){vec3 v=pos-ro;vec3 n=normalize(axes*v);float z=dot(n,v)/dot(n,fixRd);if(z<=0.){return false;}vec3 vv=fixPos-ro;vec3 nn=normalize(axes*vv);float zz=dot(nn,vv)/dot(nn,rd);position=ro+rd*min(length(fixPos-ro)+scale/2.,zz);normal=(isHUD?-ray_dir_z:normalize(ro-fixPos))*axes;vec3 pp=ro+fixRd*min(length(pos-ro)+scale/2.,z);vec3 p=pp-pos;vec3 x=normalize(cross(n,up));vec3 y=normalize(cross(n,x));uv=vec2(dot(p,x),dot(p,y));return true;}int getSurface(const in int dimension,const in vec3 ray){switch(dimension){case DIMENSION_X:return 0.<ray.x?SURFACE_FRONT:SURFACE_BACK;case DIMENSION_Y:return 0.<ray.y?SURFACE_TOP:SURFACE_BOTTOM;case DIMENSION_Z:return 0.<ray.z?SURFACE_LEFT:SURFACE_RIGHT;}return SURFACE_NONE;}void getVoxelTile(const in int surface,const in int id,out int tile,out vec2 flip){switch(surface){case SURFACE_FRONT:tile=getVoxelFront(id);flip=getVoxelFlipFront(id);break;case SURFACE_BACK:tile=getVoxelBack(id);flip=getVoxelFlipBack(id);break;case SURFACE_RIGHT:tile=getVoxelRight(id);flip=getVoxelFlipRight(id);break;case SURFACE_LEFT:tile=getVoxelLeft(id);flip=getVoxelFlipLeft(id);break;case SURFACE_BOTTOM:tile=getVoxelBottom(id);flip=getVoxelFlipBottom(id);break;case SURFACE_TOP:tile=getVoxelTop(id);flip=getVoxelFlipTop(id);break;}}int raycast(const in vec3 rd,const in vec3 ro,inout float len,out vec3 ray,out vec3 mask,out vec3 odist,out vec3 point,out vec3 normal,out ivec3 map){ray=1./rd;vec3 delta=abs(ray);vec3 dray=abs(vec3(length(rd))/rd);ivec3 sray=ivec3(sign(rd));vec3 add=floor(vec3(sray));map=ivec3(floor(ro+0.));vec3 dist=(sign(rd)*(vec3(map)-ro)+(sign(rd)*0.5)+0.5)*dray;int st=0;float dis=min(min(odist.x,odist.y),odist.z);bool isOut=false;bool isHit=false;for(int i=0;i<int(max_draw_distance);i++){vec3 m=floor(max(0.,float(st-1))/delta);dist+=m*dray;map+=ivec3(m)*sray;mask=vec3(lessThanEqual(dist.xyz,min(dist.yzx,dist.zxy)));odist=dist;dist+=mask*dray;map+=ivec3(mask)*sray;st=getDistanceField(map);dis=min(min(odist.x,odist.y),odist.z);isHit=st<1;isOut=len<=dis;if(isHit||isOut){break;}}if(isHit&&!isOut){point=ro+dis/delta*add;len=length(point-ro);normal=normalize(-mask*vec3(sray));}return hasInOfMap(map)?getMapData(map):0;}void getColorEmpty(inout vec3 point,inout ivec3 map,inout vec4 albedo,inout int object,inout vec3 material,inout vec3 mask){point=vec3(0.);map=ivec3(0.);object=OBJECT_NONE;albedo=vec4(0.);material=vec3(0.);mask=vec3(0.);}bool getColorVoxel(const in vec2 u,const in vec3 rd,const in vec3 ro,inout int bayer,inout float len,inout vec3 point,inout ivec3 map,inout vec4 albedo,inout vec3 normal,inout vec3 world,inout int object,inout vec3 material,inout vec3 mask,inout int dimension){vec3 ray;vec3 odist;vec3 p;vec3 n;vec4 col;vec3 pbr;vec3 nor;vec2 flip;vec3 rro=ro;float l=len;int id;do{id=raycast(rd,rro,l,ray,mask,odist,p,n,map);if(id<=VOXEL_EMPTY){break;}dimension=getDimension(odist);int surface=getSurface(dimension,ray);int tile;getVoxelTile(surface,id,tile,flip);int mat=getMaterialID(tile);switch(dimension){case DIMENSION_X:p.x=p.x>float(map.x)+0.5?float(map.x+1)+0.01:float(map.x)-0.01;break;case DIMENSION_Y:p.y=p.y>float(map.y)+0.5?float(map.y+1)+0.01:float(map.y)-0.01;break;case DIMENSION_Z:p.z=p.z>float(map.z)+0.5?float(map.z+1)+0.01:float(map.z)-0.01;break;}vec2 uv=vec2(fract(dimension==DIMENSION_X?p.z:p.x),dimension==DIMENSION_Y?fract(p.z):1.-fract(p.y));uv.x=flip.x<0.?1.-uv.x:uv.x;uv.y=flip.y<0.?1.-uv.y:uv.y;ivec2 pos;if(getTexture(u,uv,mat,bayer,col,pos)){pbr=getPBRData(pos);nor=getNormalData(pos);break;}rro=p+rd*0.1;l=len;}while(true);if(object!=OBJECT_NONE&&l>=len||id<=VOXEL_EMPTY){return false;}world=n;if(world.x!=0.||world.z!=0.){nor.y=-nor.y;}if(world.y<0.||world.z>0.||world.x<0.){nor.x=-nor.x;}nor.xy*=flip;len=l;point=p;object=OBJECT_HIT_VOXEL;albedo=vec4(col.rgb,1.);normal=blendNormal(world,nor);material=pbr;return true;}bool getColorBillboard(const in vec2 u,const in vec3 rd,const in vec3 fixRd,const in vec3 ro,inout int bayer,inout float len,inout vec3 point,inout vec4 albedo,inout vec3 normal,inout vec3 world,inout int index,inout int object,inout vec3 material,inout vec3 bpos,inout float bscale){if(BILLBOARD_LENGTH>0)for(int i=0;i<BILLBOARD_LENGTH;i++){int ind=getItemData(fixTexturePosition(CLUSTER_START+i));bool isHUD=bool(getBillboardHUDFix(ind));vec3 position=getBillboardPosition(ind);vec3 rrd=isHUD?vec3(0.):rd;vec3 rro=isHUD?vec3(0.):ro;float scale=getBillboardScale(ind);if(length(rro-position)-scale/2.>len){break;}float bounding=getBillboardBounding(ind);if(!collideBounding(rrd,rro,position,scale*bounding)){continue;}vec3 axes=isHUD?vec3(1.,1.,1.):getBillboardAxes(ind);vec3 fixRd=isHUD?fixRd:rrd;vec3 fixPos=isHUD?getBillboardFixPosition(ind):position;vec3 up=(axes.x==0.&&axes.y>0.&&axes.z==0.)?vec3(0.,0.,1.):vec3(0.,1.,0.);vec3 n;vec3 p;vec2 uv;if(!rayBillboard(rrd,fixRd,rro,position,fixPos,scale,isHUD,axes,up,n,p,uv)){continue;}p=isHUD?ro+p+position*rd:p;float l=length(ro-p);if(l>len){continue;}float angle=normalizeDirection1d(-getBillboardRotate(ind));float ang=normalizeDirection1d(angle+(isHUD?-getBillboardHUDRotate(ind):0.));uv/=scale;uv*=rotate(ang);uv+=0.5;if(!hasInOfUV(uv)){continue;}vec2 flip=getBillboardFlip(ind);uv.x=flip.x<0.?1.-uv.x:uv.x;uv.y=flip.y<0.?1.-uv.y:uv.y;int tile=getBillboardImage(ind);int id=getMaterialID(tile);vec4 col;vec3 pbr;vec3 nor;ivec2 pos;if(!getTexture(u,uv,id,bayer,col,pos)){continue;}pbr=getPBRData(pos);nor=getNormalData(pos);world=normalize(n);nor.xy*=flip;nor.xy*=-1.;nor.xy*=rotate(angle);index=ind;object=isHUD?OBJECT_HIT_HUD:OBJECT_HIT_BILLBOARD;albedo=vec4(col.rgb,1.);len=length(ro-p);point=p;normal=blendNormal(world,nor);material=pbr;bpos=p;bscale=scale;if(isHUD){break;}}return index!=-1;}vec2 rsi(const in vec3 ro,const in vec3 rd,const in float sr){float a=dot(rd,rd);float b=2.*dot(rd,ro);float c=dot(ro,ro)-(sr*sr);float d=(b*b)-4.*a*c;float sd=sqrt(d);float a2=2.*a;return vec2((-b-sd),(-b+sd))/(a2);}vec3 atmosphere(vec3 rd,vec3 ro,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g){vec2 p=rsi(ro,rd,rAtmos);if(p.x>p.y){return vec3(0.,0.,0.);}float iStepSize=(rAtmos-rPlanet)/float(iSteps);float iTime=0.;vec3 totalRlh=vec3(0.);vec3 totalMie=vec3(0.);float iOdRlh=0.;float iOdMie=0.;float mu=dot(rd,pSun);float mumu=mu/5.;float gg=g*g;float pRlh=3./(16.*PI)*(1.+mumu);float pMie=3./(8.*PI)*((1.-gg)*(mumu+1.))/(pow(1.+gg-2.*mu*g,1.5)*(2.+gg));for(int i=0;i<iSteps;i++){vec3 iPos=ro+rd*(iTime+iStepSize*0.5);float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=0.;float jOdRlh=0.;float jOdMie=0.;for(int j=0;j<jSteps;j++){vec3 jPos=iPos+pSun*(jTime+jStepSize*0.5);float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}return clamp(iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie),vec3(0.),vec3(1.));}vec3 calcStar(const in vec3 rd){vec3 albedo=vec3(0.);float size=0.1;vec3 r=normalize(mod(rd,size)-size/2.);vec3 g=floor(r/size);int count=int(rand(dot(g,vec3(25.,570.,553.)))*500.);float x=cos(0.123*float(count)*CIRCLE);float y=(rand(0.231*float(count))-0.5)*2.;float z=sin(0.123*float(count)*CIRCLE);float s=rand(0.312*float(count));float divY=1.-abs(y);vec3 lo=vec3(x*divY,y,z*divY)*15.;float lr=0.75;float len=length(cross(r,lo));albedo+=len<lr?saturate((1.-(len/lr))*mix(vec3(1.),vec3(0.,0.45,1.),rand(float(count)*0.132))):vec3(0.);return albedo;}void calcSkybox(const in vec3 rd,const in vec3 ro,out vec3 skybox){vec3 sun=atmosphere(rd,vec3(0.,6372000.,0.)+ro,sun_direction,30.,6361000.,6461000.,SKY_COLOR,0.0002,10000.,3500.,0.999);vec3 moon=global_moon_light<=0.?vec3(0.):(atmosphere(rd,vec3(0.,6372000.,0.)+ro,-sun_direction,30.,6361000.,6461000.,STARY_COLOR,0.0002,10000.,3500.,0.999)+calcStar(normalize(rd*rotate(vec3(0.5,0.5,1.),hour/4.)))*4.)*global_moon_light;skybox=saturate(max(sun+sun+sun,moon));}void getColorBackground(const in vec3 rd,const in vec3 ro,inout float len,inout vec4 albedo,inout vec3 normal,inout vec3 material,inout vec3 point,inout int object){if(hasGround(ro,rd,0.)){vec3 pos=ground(ro,rd,0.001);vec3 n=vec3(0.,1.,0.);len=length(ro-pos);object=OBJECT_HIT_GROUND;point=pos+vec3(0.,0.001,0.);vec3 px=pos*background_noise_size;vec3 py=pos*background_noise_size;switch(background_theme){case BACKGROUND_NOISE:vec3 rab_noise=vec3(noise(px.xz,background_noise_length),0.,noise(py.zx,background_noise_length));float par_noise=max(rab_noise.x,rab_noise.z);albedo=vec4(mix(mix(background_rise_up_color,backgorund_night_up_color,global_moon_light),mix(background_rise_down_color,backgorund_night_down_color,global_moon_light),par_noise),1.);normal=n-rab_noise*rd*0.25;material=mix(backgorund_material_up,background_material_down,par_noise);break;case BACKGROUND_LIQUID:float add_liquid=time/60.;vec3 rab_liquid=mix(vec3(noise(px.xz+add_liquid,background_noise_length),0.,noise(px.zx+add_liquid,background_noise_length)),vec3(noise(py.xz-vec2(add_liquid,-add_liquid),background_noise_length),0.,noise(py.zx-vec2(-add_liquid,add_liquid),background_noise_length)),0.5);float par_liquid=max(rab_liquid.x,rab_liquid.z);albedo=vec4(mix(mix(background_rise_up_color,backgorund_night_up_color,global_moon_light),mix(background_rise_down_color,backgorund_night_down_color,global_moon_light),par_liquid),1.);normal=n-rab_liquid*rd*0.25;material=mix(backgorund_material_up,background_material_down,par_liquid);break;}}else{vec3 skybox=albedo.rgb;calcSkybox(rd,ro,skybox);len=max_draw_distance;albedo=vec4(skybox,0.);material=vec3(0.);normal=normalize(-rd);object=OBJECT_NONE;point=vec3(0.);}}vec2 compactCheckerCoord(const in vec2 uv,const in vec2 coord,const in vec2 resolution){return floor((uv+(1./resolution*vec2(modI(coord.y,2.)==1.,0.)))*resolution)/resolution;}float destObject(const in int object){return float(object);}vec3 destNormal(const in vec3 normal){return normal*0.5+0.5;}void main(){TEXTURE_RESOLUTION=textureSize(texture_albedo_data,0);TILE_RESOLUTION=MAX_2D_TEXTURE_SIZE-int(modI(float(MAX_2D_TEXTURE_SIZE),float(tile_resolution)));vec2 u=compactCheckerCoord(uv,gl_FragCoord.xy,viewport);int tile=getClusterTile(u);CLUSTER_START=tile==0?0:getClusterLength(tile-1);BILLBOARD_LENGTH=getClusterLength(tile)-CLUSTER_START;vec2 uu=aspectUV(u,resolution);vec3 rd=calcDirectionUV_Z(uu);vec3 fixRd=calcDirectionHUD_UV_Z(uu);vec3 ro=position;float len=max_draw_distance;vec3 point;ivec3 map;vec4 albedo;vec3 normal;vec3 world;int object;vec3 material;vec3 mask;int dimension;int index=-1;vec3 bpos;float bscale;float ao=0.;int bayer=0;getColorEmpty(point,map,albedo,object,material,mask);getColorBillboard(u,rd,fixRd,ro,bayer,len,point,albedo,normal,world,index,object,material,bpos,bscale);getColorVoxel(u,rd,ro,bayer,len,point,map,albedo,normal,world,object,material,mask,dimension);if(object==OBJECT_NONE){getColorBackground(rd,ro,len,albedo,normal,material,point,object);}Albedo=albedo;Normal=vec4(destNormal(normal),0.);World=vec4(destNormal(world),bayer);Material=vec4(material,object);Location=vec4(point,len);Mask=vec4(mask,dimension);}"},(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i="#version 300 es\n#define EPSILON  0.00001\n#define FLT_MIN  1.175494351e-38\n#define FLT_MAX  3.402823466e38\n#define AO_LIGHT  vec3(0.03125)\n#define MAX_LOOP  9999\n#define STAR_MAX  500\n#define QUATER  0.7853981633974483\n#define HALF  1.5707963267948966\n#define PI  3.141592653589793\n#define CIRCLE  6.283185307179586\n#define sampler3D  sampler2DArray\n#define isampler3D  isampler2DArray\n#define usampler3D  usampler2DArray\n#define BILLBOARD_PROP_POSITION_X  0\n#define BILLBOARD_PROP_POSITION_Y  1\n#define BILLBOARD_PROP_POSITION_Z  2\n#define BILLBOARD_PROP_SCALE  3\n#define BILLBOARD_PROP_BOUNDING  4\n#define BILLBOARD_PROP_AXIS_X  5\n#define BILLBOARD_PROP_AXIS_Y  6\n#define BILLBOARD_PROP_AXIS_Z  7\n#define BILLBOARD_PROP_ROTATE  8\n#define BILLBOARD_PROP_FLIP_X  9\n#define BILLBOARD_PROP_FLIP_Y  10\n#define BILLBOARD_PROP_HUD_FIX  11\n#define BILLBOARD_PROP_HUD_ROTATE  12\n#define BILLBOARD_PROP_TILE  13\n#define BILLBOARD_PROP_LENGTH  14\n#define VOXEL_PROP_POSITION_X  0\n#define VOXEL_PROP_POSITION_Y  1\n#define VOXEL_PROP_POSITION_Z  2\n#define VOXEL_PROP_TEXTURE_FRONT  3\n#define VOXEL_PROP_TEXTURE_BACK  4\n#define VOXEL_PROP_TEXTURE_RIGHT  5\n#define VOXEL_PROP_TEXTURE_LEFT  6\n#define VOXEL_PROP_TEXTURE_TOP  7\n#define VOXEL_PROP_TEXTURE_BOTTOM  8\n#define VOXEL_PROP_TEXTURE_FLIP_X_FRONT  9\n#define VOXEL_PROP_TEXTURE_FLIP_Y_FRONT  10\n#define VOXEL_PROP_TEXTURE_FLIP_X_BACK  11\n#define VOXEL_PROP_TEXTURE_FLIP_Y_BACK  12\n#define VOXEL_PROP_TEXTURE_FLIP_X_RIGHT  13\n#define VOXEL_PROP_TEXTURE_FLIP_Y_RIGHT  14\n#define VOXEL_PROP_TEXTURE_FLIP_X_LEFT  15\n#define VOXEL_PROP_TEXTURE_FLIP_Y_LEFT  16\n#define VOXEL_PROP_TEXTURE_FLIP_X_TOP  17\n#define VOXEL_PROP_TEXTURE_FLIP_Y_TOP  18\n#define VOXEL_PROP_TEXTURE_FLIP_X_BOTTOM  19\n#define VOXEL_PROP_TEXTURE_FLIP_Y_BOTTOM  20\n#define VOXEL_PROP_LENGTH  21\n#define SURFACE_NONE  -1\n#define SURFACE_FRONT  0\n#define SURFACE_BACK  1\n#define SURFACE_RIGHT  2\n#define SURFACE_LEFT  3\n#define SURFACE_TOP  4\n#define SURFACE_BOTTOM  5\n#define DIMENSION_X  0\n#define DIMENSION_Y  1\n#define DIMENSION_Z  2\n#define OBJECT_NONE  0\n#define OBJECT_HIT_GROUND  1\n#define OBJECT_HIT_VOXEL  2\n#define OBJECT_HIT_BILLBOARD  3\n#define OBJECT_HIT_HUD  4\n#define WALL_NONE  0\n#define WALL_BLOCK  1\n#define WALL_WALLX  2\n#define WALL_WALLZ  3\n#define BACKGROUND_NOISE  0\n#define BACKGROUND_LIQUID  1\n#define VOXEL_EMPTY  0\n#define iSteps  3\n#define jSteps  1\n#define SHADOW  vec3(0.25)\n#define SLIGHT  vec3(1.0)\n#define NLIGHT  vec3(0.375, 0.375, 0.5)\n#define SKY_COLOR  vec3(0.000003, 0.0000075, 0.0000175)\n#define STARY_COLOR  vec3(0.000003, 0.0000075, 0.0000175)\n#define saturate(x)clamp(x,0.,1.)\nprecision highp int;precision highp float;precision highp sampler2D;precision highp isampler2D;precision highp usampler2D;precision highp sampler3D;precision highp isampler3D;precision highp usampler3D;uniform vec2 viewport;uniform vec2 resolution;uniform ivec3 map_size;uniform int MAX_2D_TEXTURE_SIZE;uniform int MAX_3D_TEXTURE_SIZE;uniform float max_draw_distance;uniform int tile_resolution;uniform int reflection_count;uniform isampler3D map_data;uniform isampler3D distance_field;uniform sampler2D texture_albedo_data;uniform sampler2D texture_pbr_data;uniform sampler2D texture_normal_data;uniform isampler3D material_data;uniform sampler3D voxel_data;uniform float time;uniform float hour;uniform vec3 position;uniform vec3 direction;uniform vec3 ray_dir_z;uniform vec3 sun_direction;uniform float fov;uniform float global_sun_light;uniform float global_moon_light;uniform float sun_light_force;uniform float moon_light_force;uniform bool is_shadow;uniform bool is_reflection;uniform bool is_roughness;uniform bool is_dithering;uniform int background_theme;uniform vec3 background_rise_up_color;uniform vec3 backgorund_night_up_color;uniform vec3 background_rise_down_color;uniform vec3 backgorund_night_down_color;uniform vec3 backgorund_material_up;uniform vec3 background_material_down;uniform float background_noise_size;uniform float background_noise_length;uniform sampler2D Albedo;uniform sampler2D Normal;uniform sampler2D World;uniform sampler2D Material;uniform sampler2D Location;uniform sampler2D Mask;in vec2 uv;in vec2 dirX;in vec2 dirY;in vec2 dirZ;in vec2 dirZI;layout(location=0)out vec4 Lighting;layout(location=1)out vec4 LightingParam;layout(location=2)out vec4 ClipAlbedo;layout(location=3)out vec4 ClipLighting;layout(location=4)out vec4 ClipSkybox;layout(location=5)out vec4 Reflection;layout(location=6)out vec4 ClipReflection;ivec2 TEXTURE_RESOLUTION;int TILE_RESOLUTION;\n#define fixTexturePosition(index)ivec3(modI(float(index),float(MAX_3D_TEXTURE_SIZE)),modI(floor(float(index)/float(MAX_3D_TEXTURE_SIZE)),float(MAX_3D_TEXTURE_SIZE)),floor(floor(float(index)/float(MAX_3D_TEXTURE_SIZE))/float(MAX_3D_TEXTURE_SIZE)))\n#define vertexAO(side,corner)((side.x+side.y+max(corner,side.x*side.y))/3.)\n#define getFade(dist,len,depth)clamp((depth-(dist-len))/len,0.,1.)\n#define saturate(x)clamp(x,0.,1.)\n#define hasInOfMap(map)all(bvec2(all(greaterThanEqual(map,ivec3(0))),all(lessThan(map,map_size))))\n#define getDimension(max)max.x<max.y?(max.x<max.z?DIMENSION_X:DIMENSION_Z):(max.y<max.z?DIMENSION_Y:DIMENSION_Z)\n#define getMapData(point)int(texelFetch(map_data,ivec3(point),0).r)\n#define getDistanceField(point)int(texelFetch(distance_field,ivec3(point),0).r)\n#define getMaterialData(point)texelFetch(material_data,point,0)\n#define getVoxelData(point)texelFetch(voxel_data,point,0).r\n#define getImageData(point)texelFetch(texture_albedo_data,point,0)\n#define getPBRData(point)texelFetch(texture_pbr_data,point,0).rgb\n#define getNormalData(point)texelFetch(texture_normal_data,point,0).rgb*2.-1.\n#define getMaterialID(tile)int(getMaterialData(fixTexturePosition(tile)).x)\n#define getVoxel(index,id)getVoxelData(fixTexturePosition(VOXEL_PROP_LENGTH*index+id))\n#define getVoxelFront(index)int(getVoxel(index,VOXEL_PROP_TEXTURE_FRONT))\n#define getVoxelBack(index)int(getVoxel(index,VOXEL_PROP_TEXTURE_BACK))\n#define getVoxelRight(index)int(getVoxel(index,VOXEL_PROP_TEXTURE_RIGHT))\n#define getVoxelLeft(index)int(getVoxel(index,VOXEL_PROP_TEXTURE_LEFT))\n#define getVoxelTop(index)int(getVoxel(index,VOXEL_PROP_TEXTURE_TOP))\n#define getVoxelBottom(index)int(getVoxel(index,VOXEL_PROP_TEXTURE_BOTTOM))\n#define getVoxelFlipFront(index)sign(vec2(getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_X_FRONT),getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_Y_FRONT)))\n#define getVoxelFlipBack(index)sign(vec2(-getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_X_BACK),getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_Y_BACK)))\n#define getVoxelFlipRight(index)sign(vec2(getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_X_RIGHT),getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_Y_RIGHT)))\n#define getVoxelFlipLeft(index)sign(vec2(-getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_X_LEFT),getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_Y_LEFT)))\n#define getVoxelFlipTop(index)sign(vec2(-getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_X_TOP),-getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_Y_TOP)))\n#define getVoxelFlipBottom(index)sign(vec2(getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_X_BOTTOM),-getVoxel(index,VOXEL_PROP_TEXTURE_FLIP_Y_BOTTOM)))\nfloat rand(const in float co){return abs(cos(co*43758.5453));}float rand(const in vec2 co){return abs(sin(dot(co.yx,vec2(12.9898,78.233)))*43758.5453);}float rand(const in vec3 co){return abs(sin(dot(co.zxy,vec3(12.9898,78.233,25.3245)))*43758.5453);}vec2 g(const in vec2 n){return sin(n.x*n.y*vec2(12,17)+vec2(1,2));}float noise(const in vec2 p,const in float kF){vec2 i=floor(mod(p,vec2(map_size.xz)));vec2 f=fract(p);f=f*f*(3.-2.*f);return(mix(mix(sin(kF*dot(p,g(i+vec2(0,0)))),sin(kF*dot(p,g(i+vec2(1,0)))),f.x),mix(sin(kF*dot(p,g(i+vec2(0,1)))),sin(kF*dot(p,g(i+vec2(1,1)))),f.x),f.y)+1.)/2.;}float modI(const in float a,const in float b){float m=a-floor((a+0.5)/b)*b;return floor(m+0.5);}vec2 modI(const in vec2 a,const in vec2 b){vec2 m=a-floor((a+0.5)/b)*b;return floor(m+0.5);}mat2 rotate(const in bool inv){float c=inv?dirZI.x:dirZ.x;float s=inv?dirZI.y:dirZ.y;return mat2(c,-s,s,c);}mat2 rotate(const in float angle){float c=cos(angle);float s=sin(angle);return mat2(c,-s,s,c);}mat3 rotate(const in vec3 axis,const in float angle){vec3 a=normalize(axis);float s=sin(angle);float c=cos(angle);float oc=1.-c;return mat3(oc*a.x*a.x+c,oc*a.x*a.y-a.z*s,oc*a.z*a.x+a.y*s,oc*a.x*a.y+a.z*s,oc*a.y*a.y+c,oc*a.y*a.z-a.x*s,oc*a.z*a.x-a.y*s,oc*a.y*a.z+a.x*s,oc*a.z*a.z+c);}vec2 project(const in vec3 point,const in mat4 cam,const in float fov){vec3 o=(cam*vec4(point,1.)).xyz;float z2=o.z*o.z;return fov*o.z*o.xy/z2;}vec2 rotateUV(const in vec2 uv,const in vec2 viewport){vec2 u=(uv-0.5)*viewport/min(viewport.x,viewport.y);u*=rotate(false);u+=0.5;return u;}mat2 scale(const in vec2 size){return mat2(size.x,0.,0.,size.y);}vec3 calcNormal(const in vec3 point){vec3 dx=normalize(dFdx(point));vec3 dy=normalize(dFdy(point));return normalize(cross(dx,dy));}float normalizeDirection1d(const in float direction){float dir=mod(direction,CIRCLE);dir=mix(dir,dir+CIRCLE,step(dir,0.));return dir;}float directionDiff2d(const in float direction1,const in float direction2){float dir1=normalizeDirection1d(direction1);float dir2=normalizeDirection1d(direction2);float diff=dir1-dir2;diff-=floor(diff/CIRCLE)*CIRCLE;diff-=mix(0.,CIRCLE,step(PI,diff));return diff;}int combineBit2D32(const in int num){int n=num;n=n&0x55555555;n=(n|(n>>1))&0x33333333;n=(n|(n>>2))&0x0f0f0f0f;n=(n|(n>>4))&0x00ff00ff;n=(n|(n>>8))&0x0000ffff;return n;}ivec2 decodeMorton2d(const in int morton){return ivec2(combineBit2D32(morton>>0),combineBit2D32(morton>>1));}mat3 lookAt(const in vec3 origin,const in vec3 target,const in float roll){vec3 rr=vec3(sin(roll),cos(roll),0.);vec3 ww=normalize(target-origin);vec3 uu=normalize(cross(ww,rr));vec3 vv=normalize(cross(uu,ww));return mat3(uu,vv,ww);}mat4 lookAt(const in vec3 eye,const in vec3 center,const in vec3 up){vec3 w=normalize(eye-center);vec3 u=normalize(cross(up,w));vec3 v=normalize(cross(w,u));return mat4(u.x,v.x,w.x,0,u.y,v.y,w.y,0,u.z,v.z,w.z,0,-dot(u,eye),-dot(u,eye),-dot(w,eye),1);}mat4 perspective(const in float fov,const in float aspect,const in float near,const in float far){float v=1./tan(radians(fov/2.)),u=v/aspect,w=near-far;return mat4(u,0,0,0,0,v,0,0,0,0,(near+far)/w,-1,0,0,near*far*2./w,1);}vec3 ground(const in vec3 p,const in vec3 d,const in float depth){vec3 n=vec3(0.,depth,0.);float f=dot(-n*0.8-p,n)/dot(n,d);return p+d*f;}vec3 blendNormal(const in vec3 n2,const in vec3 n1){vec3 world_n=normalize(n2);vec3 t=cross(world_n,vec3(0.,1.,0.));if(length(t)==0.){t=cross(world_n,vec3(0.,0.,1.));}if(length(t)==0.){t=cross(world_n,vec3(1.,0.,0.));}t=normalize(t);vec3 b=normalize(cross(world_n,t));mat3 tbn=mat3(t,b,world_n);vec3 map_n=normalize(n1);return normalize(tbn*map_n);}const mat4x4 bayers=mat4x4(0.,8.,2.,10.,12.,4.,14.,6.,3.,11.,1.,9.,15.,7.,13.,5.)/16.;float getBayer(const in vec2 uv){int ix=int(uv.x)%4;int iy=int(uv.y)%4;return bayers[ix][iy];}bool hasBayer(const in vec2 uv,const in float alpha,inout int bayer){bool is=getBayer(uv*viewport.xy+vec2(decodeMorton2d(bayer)))>alpha;bayer=is?bayer:bayer+1;return is;}bool getTexture(const in vec2 u,const in vec2 uv,const in int id,inout int bayer,out vec4 col,out ivec2 pos){float tile=float(tile_resolution);ivec2 p=decodeMorton2d(id);pos=ivec2(uv*tile+vec2(p)*tile);col=getImageData(pos);int old=bayer;bool is=!(col.a<1.&&(col.a<=0.||!hasBayer(u,col.a,bayer)));bayer=is&&old!=bayer?bayer-1:bayer;return is;}float diffuse(const in vec3 light,const in vec3 normal){return saturate(dot(normal,light));}float phong(const in vec3 posg,const in vec3 light,const in vec3 normal,const in vec3 parametes){vec3 n=normal;vec3 invLight=light;vec3 invEye=posg;vec3 halfLE=normalize(invLight-invEye);float rough=parametes.y;float alpha2=pow(rough,4.);float D=alpha2/(PI*pow(dot(n,halfLE)*dot(n,halfLE)*(alpha2-1.)+1.,2.));float fre=parametes.x+(1.-parametes.x)*pow(saturate(dot(invEye,halfLE)),5.);float nv=saturate(dot(invEye,n));float nl=saturate(dot(invLight,n));float G=1./(nv+sqrt(alpha2+(1.-alpha2)*nv*nv))/(nl+sqrt(alpha2+(1.-alpha2)*nl*nl));float specular=D*fre*G;float diffuse=(1.-fre)*saturate(dot(n,invLight))/PI;float meta=parametes.z;return saturate(mix(diffuse,specular,meta));}int getSurface(const in int dimension,const in vec3 ray){switch(dimension){case DIMENSION_X:return 0.<ray.x?SURFACE_FRONT:SURFACE_BACK;case DIMENSION_Y:return 0.<ray.y?SURFACE_TOP:SURFACE_BOTTOM;case DIMENSION_Z:return 0.<ray.z?SURFACE_LEFT:SURFACE_RIGHT;}return SURFACE_NONE;}void getVoxelTile(const in int surface,const in int id,out int tile,out vec2 flip){switch(surface){case SURFACE_FRONT:tile=getVoxelFront(id);flip=getVoxelFlipFront(id);break;case SURFACE_BACK:tile=getVoxelBack(id);flip=getVoxelFlipBack(id);break;case SURFACE_RIGHT:tile=getVoxelRight(id);flip=getVoxelFlipRight(id);break;case SURFACE_LEFT:tile=getVoxelLeft(id);flip=getVoxelFlipLeft(id);break;case SURFACE_TOP:tile=getVoxelTop(id);flip=getVoxelFlipTop(id);break;case SURFACE_BOTTOM:tile=getVoxelBottom(id);flip=getVoxelFlipBottom(id);break;}}int raycast(const in vec3 rd,const in vec3 ro,inout float len,out vec3 ray,out vec3 mask,out vec3 odist,out vec3 point,out vec3 normal,out ivec3 map){ray=1./rd;vec3 delta=abs(ray);vec3 dray=abs(vec3(length(rd))/rd);ivec3 sray=ivec3(sign(rd));vec3 add=floor(vec3(sray));map=ivec3(floor(ro+0.));vec3 dist=(sign(rd)*(vec3(map)-ro)+(sign(rd)*0.5)+0.5)*dray;int st=0;float dis=min(min(odist.x,odist.y),odist.z);bool isOut=false;bool isHit=false;for(int i=0;i<int(max_draw_distance);i++){vec3 m=floor(max(0.,float(st-1))/delta);dist+=m*dray;map+=ivec3(m)*sray;mask=vec3(lessThanEqual(dist.xyz,min(dist.yzx,dist.zxy)));odist=dist;dist+=mask*dray;map+=ivec3(mask)*sray;st=getDistanceField(map);dis=min(min(odist.x,odist.y),odist.z);isHit=st<1;isOut=len<=dis;if(isHit||isOut){break;}}if(isHit&&!isOut){point=ro+dis/delta*add;len=length(point-ro);normal=normalize(-mask*vec3(sray));}return hasInOfMap(map)?getMapData(map):0;}void getColorEmpty(inout vec3 point,inout ivec3 map,inout vec4 color,inout int object,inout vec3 material,inout vec3 mask){point=vec3(0.);map=ivec3(0.);object=OBJECT_NONE;color=vec4(0.);material=vec3(0.);mask=vec3(0.);}bool getColorVoxel(const in vec2 u,const in vec3 rd,const in vec3 ro,inout int bayer,inout float len,inout vec3 point,inout ivec3 map,inout vec4 color,inout vec3 normal,inout vec3 world,inout int object,inout vec3 material,inout vec3 mask,inout int dimension){vec3 ray;vec3 odist;vec3 p;vec3 n;vec4 col;vec3 pbr;vec3 nor;vec2 flip;vec3 rro=ro;float l=len;int id;do{id=raycast(rd,rro,l,ray,mask,odist,p,n,map);if(id<=VOXEL_EMPTY){break;}dimension=getDimension(odist);int surface=getSurface(dimension,ray);int tile;getVoxelTile(surface,id,tile,flip);int mat=getMaterialID(tile);switch(dimension){case DIMENSION_X:p.x=p.x>float(map.x)+0.5?float(map.x+1)+0.01:float(map.x)-0.01;break;case DIMENSION_Y:p.y=p.y>float(map.y)+0.5?float(map.y+1)+0.01:float(map.y)-0.01;break;case DIMENSION_Z:p.z=p.z>float(map.z)+0.5?float(map.z+1)+0.01:float(map.z)-0.01;break;}vec2 uv=vec2(fract(dimension==DIMENSION_X?p.z:p.x),dimension==DIMENSION_Y?fract(p.z):1.-fract(p.y));uv.x=flip.x<0.?1.-uv.x:uv.x;uv.y=flip.y<0.?1.-uv.y:uv.y;ivec2 pos;if(getTexture(u,uv,mat,bayer,col,pos)){pbr=getPBRData(pos);nor=getNormalData(pos);break;}rro=p+rd*0.1;l=len;}while(true);if(object!=OBJECT_NONE&&l>=len||id<=VOXEL_EMPTY){return false;}world=n;if(world.x!=0.||world.z!=0.){nor.y=-nor.y;}if(world.y<0.||world.z>0.||world.x<0.){nor.x=-nor.x;}nor.xy*=flip;len=l;point=p;object=OBJECT_HIT_VOXEL;color=vec4(col.rgb,1.);normal=blendNormal(world,nor);material=pbr;return true;}vec3 calcDirectionUV_Z(const in vec2 uv){float gggxd=uv.x-0.5;float ggyd=uv.y-0.5;float ggzd=fov;float gggzd=ggzd*dirY.x+ggyd*dirY.y;return normalize(vec3(gggzd*dirX.x-gggxd*dirX.y,ggyd*dirY.x-ggzd*dirY.y,gggxd*dirX.x+gggzd*dirX.y));}vec3 calcDirection(){float xRotRads=direction.x;float yRotRads=direction.y;vec3 dir;float cosY=cos(yRotRads);dir.x=sin(xRotRads)*cosY;dir.y=-sin(yRotRads);dir.z=cos(xRotRads)*cosY;return dir;}vec2 aspectUV(const in vec2 uv,const in vec2 viewport){vec2 u=uv-0.5;u*=viewport/viewport.y;u*=rotate(false);return u+0.5;}bool hasGround(const in vec3 rd,const in vec3 ro,const in float height){float d=-(ro.y-height)/rd.y;d=min(100000.,d);return d>0.;}bool hasShadow(const in vec2 u,const in vec3 rd,const in vec3 ro,inout int bayer,inout float len){vec3 ray;vec3 mask;vec3 odist;vec3 p;vec3 n;ivec3 map;int id=raycast(rd,ro,len,ray,mask,odist,p,n,map);if(id>VOXEL_EMPTY){return true;}vec2 flip;int dimension=getDimension(odist);int surface=getSurface(dimension,ray);int tile;getVoxelTile(surface,id-1,tile,flip);int mat=getMaterialID(tile);switch(dimension){case DIMENSION_X:p.x=p.x>float(map.x)+0.5?float(map.x+1)+0.01:float(map.x)-0.01;break;case DIMENSION_Y:p.y=p.y>float(map.y)+0.5?float(map.y+1)+0.01:float(map.y)-0.01;break;case DIMENSION_Z:p.z=p.z>float(map.z)+0.5?float(map.z+1)+0.01:float(map.z)-0.01;break;}vec2 uv=vec2(fract(dimension==DIMENSION_X?p.z:p.x),dimension==DIMENSION_Y?fract(p.z):1.-fract(p.y));uv.x=flip.x<0.?1.-uv.x:uv.x;uv.y=flip.y<0.?1.-uv.y:uv.y;vec4 col;ivec2 pos;return getTexture(u,uv,mat,bayer,col,pos);}vec2 rsi(const in vec3 ro,const in vec3 rd,const in float sr){float a=dot(rd,rd);float b=2.*dot(rd,ro);float c=dot(ro,ro)-(sr*sr);float d=(b*b)-4.*a*c;float sd=sqrt(d);float a2=2.*a;return vec2((-b-sd),(-b+sd))/(a2);}vec3 atmosphere(vec3 rd,vec3 ro,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g){vec2 p=rsi(ro,rd,rAtmos);if(p.x>p.y){return vec3(0.,0.,0.);}float iStepSize=(rAtmos-rPlanet)/float(iSteps);float iTime=0.;vec3 totalRlh=vec3(0.);vec3 totalMie=vec3(0.);float iOdRlh=0.;float iOdMie=0.;float mu=dot(rd,pSun);float mumu=mu/5.;float gg=g*g;float pRlh=3./(16.*PI)*(1.+mumu);float pMie=3./(8.*PI)*((1.-gg)*(mumu+1.))/(pow(1.+gg-2.*mu*g,1.5)*(2.+gg));for(int i=0;i<iSteps;i++){vec3 iPos=ro+rd*(iTime+iStepSize*0.5);float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=0.;float jOdRlh=0.;float jOdMie=0.;for(int j=0;j<jSteps;j++){vec3 jPos=iPos+pSun*(jTime+jStepSize*0.5);float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}return clamp(iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie),vec3(0.),vec3(1.));}vec3 calcStar(const in vec3 rd){vec3 color=vec3(0.);float size=0.1;vec3 r=normalize(mod(rd,size)-size/2.);vec3 g=floor(r/size);int count=int(rand(dot(g,vec3(25.,570.,553.)))*500.);float x=cos(0.123*float(count)*CIRCLE);float y=(rand(0.231*float(count))-0.5)*2.;float z=sin(0.123*float(count)*CIRCLE);float s=rand(0.312*float(count));float divY=1.-abs(y);vec3 lo=vec3(x*divY,y,z*divY)*15.;float lr=0.75;float len=length(cross(r,lo));color+=len<lr?saturate((1.-(len/lr))*mix(vec3(1.),vec3(0.,0.45,1.),rand(float(count)*0.132))):vec3(0.);return color;}void calcSkybox(const in vec3 rd,const in vec3 ro,out vec3 skybox){vec3 sun=atmosphere(rd,vec3(0.,6372000.,0.)+ro,sun_direction,30.,6361000.,6461000.,SKY_COLOR,0.0002,10000.,3500.,0.999);vec3 moon=global_moon_light<=0.?vec3(0.):(atmosphere(rd,vec3(0.,6372000.,0.)+ro,-sun_direction,30.,6361000.,6461000.,STARY_COLOR,0.0002,10000.,3500.,0.999)+calcStar(normalize(rd*rotate(vec3(0.5,0.5,1.),hour/4.)))*4.)*global_moon_light;skybox=saturate(max(sun+sun+sun,moon));}void getColorBackground(const in vec3 rd,const in vec3 ro,inout float len,inout vec4 albedo,inout vec3 normal,inout vec3 material,inout vec3 point,inout int object){if(hasGround(ro,rd,0.)){vec3 pos=ground(ro,rd,0.001);vec3 n=vec3(0.,1.,0.);len=length(ro-pos);object=OBJECT_HIT_GROUND;point=pos+vec3(0.,0.001,0.);vec3 px=pos*background_noise_size;vec3 py=pos*background_noise_size;switch(background_theme){case BACKGROUND_NOISE:vec3 rab_noise=vec3(noise(px.xz,background_noise_length),0.,noise(py.zx,background_noise_length));float par_noise=max(rab_noise.x,rab_noise.z);albedo=vec4(mix(mix(background_rise_up_color,backgorund_night_up_color,global_moon_light),mix(background_rise_down_color,backgorund_night_down_color,global_moon_light),par_noise),0.);normal=n-rab_noise*rd*0.25;material=mix(backgorund_material_up,background_material_down,par_noise);break;case BACKGROUND_LIQUID:float add_liquid=time/60.;vec3 rab_liquid=mix(vec3(noise(px.xz+add_liquid,background_noise_length),0.,noise(px.zx+add_liquid,background_noise_length)),vec3(noise(py.xz-vec2(add_liquid,-add_liquid),background_noise_length),0.,noise(py.zx-vec2(-add_liquid,add_liquid),background_noise_length)),0.5);float par_liquid=max(rab_liquid.x,rab_liquid.z);albedo=vec4(mix(mix(background_rise_up_color,backgorund_night_up_color,global_moon_light),mix(background_rise_down_color,backgorund_night_down_color,global_moon_light),par_liquid),0.);normal=n-rab_liquid*rd*0.25;material=mix(backgorund_material_up,background_material_down,par_liquid);break;}}else{vec3 skybox;calcSkybox(rd,ro,skybox);len=max_draw_distance;albedo=vec4(skybox,0.);material=vec3(0.);normal=normalize(-rd);object=OBJECT_NONE;point=vec3(0.);}}vec4 voxelAO(const in vec3 pos,const in vec3 d1,const in vec3 d2){vec4 side=vec4(bvec4(max(vec4(0.),vec4(getMapData(pos+d1),getMapData(pos+d2),getMapData(pos-d1),getMapData(pos-d2)))));vec4 corner=vec4(bvec4(max(vec4(0.),vec4(getMapData(pos+d1+d2),getMapData(pos-d1+d2),getMapData(pos-d1-d2),getMapData(pos+d1-d2)))));vec4 ao=vec4(vertexAO(side.xy,corner.x),vertexAO(side.yz,corner.y),vertexAO(side.zw,corner.z),vertexAO(side.wx,corner.w));return ao;}float calcAO(const vec3 rd,const ivec3 map,const in vec3 point,const in vec3 mask){vec4 ambient=voxelAO(vec3(map)-sign(rd)*sign(mask),sign(mask.zxy),sign(mask.yzx));vec2 ambientUV=mod(vec2(dot(sign(mask)*point.yzx,vec3(1.)),dot(sign(mask)*point.zxy,vec3(1.))),vec2(1.));return mix(mix(ambient.z,ambient.w,ambientUV.x),mix(ambient.y,ambient.x,ambientUV.x),ambientUV.y);}float calcSunLighting(const vec3 rd,const in vec3 sun_dir,const in vec3 normal,const in vec3 material,const in vec3 point){return phong(rd,sun_dir,normal,all(equal(material,vec3(0.)))?material:max(vec3(0.01),material))*sun_light_force*global_sun_light;}float calcMoonLighting(const vec3 rd,const in vec3 moon_dir,const in vec3 normal,const in vec3 material,const in vec3 point){return phong(rd,moon_dir,normal,all(equal(material,vec3(0.)))?material:max(vec3(0.01),material))*moon_light_force*global_moon_light;}void calcLighting(inout vec3 rd,inout vec3 ro,const in vec2 u,const in vec3 normal,const in vec3 material,const in vec3 mask,const in int object,const in vec3 point,inout int bayer,out vec3 ll,inout float dist,inout bool isShadow){bool isGround=object==OBJECT_HIT_GROUND;if(global_sun_light>0.){ll=vec3(max(ll,max(global_sun_light,calcSunLighting(rd,sun_direction,normal,material,point))));if(!isGround){float parallel=diffuse(sun_direction,normal);if(parallel<=0.){isShadow=isShadow||true;dist=0.;}else if(is_shadow&&hasShadow(u,sun_direction,point,bayer,dist)){isShadow=isShadow||true;}else{isShadow=isShadow||false;dist=max_draw_distance;}}}if(global_moon_light>0.){ll=vec3(max(ll,max(global_moon_light,calcMoonLighting(rd,-sun_direction,normal,material,point))));if(!isGround){float parallel=diffuse(-sun_direction,normal);if(parallel<=0.){isShadow=isShadow||true;dist=0.;}else if(is_shadow&&hasShadow(u,-sun_direction,point,bayer,dist)){isShadow=isShadow||true;}else{isShadow=isShadow||false;dist=max_draw_distance;}}}}void calcReflection(const in vec2 u,inout float reflectionHide,inout float ref,inout vec3 rd,inout vec3 ro,inout int bayer,inout float ll,inout vec3 dest,inout vec3 bloom){vec3 rdd;vec3 roo;vec3 point;ivec3 map;vec4 albedo;vec3 normal;vec3 world;int object;vec3 material;vec3 mask;float len;for(int i=0;i<reflection_count+1;i++){float l=max_draw_distance;vec3 p;ivec3 m;vec4 c;vec3 n;vec3 w;int o;vec3 mat;vec3 msk;int dimention;bool isFirst=i==0;bool isSky=object==OBJECT_NONE;bool br=false;if(isFirst||!isSky){if(is_dithering&&!hasBayer(u,ref,bayer)){br=true;}else{getColorEmpty(p,m,c,o,mat,msk);if(!getColorVoxel(u,rd,ro,bayer,l,p,m,c,n,w,o,mat,msk,dimention)){getColorBackground(rd,ro,l,c,n,mat,p,o);}}}if(isFirst){ll=l;}else{bool isBright=all(equal(material,vec3(0.)));vec3 color=albedo.rgb;vec3 rl=vec3(0.);bool isNotReflection=isBright||isSky;if(!isNotReflection){vec3 shadow=vec3(1.);float dist=max_draw_distance;float ao=0.;bool isShadow=false;if(!isBright){calcLighting(rdd,roo,u,normal,material,mask,object,point,bayer,shadow,dist,isShadow);if(isShadow&&object==OBJECT_HIT_VOXEL){ao=calcAO(rdd,map,point,mask);}}ao=ao*(1.-material.z);float ll=min(1.-float(isShadow),1.-float(o!=OBJECT_NONE))*max_draw_distance;float cover=saturate(ll/max_draw_distance);float len=length(point-roo);float sh=object==OBJECT_HIT_VOXEL&&(world.z>0.5||world.z<-0.5||world.y<-0.5)?0.:0.375;vec3 lig=min(vec3(1.),shadow.rgb)+max(vec3(0.),shadow.rgb-1.)*(is_dithering?2.:1.);lig*=(1.-float(isShadow));vec3 g=mix(NLIGHT,SLIGHT,max(0.,min(1.,global_sun_light-global_moon_light)));lig=mix(max(vec3(0.),lig+sh+AO_LIGHT),lig,max(lig,vec3(ao)));rl=max(vec3(0.),(lig-1.))*cover;color=is_dithering&&all(equal(shadow.rgb,vec3(0.)))?color:color*mix(SHADOW,g+rl,saturate(lig));}float rr=saturate(ref-max(1.-material.z,material.y));dest=saturate((is_dithering?color:mix(dest,color,ref))+rl*rr);ref=rr;reflectionHide=min(1.,reflectionHide+float(object!=OBJECT_NONE));br=ref<=0.;ref=isNotReflection?0.:ref;}point=p;map=m;albedo=c;normal=n;world=w;object=o;material=mat;mask=msk;len=l;if(br){break;}rdd=rd;roo=ro;rd=normalize(reflect(rd,n));ro=p;}bloom+=dest;}vec2 compactCheckerCoord(const in vec2 uv,const in vec2 coord,const in vec2 resolution){return floor((uv+(1./resolution*vec2(modI(coord.y,2.)==1.,0.)))*resolution)/resolution;}void main(){TEXTURE_RESOLUTION=textureSize(texture_albedo_data,0);TILE_RESOLUTION=MAX_2D_TEXTURE_SIZE-int(modI(float(MAX_2D_TEXTURE_SIZE),float(tile_resolution)));vec2 u=compactCheckerCoord(uv,gl_FragCoord.xy,viewport);vec2 uu=aspectUV(u,resolution);vec2 v=u*resolution;vec3 rd=calcDirectionUV_Z(aspectUV(u,resolution));vec3 ro=position;vec4 mat=textureLod(Material,u,0.);vec3 normal=textureLod(Normal,u,0.).rgb*2.-1.;vec4 world=textureLod(World,u,0.);vec4 location=textureLod(Location,u,0.);vec4 mask=textureLod(Mask,u,0.);vec3 material=mat.rgb;int object=int(floor(mat.w));bool isBright=all(equal(material,vec3(0.)));bool isSky=object==OBJECT_NONE;int bayer=int(world.w);vec3 lig=vec3(1.);bool isShadow=false;float dist=max_draw_distance-location.w;float ao=0.;vec3 reflection=vec3(0.);vec3 clipReflection=vec3(0.);float reflectionHide=0.;if(!isSky&&!isBright&&(!is_dithering||hasBayer(u,0.5,bayer))){calcLighting(rd,ro,u,normal,material,mask.xyz,object,location.xyz,bayer,lig,dist,isShadow);bool isReflection=material.z>0.;if(is_reflection&&isReflection){float ref=1.;vec3 r=normalize(reflect(rd,normal));vec3 ro=location.xyz;float len=isReflection?max_draw_distance:location.w;calcReflection(u,reflectionHide,ref,r,ro,bayer,len,reflection,clipReflection);}}if(isSky){ClipSkybox=textureLod(Albedo,u,0.);}else if(isBright){ClipAlbedo=textureLod(Albedo,u,0.);}else{ClipLighting=vec4(lig,isShadow);}ivec3 map;int dimension=int(mask.w);switch(dimension){case DIMENSION_X:map=ivec3(round(location.x)-(mod(location.x,1.)<0.5?1.:0.),location.y,location.z);break;case DIMENSION_Y:map=ivec3(location.x,round(location.y)-(mod(location.y,1.)<0.5?1.:0.),location.z);break;case DIMENSION_Z:map=ivec3(location.x,location.y,round(location.z)-(mod(location.z,1.)<0.5?1.:0.));break;}if(isShadow&&object==OBJECT_HIT_VOXEL){ao=calcAO(rd,map,location.xyz,mask.xyz);}Lighting=vec4(lig,isShadow);LightingParam=vec4(ao,dist,0.,0.);Reflection=vec4(reflection,reflectionHide);ClipReflection=vec4(clipReflection,reflectionHide);}"},(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i="#version 300 es\n#define FLT_MIN  1.175494351e-38\n#define FLT_MAX  3.402823466e38\n#define FADE_LENGTH  5.0\n#define SHADOW_FOG_LENGTH  10.0\n#define ROUGHNESS_LENGTH  2.5\n#define HASHSCALE  443.8975\n#define QUATER  0.7853981633974483\n#define HALF  1.5707963267948966\n#define PI  3.141592653589793\n#define CIRCLE  6.283185307179586\n#define SHADOW  vec3(0.5)\n#define SLIGHT  vec3(1.0)\n#define NLIGHT  vec3(0.375, 0.375, 0.5)\n#define OBJECT_NONE  0\n#define OBJECT_HIT_GROUND  1\n#define OBJECT_HIT_VOXEL  2\n#define OBJECT_HIT_BILLBOARD  3\n#define OBJECT_HIT_HUD  4\nprecision highp int;precision highp float;precision highp sampler2D;uniform vec2 viewport;uniform vec2 resolution;uniform vec2 buffer_resolution;uniform vec2 lighting_resolution;uniform vec3 position;uniform vec3 direction;uniform sampler2D Lighting;uniform sampler2D LightingParam;uniform sampler2D ClipLighting;uniform sampler2D Reflection;uniform sampler2D ClipReflection;in vec2 uv;layout(location=0)out vec4 StackLighting;layout(location=1)out vec4 StackReflection;layout(location=2)out vec4 StackClipLighting;layout(location=3)out vec4 StackClipReflection;float modI(const in float a,const in float b){float m=a-floor((a+0.5)/b)*b;return floor(m+0.5);}const vec2 offset[3]=vec2[3](vec2(-1,0),vec2(0,1),vec2(0,-1));void createCheckerData(const in vec2 coord,const in vec2 texSize,out float m,out vec2 cd,out bool is){m=texSize.x*2./resolution.x;cd=floor(coord*m);is=int(modI(cd.x,floor(2.*m)))==int(modI(cd.y,floor(2.*m)));}vec4 restoreHalfCheckerboardBuffer(const in sampler2D tex,const in vec2 texSize,const in float m,const in vec2 cd,const in bool is){ivec2 pos=ivec2(floor(max(vec2(0.),cd.xy-vec2(cd.x,0.)/vec2(2.,1.))));vec4 outCol=texelFetch(tex,pos,0);if(is){float div=1.;ivec2 pos1=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[0]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos1),vec2(0.)),lessThan(vec2(pos1),texSize)))){outCol+=texelFetch(tex,pos1,0);div++;}ivec2 pos2=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[1]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos2),vec2(0.)),lessThan(vec2(pos2),texSize)))){outCol+=texelFetch(tex,pos2,0);div++;}ivec2 pos3=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[2]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos3),vec2(0.)),lessThan(vec2(pos3),texSize)))){outCol+=texelFetch(tex,pos3,0);div++;}return outCol/div;}return outCol;}vec4 restoreHalfCheckerboardBufferMax(const in sampler2D tex,const in vec2 texSize,const in float m,const in vec2 cd,const in bool is){ivec2 pos=ivec2(floor(max(vec2(0.),cd.xy-vec2(cd.x,0.)/vec2(2.,1.))));vec4 outCol=texelFetch(tex,pos,0);if(is){float div=1.;ivec2 pos1=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[0]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos1),vec2(0.)),lessThan(vec2(pos1),texSize)))){outCol=max(outCol,texelFetch(tex,pos1,0));}ivec2 pos2=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[1]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos2),vec2(0.)),lessThan(vec2(pos2),texSize)))){outCol=max(outCol,texelFetch(tex,pos2,0));}ivec2 pos3=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[2]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos3),vec2(0.)),lessThan(vec2(pos3),texSize)))){outCol=max(outCol,texelFetch(tex,pos3,0));}return outCol/div;}return outCol;}void main(){vec2 uv=gl_FragCoord.xy/viewport.xy;vec2 u=uv*resolution;float m2;vec2 cd2;bool is2;createCheckerData(u,lighting_resolution,m2,cd2,is2);StackLighting=restoreHalfCheckerboardBuffer(Lighting,lighting_resolution,m2,cd2,is2);StackReflection=restoreHalfCheckerboardBuffer(Reflection,lighting_resolution,m2,cd2,is2);StackClipLighting=restoreHalfCheckerboardBuffer(ClipLighting,lighting_resolution,m2,cd2,is2);StackClipReflection=restoreHalfCheckerboardBuffer(ClipReflection,lighting_resolution,m2,cd2,is2);}"},(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i="#version 300 es\n#define FLT_MIN  1.175494351e-38\n#define FLT_MAX  3.402823466e38\n#define SHADOW_FOG_LENGTH  20.0\n#define ROUGHNESS_LENGTH  2.5\n#define HASHSCALE  443.8975\n#define QUATER  0.7853981633974483\n#define HALF  1.5707963267948966\n#define PI  3.141592653589793\n#define CIRCLE  6.283185307179586\n#define SHADOW  vec3(0.5)\n#define SLIGHT  vec3(1.0)\n#define NLIGHT  vec3(0.375, 0.375, 0.5)\n#define OBJECT_NONE  0\n#define OBJECT_HIT_GROUND  1\n#define OBJECT_HIT_VOXEL  2\n#define OBJECT_HIT_BILLBOARD  3\n#define OBJECT_HIT_HUD  4\n#define saturate(x)clamp(x,0.,1.)\nprecision highp int;precision highp float;precision highp sampler2D;uniform vec2 viewport;uniform vec2 resolution;uniform int MAX_MIPMAP_LEVEL;uniform vec2 buffer_resolution;uniform vec2 lighting_resolution;uniform vec3 position;uniform vec3 direction;uniform vec3 ray_dir_z;uniform float fov;uniform bool is_soft_shadow;uniform bool is_roughness;uniform bool is_dithering;uniform float max_draw_distance;uniform float global_sun_light;uniform float global_moon_light;uniform sampler2D Normal;uniform sampler2D Material;uniform sampler2D Location;uniform sampler2D LightingParam;uniform sampler2D Reflection;uniform sampler2D ClipReflection;uniform sampler2D StackLighting;uniform sampler2D StackClipLighting;uniform sampler2D StackReflection;uniform sampler2D StackClipReflection;in vec2 uv;in vec2 dirX;in vec2 dirY;in vec2 dirZ;in vec2 dirZI;in vec2 dirYY;layout(location=0)out vec4 SoftShadow;layout(location=1)out vec4 SoftShadowParam;layout(location=2)out vec4 Roughness;layout(location=3)out vec4 ClipSoftShadow;layout(location=4)out vec4 ClipRoughness;float modI(const in float a,const in float b){float m=a-floor((a+0.5)/b)*b;return floor(m+0.5);}mat4 setCamera(in vec3 ro,in vec3 rd){vec3 cw=rd;vec3 cp=vec3(0.,1.,0.);vec3 cu=normalize(cross(cw,cp));vec3 cv=normalize(cross(cu,cw));return mat4(cu.x,cu.y,cu.z,0.,cv.x,cv.y,cv.z,0.,cw.x,cw.y,cw.z,0.,ro.x,ro.y,ro.z,1.);}mat4 setCamera(in vec3 ro,in vec3 rd,float rot){vec3 cw=rd;vec3 cp=vec3(sin(rot),cos(rot),0.);vec3 cu=normalize(cross(cw,cp));vec3 cv=normalize(cross(cu,cw));return mat4(cu.x,cu.y,cu.z,0.,cv.x,cv.y,cv.z,0.,cw.x,cw.y,cw.z,0.,ro.x,ro.y,ro.z,1.);}mat2 rotate(const in bool inv){float c=inv?dirZI.x:dirZ.x;float s=inv?dirZI.y:dirZ.y;return mat2(c,-s,s,c);}mat2 rotate(const in float angle){float c=cos(angle);float s=sin(angle);return mat2(c,-s,s,c);}mat3 rotate(const in vec3 axis,const in float angle){vec3 a=normalize(axis);float s=sin(angle);float c=cos(angle);float oc=1.-c;return mat3(oc*a.x*a.x+c,oc*a.x*a.y-a.z*s,oc*a.z*a.x+a.y*s,oc*a.x*a.y+a.z*s,oc*a.y*a.y+c,oc*a.y*a.z-a.x*s,oc*a.z*a.x-a.y*s,oc*a.y*a.z+a.x*s,oc*a.z*a.z+c);}vec3 calcDirectionUV_X(const in vec3 rdY,const in vec3 rdZ){return normalize(cross(rdZ,rdY));}vec3 calcDirectionUV_Y(const in vec2 uv){float gggxd=uv.x-0.5;float ggyd=uv.y-0.5;float ggzd=fov;float gggzd=ggzd*dirYY.x+ggyd*dirYY.y;return normalize(vec3(gggzd*dirX.x-gggxd*dirX.y,ggyd*dirYY.x-ggzd*dirYY.y,gggxd*dirX.x+gggzd*dirX.y));}vec3 calcDirectionUV_Z(const in vec2 uv){float gggxd=uv.x-0.5;float ggyd=uv.y-0.5;float ggzd=fov;float gggzd=ggzd*dirY.x+ggyd*dirY.y;return normalize(vec3(gggzd*dirX.x-gggxd*dirX.y,ggyd*dirY.x-ggzd*dirY.y,gggxd*dirX.x+gggzd*dirX.y));}vec2 aspectUV(const in vec2 uv,const in vec2 viewport){vec2 u=uv-0.5;u*=viewport/viewport.y;u*=rotate(false);return u+0.5;}vec2 compactCheckerCoord(const in vec2 uv,const in vec2 coord,const in vec2 resolution){return floor((uv+(1./resolution*vec2(modI(coord.y,2.)==1.,0.)))*resolution)/resolution;}void softShadow(const in vec3 ro,const in vec2 u,const in vec3 loc,const in int object,const in vec3 material,out vec4 shadowParam,out vec4 shadowCol,out vec4 clipShadowCol){vec4 ligP=textureLod(LightingParam,uv,0.);vec3 p=loc-ro;float cz=dot(p,ray_dir_z);float fix=2.*fov;float rad=saturate(ligP.y/SHADOW_FOG_LENGTH);float shadowLevel=float(MAX_MIPMAP_LEVEL)/2.5;float blurLevel=min(1.,rad*(5.*min(5.+5.*(1.-global_sun_light),5.+5.*(1.-global_moon_light)))/cz*fix);float softLevel=shadowLevel*blurLevel;softLevel=is_dithering?max(softLevel,1.):softLevel;float level=is_dithering?1.:0.;vec4 lig=textureLod(StackLighting,u,level);vec4 clig=textureLod(StackClipLighting,u,level);vec4 ll=textureLod(StackLighting,u,softLevel);vec4 cll=textureLod(StackClipLighting,u,softLevel);float cover=saturate(1.-ll.w);float ccover=saturate(1.-cll.w);vec4 l=mix(vec4(cover),max(lig,vec4(vec3(cover),ll.w)),cover);vec4 cl=mix(vec4(ccover),max(clig,vec4(vec3(ccover),cll.w)),ccover);shadowParam=ligP;shadowCol=l;clipShadowCol=cl;}void main(){vec2 u=compactCheckerCoord(uv,gl_FragCoord.xy,viewport);vec2 uu=aspectUV(u,resolution);vec3 ro=position;vec2 v=u*resolution;vec4 mat=textureLod(Material,u,0.);vec4 location=textureLod(Location,u,0.);vec3 material=mat.rgb;int object=int(floor(mat.w));if(is_roughness){float roughness=material.y;float rad=saturate(roughness);float level=float(MAX_MIPMAP_LEVEL)*rad;level=is_dithering?max(1.,level):level;Roughness=textureLod(StackReflection,uv,level);ClipRoughness=textureLod(StackClipReflection,uv,level);}if(is_soft_shadow){vec4 shadowParam;vec4 softShadowCol;vec4 clipSoftShadowCol;softShadow(ro,u,location.xyz,object,material,shadowParam,softShadowCol,clipSoftShadowCol);SoftShadowParam=shadowParam;SoftShadow=softShadowCol;ClipSoftShadow=clipSoftShadowCol;}}"},(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i="#version 300 es\n#define FLT_MIN  1.175494351e-38\n#define FLT_MAX  3.402823466e38\n#define AO_LIGHT  vec3(0.03125)\n#define FADE_LENGTH  5.0\n#define QUATER  0.7853981633974483\n#define HALF  1.5707963267948966\n#define PI  3.141592653589793\n#define CIRCLE  6.283185307179586\n#define SHADOW  vec3(0.25)\n#define SLIGHT  vec3(1.0)\n#define NLIGHT  vec3(0.375, 0.375, 0.5)\n#define OBJECT_NONE  0\n#define OBJECT_HIT_GROUND  1\n#define OBJECT_HIT_VOXEL  2\n#define OBJECT_HIT_BILLBOARD  3\n#define OBJECT_HIT_HUD  4\n#define saturate(x)clamp(x,0.,1.)\nprecision highp int;precision highp float;precision highp sampler2D;uniform vec2 viewport;uniform vec2 resolution;uniform int MAX_MIPMAP_LEVEL;uniform vec2 buffer_resolution;uniform vec2 lighting_resolution;uniform vec3 position;uniform vec3 direction;uniform vec3 ray_dir_z;uniform float fov;uniform bool is_soft_shadow;uniform bool is_roughness;uniform bool is_dithering;uniform float global_sun_light;uniform float global_moon_light;uniform int reflection_count;uniform int tile_resolution;uniform float max_draw_distance;uniform sampler2D Material;uniform sampler2D Location;uniform sampler2D World;uniform sampler2D Roughness;uniform sampler2D ClipAlbedo;uniform sampler2D ClipSkybox;uniform sampler2D ClipSoftShadow;uniform sampler2D ClipRoughness;uniform sampler2D SoftShadowParam;in vec2 uv;in vec2 dirX;in vec2 dirY;in vec2 dirZ;in vec2 dirZI;in vec2 dirYY;layout(location=0)out vec4 StackBloom;float modI(const in float a,const in float b){float m=a-floor((a+0.5)/b)*b;return floor(m+0.5);}vec3 schlick(const in vec3 f0,const in float product){return f0+(1.-f0)*pow((1.-product),5.);}mat2 rotate(){float c=dirZ.x;float s=dirZ.y;return mat2(c,-s,s,c);}mat2 rotate(const in bool inv){float c=inv?dirZI.x:dirZ.x;float s=inv?dirZI.y:dirZ.y;return mat2(c,-s,s,c);}mat2 rotate(const in float angle){float c=cos(angle);float s=sin(angle);return mat2(c,-s,s,c);}mat3 rotate(const in vec3 axis,const in float angle){vec3 a=normalize(axis);float s=sin(angle);float c=cos(angle);float oc=1.-c;return mat3(oc*a.x*a.x+c,oc*a.x*a.y-a.z*s,oc*a.z*a.x+a.y*s,oc*a.x*a.y+a.z*s,oc*a.y*a.y+c,oc*a.y*a.z-a.x*s,oc*a.z*a.x-a.y*s,oc*a.y*a.z+a.x*s,oc*a.z*a.z+c);}vec3 calcDirection(){float xRotRads=direction.x;float yRotRads=direction.y;vec3 dir;float cosY=cos(yRotRads);dir.x=sin(xRotRads)*cosY;dir.y=-sin(yRotRads);dir.z=cos(xRotRads)*cosY;return dir;}vec2 project(const in vec3 point,const in mat4 cam,const in float fov){vec3 o=(cam*vec4(point,1.)).xyz;float z2=o.z*o.z;return fov*o.z*o.xy/z2;}mat4 setCamera(in vec3 ro,in vec3 rd){vec3 cw=rd;vec3 cp=vec3(0.,1.,0.);vec3 cu=normalize(cross(cw,cp));vec3 cv=normalize(cross(cu,cw));return mat4(cu.x,cu.y,cu.z,0.,cv.x,cv.y,cv.z,0.,cw.x,cw.y,cw.z,0.,ro.x,ro.y,ro.z,1.);}mat4 setCamera(in vec3 ro,in vec3 rd,float rot){vec3 cw=rd;vec3 cp=vec3(sin(rot),cos(rot),0.);vec3 cu=normalize(cross(cw,cp));vec3 cv=normalize(cross(cu,cw));return mat4(cu.x,cu.y,cu.z,0.,cv.x,cv.y,cv.z,0.,cw.x,cw.y,cw.z,0.,ro.x,ro.y,ro.z,1.);}vec2 aspectUV(const in vec2 uv,const in vec2 viewport){vec2 u=uv-0.5;u*=viewport/viewport.y;u*=rotate();return u+0.5;}const vec2 offset[3]=vec2[3](vec2(-1,0),vec2(0,1),vec2(0,-1));void createCheckerData(const in vec2 coord,const in vec2 texSize,out float m,out vec2 cd,out bool is){m=texSize.x*2./resolution.x;cd=floor(coord*m);is=int(modI(cd.x,floor(2.*m)))==int(modI(cd.y,floor(2.*m)));}vec4 restoreHalfCheckerboardBuffer(const in sampler2D tex,const in vec2 texSize,const in float m,const in vec2 cd,const in bool is){ivec2 pos=ivec2(floor(max(vec2(0.),cd.xy-vec2(cd.x,0.)/vec2(2.,1.))));vec4 outCol=texelFetch(tex,pos,0);if(is){float div=1.;ivec2 pos1=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[0]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos1),vec2(0.)),lessThan(vec2(pos1),texSize)))){outCol+=texelFetch(tex,pos1,0);div++;}ivec2 pos2=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[1]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos2),vec2(0.)),lessThan(vec2(pos2),texSize)))){outCol+=texelFetch(tex,pos2,0);div++;}ivec2 pos3=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[2]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos3),vec2(0.)),lessThan(vec2(pos3),texSize)))){outCol+=texelFetch(tex,pos3,0);div++;}return outCol/div;}return outCol;}vec4 restoreHalfCheckerboardBufferMax(const in sampler2D tex,const in vec2 texSize,const in float m,const in vec2 cd,const in bool is){ivec2 pos=ivec2(floor(max(vec2(0.),cd.xy-vec2(cd.x,0.)/vec2(2.,1.))));vec4 outCol=texelFetch(tex,pos,0);if(is){float div=1.;ivec2 pos1=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[0]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos1),vec2(0.)),lessThan(vec2(pos1),texSize)))){outCol=max(outCol,texelFetch(tex,pos1,0));}ivec2 pos2=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[1]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos2),vec2(0.)),lessThan(vec2(pos2),texSize)))){outCol=max(outCol,texelFetch(tex,pos2,0));}ivec2 pos3=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[2]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos3),vec2(0.)),lessThan(vec2(pos3),texSize)))){outCol=max(outCol,texelFetch(tex,pos3,0));}return outCol/div;}return outCol;}vec3 bloom(const in vec2 uv){vec2 u=uv*resolution;float m1;vec2 cd1;bool is1;createCheckerData(u,buffer_resolution,m1,cd1,is1);float m2;vec2 cd2;bool is2;createCheckerData(u,lighting_resolution,m2,cd2,is2);vec4 mat=restoreHalfCheckerboardBuffer(Material,buffer_resolution,m1,cd1,is1);int object=int(floor(mat.w));bool isSky=object==OBJECT_NONE;bool isNone=object==OBJECT_NONE;bool isBright=all(equal(mat.rgb,vec3(0.)));if(!isSky&&isBright){return restoreHalfCheckerboardBuffer(ClipAlbedo,lighting_resolution,m2,cd2,is2).rgb;}else{vec3 material=restoreHalfCheckerboardBuffer(Material,buffer_resolution,m1,cd1,is1).rgb;vec3 world=restoreHalfCheckerboardBuffer(World,buffer_resolution,m1,cd1,is1).xyz*2.-1.;vec4 location=restoreHalfCheckerboardBuffer(Location,buffer_resolution,m1,cd1,is1);vec4 skybox=restoreHalfCheckerboardBuffer(ClipSkybox,lighting_resolution,m2,cd2,is2);vec4 albedo=restoreHalfCheckerboardBuffer(ClipAlbedo,lighting_resolution,m2,cd2,is2);vec4 shadow=restoreHalfCheckerboardBuffer(ClipSoftShadow,lighting_resolution,m2,cd2,is2);vec3 shadowparam=restoreHalfCheckerboardBuffer(SoftShadowParam,lighting_resolution,m2,cd2,is2).xyz;vec4 reflection=restoreHalfCheckerboardBuffer(ClipRoughness,lighting_resolution,m2,cd2,is2);vec3 color=albedo.rgb;vec3 ro=position;float ao=shadowparam.x*(1.-material.z);vec3 point=location.xyz;float ll=min(1.-shadow.w,1.-reflection.w)*max_draw_distance;float roughness=material.y;float rad=saturate(roughness);float level=float(MAX_MIPMAP_LEVEL)*rad;level=is_dithering?max(1.,level):level;color=(reflection_count>0?mix(color,reflection.rgb,!is_dithering||level>0.?vec3(material.z):sign(reflection.rgb)):color);float cover=saturate(ll/max_draw_distance);float len=length(point-ro);float sh=object==OBJECT_HIT_VOXEL&&(world.z>0.5||world.z<-0.5||world.y<-0.5)?0.:0.375;vec3 lig=min(vec3(1.),shadow.rgb)+max(vec3(0.),shadow.rgb-1.)*(is_dithering?2.:1.);lig*=(is_soft_shadow?1.-float(shadow.w):1.);vec3 g=mix(NLIGHT,SLIGHT,max(0.,min(1.,global_sun_light-global_moon_light)));bool isBright=all(equal(material,vec3(0.)));lig=mix(max(vec3(0.),lig+sh+AO_LIGHT),lig,max(lig,vec3(ao)));if(!isBright){vec3 rl=max(vec3(0.),(lig-1.))*cover;color=is_dithering&&all(equal(shadow.rgb,vec3(0.)))?color:color*mix(SHADOW,g+rl,saturate(lig));color+=rl;}color=object==OBJECT_NONE?skybox.rgb:color;return color;}}void main(){vec2 u=gl_FragCoord.xy/viewport.xy;vec3 color=bloom(u);StackBloom=vec4(color,0.);}"},(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i="#version 300 es\n#define FLT_MIN  1.175494351e-38\n#define FLT_MAX  3.402823466e38\n#define FADE_LENGTH  5.0\n#define QUATER  0.7853981633974483\n#define HALF  1.5707963267948966\n#define PI  3.141592653589793\n#define CIRCLE  6.283185307179586\n#define SHADOW  vec3(0.25)\n#define SLIGHT  vec3(1.0)\n#define NLIGHT  vec3(0.375, 0.375, 0.5)\n#define OBJECT_NONE  0\n#define OBJECT_HIT_GROUND  1\n#define OBJECT_HIT_VOXEL  2\n#define OBJECT_HIT_BILLBOARD  3\n#define OBJECT_HIT_HUD  4\nprecision highp int;precision highp float;precision highp sampler2D;uniform vec2 viewport;uniform vec2 resolution;uniform int MAX_MIPMAP_LEVEL;uniform vec3 direction;uniform sampler2D Material;uniform sampler2D StackBloom;in vec2 uv;in vec2 dirX;in vec2 dirY;in vec2 dirZ;layout(location=0)out vec4 Bloom;float modI(const in float a,const in float b){float m=a-floor((a+0.5)/b)*b;return floor(m+0.5);}mat2 rotate(){float c=dirZ.x;float s=dirZ.y;return mat2(c,-s,s,c);}vec3 calcDirection(){float xRotRads=direction.x;float yRotRads=direction.y;vec3 dir;float cosY=cos(yRotRads);dir.x=sin(xRotRads)*cosY;dir.y=-sin(yRotRads);dir.z=cos(xRotRads)*cosY;return dir;}vec2 aspectUV(const in vec2 uv,const in vec2 viewport){vec2 u=uv-0.5;u*=viewport/viewport.y;u*=rotate();return u+0.5;}vec2 compactCheckerCoord(const in vec2 uv,const in vec2 coord,const in vec2 resolution){return round((uv+(1./resolution*vec2(modI(coord.y,2.)==1.,0.)))*resolution)/resolution;}float weight(const in float t,const in float log2radius,const in float gamma){return exp(-gamma*pow(log2radius-t,2.));}void main(){vec2 u=compactCheckerCoord(uv,gl_FragCoord.xy,viewport);float level=float(MAX_MIPMAP_LEVEL)-1.;vec3 color=(textureLod(StackBloom,u,level/3.*0.).rgb+textureLod(StackBloom,u,level/3.*1.).rgb+textureLod(StackBloom,u,level/3.*2.).rgb+textureLod(StackBloom,u,level/3.*3.).rgb)/4.;Bloom=vec4(color,0.);}"},(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i="#version 300 es\n#define FLT_MIN  1.175494351e-38\n#define FLT_MAX  3.402823466e38\n#define AO_LIGHT  vec3(0.03125)\n#define FADE_LENGTH  5.0\n#define QUATER  0.7853981633974483\n#define HALF  1.5707963267948966\n#define PI  3.141592653589793\n#define CIRCLE  6.283185307179586\n#define SHADOW  vec3(0.25)\n#define SLIGHT  vec3(1.0)\n#define NLIGHT  vec3(0.375, 0.375, 0.5)\n#define OBJECT_NONE  0\n#define OBJECT_HIT_GROUND  1\n#define OBJECT_HIT_VOXEL  2\n#define OBJECT_HIT_BILLBOARD  3\n#define OBJECT_HIT_HUD  4\n#define iSteps  3\n#define jSteps  1\n#define saturate(x)clamp(x,0.,1.)\nprecision highp int;precision highp float;precision highp sampler2D;uniform vec2 viewport;uniform vec2 resolution;uniform int MAX_MIPMAP_LEVEL;uniform vec2 buffer_resolution;uniform vec2 lighting_resolution;uniform float contrast;uniform float brightness;uniform float global_sun_light;uniform float global_moon_light;uniform int reflection_count;uniform bool is_soft_shadow;uniform bool is_roughness;uniform float bloom_force;uniform vec3 position;uniform vec3 direction;uniform vec3 ray_dir_z;uniform vec3 sun_direction;uniform float fov;uniform int tile_resolution;uniform float max_draw_distance;uniform bool is_dithering;uniform sampler2D Albedo;uniform sampler2D Normal;uniform sampler2D Material;uniform sampler2D Location;uniform sampler2D World;uniform sampler2D SoftShadow;uniform sampler2D SoftShadowParam;uniform sampler2D Roughness;uniform sampler2D Bloom;in vec2 uv;in vec2 dirX;in vec2 dirY;in vec2 dirZ;in vec2 dirZI;in vec2 dirYY;out vec4 dest;const float a=2.51;const float b=0.03;const float c=2.43;const float d=0.59;const float e=0.14;float modI(const in float a,const in float b){float m=a-floor((a+0.5)/b)*b;return floor(m+0.5);}mat2 rotate(){float c=dirZ.x;float s=dirZ.y;return mat2(c,-s,s,c);}mat2 rotate(const in bool inv){float c=inv?dirZI.x:dirZ.x;float s=inv?dirZI.y:dirZ.y;return mat2(c,-s,s,c);}mat2 rotate(const in float angle){float c=cos(angle);float s=sin(angle);return mat2(c,-s,s,c);}mat3 rotate(const in vec3 axis,const in float angle){vec3 a=normalize(axis);float s=sin(angle);float c=cos(angle);float oc=1.-c;return mat3(oc*a.x*a.x+c,oc*a.x*a.y-a.z*s,oc*a.z*a.x+a.y*s,oc*a.x*a.y+a.z*s,oc*a.y*a.y+c,oc*a.y*a.z-a.x*s,oc*a.z*a.x-a.y*s,oc*a.y*a.z+a.x*s,oc*a.z*a.z+c);}vec2 aspectUV(const in vec2 uv,const in vec2 viewport){vec2 u=uv-0.5;u*=viewport/viewport.y;u*=rotate();return u+0.5;}bool hasGround(const in vec3 rd,const in vec3 ro,const in float height){float d=-(ro.y-height)/rd.y;d=min(100000.,d);return d>0.;}vec3 toneMapping(const in vec3 x){return(x*(a*x+b))/(x*(c*x+d)+e);}vec3 calcDirectionUV(const in vec2 uv){float gggxd=uv.x-0.5;float ggyd=uv.y-0.5;float ggzd=fov;float gggzd=ggzd*dirY.x+ggyd*dirY.y;return normalize(vec3(gggzd*dirX.x-gggxd*dirX.y,ggyd*dirY.x-ggzd*dirY.y,gggxd*dirX.x+gggzd*dirX.y));}vec3 calcDirection(){float xRotRads=direction.x;float yRotRads=direction.y;vec3 dir;float cosY=cos(yRotRads);dir.x=sin(xRotRads)*cosY;dir.y=-sin(yRotRads);dir.z=cos(xRotRads)*cosY;return dir;}vec2 project(const in vec3 point,const in mat4 cam,const in float fov){vec3 o=(cam*vec4(point,1.)).xyz;float z2=o.z*o.z;return fov*o.z*o.xy/z2;}mat4 setCamera(in vec3 ro,in vec3 rd){vec3 cw=rd;vec3 cp=vec3(0.,1.,0.);vec3 cu=normalize(cross(cw,cp));vec3 cv=normalize(cross(cu,cw));return mat4(cu.x,cu.y,cu.z,0.,cv.x,cv.y,cv.z,0.,cw.x,cw.y,cw.z,0.,ro.x,ro.y,ro.z,1.);}mat4 setCamera(in vec3 ro,in vec3 rd,float rot){vec3 cw=rd;vec3 cp=vec3(sin(rot),cos(rot),0.);vec3 cu=normalize(cross(cw,cp));vec3 cv=normalize(cross(cu,cw));return mat4(cu.x,cu.y,cu.z,0.,cv.x,cv.y,cv.z,0.,cw.x,cw.y,cw.z,0.,ro.x,ro.y,ro.z,1.);}const vec2 offset[3]=vec2[3](vec2(-1,0),vec2(0,1),vec2(0,-1));void createCheckerData(const in vec2 coord,const in vec2 texSize,out float m,out vec2 cd,out bool is){m=texSize.x*2./resolution.x;cd=floor(coord*m);is=int(modI(cd.x,floor(2.*m)))==int(modI(cd.y,floor(2.*m)));}vec4 restoreHalfCheckerboardBuffer(const in sampler2D tex,const in vec2 texSize,const in float m,const in vec2 cd,const in bool is){ivec2 pos=ivec2(floor(max(vec2(0.),cd.xy-vec2(cd.x,0.)/vec2(2.,1.))));vec4 outCol=texelFetch(tex,pos,0);if(is){float div=1.;ivec2 pos1=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[0]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos1),vec2(0.)),lessThan(vec2(pos1),texSize)))){outCol+=texelFetch(tex,pos1,0);div++;}ivec2 pos2=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[1]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos2),vec2(0.)),lessThan(vec2(pos2),texSize)))){outCol+=texelFetch(tex,pos2,0);div++;}ivec2 pos3=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[2]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos3),vec2(0.)),lessThan(vec2(pos3),texSize)))){outCol+=texelFetch(tex,pos3,0);div++;}return outCol/div;}return outCol;}vec4 restoreHalfCheckerboardBufferMax(const in sampler2D tex,const in vec2 texSize,const in float m,const in vec2 cd,const in bool is){ivec2 pos=ivec2(floor(max(vec2(0.),cd.xy-vec2(cd.x,0.)/vec2(2.,1.))));vec4 outCol=texelFetch(tex,pos,0);if(is){float div=1.;ivec2 pos1=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[0]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos1),vec2(0.)),lessThan(vec2(pos1),texSize)))){outCol=max(outCol,texelFetch(tex,pos1,0));}ivec2 pos2=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[1]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos2),vec2(0.)),lessThan(vec2(pos2),texSize)))){outCol=max(outCol,texelFetch(tex,pos2,0));}ivec2 pos3=ivec2(floor(max(vec2(0.),cd.xy-(vec2(cd.x,0.)+offset[2]*vec2(m,1.))/vec2(2.,1.))));if(all(bvec4(greaterThanEqual(vec2(pos3),vec2(0.)),lessThan(vec2(pos3),texSize)))){outCol=max(outCol,texelFetch(tex,pos3,0));}return outCol/div;}return outCol;}void main(){vec2 u=uv*resolution;float m1;vec2 cd1;bool is1;createCheckerData(u,buffer_resolution,m1,cd1,is1);vec4 albedo=restoreHalfCheckerboardBuffer(Albedo,buffer_resolution,m1,cd1,is1);vec4 mat=restoreHalfCheckerboardBuffer(Material,buffer_resolution,m1,cd1,is1);vec3 normal=restoreHalfCheckerboardBuffer(Normal,buffer_resolution,m1,cd1,is1).xyz*2.-1.;vec3 world=restoreHalfCheckerboardBuffer(World,buffer_resolution,m1,cd1,is1).xyz*2.-1.;vec4 location=restoreHalfCheckerboardBuffer(Location,buffer_resolution,m1,cd1,is1);float m2;vec2 cd2;bool is2;createCheckerData(u,lighting_resolution,m2,cd2,is2);vec4 shadow=restoreHalfCheckerboardBuffer(SoftShadow,lighting_resolution,m2,cd2,is2);vec3 shadowparam=restoreHalfCheckerboardBuffer(SoftShadowParam,lighting_resolution,m2,cd2,is2).xyz;vec3 bloom=restoreHalfCheckerboardBuffer(Bloom,lighting_resolution,m2,cd2,is2).rgb;vec4 reflection=restoreHalfCheckerboardBuffer(Roughness,lighting_resolution,m2,cd2,is2);vec3 color=albedo.rgb;vec3 material=mat.rgb;int object=int(floor(mat.w));bool isSky=object==OBJECT_NONE;bool isBright=all(equal(material,vec3(0.)));if(!isSky&&!isBright){vec3 rd=calcDirectionUV(aspectUV(uv,resolution));vec3 ro=position;float ao=shadowparam.x*(1.-material.z);vec3 point=location.xyz;float ll=min(1.-shadow.w,1.-reflection.w)*max_draw_distance;float roughness=material.y;float rad=saturate(roughness);float level=float(MAX_MIPMAP_LEVEL)*rad;level=is_dithering?max(1.,level):level;float cover=saturate(ll/max_draw_distance);float len=length(point-ro);float sh=object==OBJECT_HIT_VOXEL&&(world.z>0.5||world.z<-0.5||world.y<-0.5)?0.:0.375;vec3 lig=min(vec3(1.),shadow.rgb)+max(vec3(0.),shadow.rgb-1.)*(is_dithering?2.:1.);lig*=(is_soft_shadow?1.-float(shadow.w):1.);vec3 g=mix(NLIGHT,SLIGHT,max(0.,min(1.,global_sun_light-global_moon_light)));lig=mix(max(vec3(0.),lig+sh+AO_LIGHT),lig,max(lig,vec3(ao)));vec3 rl=max(vec3(0.),(lig-1.))*cover;color=is_dithering&&all(equal(shadow.rgb,vec3(0.)))?color:color*mix(SHADOW,g+rl,saturate(lig));color=(reflection_count>0?mix(color,reflection.rgb,!is_dithering||level>0.?vec3(min(material.z,1.-material.y)):sign(reflection.rgb)):color);color+=rl;}color+=bloom*bloom_force;color=toneMapping(clamp(color,vec3(0.),vec3(1.)));color*=contrast;color+=color*(brightness-1.);dest=vec4(color,1.);}"},(e,t,n)=>{"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{a:()=>r});class r{constructor(e,t,n){i(this,"src",void 0),i(this,"bounding",void 0),i(this,"index",void 0),this.src=e,this.bounding=t,this.index=n}}},(e,t,n)=>{"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{a:()=>r});class r{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;i(this,"color",void 0),i(this,"invert",void 0),this.color=e,this.invert=null===t?[1-e[0],1-e[1],1-e[2]]:t}getColor(){return this.color}getInvertColor(){return this.invert}}},(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i=[30,60,144,240]}],o={};function a(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}};return r[e].call(n.exports,n,n.exports,a),n.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",n="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",i=e=>{e&&!e.d&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},a.a=(r,o,a)=>{var s;a&&((s=[]).d=1);var l,c,u,d=new Set,h=r.exports,f=new Promise(((e,t)=>{u=t,c=e}));f[t]=h,f[e]=e=>(s&&e(s),d.forEach(e),f.catch((e=>{}))),r.exports=f,o((r=>{var o;l=(r=>r.map((r=>{if(null!==r&&"object"==typeof r){if(r[e])return r;if(r.then){var o=[];o.d=0,r.then((e=>{a[t]=e,i(o)}),(e=>{a[n]=e,i(o)}));var a={};return a[e]=e=>e(o),a}}var s={};return s[e]=e=>{},s[t]=r,s})))(r);var a=()=>l.map((e=>{if(e[n])throw e[n];return e[t]})),c=new Promise((t=>{(o=()=>t(a)).r=0;var n=e=>e!==s&&!d.has(e)&&(d.add(e),e&&!e.d&&(o.r++,e.push(o)));l.map((t=>t[e](n)))}));return o.r?c:a()}),(e=>(e?u(f[n]=e):c(h),i(s)))),s&&(s.d=0)},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};a(214)})();