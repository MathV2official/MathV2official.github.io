(function () {var t,e;function n(t,e){this.times=t||[],this.values=e||[]}function r(){this.position=new THREE.Vector3,this.velocity=new THREE.Vector3,this.acceleration=new THREE.Vector3,this.angle=0,this.angleVelocity=0,this.angleAcceleration=0,this.size=16,this.color=new THREE.Color,this.opacity=1,this.age=0,this.alive=0}window.Choices=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/public/assets/scripts/",n(n.s=4)}([function(t,e,n){"use strict";var r=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===i}(t)}(t)},i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function o(t,e){return!1!==e.clone&&e.isMergeableObject(t)?l((n=t,Array.isArray(n)?[]:{}),t,e):t;var n}function a(t,e,n){return t.concat(e).map(function(t){return o(t,n)})}function s(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return t.propertyIsEnumerable(e)}):[]}(t))}function l(t,e,n){(n=n||{}).arrayMerge=n.arrayMerge||a,n.isMergeableObject=n.isMergeableObject||r,n.cloneUnlessOtherwiseSpecified=o;var i=Array.isArray(e);return i===Array.isArray(t)?i?n.arrayMerge(t,e,n):function(t,e,n){var r={};return n.isMergeableObject(t)&&s(t).forEach(function(e){r[e]=o(t[e],n)}),s(e).forEach(function(i){(function(t,e){try{return e in t&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))}catch(t){return!1}})(t,i)||(n.isMergeableObject(e[i])&&t[i]?r[i]=function(t,e){if(!e.customMerge)return l;var n=e.customMerge(t);return"function"==typeof n?n:l}(i,n)(t[i],e[i],n):r[i]=o(e[i],n))}),r}(t,e,n):o(e,n)}l.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(t,n){return l(t,n,e)},{})};var c=l;t.exports=c},function(t,e,n){"use strict";(function(t,r){var i,o=n(3);i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:r;var a=Object(o.a)(i);e.a=a}).call(this,n(5),n(6)(t))},function(t,e,n){t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){t.exports=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(2),o=n(8),a=n(0),s=function(){function t(e,n){var r=n.location,i=void 0===r?0:r,a=n.distance,s=void 0===a?100:a,l=n.threshold,c=void 0===l?.6:l,u=n.maxPatternLength,p=void 0===u?32:u,d=n.caseSensitive,h=void 0!==d&&d,f=n.tokenSeparator,m=void 0===f?/ +/g:f,y=n.findAllMatches,_=void 0!==y&&y,g=n.minMatchCharLength,v=void 0===g?1:g,b=n.id,x=void 0===b?null:b,w=n.keys,E=void 0===w?[]:w,T=n.shouldSort,S=void 0===T||T,M=n.getFn,j=void 0===M?o:M,C=n.sortFn,z=void 0===C?function(t,e){return t.score-e.score}:C,R=n.tokenize,A=void 0!==R&&R,L=n.matchAllTokens,I=void 0!==L&&L,P=n.includeMatches,O=void 0!==P&&P,k=n.includeScore,B=void 0!==k&&k,D=n.verbose,H=void 0!==D&&D;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options={location:i,distance:s,threshold:c,maxPatternLength:p,isCaseSensitive:h,tokenSeparator:m,findAllMatches:_,minMatchCharLength:v,id:x,keys:E,includeMatches:O,includeScore:B,shouldSort:S,getFn:j,sortFn:z,verbose:H,tokenize:A,matchAllTokens:I},this.setCollection(e)}var e;return(e=[{key:"setCollection",value:function(t){return this.list=t,t}},{key:"search",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{limit:!1};this._log('---------\nSearch pattern: "'.concat(t,'"'));var n=this._prepareSearchers(t),r=n.tokenSearchers,i=n.fullSearcher,o=this._search(r,i),a=o.weights,s=o.results;return this._computeScore(a,s),this.options.shouldSort&&this._sort(s),e.limit&&"number"==typeof e.limit&&(s=s.slice(0,e.limit)),this._format(s)}},{key:"_prepareSearchers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=[];if(this.options.tokenize)for(var n=t.split(this.options.tokenSeparator),r=0,o=n.length;r<o;r+=1)e.push(new i(n[r],this.options));return{tokenSearchers:e,fullSearcher:new i(t,this.options)}}},{key:"_search",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0,n=this.list,r={},i=[];if("string"==typeof n[0]){for(var o=0,a=n.length;o<a;o+=1)this._analyze({key:"",value:n[o],record:o,index:o},{resultMap:r,results:i,tokenSearchers:t,fullSearcher:e});return{weights:null,results:i}}for(var s={},l=0,c=n.length;l<c;l+=1)for(var u=n[l],p=0,d=this.options.keys.length;p<d;p+=1){var h=this.options.keys[p];if("string"!=typeof h){if(s[h.name]={weight:1-h.weight||1},h.weight<=0||h.weight>1)throw new Error("Key weight has to be > 0 and <= 1");h=h.name}else s[h]={weight:1};this._analyze({key:h,value:this.options.getFn(u,h),record:u,index:l},{resultMap:r,results:i,tokenSearchers:t,fullSearcher:e})}return{weights:s,results:i}}},{key:"_analyze",value:function(t,e){var n=t.key,r=t.arrayIndex,i=void 0===r?-1:r,o=t.value,s=t.record,l=t.index,c=e.tokenSearchers,u=void 0===c?[]:c,p=e.fullSearcher,d=void 0===p?[]:p,h=e.resultMap,f=void 0===h?{}:h,m=e.results,y=void 0===m?[]:m;if(null!=o){var _=!1,g=-1,v=0;if("string"==typeof o){this._log("\nKey: ".concat(""===n?"-":n));var b=d.search(o);if(this._log('Full text: "'.concat(o,'", score: ').concat(b.score)),this.options.tokenize){for(var x=o.split(this.options.tokenSeparator),w=[],E=0;E<u.length;E+=1){var T=u[E];this._log('\nPattern: "'.concat(T.pattern,'"'));for(var S=!1,M=0;M<x.length;M+=1){var j=x[M],C=T.search(j),z={};C.isMatch?(z[j]=C.score,_=!0,S=!0,w.push(C.score)):(z[j]=1,this.options.matchAllTokens||w.push(1)),this._log('Token: "'.concat(j,'", score: ').concat(z[j]))}S&&(v+=1)}g=w[0];for(var R=w.length,A=1;A<R;A+=1)g+=w[A];g/=R,this._log("Token score average:",g)}var L=b.score;g>-1&&(L=(L+g)/2),this._log("Score average:",L);var I=!this.options.tokenize||!this.options.matchAllTokens||v>=u.length;if(this._log("\nCheck Matches: ".concat(I)),(_||b.isMatch)&&I){var P=f[l];P?P.output.push({key:n,arrayIndex:i,value:o,score:L,matchedIndices:b.matchedIndices}):(f[l]={item:s,output:[{key:n,arrayIndex:i,value:o,score:L,matchedIndices:b.matchedIndices}]},y.push(f[l]))}}else if(a(o))for(var O=0,k=o.length;O<k;O+=1)this._analyze({key:n,arrayIndex:O,value:o[O],record:s,index:l},{resultMap:f,results:y,tokenSearchers:u,fullSearcher:d})}}},{key:"_computeScore",value:function(t,e){this._log("\n\nComputing score:\n");for(var n=0,r=e.length;n<r;n+=1){for(var i=e[n].output,o=i.length,a=1,s=1,l=0;l<o;l+=1){var c=t?t[i[l].key].weight:1,u=(1===c?i[l].score:i[l].score||.001)*c;1!==c?s=Math.min(s,u):(i[l].nScore=u,a*=u)}e[n].score=1===s?a:s,this._log(e[n])}}},{key:"_sort",value:function(t){this._log("\n\nSorting...."),t.sort(this.options.sortFn)}},{key:"_format",value:function(t){var e=[];if(this.options.verbose){var n=[];this._log("\n\nOutput:\n\n",JSON.stringify(t,function(t,e){if("object"===r(e)&&null!==e){if(-1!==n.indexOf(e))return;n.push(e)}return e})),n=null}var i=[];this.options.includeMatches&&i.push(function(t,e){var n=t.output;e.matches=[];for(var r=0,i=n.length;r<i;r+=1){var o=n[r];if(0!==o.matchedIndices.length){var a={indices:o.matchedIndices,value:o.value};o.key&&(a.key=o.key),o.hasOwnProperty("arrayIndex")&&o.arrayIndex>-1&&(a.arrayIndex=o.arrayIndex),e.matches.push(a)}}}),this.options.includeScore&&i.push(function(t,e){e.score=t.score});for(var o=0,a=t.length;o<a;o+=1){var s=t[o];if(this.options.id&&(s.item=this.options.getFn(s.item,this.options.id)[0]),i.length){for(var l={item:s.item},c=0,u=i.length;c<u;c+=1)i[c](s,l);e.push(l)}else e.push(s.item)}return e}},{key:"_log",value:function(){var t;this.options.verbose&&(t=console).log.apply(t,arguments)}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,e),t}();t.exports=s},function(t,e,n){var r=n(3),i=n(4),o=n(7),a=function(){function t(e,n){var r=n.location,i=void 0===r?0:r,a=n.distance,s=void 0===a?100:a,l=n.threshold,c=void 0===l?.6:l,u=n.maxPatternLength,p=void 0===u?32:u,d=n.isCaseSensitive,h=void 0!==d&&d,f=n.tokenSeparator,m=void 0===f?/ +/g:f,y=n.findAllMatches,_=void 0!==y&&y,g=n.minMatchCharLength,v=void 0===g?1:g;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options={location:i,distance:s,threshold:c,maxPatternLength:p,isCaseSensitive:h,tokenSeparator:m,findAllMatches:_,minMatchCharLength:v},this.pattern=this.options.isCaseSensitive?e:e.toLowerCase(),this.pattern.length<=p&&(this.patternAlphabet=o(this.pattern))}var e;return(e=[{key:"search",value:function(t){if(this.options.isCaseSensitive||(t=t.toLowerCase()),this.pattern===t)return{isMatch:!0,score:0,matchedIndices:[[0,t.length-1]]};var e=this.options,n=e.maxPatternLength,o=e.tokenSeparator;if(this.pattern.length>n)return r(t,this.pattern,o);var a=this.options,s=a.location,l=a.distance,c=a.threshold,u=a.findAllMatches,p=a.minMatchCharLength;return i(t,this.pattern,this.patternAlphabet,{location:s,distance:l,threshold:c,findAllMatches:u,minMatchCharLength:p})}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,e),t}();t.exports=a},function(t,e){var n=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;t.exports=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:/ +/g,i=new RegExp(e.replace(n,"\\$&").replace(r,"|")),o=t.match(i),a=!!o,s=[];if(a)for(var l=0,c=o.length;l<c;l+=1){var u=o[l];s.push([t.indexOf(u),u.length-1])}return{score:a?.5:1,isMatch:a,matchedIndices:s}}},function(t,e,n){var r=n(5),i=n(6);t.exports=function(t,e,n,o){for(var a=o.location,s=void 0===a?0:a,l=o.distance,c=void 0===l?100:l,u=o.threshold,p=void 0===u?.6:u,d=o.findAllMatches,h=void 0!==d&&d,f=o.minMatchCharLength,m=void 0===f?1:f,y=s,_=t.length,g=p,v=t.indexOf(e,y),b=e.length,x=[],w=0;w<_;w+=1)x[w]=0;if(-1!==v){var E=r(e,{errors:0,currentLocation:v,expectedLocation:y,distance:c});if(g=Math.min(E,g),-1!==(v=t.lastIndexOf(e,y+b))){var T=r(e,{errors:0,currentLocation:v,expectedLocation:y,distance:c});g=Math.min(T,g)}}v=-1;for(var S=[],M=1,j=b+_,C=1<<b-1,z=0;z<b;z+=1){for(var R=0,A=j;R<A;)r(e,{errors:z,currentLocation:y+A,expectedLocation:y,distance:c})<=g?R=A:j=A,A=Math.floor((j-R)/2+R);j=A;var L=Math.max(1,y-A+1),I=h?_:Math.min(y+A,_)+b,P=Array(I+2);P[I+1]=(1<<z)-1;for(var O=I;O>=L;O-=1){var k=O-1,B=n[t.charAt(k)];if(B&&(x[k]=1),P[O]=(P[O+1]<<1|1)&B,0!==z&&(P[O]|=(S[O+1]|S[O])<<1|1|S[O+1]),P[O]&C&&(M=r(e,{errors:z,currentLocation:k,expectedLocation:y,distance:c}))<=g){if(g=M,(v=k)<=y)break;L=Math.max(1,2*y-v)}}if(r(e,{errors:z+1,currentLocation:y,expectedLocation:y,distance:c})>g)break;S=P}return{isMatch:v>=0,score:0===M?.001:M,matchedIndices:i(x,m)}}},function(t,e){t.exports=function(t,e){var n=e.errors,r=void 0===n?0:n,i=e.currentLocation,o=void 0===i?0:i,a=e.expectedLocation,s=void 0===a?0:a,l=e.distance,c=void 0===l?100:l,u=r/t.length,p=Math.abs(s-o);return c?u+p/c:p?1:u}},function(t,e){t.exports=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[],r=-1,i=-1,o=0,a=t.length;o<a;o+=1){var s=t[o];s&&-1===r?r=o:s||-1===r||((i=o-1)-r+1>=e&&n.push([r,i]),r=-1)}return t[o-1]&&o-r>=e&&n.push([r,o-1]),n}},function(t,e){t.exports=function(t){for(var e={},n=t.length,r=0;r<n;r+=1)e[t.charAt(r)]=0;for(var i=0;i<n;i+=1)e[t.charAt(i)]|=1<<n-i-1;return e}},function(t,e,n){var r=n(0);t.exports=function(t,e){return function t(e,n,i){if(n){var o=n.indexOf("."),a=n,s=null;-1!==o&&(a=n.slice(0,o),s=n.slice(o+1));var l=e[a];if(null!=l)if(s||"string"!=typeof l&&"number"!=typeof l)if(r(l))for(var c=0,u=l.length;c<u;c+=1)t(l[c],s,i);else s&&t(l,s,i);else i.push(l.toString())}else i.push(e);return i}(t,e,[])}}])},function(t,e,n){"use strict";function r(t){var e,n=t.Symbol;return"function"==typeof n?n.observable?e=n.observable:(e=n("observable"),n.observable=e):e="@@observable",e}n.d(e,"a",function(){return r})},function(t,e,n){t.exports=n(7)},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n.n(r),o=n(0),a=n.n(o),s=n(1),l=function(){return Math.random().toString(36).substring(7).split("").join(".")},c={INIT:"@@redux/INIT"+l(),REPLACE:"@@redux/REPLACE"+l(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+l()}};function u(t,e,n){var r;if("function"==typeof e&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof e&&void 0===n&&(n=e,e=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(u)(t,e)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var i=t,o=e,a=[],l=a,p=!1;function d(){l===a&&(l=a.slice())}function h(){if(p)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return o}function f(t){if("function"!=typeof t)throw new Error("Expected the listener to be a function.");if(p)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var e=!0;return d(),l.push(t),function(){if(e){if(p)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");e=!1,d();var n=l.indexOf(t);l.splice(n,1)}}}function m(t){if(!function(t){if("object"!=typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(p)throw new Error("Reducers may not dispatch actions.");try{p=!0,o=i(o,t)}finally{p=!1}for(var e=a=l,n=0;n<e.length;n++)(0,e[n])();return t}return m({type:c.INIT}),(r={dispatch:m,subscribe:f,getState:h,replaceReducer:function(t){if("function"!=typeof t)throw new Error("Expected the nextReducer to be a function.");i=t,m({type:c.REPLACE})}})[s.a]=function(){var t,e=f;return(t={subscribe:function(t){if("object"!=typeof t||null===t)throw new TypeError("Expected the observer to be an object.");function n(){t.next&&t.next(h())}return n(),{unsubscribe:e(n)}}})[s.a]=function(){return this},t},r}function p(t,e){var n=e&&e.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+t+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}var d,h=[],f=[],m=[],y={loading:!1},_=function(t){return Array.from({length:t},function(){return Math.floor(36*Math.random()+0).toString(36)}).join("")},g=function(t,e){return e+"-"+(t.id||t.name&&t.name+"-"+_(2)||_(4)).replace(/(:|\.|\[|\]|,)/g,"")},v=function(t){return Object.prototype.toString.call(t).slice(8,-1)},b=function(t,e){return null!=e&&v(e)===t},x=function(t){return"string"!=typeof t?t:t.replace(/&/g,"&amp;").replace(/>/g,"&rt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")},w=(d=document.createElement("div"),function(t){var e=t.trim();d.innerHTML=e;for(var n=d.children[0];d.firstChild;)d.removeChild(d.firstChild);return n}),E=function(t,e){return t.score-e.score},T=function(t){return JSON.parse(JSON.stringify(t))},S=function(t,e){var n=Object.keys(t).sort(),r=Object.keys(e).sort();return n.filter(function(t){return r.indexOf(t)<0})},M=function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++){var i=e[r];"function"==typeof t[i]&&(n[i]=t[i])}var o,a=Object.keys(n);try{!function(t){Object.keys(t).forEach(function(e){var n=t[e];if(void 0===n(void 0,{type:c.INIT}))throw new Error('Reducer "'+e+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{type:c.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+e+"\" returned undefined when probed with a random type. Don't try to handle "+c.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(n)}catch(t){o=t}return function(t,e){if(void 0===t&&(t={}),o)throw o;for(var r=!1,i={},s=0;s<a.length;s++){var l=a[s],c=n[l],u=t[l],d=c(u,e);if(void 0===d){var h=p(l,e);throw new Error(h)}i[l]=d,r=r||d!==u}return r?i:t}}({items:function(t,e){switch(void 0===t&&(t=h),e.type){case"ADD_ITEM":return[].concat(t,[{id:e.id,choiceId:e.choiceId,groupId:e.groupId,value:e.value,label:e.label,active:!0,highlighted:!1,customProperties:e.customProperties,placeholder:e.placeholder||!1,keyCode:null}]).map(function(t){var e=t;return e.highlighted=!1,e});case"REMOVE_ITEM":return t.map(function(t){var n=t;return n.id===e.id&&(n.active=!1),n});case"HIGHLIGHT_ITEM":return t.map(function(t){var n=t;return n.id===e.id&&(n.highlighted=e.highlighted),n});default:return t}},groups:function(t,e){switch(void 0===t&&(t=f),e.type){case"ADD_GROUP":return[].concat(t,[{id:e.id,value:e.value,active:e.active,disabled:e.disabled}]);case"CLEAR_CHOICES":return[];default:return t}},choices:function(t,e){switch(void 0===t&&(t=m),e.type){case"ADD_CHOICE":return[].concat(t,[{id:e.id,elementId:e.elementId,groupId:e.groupId,value:e.value,label:e.label||e.value,disabled:e.disabled||!1,selected:!1,active:!0,score:9999,customProperties:e.customProperties,placeholder:e.placeholder||!1,keyCode:null}]);case"ADD_ITEM":return e.activateOptions?t.map(function(t){var n=t;return n.active=e.active,n}):e.choiceId>-1?t.map(function(t){var n=t;return n.id===parseInt(e.choiceId,10)&&(n.selected=!0),n}):t;case"REMOVE_ITEM":return e.choiceId>-1?t.map(function(t){var n=t;return n.id===parseInt(e.choiceId,10)&&(n.selected=!1),n}):t;case"FILTER_CHOICES":return t.map(function(t){var n=t;return n.active=e.results.some(function(t){var e=t.item,r=t.score;return e.id===n.id&&(n.score=r,!0)}),n});case"ACTIVATE_CHOICES":return t.map(function(t){var n=t;return n.active=e.active,n});case"CLEAR_CHOICES":return m;default:return t}},general:function(t,e){switch(void 0===t&&(t=y),e.type){case"SET_IS_LOADING":return{loading:e.isLoading};default:return t}}}),j=function(t,e){var n=t;if("CLEAR_ALL"===e.type)n=void 0;else if("RESET_TO"===e.type)return T(e.state);return M(n,e)},C=function(){function t(){this._store=u(j,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())}var e,n=t.prototype;return n.subscribe=function(t){this._store.subscribe(t)},n.dispatch=function(t){this._store.dispatch(t)},n.isLoading=function(){return this.state.general.loading},n.getChoiceById=function(t){return this.activeChoices.find(function(e){return e.id===parseInt(t,10)})},n.getGroupById=function(t){return this.groups.find(function(e){return e.id===t})},(e=[{key:"state",get:function(){return this._store.getState()}},{key:"items",get:function(){return this.state.items}},{key:"activeItems",get:function(){return this.items.filter(function(t){return!0===t.active})}},{key:"highlightedActiveItems",get:function(){return this.items.filter(function(t){return t.active&&t.highlighted})}},{key:"choices",get:function(){return this.state.choices}},{key:"activeChoices",get:function(){return this.choices.filter(function(t){return!0===t.active})}},{key:"selectableChoices",get:function(){return this.choices.filter(function(t){return!0!==t.disabled})}},{key:"searchableChoices",get:function(){return this.selectableChoices.filter(function(t){return!0!==t.placeholder})}},{key:"placeholderChoice",get:function(){return[].concat(this.choices).reverse().find(function(t){return!0===t.placeholder})}},{key:"groups",get:function(){return this.state.groups}},{key:"activeGroups",get:function(){var t=this.groups,e=this.choices;return t.filter(function(t){var n=!0===t.active&&!1===t.disabled,r=e.some(function(t){return!0===t.active&&!1===t.disabled});return n&&r},[])}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,e),t}(),z=function(){function t(t){var e=t.element,n=t.type,r=t.classNames;this.element=e,this.classNames=r,this.type=n,this.isActive=!1}var e,n=t.prototype;return n.getChild=function(t){return this.element.querySelector(t)},n.show=function(){return this.element.classList.add(this.classNames.activeState),this.element.setAttribute("aria-expanded","true"),this.isActive=!0,this},n.hide=function(){return this.element.classList.remove(this.classNames.activeState),this.element.setAttribute("aria-expanded","false"),this.isActive=!1,this},(e=[{key:"distanceFromTopWindow",get:function(){return this.element.getBoundingClientRect().bottom}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,e),t}(),R={items:[],choices:[],silent:!1,renderChoiceLimit:-1,maxItemCount:-1,addItems:!0,addItemFilter:null,removeItems:!0,removeItemButton:!1,editItems:!1,duplicateItemsAllowed:!0,delimiter:",",paste:!0,searchEnabled:!0,searchChoices:!0,searchFloor:1,searchResultLimit:4,searchFields:["label","value"],position:"auto",resetScrollPosition:!0,shouldSort:!0,shouldSortItems:!1,sorter:function(t,e){var n=t.value,r=t.label,i=void 0===r?n:r,o=e.value,a=e.label,s=void 0===a?o:a;return i.localeCompare(s,[],{sensitivity:"base",ignorePunctuation:!0,numeric:!0})},placeholder:!0,placeholderValue:null,searchPlaceholderValue:null,prependValue:null,appendValue:null,renderSelectedChoices:"auto",loadingText:"Loading...",noResultsText:"No results found",noChoicesText:"No choices to choose from",itemSelectText:"Press to select",uniqueItemText:"Only unique values can be added",customAddItemText:"Only values matching specific conditions can be added",addItemText:function(t){return'Press Enter to add <b>"'+x(t)+'"</b>'},maxItemText:function(t){return"Only "+t+" values can be added"},valueComparer:function(t,e){return t===e},fuseOptions:{includeScore:!0},callbackOnInit:null,callbackOnCreateTemplates:null,classNames:{containerOuter:"choices",containerInner:"choices__inner",input:"choices__input",inputCloned:"choices__input--cloned",list:"choices__list",listItems:"choices__list--multiple",listSingle:"choices__list--single",listDropdown:"choices__list--dropdown",item:"choices__item",itemSelectable:"choices__item--selectable",itemDisabled:"choices__item--disabled",itemChoice:"choices__item--choice",placeholder:"choices__placeholder",group:"choices__group",groupHeading:"choices__heading",button:"choices__button",activeState:"is-active",focusState:"is-focused",openState:"is-open",disabledState:"is-disabled",highlightedState:"is-highlighted",selectedState:"is-selected",flippedState:"is-flipped",loadingState:"is-loading",noResults:"has-no-results",noChoices:"has-no-choices"}},A="removeItem",L="highlightItem",I="text",P="select-one",O="select-multiple",k=function(){function t(t){var e=t.element,n=t.type,r=t.classNames,i=t.position;this.element=e,this.classNames=r,this.type=n,this.position=i,this.isOpen=!1,this.isFlipped=!1,this.isFocussed=!1,this.isDisabled=!1,this.isLoading=!1,this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}var e=t.prototype;return e.addEventListeners=function(){this.element.addEventListener("focus",this._onFocus),this.element.addEventListener("blur",this._onBlur)},e.removeEventListeners=function(){this.element.removeEventListener("focus",this._onFocus),this.element.removeEventListener("blur",this._onBlur)},e.shouldFlip=function(t){if("number"!=typeof t)return!1;var e=!1;return"auto"===this.position?e=!window.matchMedia("(min-height: "+(t+1)+"px)").matches:"top"===this.position&&(e=!0),e},e.setActiveDescendant=function(t){this.element.setAttribute("aria-activedescendant",t)},e.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},e.open=function(t){this.element.classList.add(this.classNames.openState),this.element.setAttribute("aria-expanded","true"),this.isOpen=!0,this.shouldFlip(t)&&(this.element.classList.add(this.classNames.flippedState),this.isFlipped=!0)},e.close=function(){this.element.classList.remove(this.classNames.openState),this.element.setAttribute("aria-expanded","false"),this.removeActiveDescendant(),this.isOpen=!1,this.isFlipped&&(this.element.classList.remove(this.classNames.flippedState),this.isFlipped=!1)},e.focus=function(){this.isFocussed||this.element.focus()},e.addFocusState=function(){this.element.classList.add(this.classNames.focusState)},e.removeFocusState=function(){this.element.classList.remove(this.classNames.focusState)},e.enable=function(){this.element.classList.remove(this.classNames.disabledState),this.element.removeAttribute("aria-disabled"),this.type===P&&this.element.setAttribute("tabindex","0"),this.isDisabled=!1},e.disable=function(){this.element.classList.add(this.classNames.disabledState),this.element.setAttribute("aria-disabled","true"),this.type===P&&this.element.setAttribute("tabindex","-1"),this.isDisabled=!0},e.wrap=function(t){!function(t,e){void 0===e&&(e=document.createElement("div")),t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e),e.appendChild(t)}(t,this.element)},e.unwrap=function(t){this.element.parentNode.insertBefore(t,this.element),this.element.parentNode.removeChild(this.element)},e.addLoadingState=function(){this.element.classList.add(this.classNames.loadingState),this.element.setAttribute("aria-busy","true"),this.isLoading=!0},e.removeLoadingState=function(){this.element.classList.remove(this.classNames.loadingState),this.element.removeAttribute("aria-busy"),this.isLoading=!1},e._onFocus=function(){this.isFocussed=!0},e._onBlur=function(){this.isFocussed=!1},t}(),B=function(){function t(t){var e=t.element,n=t.type,r=t.classNames,i=t.preventPaste;this.element=e,this.type=n,this.classNames=r,this.preventPaste=i,this.isFocussed=this.element===document.activeElement,this.isDisabled=e.disabled,this._onPaste=this._onPaste.bind(this),this._onInput=this._onInput.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}var e,n=t.prototype;return n.addEventListeners=function(){this.element.addEventListener("paste",this._onPaste),this.element.addEventListener("input",this._onInput,{passive:!0}),this.element.addEventListener("focus",this._onFocus,{passive:!0}),this.element.addEventListener("blur",this._onBlur,{passive:!0})},n.removeEventListeners=function(){this.element.removeEventListener("input",this._onInput,{passive:!0}),this.element.removeEventListener("paste",this._onPaste),this.element.removeEventListener("focus",this._onFocus,{passive:!0}),this.element.removeEventListener("blur",this._onBlur,{passive:!0})},n.enable=function(){this.element.removeAttribute("disabled"),this.isDisabled=!1},n.disable=function(){this.element.setAttribute("disabled",""),this.isDisabled=!0},n.focus=function(){this.isFocussed||this.element.focus()},n.blur=function(){this.isFocussed&&this.element.blur()},n.clear=function(t){return void 0===t&&(t=!0),this.element.value&&(this.element.value=""),t&&this.setWidth(),this},n.setWidth=function(){var t=this.element,e=t.style,n=t.value,r=t.placeholder;e.minWidth=r.length+1+"ch",e.width=n.length+1+"ch"},n.setActiveDescendant=function(t){this.element.setAttribute("aria-activedescendant",t)},n.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},n._onInput=function(){this.type!==P&&this.setWidth()},n._onPaste=function(t){this.preventPaste&&t.preventDefault()},n._onFocus=function(){this.isFocussed=!0},n._onBlur=function(){this.isFocussed=!1},(e=[{key:"placeholder",set:function(t){this.element.placeholder=t}},{key:"value",get:function(){return x(this.element.value)},set:function(t){this.element.value=t}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,e),t}(),D=function(){function t(t){var e=t.element;this.element=e,this.scrollPos=this.element.scrollTop,this.height=this.element.offsetHeight}var e=t.prototype;return e.clear=function(){this.element.innerHTML=""},e.append=function(t){this.element.appendChild(t)},e.getChild=function(t){return this.element.querySelector(t)},e.hasChildren=function(){return this.element.hasChildNodes()},e.scrollToTop=function(){this.element.scrollTop=0},e.scrollToChildElement=function(t,e){var n=this;if(t){var r=this.element.offsetHeight,i=this.element.scrollTop+r,o=t.offsetHeight,a=t.offsetTop+o,s=e>0?this.element.scrollTop+a-i:t.offsetTop;requestAnimationFrame(function(){n._animateScroll(s,e)})}},e._scrollDown=function(t,e,n){var r=(n-t)/e,i=r>1?r:1;this.element.scrollTop=t+i},e._scrollUp=function(t,e,n){var r=(t-n)/e,i=r>1?r:1;this.element.scrollTop=t-i},e._animateScroll=function(t,e){var n=this,r=this.element.scrollTop,i=!1;e>0?(this._scrollDown(r,4,t),r<t&&(i=!0)):(this._scrollUp(r,4,t),r>t&&(i=!0)),i&&requestAnimationFrame(function(){n._animateScroll(t,e)})},t}(),H=function(){function t(t){var e=t.element,n=t.classNames;if(this.element=e,this.classNames=n,!(e instanceof HTMLInputElement||e instanceof HTMLSelectElement))throw new TypeError("Invalid element passed");this.isDisabled=!1}var e,n=t.prototype;return n.conceal=function(){this.element.classList.add(this.classNames.input),this.element.hidden=!0,this.element.tabIndex=-1;var t=this.element.getAttribute("style");t&&this.element.setAttribute("data-choice-orig-style",t),this.element.setAttribute("data-choice","active")},n.reveal=function(){this.element.classList.remove(this.classNames.input),this.element.hidden=!1,this.element.removeAttribute("tabindex");var t=this.element.getAttribute("data-choice-orig-style");t?(this.element.removeAttribute("data-choice-orig-style"),this.element.setAttribute("style",t)):this.element.removeAttribute("style"),this.element.removeAttribute("data-choice"),this.element.value=this.element.value},n.enable=function(){this.element.removeAttribute("disabled"),this.element.disabled=!1,this.isDisabled=!1},n.disable=function(){this.element.setAttribute("disabled",""),this.element.disabled=!0,this.isDisabled=!0},n.triggerEvent=function(t,e){!function(t,e,n){void 0===n&&(n=null);var r=new CustomEvent(e,{detail:n,bubbles:!0,cancelable:!0});t.dispatchEvent(r)}(this.element,t,e)},(e=[{key:"isActive",get:function(){return"active"===this.element.dataset.choice}},{key:"dir",get:function(){return this.element.dir}},{key:"value",get:function(){return this.element.value},set:function(t){this.element.value=t}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,e),t}(),F=function(t){var e,n,r;function i(e){var n,r=e.element,i=e.classNames,o=e.delimiter;return(n=t.call(this,{element:r,classNames:i})||this).delimiter=o,n}return n=t,(e=i).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,(r=[{key:"value",get:function(){return this.element.value},set:function(t){var e=t.map(function(t){return t.value}).join(this.delimiter);this.element.setAttribute("value",e),this.element.value=e}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(i.prototype,r),i}(H),N=function(t){var e,n,r;function i(e){var n,r=e.element,i=e.classNames,o=e.template;return(n=t.call(this,{element:r,classNames:i})||this).template=o,n}return n=t,(e=i).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,i.prototype.appendDocFragment=function(t){this.element.innerHTML="",this.element.appendChild(t)},(r=[{key:"placeholderOption",get:function(){return this.element.querySelector('option[value=""]')||this.element.querySelector("option[placeholder]")}},{key:"optionGroups",get:function(){return Array.from(this.element.getElementsByTagName("OPTGROUP"))}},{key:"options",get:function(){return Array.from(this.element.options)},set:function(t){var e=this,n=document.createDocumentFragment();t.forEach(function(t){return r=t,i=e.template(r),void n.appendChild(i);var r,i}),this.appendDocFragment(n)}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(i.prototype,r),i}(H),U={containerOuter:function(t,e,n,r,i,o){var a=t.containerOuter,s=Object.assign(document.createElement("div"),{className:a});return s.dataset.type=o,e&&(s.dir=e),r&&(s.tabIndex=0),n&&(s.setAttribute("role",i?"combobox":"listbox"),i&&s.setAttribute("aria-autocomplete","list")),s.setAttribute("aria-haspopup","true"),s.setAttribute("aria-expanded","false"),s},containerInner:function(t){var e=t.containerInner;return Object.assign(document.createElement("div"),{className:e})},itemList:function(t,e){var n=t.list,r=t.listSingle,i=t.listItems;return Object.assign(document.createElement("div"),{className:n+" "+(e?r:i)})},placeholder:function(t,e){var n=t.placeholder;return Object.assign(document.createElement("div"),{className:n,innerHTML:e})},item:function(t,e,n){var r=t.item,i=t.button,o=t.highlightedState,a=t.itemSelectable,s=t.placeholder,l=e.id,c=e.value,u=e.label,p=e.customProperties,d=e.active,h=e.disabled,f=e.highlighted,m=e.placeholder,y=Object.assign(document.createElement("div"),{className:r,innerHTML:u});if(Object.assign(y.dataset,{item:"",id:l,value:c,customProperties:p}),d&&y.setAttribute("aria-selected","true"),h&&y.setAttribute("aria-disabled","true"),m&&y.classList.add(s),y.classList.add(f?o:a),n){h&&y.classList.remove(a),y.dataset.deletable="";var _=Object.assign(document.createElement("button"),{type:"button",className:i,innerHTML:"Remove item"});_.setAttribute("aria-label","Remove item: '"+c+"'"),_.dataset.button="",y.appendChild(_)}return y},choiceList:function(t,e){var n=t.list,r=Object.assign(document.createElement("div"),{className:n});return e||r.setAttribute("aria-multiselectable","true"),r.setAttribute("role","listbox"),r},choiceGroup:function(t,e){var n=t.group,r=t.groupHeading,i=t.itemDisabled,o=e.id,a=e.value,s=e.disabled,l=Object.assign(document.createElement("div"),{className:n+" "+(s?i:"")});return l.setAttribute("role","group"),Object.assign(l.dataset,{group:"",id:o,value:a}),s&&l.setAttribute("aria-disabled","true"),l.appendChild(Object.assign(document.createElement("div"),{className:r,innerHTML:a})),l},choice:function(t,e,n){var r=t.item,i=t.itemChoice,o=t.itemSelectable,a=t.selectedState,s=t.itemDisabled,l=t.placeholder,c=e.id,u=e.value,p=e.label,d=e.groupId,h=e.elementId,f=e.disabled,m=e.selected,y=e.placeholder,_=Object.assign(document.createElement("div"),{id:h,innerHTML:p,className:r+" "+i});return m&&_.classList.add(a),y&&_.classList.add(l),_.setAttribute("role",d>0?"treeitem":"option"),Object.assign(_.dataset,{choice:"",id:c,value:u,selectText:n}),f?(_.classList.add(s),_.dataset.choiceDisabled="",_.setAttribute("aria-disabled","true")):(_.classList.add(o),_.dataset.choiceSelectable=""),_},input:function(t,e){var n=t.input,r=t.inputCloned,i=Object.assign(document.createElement("input"),{type:"text",className:n+" "+r,autocomplete:"off",autocapitalize:"off",spellcheck:!1});return i.setAttribute("role","textbox"),i.setAttribute("aria-autocomplete","list"),i.setAttribute("aria-label",e),i},dropdown:function(t){var e=t.list,n=t.listDropdown,r=document.createElement("div");return r.classList.add(e,n),r.setAttribute("aria-expanded","false"),r},notice:function(t,e,n){var r=t.item,i=t.itemChoice,o=t.noResults,a=t.noChoices;void 0===n&&(n="");var s=[r,i];return"no-choices"===n?s.push(a):"no-results"===n&&s.push(o),Object.assign(document.createElement("div"),{innerHTML:e,className:s.join(" ")})},option:function(t){var e=t.label,n=t.value,r=t.customProperties,i=t.active,o=t.disabled,a=new Option(e,n,!1,i);return r&&(a.dataset.customProperties=r),a.disabled=o,a}},V=function(t){return void 0===t&&(t=!0),{type:"ACTIVATE_CHOICES",active:t}},G=function(t,e){return{type:"HIGHLIGHT_ITEM",id:t,highlighted:e}},W=function(t){return{type:"ADD_GROUP",value:t.value,id:t.id,active:t.active,disabled:t.disabled}},q=function(t){return{type:"SET_IS_LOADING",isLoading:t}};var X="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style,Y={},Q=function(){var t;function e(t,n){var r=this;void 0===t&&(t="[data-choice]"),void 0===n&&(n={}),this.config=a.a.all([R,e.defaults.options,n],{arrayMerge:function(t,e){return[].concat(e)}});var i=S(this.config,R);i.length&&console.warn("Unknown config option(s) passed",i.join(", "));var o="string"==typeof t?document.querySelector(t):t;if(!(o instanceof HTMLInputElement||o instanceof HTMLSelectElement))throw TypeError("Expected one of the following types text|select-one|select-multiple");if(this._isTextElement=o.type===I,this._isSelectOneElement=o.type===P,this._isSelectMultipleElement=o.type===O,this._isSelectElement=this._isSelectOneElement||this._isSelectMultipleElement,this.config.searchEnabled=this._isSelectMultipleElement||this.config.searchEnabled,["auto","always"].includes(this.config.renderSelectedChoices)||(this.config.renderSelectedChoices="auto"),n.addItemFilter&&"function"!=typeof n.addItemFilter){var s=n.addItemFilter instanceof RegExp?n.addItemFilter:new RegExp(n.addItemFilter);this.config.addItemFilter=s.test.bind(s)}if(this._isTextElement?this.passedElement=new F({element:o,classNames:this.config.classNames,delimiter:this.config.delimiter}):this.passedElement=new N({element:o,classNames:this.config.classNames,template:function(t){return r._templates.option(t)}}),this.initialised=!1,this._store=new C,this._initialState={},this._currentState={},this._prevState={},this._currentValue="",this._canSearch=this.config.searchEnabled,this._isScrollingOnIe=!1,this._highlightPosition=0,this._wasTap=!0,this._placeholderValue=this._generatePlaceholderValue(),this._baseId=g(this.passedElement.element,"choices-"),this._direction=this.passedElement.dir,!this._direction){var l=window.getComputedStyle(this.passedElement.element).direction;l!==window.getComputedStyle(document.documentElement).direction&&(this._direction=l)}if(this._idNames={itemChoice:"item-choice"},this._presetGroups=this.passedElement.optionGroups,this._presetOptions=this.passedElement.options,this._presetChoices=this.config.choices,this._presetItems=this.config.items,this.passedElement.value&&(this._presetItems=this._presetItems.concat(this.passedElement.value.split(this.config.delimiter))),this.passedElement.options&&this.passedElement.options.forEach(function(t){r._presetChoices.push({value:t.value,label:t.innerHTML,selected:t.selected,disabled:t.disabled||t.parentNode.disabled,placeholder:""===t.value||t.hasAttribute("placeholder"),customProperties:t.getAttribute("data-custom-properties")})}),this._render=this._render.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this),this._onKeyUp=this._onKeyUp.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onClick=this._onClick.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseOver=this._onMouseOver.bind(this),this._onFormReset=this._onFormReset.bind(this),this._onAKey=this._onAKey.bind(this),this._onEnterKey=this._onEnterKey.bind(this),this._onEscapeKey=this._onEscapeKey.bind(this),this._onDirectionKey=this._onDirectionKey.bind(this),this._onDeleteKey=this._onDeleteKey.bind(this),this.passedElement.isActive)return this.config.silent||console.warn("Trying to initialise Choices on element already initialised"),void(this.initialised=!0);this.init()}(t=[{key:"defaults",get:function(){return Object.preventExtensions({get options(){return Y},get templates(){return U}})}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(e,t);var n=e.prototype;return n.init=function(){if(!this.initialised){this._createTemplates(),this._createElements(),this._createStructure(),this._initialState=T(this._store.state),this._store.subscribe(this._render),this._render(),this._addEventListeners(),(!this.config.addItems||this.passedElement.element.hasAttribute("disabled"))&&this.disable(),this.initialised=!0;var t=this.config.callbackOnInit;t&&"function"==typeof t&&t.call(this)}},n.destroy=function(){this.initialised&&(this._removeEventListeners(),this.passedElement.reveal(),this.containerOuter.unwrap(this.passedElement.element),this.clearStore(),this._isSelectElement&&(this.passedElement.options=this._presetOptions),this._templates=null,this.initialised=!1)},n.enable=function(){return this.passedElement.isDisabled&&this.passedElement.enable(),this.containerOuter.isDisabled&&(this._addEventListeners(),this.input.enable(),this.containerOuter.enable()),this},n.disable=function(){return this.passedElement.isDisabled||this.passedElement.disable(),this.containerOuter.isDisabled||(this._removeEventListeners(),this.input.disable(),this.containerOuter.disable()),this},n.highlightItem=function(t,e){if(void 0===e&&(e=!0),!t)return this;var n=t.id,r=t.groupId,i=void 0===r?-1:r,o=t.value,a=void 0===o?"":o,s=t.label,l=void 0===s?"":s,c=i>=0?this._store.getGroupById(i):null;return this._store.dispatch(G(n,!0)),e&&this.passedElement.triggerEvent(L,{id:n,value:a,label:l,groupValue:c&&c.value?c.value:null}),this},n.unhighlightItem=function(t){if(!t)return this;var e=t.id,n=t.groupId,r=void 0===n?-1:n,i=t.value,o=void 0===i?"":i,a=t.label,s=void 0===a?"":a,l=r>=0?this._store.getGroupById(r):null;return this._store.dispatch(G(e,!1)),this.passedElement.triggerEvent(L,{id:e,value:o,label:s,groupValue:l&&l.value?l.value:null}),this},n.highlightAll=function(){var t=this;return this._store.items.forEach(function(e){return t.highlightItem(e)}),this},n.unhighlightAll=function(){var t=this;return this._store.items.forEach(function(e){return t.unhighlightItem(e)}),this},n.removeActiveItemsByValue=function(t){var e=this;return this._store.activeItems.filter(function(e){return e.value===t}).forEach(function(t){return e._removeItem(t)}),this},n.removeActiveItems=function(t){var e=this;return this._store.activeItems.filter(function(e){return e.id!==t}).forEach(function(t){return e._removeItem(t)}),this},n.removeHighlightedItems=function(t){var e=this;return void 0===t&&(t=!1),this._store.highlightedActiveItems.forEach(function(n){e._removeItem(n),t&&e._triggerChange(n.value)}),this},n.showDropdown=function(t){var e=this;return this.dropdown.isActive?this:(requestAnimationFrame(function(){e.dropdown.show(),e.containerOuter.open(e.dropdown.distanceFromTopWindow),!t&&e._canSearch&&e.input.focus(),e.passedElement.triggerEvent("showDropdown",{})}),this)},n.hideDropdown=function(t){var e=this;return this.dropdown.isActive?(requestAnimationFrame(function(){e.dropdown.hide(),e.containerOuter.close(),!t&&e._canSearch&&(e.input.removeActiveDescendant(),e.input.blur()),e.passedElement.triggerEvent("hideDropdown",{})}),this):this},n.getValue=function(t){void 0===t&&(t=!1);var e=this._store.activeItems.reduce(function(e,n){var r=t?n.value:n;return e.push(r),e},[]);return this._isSelectOneElement?e[0]:e},n.setValue=function(t){var e=this;return this.initialised?(t.forEach(function(t){return e._setChoiceOrItem(t)}),this):this},n.setChoiceByValue=function(t){var e=this;return!this.initialised||this._isTextElement?this:((Array.isArray(t)?t:[t]).forEach(function(t){return e._findAndSelectChoiceByValue(t)}),this)},n.setChoices=function(t,e,n,r){var i=this;if(void 0===t&&(t=[]),void 0===e&&(e="value"),void 0===n&&(n="label"),void 0===r&&(r=!1),!this.initialised)throw new ReferenceError("setChoices was called on a non-initialized instance of Choices");if(!this._isSelectElement)throw new TypeError("setChoices can't be used with INPUT based Choices");if("string"!=typeof e||!e)throw new TypeError("value parameter must be a name of 'value' field in passed objects");if(r&&this.clearChoices(),"function"==typeof t){var o=t(this);if("function"==typeof Promise&&o instanceof Promise)return new Promise(function(t){return requestAnimationFrame(t)}).then(function(){return i._handleLoadingState(!0)}).then(function(){return o}).then(function(t){return i.setChoices(t,e,n,r)}).catch(function(t){i.config.silent||console.error(t)}).then(function(){return i._handleLoadingState(!1)}).then(function(){return i});if(!Array.isArray(o))throw new TypeError(".setChoices first argument function must return either array of choices or Promise, got: "+typeof o);return this.setChoices(o,e,n,!1)}if(!Array.isArray(t))throw new TypeError(".setChoices must be called either with array of choices with a function resulting into Promise of array of choices");return this.containerOuter.removeLoadingState(),this._startLoading(),t.forEach(function(t){t.choices?i._addGroup({id:parseInt(t.id,10)||null,group:t,valueKey:e,labelKey:n}):i._addChoice({value:t[e],label:t[n],isSelected:t.selected,isDisabled:t.disabled,customProperties:t.customProperties,placeholder:t.placeholder})}),this._stopLoading(),this},n.clearChoices=function(){return this._store.dispatch({type:"CLEAR_CHOICES"}),this},n.clearStore=function(){return this._store.dispatch({type:"CLEAR_ALL"}),this},n.clearInput=function(){var t=!this._isSelectOneElement;return this.input.clear(t),!this._isTextElement&&this._canSearch&&(this._isSearching=!1,this._store.dispatch(V(!0))),this},n._render=function(){if(!this._store.isLoading()){this._currentState=this._store.state;var t=this._currentState.choices!==this._prevState.choices||this._currentState.groups!==this._prevState.groups||this._currentState.items!==this._prevState.items,e=this._isSelectElement,n=this._currentState.items!==this._prevState.items;t&&(e&&this._renderChoices(),n&&this._renderItems(),this._prevState=this._currentState)}},n._renderChoices=function(){var t=this,e=this._store,n=e.activeGroups,r=e.activeChoices,i=document.createDocumentFragment();if(this.choiceList.clear(),this.config.resetScrollPosition&&requestAnimationFrame(function(){return t.choiceList.scrollToTop()}),n.length>=1&&!this._isSearching){var o=r.filter(function(t){return!0===t.placeholder&&-1===t.groupId});o.length>=1&&(i=this._createChoicesFragment(o,i)),i=this._createGroupsFragment(n,r,i)}else r.length>=1&&(i=this._createChoicesFragment(r,i));if(i.childNodes&&i.childNodes.length>0){var a=this._store.activeItems,s=this._canAddItem(a,this.input.value);s.response?(this.choiceList.append(i),this._highlightChoice()):this.choiceList.append(this._getTemplate("notice",s.notice))}else{var l,c;this._isSearching?(c="function"==typeof this.config.noResultsText?this.config.noResultsText():this.config.noResultsText,l=this._getTemplate("notice",c,"no-results")):(c="function"==typeof this.config.noChoicesText?this.config.noChoicesText():this.config.noChoicesText,l=this._getTemplate("notice",c,"no-choices")),this.choiceList.append(l)}},n._renderItems=function(){var t=this._store.activeItems||[];this.itemList.clear();var e=this._createItemsFragment(t);e.childNodes&&this.itemList.append(e)},n._createGroupsFragment=function(t,e,n){var r=this;return void 0===n&&(n=document.createDocumentFragment()),this.config.shouldSort&&t.sort(this.config.sorter),t.forEach(function(t){var i=function(t){return e.filter(function(e){return r._isSelectOneElement?e.groupId===t.id:e.groupId===t.id&&("always"===r.config.renderSelectedChoices||!e.selected)})}(t);if(i.length>=1){var o=r._getTemplate("choiceGroup",t);n.appendChild(o),r._createChoicesFragment(i,n,!0)}}),n},n._createChoicesFragment=function(t,e,n){var r=this;void 0===e&&(e=document.createDocumentFragment()),void 0===n&&(n=!1);var i=this.config,o=i.renderSelectedChoices,a=i.searchResultLimit,s=i.renderChoiceLimit,l=this._isSearching?E:this.config.sorter,c=function(t){if("auto"!==o||r._isSelectOneElement||!t.selected){var n=r._getTemplate("choice",t,r.config.itemSelectText);e.appendChild(n)}},u=t;"auto"!==o||this._isSelectOneElement||(u=t.filter(function(t){return!t.selected}));var p=u.reduce(function(t,e){return e.placeholder?t.placeholderChoices.push(e):t.normalChoices.push(e),t},{placeholderChoices:[],normalChoices:[]}),d=p.placeholderChoices,h=p.normalChoices;(this.config.shouldSort||this._isSearching)&&h.sort(l);var f=u.length,m=this._isSelectOneElement?[].concat(d,h):h;this._isSearching?f=a:s&&s>0&&!n&&(f=s);for(var y=0;y<f;y+=1)m[y]&&c(m[y]);return e},n._createItemsFragment=function(t,e){var n=this;void 0===e&&(e=document.createDocumentFragment());var r=this.config,i=r.shouldSortItems,o=r.sorter,a=r.removeItemButton;return i&&!this._isSelectOneElement&&t.sort(o),this._isTextElement?this.passedElement.value=t:this.passedElement.options=t,t.forEach(function(t){var r=n._getTemplate("item",t,a);e.appendChild(r)}),e},n._triggerChange=function(t){null!=t&&this.passedElement.triggerEvent("change",{value:t})},n._selectPlaceholderChoice=function(){var t=this._store.placeholderChoice;t&&(this._addItem({value:t.value,label:t.label,choiceId:t.id,groupId:t.groupId,placeholder:t.placeholder}),this._triggerChange(t.value))},n._handleButtonAction=function(t,e){if(t&&e&&this.config.removeItems&&this.config.removeItemButton){var n=e.parentNode.getAttribute("data-id"),r=t.find(function(t){return t.id===parseInt(n,10)});this._removeItem(r),this._triggerChange(r.value),this._isSelectOneElement&&this._selectPlaceholderChoice()}},n._handleItemAction=function(t,e,n){var r=this;if(void 0===n&&(n=!1),t&&e&&this.config.removeItems&&!this._isSelectOneElement){var i=e.getAttribute("data-id");t.forEach(function(t){t.id!==parseInt(i,10)||t.highlighted?!n&&t.highlighted&&r.unhighlightItem(t):r.highlightItem(t)}),this.input.focus()}},n._handleChoiceAction=function(t,e){if(t&&e){var n=e.dataset.id,r=this._store.getChoiceById(n);if(r){var i=t[0]&&t[0].keyCode?t[0].keyCode:null,o=this.dropdown.isActive;r.keyCode=i,this.passedElement.triggerEvent("choice",{choice:r}),r.selected||r.disabled||this._canAddItem(t,r.value).response&&(this._addItem({value:r.value,label:r.label,choiceId:r.id,groupId:r.groupId,customProperties:r.customProperties,placeholder:r.placeholder,keyCode:r.keyCode}),this._triggerChange(r.value)),this.clearInput(),o&&this._isSelectOneElement&&(this.hideDropdown(!0),this.containerOuter.focus())}}},n._handleBackspace=function(t){if(this.config.removeItems&&t){var e=t[t.length-1],n=t.some(function(t){return t.highlighted});this.config.editItems&&!n&&e?(this.input.value=e.value,this.input.setWidth(),this._removeItem(e),this._triggerChange(e.value)):(n||this.highlightItem(e,!1),this.removeHighlightedItems(!0))}},n._startLoading=function(){this._store.dispatch(q(!0))},n._stopLoading=function(){this._store.dispatch(q(!1))},n._handleLoadingState=function(t){void 0===t&&(t=!0);var e=this.itemList.getChild("."+this.config.classNames.placeholder);t?(this.disable(),this.containerOuter.addLoadingState(),this._isSelectOneElement?e?e.innerHTML=this.config.loadingText:(e=this._getTemplate("placeholder",this.config.loadingText),this.itemList.append(e)):this.input.placeholder=this.config.loadingText):(this.enable(),this.containerOuter.removeLoadingState(),this._isSelectOneElement?e.innerHTML=this._placeholderValue||"":this.input.placeholder=this._placeholderValue||"")},n._handleSearch=function(t){if(t&&this.input.isFocussed){var e=this._store.choices,n=this.config,r=n.searchFloor,i=n.searchChoices,o=e.some(function(t){return!t.active});if(t&&t.length>=r){var a=i?this._searchChoices(t):0;this.passedElement.triggerEvent("search",{value:t,resultCount:a})}else o&&(this._isSearching=!1,this._store.dispatch(V(!0)))}},n._canAddItem=function(t,e){var n=!0,r="function"==typeof this.config.addItemText?this.config.addItemText(e):this.config.addItemText;if(!this._isSelectOneElement){var i=function(t,e,n){return void 0===n&&(n="value"),t.some(function(t){return"string"==typeof e?t[n]===e.trim():t[n]===e})}(t,e);this.config.maxItemCount>0&&this.config.maxItemCount<=t.length&&(n=!1,r="function"==typeof this.config.maxItemText?this.config.maxItemText(this.config.maxItemCount):this.config.maxItemText),!this.config.duplicateItemsAllowed&&i&&n&&(n=!1,r="function"==typeof this.config.uniqueItemText?this.config.uniqueItemText(e):this.config.uniqueItemText),this._isTextElement&&this.config.addItems&&n&&"function"==typeof this.config.addItemFilter&&!this.config.addItemFilter(e)&&(n=!1,r="function"==typeof this.config.customAddItemText?this.config.customAddItemText(e):this.config.customAddItemText)}return{response:n,notice:r}},n._searchChoices=function(t){var e="string"==typeof t?t.trim():t,n="string"==typeof this._currentValue?this._currentValue.trim():this._currentValue;if(e.length<1&&e===n+" ")return 0;var r=this._store.searchableChoices,o=e,a=[].concat(this.config.searchFields),s=Object.assign(this.config.fuseOptions,{keys:a}),l=new i.a(r,s).search(o);return this._currentValue=e,this._highlightPosition=0,this._isSearching=!0,this._store.dispatch({type:"FILTER_CHOICES",results:l}),l.length},n._addEventListeners=function(){var t=document.documentElement;t.addEventListener("touchend",this._onTouchEnd,!0),this.containerOuter.element.addEventListener("keydown",this._onKeyDown,!0),this.containerOuter.element.addEventListener("mousedown",this._onMouseDown,!0),t.addEventListener("click",this._onClick,{passive:!0}),t.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.dropdown.element.addEventListener("mouseover",this._onMouseOver,{passive:!0}),this._isSelectOneElement&&(this.containerOuter.element.addEventListener("focus",this._onFocus,{passive:!0}),this.containerOuter.element.addEventListener("blur",this._onBlur,{passive:!0})),this.input.element.addEventListener("keyup",this._onKeyUp,{passive:!0}),this.input.element.addEventListener("focus",this._onFocus,{passive:!0}),this.input.element.addEventListener("blur",this._onBlur,{passive:!0}),this.input.element.form&&this.input.element.form.addEventListener("reset",this._onFormReset,{passive:!0}),this.input.addEventListeners()},n._removeEventListeners=function(){var t=document.documentElement;t.removeEventListener("touchend",this._onTouchEnd,!0),this.containerOuter.element.removeEventListener("keydown",this._onKeyDown,!0),this.containerOuter.element.removeEventListener("mousedown",this._onMouseDown,!0),t.removeEventListener("click",this._onClick),t.removeEventListener("touchmove",this._onTouchMove),this.dropdown.element.removeEventListener("mouseover",this._onMouseOver),this._isSelectOneElement&&(this.containerOuter.element.removeEventListener("focus",this._onFocus),this.containerOuter.element.removeEventListener("blur",this._onBlur)),this.input.element.removeEventListener("keyup",this._onKeyUp),this.input.element.removeEventListener("focus",this._onFocus),this.input.element.removeEventListener("blur",this._onBlur),this.input.element.form&&this.input.element.form.removeEventListener("reset",this._onFormReset),this.input.removeEventListeners()},n._onKeyDown=function(t){var e,n=t.target,r=t.keyCode,i=t.ctrlKey,o=t.metaKey,a=this._store.activeItems,s=this.input.isFocussed,l=this.dropdown.isActive,c=this.itemList.hasChildren(),u=String.fromCharCode(r),p=i||o;!this._isTextElement&&/[a-zA-Z0-9-_ ]/.test(u)&&this.showDropdown();var d=((e={})[65]=this._onAKey,e[13]=this._onEnterKey,e[27]=this._onEscapeKey,e[38]=this._onDirectionKey,e[33]=this._onDirectionKey,e[40]=this._onDirectionKey,e[34]=this._onDirectionKey,e[8]=this._onDeleteKey,e[46]=this._onDeleteKey,e);d[r]&&d[r]({event:t,target:n,keyCode:r,metaKey:o,activeItems:a,hasFocusedInput:s,hasActiveDropdown:l,hasItems:c,hasCtrlDownKeyPressed:p})},n._onKeyUp=function(t){var e=t.target,n=t.keyCode,r=this.input.value,i=this._store.activeItems,o=this._canAddItem(i,r);if(this._isTextElement)if(o.notice&&r){var a=this._getTemplate("notice",o.notice);this.dropdown.element.innerHTML=a.outerHTML,this.showDropdown(!0)}else this.hideDropdown(!0);else{var s=(46===n||8===n)&&!e.value,l=!this._isTextElement&&this._isSearching,c=this._canSearch&&o.response;s&&l?(this._isSearching=!1,this._store.dispatch(V(!0))):c&&this._handleSearch(this.input.value)}this._canSearch=this.config.searchEnabled},n._onAKey=function(t){var e=t.hasItems;t.hasCtrlDownKeyPressed&&e&&(this._canSearch=!1,this.config.removeItems&&!this.input.value&&this.input.element===document.activeElement&&this.highlightAll())},n._onEnterKey=function(t){var e=t.event,n=t.target,r=t.activeItems,i=t.hasActiveDropdown,o=n.hasAttribute("data-button");if(this._isTextElement&&n.value){var a=this.input.value;this._canAddItem(r,a).response&&(this.hideDropdown(!0),this._addItem({value:a}),this._triggerChange(a),this.clearInput())}if(o&&(this._handleButtonAction(r,n),e.preventDefault()),i){var s=this.dropdown.getChild("."+this.config.classNames.highlightedState);s&&(r[0]&&(r[0].keyCode=13),this._handleChoiceAction(r,s)),e.preventDefault()}else this._isSelectOneElement&&(this.showDropdown(),e.preventDefault())},n._onEscapeKey=function(t){t.hasActiveDropdown&&(this.hideDropdown(!0),this.containerOuter.focus())},n._onDirectionKey=function(t){var e,n,r,i=t.event,o=t.hasActiveDropdown,a=t.keyCode,s=t.metaKey;if(o||this._isSelectOneElement){this.showDropdown(),this._canSearch=!1;var l,c=40===a||34===a?1:-1;if(s||34===a||33===a)l=c>0?this.dropdown.element.querySelector("[data-choice-selectable]:last-of-type"):this.dropdown.element.querySelector("[data-choice-selectable]");else{var u=this.dropdown.element.querySelector("."+this.config.classNames.highlightedState);l=u?function(t,e,n){if(void 0===n&&(n=1),u instanceof Element){for(var r=(n>0?"next":"previous")+"ElementSibling",i=u[r];i;){if(i.matches("[data-choice-selectable]"))return i;i=i[r]}return i}}(0,0,c):this.dropdown.element.querySelector("[data-choice-selectable]")}l&&(e=l,n=this.choiceList.element,void 0===(r=c)&&(r=1),e&&(r>0?n.scrollTop+n.offsetHeight>=e.offsetTop+e.offsetHeight:e.offsetTop>=n.scrollTop)||this.choiceList.scrollToChildElement(l,c),this._highlightChoice(l)),i.preventDefault()}},n._onDeleteKey=function(t){var e=t.event,n=t.target,r=t.hasFocusedInput,i=t.activeItems;!r||n.value||this._isSelectOneElement||(this._handleBackspace(i),e.preventDefault())},n._onTouchMove=function(){this._wasTap&&(this._wasTap=!1)},n._onTouchEnd=function(t){var e=(t||t.touches[0]).target;this._wasTap&&this.containerOuter.element.contains(e)&&((e===this.containerOuter.element||e===this.containerInner.element)&&(this._isTextElement?this.input.focus():this._isSelectMultipleElement&&this.showDropdown()),t.stopPropagation()),this._wasTap=!0},n._onMouseDown=function(t){var e=t.target;if(e instanceof HTMLElement){if(X&&this.choiceList.element.contains(e)){var n=this.choiceList.element.firstElementChild,r="ltr"===this._direction?t.offsetX>=n.offsetWidth:t.offsetX<n.offsetLeft;this._isScrollingOnIe=r}if(e!==this.input.element){var i=e.closest("[data-button],[data-item],[data-choice]");if(i instanceof HTMLElement){var o=t.shiftKey,a=this._store.activeItems,s=i.dataset;"button"in s?this._handleButtonAction(a,i):"item"in s?this._handleItemAction(a,i,o):"choice"in s&&this._handleChoiceAction(a,i)}t.preventDefault()}}},n._onMouseOver=function(t){var e=t.target;e instanceof HTMLElement&&"choice"in e.dataset&&this._highlightChoice(e)},n._onClick=function(t){var e=t.target;this.containerOuter.element.contains(e)?this.dropdown.isActive||this.containerOuter.isDisabled?this._isSelectOneElement&&e!==this.input.element&&!this.dropdown.element.contains(e)&&this.hideDropdown():this._isTextElement?document.activeElement!==this.input.element&&this.input.focus():(this.showDropdown(),this.containerOuter.focus()):(this._store.highlightedActiveItems.length>0&&this.unhighlightAll(),this.containerOuter.removeFocusState(),this.hideDropdown(!0))},n._onFocus=function(t){var e,n=this,r=t.target;this.containerOuter.element.contains(r)&&((e={})[I]=function(){r===n.input.element&&n.containerOuter.addFocusState()},e[P]=function(){n.containerOuter.addFocusState(),r===n.input.element&&n.showDropdown(!0)},e[O]=function(){r===n.input.element&&(n.showDropdown(!0),n.containerOuter.addFocusState())},e)[this.passedElement.element.type]()},n._onBlur=function(t){var e=this,n=t.target;if(this.containerOuter.element.contains(n)&&!this._isScrollingOnIe){var r,i=this._store.activeItems.some(function(t){return t.highlighted});((r={})[I]=function(){n===e.input.element&&(e.containerOuter.removeFocusState(),i&&e.unhighlightAll(),e.hideDropdown(!0))},r[P]=function(){e.containerOuter.removeFocusState(),(n===e.input.element||n===e.containerOuter.element&&!e._canSearch)&&e.hideDropdown(!0)},r[O]=function(){n===e.input.element&&(e.containerOuter.removeFocusState(),e.hideDropdown(!0),i&&e.unhighlightAll())},r)[this.passedElement.element.type]()}else this._isScrollingOnIe=!1,this.input.element.focus()},n._onFormReset=function(){this._store.dispatch({type:"RESET_TO",state:this._initialState})},n._highlightChoice=function(t){var e=this;void 0===t&&(t=null);var n=Array.from(this.dropdown.element.querySelectorAll("[data-choice-selectable]"));if(n.length){var r=t;Array.from(this.dropdown.element.querySelectorAll("."+this.config.classNames.highlightedState)).forEach(function(t){t.classList.remove(e.config.classNames.highlightedState),t.setAttribute("aria-selected","false")}),r?this._highlightPosition=n.indexOf(r):(r=n.length>this._highlightPosition?n[this._highlightPosition]:n[n.length-1])||(r=n[0]),r.classList.add(this.config.classNames.highlightedState),r.setAttribute("aria-selected","true"),this.passedElement.triggerEvent("highlightChoice",{el:r}),this.dropdown.isActive&&(this.input.setActiveDescendant(r.id),this.containerOuter.setActiveDescendant(r.id))}},n._addItem=function(t){var e=t.value,n=t.label,r=void 0===n?null:n,i=t.choiceId,o=void 0===i?-1:i,a=t.groupId,s=void 0===a?-1:a,l=t.customProperties,c=void 0===l?null:l,u=t.placeholder,p=void 0!==u&&u,d=t.keyCode,h=void 0===d?null:d,f="string"==typeof e?e.trim():e,m=h,y=c,_=this._store.items,g=r||f,v=o||-1,b=s>=0?this._store.getGroupById(s):null,x=_?_.length+1:1;return this.config.prependValue&&(f=this.config.prependValue+f.toString()),this.config.appendValue&&(f+=this.config.appendValue.toString()),this._store.dispatch(function(t){return{type:"ADD_ITEM",value:t.value,label:t.label,id:t.id,choiceId:t.choiceId,groupId:t.groupId,customProperties:t.customProperties,placeholder:t.placeholder,keyCode:t.keyCode}}({value:f,label:g,id:x,choiceId:v,groupId:s,customProperties:c,placeholder:p,keyCode:m})),this._isSelectOneElement&&this.removeActiveItems(x),this.passedElement.triggerEvent("addItem",{id:x,value:f,label:g,customProperties:y,groupValue:b&&b.value?b.value:void 0,keyCode:m}),this},n._removeItem=function(t){if(!t||!b("Object",t))return this;var e=t.id,n=t.value,r=t.label,i=t.choiceId,o=t.groupId,a=o>=0?this._store.getGroupById(o):null;return this._store.dispatch(function(t,e){return{type:"REMOVE_ITEM",id:t,choiceId:i}}(e)),a&&a.value?this.passedElement.triggerEvent(A,{id:e,value:n,label:r,groupValue:a.value}):this.passedElement.triggerEvent(A,{id:e,value:n,label:r}),this},n._addChoice=function(t){var e=t.value,n=t.label,r=void 0===n?null:n,i=t.isSelected,o=void 0!==i&&i,a=t.isDisabled,s=void 0!==a&&a,l=t.groupId,c=void 0===l?-1:l,u=t.customProperties,p=void 0===u?null:u,d=t.placeholder,h=void 0!==d&&d,f=t.keyCode,m=void 0===f?null:f;if(null!=e){var y=this._store.choices,_=r||e,g=y?y.length+1:1,v=this._baseId+"-"+this._idNames.itemChoice+"-"+g;this._store.dispatch(function(t){return{type:"ADD_CHOICE",value:t.value,label:t.label,id:t.id,groupId:t.groupId,disabled:t.disabled,elementId:t.elementId,customProperties:t.customProperties,placeholder:t.placeholder,keyCode:t.keyCode}}({id:g,groupId:c,elementId:v,value:e,label:_,disabled:s,customProperties:p,placeholder:h,keyCode:m})),o&&this._addItem({value:e,label:_,choiceId:g,customProperties:p,placeholder:h,keyCode:m})}},n._addGroup=function(t){var e=this,n=t.group,r=t.id,i=t.valueKey,o=void 0===i?"value":i,a=t.labelKey,s=void 0===a?"label":a,l=b("Object",n)?n.choices:Array.from(n.getElementsByTagName("OPTION")),c=r||Math.floor((new Date).valueOf()*Math.random()),u=!!n.disabled&&n.disabled;l?(this._store.dispatch(W({value:n.label,id:c,active:!0,disabled:u})),l.forEach(function(t){var n=t.disabled||t.parentNode&&t.parentNode.disabled;e._addChoice({value:t[o],label:b("Object",t)?t[s]:t.innerHTML,isSelected:t.selected,isDisabled:n,groupId:c,customProperties:t.customProperties,placeholder:t.placeholder})})):this._store.dispatch(W({value:n.label,id:n.id,active:!1,disabled:n.disabled}))},n._getTemplate=function(t){var e;if(!t)return null;for(var n=this.config.classNames,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return(e=this._templates[t]).call.apply(e,[this,n].concat(i))},n._createTemplates=function(){var t=this.config.callbackOnCreateTemplates,e={};t&&"function"==typeof t&&(e=t.call(this,w)),this._templates=a()(U,e)},n._createElements=function(){this.containerOuter=new k({element:this._getTemplate("containerOuter",this._direction,this._isSelectElement,this._isSelectOneElement,this.config.searchEnabled,this.passedElement.element.type),classNames:this.config.classNames,type:this.passedElement.element.type,position:this.config.position}),this.containerInner=new k({element:this._getTemplate("containerInner"),classNames:this.config.classNames,type:this.passedElement.element.type,position:this.config.position}),this.input=new B({element:this._getTemplate("input",this._placeholderValue),classNames:this.config.classNames,type:this.passedElement.element.type,preventPaste:!this.config.paste}),this.choiceList=new D({element:this._getTemplate("choiceList",this._isSelectOneElement)}),this.itemList=new D({element:this._getTemplate("itemList",this._isSelectOneElement)}),this.dropdown=new z({element:this._getTemplate("dropdown"),classNames:this.config.classNames,type:this.passedElement.element.type})},n._createStructure=function(){this.passedElement.conceal(),this.containerInner.wrap(this.passedElement.element),this.containerOuter.wrap(this.containerInner.element),this._isSelectOneElement?this.input.placeholder=this.config.searchPlaceholderValue||"":this._placeholderValue&&(this.input.placeholder=this._placeholderValue,this.input.setWidth()),this.containerOuter.element.appendChild(this.containerInner.element),this.containerOuter.element.appendChild(this.dropdown.element),this.containerInner.element.appendChild(this.itemList.element),this._isTextElement||this.dropdown.element.appendChild(this.choiceList.element),this._isSelectOneElement?this.config.searchEnabled&&this.dropdown.element.insertBefore(this.input.element,this.dropdown.element.firstChild):this.containerInner.element.appendChild(this.input.element),this._isSelectElement&&(this._highlightPosition=0,this._isSearching=!1,this._startLoading(),this._presetGroups.length?this._addPredefinedGroups(this._presetGroups):this._addPredefinedChoices(this._presetChoices),this._stopLoading()),this._isTextElement&&this._addPredefinedItems(this._presetItems)},n._addPredefinedGroups=function(t){var e=this,n=this.passedElement.placeholderOption;n&&"SELECT"===n.parentNode.tagName&&this._addChoice({value:n.value,label:n.innerHTML,isSelected:n.selected,isDisabled:n.disabled,placeholder:!0}),t.forEach(function(t){return e._addGroup({group:t,id:t.id||null})})},n._addPredefinedChoices=function(t){var e=this;this.config.shouldSort&&t.sort(this.config.sorter);var n=t.some(function(t){return t.selected}),r=t.findIndex(function(t){return void 0===t.disabled||!t.disabled});t.forEach(function(t,i){var o=t.value,a=t.label,s=t.customProperties,l=t.placeholder;if(e._isSelectElement)if(t.choices)e._addGroup({group:t,id:t.id||null});else{var c=!(!e._isSelectOneElement||n||i!==r)||t.selected,u=t.disabled;e._addChoice({value:o,label:a,isSelected:c,isDisabled:u,customProperties:s,placeholder:l})}else e._addChoice({value:o,label:a,isSelected:t.selected,isDisabled:t.disabled,customProperties:s,placeholder:l})})},n._addPredefinedItems=function(t){var e=this;t.forEach(function(t){"object"==typeof t&&t.value&&e._addItem({value:t.value,label:t.label,choiceId:t.id,customProperties:t.customProperties,placeholder:t.placeholder}),"string"==typeof t&&e._addItem({value:t})})},n._setChoiceOrItem=function(t){var e=this;({object:function(){t.value&&(e._isTextElement?e._addItem({value:t.value,label:t.label,choiceId:t.id,customProperties:t.customProperties,placeholder:t.placeholder}):e._addChoice({value:t.value,label:t.label,isSelected:!0,isDisabled:!1,customProperties:t.customProperties,placeholder:t.placeholder}))},string:function(){e._isTextElement?e._addItem({value:t}):e._addChoice({value:t,label:t,isSelected:!0,isDisabled:!1})}})[v(t).toLowerCase()]()},n._findAndSelectChoiceByValue=function(t){var e=this,n=this._store.choices.find(function(n){return e.config.valueComparer(n.value,t)});n&&!n.selected&&this._addItem({value:n.value,label:n.label,choiceId:n.id,groupId:n.groupId,customProperties:n.customProperties,placeholder:n.placeholder,keyCode:n.keyCode})},n._generatePlaceholderValue=function(){if(this._isSelectElement){var t=this.passedElement.placeholderOption;return!!t&&t.text}var e=this.config,n=e.placeholder,r=e.placeholderValue,i=this.passedElement.element.dataset;if(n){if(r)return r;if(i.placeholder)return i.placeholder}return!1},e}();e.default=Q}]).default,function(t,e){const n="object"==typeof exports?exports:"object"==typeof t?t:{};!function(t){const e=Symbol("newer"),n=Symbol("older");function r(t,e){"number"!=typeof t&&(e=t,t=0),this.size=0,this.limit=t,this.oldest=this.newest=void 0,this._keymap=new Map,e&&(this.assign(e),t<1&&(this.limit=this.size))}function i(t,r){this.key=t,this.value=r,this[e]=void 0,this[n]=void 0}function o(t){this.entry=t}function a(t){this.entry=t}function s(t){this.entry=t}t.LRUMap=r,r.prototype._markEntryAsUsed=function(t){t!==this.newest&&(t[e]&&(t===this.oldest&&(this.oldest=t[e]),t[e][n]=t[n]),t[n]&&(t[n][e]=t[e]),t[e]=void 0,t[n]=this.newest,this.newest&&(this.newest[e]=t),this.newest=t)},r.prototype.assign=function(t){let r,o=this.limit||Number.MAX_VALUE;this._keymap.clear();let a=t[Symbol.iterator]();for(let t=a.next();!t.done;t=a.next()){let a=new i(t.value[0],t.value[1]);if(this._keymap.set(a.key,a),r?(r[e]=a,a[n]=r):this.oldest=a,r=a,0==o--)throw new Error("overflow")}this.newest=r,this.size=this._keymap.size},r.prototype.get=function(t){var e=this._keymap.get(t);if(e)return this._markEntryAsUsed(e),e.value},r.prototype.set=function(t,r){var o=this._keymap.get(t);return o?(o.value=r,this._markEntryAsUsed(o),this):(this._keymap.set(t,o=new i(t,r)),this.newest?(this.newest[e]=o,o[n]=this.newest):this.oldest=o,this.newest=o,++this.size,this.size>this.limit&&this.shift(),this)},r.prototype.shift=function(){var t=this.oldest;if(t)return this.oldest[e]?(this.oldest=this.oldest[e],this.oldest[n]=void 0):(this.oldest=void 0,this.newest=void 0),t[e]=t[n]=void 0,this._keymap.delete(t.key),--this.size,[t.key,t.value]},r.prototype.find=function(t){let e=this._keymap.get(t);return e?e.value:void 0},r.prototype.has=function(t){return this._keymap.has(t)},r.prototype.delete=function(t){var r=this._keymap.get(t);if(r)return this._keymap.delete(r.key),r[e]&&r[n]?(r[n][e]=r[e],r[e][n]=r[n]):r[e]?(r[e][n]=void 0,this.oldest=r[e]):r[n]?(r[n][e]=void 0,this.newest=r[n]):this.oldest=this.newest=void 0,this.size--,r.value},r.prototype.clear=function(){this.oldest=this.newest=void 0,this.size=0,this._keymap.clear()},o.prototype[Symbol.iterator]=function(){return this},o.prototype.next=function(){let t=this.entry;return t?(this.entry=t[e],{done:!1,value:[t.key,t.value]}):{done:!0,value:void 0}},a.prototype[Symbol.iterator]=function(){return this},a.prototype.next=function(){let t=this.entry;return t?(this.entry=t[e],{done:!1,value:t.key}):{done:!0,value:void 0}},s.prototype[Symbol.iterator]=function(){return this},s.prototype.next=function(){let t=this.entry;return t?(this.entry=t[e],{done:!1,value:t.value}):{done:!0,value:void 0}},r.prototype.keys=function(){return new a(this.oldest)},r.prototype.values=function(){return new s(this.oldest)},r.prototype.entries=function(){return this},r.prototype[Symbol.iterator]=function(){return new o(this.oldest)},r.prototype.forEach=function(t,n){"object"!=typeof n&&(n=this);let r=this.oldest;for(;r;)t.call(n,r.value,r.key,this),r=r[e]},r.prototype.toJSON=function(){for(var t=new Array(this.size),n=0,r=this.oldest;r;)t[n++]={key:r.key,value:r.value},r=r[e];return t},r.prototype.toString=function(){for(var t="",n=this.oldest;n;)t+=String(n.key)+":"+n.value,(n=n[e])&&(t+=" < ");return t}}(n),"function"==typeof define&&define.amd&&define("lru",n)}(this),function(t){function e(t){if(n=_(e),!(t<o+d)){for(i+=t-o,o=t,b(t,i),t>c+l&&(a=s*u*1e3/(t-c)+(1-s)*a,c=t,u=0),u++,p=0;i>=r;)if(x(r),i-=r,++p>=240){m=!0;break}w(i/r),E(a,m),m=!1}}var n,r=1e3/60,i=0,o=0,a=60,s=.9,l=1e3,c=0,u=0,p=0,d=0,h=!1,f=!1,m=!1,y="object"==typeof window?window:t,_=y.requestAnimationFrame||function(){var t,e,n=Date.now();return function(i){return t=Date.now(),e=Math.max(0,r-(t-n)),n=t+e,setTimeout(function(){i(t+e)},e)}}(),g=y.cancelAnimationFrame||clearTimeout,v=function(){},b=v,x=v,w=v,E=v;t.MainLoop={getSimulationTimestep:function(){return r},setSimulationTimestep:function(t){return r=t,this},getFPS:function(){return a},getMaxAllowedFPS:function(){return 1e3/d},setMaxAllowedFPS:function(t){return void 0===t&&(t=1/0),0===t?this.stop():d=1e3/t,this},resetFrameDelta:function(){var t=i;return i=0,t},setBegin:function(t){return b=t||b,this},setUpdate:function(t){return x=t||x,this},setDraw:function(t){return w=t||w,this},setEnd:function(t){return E=t||E,this},start:function(){return f||(f=!0,n=_(function(t){w(1),h=!0,o=t,c=t,u=0,n=_(e)})),this},stop:function(){return h=!1,f=!1,g(n),this},isRunning:function(){return h}},"function"==typeof define&&define.amd?define(t.MainLoop):"object"==typeof module&&null!==module&&"object"==typeof module.exports&&(module.exports=t.MainLoop)}(this),t=this,e=function(t){"use strict";var e=function(t){var e,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var i=e&&e.prototype instanceof y?e:y,o=Object.create(i.prototype),a=new C(r||[]);return o._invoke=function(t,e,n){var r=p;return function(i,o){if(r===h)throw new Error("Generator is already running");if(r===f){if("throw"===i)throw o;return R()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===p)throw r=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var l=u(t,e,n);if("normal"===l.type){if(r=n.done?f:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=f,n.method="throw",n.arg=l.arg)}}}(t,n,a),o}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var p="suspendedStart",d="suspendedYield",h="executing",f="completed",m={};function y(){}function _(){}function g(){}var v={};v[o]=function(){return this};var b=Object.getPrototypeOf,x=b&&b(b(z([])));x&&x!==n&&r.call(x,o)&&(v=x);var w=g.prototype=y.prototype=Object.create(v);function E(t){["next","throw","return"].forEach(function(e){l(t,e,function(t){return this._invoke(e,t)})})}function T(t,e){function n(i,o,a,s){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,p=c.value;return p&&"object"==typeof p&&r.call(p,"__await")?e.resolve(p.__await).then(function(t){n("next",t,a,s)},function(t){n("throw",t,a,s)}):e.resolve(p).then(function(t){c.value=t,a(c)},function(t){return n("throw",t,a,s)})}s(l.arg)}var i;this._invoke=function(t,r){function o(){return new e(function(e,i){n(t,r,e,i)})}return i=i?i.then(o,o):o()}}function S(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=u(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var o=i.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function z(t){if(t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:R}}function R(){return{value:e,done:!0}}return _.prototype=w.constructor=g,g.constructor=_,_.displayName=l(g,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,s,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},E(T.prototype),T.prototype[a]=function(){return this},t.AsyncIterator=T,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new T(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then(function(t){return t.done?t.value:a.next()})},E(w),l(w,s,"Generator"),w[o]=function(){return this},w.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=z,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;j(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:z(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),m}},t}("object"==typeof module?module.exports:{});try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}var n="126",r=100,i=300,o=301,a=302,s=303,l=304,c=306,u=307,p=1e3,d=1001,h=1002,f=1003,m=1004,y=1005,_=1006,g=1008,v=1009,b=1012,x=1014,w=1015,E=1016,T=1020,S=1022,M=1023,j=1026,C=1027,z=33776,R=33777,A=33778,L=33779,I=35840,P=35841,O=35842,k=35843,B=37492,D=37496,H=2300,F=2301,N=2302,U=2400,V=2401,G=2402,W=2500,q=2501,X=3e3,Y=3001,Q=3007,Z=3002,J=3004,K=3005,$=3006,tt=7680,et=35044,nt=35048,rt="300 es";function it(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function at(t,e,n){return e&&ot(t.prototype,e),n&&ot(t,n),t}function st(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,function(t,e){(Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}function lt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ut(){}Object.assign(ut.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}}}});for(var pt=[],dt=0;dt<256;dt++)pt[dt]=(dt<16?"0":"")+dt.toString(16);var ht=1234567,ft={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(pt[255&t]+pt[t>>8&255]+pt[t>>16&255]+pt[t>>24&255]+"-"+pt[255&e]+pt[e>>8&255]+"-"+pt[e>>16&15|64]+pt[e>>24&255]+"-"+pt[63&n|128]+pt[n>>8&255]+"-"+pt[n>>16&255]+pt[n>>24&255]+pt[255&r]+pt[r>>8&255]+pt[r>>16&255]+pt[r>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},damp:function(t,e,n,r){return ft.lerp(t,e,1-Math.exp(-n*r))},pingpong:function(t,e){return void 0===e&&(e=1),e-Math.abs(ft.euclideanModulo(t,2*e)-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return void 0!==t&&(ht=t%2147483647),((ht=16807*ht%2147483647)-1)/2147483646},degToRad:function(t){return t*ft.DEG2RAD},radToDeg:function(t){return t*ft.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){var o=Math.cos,a=Math.sin,s=o(n/2),l=a(n/2),c=o((e+r)/2),u=a((e+r)/2),p=o((e-r)/2),d=a((e-r)/2),h=o((r-e)/2),f=a((r-e)/2);switch(i){case"XYX":t.set(s*u,l*p,l*d,s*c);break;case"YZY":t.set(l*d,s*u,l*p,s*c);break;case"ZXZ":t.set(l*p,l*d,s*u,s*c);break;case"XZX":t.set(s*u,l*f,l*h,s*c);break;case"YXY":t.set(l*h,s*u,l*f,s*c);break;case"ZYZ":t.set(l*f,l*h,s*u,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}},mt=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var e=t.prototype;return e.set=function(t,e){return this.x=t,this.y=e,this},e.setScalar=function(t){return this.x=t,this.y=t,this},e.setX=function(t){return this.x=t,this},e.setY=function(t){return this.y=t,this},e.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},e.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},e.clone=function(){return new this.constructor(this.x,this.y)},e.copy=function(t){return this.x=t.x,this.y=t.y,this},e.add=function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},e.addScalar=function(t){return this.x+=t,this.y+=t,this},e.addVectors=function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},e.addScaledVector=function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},e.sub=function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},e.subScalar=function(t){return this.x-=t,this.y-=t,this},e.subVectors=function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},e.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},e.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},e.divide=function(t){return this.x/=t.x,this.y/=t.y,this},e.divideScalar=function(t){return this.multiplyScalar(1/t)},e.applyMatrix3=function(t){var e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this},e.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},e.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},e.clamp=function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},e.clampScalar=function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},e.clampLength=function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},e.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},e.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},e.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},e.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},e.negate=function(){return this.x=-this.x,this.y=-this.y,this},e.dot=function(t){return this.x*t.x+this.y*t.y},e.cross=function(t){return this.x*t.y-this.y*t.x},e.lengthSq=function(){return this.x*this.x+this.y*this.y},e.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},e.normalize=function(){return this.divideScalar(this.length()||1)},e.angle=function(){return Math.atan2(-this.y,-this.x)+Math.PI},e.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},e.distanceToSquared=function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},e.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},e.setLength=function(t){return this.normalize().multiplyScalar(t)},e.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},e.lerpVectors=function(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this},e.equals=function(t){return t.x===this.x&&t.y===this.y},e.fromArray=function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},e.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},e.fromBufferAttribute=function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},e.rotateAround=function(t,e){var n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this},e.random=function(){return this.x=Math.random(),this.y=Math.random(),this},at(t,[{key:"width",get:function(){return this.x},set:function(t){this.x=t}},{key:"height",get:function(){return this.y},set:function(t){this.y=t}}]),t}();mt.prototype.isVector2=!0;var yt,_t=function(){function t(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}var e=t.prototype;return e.set=function(t,e,n,r,i,o,a,s,l){var c=this.elements;return c[0]=t,c[1]=r,c[2]=a,c[3]=e,c[4]=i,c[5]=s,c[6]=n,c[7]=o,c[8]=l,this},e.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},e.copy=function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},e.extractBasis=function(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},e.setFromMatrix4=function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},e.multiply=function(t){return this.multiplyMatrices(this,t)},e.premultiply=function(t){return this.multiplyMatrices(t,this)},e.multiplyMatrices=function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[3],s=n[6],l=n[1],c=n[4],u=n[7],p=n[2],d=n[5],h=n[8],f=r[0],m=r[3],y=r[6],_=r[1],g=r[4],v=r[7],b=r[2],x=r[5],w=r[8];return i[0]=o*f+a*_+s*b,i[3]=o*m+a*g+s*x,i[6]=o*y+a*v+s*w,i[1]=l*f+c*_+u*b,i[4]=l*m+c*g+u*x,i[7]=l*y+c*v+u*w,i[2]=p*f+d*_+h*b,i[5]=p*m+d*g+h*x,i[8]=p*y+d*v+h*w,this},e.multiplyScalar=function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},e.determinant=function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8];return e*o*c-e*a*l-n*i*c+n*a*s+r*i*l-r*o*s},e.invert=function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8],u=c*o-a*l,p=a*s-c*i,d=l*i-o*s,h=e*u+n*p+r*d;if(0===h)return this.set(0,0,0,0,0,0,0,0,0);var f=1/h;return t[0]=u*f,t[1]=(r*l-c*n)*f,t[2]=(a*n-r*o)*f,t[3]=p*f,t[4]=(c*e-r*s)*f,t[5]=(r*i-a*e)*f,t[6]=d*f,t[7]=(n*s-l*e)*f,t[8]=(o*e-n*i)*f,this},e.transpose=function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},e.getNormalMatrix=function(t){return this.setFromMatrix4(t).invert().transpose()},e.transposeIntoArray=function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},e.setUvTransform=function(t,e,n,r,i,o,a){var s=Math.cos(i),l=Math.sin(i);return this.set(n*s,n*l,-n*(s*o+l*a)+o+t,-r*l,r*s,-r*(-l*o+s*a)+a+e,0,0,1),this},e.scale=function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},e.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],l=r[4],c=r[7];return r[0]=e*i+n*s,r[3]=e*o+n*l,r[6]=e*a+n*c,r[1]=-n*i+e*s,r[4]=-n*o+e*l,r[7]=-n*a+e*c,this},e.translate=function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},e.equals=function(t){for(var e=this.elements,n=t.elements,r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},e.fromArray=function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},e.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t},e.clone=function(){return(new this.constructor).fromArray(this.elements)},t}();_t.prototype.isMatrix3=!0;var gt={getDataURL:function(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;var e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===yt&&(yt=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),yt.width=t.width,yt.height=t.height;var n=yt.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=yt}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}},vt=0,bt=function(t){function e(n,r,i,o,a,s,l,c,u,p){var h;return void 0===n&&(n=e.DEFAULT_IMAGE),void 0===r&&(r=e.DEFAULT_MAPPING),void 0===i&&(i=d),void 0===o&&(o=d),void 0===a&&(a=_),void 0===s&&(s=g),void 0===l&&(l=M),void 0===c&&(c=v),void 0===u&&(u=1),void 0===p&&(p=X),h=t.call(this)||this,Object.defineProperty(lt(h),"id",{value:vt++}),h.uuid=ft.generateUUID(),h.name="",h.image=n,h.mipmaps=[],h.mapping=r,h.wrapS=i,h.wrapT=o,h.magFilter=a,h.minFilter=s,h.anisotropy=u,h.format=l,h.internalFormat=null,h.type=c,h.offset=new mt(0,0),h.repeat=new mt(1,1),h.center=new mt(0,0),h.rotation=0,h.matrixAutoUpdate=!0,h.matrix=new _t,h.generateMipmaps=!0,h.premultiplyAlpha=!1,h.flipY=!0,h.unpackAlignment=4,h.encoding=p,h.version=0,h.onUpdate=null,h}st(e,t);var n=e.prototype;return n.updateMatrix=function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},n.clone=function(){return(new this.constructor).copy(this)},n.copy=function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},n.toJSON=function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=ft.generateUUID()),!e&&void 0===t.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var o=0,a=r.length;o<a;o++)r[o].isDataTexture?i.push(xt(r[o].image)):i.push(xt(r[o]))}else i=xt(r);t.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return e||(t.textures[this.uuid]=n),n},n.dispose=function(){this.dispatchEvent({type:"dispose"})},n.transformUv=function(t){if(this.mapping!==i)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case p:t.x=t.x-Math.floor(t.x);break;case d:t.x=t.x<0?0:1;break;case h:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case p:t.y=t.y-Math.floor(t.y);break;case d:t.y=t.y<0?0:1;break;case h:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t},at(e,[{key:"needsUpdate",set:function(t){!0===t&&this.version++}}]),e}(ut);function xt(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?gt.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}bt.DEFAULT_IMAGE=void 0,bt.DEFAULT_MAPPING=i,bt.prototype.isTexture=!0;var wt=function(){function t(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=1),this.x=t,this.y=e,this.z=n,this.w=r}var e=t.prototype;return e.set=function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},e.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},e.setX=function(t){return this.x=t,this},e.setY=function(t){return this.y=t,this},e.setZ=function(t){return this.z=t,this},e.setW=function(t){return this.w=t,this},e.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},e.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},e.clone=function(){return new this.constructor(this.x,this.y,this.z,this.w)},e.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},e.add=function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},e.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},e.addVectors=function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},e.addScaledVector=function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},e.sub=function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},e.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},e.subVectors=function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},e.multiply=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},e.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},e.applyMatrix4=function(t){var e=this.x,n=this.y,r=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*i,this},e.divideScalar=function(t){return this.multiplyScalar(1/t)},e.setAxisAngleFromQuaternion=function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},e.setAxisAngleFromRotationMatrix=function(t){var e,n,r,i,o=.01,a=t.elements,s=a[0],l=a[4],c=a[8],u=a[1],p=a[5],d=a[9],h=a[2],f=a[6],m=a[10];if(Math.abs(l-u)<o&&Math.abs(c-h)<o&&Math.abs(d-f)<o){if(Math.abs(l+u)<.1&&Math.abs(c+h)<.1&&Math.abs(d+f)<.1&&Math.abs(s+p+m-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var y=(s+1)/2,_=(p+1)/2,g=(m+1)/2,v=(l+u)/4,b=(c+h)/4,x=(d+f)/4;return y>_&&y>g?y<o?(n=0,r=.707106781,i=.707106781):(r=v/(n=Math.sqrt(y)),i=b/n):_>g?_<o?(n=.707106781,r=0,i=.707106781):(n=v/(r=Math.sqrt(_)),i=x/r):g<o?(n=.707106781,r=.707106781,i=0):(n=b/(i=Math.sqrt(g)),r=x/i),this.set(n,r,i,e),this}var w=Math.sqrt((f-d)*(f-d)+(c-h)*(c-h)+(u-l)*(u-l));return Math.abs(w)<.001&&(w=1),this.x=(f-d)/w,this.y=(c-h)/w,this.z=(u-l)/w,this.w=Math.acos((s+p+m-1)/2),this},e.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},e.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},e.clamp=function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},e.clampScalar=function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},e.clampLength=function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},e.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},e.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},e.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},e.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},e.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},e.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},e.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},e.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},e.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},e.normalize=function(){return this.divideScalar(this.length()||1)},e.setLength=function(t){return this.normalize().multiplyScalar(t)},e.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},e.lerpVectors=function(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this},e.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},e.fromArray=function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},e.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},e.fromBufferAttribute=function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this},e.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this},at(t,[{key:"width",get:function(){return this.z},set:function(t){this.z=t}},{key:"height",get:function(){return this.w},set:function(t){this.w=t}}]),t}();wt.prototype.isVector4=!0;var Et=function(t){function e(e,n,r){var i;return(i=t.call(this)||this).width=e,i.height=n,i.depth=1,i.scissor=new wt(0,0,e,n),i.scissorTest=!1,i.viewport=new wt(0,0,e,n),r=r||{},i.texture=new bt(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),i.texture.image={},i.texture.image.width=e,i.texture.image.height=n,i.texture.image.depth=1,i.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,i.texture.minFilter=void 0!==r.minFilter?r.minFilter:_,i.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,i.stencilBuffer=void 0!==r.stencilBuffer&&r.stencilBuffer,i.depthTexture=void 0!==r.depthTexture?r.depthTexture:null,i}st(e,t);var n=e.prototype;return n.setTexture=function(t){t.image={width:this.width,height:this.height,depth:this.depth},this.texture=t},n.setSize=function(t,e,n){void 0===n&&(n=1),this.width===t&&this.height===e&&this.depth===n||(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},n.clone=function(){return(new this.constructor).copy(this)},n.copy=function(t){return this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},n.dispose=function(){this.dispatchEvent({type:"dispose"})},e}(ut);Et.prototype.isWebGLRenderTarget=!0;var Tt=function(t){function e(e,n,r){var i;return(i=t.call(this,e,n,r)||this).samples=4,i}return st(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.samples=e.samples,this},e}(Et);Tt.prototype.isWebGLMultisampleRenderTarget=!0;var St=function(){function t(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=1),this._x=t,this._y=e,this._z=n,this._w=r}t.slerp=function(t,e,n,r){return n.copy(t).slerp(e,r)},t.slerpFlat=function(t,e,n,r,i,o,a){var s=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3],p=i[o+0],d=i[o+1],h=i[o+2],f=i[o+3];if(0===a)return t[e+0]=s,t[e+1]=l,t[e+2]=c,void(t[e+3]=u);if(1===a)return t[e+0]=p,t[e+1]=d,t[e+2]=h,void(t[e+3]=f);if(u!==f||s!==p||l!==d||c!==h){var m=1-a,y=s*p+l*d+c*h+u*f,_=y>=0?1:-1,g=1-y*y;if(g>Number.EPSILON){var v=Math.sqrt(g),b=Math.atan2(v,y*_);m=Math.sin(m*b)/v,a=Math.sin(a*b)/v}var x=a*_;if(s=s*m+p*x,l=l*m+d*x,c=c*m+h*x,u=u*m+f*x,m===1-a){var w=1/Math.sqrt(s*s+l*l+c*c+u*u);s*=w,l*=w,c*=w,u*=w}}t[e]=s,t[e+1]=l,t[e+2]=c,t[e+3]=u},t.multiplyQuaternionsFlat=function(t,e,n,r,i,o){var a=n[r],s=n[r+1],l=n[r+2],c=n[r+3],u=i[o],p=i[o+1],d=i[o+2],h=i[o+3];return t[e]=a*h+c*u+s*d-l*p,t[e+1]=s*h+c*p+l*u-a*d,t[e+2]=l*h+c*d+a*p-s*u,t[e+3]=c*h-a*u-s*p-l*d,t};var e=t.prototype;return e.set=function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this},e.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)},e.copy=function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},e.setFromEuler=function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,o=t._order,a=Math.cos,s=Math.sin,l=a(n/2),c=a(r/2),u=a(i/2),p=s(n/2),d=s(r/2),h=s(i/2);switch(o){case"XYZ":this._x=p*c*u+l*d*h,this._y=l*d*u-p*c*h,this._z=l*c*h+p*d*u,this._w=l*c*u-p*d*h;break;case"YXZ":this._x=p*c*u+l*d*h,this._y=l*d*u-p*c*h,this._z=l*c*h-p*d*u,this._w=l*c*u+p*d*h;break;case"ZXY":this._x=p*c*u-l*d*h,this._y=l*d*u+p*c*h,this._z=l*c*h+p*d*u,this._w=l*c*u-p*d*h;break;case"ZYX":this._x=p*c*u-l*d*h,this._y=l*d*u+p*c*h,this._z=l*c*h-p*d*u,this._w=l*c*u+p*d*h;break;case"YZX":this._x=p*c*u+l*d*h,this._y=l*d*u+p*c*h,this._z=l*c*h-p*d*u,this._w=l*c*u-p*d*h;break;case"XZY":this._x=p*c*u-l*d*h,this._y=l*d*u-p*c*h,this._z=l*c*h+p*d*u,this._w=l*c*u+p*d*h;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==e&&this._onChangeCallback(),this},e.setFromAxisAngle=function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},e.setFromRotationMatrix=function(t){var e=t.elements,n=e[0],r=e[4],i=e[8],o=e[1],a=e[5],s=e[9],l=e[2],c=e[6],u=e[10],p=n+a+u;if(p>0){var d=.5/Math.sqrt(p+1);this._w=.25/d,this._x=(c-s)*d,this._y=(i-l)*d,this._z=(o-r)*d}else if(n>a&&n>u){var h=2*Math.sqrt(1+n-a-u);this._w=(c-s)/h,this._x=.25*h,this._y=(r+o)/h,this._z=(i+l)/h}else if(a>u){var f=2*Math.sqrt(1+a-n-u);this._w=(i-l)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(s+c)/f}else{var m=2*Math.sqrt(1+u-n-a);this._w=(o-r)/m,this._x=(i+l)/m,this._y=(s+c)/m,this._z=.25*m}return this._onChangeCallback(),this},e.setFromUnitVectors=function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()},e.angleTo=function(t){return 2*Math.acos(Math.abs(ft.clamp(this.dot(t),-1,1)))},e.rotateTowards=function(t,e){var n=this.angleTo(t);if(0===n)return this;var r=Math.min(1,e/n);return this.slerp(t,r),this},e.identity=function(){return this.set(0,0,0,1)},e.invert=function(){return this.conjugate()},e.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},e.dot=function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},e.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},e.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},e.normalize=function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},e.multiply=function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},e.premultiply=function(t){return this.multiplyQuaternions(t,this)},e.multiplyQuaternions=function(t,e){var n=t._x,r=t._y,i=t._z,o=t._w,a=e._x,s=e._y,l=e._z,c=e._w;return this._x=n*c+o*a+r*l-i*s,this._y=r*c+o*s+i*a-n*l,this._z=i*c+o*l+n*s-r*a,this._w=o*c-n*a-r*s-i*l,this._onChangeCallback(),this},e.slerp=function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*t._w+n*t._x+r*t._y+i*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=1-a*a;if(s<=Number.EPSILON){var l=1-e;return this._w=l*o+e*this._w,this._x=l*n+e*this._x,this._y=l*r+e*this._y,this._z=l*i+e*this._z,this.normalize(),this._onChangeCallback(),this}var c=Math.sqrt(s),u=Math.atan2(c,a),p=Math.sin((1-e)*u)/c,d=Math.sin(e*u)/c;return this._w=o*p+this._w*d,this._x=n*p+this._x*d,this._y=r*p+this._y*d,this._z=i*p+this._z*d,this._onChangeCallback(),this},e.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},e.fromArray=function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},e.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},e.fromBufferAttribute=function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},e._onChange=function(t){return this._onChangeCallback=t,this},e._onChangeCallback=function(){},at(t,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}]),t}();St.prototype.isQuaternion=!0;var Mt=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=e,this.z=n}var e=t.prototype;return e.set=function(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this},e.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this},e.setX=function(t){return this.x=t,this},e.setY=function(t){return this.y=t,this},e.setZ=function(t){return this.z=t,this},e.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},e.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},e.clone=function(){return new this.constructor(this.x,this.y,this.z)},e.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},e.add=function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},e.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this},e.addVectors=function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},e.addScaledVector=function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},e.sub=function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},e.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this},e.subVectors=function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},e.multiply=function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},e.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this},e.multiplyVectors=function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},e.applyEuler=function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Ct.setFromEuler(t))},e.applyAxisAngle=function(t,e){return this.applyQuaternion(Ct.setFromAxisAngle(t,e))},e.applyMatrix3=function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},e.applyNormalMatrix=function(t){return this.applyMatrix3(t).normalize()},e.applyMatrix4=function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this},e.applyQuaternion=function(t){var e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z,s=t.w,l=s*e+o*r-a*n,c=s*n+a*e-i*r,u=s*r+i*n-o*e,p=-i*e-o*n-a*r;return this.x=l*s+p*-i+c*-a-u*-o,this.y=c*s+p*-o+u*-i-l*-a,this.z=u*s+p*-a+l*-o-c*-i,this},e.project=function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},e.unproject=function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},e.transformDirection=function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},e.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},e.divideScalar=function(t){return this.multiplyScalar(1/t)},e.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},e.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},e.clamp=function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},e.clampScalar=function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},e.clampLength=function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},e.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},e.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},e.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},e.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},e.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},e.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},e.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},e.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},e.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},e.normalize=function(){return this.divideScalar(this.length()||1)},e.setLength=function(t){return this.normalize().multiplyScalar(t)},e.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},e.lerpVectors=function(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this},e.cross=function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},e.crossVectors=function(t,e){var n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},e.projectOnVector=function(t){var e=t.lengthSq();if(0===e)return this.set(0,0,0);var n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)},e.projectOnPlane=function(t){return jt.copy(this).projectOnVector(t),this.sub(jt)},e.reflect=function(t){return this.sub(jt.copy(t).multiplyScalar(2*this.dot(t)))},e.angleTo=function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;var n=this.dot(t)/e;return Math.acos(ft.clamp(n,-1,1))},e.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},e.distanceToSquared=function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},e.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},e.setFromSpherical=function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},e.setFromSphericalCoords=function(t,e,n){var r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this},e.setFromCylindrical=function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},e.setFromCylindricalCoords=function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},e.setFromMatrixPosition=function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},e.setFromMatrixScale=function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},e.setFromMatrixColumn=function(t,e){return this.fromArray(t.elements,4*e)},e.setFromMatrix3Column=function(t,e){return this.fromArray(t.elements,3*e)},e.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},e.fromArray=function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},e.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},e.fromBufferAttribute=function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this},e.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this},t}();Mt.prototype.isVector3=!0;var jt=new Mt,Ct=new St,zt=function(){function t(t,e){void 0===t&&(t=new Mt(1/0,1/0,1/0)),void 0===e&&(e=new Mt(-1/0,-1/0,-1/0)),this.min=t,this.max=e}var e=t.prototype;return e.set=function(t,e){return this.min.copy(t),this.max.copy(e),this},e.setFromArray=function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,l=t.length;s<l;s+=3){var c=t[s],u=t[s+1],p=t[s+2];c<e&&(e=c),u<n&&(n=u),p<r&&(r=p),c>i&&(i=c),u>o&&(o=u),p>a&&(a=p)}return this.min.set(e,n,r),this.max.set(i,o,a),this},e.setFromBufferAttribute=function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,l=t.count;s<l;s++){var c=t.getX(s),u=t.getY(s),p=t.getZ(s);c<e&&(e=c),u<n&&(n=u),p<r&&(r=p),c>i&&(i=c),u>o&&(o=u),p>a&&(a=p)}return this.min.set(e,n,r),this.max.set(i,o,a),this},e.setFromPoints=function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},e.setFromCenterAndSize=function(t,e){var n=At.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},e.setFromObject=function(t){return this.makeEmpty(),this.expandByObject(t)},e.clone=function(){return(new this.constructor).copy(this)},e.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},e.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},e.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},e.getCenter=function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new Mt),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},e.getSize=function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new Mt),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},e.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},e.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},e.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},e.expandByObject=function(t){t.updateWorldMatrix(!1,!1);var e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),Lt.copy(e.boundingBox),Lt.applyMatrix4(t.matrixWorld),this.union(Lt));for(var n=t.children,r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this},e.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},e.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},e.getParameter=function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new Mt),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},e.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},e.intersectsSphere=function(t){return this.clampPoint(t.center,At),At.distanceToSquared(t.center)<=t.radius*t.radius},e.intersectsPlane=function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant},e.intersectsTriangle=function(t){if(this.isEmpty())return!1;this.getCenter(Ht),Ft.subVectors(this.max,Ht),It.subVectors(t.a,Ht),Pt.subVectors(t.b,Ht),Ot.subVectors(t.c,Ht),kt.subVectors(Pt,It),Bt.subVectors(Ot,Pt),Dt.subVectors(It,Ot);var e=[0,-kt.z,kt.y,0,-Bt.z,Bt.y,0,-Dt.z,Dt.y,kt.z,0,-kt.x,Bt.z,0,-Bt.x,Dt.z,0,-Dt.x,-kt.y,kt.x,0,-Bt.y,Bt.x,0,-Dt.y,Dt.x,0];return!!Vt(e,It,Pt,Ot,Ft)&&!!Vt(e=[1,0,0,0,1,0,0,0,1],It,Pt,Ot,Ft)&&(Nt.crossVectors(kt,Bt),Vt(e=[Nt.x,Nt.y,Nt.z],It,Pt,Ot,Ft))},e.clampPoint=function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new Mt),e.copy(t).clamp(this.min,this.max)},e.distanceToPoint=function(t){return At.copy(t).clamp(this.min,this.max).sub(t).length()},e.getBoundingSphere=function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(At).length(),t},e.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},e.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},e.applyMatrix4=function(t){return this.isEmpty()||(Rt[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Rt[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Rt[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Rt[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Rt[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Rt[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Rt[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Rt[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Rt)),this},e.translate=function(t){return this.min.add(t),this.max.add(t),this},e.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},t}();zt.prototype.isBox3=!0;var Rt=[new Mt,new Mt,new Mt,new Mt,new Mt,new Mt,new Mt,new Mt],At=new Mt,Lt=new zt,It=new Mt,Pt=new Mt,Ot=new Mt,kt=new Mt,Bt=new Mt,Dt=new Mt,Ht=new Mt,Ft=new Mt,Nt=new Mt,Ut=new Mt;function Vt(t,e,n,r,i){for(var o=0,a=t.length-3;o<=a;o+=3){Ut.fromArray(t,o);var s=i.x*Math.abs(Ut.x)+i.y*Math.abs(Ut.y)+i.z*Math.abs(Ut.z),l=e.dot(Ut),c=n.dot(Ut),u=r.dot(Ut);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>s)return!1}return!0}var Gt=new zt,Wt=function(){function t(t,e){void 0===t&&(t=new Mt),void 0===e&&(e=-1),this.center=t,this.radius=e}var e=t.prototype;return e.set=function(t,e){return this.center.copy(t),this.radius=e,this},e.setFromPoints=function(t,e){var n=this.center;void 0!==e?n.copy(e):Gt.setFromPoints(t).getCenter(n);for(var r=0,i=0,o=t.length;i<o;i++)r=Math.max(r,n.distanceToSquared(t[i]));return this.radius=Math.sqrt(r),this},e.copy=function(t){return this.center.copy(t.center),this.radius=t.radius,this},e.isEmpty=function(){return this.radius<0},e.makeEmpty=function(){return this.center.set(0,0,0),this.radius=-1,this},e.containsPoint=function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},e.distanceToPoint=function(t){return t.distanceTo(this.center)-this.radius},e.intersectsSphere=function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},e.intersectsBox=function(t){return t.intersectsSphere(this)},e.intersectsPlane=function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},e.clampPoint=function(t,e){var n=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new Mt),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},e.getBoundingBox=function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new zt),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)},e.applyMatrix4=function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},e.translate=function(t){return this.center.add(t),this},e.equals=function(t){return t.center.equals(this.center)&&t.radius===this.radius},e.clone=function(){return(new this.constructor).copy(this)},t}(),qt=new Mt,Xt=new Mt,Yt=new Mt,Qt=new Mt,Zt=new Mt,Jt=new Mt,Kt=new Mt,$t=function(){function t(t,e){void 0===t&&(t=new Mt),void 0===e&&(e=new Mt(0,0,-1)),this.origin=t,this.direction=e}var e=t.prototype;return e.set=function(t,e){return this.origin.copy(t),this.direction.copy(e),this},e.copy=function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},e.at=function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new Mt),e.copy(this.direction).multiplyScalar(t).add(this.origin)},e.lookAt=function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},e.recast=function(t){return this.origin.copy(this.at(t,qt)),this},e.closestPointToPoint=function(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new Mt),e.subVectors(t,this.origin);var n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)},e.distanceToPoint=function(t){return Math.sqrt(this.distanceSqToPoint(t))},e.distanceSqToPoint=function(t){var e=qt.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(qt.copy(this.direction).multiplyScalar(e).add(this.origin),qt.distanceToSquared(t))},e.distanceSqToSegment=function(t,e,n,r){Xt.copy(t).add(e).multiplyScalar(.5),Yt.copy(e).sub(t).normalize(),Qt.copy(this.origin).sub(Xt);var i,o,a,s,l=.5*t.distanceTo(e),c=-this.direction.dot(Yt),u=Qt.dot(this.direction),p=-Qt.dot(Yt),d=Qt.lengthSq(),h=Math.abs(1-c*c);if(h>0)if(o=c*u-p,s=l*h,(i=c*p-u)>=0)if(o>=-s)if(o<=s){var f=1/h;a=(i*=f)*(i+c*(o*=f)+2*u)+o*(c*i+o+2*p)+d}else o=l,a=-(i=Math.max(0,-(c*o+u)))*i+o*(o+2*p)+d;else o=-l,a=-(i=Math.max(0,-(c*o+u)))*i+o*(o+2*p)+d;else o<=-s?a=-(i=Math.max(0,-(-c*l+u)))*i+(o=i>0?-l:Math.min(Math.max(-l,-p),l))*(o+2*p)+d:o<=s?(i=0,a=(o=Math.min(Math.max(-l,-p),l))*(o+2*p)+d):a=-(i=Math.max(0,-(c*l+u)))*i+(o=i>0?l:Math.min(Math.max(-l,-p),l))*(o+2*p)+d;else o=c>0?-l:l,a=-(i=Math.max(0,-(c*o+u)))*i+o*(o+2*p)+d;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(Yt).multiplyScalar(o).add(Xt),a},e.intersectSphere=function(t,e){qt.subVectors(t.center,this.origin);var n=qt.dot(this.direction),r=qt.dot(qt)-n*n,i=t.radius*t.radius;if(r>i)return null;var o=Math.sqrt(i-r),a=n-o,s=n+o;return a<0&&s<0?null:a<0?this.at(s,e):this.at(a,e)},e.intersectsSphere=function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},e.distanceToPlane=function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},e.intersectPlane=function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},e.intersectsPlane=function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},e.intersectBox=function(t,e){var n,r,i,o,a,s,l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,p=this.origin;return l>=0?(n=(t.min.x-p.x)*l,r=(t.max.x-p.x)*l):(n=(t.max.x-p.x)*l,r=(t.min.x-p.x)*l),c>=0?(i=(t.min.y-p.y)*c,o=(t.max.y-p.y)*c):(i=(t.max.y-p.y)*c,o=(t.min.y-p.y)*c),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),u>=0?(a=(t.min.z-p.z)*u,s=(t.max.z-p.z)*u):(a=(t.max.z-p.z)*u,s=(t.min.z-p.z)*u),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,e)))},e.intersectsBox=function(t){return null!==this.intersectBox(t,qt)},e.intersectTriangle=function(t,e,n,r,i){Zt.subVectors(e,t),Jt.subVectors(n,t),Kt.crossVectors(Zt,Jt);var o,a=this.direction.dot(Kt);if(a>0){if(r)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}Qt.subVectors(this.origin,t);var s=o*this.direction.dot(Jt.crossVectors(Qt,Jt));if(s<0)return null;var l=o*this.direction.dot(Zt.cross(Qt));if(l<0)return null;if(s+l>a)return null;var c=-o*Qt.dot(Kt);return c<0?null:this.at(c/a,i)},e.applyMatrix4=function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},e.equals=function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)},e.clone=function(){return(new this.constructor).copy(this)},t}(),te=function(){function t(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}var e=t.prototype;return e.set=function(t,e,n,r,i,o,a,s,l,c,u,p,d,h,f,m){var y=this.elements;return y[0]=t,y[4]=e,y[8]=n,y[12]=r,y[1]=i,y[5]=o,y[9]=a,y[13]=s,y[2]=l,y[6]=c,y[10]=u,y[14]=p,y[3]=d,y[7]=h,y[11]=f,y[15]=m,this},e.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},e.clone=function(){return(new t).fromArray(this.elements)},e.copy=function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},e.copyPosition=function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},e.setFromMatrix3=function(t){var e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this},e.extractBasis=function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},e.makeBasis=function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},e.extractRotation=function(t){var e=this.elements,n=t.elements,r=1/ee.setFromMatrixColumn(t,0).length(),i=1/ee.setFromMatrixColumn(t,1).length(),o=1/ee.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},e.makeRotationFromEuler=function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),l=Math.sin(r),c=Math.cos(i),u=Math.sin(i);if("XYZ"===t.order){var p=o*c,d=o*u,h=a*c,f=a*u;e[0]=s*c,e[4]=-s*u,e[8]=l,e[1]=d+h*l,e[5]=p-f*l,e[9]=-a*s,e[2]=f-p*l,e[6]=h+d*l,e[10]=o*s}else if("YXZ"===t.order){var m=s*c,y=s*u,_=l*c,g=l*u;e[0]=m+g*a,e[4]=_*a-y,e[8]=o*l,e[1]=o*u,e[5]=o*c,e[9]=-a,e[2]=y*a-_,e[6]=g+m*a,e[10]=o*s}else if("ZXY"===t.order){var v=s*c,b=s*u,x=l*c,w=l*u;e[0]=v-w*a,e[4]=-o*u,e[8]=x+b*a,e[1]=b+x*a,e[5]=o*c,e[9]=w-v*a,e[2]=-o*l,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){var E=o*c,T=o*u,S=a*c,M=a*u;e[0]=s*c,e[4]=S*l-T,e[8]=E*l+M,e[1]=s*u,e[5]=M*l+E,e[9]=T*l-S,e[2]=-l,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){var j=o*s,C=o*l,z=a*s,R=a*l;e[0]=s*c,e[4]=R-j*u,e[8]=z*u+C,e[1]=u,e[5]=o*c,e[9]=-a*c,e[2]=-l*c,e[6]=C*u+z,e[10]=j-R*u}else if("XZY"===t.order){var A=o*s,L=o*l,I=a*s,P=a*l;e[0]=s*c,e[4]=-u,e[8]=l*c,e[1]=A*u+P,e[5]=o*c,e[9]=L*u-I,e[2]=I*u-L,e[6]=a*c,e[10]=P*u+A}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},e.makeRotationFromQuaternion=function(t){return this.compose(re,t,ie)},e.lookAt=function(t,e,n){var r=this.elements;return se.subVectors(t,e),0===se.lengthSq()&&(se.z=1),se.normalize(),oe.crossVectors(n,se),0===oe.lengthSq()&&(1===Math.abs(n.z)?se.x+=1e-4:se.z+=1e-4,se.normalize(),oe.crossVectors(n,se)),oe.normalize(),ae.crossVectors(se,oe),r[0]=oe.x,r[4]=ae.x,r[8]=se.x,r[1]=oe.y,r[5]=ae.y,r[9]=se.y,r[2]=oe.z,r[6]=ae.z,r[10]=se.z,this},e.multiply=function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},e.premultiply=function(t){return this.multiplyMatrices(t,this)},e.multiplyMatrices=function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[4],s=n[8],l=n[12],c=n[1],u=n[5],p=n[9],d=n[13],h=n[2],f=n[6],m=n[10],y=n[14],_=n[3],g=n[7],v=n[11],b=n[15],x=r[0],w=r[4],E=r[8],T=r[12],S=r[1],M=r[5],j=r[9],C=r[13],z=r[2],R=r[6],A=r[10],L=r[14],I=r[3],P=r[7],O=r[11],k=r[15];return i[0]=o*x+a*S+s*z+l*I,i[4]=o*w+a*M+s*R+l*P,i[8]=o*E+a*j+s*A+l*O,i[12]=o*T+a*C+s*L+l*k,i[1]=c*x+u*S+p*z+d*I,i[5]=c*w+u*M+p*R+d*P,i[9]=c*E+u*j+p*A+d*O,i[13]=c*T+u*C+p*L+d*k,i[2]=h*x+f*S+m*z+y*I,i[6]=h*w+f*M+m*R+y*P,i[10]=h*E+f*j+m*A+y*O,i[14]=h*T+f*C+m*L+y*k,i[3]=_*x+g*S+v*z+b*I,i[7]=_*w+g*M+v*R+b*P,i[11]=_*E+g*j+v*A+b*O,i[15]=_*T+g*C+v*L+b*k,this},e.multiplyScalar=function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},e.determinant=function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],a=t[5],s=t[9],l=t[13],c=t[2],u=t[6],p=t[10],d=t[14];return t[3]*(+i*s*u-r*l*u-i*a*p+n*l*p+r*a*d-n*s*d)+t[7]*(+e*s*d-e*l*p+i*o*p-r*o*d+r*l*c-i*s*c)+t[11]*(+e*l*u-e*a*d-i*o*u+n*o*d+i*a*c-n*l*c)+t[15]*(-r*a*c-e*s*u+e*a*p+r*o*u-n*o*p+n*s*c)},e.transpose=function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},e.setPosition=function(t,e,n){var r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this},e.invert=function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8],u=t[9],p=t[10],d=t[11],h=t[12],f=t[13],m=t[14],y=t[15],_=u*m*l-f*p*l+f*s*d-a*m*d-u*s*y+a*p*y,g=h*p*l-c*m*l-h*s*d+o*m*d+c*s*y-o*p*y,v=c*f*l-h*u*l+h*a*d-o*f*d-c*a*y+o*u*y,b=h*u*s-c*f*s-h*a*p+o*f*p+c*a*m-o*u*m,x=e*_+n*g+r*v+i*b;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var w=1/x;return t[0]=_*w,t[1]=(f*p*i-u*m*i-f*r*d+n*m*d+u*r*y-n*p*y)*w,t[2]=(a*m*i-f*s*i+f*r*l-n*m*l-a*r*y+n*s*y)*w,t[3]=(u*s*i-a*p*i-u*r*l+n*p*l+a*r*d-n*s*d)*w,t[4]=g*w,t[5]=(c*m*i-h*p*i+h*r*d-e*m*d-c*r*y+e*p*y)*w,t[6]=(h*s*i-o*m*i-h*r*l+e*m*l+o*r*y-e*s*y)*w,t[7]=(o*p*i-c*s*i+c*r*l-e*p*l-o*r*d+e*s*d)*w,t[8]=v*w,t[9]=(h*u*i-c*f*i-h*n*d+e*f*d+c*n*y-e*u*y)*w,t[10]=(o*f*i-h*a*i+h*n*l-e*f*l-o*n*y+e*a*y)*w,t[11]=(c*a*i-o*u*i-c*n*l+e*u*l+o*n*d-e*a*d)*w,t[12]=b*w,t[13]=(c*f*r-h*u*r+h*n*p-e*f*p-c*n*m+e*u*m)*w,t[14]=(h*a*r-o*f*r-h*n*s+e*f*s+o*n*m-e*a*m)*w,t[15]=(o*u*r-c*a*r+c*n*s-e*u*s-o*n*p+e*a*p)*w,this},e.scale=function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},e.getMaxScaleOnAxis=function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},e.makeTranslation=function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},e.makeRotationX=function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},e.makeRotationY=function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},e.makeRotationZ=function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},e.makeRotationAxis=function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,a=t.y,s=t.z,l=i*o,c=i*a;return this.set(l*o+n,l*a-r*s,l*s+r*a,0,l*a+r*s,c*a+n,c*s-r*o,0,l*s-r*a,c*s+r*o,i*s*s+n,0,0,0,0,1),this},e.makeScale=function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},e.makeShear=function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},e.compose=function(t,e,n){var r=this.elements,i=e._x,o=e._y,a=e._z,s=e._w,l=i+i,c=o+o,u=a+a,p=i*l,d=i*c,h=i*u,f=o*c,m=o*u,y=a*u,_=s*l,g=s*c,v=s*u,b=n.x,x=n.y,w=n.z;return r[0]=(1-(f+y))*b,r[1]=(d+v)*b,r[2]=(h-g)*b,r[3]=0,r[4]=(d-v)*x,r[5]=(1-(p+y))*x,r[6]=(m+_)*x,r[7]=0,r[8]=(h+g)*w,r[9]=(m-_)*w,r[10]=(1-(p+f))*w,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this},e.decompose=function(t,e,n){var r=this.elements,i=ee.set(r[0],r[1],r[2]).length(),o=ee.set(r[4],r[5],r[6]).length(),a=ee.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],ne.copy(this);var s=1/i,l=1/o,c=1/a;return ne.elements[0]*=s,ne.elements[1]*=s,ne.elements[2]*=s,ne.elements[4]*=l,ne.elements[5]*=l,ne.elements[6]*=l,ne.elements[8]*=c,ne.elements[9]*=c,ne.elements[10]*=c,e.setFromRotationMatrix(ne),n.x=i,n.y=o,n.z=a,this},e.makePerspective=function(t,e,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(e-t),l=2*i/(n-r),c=(e+t)/(e-t),u=(n+r)/(n-r),p=-(o+i)/(o-i),d=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=p,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},e.makeOrthographic=function(t,e,n,r,i,o){var a=this.elements,s=1/(e-t),l=1/(n-r),c=1/(o-i),u=(e+t)*s,p=(n+r)*l,d=(o+i)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-p,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},e.equals=function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},e.fromArray=function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},e.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t},t}();te.prototype.isMatrix4=!0;var ee=new Mt,ne=new te,re=new Mt(0,0,0),ie=new Mt(1,1,1),oe=new Mt,ae=new Mt,se=new Mt,le=new te,ce=new St,ue=function(){function t(e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=t.DefaultOrder),this._x=e,this._y=n,this._z=r,this._order=i}var e=t.prototype;return e.set=function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},e.clone=function(){return new this.constructor(this._x,this._y,this._z,this._order)},e.copy=function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},e.setFromRotationMatrix=function(t,e,n){var r=ft.clamp,i=t.elements,o=i[0],a=i[4],s=i[8],l=i[1],c=i[5],u=i[9],p=i[2],d=i[6],h=i[10];switch(e=e||this._order){case"XYZ":this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-u,h),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-r(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(s,h),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-p,o),this._z=0);break;case"ZXY":this._x=Math.asin(r(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-p,h),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-r(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(d,h),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,c));break;case"YZX":this._z=Math.asin(r(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-p,o)):(this._x=0,this._y=Math.atan2(s,h));break;case"XZY":this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-u,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!1!==n&&this._onChangeCallback(),this},e.setFromQuaternion=function(t,e,n){return le.makeRotationFromQuaternion(t),this.setFromRotationMatrix(le,e,n)},e.setFromVector3=function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},e.reorder=function(t){return ce.setFromEuler(this),this.setFromQuaternion(ce,t)},e.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},e.fromArray=function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},e.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},e.toVector3=function(t){return t?t.set(this._x,this._y,this._z):new Mt(this._x,this._y,this._z)},e._onChange=function(t){return this._onChangeCallback=t,this},e._onChangeCallback=function(){},at(t,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}]),t}();ue.prototype.isEuler=!0,ue.DefaultOrder="XYZ",ue.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var pe=function(){function t(){this.mask=1}var e=t.prototype;return e.set=function(t){this.mask=1<<t|0},e.enable=function(t){this.mask|=1<<t|0},e.enableAll=function(){this.mask=-1},e.toggle=function(t){this.mask^=1<<t|0},e.disable=function(t){this.mask&=~(1<<t|0)},e.disableAll=function(){this.mask=0},e.test=function(t){return 0!=(this.mask&t.mask)},t}(),de=0,he=new Mt,fe=new St,me=new te,ye=new Mt,_e=new Mt,ge=new Mt,ve=new St,be=new Mt(1,0,0),xe=new Mt(0,1,0),we=new Mt(0,0,1),Ee={type:"added"},Te={type:"removed"};function Se(){Object.defineProperty(this,"id",{value:de++}),this.uuid=ft.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Se.DefaultUp.clone();var t=new Mt,e=new ue,n=new St,r=new Mt(1,1,1);e._onChange(function(){n.setFromEuler(e,!1)}),n._onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new te},normalMatrix:{value:new _t}}),this.matrix=new te,this.matrixWorld=new te,this.matrixAutoUpdate=Se.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new pe,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}Se.DefaultUp=new Mt(0,1,0),Se.DefaultMatrixAutoUpdate=!0,Se.prototype=Object.assign(Object.create(ut.prototype),{constructor:Se,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return fe.setFromAxisAngle(t,e),this.quaternion.multiply(fe),this},rotateOnWorldAxis:function(t,e){return fe.setFromAxisAngle(t,e),this.quaternion.premultiply(fe),this},rotateX:function(t){return this.rotateOnAxis(be,t)},rotateY:function(t){return this.rotateOnAxis(xe,t)},rotateZ:function(t){return this.rotateOnAxis(we,t)},translateOnAxis:function(t,e){return he.copy(t).applyQuaternion(this.quaternion),this.position.add(he.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(be,t)},translateY:function(t){return this.translateOnAxis(xe,t)},translateZ:function(t){return this.translateOnAxis(we,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(me.copy(this.matrixWorld).invert())},lookAt:function(t,e,n){t.isVector3?ye.copy(t):ye.set(t,e,n);var r=this.parent;this.updateWorldMatrix(!0,!1),_e.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?me.lookAt(_e,ye,this.up):me.lookAt(ye,_e,this.up),this.quaternion.setFromRotationMatrix(me),r&&(me.extractRotation(r.matrixWorld),fe.setFromRotationMatrix(me),this.quaternion.premultiply(fe.invert()))},add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Ee)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(Te)),this},clear:function(){for(var t=0;t<this.children.length;t++){var e=this.children[t];e.parent=null,e.dispatchEvent(Te)}return this.children.length=0,this},attach:function(t){return this.updateWorldMatrix(!0,!1),me.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),me.multiply(t.parent.matrixWorld)),t.applyMatrix4(me),this.add(t),t.updateWorldMatrix(!1,!0),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new Mt),this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new St),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_e,t,ge),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new Mt),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_e,ve,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new Mt),this.updateWorldMatrix(!0,!1);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var r=this.children,i=0,o=r.length;i<o;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(t){var e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,l=a.length;s<l;s++){var c=a[s];i(t.shapes,c)}else i(t.shapes,a)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var u=[],p=0,d=this.material.length;p<d;p++)u.push(i(t.materials,this.material[p]));r.material=u}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(var h=0;h<this.children.length;h++)r.children.push(this.children[h].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(var f=0;f<this.animations.length;f++){var m=this.animations[f];r.animations.push(i(t.animations,m))}}if(e){var y=E(t.geometries),_=E(t.materials),g=E(t.textures),v=E(t.images),b=E(t.shapes),x=E(t.skeletons),w=E(t.animations);y.length>0&&(n.geometries=y),_.length>0&&(n.materials=_),g.length>0&&(n.textures=g),v.length>0&&(n.images=v),b.length>0&&(n.shapes=b),x.length>0&&(n.skeletons=x),w.length>0&&(n.animations=w)}return n.object=r,n;function E(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var r=t.children[n];this.add(r.clone())}return this}});var Me=new Mt,je=new Mt,Ce=new _t,ze=function(){function t(t,e){void 0===t&&(t=new Mt(1,0,0)),void 0===e&&(e=0),this.normal=t,this.constant=e}var e=t.prototype;return e.set=function(t,e){return this.normal.copy(t),this.constant=e,this},e.setComponents=function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},e.setFromNormalAndCoplanarPoint=function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},e.setFromCoplanarPoints=function(t,e,n){var r=Me.subVectors(n,e).cross(je.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this},e.copy=function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},e.normalize=function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},e.negate=function(){return this.constant*=-1,this.normal.negate(),this},e.distanceToPoint=function(t){return this.normal.dot(t)+this.constant},e.distanceToSphere=function(t){return this.distanceToPoint(t.center)-t.radius},e.projectPoint=function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new Mt),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},e.intersectLine=function(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new Mt);var n=t.delta(Me),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):void 0;var i=-(t.start.dot(this.normal)+this.constant)/r;return i<0||i>1?void 0:e.copy(n).multiplyScalar(i).add(t.start)},e.intersectsLine=function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},e.intersectsBox=function(t){return t.intersectsPlane(this)},e.intersectsSphere=function(t){return t.intersectsPlane(this)},e.coplanarPoint=function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new Mt),t.copy(this.normal).multiplyScalar(-this.constant)},e.applyMatrix4=function(t,e){var n=e||Ce.getNormalMatrix(t),r=this.coplanarPoint(Me).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this},e.translate=function(t){return this.constant-=t.dot(this.normal),this},e.equals=function(t){return t.normal.equals(this.normal)&&t.constant===this.constant},e.clone=function(){return(new this.constructor).copy(this)},t}();ze.prototype.isPlane=!0;var Re=new Mt,Ae=new Mt,Le=new Mt,Ie=new Mt,Pe=new Mt,Oe=new Mt,ke=new Mt,Be=new Mt,De=new Mt,He=new Mt,Fe=function(){function t(t,e,n){void 0===t&&(t=new Mt),void 0===e&&(e=new Mt),void 0===n&&(n=new Mt),this.a=t,this.b=e,this.c=n}t.getNormal=function(t,e,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new Mt),r.subVectors(n,e),Re.subVectors(t,e),r.cross(Re);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)},t.getBarycoord=function(t,e,n,r,i){Re.subVectors(r,e),Ae.subVectors(n,e),Le.subVectors(t,e);var o=Re.dot(Re),a=Re.dot(Ae),s=Re.dot(Le),l=Ae.dot(Ae),c=Ae.dot(Le),u=o*l-a*a;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new Mt),0===u)return i.set(-2,-1,-1);var p=1/u,d=(l*s-a*c)*p,h=(o*c-a*s)*p;return i.set(1-d-h,h,d)},t.containsPoint=function(t,e,n,r){return this.getBarycoord(t,e,n,r,Ie),Ie.x>=0&&Ie.y>=0&&Ie.x+Ie.y<=1},t.getUV=function(t,e,n,r,i,o,a,s){return this.getBarycoord(t,e,n,r,Ie),s.set(0,0),s.addScaledVector(i,Ie.x),s.addScaledVector(o,Ie.y),s.addScaledVector(a,Ie.z),s},t.isFrontFacing=function(t,e,n,r){return Re.subVectors(n,e),Ae.subVectors(t,e),Re.cross(Ae).dot(r)<0};var e=t.prototype;return e.set=function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},e.setFromPointsAndIndices=function(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this},e.clone=function(){return(new this.constructor).copy(this)},e.copy=function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},e.getArea=function(){return Re.subVectors(this.c,this.b),Ae.subVectors(this.a,this.b),.5*Re.cross(Ae).length()},e.getMidpoint=function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new Mt),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},e.getNormal=function(e){return t.getNormal(this.a,this.b,this.c,e)},e.getPlane=function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new ze),t.setFromCoplanarPoints(this.a,this.b,this.c)},e.getBarycoord=function(e,n){return t.getBarycoord(e,this.a,this.b,this.c,n)},e.getUV=function(e,n,r,i,o){return t.getUV(e,this.a,this.b,this.c,n,r,i,o)},e.containsPoint=function(e){return t.containsPoint(e,this.a,this.b,this.c)},e.isFrontFacing=function(e){return t.isFrontFacing(this.a,this.b,this.c,e)},e.intersectsBox=function(t){return t.intersectsTriangle(this)},e.closestPointToPoint=function(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new Mt);var n,r,i=this.a,o=this.b,a=this.c;Pe.subVectors(o,i),Oe.subVectors(a,i),Be.subVectors(t,i);var s=Pe.dot(Be),l=Oe.dot(Be);if(s<=0&&l<=0)return e.copy(i);De.subVectors(t,o);var c=Pe.dot(De),u=Oe.dot(De);if(c>=0&&u<=c)return e.copy(o);var p=s*u-c*l;if(p<=0&&s>=0&&c<=0)return n=s/(s-c),e.copy(i).addScaledVector(Pe,n);He.subVectors(t,a);var d=Pe.dot(He),h=Oe.dot(He);if(h>=0&&d<=h)return e.copy(a);var f=d*l-s*h;if(f<=0&&l>=0&&h<=0)return r=l/(l-h),e.copy(i).addScaledVector(Oe,r);var m=c*h-d*u;if(m<=0&&u-c>=0&&d-h>=0)return ke.subVectors(a,o),r=(u-c)/(u-c+(d-h)),e.copy(o).addScaledVector(ke,r);var y=1/(m+f+p);return n=f*y,r=p*y,e.copy(i).addScaledVector(Pe,n).addScaledVector(Oe,r)},e.equals=function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)},t}(),Ne=0;function Ue(){Object.defineProperty(this,"id",{value:Ne++}),this.uuid=ft.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=r,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=tt,this.stencilZFail=tt,this.stencilZPass=tt,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}Ue.prototype=Object.assign(Object.create(ut.prototype),{constructor:Ue,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n)if("shading"!==e){var r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){var i=r(t.textures),o=r(t.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,n=null;if(null!==e){var r=e.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Ue.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}});var Ve={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ge={h:0,s:0,l:0},We={h:0,s:0,l:0};function qe(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function Xe(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Ye(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}var Qe=function(){function t(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}var e=t.prototype;return e.set=function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},e.setScalar=function(t){return this.r=t,this.g=t,this.b=t,this},e.setHex=function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},e.setRGB=function(t,e,n){return this.r=t,this.g=e,this.b=n,this},e.setHSL=function(t,e,n){if(t=ft.euclideanModulo(t,1),e=ft.clamp(e,0,1),n=ft.clamp(n,0,1),0===e)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=qe(i,r,t+1/3),this.g=qe(i,r,t),this.b=qe(i,r,t-1/3)}return this},e.setStyle=function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){var r,i=n[1],o=n[2];switch(i){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){var a=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,l=parseInt(r[3],10)/100;return e(r[4]),this.setHSL(a,s,l)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){var c=n[1],u=c.length;if(3===u)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},e.setColorName=function(t){var e=Ve[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this},e.clone=function(){return new this.constructor(this.r,this.g,this.b)},e.copy=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},e.copyGammaToLinear=function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},e.copyLinearToGamma=function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},e.convertGammaToLinear=function(t){return this.copyGammaToLinear(this,t),this},e.convertLinearToGamma=function(t){return this.copyLinearToGamma(this,t),this},e.copySRGBToLinear=function(t){return this.r=Xe(t.r),this.g=Xe(t.g),this.b=Xe(t.b),this},e.copyLinearToSRGB=function(t){return this.r=Ye(t.r),this.g=Ye(t.g),this.b=Ye(t.b),this},e.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},e.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},e.getHex=function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},e.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},e.getHSL=function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,n,r=this.r,i=this.g,o=this.b,a=Math.max(r,i,o),s=Math.min(r,i,o),l=(s+a)/2;if(s===a)e=0,n=0;else{var c=a-s;switch(n=l<=.5?c/(a+s):c/(2-a-s),a){case r:e=(i-o)/c+(i<o?6:0);break;case i:e=(o-r)/c+2;break;case o:e=(r-i)/c+4}e/=6}return t.h=e,t.s=n,t.l=l,t},e.getStyle=function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},e.offsetHSL=function(t,e,n){return this.getHSL(Ge),Ge.h+=t,Ge.s+=e,Ge.l+=n,this.setHSL(Ge.h,Ge.s,Ge.l),this},e.add=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},e.addColors=function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},e.addScalar=function(t){return this.r+=t,this.g+=t,this.b+=t,this},e.sub=function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},e.multiply=function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},e.multiplyScalar=function(t){return this.r*=t,this.g*=t,this.b*=t,this},e.lerp=function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},e.lerpColors=function(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this},e.lerpHSL=function(t,e){this.getHSL(Ge),t.getHSL(We);var n=ft.lerp(Ge.h,We.h,e),r=ft.lerp(Ge.s,We.s,e),i=ft.lerp(Ge.l,We.l,e);return this.setHSL(n,r,i),this},e.equals=function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},e.fromArray=function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},e.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},e.fromBufferAttribute=function(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},e.toJSON=function(){return this.getHex()},t}();Qe.NAMES=Ve,Qe.prototype.isColor=!0,Qe.prototype.r=1,Qe.prototype.g=1,Qe.prototype.b=1;var Ze=function(t){function e(e){var n;return(n=t.call(this)||this).type="MeshBasicMaterial",n.color=new Qe(16777215),n.map=null,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=null,n.aoMapIntensity=1,n.specularMap=null,n.alphaMap=null,n.envMap=null,n.combine=0,n.reflectivity=1,n.refractionRatio=.98,n.wireframe=!1,n.wireframeLinewidth=1,n.wireframeLinecap="round",n.wireframeLinejoin="round",n.skinning=!1,n.morphTargets=!1,n.setValues(e),n}return st(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},e}(Ue);Ze.prototype.isMeshBasicMaterial=!0;var Je=new Mt,Ke=new mt;function $e(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=et,this.updateRange={offset:0,count:-1},this.version=0}function tn(t,e,n){$e.call(this,new Int8Array(t),e,n)}function en(t,e,n){$e.call(this,new Uint8Array(t),e,n)}function nn(t,e,n){$e.call(this,new Uint8ClampedArray(t),e,n)}function rn(t,e,n){$e.call(this,new Int16Array(t),e,n)}function on(t,e,n){$e.call(this,new Uint16Array(t),e,n)}function an(t,e,n){$e.call(this,new Int32Array(t),e,n)}function sn(t,e,n){$e.call(this,new Uint32Array(t),e,n)}function ln(t,e,n){$e.call(this,new Uint16Array(t),e,n)}function cn(t,e,n){$e.call(this,new Float32Array(t),e,n)}function un(t,e,n){$e.call(this,new Float64Array(t),e,n)}function pn(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}Object.defineProperty($e.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign($e.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new Qe),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new mt),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new Mt),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new wt),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},applyMatrix3:function(t){if(2===this.itemSize)for(var e=0,n=this.count;e<n;e++)Ke.fromBufferAttribute(this,e),Ke.applyMatrix3(t),this.setXY(e,Ke.x,Ke.y);else if(3===this.itemSize)for(var r=0,i=this.count;r<i;r++)Je.fromBufferAttribute(this,r),Je.applyMatrix3(t),this.setXYZ(r,Je.x,Je.y,Je.z);return this},applyMatrix4:function(t){for(var e=0,n=this.count;e<n;e++)Je.x=this.getX(e),Je.y=this.getY(e),Je.z=this.getZ(e),Je.applyMatrix4(t),this.setXYZ(e,Je.x,Je.y,Je.z);return this},applyNormalMatrix:function(t){for(var e=0,n=this.count;e<n;e++)Je.x=this.getX(e),Je.y=this.getY(e),Je.z=this.getZ(e),Je.applyNormalMatrix(t),this.setXYZ(e,Je.x,Je.y,Je.z);return this},transformDirection:function(t){for(var e=0,n=this.count;e<n;e++)Je.x=this.getX(e),Je.y=this.getY(e),Je.z=this.getZ(e),Je.transformDirection(t),this.setXYZ(e,Je.x,Je.y,Je.z);return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),tn.prototype=Object.create($e.prototype),tn.prototype.constructor=tn,en.prototype=Object.create($e.prototype),en.prototype.constructor=en,nn.prototype=Object.create($e.prototype),nn.prototype.constructor=nn,rn.prototype=Object.create($e.prototype),rn.prototype.constructor=rn,on.prototype=Object.create($e.prototype),on.prototype.constructor=on,an.prototype=Object.create($e.prototype),an.prototype.constructor=an,sn.prototype=Object.create($e.prototype),sn.prototype.constructor=sn,ln.prototype=Object.create($e.prototype),ln.prototype.constructor=ln,ln.prototype.isFloat16BufferAttribute=!0,cn.prototype=Object.create($e.prototype),cn.prototype.constructor=cn,un.prototype=Object.create($e.prototype),un.prototype.constructor=un;var dn={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function hn(t,e){return new dn[t](e)}var fn=0,mn=new te,yn=new Se,_n=new Mt,gn=new zt,vn=new zt,bn=new Mt;function xn(){Object.defineProperty(this,"id",{value:fn++}),this.uuid=ft.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}xn.prototype=Object.assign(Object.create(ut.prototype),{constructor:xn,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){return Array.isArray(t)?this.index=new(pn(t)>65535?sn:on)(t,1):this.index=t,this},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},hasAttribute:function(t){return void 0!==this.attributes[t]},addGroup:function(t,e,n){void 0===n&&(n=0),this.groups.push({start:t,count:e,materialIndex:n})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){var e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new _t).getNormalMatrix(t);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return mn.makeRotationX(t),this.applyMatrix4(mn),this},rotateY:function(t){return mn.makeRotationY(t),this.applyMatrix4(mn),this},rotateZ:function(t){return mn.makeRotationZ(t),this.applyMatrix4(mn),this},translate:function(t,e,n){return mn.makeTranslation(t,e,n),this.applyMatrix4(mn),this},scale:function(t,e,n){return mn.makeScale(t,e,n),this.applyMatrix4(mn),this},lookAt:function(t){return yn.lookAt(t),yn.updateMatrix(),this.applyMatrix4(yn.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(_n).negate(),this.translate(_n.x,_n.y,_n.z),this},setFromPoints:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new cn(e,3)),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new zt);var t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Mt(-1/0,-1/0,-1/0),new Mt(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var n=0,r=e.length;n<r;n++){var i=e[n];gn.setFromBufferAttribute(i),this.morphTargetsRelative?(bn.addVectors(this.boundingBox.min,gn.min),this.boundingBox.expandByPoint(bn),bn.addVectors(this.boundingBox.max,gn.max),this.boundingBox.expandByPoint(bn)):(this.boundingBox.expandByPoint(gn.min),this.boundingBox.expandByPoint(gn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Wt);var t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Mt,1/0);if(t){var n=this.boundingSphere.center;if(gn.setFromBufferAttribute(t),e)for(var r=0,i=e.length;r<i;r++){var o=e[r];vn.setFromBufferAttribute(o),this.morphTargetsRelative?(bn.addVectors(gn.min,vn.min),gn.expandByPoint(bn),bn.addVectors(gn.max,vn.max),gn.expandByPoint(bn)):(gn.expandByPoint(vn.min),gn.expandByPoint(vn.max))}gn.getCenter(n);for(var a=0,s=0,l=t.count;s<l;s++)bn.fromBufferAttribute(t,s),a=Math.max(a,n.distanceToSquared(bn));if(e)for(var c=0,u=e.length;c<u;c++)for(var p=e[c],d=this.morphTargetsRelative,h=0,f=p.count;h<f;h++)bn.fromBufferAttribute(p,h),d&&(_n.fromBufferAttribute(t,h),bn.add(_n)),a=Math.max(a,n.distanceToSquared(bn));this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){var t=this.index,e=this.attributes;if(null!==t&&void 0!==e.position&&void 0!==e.normal&&void 0!==e.uv){var n=t.array,r=e.position.array,i=e.normal.array,o=e.uv.array,a=r.length/3;void 0===e.tangent&&this.setAttribute("tangent",new $e(new Float32Array(4*a),4));for(var s=e.tangent.array,l=[],c=[],u=0;u<a;u++)l[u]=new Mt,c[u]=new Mt;var p=new Mt,d=new Mt,h=new Mt,f=new mt,m=new mt,y=new mt,_=new Mt,g=new Mt,v=this.groups;0===v.length&&(v=[{start:0,count:n.length}]);for(var b=0,x=v.length;b<x;++b)for(var w=v[b],E=w.start,T=E,S=E+w.count;T<S;T+=3)k(n[T+0],n[T+1],n[T+2]);for(var M=new Mt,j=new Mt,C=new Mt,z=new Mt,R=0,A=v.length;R<A;++R)for(var L=v[R],I=L.start,P=I,O=I+L.count;P<O;P+=3)B(n[P+0]),B(n[P+1]),B(n[P+2])}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function k(t,e,n){p.fromArray(r,3*t),d.fromArray(r,3*e),h.fromArray(r,3*n),f.fromArray(o,2*t),m.fromArray(o,2*e),y.fromArray(o,2*n),d.sub(p),h.sub(p),m.sub(f),y.sub(f);var i=1/(m.x*y.y-y.x*m.y);isFinite(i)&&(_.copy(d).multiplyScalar(y.y).addScaledVector(h,-m.y).multiplyScalar(i),g.copy(h).multiplyScalar(m.x).addScaledVector(d,-y.x).multiplyScalar(i),l[t].add(_),l[e].add(_),l[n].add(_),c[t].add(g),c[e].add(g),c[n].add(g))}function B(t){C.fromArray(i,3*t),z.copy(C);var e=l[t];M.copy(e),M.sub(C.multiplyScalar(C.dot(e))).normalize(),j.crossVectors(z,e);var n=j.dot(c[t])<0?-1:1;s[4*t]=M.x,s[4*t+1]=M.y,s[4*t+2]=M.z,s[4*t+3]=n}},computeVertexNormals:function(){var t=this.index,e=this.getAttribute("position");if(void 0!==e){var n=this.getAttribute("normal");if(void 0===n)n=new $e(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(var r=0,i=n.count;r<i;r++)n.setXYZ(r,0,0,0);var o=new Mt,a=new Mt,s=new Mt,l=new Mt,c=new Mt,u=new Mt,p=new Mt,d=new Mt;if(t)for(var h=0,f=t.count;h<f;h+=3){var m=t.getX(h+0),y=t.getX(h+1),_=t.getX(h+2);o.fromBufferAttribute(e,m),a.fromBufferAttribute(e,y),s.fromBufferAttribute(e,_),p.subVectors(s,a),d.subVectors(o,a),p.cross(d),l.fromBufferAttribute(n,m),c.fromBufferAttribute(n,y),u.fromBufferAttribute(n,_),l.add(p),c.add(p),u.add(p),n.setXYZ(m,l.x,l.y,l.z),n.setXYZ(y,c.x,c.y,c.z),n.setXYZ(_,u.x,u.y,u.z)}else for(var g=0,v=e.count;g<v;g+=3)o.fromBufferAttribute(e,g+0),a.fromBufferAttribute(e,g+1),s.fromBufferAttribute(e,g+2),p.subVectors(s,a),d.subVectors(o,a),p.cross(d),n.setXYZ(g+0,p.x,p.y,p.z),n.setXYZ(g+1,p.x,p.y,p.z),n.setXYZ(g+2,p.x,p.y,p.z);this.normalizeNormals(),n.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==t.attributes[r])for(var i=n[r].array,o=t.attributes[r],a=o.array,s=o.itemSize*e,l=Math.min(a.length,i.length-s),c=0,u=s;c<l;c++,u++)i[u]=a[c];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t=this.attributes.normal,e=0,n=t.count;e<n;e++)bn.fromBufferAttribute(t,e),bn.normalize(),t.setXYZ(e,bn.x,bn.y,bn.z)},toNonIndexed:function(){function t(t,e){for(var n=t.array,r=t.itemSize,i=t.normalized,o=new n.constructor(e.length*r),a=0,s=0,l=0,c=e.length;l<c;l++){a=e[l]*r;for(var u=0;u<r;u++)o[s++]=n[a++]}return new $e(o,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var e=new xn,n=this.index.array,r=this.attributes;for(var i in r){var o=t(r[i],n);e.setAttribute(i,o)}var a=this.morphAttributes;for(var s in a){for(var l=[],c=a[s],u=0,p=c.length;u<p;u++){var d=t(c[u],n);l.push(d)}e.morphAttributes[s]=l}e.morphTargetsRelative=this.morphTargetsRelative;for(var h=this.groups,f=0,m=h.length;f<m;f++){var y=h[f];e.addGroup(y.start,y.count,y.materialIndex)}return e},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var r=this.index;null!==r&&(t.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var o in i){var a=i[o],s=a.toJSON(t.data);""!==a.name&&(s.name=a.name),t.data.attributes[o]=s}var l={},c=!1;for(var u in this.morphAttributes){for(var p=this.morphAttributes[u],d=[],h=0,f=p.length;h<f;h++){var m=p[h],y=m.toJSON(t.data);""!==m.name&&(y.name=m.name),d.push(y)}d.length>0&&(l[u]=d,c=!0)}c&&(t.data.morphAttributes=l,t.data.morphTargetsRelative=this.morphTargetsRelative);var _=this.groups;_.length>0&&(t.data.groups=JSON.parse(JSON.stringify(_)));var g=this.boundingSphere;return null!==g&&(t.data.boundingSphere={center:g.center.toArray(),radius:g.radius}),t},clone:function(){return(new xn).copy(this)},copy:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var e={};this.name=t.name;var n=t.index;null!==n&&this.setIndex(n.clone(e));var r=t.attributes;for(var i in r){var o=r[i];this.setAttribute(i,o.clone(e))}var a=t.morphAttributes;for(var s in a){for(var l=[],c=a[s],u=0,p=c.length;u<p;u++)l.push(c[u].clone(e));this.morphAttributes[s]=l}this.morphTargetsRelative=t.morphTargetsRelative;for(var d=t.groups,h=0,f=d.length;h<f;h++){var m=d[h];this.addGroup(m.start,m.count,m.materialIndex)}var y=t.boundingBox;null!==y&&(this.boundingBox=y.clone());var _=t.boundingSphere;return null!==_&&(this.boundingSphere=_.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var wn=new te,En=new $t,Tn=new Wt,Sn=new Mt,Mn=new Mt,jn=new Mt,Cn=new Mt,zn=new Mt,Rn=new Mt,An=new Mt,Ln=new Mt,In=new Mt,Pn=new mt,On=new mt,kn=new mt,Bn=new Mt,Dn=new Mt;function Hn(t,e){void 0===t&&(t=new xn),void 0===e&&(e=new Ze),Se.call(this),this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}function Fn(t,e,n,r,i,o,a,s,l,c,u,p){Sn.fromBufferAttribute(i,c),Mn.fromBufferAttribute(i,u),jn.fromBufferAttribute(i,p);var d=t.morphTargetInfluences;if(e.morphTargets&&o&&d){An.set(0,0,0),Ln.set(0,0,0),In.set(0,0,0);for(var h=0,f=o.length;h<f;h++){var m=d[h],y=o[h];0!==m&&(Cn.fromBufferAttribute(y,c),zn.fromBufferAttribute(y,u),Rn.fromBufferAttribute(y,p),a?(An.addScaledVector(Cn,m),Ln.addScaledVector(zn,m),In.addScaledVector(Rn,m)):(An.addScaledVector(Cn.sub(Sn),m),Ln.addScaledVector(zn.sub(Mn),m),In.addScaledVector(Rn.sub(jn),m)))}Sn.add(An),Mn.add(Ln),jn.add(In)}t.isSkinnedMesh&&e.skinning&&(t.boneTransform(c,Sn),t.boneTransform(u,Mn),t.boneTransform(p,jn));var _=function(t,e,n,r,i,o,a,s){if(null===(1===e.side?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,2!==e.side,s)))return null;Dn.copy(s),Dn.applyMatrix4(t.matrixWorld);var l=n.ray.origin.distanceTo(Dn);return l<n.near||l>n.far?null:{distance:l,point:Dn.clone(),object:t}}(t,e,n,r,Sn,Mn,jn,Bn);if(_){s&&(Pn.fromBufferAttribute(s,c),On.fromBufferAttribute(s,u),kn.fromBufferAttribute(s,p),_.uv=Fe.getUV(Bn,Sn,Mn,jn,Pn,On,kn,new mt)),l&&(Pn.fromBufferAttribute(l,c),On.fromBufferAttribute(l,u),kn.fromBufferAttribute(l,p),_.uv2=Fe.getUV(Bn,Sn,Mn,jn,Pn,On,kn,new mt));var g={a:c,b:u,c:p,normal:new Mt,materialIndex:0};Fe.getNormal(Sn,Mn,jn,g.normal),_.face=g}return _}Hn.prototype=Object.assign(Object.create(Se.prototype),{constructor:Hn,isMesh:!0,copy:function(t){return Se.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){var e=t.morphAttributes,n=Object.keys(e);if(n.length>0){var r=e[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,o=r.length;i<o;i++){var a=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}else{var s=t.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,e){var n,r=this.geometry,i=this.material,o=this.matrixWorld;if(void 0!==i&&(null===r.boundingSphere&&r.computeBoundingSphere(),Tn.copy(r.boundingSphere),Tn.applyMatrix4(o),!1!==t.ray.intersectsSphere(Tn)&&(wn.copy(o).invert(),En.copy(t.ray).applyMatrix4(wn),null===r.boundingBox||!1!==En.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var a=r.index,s=r.attributes.position,l=r.morphAttributes.position,c=r.morphTargetsRelative,u=r.attributes.uv,p=r.attributes.uv2,d=r.groups,h=r.drawRange;if(null!==a)if(Array.isArray(i))for(var f=0,m=d.length;f<m;f++)for(var y=d[f],_=i[y.materialIndex],g=Math.max(y.start,h.start),v=Math.min(y.start+y.count,h.start+h.count);g<v;g+=3){var b=a.getX(g),x=a.getX(g+1),w=a.getX(g+2);(n=Fn(this,_,t,En,s,l,c,u,p,b,x,w))&&(n.faceIndex=Math.floor(g/3),n.face.materialIndex=y.materialIndex,e.push(n))}else for(var E=Math.max(0,h.start),T=Math.min(a.count,h.start+h.count);E<T;E+=3){var S=a.getX(E),M=a.getX(E+1),j=a.getX(E+2);(n=Fn(this,i,t,En,s,l,c,u,p,S,M,j))&&(n.faceIndex=Math.floor(E/3),e.push(n))}else if(void 0!==s)if(Array.isArray(i))for(var C=0,z=d.length;C<z;C++)for(var R=d[C],A=i[R.materialIndex],L=Math.max(R.start,h.start),I=Math.min(R.start+R.count,h.start+h.count);L<I;L+=3)(n=Fn(this,A,t,En,s,l,c,u,p,L,L+1,L+2))&&(n.faceIndex=Math.floor(L/3),n.face.materialIndex=R.materialIndex,e.push(n));else for(var P=Math.max(0,h.start),O=Math.min(s.count,h.start+h.count);P<O;P+=3)(n=Fn(this,i,t,En,s,l,c,u,p,P,P+1,P+2))&&(n.faceIndex=Math.floor(P/3),e.push(n))}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}});var Nn=function(t){function e(e,n,r,i,o,a){var s;void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1),void 0===o&&(o=1),void 0===a&&(a=1),(s=t.call(this)||this).type="BoxGeometry",s.parameters={width:e,height:n,depth:r,widthSegments:i,heightSegments:o,depthSegments:a};var l=lt(s);i=Math.floor(i),o=Math.floor(o);var c=[],u=[],p=[],d=[],h=0,f=0;function m(t,e,n,r,i,o,a,s,m,y,_){for(var g=o/m,v=a/y,b=o/2,x=a/2,w=s/2,E=m+1,T=y+1,S=0,M=0,j=new Mt,C=0;C<T;C++)for(var z=C*v-x,R=0;R<E;R++){var A=R*g-b;j[t]=A*r,j[e]=z*i,j[n]=w,u.push(j.x,j.y,j.z),j[t]=0,j[e]=0,j[n]=s>0?1:-1,p.push(j.x,j.y,j.z),d.push(R/m),d.push(1-C/y),S+=1}for(var L=0;L<y;L++)for(var I=0;I<m;I++){var P=h+I+E*L,O=h+I+E*(L+1),k=h+(I+1)+E*(L+1),B=h+(I+1)+E*L;c.push(P,O,B),c.push(O,k,B),M+=6}l.addGroup(f,M,_),f+=M,h+=S}return m("z","y","x",-1,-1,r,n,e,a=Math.floor(a),o,0),m("z","y","x",1,-1,r,n,-e,a,o,1),m("x","z","y",1,1,e,r,n,i,a,2),m("x","z","y",1,-1,e,r,-n,i,a,3),m("x","y","z",1,-1,e,n,r,i,o,4),m("x","y","z",-1,-1,e,n,-r,i,o,5),s.setIndex(c),s.setAttribute("position",new cn(u,3)),s.setAttribute("normal",new cn(p,3)),s.setAttribute("uv",new cn(d,2)),s}return st(e,t),e}(xn);function Un(t){var e={};for(var n in t)for(var r in e[n]={},t[n]){var i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}return e}function Vn(t){for(var e={},n=0;n<t.length;n++){var r=Un(t[n]);for(var i in r)e[i]=r[i]}return e}var Gn={clone:Un,merge:Vn};function Wn(t){Ue.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function qn(){Se.call(this),this.type="Camera",this.matrixWorldInverse=new te,this.projectionMatrix=new te,this.projectionMatrixInverse=new te}function Xn(t,e,n,r){void 0===t&&(t=50),void 0===e&&(e=1),void 0===n&&(n=.1),void 0===r&&(r=2e3),qn.call(this),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Wn.prototype=Object.create(Ue.prototype),Wn.prototype.constructor=Wn,Wn.prototype.isShaderMaterial=!0,Wn.prototype.copy=function(t){return Ue.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Un(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this},Wn.prototype.toJSON=function(t){var e=Ue.prototype.toJSON.call(this,t);for(var n in e.glslVersion=this.glslVersion,e.uniforms={},this.uniforms){var r=this.uniforms[n].value;r&&r.isTexture?e.uniforms[n]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[n]={type:"m4",value:r.toArray()}:e.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;var i={};for(var o in this.extensions)!0===this.extensions[o]&&(i[o]=!0);return Object.keys(i).length>0&&(e.extensions=i),e},qn.prototype=Object.assign(Object.create(Se.prototype),{constructor:qn,isCamera:!0,copy:function(t,e){return Se.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new Mt),this.updateWorldMatrix(!0,!1);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){Se.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(t,e){Se.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return(new this.constructor).copy(this)}}),Xn.prototype=Object.assign(Object.create(qn.prototype),{constructor:Xn,isPerspectiveCamera:!0,copy:function(t,e){return qn.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*ft.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*ft.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*ft.RAD2DEG*Math.atan(Math.tan(.5*ft.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,r,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*ft.DEG2RAD*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/a,e-=o.offsetY*n/s,r*=o.width/a,n*=o.height/s}var l=this.filmOffset;0!==l&&(i+=t*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(t){var e=Se.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});var Yn=90,Qn=function(t){function e(e,n,r){var i;if((i=t.call(this)||this).type="CubeCamera",!0!==r.isWebGLCubeRenderTarget)return console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter."),lt(i);i.renderTarget=r;var o=new Xn(Yn,1,e,n);o.layers=i.layers,o.up.set(0,-1,0),o.lookAt(new Mt(1,0,0)),i.add(o);var a=new Xn(Yn,1,e,n);a.layers=i.layers,a.up.set(0,-1,0),a.lookAt(new Mt(-1,0,0)),i.add(a);var s=new Xn(Yn,1,e,n);s.layers=i.layers,s.up.set(0,0,1),s.lookAt(new Mt(0,1,0)),i.add(s);var l=new Xn(Yn,1,e,n);l.layers=i.layers,l.up.set(0,0,-1),l.lookAt(new Mt(0,-1,0)),i.add(l);var c=new Xn(Yn,1,e,n);c.layers=i.layers,c.up.set(0,-1,0),c.lookAt(new Mt(0,0,1)),i.add(c);var u=new Xn(Yn,1,e,n);return u.layers=i.layers,u.up.set(0,-1,0),u.lookAt(new Mt(0,0,-1)),i.add(u),i}return st(e,t),e.prototype.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,r=this.children,i=r[0],o=r[1],a=r[2],s=r[3],l=r[4],c=r[5],u=t.xr.enabled,p=t.getRenderTarget();t.xr.enabled=!1;var d=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,i),t.setRenderTarget(n,1),t.render(e,o),t.setRenderTarget(n,2),t.render(e,a),t.setRenderTarget(n,3),t.render(e,s),t.setRenderTarget(n,4),t.render(e,l),n.texture.generateMipmaps=d,t.setRenderTarget(n,5),t.render(e,c),t.setRenderTarget(p),t.xr.enabled=u},e}(Se),Zn=function(t){function e(e,n,r,i,a,s,l,c,u,p){var d;return e=void 0!==e?e:[],n=void 0!==n?n:o,l=void 0!==l?l:S,(d=t.call(this,e,n,r,i,a,s,l,c,u,p)||this)._needsFlipEnvMap=!0,d.flipY=!1,d}return st(e,t),at(e,[{key:"images",get:function(){return this.image},set:function(t){this.image=t}}]),e}(bt);Zn.prototype.isCubeTexture=!0;var Jn=function(t){function e(e,n,r){var i;return Number.isInteger(n)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),n=r),i=t.call(this,e,e,n)||this,n=n||{},i.texture=new Zn(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),i.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,i.texture.minFilter=void 0!==n.minFilter?n.minFilter:_,i.texture._needsFlipEnvMap=!1,i}st(e,t);var n=e.prototype;return n.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.format=M,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;var n=new Nn(5,5,5),r=new Wn({name:"CubemapFromEquirect",uniforms:Un({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",side:1,blending:0});r.uniforms.tEquirect.value=e;var i=new Hn(n,r),o=e.minFilter;return e.minFilter===g&&(e.minFilter=_),new Qn(1,10,this).update(t,i),e.minFilter=o,i.geometry.dispose(),i.material.dispose(),this},n.clear=function(t,e,n,r){for(var i=t.getRenderTarget(),o=0;o<6;o++)t.setRenderTarget(this,o),t.clear(e,n,r);t.setRenderTarget(i)},e}(Et);Jn.prototype.isWebGLCubeRenderTarget=!0;var Kn=function(t){function e(e,n,r,i,o,a,s,l,c,u,p,d){var h;return(h=t.call(this,null,a,s,l,c,u,i,o,p,d)||this).image={data:e||null,width:n||1,height:r||1},h.magFilter=void 0!==c?c:f,h.minFilter=void 0!==u?u:f,h.generateMipmaps=!1,h.flipY=!1,h.unpackAlignment=1,h.needsUpdate=!0,h}return st(e,t),e}(bt);Kn.prototype.isDataTexture=!0;var $n=new Wt,tr=new Mt,er=function(){function t(t,e,n,r,i,o){void 0===t&&(t=new ze),void 0===e&&(e=new ze),void 0===n&&(n=new ze),void 0===r&&(r=new ze),void 0===i&&(i=new ze),void 0===o&&(o=new ze),this.planes=[t,e,n,r,i,o]}var e=t.prototype;return e.set=function(t,e,n,r,i,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},e.copy=function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},e.setFromProjectionMatrix=function(t){var e=this.planes,n=t.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],l=n[5],c=n[6],u=n[7],p=n[8],d=n[9],h=n[10],f=n[11],m=n[12],y=n[13],_=n[14],g=n[15];return e[0].setComponents(a-r,u-s,f-p,g-m).normalize(),e[1].setComponents(a+r,u+s,f+p,g+m).normalize(),e[2].setComponents(a+i,u+l,f+d,g+y).normalize(),e[3].setComponents(a-i,u-l,f-d,g-y).normalize(),e[4].setComponents(a-o,u-c,f-h,g-_).normalize(),e[5].setComponents(a+o,u+c,f+h,g+_).normalize(),this},e.intersectsObject=function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),$n.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere($n)},e.intersectsSprite=function(t){return $n.center.set(0,0,0),$n.radius=.7071067811865476,$n.applyMatrix4(t.matrixWorld),this.intersectsSphere($n)},e.intersectsSphere=function(t){for(var e=this.planes,n=t.center,r=-t.radius,i=0;i<6;i++)if(e[i].distanceToPoint(n)<r)return!1;return!0},e.intersectsBox=function(t){for(var e=this.planes,n=0;n<6;n++){var r=e[n];if(tr.x=r.normal.x>0?t.max.x:t.min.x,tr.y=r.normal.y>0?t.max.y:t.min.y,tr.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(tr)<0)return!1}return!0},e.containsPoint=function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0},e.clone=function(){return(new this.constructor).copy(this)},t}();function nr(){var t=null,e=!1,n=null,r=null;function i(e,o){n(e,o),r=t.requestAnimationFrame(i)}return{start:function(){!0!==e&&null!==n&&(r=t.requestAnimationFrame(i),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}var rr=function(t){function e(e,n,r,i){var o;void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1),(o=t.call(this)||this).type="PlaneGeometry",o.parameters={width:e,height:n,widthSegments:r,heightSegments:i};for(var a=e/2,s=n/2,l=Math.floor(r),c=Math.floor(i),u=l+1,p=c+1,d=e/l,h=n/c,f=[],m=[],y=[],_=[],g=0;g<p;g++)for(var v=g*h-s,b=0;b<u;b++){var x=b*d-a;m.push(x,-v,0),y.push(0,0,1),_.push(b/l),_.push(1-g/c)}for(var w=0;w<c;w++)for(var E=0;E<l;E++){var T=E+u*w,S=E+u*(w+1),M=E+1+u*(w+1),j=E+1+u*w;f.push(T,S,j),f.push(S,M,j)}return o.setIndex(f),o.setAttribute("position",new cn(m,3)),o.setAttribute("normal",new cn(y,3)),o.setAttribute("uv",new cn(_,2)),o}return st(e,t),e}(xn),ir={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor.xyz *= color.xyz;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(\t\t0, 1,\t\t0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t\tf.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t\tf.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(\t1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,\t1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,\t1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},or={common:{diffuse:{value:new Qe(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new _t},uv2Transform:{value:new _t},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new mt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Qe(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Qe(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new _t}},sprite:{diffuse:{value:new Qe(15658734)},opacity:{value:1},center:{value:new mt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new _t}}},ar={basic:{uniforms:Vn([or.common,or.specularmap,or.envmap,or.aomap,or.lightmap,or.fog]),vertexShader:ir.meshbasic_vert,fragmentShader:ir.meshbasic_frag},lambert:{uniforms:Vn([or.common,or.specularmap,or.envmap,or.aomap,or.lightmap,or.emissivemap,or.fog,or.lights,{emissive:{value:new Qe(0)}}]),vertexShader:ir.meshlambert_vert,fragmentShader:ir.meshlambert_frag},phong:{uniforms:Vn([or.common,or.specularmap,or.envmap,or.aomap,or.lightmap,or.emissivemap,or.bumpmap,or.normalmap,or.displacementmap,or.fog,or.lights,{emissive:{value:new Qe(0)},specular:{value:new Qe(1118481)},shininess:{value:30}}]),vertexShader:ir.meshphong_vert,fragmentShader:ir.meshphong_frag},standard:{uniforms:Vn([or.common,or.envmap,or.aomap,or.lightmap,or.emissivemap,or.bumpmap,or.normalmap,or.displacementmap,or.roughnessmap,or.metalnessmap,or.fog,or.lights,{emissive:{value:new Qe(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ir.meshphysical_vert,fragmentShader:ir.meshphysical_frag},toon:{uniforms:Vn([or.common,or.aomap,or.lightmap,or.emissivemap,or.bumpmap,or.normalmap,or.displacementmap,or.gradientmap,or.fog,or.lights,{emissive:{value:new Qe(0)}}]),vertexShader:ir.meshtoon_vert,fragmentShader:ir.meshtoon_frag},matcap:{uniforms:Vn([or.common,or.bumpmap,or.normalmap,or.displacementmap,or.fog,{matcap:{value:null}}]),vertexShader:ir.meshmatcap_vert,fragmentShader:ir.meshmatcap_frag},points:{uniforms:Vn([or.points,or.fog]),vertexShader:ir.points_vert,fragmentShader:ir.points_frag},dashed:{uniforms:Vn([or.common,or.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ir.linedashed_vert,fragmentShader:ir.linedashed_frag},depth:{uniforms:Vn([or.common,or.displacementmap]),vertexShader:ir.depth_vert,fragmentShader:ir.depth_frag},normal:{uniforms:Vn([or.common,or.bumpmap,or.normalmap,or.displacementmap,{opacity:{value:1}}]),vertexShader:ir.normal_vert,fragmentShader:ir.normal_frag},sprite:{uniforms:Vn([or.sprite,or.fog]),vertexShader:ir.sprite_vert,fragmentShader:ir.sprite_frag},background:{uniforms:{uvTransform:{value:new _t},t2D:{value:null}},vertexShader:ir.background_vert,fragmentShader:ir.background_frag},cube:{uniforms:Vn([or.envmap,{opacity:{value:1}}]),vertexShader:ir.cube_vert,fragmentShader:ir.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ir.equirect_vert,fragmentShader:ir.equirect_frag},distanceRGBA:{uniforms:Vn([or.common,or.displacementmap,{referencePosition:{value:new Mt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ir.distanceRGBA_vert,fragmentShader:ir.distanceRGBA_frag},shadow:{uniforms:Vn([or.lights,or.fog,{color:{value:new Qe(0)},opacity:{value:1}}]),vertexShader:ir.shadow_vert,fragmentShader:ir.shadow_frag}};function sr(t,e,n,r,i){var o,a,s=new Qe(0),l=0,u=null,p=0,d=null;function h(t,e){n.buffers.color.setClear(t.r,t.g,t.b,e,i)}return{getClearColor:function(){return s},setClearColor:function(t,e){void 0===e&&(e=1),s.set(t),h(s,l=e)},getClearAlpha:function(){return l},setClearAlpha:function(t){h(s,l=t)},render:function(n,i,f,m){var y=!0===i.isScene?i.background:null;y&&y.isTexture&&(y=e.get(y));var _=t.xr,g=_.getSession&&_.getSession();g&&"additive"===g.environmentBlendMode&&(y=null),null===y?h(s,l):y&&y.isColor&&(h(y,1),m=!0),(t.autoClear||m)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),y&&(y.isCubeTexture||y.isWebGLCubeRenderTarget||y.mapping===c)?(void 0===a&&((a=new Hn(new Nn(1,1,1),new Wn({name:"BackgroundCubeMaterial",uniforms:Un(ar.cube.uniforms),vertexShader:ar.cube.vertexShader,fragmentShader:ar.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(a)),y.isWebGLCubeRenderTarget&&(y=y.texture),a.material.uniforms.envMap.value=y,a.material.uniforms.flipEnvMap.value=y.isCubeTexture&&y._needsFlipEnvMap?-1:1,u===y&&p===y.version&&d===t.toneMapping||(a.material.needsUpdate=!0,u=y,p=y.version,d=t.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null)):y&&y.isTexture&&(void 0===o&&((o=new Hn(new rr(2,2),new Wn({name:"BackgroundMaterial",uniforms:Un(ar.background.uniforms),vertexShader:ar.background.vertexShader,fragmentShader:ar.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(o)),o.material.uniforms.t2D.value=y,!0===y.matrixAutoUpdate&&y.updateMatrix(),o.material.uniforms.uvTransform.value.copy(y.matrix),u===y&&p===y.version&&d===t.toneMapping||(o.material.needsUpdate=!0,u=y,p=y.version,d=t.toneMapping),n.unshift(o,o.geometry,o.material,0,0,null))}}}function lr(t){var e=this,n=null,r=0,i=!1,o=!1,a=new ze,s=new _t,l={value:null,needsUpdate:!1};function c(){l.value!==n&&(l.value=n,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(t,n,r,i){var o=null!==t?t.length:0,c=null;if(0!==o){if(c=l.value,!0!==i||null===c){var u=r+4*o,p=n.matrixWorldInverse;s.getNormalMatrix(p),(null===c||c.length<u)&&(c=new Float32Array(u));for(var d=0,h=r;d!==o;++d,h+=4)a.copy(t[d]).applyMatrix4(p,s),a.normal.toArray(c,h),c[h+3]=a.constant}l.value=c,l.needsUpdate=!0}return e.numPlanes=o,e.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e,o){var a=0!==t.length||e||0!==r||i;return i=e,n=u(t,o,0),r=t.length,a},this.beginShadows=function(){o=!0,u(null)},this.endShadows=function(){o=!1,c()},this.setState=function(e,a,s){var p=e.clippingPlanes,d=e.clipIntersection,h=e.clipShadows,f=t.get(e);if(!i||null===p||0===p.length||o&&!h)o?u(null):c();else{var m=o?0:r,y=4*m,_=f.clippingState||null;l.value=_,_=u(p,a,y,s);for(var g=0;g!==y;++g)_[g]=n[g];f.clippingState=_,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=m}}}function cr(t){var e=new WeakMap;function n(t,e){return e===s?t.mapping=o:e===l&&(t.mapping=a),t}function r(t){var n=t.target;n.removeEventListener("dispose",r);var i=e.get(n);void 0!==i&&(e.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){var o=i.mapping;if(o===s||o===l){if(e.has(i))return n(e.get(i).texture,i.mapping);var a=i.image;if(a&&a.height>0){var c=t.getRenderTarget(),u=new Jn(a.height/2);return u.fromEquirectangularTexture(t,i),e.set(i,u),t.setRenderTarget(c),i.addEventListener("dispose",r),n(u.texture,i.mapping)}return null}}return i},dispose:function(){e=new WeakMap}}}function ur(t,e){return t[0]-e[0]}function pr(t,e){return Math.abs(e[1])-Math.abs(t[1])}ar.physical={uniforms:Vn([ar.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new mt(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Qe(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:ir.meshphysical_vert,fragmentShader:ir.meshphysical_frag};var dr=function(t){function e(e,n,r,i){var o;return void 0===e&&(e=null),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1),(o=t.call(this,null)||this).image={data:e,width:n,height:r,depth:i},o.magFilter=f,o.minFilter=f,o.wrapR=d,o.generateMipmaps=!1,o.flipY=!1,o.needsUpdate=!0,o}return st(e,t),e}(bt);dr.prototype.isDataTexture2DArray=!0;var hr=function(t){function e(e,n,r,i){var o;return void 0===e&&(e=null),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1),(o=t.call(this,null)||this).image={data:e,width:n,height:r,depth:i},o.magFilter=f,o.minFilter=f,o.wrapR=d,o.generateMipmaps=!1,o.flipY=!1,o.needsUpdate=!0,o}return st(e,t),e}(bt);hr.prototype.isDataTexture3D=!0;var fr=new bt,mr=new dr,yr=new hr,_r=new Zn,gr=[],vr=[],br=new Float32Array(16),xr=new Float32Array(9),wr=new Float32Array(4);function Er(t,e,n){var r=t[0];if(r<=0||r>0)return t;var i=e*n,o=gr[i];if(void 0===o&&(o=new Float32Array(i),gr[i]=o),0!==e){r.toArray(o,0);for(var a=1,s=0;a!==e;++a)s+=n,t[a].toArray(o,s)}return o}function Tr(t,e){if(t.length!==e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function Sr(t,e){for(var n=0,r=e.length;n<r;n++)t[n]=e[n]}function Mr(t,e){var n=vr[e];void 0===n&&(n=new Int32Array(e),vr[e]=n);for(var r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function jr(t,e){var n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Cr(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Tr(n,e))return;t.uniform2fv(this.addr,e),Sr(n,e)}}function zr(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Tr(n,e))return;t.uniform3fv(this.addr,e),Sr(n,e)}}function Rr(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Tr(n,e))return;t.uniform4fv(this.addr,e),Sr(n,e)}}function Ar(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(Tr(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Sr(n,e)}else{if(Tr(n,r))return;wr.set(r),t.uniformMatrix2fv(this.addr,!1,wr),Sr(n,r)}}function Lr(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(Tr(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Sr(n,e)}else{if(Tr(n,r))return;xr.set(r),t.uniformMatrix3fv(this.addr,!1,xr),Sr(n,r)}}function Ir(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(Tr(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Sr(n,e)}else{if(Tr(n,r))return;br.set(r),t.uniformMatrix4fv(this.addr,!1,br),Sr(n,r)}}function Pr(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(e||fr,i)}function Or(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||mr,i)}function kr(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||yr,i)}function Br(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(e||_r,i)}function Dr(t,e){var n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Hr(t,e){var n=this.cache;Tr(n,e)||(t.uniform2iv(this.addr,e),Sr(n,e))}function Fr(t,e){var n=this.cache;Tr(n,e)||(t.uniform3iv(this.addr,e),Sr(n,e))}function Nr(t,e){var n=this.cache;Tr(n,e)||(t.uniform4iv(this.addr,e),Sr(n,e))}function Ur(t,e){var n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Vr(t,e){t.uniform1fv(this.addr,e)}function Gr(t,e){t.uniform1iv(this.addr,e)}function Wr(t,e){t.uniform2iv(this.addr,e)}function qr(t,e){t.uniform3iv(this.addr,e)}function Xr(t,e){t.uniform4iv(this.addr,e)}function Yr(t,e){var n=Er(e,this.size,2);t.uniform2fv(this.addr,n)}function Qr(t,e){var n=Er(e,this.size,3);t.uniform3fv(this.addr,n)}function Zr(t,e){var n=Er(e,this.size,4);t.uniform4fv(this.addr,n)}function Jr(t,e){var n=Er(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Kr(t,e){var n=Er(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function $r(t,e){var n=Er(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function ti(t,e,n){var r=e.length,i=Mr(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTexture2D(e[o]||fr,i[o])}function ei(t,e,n){var r=e.length,i=Mr(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTextureCube(e[o]||_r,i[o])}function ni(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(e.type){case 5126:return jr;case 35664:return Cr;case 35665:return zr;case 35666:return Rr;case 35674:return Ar;case 35675:return Lr;case 35676:return Ir;case 5124:case 35670:return Dr;case 35667:case 35671:return Hr;case 35668:case 35672:return Fr;case 35669:case 35673:return Nr;case 5125:return Ur;case 35678:case 36198:case 36298:case 36306:case 35682:return Pr;case 35679:case 36299:case 36307:return kr;case 35680:case 36300:case 36308:case 36293:return Br;case 36289:case 36303:case 36311:case 36292:return Or}}()}function ri(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(e.type){case 5126:return Vr;case 35664:return Yr;case 35665:return Qr;case 35666:return Zr;case 35674:return Jr;case 35675:return Kr;case 35676:return $r;case 5124:case 35670:return Gr;case 35667:case 35671:return Wr;case 35668:case 35672:return qr;case 35669:case 35673:return Xr;case 35678:case 36198:case 36298:case 36306:case 35682:return ti;case 35680:case 36300:case 36308:case 36293:return ei}}()}function ii(t){this.id=t,this.seq=[],this.map={}}ri.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),Sr(e,t)},ii.prototype.setValue=function(t,e,n){for(var r=this.seq,i=0,o=r.length;i!==o;++i){var a=r[i];a.setValue(t,e[a.id],n)}};var oi=/(\w+)(\])?(\[|\.)?/g;function ai(t,e){t.seq.push(e),t.map[e.id]=e}function si(t,e,n){var r=t.name,i=r.length;for(oi.lastIndex=0;;){var o=oi.exec(r),a=oi.lastIndex,s=o[1],l="]"===o[2],c=o[3];if(l&&(s|=0),void 0===c||"["===c&&a+2===i){ai(n,void 0===c?new ni(s,t,e):new ri(s,t,e));break}var u=n.map[s];void 0===u&&ai(n,u=new ii(s)),n=u}}function li(t,e){this.seq=[],this.map={};for(var n=t.getProgramParameter(e,35718),r=0;r<n;++r){var i=t.getActiveUniform(e,r);si(i,t.getUniformLocation(e,i.name),this)}}function ci(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}li.prototype.setValue=function(t,e,n,r){var i=this.map[e];void 0!==i&&i.setValue(t,n,r)},li.prototype.setOptional=function(t,e,n){var r=e[n];void 0!==r&&this.setValue(t,n,r)},li.upload=function(t,e,n,r){for(var i=0,o=e.length;i!==o;++i){var a=e[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,r)}},li.seqWithValue=function(t,e){for(var n=[],r=0,i=t.length;r!==i;++r){var o=t[r];o.id in e&&n.push(o)}return n};var ui=0;function pi(t){switch(t){case X:return["Linear","( value )"];case Y:return["sRGB","( value )"];case Z:return["RGBE","( value )"];case J:return["RGBM","( value, 7.0 )"];case K:return["RGBM","( value, 16.0 )"];case $:return["RGBD","( value, 256.0 )"];case Q:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function di(t,e,n){var r=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(t.getShaderSource(e))}function hi(t,e){var n=pi(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function fi(t){return""!==t}function mi(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function yi(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var _i=/^[ \t]*#include +<([\w\d./]+)>/gm;function gi(t){return t.replace(_i,vi)}function vi(t,e){var n=ir[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return gi(n)}var bi=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,xi=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function wi(t){return t.replace(xi,Ti).replace(bi,Ei)}function Ei(t,e,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Ti(0,e,n,r)}function Ti(t,e,n,r){for(var i="",o=parseInt(e);o<parseInt(n);o++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return i}function Si(t){var e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function Mi(t,e,n,r){var i,s,l,p,d,h=t.getContext(),f=n.defines,m=n.vertexShader,y=n.fragmentShader,_=function(t){var e="SHADOWMAP_TYPE_BASIC";return 1===t.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===t.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===t.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(n),g=function(t){var e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case o:case a:e="ENVMAP_TYPE_CUBE";break;case c:case u:e="ENVMAP_TYPE_CUBE_UV"}return e}(n),v=function(t){var e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case a:case u:e="ENVMAP_MODE_REFRACTION"}return e}(n),b=function(t){var e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(n),x=t.gammaFactor>0?t.gammaFactor:1,w=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(fi).join("\n")}(n),E=function(t){var e=[];for(var n in t){var r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(f),T=h.createProgram(),S=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?((i=[E].filter(fi).join("\n")).length>0&&(i+="\n"),(s=[w,E].filter(fi).join("\n")).length>0&&(s+="\n")):(i=[Si(n),"#define SHADER_NAME "+n.shaderName,E,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+x,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+v:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+_:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(fi).join("\n"),s=[w,Si(n),"#define SHADER_NAME "+n.shaderName,E,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+x,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+g:"",n.envMap?"#define "+v:"",n.envMap?"#define "+b:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+_:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?ir.tonemapping_pars_fragment:"",0!==n.toneMapping?function(t,e){var n;switch(e){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 toneMapping( vec3 color ) { return "+n+"ToneMapping( color ); }"}(0,n.toneMapping):"",n.dithering?"#define DITHERING":"",ir.encodings_pars_fragment,n.map?hi("mapTexelToLinear",n.mapEncoding):"",n.matcap?hi("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?hi("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?hi("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?hi("lightMapTexelToLinear",n.lightMapEncoding):"",(l="linearToOutputTexel",p=n.outputEncoding,d=pi(p),"vec4 "+l+"( vec4 value ) { return LinearTo"+d[0]+d[1]+"; }"),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(fi).join("\n")),m=yi(m=mi(m=gi(m),n),n),y=yi(y=mi(y=gi(y),n),n),m=wi(m),y=wi(y),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(S="#version 300 es\n",i=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+i,s=["#define varying in",n.glslVersion===rt?"":"out highp vec4 pc_fragColor;",n.glslVersion===rt?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+s);var M,j,C=S+s+y,z=ci(h,35633,S+i+m),R=ci(h,35632,C);if(h.attachShader(T,z),h.attachShader(T,R),void 0!==n.index0AttributeName?h.bindAttribLocation(T,0,n.index0AttributeName):!0===n.morphTargets&&h.bindAttribLocation(T,0,"position"),h.linkProgram(T),t.debug.checkShaderErrors){var A=h.getProgramInfoLog(T).trim(),L=h.getShaderInfoLog(z).trim(),I=h.getShaderInfoLog(R).trim(),P=!0,O=!0;if(!1===h.getProgramParameter(T,35714)){P=!1;var k=di(h,z,"vertex"),B=di(h,R,"fragment");console.error("THREE.WebGLProgram: shader error: ",h.getError(),"35715",h.getProgramParameter(T,35715),"gl.getProgramInfoLog",A,k,B)}else""!==A?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",A):""!==L&&""!==I||(O=!1);O&&(this.diagnostics={runnable:P,programLog:A,vertexShader:{log:L,prefix:i},fragmentShader:{log:I,prefix:s}})}return h.deleteShader(z),h.deleteShader(R),this.getUniforms=function(){return void 0===M&&(M=new li(h,T)),M},this.getAttributes=function(){return void 0===j&&(j=function(t,e){for(var n={},r=t.getProgramParameter(e,35721),i=0;i<r;i++){var o=t.getActiveAttrib(e,i).name;n[o]=t.getAttribLocation(e,o)}return n}(h,T)),j},this.destroy=function(){r.releaseStatesOfProgram(this),h.deleteProgram(T),this.program=void 0},this.name=n.shaderName,this.id=ui++,this.cacheKey=e,this.usedTimes=1,this.program=T,this.vertexShader=z,this.fragmentShader=R,this}function ji(t,e,n,r,i,o){var a=[],s=r.isWebGL2,l=r.logarithmicDepthBuffer,p=r.floatVertexTextures,d=r.maxVertexUniforms,h=r.vertexTextures,f=r.precision,m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},y=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function _(t){var e;return t&&t.isTexture?e=t.encoding:t&&t.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=t.texture.encoding):e=X,e}return{getParameters:function(i,a,y,g,v){var b,x,w=g.fog,E=i.isMeshStandardMaterial?g.environment:null,T=e.get(i.envMap||E),S=m[i.type],M=v.isSkinnedMesh?function(t){var e=v.skeleton.bones;if(p)return 1024;var n=d,r=Math.floor((n-20)/4),i=Math.min(r,e.length);return i<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+i+"."),0):i}():0;if(null!==i.precision&&(f=r.getMaxPrecision(i.precision))!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",f,"instead."),S){var j=ar[S];b=j.vertexShader,x=j.fragmentShader}else b=i.vertexShader,x=i.fragmentShader;var C=t.getRenderTarget();return{isWebGL2:s,shaderID:S,shaderName:i.type,vertexShader:b,fragmentShader:x,defines:i.defines,isRawShaderMaterial:!0===i.isRawShaderMaterial,glslVersion:i.glslVersion,precision:f,instancing:!0===v.isInstancedMesh,instancingColor:!0===v.isInstancedMesh&&null!==v.instanceColor,supportsVertexTextures:h,outputEncoding:null!==C?_(C.texture):t.outputEncoding,map:!!i.map,mapEncoding:_(i.map),matcap:!!i.matcap,matcapEncoding:_(i.matcap),envMap:!!T,envMapMode:T&&T.mapping,envMapEncoding:_(T),envMapCubeUV:!!T&&(T.mapping===c||T.mapping===u),lightMap:!!i.lightMap,lightMapEncoding:_(i.lightMap),aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:_(i.emissiveMap),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,objectSpaceNormalMap:1===i.normalMapType,tangentSpaceNormalMap:0===i.normalMapType,clearcoatMap:!!i.clearcoatMap,clearcoatRoughnessMap:!!i.clearcoatRoughnessMap,clearcoatNormalMap:!!i.clearcoatNormalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,gradientMap:!!i.gradientMap,sheen:!!i.sheen,transmissionMap:!!i.transmissionMap,combine:i.combine,vertexTangents:i.normalMap&&i.vertexTangents,vertexColors:i.vertexColors,vertexUvs:!!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatMap||i.clearcoatRoughnessMap||i.clearcoatNormalMap||i.displacementMap||i.transmissionMap),uvsVertexOnly:!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatNormalMap||i.transmissionMap||!i.displacementMap),fog:!!w,useFog:i.fog,fogExp2:w&&w.isFogExp2,flatShading:!!i.flatShading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:l,skinning:i.skinning&&M>0,maxBones:M,useVertexTexture:p,morphTargets:i.morphTargets,morphNormals:i.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:i.dithering,shadowMapEnabled:t.shadowMap.enabled&&y.length>0,shadowMapType:t.shadowMap.type,toneMapping:i.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:2===i.side,flipSided:1===i.side,depthPacking:void 0!==i.depthPacking&&i.depthPacking,index0AttributeName:i.index0AttributeName,extensionDerivatives:i.extensions&&i.extensions.derivatives,extensionFragDepth:i.extensions&&i.extensions.fragDepth,extensionDrawBuffers:i.extensions&&i.extensions.drawBuffers,extensionShaderTextureLOD:i.extensions&&i.extensions.shaderTextureLOD,rendererExtensionFragDepth:s||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:s||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:s||n.has("EXT_shader_texture_lod"),customProgramCacheKey:i.customProgramCacheKey()}},getProgramCacheKey:function(e){var n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(var r in e.defines)n.push(r),n.push(e.defines[r]);if(!1===e.isRawShaderMaterial){for(var i=0;i<y.length;i++)n.push(e[y[i]]);n.push(t.outputEncoding),n.push(t.gammaFactor)}return n.push(e.customProgramCacheKey),n.join()},getUniforms:function(t){var e,n=m[t.type];if(n){var r=ar[n];e=Gn.clone(r.uniforms)}else e=t.uniforms;return e},acquireProgram:function(e,n){for(var r,o=0,s=a.length;o<s;o++){var l=a[o];if(l.cacheKey===n){++(r=l).usedTimes;break}}return void 0===r&&(r=new Mi(t,n,e,i),a.push(r)),r},releaseProgram:function(t){if(0==--t.usedTimes){var e=a.indexOf(t);a[e]=a[a.length-1],a.pop(),t.destroy()}},programs:a}}function Ci(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function zi(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Ri(t){var e=[],n=0,r=[],i=[],o={id:-1};function a(r,i,a,s,l,c){var u=e[n],p=t.get(a);return void 0===u?(u={id:r.id,object:r,geometry:i,material:a,program:p.program||o,groupOrder:s,renderOrder:r.renderOrder,z:l,group:c},e[n]=u):(u.id=r.id,u.object=r,u.geometry=i,u.material=a,u.program=p.program||o,u.groupOrder=s,u.renderOrder=r.renderOrder,u.z=l,u.group=c),n++,u}return{opaque:r,transparent:i,init:function(){n=0,r.length=0,i.length=0},push:function(t,e,n,o,s,l){var c=a(t,e,n,o,s,l);(!0===n.transparent?i:r).push(c)},unshift:function(t,e,n,o,s,l){var c=a(t,e,n,o,s,l);(!0===n.transparent?i:r).unshift(c)},finish:function(){for(var t=n,r=e.length;t<r;t++){var i=e[t];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.program=null,i.group=null}},sort:function(t,e){r.length>1&&r.sort(t||Ci),i.length>1&&i.sort(e||zi)}}}var Ai=0;function Li(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function Ii(t,e){var n=new function(t,e){for(var n,r=new function(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new Mt,color:new Qe};break;case"SpotLight":n={position:new Mt,direction:new Mt,color:new Qe,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Mt,color:new Qe,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Mt,skyColor:new Qe,groundColor:new Qe};break;case"RectAreaLight":n={color:new Qe,position:new Mt,halfWidth:new Mt,halfHeight:new Mt}}return t[e.id]=n,n}}},i=(n={},{get:function(t){if(void 0!==n[t.id])return n[t.id];var e;switch(t.type){case"DirectionalLight":case"SpotLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new mt};break;case"PointLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new mt,shadowCameraNear:1,shadowCameraFar:1e3}}return n[t.id]=e,e}}),o={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},a=0;a<9;a++)o.probe.push(new Mt);var s=new Mt,l=new te,c=new te;return{setup:function(n){for(var a=0,s=0,l=0,c=0;c<9;c++)o.probe[c].set(0,0,0);var u=0,p=0,d=0,h=0,f=0,m=0,y=0,_=0;n.sort(Li);for(var g=0,v=n.length;g<v;g++){var b=n[g],x=b.color,w=b.intensity,E=b.distance,T=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)a+=x.r*w,s+=x.g*w,l+=x.b*w;else if(b.isLightProbe)for(var S=0;S<9;S++)o.probe[S].addScaledVector(b.sh.coefficients[S],w);else if(b.isDirectionalLight){var M=r.get(b);if(M.color.copy(b.color).multiplyScalar(b.intensity),b.castShadow){var j=b.shadow,C=i.get(b);C.shadowBias=j.bias,C.shadowNormalBias=j.normalBias,C.shadowRadius=j.radius,C.shadowMapSize=j.mapSize,o.directionalShadow[u]=C,o.directionalShadowMap[u]=T,o.directionalShadowMatrix[u]=b.shadow.matrix,m++}o.directional[u]=M,u++}else if(b.isSpotLight){var z=r.get(b);if(z.position.setFromMatrixPosition(b.matrixWorld),z.color.copy(x).multiplyScalar(w),z.distance=E,z.coneCos=Math.cos(b.angle),z.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),z.decay=b.decay,b.castShadow){var R=b.shadow,A=i.get(b);A.shadowBias=R.bias,A.shadowNormalBias=R.normalBias,A.shadowRadius=R.radius,A.shadowMapSize=R.mapSize,o.spotShadow[d]=A,o.spotShadowMap[d]=T,o.spotShadowMatrix[d]=b.shadow.matrix,_++}o.spot[d]=z,d++}else if(b.isRectAreaLight){var L=r.get(b);L.color.copy(x).multiplyScalar(w),L.halfWidth.set(.5*b.width,0,0),L.halfHeight.set(0,.5*b.height,0),o.rectArea[h]=L,h++}else if(b.isPointLight){var I=r.get(b);if(I.color.copy(b.color).multiplyScalar(b.intensity),I.distance=b.distance,I.decay=b.decay,b.castShadow){var P=b.shadow,O=i.get(b);O.shadowBias=P.bias,O.shadowNormalBias=P.normalBias,O.shadowRadius=P.radius,O.shadowMapSize=P.mapSize,O.shadowCameraNear=P.camera.near,O.shadowCameraFar=P.camera.far,o.pointShadow[p]=O,o.pointShadowMap[p]=T,o.pointShadowMatrix[p]=b.shadow.matrix,y++}o.point[p]=I,p++}else if(b.isHemisphereLight){var k=r.get(b);k.skyColor.copy(b.color).multiplyScalar(w),k.groundColor.copy(b.groundColor).multiplyScalar(w),o.hemi[f]=k,f++}}h>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(o.rectAreaLTC1=or.LTC_FLOAT_1,o.rectAreaLTC2=or.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")?(o.rectAreaLTC1=or.LTC_HALF_1,o.rectAreaLTC2=or.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),o.ambient[0]=a,o.ambient[1]=s,o.ambient[2]=l;var B=o.hash;B.directionalLength===u&&B.pointLength===p&&B.spotLength===d&&B.rectAreaLength===h&&B.hemiLength===f&&B.numDirectionalShadows===m&&B.numPointShadows===y&&B.numSpotShadows===_||(o.directional.length=u,o.spot.length=d,o.rectArea.length=h,o.point.length=p,o.hemi.length=f,o.directionalShadow.length=m,o.directionalShadowMap.length=m,o.pointShadow.length=y,o.pointShadowMap.length=y,o.spotShadow.length=_,o.spotShadowMap.length=_,o.directionalShadowMatrix.length=m,o.pointShadowMatrix.length=y,o.spotShadowMatrix.length=_,B.directionalLength=u,B.pointLength=p,B.spotLength=d,B.rectAreaLength=h,B.hemiLength=f,B.numDirectionalShadows=m,B.numPointShadows=y,B.numSpotShadows=_,o.version=Ai++)},setupView:function(t,e){for(var n=0,r=0,i=0,a=0,u=0,p=e.matrixWorldInverse,d=0,h=t.length;d<h;d++){var f=t[d];if(f.isDirectionalLight){var m=o.directional[n];m.direction.setFromMatrixPosition(f.matrixWorld),s.setFromMatrixPosition(f.target.matrixWorld),m.direction.sub(s),m.direction.transformDirection(p),n++}else if(f.isSpotLight){var y=o.spot[i];y.position.setFromMatrixPosition(f.matrixWorld),y.position.applyMatrix4(p),y.direction.setFromMatrixPosition(f.matrixWorld),s.setFromMatrixPosition(f.target.matrixWorld),y.direction.sub(s),y.direction.transformDirection(p),i++}else if(f.isRectAreaLight){var _=o.rectArea[a];_.position.setFromMatrixPosition(f.matrixWorld),_.position.applyMatrix4(p),c.identity(),l.copy(f.matrixWorld),l.premultiply(p),c.extractRotation(l),_.halfWidth.set(.5*f.width,0,0),_.halfHeight.set(0,.5*f.height,0),_.halfWidth.applyMatrix4(c),_.halfHeight.applyMatrix4(c),a++}else if(f.isPointLight){var g=o.point[r];g.position.setFromMatrixPosition(f.matrixWorld),g.position.applyMatrix4(p),r++}else if(f.isHemisphereLight){var v=o.hemi[u];v.direction.setFromMatrixPosition(f.matrixWorld),v.direction.transformDirection(p),v.direction.normalize(),u++}}},state:o}}(t,e),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(){n.setup(r)},setupLightsView:function(t){n.setupView(r,t)},pushLight:function(t){r.push(t)},pushShadow:function(t){i.push(t)}}}var Pi=function(t){function e(e){var n;return(n=t.call(this)||this).type="MeshDepthMaterial",n.depthPacking=3200,n.skinning=!1,n.morphTargets=!1,n.map=null,n.alphaMap=null,n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.wireframe=!1,n.wireframeLinewidth=1,n.fog=!1,n.setValues(e),n}return st(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},e}(Ue);Pi.prototype.isMeshDepthMaterial=!0;var Oi=function(t){function e(e){var n;return(n=t.call(this)||this).type="MeshDistanceMaterial",n.referencePosition=new Mt,n.nearDistance=1,n.farDistance=1e3,n.skinning=!1,n.morphTargets=!1,n.map=null,n.alphaMap=null,n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.fog=!1,n.setValues(e),n}return st(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},e}(Ue);function ki(t,e,n){var r=new er,i=new mt,o=new mt,a=new wt,s=[],l=[],c={},u={0:1,1:0,2:2},p=new Wn({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new mt},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),d=p.clone();d.defines.HORIZONTAL_PASS=1;var h=new xn;h.setAttribute("position",new $e(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var m=new Hn(h,p),y=this;function g(n,r){var i=e.update(m);p.uniforms.shadow_pass.value=n.map.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(r,null,i,p,m,null),d.uniforms.shadow_pass.value=n.mapPass.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(r,null,i,d,m,null)}function v(t,e,n){var r=t<<0|e<<1|n<<2,i=s[r];return void 0===i&&(i=new Pi({depthPacking:3201,morphTargets:t,skinning:e}),s[r]=i),i}function b(t,e,n){var r=t<<0|e<<1|n<<2,i=l[r];return void 0===i&&(i=new Oi({morphTargets:t,skinning:e}),l[r]=i),i}function x(e,n,r,i,o,a,s){var l=null,p=v,d=e.customDepthMaterial;if(!0===i.isPointLight&&(p=b,d=e.customDistanceMaterial),void 0===d){var h=!1;!0===r.morphTargets&&(h=n.morphAttributes&&n.morphAttributes.position&&n.morphAttributes.position.length>0);var f=!1;!0===e.isSkinnedMesh&&(!0===r.skinning?f=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e)),l=p(h,f,!0===e.isInstancedMesh)}else l=d;if(t.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){var m=l.uuid,y=r.uuid,_=c[m];void 0===_&&(_={},c[m]=_);var g=_[y];void 0===g&&(g=l.clone(),_[y]=g),l=g}return l.visible=r.visible,l.wireframe=r.wireframe,l.side=3===s?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:u[r.side],l.clipShadows=r.clipShadows,l.clippingPlanes=r.clippingPlanes,l.clipIntersection=r.clipIntersection,l.wireframeLinewidth=r.wireframeLinewidth,l.linewidth=r.linewidth,!0===i.isPointLight&&!0===l.isMeshDistanceMaterial&&(l.referencePosition.setFromMatrixPosition(i.matrixWorld),l.nearDistance=o,l.farDistance=a),l}function w(n,i,o,a,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var l=e.update(n),c=n.material;if(Array.isArray(c))for(var u=l.groups,p=0,d=u.length;p<d;p++){var h=u[p],f=c[h.materialIndex];if(f&&f.visible){var m=x(n,l,f,a,o.near,o.far,s);t.renderBufferDirect(o,null,l,m,n,h)}}else if(c.visible){var y=x(n,l,c,a,o.near,o.far,s);t.renderBufferDirect(o,null,l,y,n,null)}}for(var _=n.children,g=0,v=_.length;g<v;g++)w(_[g],i,o,a,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(e,s,l){if(!1!==y.enabled&&(!1!==y.autoUpdate||!1!==y.needsUpdate)&&0!==e.length){var c=t.getRenderTarget(),u=t.getActiveCubeFace(),p=t.getActiveMipmapLevel(),d=t.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var h=0,m=e.length;h<m;h++){var v=e[h],b=v.shadow;if(void 0!==b){if(!1!==b.autoUpdate||!1!==b.needsUpdate){i.copy(b.mapSize);var x=b.getFrameExtents();if(i.multiply(x),o.copy(b.mapSize),(i.x>n||i.y>n)&&(i.x>n&&(o.x=Math.floor(n/x.x),i.x=o.x*x.x,b.mapSize.x=o.x),i.y>n&&(o.y=Math.floor(n/x.y),i.y=o.y*x.y,b.mapSize.y=o.y)),null===b.map&&!b.isPointLightShadow&&3===this.type){var E={minFilter:_,magFilter:_,format:M};b.map=new Et(i.x,i.y,E),b.map.texture.name=v.name+".shadowMap",b.mapPass=new Et(i.x,i.y,E),b.camera.updateProjectionMatrix()}if(null===b.map){var T={minFilter:f,magFilter:f,format:M};b.map=new Et(i.x,i.y,T),b.map.texture.name=v.name+".shadowMap",b.camera.updateProjectionMatrix()}t.setRenderTarget(b.map),t.clear();for(var S=b.getViewportCount(),j=0;j<S;j++){var C=b.getViewport(j);a.set(o.x*C.x,o.y*C.y,o.x*C.z,o.y*C.w),d.viewport(a),b.updateMatrices(v,j),r=b.getFrustum(),w(s,l,b.camera,v,this.type)}b.isPointLightShadow||3!==this.type||g(b,l),b.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",v,"has no shadow.")}y.needsUpdate=!1,t.setRenderTarget(c,u,p)}}}function Bi(t,e,n){var i,o,a=n.isWebGL2,s=new function(){var e=!1,n=new wt,r=null,i=new wt(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,o,a,s){!0===s&&(e*=a,r*=a,o*=a),n.set(e,r,o,a),!1===i.equals(n)&&(t.clearColor(e,r,o,a),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},l=new function(){var e=!1,n=null,r=null,i=null;return{setTest:function(t){t?k(2929):B(2929)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}},c=new function(){var e=!1,n=null,r=null,i=null,o=null,a=null,s=null,l=null,c=null;return{setTest:function(t){e||(t?k(2960):B(2960))},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,a){r===e&&i===n&&o===a||(t.stencilFunc(e,n,a),r=e,i=n,o=a)},setOp:function(e,n,r){a===e&&s===n&&l===r||(t.stencilOp(e,n,r),a=e,s=n,l=r)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,r=null,i=null,o=null,a=null,s=null,l=null,c=null}}},u={},p=null,d=!1,h=null,f=null,m=null,y=null,_=null,g=null,v=null,b=!1,x=null,w=null,E=null,T=null,S=null,M=t.getParameter(35661),j=!1,C=0,z=t.getParameter(7938);-1!==z.indexOf("WebGL")?(C=parseFloat(/^WebGL (\d)/.exec(z)[1]),j=C>=1):-1!==z.indexOf("OpenGL ES")&&(C=parseFloat(/^OpenGL ES (\d)/.exec(z)[1]),j=C>=2);var R=null,A={},L=new wt,I=new wt;function P(e,n,r){var i=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(var a=0;a<r;a++)t.texImage2D(n+a,0,6408,1,1,0,6408,5121,i);return o}var O={};function k(e){!0!==u[e]&&(t.enable(e),u[e]=!0)}function B(e){!1!==u[e]&&(t.disable(e),u[e]=!1)}O[3553]=P(3553,3553,1),O[34067]=P(34067,34069,6),s.setClear(0,0,0,1),l.setClear(1),c.setClear(0),k(2929),l.setFunc(3),U(!1),V(1),k(2884),N(0);var D=((i={})[100]=32774,i[101]=32778,i[102]=32779,i);if(a)D[103]=32775,D[104]=32776;else{var H=e.get("EXT_blend_minmax");null!==H&&(D[103]=H.MIN_EXT,D[104]=H.MAX_EXT)}var F=((o={})[200]=0,o[201]=1,o[202]=768,o[204]=770,o[210]=776,o[208]=774,o[206]=772,o[203]=769,o[205]=771,o[209]=775,o[207]=773,o);function N(e,n,i,o,a,s,l,c){if(0!==e){if(!1===d&&(k(3042),d=!0),5===e)a=a||n,s=s||i,l=l||o,n===f&&a===_||(t.blendEquationSeparate(D[n],D[a]),f=n,_=a),i===m&&o===y&&s===g&&l===v||(t.blendFuncSeparate(F[i],F[o],F[s],F[l]),m=i,y=o,g=s,v=l),h=e,b=null;else if(e!==h||c!==b){if(f===r&&_===r||(t.blendEquation(32774),f=r,_=r),c)switch(e){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,0,769,771);break;case 4:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFunc(0,769);break;case 4:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}m=null,y=null,g=null,v=null,h=e,b=c}}else!0===d&&(B(3042),d=!1)}function U(e){x!==e&&(e?t.frontFace(2304):t.frontFace(2305),x=e)}function V(e){0!==e?(k(2884),e!==w&&(1===e?t.cullFace(1029):2===e?t.cullFace(1028):t.cullFace(1032))):B(2884),w=e}function G(e,n,r){e?(k(32823),T===n&&S===r||(t.polygonOffset(n,r),T=n,S=r)):B(32823)}function W(e){void 0===e&&(e=33984+M-1),R!==e&&(t.activeTexture(e),R=e)}return{buffers:{color:s,depth:l,stencil:c},enable:k,disable:B,useProgram:function(e){return p!==e&&(t.useProgram(e),p=e,!0)},setBlending:N,setMaterial:function(t,e){2===t.side?B(2884):k(2884);var n=1===t.side;e&&(n=!n),U(n),1===t.blending&&!1===t.transparent?N(0):N(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),l.setFunc(t.depthFunc),l.setTest(t.depthTest),l.setMask(t.depthWrite),s.setMask(t.colorWrite);var r=t.stencilWrite;c.setTest(r),r&&(c.setMask(t.stencilWriteMask),c.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),c.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),G(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:U,setCullFace:V,setLineWidth:function(e){e!==E&&(j&&t.lineWidth(e),E=e)},setPolygonOffset:G,setScissorTest:function(t){t?k(3089):B(3089)},activeTexture:W,bindTexture:function(e,n){null===R&&W();var r=A[R];void 0===r&&(r={type:void 0,texture:void 0},A[R]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||O[e]),r.type=e,r.texture=n)},unbindTexture:function(){var e=A[R];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===L.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),L.copy(e))},viewport:function(e){!1===I.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),I.copy(e))},reset:function(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),u={},R=null,A={},p=null,d=!1,h=null,f=null,m=null,y=null,_=null,g=null,v=null,b=!1,x=null,w=null,E=null,T=null,S=null,s.reset(),l.reset(),c.reset()}}}function Di(t,e,n,r,i,o,a){var s,l,c,u=i.isWebGL2,p=i.maxTextures,h=i.maxCubemapSize,g=i.maxTextureSize,v=i.maxSamples,z=new WeakMap,R=!1;try{R="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function A(t,e){return R?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function L(t,e,n,r){var i=1;if((t.width>r||t.height>r)&&(i=r/Math.max(t.width,t.height)),i<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){var o=e?ft.floorPowerOfTwo:Math.floor,a=o(i*t.width),s=o(i*t.height);void 0===c&&(c=A(a,s));var l=n?A(a,s):c;return l.width=a,l.height=s,l.getContext("2d").drawImage(t,0,0,a,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+a+"x"+s+")."),l}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function I(t){return ft.isPowerOfTwo(t.width)&&ft.isPowerOfTwo(t.height)}function P(t,e){return t.generateMipmaps&&e&&t.minFilter!==f&&t.minFilter!==_}function O(e,n,i,o){t.generateMipmap(e),r.get(n).__maxMipLevel=Math.log2(Math.max(i,o))}function k(n,r,i){if(!1===u)return r;if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var o=r;return 6403===r&&(5126===i&&(o=33326),5131===i&&(o=33325),5121===i&&(o=33321)),6407===r&&(5126===i&&(o=34837),5131===i&&(o=34843),5121===i&&(o=32849)),6408===r&&(5126===i&&(o=34836),5131===i&&(o=34842),5121===i&&(o=32856)),33325!==o&&33326!==o&&34842!==o&&34836!==o||e.get("EXT_color_buffer_float"),o}function B(t){return t===f||t===m||t===y?9728:9729}function D(e){var n=e.target;n.removeEventListener("dispose",D),function(e){var n=r.get(e);void 0!==n.__webglInit&&(t.deleteTexture(n.__webglTexture),r.remove(e))}(n),n.isVideoTexture&&z.delete(n),a.memory.textures--}function H(e){var n=e.target;n.removeEventListener("dispose",H),function(e){var n=e.texture,i=r.get(e),o=r.get(n);if(e){if(void 0!==o.__webglTexture&&t.deleteTexture(o.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLCubeRenderTarget)for(var a=0;a<6;a++)t.deleteFramebuffer(i.__webglFramebuffer[a]),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer[a]);else t.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&t.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer&&t.deleteRenderbuffer(i.__webglColorRenderbuffer),i.__webglDepthRenderbuffer&&t.deleteRenderbuffer(i.__webglDepthRenderbuffer);r.remove(n),r.remove(e)}}(n),a.memory.textures--}var F=0;function N(t,e){var i=r.get(t);if(t.isVideoTexture&&function(t){var e=a.render.frame;z.get(t)!==e&&(z.set(t,e),t.update())}(t),t.version>0&&i.__version!==t.version){var o=t.image;if(void 0===o)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==o.complete)return void X(i,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+e),n.bindTexture(3553,i.__webglTexture)}function U(e,i){var a=r.get(e);e.version>0&&a.__version!==e.version?function(e,r,i){if(6===r.image.length){q(e,r),n.activeTexture(33984+i),n.bindTexture(34067,e.__webglTexture),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment),t.pixelStorei(37443,0);for(var a=r&&(r.isCompressedTexture||r.image[0].isCompressedTexture),s=r.image[0]&&r.image[0].isDataTexture,l=[],c=0;c<6;c++)l[c]=a||s?s?r.image[c].image:r.image[c]:L(r.image[c],!1,!0,h);var p,d=l[0],f=I(d)||u,m=o.convert(r.format),y=o.convert(r.type),_=k(r.internalFormat,m,y);if(W(34067,r,f),a){for(var g=0;g<6;g++){p=l[g].mipmaps;for(var v=0;v<p.length;v++){var b=p[v];r.format!==M&&r.format!==S?null!==m?n.compressedTexImage2D(34069+g,v,_,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+g,v,_,b.width,b.height,0,m,y,b.data)}}e.__maxMipLevel=p.length-1}else{p=r.mipmaps;for(var x=0;x<6;x++)if(s){n.texImage2D(34069+x,0,_,l[x].width,l[x].height,0,m,y,l[x].data);for(var w=0;w<p.length;w++){var E=p[w].image[x].image;n.texImage2D(34069+x,w+1,_,E.width,E.height,0,m,y,E.data)}}else{n.texImage2D(34069+x,0,_,m,y,l[x]);for(var T=0;T<p.length;T++){var j=p[T];n.texImage2D(34069+x,T+1,_,m,y,j.image[x])}}e.__maxMipLevel=p.length}P(r,f)&&O(34067,r,d.width,d.height),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}}(a,e,i):(n.activeTexture(33984+i),n.bindTexture(34067,a.__webglTexture))}var V=((s={})[1e3]=10497,s[1001]=33071,s[1002]=33648,s),G=((l={})[1003]=9728,l[1004]=9984,l[1005]=9986,l[1006]=9729,l[1007]=9985,l[1008]=9987,l);function W(n,o,a){if(a?(t.texParameteri(n,10242,V[o.wrapS]),t.texParameteri(n,10243,V[o.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,V[o.wrapR]),t.texParameteri(n,10240,G[o.magFilter]),t.texParameteri(n,10241,G[o.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),o.wrapS===d&&o.wrapT===d||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(n,10240,B(o.magFilter)),t.texParameteri(n,10241,B(o.minFilter)),o.minFilter!==f&&o.minFilter!==_&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){var s=e.get("EXT_texture_filter_anisotropic");if(o.type===w&&!1===e.has("OES_texture_float_linear"))return;if(!1===u&&o.type===E&&!1===e.has("OES_texture_half_float_linear"))return;(o.anisotropy>1||r.get(o).__currentAnisotropy)&&(t.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function q(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",D),e.__webglTexture=t.createTexture(),a.memory.textures++)}function X(e,r,i){var a=3553;r.isDataTexture2DArray&&(a=35866),r.isDataTexture3D&&(a=32879),q(e,r),n.activeTexture(33984+i),n.bindTexture(a,e.__webglTexture),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment),t.pixelStorei(37443,0);var s,l=function(t){return!u&&(t.wrapS!==d||t.wrapT!==d||t.minFilter!==f&&t.minFilter!==_)}(r)&&!1===I(r.image),c=L(r.image,l,!1,g),p=I(c)||u,h=o.convert(r.format),m=o.convert(r.type),y=k(r.internalFormat,h,m);W(a,r,p);var v=r.mipmaps;if(r.isDepthTexture)y=6402,u?y=r.type===w?36012:r.type===x?33190:r.type===T?35056:33189:r.type===w&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===j&&6402===y&&r.type!==b&&r.type!==x&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=b,m=o.convert(r.type)),r.format===C&&6402===y&&(y=34041,r.type!==T&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=T,m=o.convert(r.type))),n.texImage2D(3553,0,y,c.width,c.height,0,h,m,null);else if(r.isDataTexture)if(v.length>0&&p){for(var E=0,z=v.length;E<z;E++)s=v[E],n.texImage2D(3553,E,y,s.width,s.height,0,h,m,s.data);r.generateMipmaps=!1,e.__maxMipLevel=v.length-1}else n.texImage2D(3553,0,y,c.width,c.height,0,h,m,c.data),e.__maxMipLevel=0;else if(r.isCompressedTexture){for(var R=0,A=v.length;R<A;R++)s=v[R],r.format!==M&&r.format!==S?null!==h?n.compressedTexImage2D(3553,R,y,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,R,y,s.width,s.height,0,h,m,s.data);e.__maxMipLevel=v.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,y,c.width,c.height,c.depth,0,h,m,c.data),e.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,y,c.width,c.height,c.depth,0,h,m,c.data),e.__maxMipLevel=0;else if(v.length>0&&p){for(var B=0,D=v.length;B<D;B++)s=v[B],n.texImage2D(3553,B,y,h,m,s);r.generateMipmaps=!1,e.__maxMipLevel=v.length-1}else n.texImage2D(3553,0,y,h,m,c),e.__maxMipLevel=0;P(r,p)&&O(a,r,c.width,c.height),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}function Y(e,i,a,s){var l=i.texture,c=o.convert(l.format),u=o.convert(l.type),p=k(l.internalFormat,c,u);32879===s||35866===s?n.texImage3D(s,0,p,i.width,i.height,i.depth,0,c,u,null):n.texImage2D(s,0,p,i.width,i.height,0,c,u,null),t.bindFramebuffer(36160,e),t.framebufferTexture2D(36160,a,s,r.get(l).__webglTexture,0),t.bindFramebuffer(36160,null)}function Q(e,n,r){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){var i=33189;if(r){var a=n.depthTexture;a&&a.isDepthTexture&&(a.type===w?i=36012:a.type===x&&(i=33190));var s=Z(n);t.renderbufferStorageMultisample(36161,s,i,n.width,n.height)}else t.renderbufferStorage(36161,i,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){if(r){var l=Z(n);t.renderbufferStorageMultisample(36161,l,35056,n.width,n.height)}else t.renderbufferStorage(36161,34041,n.width,n.height);t.framebufferRenderbuffer(36160,33306,36161,e)}else{var c=n.texture,u=o.convert(c.format),p=o.convert(c.type),d=k(c.internalFormat,u,p);if(r){var h=Z(n);t.renderbufferStorageMultisample(36161,h,d,n.width,n.height)}else t.renderbufferStorage(36161,d,n.width,n.height)}t.bindRenderbuffer(36161,null)}function Z(t){return u&&t.isWebGLMultisampleRenderTarget?Math.min(v,t.samples):0}var J=!1,K=!1;this.allocateTextureUnit=function(){var t=F;return t>=p&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+p),F+=1,t},this.resetTextureUnits=function(){F=0},this.setTexture2D=N,this.setTexture2DArray=function(t,e){var i=r.get(t);t.version>0&&i.__version!==t.version?X(i,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(t,e){var i=r.get(t);t.version>0&&i.__version!==t.version?X(i,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=U,this.setupRenderTarget=function(e){var i=e.texture,s=r.get(e),l=r.get(i);e.addEventListener("dispose",H),l.__webglTexture=t.createTexture(),a.memory.textures++;var c=!0===e.isWebGLCubeRenderTarget,p=!0===e.isWebGLMultisampleRenderTarget,d=i.isDataTexture3D||i.isDataTexture2DArray,h=I(e)||u;if(!u||i.format!==S||i.type!==w&&i.type!==E||(i.format=M,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),c){s.__webglFramebuffer=[];for(var f=0;f<6;f++)s.__webglFramebuffer[f]=t.createFramebuffer()}else if(s.__webglFramebuffer=t.createFramebuffer(),p)if(u){s.__webglMultisampledFramebuffer=t.createFramebuffer(),s.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,s.__webglColorRenderbuffer);var m=o.convert(i.format),y=o.convert(i.type),_=k(i.internalFormat,m,y),g=Z(e);t.renderbufferStorageMultisample(36161,g,_,e.width,e.height),t.bindFramebuffer(36160,s.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,s.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(s.__webglDepthRenderbuffer=t.createRenderbuffer(),Q(s.__webglDepthRenderbuffer,e,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(c){n.bindTexture(34067,l.__webglTexture),W(34067,i,h);for(var v=0;v<6;v++)Y(s.__webglFramebuffer[v],e,36064,34069+v);P(i,h)&&O(34067,i,e.width,e.height),n.bindTexture(34067,null)}else{var b=3553;d&&(u?b=i.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),n.bindTexture(b,l.__webglTexture),W(b,i,h),Y(s.__webglFramebuffer,e,36064,b),P(i,h)&&O(3553,i,e.width,e.height),n.bindTexture(3553,null)}e.depthBuffer&&function(e){var n=r.get(e),i=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),N(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===j)t.framebufferTexture2D(36160,36096,3553,i,0);else{if(n.depthTexture.format!==C)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,i,0)}}(n.__webglFramebuffer,e)}else if(i){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)t.bindFramebuffer(36160,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=t.createRenderbuffer(),Q(n.__webglDepthbuffer[o],e,!1)}else t.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),Q(n.__webglDepthbuffer,e,!1);t.bindFramebuffer(36160,null)}(e)},this.updateRenderTargetMipmap=function(t){var e=t.texture;if(P(e,I(t)||u)){var i=t.isWebGLCubeRenderTarget?34067:3553,o=r.get(e).__webglTexture;n.bindTexture(i,o),O(i,e,t.width,t.height),n.bindTexture(i,null)}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget)if(u){var n=r.get(e);t.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,n.__webglFramebuffer);var i=e.width,o=e.height,a=16384;e.depthBuffer&&(a|=256),e.stencilBuffer&&(a|=1024),t.blitFramebuffer(0,0,i,o,0,0,i,o,a,9728),t.bindFramebuffer(36160,n.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===J&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),J=!0),t=t.texture),N(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===K&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),K=!0),t=t.texture),U(t,e)}}function Hi(t,e,n){var r=n.isWebGL2;return{convert:function(t){var n;if(t===v)return 5121;if(1017===t)return 32819;if(1018===t)return 32820;if(1019===t)return 33635;if(1010===t)return 5120;if(1011===t)return 5122;if(t===b)return 5123;if(1013===t)return 5124;if(t===x)return 5125;if(t===w)return 5126;if(t===E)return r?5131:null!==(n=e.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(1021===t)return 6406;if(t===S)return 6407;if(t===M)return 6408;if(1024===t)return 6409;if(1025===t)return 6410;if(t===j)return 6402;if(t===C)return 34041;if(1028===t)return 6403;if(1029===t)return 36244;if(1030===t)return 33319;if(1031===t)return 33320;if(1032===t)return 36248;if(1033===t)return 36249;if(t===z||t===R||t===A||t===L){if(null===(n=e.get("WEBGL_compressed_texture_s3tc")))return null;if(t===z)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===R)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===A)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===L)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(t===I||t===P||t===O||t===k){if(null===(n=e.get("WEBGL_compressed_texture_pvrtc")))return null;if(t===I)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===P)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===O)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===k)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===t)return null!==(n=e.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((t===B||t===D)&&null!==(n=e.get("WEBGL_compressed_texture_etc"))){if(t===B)return n.COMPRESSED_RGB8_ETC2;if(t===D)return n.COMPRESSED_RGBA8_ETC2_EAC}return 37808===t||37809===t||37810===t||37811===t||37812===t||37813===t||37814===t||37815===t||37816===t||37817===t||37818===t||37819===t||37820===t||37821===t||37840===t||37841===t||37842===t||37843===t||37844===t||37845===t||37846===t||37847===t||37848===t||37849===t||37850===t||37851===t||37852===t||37853===t?null!==(n=e.get("WEBGL_compressed_texture_astc"))?t:null:36492===t?null!==(n=e.get("EXT_texture_compression_bptc"))?t:null:t===T?r?34042:null!==(n=e.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function Fi(t){void 0===t&&(t=[]),Xn.call(this),this.cameras=t}Oi.prototype.isMeshDistanceMaterial=!0,Fi.prototype=Object.assign(Object.create(Xn.prototype),{constructor:Fi,isArrayCamera:!0});var Ni=function(t){function e(){var e;return(e=t.call(this)||this).type="Group",e}return st(e,t),e}(Se);function Ui(){this._targetRay=null,this._grip=null,this._hand=null}function Vi(t,e){var n=this,r=null,i=1,o=null,a="local-floor",s=null,l=[],c=new Map,u=new Xn;u.layers.enable(1),u.viewport=new wt;var p=new Xn;p.layers.enable(2),p.viewport=new wt;var d=[u,p],h=new Fi;h.layers.enable(1),h.layers.enable(2);var f=null,m=null;function y(t){var e=c.get(t.inputSource);e&&e.dispatchEvent({type:t.type,data:t.inputSource})}function _(){c.forEach(function(t,e){t.disconnect(e)}),c.clear(),f=null,m=null,t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),E.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function g(t){for(var e=r.inputSources,n=0;n<l.length;n++)c.set(e[n],l[n]);for(var i=0;i<t.removed.length;i++){var o=t.removed[i],a=c.get(o);a&&(a.dispatchEvent({type:"disconnected",data:o}),c.delete(o))}for(var s=0;s<t.added.length;s++){var u=t.added[s],p=c.get(u);p&&p.dispatchEvent({type:"connected",data:u})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(t){var e=l[t];return void 0===e&&(e=new Ui,l[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){var e=l[t];return void 0===e&&(e=new Ui,l[t]=e),e.getGripSpace()},this.getHand=function(t){var e=l[t];return void 0===e&&(e=new Ui,l[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){i=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){a=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getSession=function(){return r},this.setSession=function(){var t,s=(t=regeneratorRuntime.mark(function t(s){var l,c,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(r=s)){t.next=24;break}if(r.addEventListener("select",y),r.addEventListener("selectstart",y),r.addEventListener("selectend",y),r.addEventListener("squeeze",y),r.addEventListener("squeezestart",y),r.addEventListener("squeezeend",y),r.addEventListener("end",_),r.addEventListener("inputsourceschange",g),!0===(l=e.getContextAttributes()).xrCompatible){t.next=14;break}return t.next=14,e.makeXRCompatible();case 14:return c={antialias:l.antialias,alpha:l.alpha,depth:l.depth,stencil:l.stencil,framebufferScaleFactor:i},u=new XRWebGLLayer(r,e,c),r.updateRenderState({baseLayer:u}),t.next=19,r.requestReferenceSpace(a);case 19:o=t.sent,E.setContext(r),E.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"});case 24:case"end":return t.stop()}},t)}),function(){var e=this,n=arguments;return new Promise(function(r,i){var o=t.apply(e,n);function a(t){it(o,r,i,a,s,"next",t)}function s(t){it(o,r,i,a,s,"throw",t)}a(void 0)})});return function(t){return s.apply(this,arguments)}}();var v=new Mt,b=new Mt;function x(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.getCamera=function(t){h.near=p.near=u.near=t.near,h.far=p.far=u.far=t.far,f===h.near&&m===h.far||(r.updateRenderState({depthNear:h.near,depthFar:h.far}),f=h.near,m=h.far);var e=t.parent,n=h.cameras;x(h,e);for(var i=0;i<n.length;i++)x(n[i],e);t.matrixWorld.copy(h.matrixWorld),t.matrix.copy(h.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale);for(var o=t.children,a=0,s=o.length;a<s;a++)o[a].updateMatrixWorld(!0);return 2===n.length?function(t,e,n){v.setFromMatrixPosition(e.matrixWorld),b.setFromMatrixPosition(n.matrixWorld);var r=v.distanceTo(b),i=e.projectionMatrix.elements,o=n.projectionMatrix.elements,a=i[14]/(i[10]-1),s=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],p=(o[8]+1)/o[0],d=a*u,h=a*p,f=r/(-u+p),m=f*-u;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(f),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();var y=a+f,_=s+f,g=d-m,x=h+(r-m),w=l*s/_*y,E=c*s/_*y;t.projectionMatrix.makePerspective(g,x,w,E,y,_)}(h,u,p):h.projectionMatrix.copy(u.projectionMatrix),h};var w=null,E=new nr;E.setAnimationLoop(function(e,n){if(null!==(s=n.getViewerPose(o))){var i=s.views,a=r.renderState.baseLayer;t.setFramebuffer(a.framebuffer);var c=!1;i.length!==h.cameras.length&&(h.cameras.length=0,c=!0);for(var u=0;u<i.length;u++){var p=i[u],f=a.getViewport(p),m=d[u];m.matrix.fromArray(p.transform.matrix),m.projectionMatrix.fromArray(p.projectionMatrix),m.viewport.set(f.x,f.y,f.width,f.height),0===u&&h.matrix.copy(m.matrix),!0===c&&h.cameras.push(m)}}for(var y=r.inputSources,_=0;_<l.length;_++){var g=l[_],v=y[_];g.update(v,n,o)}w&&w(e,n)}),this.setAnimationLoop=function(t){w=t},this.dispose=function(){}}function Gi(t){var e,n=void 0!==(t=t||{}).canvas?t.canvas:((e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).style.display="block",e),r=void 0!==t.context?t.context:null,i=void 0!==t.alpha&&t.alpha,o=void 0===t.depth||t.depth,a=void 0===t.stencil||t.stencil,s=void 0!==t.antialias&&t.antialias,l=void 0===t.premultipliedAlpha||t.premultipliedAlpha,c=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,u=void 0!==t.powerPreference?t.powerPreference:"default",p=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat,d=null,h=null,f=[],m=[];this.domElement=n,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=X,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var y=this,_=!1,g=null,b=0,x=0,T=null,S=null,j=-1,C=null,z=new wt,R=new wt,A=null,L=n.width,I=n.height,P=1,O=null,k=null,B=new wt(0,0,L,I),D=new wt(0,0,L,I),H=!1,F=new er,N=!1,U=!1,V=new te,G=new Mt,W={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function q(){return null===T?P:1}var Y,Q,Z,J,K,$,tt,et,nt,rt,it,ot,at,st,lt,ct,ut,pt,dt,ht,yt,_t=r;function gt(t,e){for(var r=0;r<t.length;r++){var i=t[r],o=n.getContext(i,e);if(null!==o)return o}return null}try{var vt={alpha:i,depth:o,stencil:a,antialias:s,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:p};if(n.addEventListener("webglcontextlost",St,!1),n.addEventListener("webglcontextrestored",jt,!1),null===_t){var bt=["webgl2","webgl","experimental-webgl"];if(!0===y.isWebGL1Renderer&&bt.shift(),null===(_t=gt(bt,vt)))throw gt(bt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===_t.getShaderPrecisionFormat&&(_t.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}function xt(){Y=new function(t){var e={};function n(n){if(void 0!==e[n])return e[n];var r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return e[n]=r,r}return{has:function(t){return null!==n(t)},init:function(t){t.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float")},get:function(t){var e=n(t);return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}(_t),Q=new function(t,e,n){var r;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var o="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext,a=void 0!==n.precision?n.precision:"highp",s=i(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var l=!0===n.logarithmicDepthBuffer,c=t.getParameter(34930),u=t.getParameter(35660),p=t.getParameter(3379),d=t.getParameter(34076),h=t.getParameter(34921),f=t.getParameter(36347),m=t.getParameter(36348),y=t.getParameter(36349),_=u>0,g=o||e.has("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===e.has("EXT_texture_filter_anisotropic")){var n=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:l,maxTextures:c,maxVertexTextures:u,maxTextureSize:p,maxCubemapSize:d,maxAttributes:h,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:y,vertexTextures:_,floatFragmentTextures:g,floatVertexTextures:_&&g,maxSamples:o?t.getParameter(36183):0}}(_t,Y,t),Y.init(Q),ht=new Hi(_t,Y,Q),(Z=new Bi(_t,Y,Q)).scissor(R.copy(D).multiplyScalar(P).floor()),Z.viewport(z.copy(B).multiplyScalar(P).floor()),J=new function(t){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,r){switch(e.calls++,n){case 4:e.triangles+=r*(t/3);break;case 1:e.lines+=r*(t/2);break;case 3:e.lines+=r*(t-1);break;case 2:e.lines+=r*t;break;case 0:e.points+=r*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}(_t),K=new function(){var t=new WeakMap;return{get:function(e){var n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}},$=new Di(_t,Y,Z,K,Q,ht,J),tt=new cr(y),et=new function(t,e){var n=Q.isWebGL2,r=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),r.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);var n=r.get(e);n&&(t.deleteBuffer(n.buffer),r.delete(e))},update:function(e,i){if(e.isGLBufferAttribute){var o=r.get(e);(!o||o.version<e.version)&&r.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version})}else{e.isInterleavedBufferAttribute&&(e=e.data);var a=r.get(e);void 0===a?r.set(e,function(e,r){var i=e.array,o=e.usage,a=t.createBuffer();t.bindBuffer(r,a),t.bufferData(r,i,o),e.onUploadCallback();var s=5126;return i instanceof Float32Array?s=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?e.isFloat16BufferAttribute?n?s=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):s=5123:i instanceof Int16Array?s=5122:i instanceof Uint32Array?s=5125:i instanceof Int32Array?s=5124:i instanceof Int8Array?s=5120:i instanceof Uint8Array&&(s=5121),{buffer:a,type:s,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version}}(e,i)):a.version<e.version&&(function(e,r,i){var o=r.array,a=r.updateRange;t.bindBuffer(i,e),-1===a.count?t.bufferSubData(i,0,o):(n?t.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o,a.offset,a.count):t.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1)}(a.buffer,e,i),a.version=e.version)}}}}(_t,0),yt=new function(t,e,n,r){var i=t.getParameter(34921),o=r.isWebGL2?null:e.get("OES_vertex_array_object"),a=r.isWebGL2||null!==o,s={},l=d(null),c=l;function u(e){return r.isWebGL2?t.bindVertexArray(e):o.bindVertexArrayOES(e)}function p(e){return r.isWebGL2?t.deleteVertexArray(e):o.deleteVertexArrayOES(e)}function d(t){for(var e=[],n=[],r=[],o=0;o<i;o++)e[o]=0,n[o]=0,r[o]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:n,attributeDivisors:r,object:t,attributes:{},index:null}}function h(){for(var t=c.newAttributes,e=0,n=t.length;e<n;e++)t[e]=0}function f(t){m(t,0)}function m(n,i){var o=c.newAttributes,a=c.enabledAttributes,s=c.attributeDivisors;o[n]=1,0===a[n]&&(t.enableVertexAttribArray(n),a[n]=1),s[n]!==i&&((r.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),s[n]=i)}function y(){for(var e=c.newAttributes,n=c.enabledAttributes,r=0,i=n.length;r<i;r++)n[r]!==e[r]&&(t.disableVertexAttribArray(r),n[r]=0)}function _(e,n,i,o,a,s){!0!==r.isWebGL2||5124!==i&&5125!==i?t.vertexAttribPointer(e,n,i,o,a,s):t.vertexAttribIPointer(e,n,i,a,s)}function g(){v(),c!==l&&u((c=l).object)}function v(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,p,g,v){var b=!1;if(a){var x=function(e,n,i){var a=!0===i.wireframe,l=s[e.id];void 0===l&&(l={},s[e.id]=l);var c=l[n.id];void 0===c&&(c={},l[n.id]=c);var u=c[a];return void 0===u&&(u=d(r.isWebGL2?t.createVertexArray():o.createVertexArrayOES()),c[a]=u),u}(g,p,l);c!==x&&u((c=x).object),(b=function(t,e){var n=c.attributes,r=t.attributes,i=0;for(var o in r){var a=n[o],s=r[o];if(void 0===a)return!0;if(a.attribute!==s)return!0;if(a.data!==s.data)return!0;i++}return c.attributesNum!==i||c.index!==e}(g,v))&&function(t,e){var n={},r=g.attributes,i=0;for(var o in r){var a=r[o],s={};s.attribute=a,a.data&&(s.data=a.data),n[o]=s,i++}c.attributes=n,c.attributesNum=i,c.index=e}(0,v)}else{var w=!0===l.wireframe;c.geometry===g.id&&c.program===p.id&&c.wireframe===w||(c.geometry=g.id,c.program=p.id,c.wireframe=w,b=!0)}!0===i.isInstancedMesh&&(b=!0),null!==v&&n.update(v,34963),b&&(function(i,o,a,s){if(!1!==r.isWebGL2||!i.isInstancedMesh&&!s.isInstancedBufferGeometry||null!==e.get("ANGLE_instanced_arrays")){h();var l=s.attributes,c=a.getAttributes(),u=o.defaultAttributeValues;for(var p in c){var d=c[p];if(d>=0){var g=l[p];if(void 0!==g){var v=g.normalized,b=g.itemSize,x=n.get(g);if(void 0===x)continue;var w=x.buffer,E=x.type,T=x.bytesPerElement;if(g.isInterleavedBufferAttribute){var S=g.data,M=S.stride,j=g.offset;S&&S.isInstancedInterleavedBuffer?(m(d,S.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=S.meshPerAttribute*S.count)):f(d),t.bindBuffer(34962,w),_(d,b,E,v,M*T,j*T)}else g.isInstancedBufferAttribute?(m(d,g.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=g.meshPerAttribute*g.count)):f(d),t.bindBuffer(34962,w),_(d,b,E,v,0,0)}else if("instanceMatrix"===p){var C=n.get(i.instanceMatrix);if(void 0===C)continue;var z=C.buffer,R=C.type;m(d+0,1),m(d+1,1),m(d+2,1),m(d+3,1),t.bindBuffer(34962,z),t.vertexAttribPointer(d+0,4,R,!1,64,0),t.vertexAttribPointer(d+1,4,R,!1,64,16),t.vertexAttribPointer(d+2,4,R,!1,64,32),t.vertexAttribPointer(d+3,4,R,!1,64,48)}else if("instanceColor"===p){var A=n.get(i.instanceColor);if(void 0===A)continue;var L=A.buffer,I=A.type;m(d,1),t.bindBuffer(34962,L),t.vertexAttribPointer(d,3,I,!1,12,0)}else if(void 0!==u){var P=u[p];if(void 0!==P)switch(P.length){case 2:t.vertexAttrib2fv(d,P);break;case 3:t.vertexAttrib3fv(d,P);break;case 4:t.vertexAttrib4fv(d,P);break;default:t.vertexAttrib1fv(d,P)}}}}y()}}(i,l,p,g),null!==v&&t.bindBuffer(34963,n.get(v).buffer))},reset:g,resetDefaultState:v,dispose:function(){for(var t in g(),s){var e=s[t];for(var n in e){var r=e[n];for(var i in r)p(r[i].object),delete r[i];delete e[n]}delete s[t]}},releaseStatesOfGeometry:function(t){if(void 0!==s[t.id]){var e=s[t.id];for(var n in e){var r=e[n];for(var i in r)p(r[i].object),delete r[i];delete e[n]}delete s[t.id]}},releaseStatesOfProgram:function(t){for(var e in s){var n=s[e];if(void 0!==n[t.id]){var r=n[t.id];for(var i in r)p(r[i].object),delete r[i];delete n[t.id]}}},initAttributes:h,enableAttribute:f,disableUnusedAttributes:y}}(_t,Y,et,Q),nt=new function(t,e,n,r){var i={},o=new WeakMap;function a(t){var s=t.target;for(var l in null!==s.index&&e.remove(s.index),s.attributes)e.remove(s.attributes[l]);s.removeEventListener("dispose",a),delete i[s.id];var c=o.get(s);c&&(e.remove(c),o.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(t){var n=[],r=t.index,i=t.attributes.position,a=0;if(null!==r){var s=r.array;a=r.version;for(var l=0,c=s.length;l<c;l+=3){var u=s[l+0],p=s[l+1],d=s[l+2];n.push(u,p,p,d,d,u)}}else{var h=i.array;a=i.version;for(var f=0,m=h.length/3-1;f<m;f+=3){var y=f+0,_=f+1,g=f+2;n.push(y,_,_,g,g,y)}}var v=new(pn(n)>65535?sn:on)(n,1);v.version=a;var b=o.get(t);b&&e.remove(b),o.set(t,v)}return{get:function(t,e){return!0===i[e.id]||(e.addEventListener("dispose",a),i[e.id]=!0,n.memory.geometries++),e},update:function(t){var n=t.attributes;for(var r in n)e.update(n[r],34962);var i=t.morphAttributes;for(var o in i)for(var a=i[o],s=0,l=a.length;s<l;s++)e.update(a[s],34962)},getWireframeAttribute:function(t){var e=o.get(t);if(e){var n=t.index;null!==n&&e.version<n.version&&s(t)}else s(t);return o.get(t)}}}(_t,et,J,yt),rt=new function(t,e,n,r){var i=new WeakMap;function o(t){var e=t.target;e.removeEventListener("dispose",o),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(t){var a=r.render.frame,s=t.geometry,l=e.get(t,s);return i.get(l)!==a&&(e.update(l),i.set(l,a)),t.isInstancedMesh&&(!1===t.hasEventListener("dispose",o)&&t.addEventListener("dispose",o),n.update(t.instanceMatrix,34962),null!==t.instanceColor&&n.update(t.instanceColor,34962)),l},dispose:function(){i=new WeakMap}}}(_t,nt,et,J),ut=new function(t){for(var e={},n=new Float32Array(8),r=[],i=0;i<8;i++)r[i]=[i,0];return{update:function(i,o,a,s){var l=i.morphTargetInfluences,c=void 0===l?0:l.length,u=e[o.id];if(void 0===u){u=[];for(var p=0;p<c;p++)u[p]=[p,0];e[o.id]=u}for(var d=0;d<c;d++){var h=u[d];h[0]=d,h[1]=l[d]}u.sort(pr);for(var f=0;f<8;f++)f<c&&u[f][1]?(r[f][0]=u[f][0],r[f][1]=u[f][1]):(r[f][0]=Number.MAX_SAFE_INTEGER,r[f][1]=0);r.sort(ur);for(var m=a.morphTargets&&o.morphAttributes.position,y=a.morphNormals&&o.morphAttributes.normal,_=0,g=0;g<8;g++){var v=r[g],b=v[0],x=v[1];b!==Number.MAX_SAFE_INTEGER&&x?(m&&o.getAttribute("morphTarget"+g)!==m[b]&&o.setAttribute("morphTarget"+g,m[b]),y&&o.getAttribute("morphNormal"+g)!==y[b]&&o.setAttribute("morphNormal"+g,y[b]),n[g]=x,_+=x):(m&&!0===o.hasAttribute("morphTarget"+g)&&o.deleteAttribute("morphTarget"+g),y&&!0===o.hasAttribute("morphNormal"+g)&&o.deleteAttribute("morphNormal"+g),n[g]=0)}var w=o.morphTargetsRelative?1:1-_;s.getUniforms().setValue(t,"morphTargetBaseInfluence",w),s.getUniforms().setValue(t,"morphTargetInfluences",n)}}}(_t),lt=new lr(K),it=new ji(y,tt,Y,Q,yt,lt),ot=new function(t){function e(e,n){e.opacity.value=n.opacity,n.color&&e.diffuse.value.copy(n.color),n.emissive&&e.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(e.map.value=n.map),n.alphaMap&&(e.alphaMap.value=n.alphaMap),n.specularMap&&(e.specularMap.value=n.specularMap);var r,i,o=t.get(n).envMap;if(o){e.envMap.value=o,e.flipEnvMap.value=o.isCubeTexture&&o._needsFlipEnvMap?-1:1,e.reflectivity.value=n.reflectivity,e.refractionRatio.value=n.refractionRatio;var a=t.get(o).__maxMipLevel;void 0!==a&&(e.maxMipLevel.value=a)}n.lightMap&&(e.lightMap.value=n.lightMap,e.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(e.aoMap.value=n.aoMap,e.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap&&(r=n.clearcoatRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix)),n.aoMap?i=n.aoMap:n.lightMap&&(i=n.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uv2Transform.value.copy(i.matrix))}function n(e,n){e.roughness.value=n.roughness,e.metalness.value=n.metalness,n.roughnessMap&&(e.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(e.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(e.emissiveMap.value=n.emissiveMap),n.bumpMap&&(e.bumpMap.value=n.bumpMap,e.bumpScale.value=n.bumpScale,1===n.side&&(e.bumpScale.value*=-1)),n.normalMap&&(e.normalMap.value=n.normalMap,e.normalScale.value.copy(n.normalScale),1===n.side&&e.normalScale.value.negate()),n.displacementMap&&(e.displacementMap.value=n.displacementMap,e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias),t.get(n).envMap&&(e.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)},refreshMaterialUniforms:function(t,r,i,o){r.isMeshBasicMaterial?e(t,r):r.isMeshLambertMaterial?(e(t,r),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(t,r)):r.isMeshToonMaterial?(e(t,r),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshPhongMaterial?(e(t,r),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshStandardMaterial?(e(t,r),r.isMeshPhysicalMaterial?function(t,e){n(t,e),t.reflectivity.value=e.reflectivity,t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.sheen&&t.sheen.value.copy(e.sheen),e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap),e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,1===e.side&&t.clearcoatNormalScale.value.negate()),t.transmission.value=e.transmission,e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap)}(t,r):n(t,r)):r.isMeshMatcapMaterial?(e(t,r),function(t,e){e.matcap&&(t.matcap.value=e.matcap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshDepthMaterial?(e(t,r),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshDistanceMaterial?(e(t,r),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(t,r)):r.isMeshNormalMaterial?(e(t,r),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(t,r),r.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,r)):r.isPointsMaterial?function(t,e,n,r){var i;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*r,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.map?i=e.map:e.alphaMap&&(i=e.alphaMap),void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix))}(t,r,i,o):r.isSpriteMaterial?function(t,e){var n;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.map?n=e.map:e.alphaMap&&(n=e.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(t,r):r.isShadowMaterial?(t.color.value.copy(r.color),t.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}(K),at=new function(t){var e=new WeakMap;return{get:function(n,r){var i;return!1===e.has(n)?(i=new Ri(t),e.set(n,[i])):r>=e.get(n).length?(i=new Ri(t),e.get(n).push(i)):i=e.get(n)[r],i},dispose:function(){e=new WeakMap}}}(K),st=new function(t,e){var n=new WeakMap;return{get:function(r,i){var o;return void 0===i&&(i=0),!1===n.has(r)?(o=new Ii(t,e),n.set(r,[o])):i>=n.get(r).length?(o=new Ii(t,e),n.get(r).push(o)):o=n.get(r)[i],o},dispose:function(){n=new WeakMap}}}(Y,Q),ct=new sr(y,tt,Z,rt,l),pt=new function(t,e,n,r){var i,o=Q.isWebGL2;this.setMode=function(t){i=t},this.render=function(e,r){t.drawArrays(i,e,r),n.update(r,i,1)},this.renderInstances=function(r,a,s){if(0!==s){var l,c;if(o)l=t,c="drawArraysInstanced";else if(c="drawArraysInstancedANGLE",null===(l=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](i,r,a,s),n.update(a,i,s)}}}(_t,Y,J,0),dt=new function(t,e,n,r){var i,o,a,s=Q.isWebGL2;this.setMode=function(t){i=t},this.setIndex=function(t){o=t.type,a=t.bytesPerElement},this.render=function(e,r){t.drawElements(i,r,o,e*a),n.update(r,i,1)},this.renderInstances=function(r,l,c){if(0!==c){var u,p;if(s)u=t,p="drawElementsInstanced";else if(p="drawElementsInstancedANGLE",null===(u=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[p](i,l,o,r*a,c),n.update(l,i,c)}}}(_t,Y,J,0),J.programs=it.programs,y.capabilities=Q,y.extensions=Y,y.properties=K,y.renderLists=at,y.state=Z,y.info=J}xt();var Et=new Vi(y,_t);this.xr=Et;var Tt=new ki(y,rt,Q.maxTextureSize);function St(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),_=!0}function jt(){console.log("THREE.WebGLRenderer: Context Restored."),_=!1,xt()}function Ct(t){var e=t.target;e.removeEventListener("dispose",Ct),function(t){zt(t),K.remove(t)}(e)}function zt(t){var e=K.get(t).program;void 0!==e&&it.releaseProgram(e)}this.shadowMap=Tt,this.getContext=function(){return _t},this.getContextAttributes=function(){return _t.getContextAttributes()},this.forceContextLoss=function(){var t=Y.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=Y.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return P},this.setPixelRatio=function(t){void 0!==t&&(P=t,this.setSize(L,I,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new mt),t.set(L,I)},this.setSize=function(t,e,r){Et.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(L=t,I=e,n.width=Math.floor(t*P),n.height=Math.floor(e*P),!1!==r&&(n.style.width=t+"px",n.style.height=e+"px"),this.setViewport(0,0,t,e))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new mt),t.set(L*P,I*P).floor()},this.setDrawingBufferSize=function(t,e,r){L=t,I=e,P=r,n.width=Math.floor(t*r),n.height=Math.floor(e*r),this.setViewport(0,0,t,e)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new wt),t.copy(z)},this.getViewport=function(t){return t.copy(B)},this.setViewport=function(t,e,n,r){t.isVector4?B.set(t.x,t.y,t.z,t.w):B.set(t,e,n,r),Z.viewport(z.copy(B).multiplyScalar(P).floor())},this.getScissor=function(t){return t.copy(D)},this.setScissor=function(t,e,n,r){t.isVector4?D.set(t.x,t.y,t.z,t.w):D.set(t,e,n,r),Z.scissor(R.copy(D).multiplyScalar(P).floor())},this.getScissorTest=function(){return H},this.setScissorTest=function(t){Z.setScissorTest(H=t)},this.setOpaqueSort=function(t){O=t},this.setTransparentSort=function(t){k=t},this.getClearColor=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),t=new Qe),t.copy(ct.getClearColor())},this.setClearColor=function(){ct.setClearColor.apply(ct,arguments)},this.getClearAlpha=function(){return ct.getClearAlpha()},this.setClearAlpha=function(){ct.setClearAlpha.apply(ct,arguments)},this.clear=function(t,e,n){var r=0;(void 0===t||t)&&(r|=16384),(void 0===e||e)&&(r|=256),(void 0===n||n)&&(r|=1024),_t.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",St,!1),n.removeEventListener("webglcontextrestored",jt,!1),at.dispose(),st.dispose(),K.dispose(),tt.dispose(),rt.dispose(),yt.dispose(),Et.dispose(),At.stop()},this.renderBufferImmediate=function(t,e){yt.initAttributes();var n=K.get(t);t.hasPositions&&!n.position&&(n.position=_t.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=_t.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=_t.createBuffer()),t.hasColors&&!n.color&&(n.color=_t.createBuffer());var r=e.getAttributes();t.hasPositions&&(_t.bindBuffer(34962,n.position),_t.bufferData(34962,t.positionArray,35048),yt.enableAttribute(r.position),_t.vertexAttribPointer(r.position,3,5126,!1,0,0)),t.hasNormals&&(_t.bindBuffer(34962,n.normal),_t.bufferData(34962,t.normalArray,35048),yt.enableAttribute(r.normal),_t.vertexAttribPointer(r.normal,3,5126,!1,0,0)),t.hasUvs&&(_t.bindBuffer(34962,n.uv),_t.bufferData(34962,t.uvArray,35048),yt.enableAttribute(r.uv),_t.vertexAttribPointer(r.uv,2,5126,!1,0,0)),t.hasColors&&(_t.bindBuffer(34962,n.color),_t.bufferData(34962,t.colorArray,35048),yt.enableAttribute(r.color),_t.vertexAttribPointer(r.color,3,5126,!1,0,0)),yt.disableUnusedAttributes(),_t.drawArrays(4,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,r,i,o){null===e&&(e=W);var a=i.isMesh&&i.matrixWorld.determinant()<0,s=Ot(t,e,r,i);Z.setMaterial(r,a);var l=n.index,c=n.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;var u,p=1;!0===r.wireframe&&(l=nt.getWireframeAttribute(n),p=2),(r.morphTargets||r.morphNormals)&&ut.update(i,n,r,s),yt.setup(i,r,s,n,l);var d=pt;null!==l&&(u=et.get(l),(d=dt).setIndex(u));var h=null!==l?l.count:c.count,f=n.drawRange.start*p,m=n.drawRange.count*p,y=null!==o?o.start*p:0,_=null!==o?o.count*p:1/0,g=Math.max(f,y),v=Math.min(h,f+m,y+_)-1,b=Math.max(0,v-g+1);if(0!==b){if(i.isMesh)!0===r.wireframe?(Z.setLineWidth(r.wireframeLinewidth*q()),d.setMode(1)):d.setMode(4);else if(i.isLine){var x=r.linewidth;void 0===x&&(x=1),Z.setLineWidth(x*q()),i.isLineSegments?d.setMode(1):i.isLineLoop?d.setMode(2):d.setMode(3)}else i.isPoints?d.setMode(0):i.isSprite&&d.setMode(4);if(i.isInstancedMesh)d.renderInstances(g,b,i.count);else if(n.isInstancedBufferGeometry){var w=Math.min(n.instanceCount,n._maxInstanceCount);d.renderInstances(g,b,w)}else d.render(g,b)}},this.compile=function(t,e){(h=st.get(t)).init(),t.traverseVisible(function(t){t.isLight&&t.layers.test(e.layers)&&(h.pushLight(t),t.castShadow&&h.pushShadow(t))}),h.setupLights();var n=new WeakMap;t.traverse(function(e){var r=e.material;if(r)if(Array.isArray(r))for(var i=0;i<r.length;i++){var o=r[i];!1===n.has(o)&&(Pt(o,t,e),n.set(o))}else!1===n.has(r)&&(Pt(r,t,e),n.set(r))})};var Rt=null,At=new nr;function Lt(t,e,n){for(var r=!0===e.isScene?e.overrideMaterial:null,i=0,o=t.length;i<o;i++){var a=t[i],s=a.object,l=a.geometry,c=null===r?a.material:r,u=a.group;if(n.isArrayCamera)for(var p=n.cameras,d=0,f=p.length;d<f;d++){var m=p[d];s.layers.test(m.layers)&&(Z.viewport(z.copy(m.viewport)),h.setupLightsView(m),It(s,e,m,l,c,u))}else It(s,e,n,l,c,u)}}function It(t,e,n,r,i,o){if(t.onBeforeRender(y,e,n,r,i,o),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var a=Ot(n,e,i,t);Z.setMaterial(i),yt.reset(),function(t,e){t.render(function(t){y.renderBufferImmediate(t,e)})}(t,a)}else y.renderBufferDirect(n,e,r,i,t,o);t.onAfterRender(y,e,n,r,i,o)}function Pt(t,e,n){!0!==e.isScene&&(e=W);var r=K.get(t),i=h.state.lights,o=h.state.shadowsArray,a=i.state.version,s=it.getParameters(t,i.state,o,e,n),l=it.getProgramCacheKey(s),c=r.program,u=!0;if(r.environment=t.isMeshStandardMaterial?e.environment:null,r.fog=e.fog,r.envMap=tt.get(t.envMap||r.environment),void 0===c)t.addEventListener("dispose",Ct);else if(c.cacheKey!==l)zt(t);else if(r.lightsStateVersion!==a)u=!1;else{if(void 0!==s.shaderID)return;u=!1}u&&(s.uniforms=it.getUniforms(t),t.onBeforeCompile(s,y),c=it.acquireProgram(s,l),r.program=c,r.uniforms=s.uniforms,r.outputEncoding=s.outputEncoding);var p=r.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=lt.numPlanes,r.numIntersection=lt.numIntersection,p.clippingPlanes=lt.uniform),r.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),r.lightsStateVersion=a,r.needsLights&&(p.ambientLightColor.value=i.state.ambient,p.lightProbe.value=i.state.probe,p.directionalLights.value=i.state.directional,p.directionalLightShadows.value=i.state.directionalShadow,p.spotLights.value=i.state.spot,p.spotLightShadows.value=i.state.spotShadow,p.rectAreaLights.value=i.state.rectArea,p.ltc_1.value=i.state.rectAreaLTC1,p.ltc_2.value=i.state.rectAreaLTC2,p.pointLights.value=i.state.point,p.pointLightShadows.value=i.state.pointShadow,p.hemisphereLights.value=i.state.hemi,p.directionalShadowMap.value=i.state.directionalShadowMap,p.directionalShadowMatrix.value=i.state.directionalShadowMatrix,p.spotShadowMap.value=i.state.spotShadowMap,p.spotShadowMatrix.value=i.state.spotShadowMatrix,p.pointShadowMap.value=i.state.pointShadowMap,p.pointShadowMatrix.value=i.state.pointShadowMatrix);var d=r.program.getUniforms(),f=li.seqWithValue(d.seq,p);r.uniformsList=f}function Ot(t,e,n,r){!0!==e.isScene&&(e=W),$.resetTextureUnits();var i=e.fog,o=n.isMeshStandardMaterial?e.environment:null,a=null===T?y.outputEncoding:T.texture.encoding,s=tt.get(n.envMap||o),l=K.get(n),c=h.state.lights;if(!0===N&&(!0===U||t!==C)){var u=t===C&&n.id===j;lt.setState(n,t,u)}n.version===l.__version?n.fog&&l.fog!==i||l.environment!==o||l.needsLights&&l.lightsStateVersion!==c.state.version?Pt(n,e,r):void 0===l.numClippingPlanes||l.numClippingPlanes===lt.numPlanes&&l.numIntersection===lt.numIntersection?(l.outputEncoding!==a||l.envMap!==s)&&Pt(n,e,r):Pt(n,e,r):(Pt(n,e,r),l.__version=n.version);var p,d,f=!1,m=!1,_=!1,g=l.program,v=g.getUniforms(),b=l.uniforms;if(Z.useProgram(g.program)&&(f=!0,m=!0,_=!0),n.id!==j&&(j=n.id,m=!0),f||C!==t){if(v.setValue(_t,"projectionMatrix",t.projectionMatrix),Q.logarithmicDepthBuffer&&v.setValue(_t,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),C!==t&&(C=t,m=!0,_=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var x=v.map.cameraPosition;void 0!==x&&x.setValue(_t,G.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&v.setValue(_t,"isOrthographic",!0===t.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||n.skinning)&&v.setValue(_t,"viewMatrix",t.matrixWorldInverse)}if(n.skinning){v.setOptional(_t,r,"bindMatrix"),v.setOptional(_t,r,"bindMatrixInverse");var E=r.skeleton;if(E){var S=E.bones;if(Q.floatVertexTextures){if(null===E.boneTexture){var z=Math.sqrt(4*S.length);z=ft.ceilPowerOfTwo(z),z=Math.max(z,4);var R=new Float32Array(z*z*4);R.set(E.boneMatrices);var A=new Kn(R,z,z,M,w);E.boneMatrices=R,E.boneTexture=A,E.boneTextureSize=z}v.setValue(_t,"boneTexture",E.boneTexture,$),v.setValue(_t,"boneTextureSize",E.boneTextureSize)}else v.setOptional(_t,E,"boneMatrices")}}return(m||l.receiveShadow!==r.receiveShadow)&&(l.receiveShadow=r.receiveShadow,v.setValue(_t,"receiveShadow",r.receiveShadow)),m&&(v.setValue(_t,"toneMappingExposure",y.toneMappingExposure),l.needsLights&&(d=_,(p=b).ambientLightColor.needsUpdate=d,p.lightProbe.needsUpdate=d,p.directionalLights.needsUpdate=d,p.directionalLightShadows.needsUpdate=d,p.pointLights.needsUpdate=d,p.pointLightShadows.needsUpdate=d,p.spotLights.needsUpdate=d,p.spotLightShadows.needsUpdate=d,p.rectAreaLights.needsUpdate=d,p.hemisphereLights.needsUpdate=d),i&&n.fog&&ot.refreshFogUniforms(b,i),ot.refreshMaterialUniforms(b,n,P,I),li.upload(_t,l.uniformsList,b,$)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(li.upload(_t,l.uniformsList,b,$),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&v.setValue(_t,"center",r.center),v.setValue(_t,"modelViewMatrix",r.modelViewMatrix),v.setValue(_t,"normalMatrix",r.normalMatrix),v.setValue(_t,"modelMatrix",r.matrixWorld),g}At.setAnimationLoop(function(t){Et.isPresenting||Rt&&Rt(t)}),"undefined"!=typeof window&&At.setContext(window),this.setAnimationLoop=function(t){Rt=t,Et.setAnimationLoop(t),null===t?At.stop():At.start()},this.render=function(t,e){var n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),void 0===e||!0===e.isCamera){if(!0!==_){yt.resetDefaultState(),j=-1,C=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),!0===Et.enabled&&!0===Et.isPresenting&&(e=Et.getCamera(e)),!0===t.isScene&&t.onBeforeRender(y,t,e,n||T),(h=st.get(t,m.length)).init(),m.push(h),V.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),F.setFromProjectionMatrix(V),U=this.localClippingEnabled,N=lt.init(this.clippingPlanes,U,e),(d=at.get(t,f.length)).init(),f.push(d),function t(e,n,r,i){if(!1!==e.visible){if(e.layers.test(n.layers))if(e.isGroup)r=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(n);else if(e.isLight)h.pushLight(e),e.castShadow&&h.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||F.intersectsSprite(e)){i&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(V);var o=rt.update(e),a=e.material;a.visible&&d.push(e,o,a,r,G.z,null)}}else if(e.isImmediateRenderObject)i&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(V),d.push(e,null,e.material,r,G.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==J.render.frame&&(e.skeleton.update(),e.skeleton.frame=J.render.frame),!e.frustumCulled||F.intersectsObject(e))){i&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(V);var s=rt.update(e),l=e.material;if(Array.isArray(l))for(var c=s.groups,u=0,p=c.length;u<p;u++){var f=c[u],m=l[f.materialIndex];m&&m.visible&&d.push(e,s,m,r,G.z,f)}else l.visible&&d.push(e,s,l,r,G.z,null)}for(var y=e.children,_=0,g=y.length;_<g;_++)t(y[_],n,r,i)}}(t,e,0,y.sortObjects),d.finish(),!0===y.sortObjects&&d.sort(O,k),!0===N&&lt.beginShadows();var i=h.state.shadowsArray;Tt.render(i,t,e),h.setupLights(),h.setupLightsView(e),!0===N&&lt.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),ct.render(d,t,e,r);var o=d.opaque,a=d.transparent;o.length>0&&Lt(o,t,e),a.length>0&&Lt(a,t,e),!0===t.isScene&&t.onAfterRender(y,t,e),null!==T&&($.updateRenderTargetMipmap(T),$.updateMultisampleRenderTarget(T)),Z.buffers.depth.setTest(!0),Z.buffers.depth.setMask(!0),Z.buffers.color.setMask(!0),Z.setPolygonOffset(!1),m.pop(),h=m.length>0?m[m.length-1]:null,f.pop(),d=f.length>0?f[f.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(t){g!==t&&null===T&&_t.bindFramebuffer(36160,t),g=t},this.getActiveCubeFace=function(){return b},this.getActiveMipmapLevel=function(){return x},this.getRenderTarget=function(){return T},this.setRenderTarget=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0),T=t,b=e,x=n,t&&void 0===K.get(t).__webglFramebuffer&&$.setupRenderTarget(t);var r=g,i=!1,o=!1;if(t){var a=t.texture;(a.isDataTexture3D||a.isDataTexture2DArray)&&(o=!0);var s=K.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=s[e],i=!0):r=t.isWebGLMultisampleRenderTarget?K.get(t).__webglMultisampledFramebuffer:s,z.copy(t.viewport),R.copy(t.scissor),A=t.scissorTest}else z.copy(B).multiplyScalar(P).floor(),R.copy(D).multiplyScalar(P).floor(),A=H;if(S!==r&&(_t.bindFramebuffer(36160,r),S=r),Z.viewport(z),Z.scissor(R),Z.setScissorTest(A),i){var l=K.get(t.texture);_t.framebufferTexture2D(36160,36064,34069+e,l.__webglTexture,n)}else if(o){var c=K.get(t.texture),u=e||0;_t.framebufferTextureLayer(36160,36064,c.__webglTexture,n||0,u)}},this.readRenderTargetPixels=function(t,e,n,r,i,o,a){if(t&&t.isWebGLRenderTarget){var s=K.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){var l=!1;s!==S&&(_t.bindFramebuffer(36160,s),l=!0);try{var c=t.texture,u=c.format,p=c.type;if(u!==M&&ht.convert(u)!==_t.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");var d=p===E&&(Y.has("EXT_color_buffer_half_float")||Q.isWebGL2&&Y.has("EXT_color_buffer_float"));if(!(p===v||ht.convert(p)===_t.getParameter(35738)||p===w&&(Q.isWebGL2||Y.has("OES_texture_float")||Y.has("WEBGL_color_buffer_float"))||d))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===_t.checkFramebufferStatus(36160)?e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&_t.readPixels(e,n,r,i,ht.convert(u),ht.convert(p),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{l&&_t.bindFramebuffer(36160,S)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,n){void 0===n&&(n=0);var r=Math.pow(2,-n),i=Math.floor(e.image.width*r),o=Math.floor(e.image.height*r),a=ht.convert(e.format);$.setTexture2D(e,0),_t.copyTexImage2D(3553,n,a,t.x,t.y,i,o,0),Z.unbindTexture()},this.copyTextureToTexture=function(t,e,n,r){void 0===r&&(r=0);var i=e.image.width,o=e.image.height,a=ht.convert(n.format),s=ht.convert(n.type);$.setTexture2D(n,0),_t.pixelStorei(37440,n.flipY),_t.pixelStorei(37441,n.premultiplyAlpha),_t.pixelStorei(3317,n.unpackAlignment),e.isDataTexture?_t.texSubImage2D(3553,r,t.x,t.y,i,o,a,s,e.image.data):e.isCompressedTexture?_t.compressedTexSubImage2D(3553,r,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,a,e.mipmaps[0].data):_t.texSubImage2D(3553,r,t.x,t.y,a,s,e.image),0===r&&n.generateMipmaps&&_t.generateMipmap(3553),Z.unbindTexture()},this.copyTextureToTexture3D=function(t,e,n,r,i){if(void 0===i&&(i=0),y.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var o,a=n.image,s=a.width,l=a.height,c=a.data,u=ht.convert(r.format),p=ht.convert(r.type);if(r.isDataTexture3D)$.setTexture3D(r,0),o=32879;else{if(!r.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");$.setTexture2DArray(r,0),o=35866}_t.pixelStorei(37440,r.flipY),_t.pixelStorei(37441,r.premultiplyAlpha),_t.pixelStorei(3317,r.unpackAlignment);var d=_t.getParameter(3314),h=_t.getParameter(32878),f=_t.getParameter(3316),m=_t.getParameter(3315),_=_t.getParameter(32877);_t.pixelStorei(3314,s),_t.pixelStorei(32878,l),_t.pixelStorei(3316,t.min.x),_t.pixelStorei(3315,t.min.y),_t.pixelStorei(32877,t.min.z),_t.texSubImage3D(o,i,e.x,e.y,e.z,t.max.x-t.min.x+1,t.max.y-t.min.y+1,t.max.z-t.min.z+1,u,p,c),_t.pixelStorei(3314,d),_t.pixelStorei(32878,h),_t.pixelStorei(3316,f),_t.pixelStorei(3315,m),_t.pixelStorei(32877,_),0===i&&r.generateMipmaps&&_t.generateMipmap(o),Z.unbindTexture()}},this.initTexture=function(t){$.setTexture2D(t,0),Z.unbindTexture()},this.resetState=function(){Z.reset(),yt.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Ni.prototype.isGroup=!0,Object.assign(Ui.prototype,{constructor:Ui,getHandSpace:function(){return null===this._hand&&(this._hand=new Ni,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Ni,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Ni,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(t,e,n){var r=null,i=null,o=null,a=this._targetRay,s=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState)if(l&&t.hand){o=!0;for(var c,u=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ct(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ct(t,e):void 0}}(t))){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=t[Symbol.iterator]()).next.bind(n)}(t.hand.values());!(c=u()).done;){var p=c.value,d=e.getJointPose(p,n);if(void 0===l.joints[p.jointName]){var h=new Ni;h.matrixAutoUpdate=!1,h.visible=!1,l.joints[p.jointName]=h,l.add(h)}var f=l.joints[p.jointName];null!==d&&(f.matrix.fromArray(d.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.jointRadius=d.radius),f.visible=null!==d}var m=l.joints["index-finger-tip"],y=l.joints["thumb-tip"],_=m.position.distanceTo(y.position);l.inputState.pinching&&_>.025?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&_<=.015&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==a&&null!==(r=e.getPose(t.targetRaySpace,n))&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale)),null!==s&&t.gripSpace&&null!==(i=e.getPose(t.gripSpace,n))&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale));return null!==a&&(a.visible=null!==r),null!==s&&(s.visible=null!==i),null!==l&&(l.visible=null!==o),this}}),Object.assign(Vi.prototype,ut.prototype);var Wi=function(t){function e(){return t.apply(this,arguments)||this}return st(e,t),e}(Gi);Wi.prototype.isWebGL1Renderer=!0;var qi=function(){function t(t,e){this.name="",this.color=new Qe(t),this.density=void 0!==e?e:25e-5}var e=t.prototype;return e.clone=function(){return new t(this.color,this.density)},e.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},t}();qi.prototype.isFogExp2=!0;var Xi=function(){function t(t,e,n){this.name="",this.color=new Qe(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}var e=t.prototype;return e.clone=function(){return new t(this.color,this.near,this.far)},e.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},t}();Xi.prototype.isFog=!0;var Yi=function(t){function e(){var e;return(e=t.call(this)||this).type="Scene",e.background=null,e.environment=null,e.fog=null,e.overrideMaterial=null,e.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:lt(e)})),e}st(e,t);var n=e.prototype;return n.copy=function(e,n){return t.prototype.copy.call(this,e,n),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},n.toJSON=function(e){var n=t.prototype.toJSON.call(this,e);return null!==this.background&&(n.object.background=this.background.toJSON(e)),null!==this.environment&&(n.object.environment=this.environment.toJSON(e)),null!==this.fog&&(n.object.fog=this.fog.toJSON()),n},e}(Se);function Qi(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=et,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ft.generateUUID()}Yi.prototype.isScene=!0,Object.defineProperty(Qi.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Qi.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ft.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var e=new Qi(new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),this.stride);return e.setUsage(this.usage),e},onUpload:function(t){return this.onUploadCallback=t,this},toJSON:function(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ft.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});var Zi=new Mt;function Ji(t,e,n,r){this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}Object.defineProperties(Ji.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(t){this.data.needsUpdate=t}}}),Object.assign(Ji.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var e=0,n=this.data.count;e<n;e++)Zi.x=this.getX(e),Zi.y=this.getY(e),Zi.z=this.getZ(e),Zi.applyMatrix4(t),this.setXYZ(e,Zi.x,Zi.y,Zi.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this},clone:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var e=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,i=0;i<this.itemSize;i++)e.push(this.data.array[r+i]);return new $e(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new Ji(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var e=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,i=0;i<this.itemSize;i++)e.push(this.data.array[r+i]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});var Ki,$i=function(t){function e(e){var n;return(n=t.call(this)||this).type="SpriteMaterial",n.color=new Qe(16777215),n.map=null,n.alphaMap=null,n.rotation=0,n.sizeAttenuation=!0,n.transparent=!0,n.setValues(e),n}return st(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this},e}(Ue);$i.prototype.isSpriteMaterial=!0;var to=new Mt,eo=new Mt,no=new Mt,ro=new mt,io=new mt,oo=new te,ao=new Mt,so=new Mt,lo=new Mt,co=new mt,uo=new mt,po=new mt,ho=function(t){function e(e){var n;if((n=t.call(this)||this).type="Sprite",void 0===Ki){Ki=new xn;var r=new Qi(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Ki.setIndex([0,1,2,0,2,3]),Ki.setAttribute("position",new Ji(r,3,0,!1)),Ki.setAttribute("uv",new Ji(r,2,3,!1))}return n.geometry=Ki,n.material=void 0!==e?e:new $i,n.center=new mt(.5,.5),n}st(e,t);var n=e.prototype;return n.raycast=function(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),eo.setFromMatrixScale(this.matrixWorld),oo.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),no.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&eo.multiplyScalar(-no.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var o=this.center;fo(ao.set(-.5,-.5,0),no,o,eo,n,r),fo(so.set(.5,-.5,0),no,o,eo,n,r),fo(lo.set(.5,.5,0),no,o,eo,n,r),co.set(0,0),uo.set(1,0),po.set(1,1);var a=t.ray.intersectTriangle(ao,so,lo,!1,to);if(null!==a||(fo(so.set(-.5,.5,0),no,o,eo,n,r),uo.set(0,1),null!==(a=t.ray.intersectTriangle(ao,lo,so,!1,to)))){var s=t.ray.origin.distanceTo(to);s<t.near||s>t.far||e.push({distance:s,point:to.clone(),uv:Fe.getUV(to,ao,so,lo,co,uo,po,new mt),face:null,object:this})}},n.copy=function(e){return t.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this},e}(Se);function fo(t,e,n,r,i,o){ro.subVectors(t,n).addScalar(.5).multiply(r),void 0!==i?(io.x=o*ro.x-i*ro.y,io.y=i*ro.x+o*ro.y):io.copy(ro),t.copy(e),t.x+=io.x,t.y+=io.y,t.applyMatrix4(oo)}ho.prototype.isSprite=!0;var mo=new Mt,yo=new Mt,_o=function(t){function e(){var e;return(e=t.call(this)||this)._currentLevel=0,e.type="LOD",Object.defineProperties(lt(e),{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),e.autoUpdate=!0,e}st(e,t);var n=e.prototype;return n.copy=function(e){t.prototype.copy.call(this,e,!1);for(var n=e.levels,r=0,i=n.length;r<i;r++){var o=n[r];this.addLevel(o.object.clone(),o.distance)}return this.autoUpdate=e.autoUpdate,this},n.addLevel=function(t,e){void 0===e&&(e=0),e=Math.abs(e);var n,r=this.levels;for(n=0;n<r.length&&!(e<r[n].distance);n++);return r.splice(n,0,{distance:e,object:t}),this.add(t),this},n.getCurrentLevel=function(){return this._currentLevel},n.getObjectForDistance=function(t){var e=this.levels;if(e.length>0){var n,r;for(n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object}return null},n.raycast=function(t,e){if(this.levels.length>0){mo.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(mo);this.getObjectForDistance(n).raycast(t,e)}},n.update=function(t){var e=this.levels;if(e.length>1){mo.setFromMatrixPosition(t.matrixWorld),yo.setFromMatrixPosition(this.matrixWorld);var n,r,i=mo.distanceTo(yo)/t.zoom;for(e[0].object.visible=!0,n=1,r=e.length;n<r&&i>=e[n].distance;n++)e[n-1].object.visible=!1,e[n].object.visible=!0;for(this._currentLevel=n-1;n<r;n++)e[n].object.visible=!1}},n.toJSON=function(e){var n=t.prototype.toJSON.call(this,e);!1===this.autoUpdate&&(n.object.autoUpdate=!1),n.object.levels=[];for(var r=this.levels,i=0,o=r.length;i<o;i++){var a=r[i];n.object.levels.push({object:a.object.uuid,distance:a.distance})}return n},e}(Se),go=new Mt,vo=new wt,bo=new wt,xo=new Mt,wo=new te;function Eo(t,e){Hn.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new te,this.bindMatrixInverse=new te}function To(){Se.call(this),this.type="Bone"}Eo.prototype=Object.assign(Object.create(Hn.prototype),{constructor:Eo,isSkinnedMesh:!0,copy:function(t){return Hn.prototype.copy.call(this,t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new wt,e=this.geometry.attributes.skinWeight,n=0,r=e.count;n<r;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);var i=1/t.manhattanLength();i!==1/0?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){Hn.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(t,e){var n=this.skeleton,r=this.geometry;vo.fromBufferAttribute(r.attributes.skinIndex,t),bo.fromBufferAttribute(r.attributes.skinWeight,t),go.fromBufferAttribute(r.attributes.position,t).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(var i=0;i<4;i++){var o=bo.getComponent(i);if(0!==o){var a=vo.getComponent(i);wo.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),e.addScaledVector(xo.copy(go).applyMatrix4(wo),o)}}return e.applyMatrix4(this.bindMatrixInverse)}}),To.prototype=Object.assign(Object.create(Se.prototype),{constructor:To,isBone:!0});var So=new te,Mo=new te,jo=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e=[]),this.uuid=ft.generateUUID(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}var e=t.prototype;return e.init=function(){var t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new te)}},e.calculateInverses=function(){this.boneInverses.length=0;for(var t=0,e=this.bones.length;t<e;t++){var n=new te;this.bones[t]&&n.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(n)}},e.pose=function(){for(var t=0,e=this.bones.length;t<e;t++){var n=this.bones[t];n&&n.matrixWorld.copy(this.boneInverses[t]).invert()}for(var r=0,i=this.bones.length;r<i;r++){var o=this.bones[r];o&&(o.parent&&o.parent.isBone?(o.matrix.copy(o.parent.matrixWorld).invert(),o.matrix.multiply(o.matrixWorld)):o.matrix.copy(o.matrixWorld),o.matrix.decompose(o.position,o.quaternion,o.scale))}},e.update=function(){for(var t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,o=t.length;i<o;i++){var a=t[i]?t[i].matrixWorld:Mo;So.multiplyMatrices(a,e[i]),So.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)},e.clone=function(){return new t(this.bones,this.boneInverses)},e.getBoneByName=function(t){for(var e=0,n=this.bones.length;e<n;e++){var r=this.bones[e];if(r.name===t)return r}},e.dispose=function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)},e.fromJSON=function(t,e){this.uuid=t.uuid;for(var n=0,r=t.bones.length;n<r;n++){var i=t.bones[n],o=e[i];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),o=new To),this.bones.push(o),this.boneInverses.push((new te).fromArray(t.boneInverses[n]))}return this.init(),this},e.toJSON=function(){var t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;for(var e=this.bones,n=this.boneInverses,r=0,i=e.length;r<i;r++){var o=e[r];t.bones.push(o.uuid);var a=n[r];t.boneInverses.push(a.toArray())}return t},t}(),Co=new te,zo=new te,Ro=[],Ao=new Hn;function Lo(t,e,n){Hn.call(this,t,e),this.instanceMatrix=new $e(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}Lo.prototype=Object.assign(Object.create(Hn.prototype),{constructor:Lo,isInstancedMesh:!0,copy:function(t){return Hn.prototype.copy.call(this,t),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this},getColorAt:function(t,e){e.fromArray(this.instanceColor.array,3*t)},getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,e){var n=this.matrixWorld,r=this.count;if(Ao.geometry=this.geometry,Ao.material=this.material,void 0!==Ao.material)for(var i=0;i<r;i++){this.getMatrixAt(i,Co),zo.multiplyMatrices(n,Co),Ao.matrixWorld=zo,Ao.raycast(t,Ro);for(var o=0,a=Ro.length;o<a;o++){var s=Ro[o];s.instanceId=i,s.object=this,e.push(s)}Ro.length=0}},setColorAt:function(t,e){null===this.instanceColor&&(this.instanceColor=new $e(new Float32Array(3*this.count),3)),e.toArray(this.instanceColor.array,3*t)},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Io=function(t){function e(e){var n;return(n=t.call(this)||this).type="LineBasicMaterial",n.color=new Qe(16777215),n.linewidth=1,n.linecap="round",n.linejoin="round",n.morphTargets=!1,n.setValues(e),n}return st(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this},e}(Ue);Io.prototype.isLineBasicMaterial=!0;var Po=new Mt,Oo=new Mt,ko=new te,Bo=new $t,Do=new Wt;function Ho(t,e){void 0===t&&(t=new xn),void 0===e&&(e=new Io),Se.call(this),this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}Ho.prototype=Object.assign(Object.create(Se.prototype),{constructor:Ho,isLine:!0,copy:function(t){return Se.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,n=[0],r=1,i=e.count;r<i;r++)Po.fromBufferAttribute(e,r-1),Oo.fromBufferAttribute(e,r),n[r]=n[r-1],n[r]+=Po.distanceTo(Oo);t.setAttribute("lineDistance",new cn(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(t,e){var n=this.geometry,r=this.matrixWorld,i=t.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Do.copy(n.boundingSphere),Do.applyMatrix4(r),Do.radius+=i,!1!==t.ray.intersectsSphere(Do)){ko.copy(r).invert(),Bo.copy(t.ray).applyMatrix4(ko);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,s=new Mt,l=new Mt,c=new Mt,u=new Mt,p=this.isLineSegments?2:1;if(n.isBufferGeometry){var d=n.index,h=n.attributes.position;if(null!==d)for(var f=d.array,m=0,y=f.length-1;m<y;m+=p){var _=f[m],g=f[m+1];if(s.fromBufferAttribute(h,_),l.fromBufferAttribute(h,g),!(Bo.distanceSqToSegment(s,l,u,c)>a)){u.applyMatrix4(this.matrixWorld);var v=t.ray.origin.distanceTo(u);v<t.near||v>t.far||e.push({distance:v,point:c.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else for(var b=0,x=h.count-1;b<x;b+=p)if(s.fromBufferAttribute(h,b),l.fromBufferAttribute(h,b+1),!(Bo.distanceSqToSegment(s,l,u,c)>a)){u.applyMatrix4(this.matrixWorld);var w=t.ray.origin.distanceTo(u);w<t.near||w>t.far||e.push({distance:w,point:c.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){var e=t.morphAttributes,n=Object.keys(e);if(n.length>0){var r=e[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,o=r.length;i<o;i++){var a=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}else{var s=t.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var Fo=new Mt,No=new Mt;function Uo(t,e){Ho.call(this,t,e),this.type="LineSegments"}Uo.prototype=Object.assign(Object.create(Ho.prototype),{constructor:Uo,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,n=[],r=0,i=e.count;r<i;r+=2)Fo.fromBufferAttribute(e,r),No.fromBufferAttribute(e,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Fo.distanceTo(No);t.setAttribute("lineDistance",new cn(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}});var Vo=function(t){function e(e,n){var r;return(r=t.call(this,e,n)||this).type="LineLoop",r}return st(e,t),e}(Ho);Vo.prototype.isLineLoop=!0;var Go=function(t){function e(e){var n;return(n=t.call(this)||this).type="PointsMaterial",n.color=new Qe(16777215),n.map=null,n.alphaMap=null,n.size=1,n.sizeAttenuation=!0,n.morphTargets=!1,n.setValues(e),n}return st(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this},e}(Ue);Go.prototype.isPointsMaterial=!0;var Wo=new te,qo=new $t,Xo=new Wt,Yo=new Mt;function Qo(t,e){void 0===t&&(t=new xn),void 0===e&&(e=new Go),Se.call(this),this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}function Zo(t,e,n,r,i,o,a){var s=qo.distanceSqToPoint(t);if(s<n){var l=new Mt;qo.closestPointToPoint(t,l),l.applyMatrix4(r);var c=i.ray.origin.distanceTo(l);if(c<i.near||c>i.far)return;o.push({distance:c,distanceToRay:Math.sqrt(s),point:l,index:e,face:null,object:a})}}Qo.prototype=Object.assign(Object.create(Se.prototype),{constructor:Qo,isPoints:!0,copy:function(t){return Se.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},raycast:function(t,e){var n=this.geometry,r=this.matrixWorld,i=t.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Xo.copy(n.boundingSphere),Xo.applyMatrix4(r),Xo.radius+=i,!1!==t.ray.intersectsSphere(Xo)){Wo.copy(r).invert(),qo.copy(t.ray).applyMatrix4(Wo);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o;if(n.isBufferGeometry){var s=n.index,l=n.attributes.position;if(null!==s)for(var c=s.array,u=0,p=c.length;u<p;u++){var d=c[u];Yo.fromBufferAttribute(l,d),Zo(Yo,d,a,r,t,e,this)}else for(var h=0,f=l.count;h<f;h++)Yo.fromBufferAttribute(l,h),Zo(Yo,h,a,r,t,e,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){var e=t.morphAttributes,n=Object.keys(e);if(n.length>0){var r=e[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,o=r.length;i<o;i++){var a=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}else{var s=t.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var Jo=function(t){function e(e,n,r,i,o,a,s,l,c){var u;(u=t.call(this,e,n,r,i,o,a,s,l,c)||this).format=void 0!==s?s:S,u.minFilter=void 0!==a?a:_,u.magFilter=void 0!==o?o:_,u.generateMipmaps=!1;var p=lt(u);return"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function t(){p.needsUpdate=!0,e.requestVideoFrameCallback(t)}),u}st(e,t);var n=e.prototype;return n.clone=function(){return new this.constructor(this.image).copy(this)},n.update=function(){var t=this.image;0=="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)},e}(bt);Jo.prototype.isVideoTexture=!0;var Ko=function(t){function e(e,n,r,i,o,a,s,l,c,u,p,d){var h;return(h=t.call(this,null,a,s,l,c,u,i,o,p,d)||this).image={width:n,height:r},h.mipmaps=e,h.flipY=!1,h.generateMipmaps=!1,h}return st(e,t),e}(bt);Ko.prototype.isCompressedTexture=!0;var $o=function(t){function e(e,n,r,i,o,a,s,l,c){var u;return(u=t.call(this,e,n,r,i,o,a,s,l,c)||this).needsUpdate=!0,u}return st(e,t),e}(bt);$o.prototype.isCanvasTexture=!0;var ta=function(t){function e(e,n,r,i,o,a,s,l,c,u){var p;if((u=void 0!==u?u:j)!==j&&u!==C)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");return void 0===r&&u===j&&(r=b),void 0===r&&u===C&&(r=T),(p=t.call(this,null,i,o,a,s,l,u,r,c)||this).image={width:e,height:n},p.magFilter=void 0!==s?s:f,p.minFilter=void 0!==l?l:f,p.flipY=!1,p.generateMipmaps=!1,p}return st(e,t),e}(bt);ta.prototype.isDepthTexture=!0;var ea=function(t){function e(e,n,r,i){var o;void 0===e&&(e=1),void 0===n&&(n=8),void 0===r&&(r=0),void 0===i&&(i=2*Math.PI),(o=t.call(this)||this).type="CircleGeometry",o.parameters={radius:e,segments:n,thetaStart:r,thetaLength:i},n=Math.max(3,n);var a=[],s=[],l=[],c=[],u=new Mt,p=new mt;s.push(0,0,0),l.push(0,0,1),c.push(.5,.5);for(var d=0,h=3;d<=n;d++,h+=3){var f=r+d/n*i;u.x=e*Math.cos(f),u.y=e*Math.sin(f),s.push(u.x,u.y,u.z),l.push(0,0,1),p.x=(s[h]/e+1)/2,p.y=(s[h+1]/e+1)/2,c.push(p.x,p.y)}for(var m=1;m<=n;m++)a.push(m,m+1,0);return o.setIndex(a),o.setAttribute("position",new cn(s,3)),o.setAttribute("normal",new cn(l,3)),o.setAttribute("uv",new cn(c,2)),o}return st(e,t),e}(xn),na=function(t){function e(e,n,r,i,o,a,s,l){var c;void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=8),void 0===o&&(o=1),void 0===a&&(a=!1),void 0===s&&(s=0),void 0===l&&(l=2*Math.PI),(c=t.call(this)||this).type="CylinderGeometry",c.parameters={radiusTop:e,radiusBottom:n,height:r,radialSegments:i,heightSegments:o,openEnded:a,thetaStart:s,thetaLength:l};var u=lt(c);i=Math.floor(i),o=Math.floor(o);var p=[],d=[],h=[],f=[],m=0,y=[],_=r/2,g=0;function v(t){for(var r=m,o=new mt,a=new Mt,c=0,y=!0===t?e:n,v=!0===t?1:-1,b=1;b<=i;b++)d.push(0,_*v,0),h.push(0,v,0),f.push(.5,.5),m++;for(var x=m,w=0;w<=i;w++){var E=w/i*l+s,T=Math.cos(E),S=Math.sin(E);a.x=y*S,a.y=_*v,a.z=y*T,d.push(a.x,a.y,a.z),h.push(0,v,0),o.x=.5*T+.5,o.y=.5*S*v+.5,f.push(o.x,o.y),m++}for(var M=0;M<i;M++){var j=r+M,C=x+M;!0===t?p.push(C,C+1,j):p.push(C+1,C,j),c+=3}u.addGroup(g,c,!0===t?1:2),g+=c}return function(){for(var t=new Mt,a=new Mt,c=0,v=(n-e)/r,b=0;b<=o;b++){for(var x=[],w=b/o,E=w*(n-e)+e,T=0;T<=i;T++){var S=T/i,M=S*l+s,j=Math.sin(M),C=Math.cos(M);a.x=E*j,a.y=-w*r+_,a.z=E*C,d.push(a.x,a.y,a.z),t.set(j,v,C).normalize(),h.push(t.x,t.y,t.z),f.push(S,1-w),x.push(m++)}y.push(x)}for(var z=0;z<i;z++)for(var R=0;R<o;R++){var A=y[R][z],L=y[R+1][z],I=y[R+1][z+1],P=y[R][z+1];p.push(A,L,P),p.push(L,I,P),c+=6}u.addGroup(g,c,0),g+=c}(),!1===a&&(e>0&&v(!0),n>0&&v(!1)),c.setIndex(p),c.setAttribute("position",new cn(d,3)),c.setAttribute("normal",new cn(h,3)),c.setAttribute("uv",new cn(f,2)),c}return st(e,t),e}(xn),ra=function(t){function e(e,n,r,i,o,a,s){var l;return void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=8),void 0===i&&(i=1),void 0===o&&(o=!1),void 0===a&&(a=0),void 0===s&&(s=2*Math.PI),(l=t.call(this,0,e,n,r,i,o,a,s)||this).type="ConeGeometry",l.parameters={radius:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},l}return st(e,t),e}(na),ia=function(t){function e(e,n,r,i){var o;void 0===r&&(r=1),void 0===i&&(i=0),(o=t.call(this)||this).type="PolyhedronGeometry",o.parameters={vertices:e,indices:n,radius:r,detail:i};var a=[],s=[];function l(t,e,n,r){for(var i=r+1,o=[],a=0;a<=i;a++){o[a]=[];for(var s=t.clone().lerp(n,a/i),l=e.clone().lerp(n,a/i),u=i-a,p=0;p<=u;p++)o[a][p]=0===p&&a===i?s:s.clone().lerp(l,p/u)}for(var d=0;d<i;d++)for(var h=0;h<2*(i-d)-1;h++){var f=Math.floor(h/2);h%2==0?(c(o[d][f+1]),c(o[d+1][f]),c(o[d][f])):(c(o[d][f+1]),c(o[d+1][f+1]),c(o[d+1][f]))}}function c(t){a.push(t.x,t.y,t.z)}function u(t,n){var r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function p(t,e,n,r){r<0&&1===t.x&&(s[e]=t.x-1),0===n.x&&0===n.z&&(s[e]=r/2/Math.PI+.5)}function d(t){return Math.atan2(t.z,-t.x)}return function(t){for(var e=new Mt,r=new Mt,i=new Mt,o=0;o<n.length;o+=3)u(n[o+0],e),u(n[o+1],r),u(n[o+2],i),l(e,r,i,t)}(i),function(t){for(var e=new Mt,n=0;n<a.length;n+=3)e.x=a[n+0],e.y=a[n+1],e.z=a[n+2],e.normalize().multiplyScalar(t),a[n+0]=e.x,a[n+1]=e.y,a[n+2]=e.z}(r),function(){for(var t=new Mt,e=0;e<a.length;e+=3){t.x=a[e+0],t.y=a[e+1],t.z=a[e+2];var n=d(t)/2/Math.PI+.5,r=(i=t,Math.atan2(-i.y,Math.sqrt(i.x*i.x+i.z*i.z))/Math.PI+.5);s.push(n,1-r)}var i;(function(){for(var t=new Mt,e=new Mt,n=new Mt,r=new Mt,i=new mt,o=new mt,l=new mt,c=0,u=0;c<a.length;c+=9,u+=6){t.set(a[c+0],a[c+1],a[c+2]),e.set(a[c+3],a[c+4],a[c+5]),n.set(a[c+6],a[c+7],a[c+8]),i.set(s[u+0],s[u+1]),o.set(s[u+2],s[u+3]),l.set(s[u+4],s[u+5]),r.copy(t).add(e).add(n).divideScalar(3);var h=d(r);p(i,u+0,t,h),p(o,u+2,e,h),p(l,u+4,n,h)}})(),function(){for(var t=0;t<s.length;t+=6){var e=s[t+0],n=s[t+2],r=s[t+4],i=Math.max(e,n,r),o=Math.min(e,n,r);i>.9&&o<.1&&(e<.2&&(s[t+0]+=1),n<.2&&(s[t+2]+=1),r<.2&&(s[t+4]+=1))}}()}(),o.setAttribute("position",new cn(a,3)),o.setAttribute("normal",new cn(a.slice(),3)),o.setAttribute("uv",new cn(s,2)),0===i?o.computeVertexNormals():o.normalizeNormals(),o}return st(e,t),e}(xn),oa=function(t){function e(e,n){var r;void 0===e&&(e=1),void 0===n&&(n=0);var i=(1+Math.sqrt(5))/2,o=1/i,a=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-o,-i,0,-o,i,0,o,-i,0,o,i,-o,-i,0,-o,i,0,o,-i,0,o,i,0,-i,0,-o,i,0,-o,-i,0,o,i,0,o];return(r=t.call(this,a,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,n)||this).type="DodecahedronGeometry",r.parameters={radius:e,detail:n},r}return st(e,t),e}(ia),aa=new Mt,sa=new Mt,la=new Mt,ca=new Fe,ua=function(t){function e(e,n){var r;if((r=t.call(this)||this).type="EdgesGeometry",r.parameters={thresholdAngle:n},n=void 0!==n?n:1,!0===e.isGeometry)return console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),lt(r);for(var i=Math.pow(10,4),o=Math.cos(ft.DEG2RAD*n),a=e.getIndex(),s=e.getAttribute("position"),l=a?a.count:s.count,c=[0,0,0],u=["a","b","c"],p=new Array(3),d={},h=[],f=0;f<l;f+=3){a?(c[0]=a.getX(f),c[1]=a.getX(f+1),c[2]=a.getX(f+2)):(c[0]=f,c[1]=f+1,c[2]=f+2);var m=ca.a,y=ca.b,_=ca.c;if(m.fromBufferAttribute(s,c[0]),y.fromBufferAttribute(s,c[1]),_.fromBufferAttribute(s,c[2]),ca.getNormal(la),p[0]=Math.round(m.x*i)+","+Math.round(m.y*i)+","+Math.round(m.z*i),p[1]=Math.round(y.x*i)+","+Math.round(y.y*i)+","+Math.round(y.z*i),p[2]=Math.round(_.x*i)+","+Math.round(_.y*i)+","+Math.round(_.z*i),p[0]!==p[1]&&p[1]!==p[2]&&p[2]!==p[0])for(var g=0;g<3;g++){var v=(g+1)%3,b=p[g],x=p[v],w=ca[u[g]],E=ca[u[v]],T=b+"_"+x,S=x+"_"+b;S in d&&d[S]?(la.dot(d[S].normal)<=o&&(h.push(w.x,w.y,w.z),h.push(E.x,E.y,E.z)),d[S]=null):T in d||(d[T]={index0:c[g],index1:c[v],normal:la.clone()})}}for(var M in d)if(d[M]){var j=d[M],C=j.index0,z=j.index1;aa.fromBufferAttribute(s,C),sa.fromBufferAttribute(s,z),h.push(aa.x,aa.y,aa.z),h.push(sa.x,sa.y,sa.z)}return r.setAttribute("position",new cn(h,3)),r}return st(e,t),e}(xn);function pa(t,e,n,r,i){var o,a;if(i===function(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}(t,e,n,r)>0)for(o=e;o<n;o+=r)a=La(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=La(o,t[o],t[o+1],a);return a&&Ma(a,a.next)&&(Ia(a),a=a.next),a}function da(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!Ma(r,r.next)&&0!==Sa(r.prev,r,r.next))r=r.next;else{if(Ia(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function ha(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=xa(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,l,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(l=c;s>0||l>0&&r;)0!==s&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(t,r,i,o);for(var s,l,c=t;t.prev!==t.next;)if(s=t.prev,l=t.next,o?ma(t,r,i,o):fa(t))e.push(s.i/n),e.push(t.i/n),e.push(l.i/n),Ia(t),t=l.next,c=l.next;else if((t=l)===c){a?1===a?ha(t=ya(da(t),e,n),e,n,r,i,o,2):2===a&&_a(t,e,n,r,i,o):ha(da(t),e,n,r,i,o,1);break}}}function fa(t){var e=t.prev,n=t,r=t.next;if(Sa(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(Ea(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Sa(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function ma(t,e,n,r){var i=t.prev,o=t,a=t.next;if(Sa(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,l=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,u=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,p=xa(s,l,e,n,r),d=xa(c,u,e,n,r),h=t.prevZ,f=t.nextZ;h&&h.z>=p&&f&&f.z<=d;){if(h!==t.prev&&h!==t.next&&Ea(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&Sa(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,f!==t.prev&&f!==t.next&&Ea(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Sa(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;h&&h.z>=p;){if(h!==t.prev&&h!==t.next&&Ea(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&Sa(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;f&&f.z<=d;){if(f!==t.prev&&f!==t.next&&Ea(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Sa(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function ya(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!Ma(i,o)&&ja(i,r,r.next,o)&&Ra(i,o)&&Ra(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),Ia(r),Ia(r.next),r=t=o),r=r.next}while(r!==t);return da(r)}function _a(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Ta(a,s)){var l=Aa(a,s);return a=da(a,a.next),l=da(l,l.next),ha(a,e,n,r,i,o),void ha(l,e,n,r,i,o)}s=s.next}a=a.next}while(a!==t)}function ga(t,e){return t.x-e.x}function va(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n;var l,c=n,u=n.x,p=n.y,d=1/0;r=n;do{i>=r.x&&r.x>=u&&i!==r.x&&Ea(o<p?i:a,o,u,p,o<p?a:i,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(i-r.x),Ra(r,t)&&(l<d||l===d&&(r.x>n.x||r.x===n.x&&ba(n,r)))&&(n=r,d=l)),r=r.next}while(r!==c);return n}(t,e)){var n=Aa(e,t);da(e,e.next),da(n,n.next)}}function ba(t,e){return Sa(t.prev,t,e.prev)<0&&Sa(e.next,t,t.next)<0}function xa(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function wa(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Ea(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function Ta(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&ja(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Ra(t,e)&&Ra(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(Sa(t.prev,t,e.prev)||Sa(t,e.prev,e))||Ma(t,e)&&Sa(t.prev,t,t.next)>0&&Sa(e.prev,e,e.next)>0)}function Sa(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Ma(t,e){return t.x===e.x&&t.y===e.y}function ja(t,e,n,r){var i=za(Sa(t,e,n)),o=za(Sa(t,e,r)),a=za(Sa(n,r,t)),s=za(Sa(n,r,e));return i!==o&&a!==s||!(0!==i||!Ca(t,n,e))||!(0!==o||!Ca(t,r,e))||!(0!==a||!Ca(n,t,r))||!(0!==s||!Ca(n,e,r))}function Ca(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function za(t){return t>0?1:t<0?-1:0}function Ra(t,e){return Sa(t.prev,t,t.next)<0?Sa(t,e,t.next)>=0&&Sa(t,t.prev,e)>=0:Sa(t,e,t.prev)<0||Sa(t,t.next,e)<0}function Aa(t,e){var n=new Pa(t.i,t.x,t.y),r=new Pa(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function La(t,e,n,r){var i=new Pa(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Ia(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Pa(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var Oa={area:function(t){for(var e=t.length,n=0,r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n},isClockWise:function(t){return Oa.area(t)<0},triangulateShape:function(t,e){var n=[],r=[],i=[];ka(t),Ba(n,t);var o=t.length;e.forEach(ka);for(var a=0;a<e.length;a++)r.push(o),o+=e[a].length,Ba(n,e[a]);for(var s=function(t,e,n){n=n||2;var r,i,o,a,s,l,c,u=e&&e.length,p=u?e[0]*n:t.length,d=pa(t,0,p,n,!0),h=[];if(!d||d.next===d.prev)return h;if(u&&(d=function(t,e,n,r){var i,o,a,s=[];for(i=0,o=e.length;i<o;i++)(a=pa(t,e[i]*r,i<o-1?e[i+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),s.push(wa(a));for(s.sort(ga),i=0;i<s.length;i++)va(s[i],n),n=da(n,n.next);return n}(t,e,d,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(var f=n;f<p;f+=n)(s=t[f])<r&&(r=s),(l=t[f+1])<i&&(i=l),s>o&&(o=s),l>a&&(a=l);c=0!==(c=Math.max(o-r,a-i))?1/c:0}return ha(d,h,n,r,i,c),h}(n,r),l=0;l<s.length;l+=3)i.push(s.slice(l,l+3));return i}};function ka(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function Ba(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}var Da=function(t){function e(e,n){var r;(r=t.call(this)||this).type="ExtrudeGeometry",r.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];for(var i=lt(r),o=[],a=[],s=0,l=e.length;s<l;s++)c(e[s]);function c(t){var e=[],r=void 0!==n.curveSegments?n.curveSegments:12,s=void 0!==n.steps?n.steps:1,l=void 0!==n.depth?n.depth:100,c=void 0===n.bevelEnabled||n.bevelEnabled,u=void 0!==n.bevelThickness?n.bevelThickness:6,p=void 0!==n.bevelSize?n.bevelSize:u-2,d=void 0!==n.bevelOffset?n.bevelOffset:0,h=void 0!==n.bevelSegments?n.bevelSegments:3,f=n.extrudePath,m=void 0!==n.UVGenerator?n.UVGenerator:Ha;void 0!==n.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=n.amount);var y,_,g,v,b,x=!1;f&&(y=f.getSpacedPoints(s),x=!0,c=!1,_=f.computeFrenetFrames(s,!1),g=new Mt,v=new Mt,b=new Mt),c||(h=0,u=0,p=0,d=0);var w=t.extractPoints(r),E=w.shape,T=w.holes;if(!Oa.isClockWise(E)){E=E.reverse();for(var S=0,M=T.length;S<M;S++){var j=T[S];Oa.isClockWise(j)&&(T[S]=j.reverse())}}for(var C=Oa.triangulateShape(E,T),z=E,R=0,A=T.length;R<A;R++){var L=T[R];E=E.concat(L)}function I(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}var P=E.length,O=C.length;function k(t,e,n){var r,i,o,a=t.x-e.x,s=t.y-e.y,l=n.x-t.x,c=n.y-t.y,u=a*a+s*s,p=a*c-s*l;if(Math.abs(p)>Number.EPSILON){var d=Math.sqrt(u),h=Math.sqrt(l*l+c*c),f=e.x-s/d,m=e.y+a/d,y=((n.x-c/h-f)*c-(n.y+l/h-m)*l)/(a*c-s*l),_=(r=f+a*y-t.x)*r+(i=m+s*y-t.y)*i;if(_<=2)return new mt(r,i);o=Math.sqrt(_/2)}else{var g=!1;a>Number.EPSILON?l>Number.EPSILON&&(g=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(g=!0):Math.sign(s)===Math.sign(c)&&(g=!0),g?(r=-s,i=a,o=Math.sqrt(u)):(r=a,i=s,o=Math.sqrt(u/2))}return new mt(r/o,i/o)}for(var B=[],D=0,H=z.length,F=H-1,N=D+1;D<H;D++,F++,N++)F===H&&(F=0),N===H&&(N=0),B[D]=k(z[D],z[F],z[N]);for(var U,V=[],G=B.concat(),W=0,q=T.length;W<q;W++){var X=T[W];U=[];for(var Y=0,Q=X.length,Z=Q-1,J=Y+1;Y<Q;Y++,Z++,J++)Z===Q&&(Z=0),J===Q&&(J=0),U[Y]=k(X[Y],X[Z],X[J]);V.push(U),G=G.concat(U)}for(var K=0;K<h;K++){for(var $=K/h,tt=u*Math.cos($*Math.PI/2),et=p*Math.sin($*Math.PI/2)+d,nt=0,rt=z.length;nt<rt;nt++){var it=I(z[nt],B[nt],et);It(it.x,it.y,-tt)}for(var ot=0,at=T.length;ot<at;ot++){var st=T[ot];U=V[ot];for(var lt=0,ct=st.length;lt<ct;lt++){var ut=I(st[lt],U[lt],et);It(ut.x,ut.y,-tt)}}}for(var pt=p+d,dt=0;dt<P;dt++){var ht=c?I(E[dt],G[dt],pt):E[dt];x?(v.copy(_.normals[0]).multiplyScalar(ht.x),g.copy(_.binormals[0]).multiplyScalar(ht.y),b.copy(y[0]).add(v).add(g),It(b.x,b.y,b.z)):It(ht.x,ht.y,0)}for(var ft=1;ft<=s;ft++)for(var yt=0;yt<P;yt++){var _t=c?I(E[yt],G[yt],pt):E[yt];x?(v.copy(_.normals[ft]).multiplyScalar(_t.x),g.copy(_.binormals[ft]).multiplyScalar(_t.y),b.copy(y[ft]).add(v).add(g),It(b.x,b.y,b.z)):It(_t.x,_t.y,l/s*ft)}for(var gt=h-1;gt>=0;gt--){for(var vt=gt/h,bt=u*Math.cos(vt*Math.PI/2),xt=p*Math.sin(vt*Math.PI/2)+d,wt=0,Et=z.length;wt<Et;wt++){var Tt=I(z[wt],B[wt],xt);It(Tt.x,Tt.y,l+bt)}for(var St=0,jt=T.length;St<jt;St++){var Ct=T[St];U=V[St];for(var zt=0,Rt=Ct.length;zt<Rt;zt++){var At=I(Ct[zt],U[zt],xt);x?It(At.x,At.y+y[s-1].y,y[s-1].x+bt):It(At.x,At.y,l+bt)}}}function Lt(t,e){for(var n=t.length;--n>=0;){var r=n,i=n-1;i<0&&(i=t.length-1);for(var o=0,a=s+2*h;o<a;o++){var l=P*o,c=P*(o+1);Ot(e+r+l,e+i+l,e+i+c,e+r+c)}}}function It(t,n,r){e.push(t),e.push(n),e.push(r)}function Pt(t,e,n){kt(t),kt(e),kt(n);var r=o.length/3,a=m.generateTopUV(i,o,r-3,r-2,r-1);Bt(a[0]),Bt(a[1]),Bt(a[2])}function Ot(t,e,n,r){kt(t),kt(e),kt(r),kt(e),kt(n),kt(r);var a=o.length/3,s=m.generateSideWallUV(i,o,a-6,a-3,a-2,a-1);Bt(s[0]),Bt(s[1]),Bt(s[3]),Bt(s[1]),Bt(s[2]),Bt(s[3])}function kt(t){o.push(e[3*t+0]),o.push(e[3*t+1]),o.push(e[3*t+2])}function Bt(t){a.push(t.x),a.push(t.y)}!function(){var t=o.length/3;if(c){for(var e=0,n=P*e,r=0;r<O;r++){var a=C[r];Pt(a[2]+n,a[1]+n,a[0]+n)}n=P*(e=s+2*h);for(var l=0;l<O;l++){var u=C[l];Pt(u[0]+n,u[1]+n,u[2]+n)}}else{for(var p=0;p<O;p++){var d=C[p];Pt(d[2],d[1],d[0])}for(var f=0;f<O;f++){var m=C[f];Pt(m[0]+P*s,m[1]+P*s,m[2]+P*s)}}i.addGroup(t,o.length/3-t,0)}(),function(){var t=o.length/3,e=0;Lt(z,e),e+=z.length;for(var n=0,r=T.length;n<r;n++){var a=T[n];Lt(a,e),e+=a.length}i.addGroup(t,o.length/3-t,1)}()}return r.setAttribute("position",new cn(o,3)),r.setAttribute("uv",new cn(a,2)),r.computeVertexNormals(),r}return st(e,t),e.prototype.toJSON=function(){var t=xn.prototype.toJSON.call(this);return function(t,e,n){if(n.shapes=[],Array.isArray(t))for(var r=0,i=t.length;r<i;r++){var o=t[r];n.shapes.push(o.uuid)}else n.shapes.push(t.uuid);return void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}(this.parameters.shapes,this.parameters.options,t)},e}(xn),Ha={generateTopUV:function(t,e,n,r,i){var o=e[3*n],a=e[3*n+1],s=e[3*r],l=e[3*r+1],c=e[3*i],u=e[3*i+1];return[new mt(o,a),new mt(s,l),new mt(c,u)]},generateSideWallUV:function(t,e,n,r,i,o){var a=e[3*n],s=e[3*n+1],l=e[3*n+2],c=e[3*r],u=e[3*r+1],p=e[3*r+2],d=e[3*i],h=e[3*i+1],f=e[3*i+2],m=e[3*o],y=e[3*o+1],_=e[3*o+2];return Math.abs(s-u)<.01?[new mt(a,1-l),new mt(c,1-p),new mt(d,1-f),new mt(m,1-_)]:[new mt(s,1-l),new mt(u,1-p),new mt(h,1-f),new mt(y,1-_)]}},Fa=function(t){function e(e,n){var r;void 0===e&&(e=1),void 0===n&&(n=0);var i=(1+Math.sqrt(5))/2,o=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1];return(r=t.call(this,o,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,n)||this).type="IcosahedronGeometry",r.parameters={radius:e,detail:n},r}return st(e,t),e}(ia),Na=function(t){function e(e,n,r,i){var o;void 0===n&&(n=12),void 0===r&&(r=0),void 0===i&&(i=2*Math.PI),(o=t.call(this)||this).type="LatheGeometry",o.parameters={points:e,segments:n,phiStart:r,phiLength:i},n=Math.floor(n),i=ft.clamp(i,0,2*Math.PI);for(var a=[],s=[],l=[],c=1/n,u=new Mt,p=new mt,d=0;d<=n;d++)for(var h=r+d*c*i,f=Math.sin(h),m=Math.cos(h),y=0;y<=e.length-1;y++)u.x=e[y].x*f,u.y=e[y].y,u.z=e[y].x*m,s.push(u.x,u.y,u.z),p.x=d/n,p.y=y/(e.length-1),l.push(p.x,p.y);for(var _=0;_<n;_++)for(var g=0;g<e.length-1;g++){var v=g+_*e.length,b=v,x=v+e.length,w=v+e.length+1,E=v+1;a.push(b,x,E),a.push(x,w,E)}if(o.setIndex(a),o.setAttribute("position",new cn(s,3)),o.setAttribute("uv",new cn(l,2)),o.computeVertexNormals(),i===2*Math.PI)for(var T=o.attributes.normal.array,S=new Mt,M=new Mt,j=new Mt,C=n*e.length*3,z=0,R=0;z<e.length;z++,R+=3)S.x=T[R+0],S.y=T[R+1],S.z=T[R+2],M.x=T[C+R+0],M.y=T[C+R+1],M.z=T[C+R+2],j.addVectors(S,M).normalize(),T[R+0]=T[C+R+0]=j.x,T[R+1]=T[C+R+1]=j.y,T[R+2]=T[C+R+2]=j.z;return o}return st(e,t),e}(xn),Ua=function(t){function e(e,n){var r;return void 0===e&&(e=1),void 0===n&&(n=0),(r=t.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,n)||this).type="OctahedronGeometry",r.parameters={radius:e,detail:n},r}return st(e,t),e}(ia);function Va(t,e,n){xn.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n};var r=[],i=[],o=[],a=[],s=1e-5,l=new Mt,c=new Mt,u=new Mt,p=new Mt,d=new Mt;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var h=e+1,f=0;f<=n;f++)for(var m=f/n,y=0;y<=e;y++){var _=y/e;t(_,m,c),i.push(c.x,c.y,c.z),_-s>=0?(t(_-s,m,u),p.subVectors(c,u)):(t(_+s,m,u),p.subVectors(u,c)),m-s>=0?(t(_,m-s,u),d.subVectors(c,u)):(t(_,m+s,u),d.subVectors(u,c)),l.crossVectors(p,d).normalize(),o.push(l.x,l.y,l.z),a.push(_,m)}for(var g=0;g<n;g++)for(var v=0;v<e;v++){var b=g*h+v,x=g*h+v+1,w=(g+1)*h+v+1,E=(g+1)*h+v;r.push(b,x,E),r.push(x,w,E)}this.setIndex(r),this.setAttribute("position",new cn(i,3)),this.setAttribute("normal",new cn(o,3)),this.setAttribute("uv",new cn(a,2))}Va.prototype=Object.create(xn.prototype),Va.prototype.constructor=Va;var Ga=function(t){function e(e,n,r,i,o,a){var s;void 0===e&&(e=.5),void 0===n&&(n=1),void 0===r&&(r=8),void 0===i&&(i=1),void 0===o&&(o=0),void 0===a&&(a=2*Math.PI),(s=t.call(this)||this).type="RingGeometry",s.parameters={innerRadius:e,outerRadius:n,thetaSegments:r,phiSegments:i,thetaStart:o,thetaLength:a},r=Math.max(3,r);for(var l=[],c=[],u=[],p=[],d=e,h=(n-e)/(i=Math.max(1,i)),f=new Mt,m=new mt,y=0;y<=i;y++){for(var _=0;_<=r;_++){var g=o+_/r*a;f.x=d*Math.cos(g),f.y=d*Math.sin(g),c.push(f.x,f.y,f.z),u.push(0,0,1),m.x=(f.x/n+1)/2,m.y=(f.y/n+1)/2,p.push(m.x,m.y)}d+=h}for(var v=0;v<i;v++)for(var b=v*(r+1),x=0;x<r;x++){var w=x+b,E=w,T=w+r+1,S=w+r+2,M=w+1;l.push(E,T,M),l.push(T,S,M)}return s.setIndex(l),s.setAttribute("position",new cn(c,3)),s.setAttribute("normal",new cn(u,3)),s.setAttribute("uv",new cn(p,2)),s}return st(e,t),e}(xn),Wa=function(t){function e(e,n){var r;void 0===n&&(n=12),(r=t.call(this)||this).type="ShapeGeometry",r.parameters={shapes:e,curveSegments:n};var i=[],o=[],a=[],s=[],l=0,c=0;if(!1===Array.isArray(e))p(e);else for(var u=0;u<e.length;u++)p(e[u]),r.addGroup(l,c,u),l+=c,c=0;function p(t){var e=o.length/3,r=t.extractPoints(n),l=r.shape,u=r.holes;!1===Oa.isClockWise(l)&&(l=l.reverse());for(var p=0,d=u.length;p<d;p++){var h=u[p];!0===Oa.isClockWise(h)&&(u[p]=h.reverse())}for(var f=Oa.triangulateShape(l,u),m=0,y=u.length;m<y;m++){var _=u[m];l=l.concat(_)}for(var g=0,v=l.length;g<v;g++){var b=l[g];o.push(b.x,b.y,0),a.push(0,0,1),s.push(b.x,b.y)}for(var x=0,w=f.length;x<w;x++){var E=f[x],T=E[0]+e,S=E[1]+e,M=E[2]+e;i.push(T,S,M),c+=3}}return r.setIndex(i),r.setAttribute("position",new cn(o,3)),r.setAttribute("normal",new cn(a,3)),r.setAttribute("uv",new cn(s,2)),r}return st(e,t),e.prototype.toJSON=function(){var t=xn.prototype.toJSON.call(this);return function(t,e){if(e.shapes=[],Array.isArray(t))for(var n=0,r=t.length;n<r;n++){var i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)},e}(xn),qa=function(t){function e(e,n,r,i,o,a,s){var l;void 0===e&&(e=1),void 0===n&&(n=8),void 0===r&&(r=6),void 0===i&&(i=0),void 0===o&&(o=2*Math.PI),void 0===a&&(a=0),void 0===s&&(s=Math.PI),(l=t.call(this)||this).type="SphereGeometry",l.parameters={radius:e,widthSegments:n,heightSegments:r,phiStart:i,phiLength:o,thetaStart:a,thetaLength:s},n=Math.max(3,Math.floor(n)),r=Math.max(2,Math.floor(r));for(var c=Math.min(a+s,Math.PI),u=0,p=[],d=new Mt,h=new Mt,f=[],m=[],y=[],_=[],g=0;g<=r;g++){var v=[],b=g/r,x=0;0==g&&0==a?x=.5/n:g==r&&c==Math.PI&&(x=-.5/n);for(var w=0;w<=n;w++){var E=w/n;d.x=-e*Math.cos(i+E*o)*Math.sin(a+b*s),d.y=e*Math.cos(a+b*s),d.z=e*Math.sin(i+E*o)*Math.sin(a+b*s),m.push(d.x,d.y,d.z),h.copy(d).normalize(),y.push(h.x,h.y,h.z),_.push(E+x,1-b),v.push(u++)}p.push(v)}for(var T=0;T<r;T++)for(var S=0;S<n;S++){var M=p[T][S+1],j=p[T][S],C=p[T+1][S],z=p[T+1][S+1];(0!==T||a>0)&&f.push(M,j,z),(T!==r-1||c<Math.PI)&&f.push(j,C,z)}return l.setIndex(f),l.setAttribute("position",new cn(m,3)),l.setAttribute("normal",new cn(y,3)),l.setAttribute("uv",new cn(_,2)),l}return st(e,t),e}(xn),Xa=function(t){function e(e,n){var r;return void 0===e&&(e=1),void 0===n&&(n=0),(r=t.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,n)||this).type="TetrahedronGeometry",r.parameters={radius:e,detail:n},r}return st(e,t),e}(ia),Ya=function(t){function e(e,n){var r;void 0===n&&(n={});var i=n.font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new xn||lt(r);var o=i.generateShapes(e,n.size);return n.depth=void 0!==n.height?n.height:50,void 0===n.bevelThickness&&(n.bevelThickness=10),void 0===n.bevelSize&&(n.bevelSize=8),void 0===n.bevelEnabled&&(n.bevelEnabled=!1),(r=t.call(this,o,n)||this).type="TextGeometry",r}return st(e,t),e}(Da),Qa=function(t){function e(e,n,r,i,o){var a;void 0===e&&(e=1),void 0===n&&(n=.4),void 0===r&&(r=8),void 0===i&&(i=6),void 0===o&&(o=2*Math.PI),(a=t.call(this)||this).type="TorusGeometry",a.parameters={radius:e,tube:n,radialSegments:r,tubularSegments:i,arc:o},r=Math.floor(r),i=Math.floor(i);for(var s=[],l=[],c=[],u=[],p=new Mt,d=new Mt,h=new Mt,f=0;f<=r;f++)for(var m=0;m<=i;m++){var y=m/i*o,_=f/r*Math.PI*2;d.x=(e+n*Math.cos(_))*Math.cos(y),d.y=(e+n*Math.cos(_))*Math.sin(y),d.z=n*Math.sin(_),l.push(d.x,d.y,d.z),p.x=e*Math.cos(y),p.y=e*Math.sin(y),h.subVectors(d,p).normalize(),c.push(h.x,h.y,h.z),u.push(m/i),u.push(f/r)}for(var g=1;g<=r;g++)for(var v=1;v<=i;v++){var b=(i+1)*g+v-1,x=(i+1)*(g-1)+v-1,w=(i+1)*(g-1)+v,E=(i+1)*g+v;s.push(b,x,E),s.push(x,w,E)}return a.setIndex(s),a.setAttribute("position",new cn(l,3)),a.setAttribute("normal",new cn(c,3)),a.setAttribute("uv",new cn(u,2)),a}return st(e,t),e}(xn),Za=function(t){function e(e,n,r,i,o,a){var s;void 0===e&&(e=1),void 0===n&&(n=.4),void 0===r&&(r=64),void 0===i&&(i=8),void 0===o&&(o=2),void 0===a&&(a=3),(s=t.call(this)||this).type="TorusKnotGeometry",s.parameters={radius:e,tube:n,tubularSegments:r,radialSegments:i,p:o,q:a},r=Math.floor(r),i=Math.floor(i);for(var l=[],c=[],u=[],p=[],d=new Mt,h=new Mt,f=new Mt,m=new Mt,y=new Mt,_=new Mt,g=new Mt,v=0;v<=r;++v){var b=v/r*o*Math.PI*2;A(b,o,a,e,f),A(b+.01,o,a,e,m),_.subVectors(m,f),g.addVectors(m,f),y.crossVectors(_,g),g.crossVectors(y,_),y.normalize(),g.normalize();for(var x=0;x<=i;++x){var w=x/i*Math.PI*2,E=-n*Math.cos(w),T=n*Math.sin(w);d.x=f.x+(E*g.x+T*y.x),d.y=f.y+(E*g.y+T*y.y),d.z=f.z+(E*g.z+T*y.z),c.push(d.x,d.y,d.z),h.subVectors(d,f).normalize(),u.push(h.x,h.y,h.z),p.push(v/r),p.push(x/i)}}for(var S=1;S<=r;S++)for(var M=1;M<=i;M++){var j=(i+1)*(S-1)+(M-1),C=(i+1)*S+(M-1),z=(i+1)*S+M,R=(i+1)*(S-1)+M;l.push(j,C,R),l.push(C,z,R)}function A(t,e,n,r,i){var o=Math.cos(t),a=Math.sin(t),s=n/e*t,l=Math.cos(s);i.x=r*(2+l)*.5*o,i.y=r*(2+l)*a*.5,i.z=r*Math.sin(s)*.5}return s.setIndex(l),s.setAttribute("position",new cn(c,3)),s.setAttribute("normal",new cn(u,3)),s.setAttribute("uv",new cn(p,2)),s}return st(e,t),e}(xn),Ja=function(t){function e(e,n,r,i,o){var a;void 0===n&&(n=64),void 0===r&&(r=1),void 0===i&&(i=8),void 0===o&&(o=!1),(a=t.call(this)||this).type="TubeGeometry",a.parameters={path:e,tubularSegments:n,radius:r,radialSegments:i,closed:o};var s=e.computeFrenetFrames(n,o);a.tangents=s.tangents,a.normals=s.normals,a.binormals=s.binormals;var l=new Mt,c=new Mt,u=new mt,p=new Mt,d=[],h=[],f=[],m=[];function y(t){p=e.getPointAt(t/n,p);for(var o=s.normals[t],a=s.binormals[t],u=0;u<=i;u++){var f=u/i*Math.PI*2,m=Math.sin(f),y=-Math.cos(f);c.x=y*o.x+m*a.x,c.y=y*o.y+m*a.y,c.z=y*o.z+m*a.z,c.normalize(),h.push(c.x,c.y,c.z),l.x=p.x+r*c.x,l.y=p.y+r*c.y,l.z=p.z+r*c.z,d.push(l.x,l.y,l.z)}}return function(){for(var t=0;t<n;t++)y(t);y(!1===o?n:0),function(){for(var t=0;t<=n;t++)for(var e=0;e<=i;e++)u.x=t/n,u.y=e/i,f.push(u.x,u.y)}(),function(){for(var t=1;t<=n;t++)for(var e=1;e<=i;e++){var r=(i+1)*(t-1)+(e-1),o=(i+1)*t+(e-1),a=(i+1)*t+e,s=(i+1)*(t-1)+e;m.push(r,o,s),m.push(o,a,s)}}()}(),a.setIndex(m),a.setAttribute("position",new cn(d,3)),a.setAttribute("normal",new cn(h,3)),a.setAttribute("uv",new cn(f,2)),a}return st(e,t),e.prototype.toJSON=function(){var t=xn.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},e}(xn),Ka=function(t){function e(e){var n;if((n=t.call(this)||this).type="WireframeGeometry",!0===e.isGeometry)return console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),lt(n);var r=[],i=[0,0],o={},a=new Mt;if(null!==e.index){var s=e.attributes.position,l=e.index,c=e.groups;0===c.length&&(c=[{start:0,count:l.count,materialIndex:0}]);for(var u=0,p=c.length;u<p;++u)for(var d=c[u],h=d.start,f=h,m=h+d.count;f<m;f+=3)for(var y=0;y<3;y++){var _=l.getX(f+y),g=l.getX(f+(y+1)%3);i[0]=Math.min(_,g),i[1]=Math.max(_,g);var v=i[0]+","+i[1];void 0===o[v]&&(o[v]={index1:i[0],index2:i[1]})}for(var b in o){var x=o[b];a.fromBufferAttribute(s,x.index1),r.push(a.x,a.y,a.z),a.fromBufferAttribute(s,x.index2),r.push(a.x,a.y,a.z)}}else for(var w=e.attributes.position,E=0,T=w.count/3;E<T;E++)for(var S=0;S<3;S++){var M=3*E+S;a.fromBufferAttribute(w,M),r.push(a.x,a.y,a.z);var j=3*E+(S+1)%3;a.fromBufferAttribute(w,j),r.push(a.x,a.y,a.z)}return n.setAttribute("position",new cn(r,3)),n}return st(e,t),e}(xn),$a=Object.freeze({__proto__:null,BoxGeometry:Nn,BoxBufferGeometry:Nn,CircleGeometry:ea,CircleBufferGeometry:ea,ConeGeometry:ra,ConeBufferGeometry:ra,CylinderGeometry:na,CylinderBufferGeometry:na,DodecahedronGeometry:oa,DodecahedronBufferGeometry:oa,EdgesGeometry:ua,ExtrudeGeometry:Da,ExtrudeBufferGeometry:Da,IcosahedronGeometry:Fa,IcosahedronBufferGeometry:Fa,LatheGeometry:Na,LatheBufferGeometry:Na,OctahedronGeometry:Ua,OctahedronBufferGeometry:Ua,ParametricGeometry:Va,ParametricBufferGeometry:Va,PlaneGeometry:rr,PlaneBufferGeometry:rr,PolyhedronGeometry:ia,PolyhedronBufferGeometry:ia,RingGeometry:Ga,RingBufferGeometry:Ga,ShapeGeometry:Wa,ShapeBufferGeometry:Wa,SphereGeometry:qa,SphereBufferGeometry:qa,TetrahedronGeometry:Xa,TetrahedronBufferGeometry:Xa,TextGeometry:Ya,TextBufferGeometry:Ya,TorusGeometry:Qa,TorusBufferGeometry:Qa,TorusKnotGeometry:Za,TorusKnotBufferGeometry:Za,TubeGeometry:Ja,TubeBufferGeometry:Ja,WireframeGeometry:Ka}),ts=function(t){function e(e){var n;return(n=t.call(this)||this).type="ShadowMaterial",n.color=new Qe(0),n.transparent=!0,n.setValues(e),n}return st(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this},e}(Ue);ts.prototype.isShadowMaterial=!0;var es=function(t){function e(e){var n;return(n=t.call(this,e)||this).type="RawShaderMaterial",n}return st(e,t),e}(Wn);function ns(t){Ue.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Qe(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new mt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(t)}function rs(t){ns.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new mt(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(t){this.reflectivity=ft.clamp(2.5*(t-1)/(t+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(t)}es.prototype.isRawShaderMaterial=!0,ns.prototype=Object.create(Ue.prototype),ns.prototype.constructor=ns,ns.prototype.isMeshStandardMaterial=!0,ns.prototype.copy=function(t){return Ue.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this.vertexTangents=t.vertexTangents,this},rs.prototype=Object.create(ns.prototype),rs.prototype.constructor=rs,rs.prototype.isMeshPhysicalMaterial=!0,rs.prototype.copy=function(t){return ns.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new Qe).copy(t.sheen):this.sheen=null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this};var is=function(t){function e(e){var n;return(n=t.call(this)||this).type="MeshPhongMaterial",n.color=new Qe(16777215),n.specular=new Qe(1118481),n.shininess=30,n.map=null,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=null,n.aoMapIntensity=1,n.emissive=new Qe(0),n.emissiveIntensity=1,n.emissiveMap=null,n.bumpMap=null,n.bumpScale=1,n.normalMap=null,n.normalMapType=0,n.normalScale=new mt(1,1),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.specularMap=null,n.alphaMap=null,n.envMap=null,n.combine=0,n.reflectivity=1,n.refractionRatio=.98,n.wireframe=!1,n.wireframeLinewidth=1,n.wireframeLinecap="round",n.wireframeLinejoin="round",n.skinning=!1,n.morphTargets=!1,n.morphNormals=!1,n.flatShading=!1,n.setValues(e),n}return st(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this},e}(Ue);is.prototype.isMeshPhongMaterial=!0;var os=function(t){function e(e){var n;return(n=t.call(this)||this).defines={TOON:""},n.type="MeshToonMaterial",n.color=new Qe(16777215),n.map=null,n.gradientMap=null,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=null,n.aoMapIntensity=1,n.emissive=new Qe(0),n.emissiveIntensity=1,n.emissiveMap=null,n.bumpMap=null,n.bumpScale=1,n.normalMap=null,n.normalMapType=0,n.normalScale=new mt(1,1),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.alphaMap=null,n.wireframe=!1,n.wireframeLinewidth=1,n.wireframeLinecap="round",n.wireframeLinejoin="round",n.skinning=!1,n.morphTargets=!1,n.morphNormals=!1,n.setValues(e),n}return st(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},e}(Ue);os.prototype.isMeshToonMaterial=!0;var as=function(t){function e(e){var n;return(n=t.call(this)||this).type="MeshNormalMaterial",n.bumpMap=null,n.bumpScale=1,n.normalMap=null,n.normalMapType=0,n.normalScale=new mt(1,1),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.wireframe=!1,n.wireframeLinewidth=1,n.fog=!1,n.skinning=!1,n.morphTargets=!1,n.morphNormals=!1,n.flatShading=!1,n.setValues(e),n}return st(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this},e}(Ue);as.prototype.isMeshNormalMaterial=!0;var ss=function(t){function e(e){var n;return(n=t.call(this)||this).type="MeshLambertMaterial",n.color=new Qe(16777215),n.map=null,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=null,n.aoMapIntensity=1,n.emissive=new Qe(0),n.emissiveIntensity=1,n.emissiveMap=null,n.specularMap=null,n.alphaMap=null,n.envMap=null,n.combine=0,n.reflectivity=1,n.refractionRatio=.98,n.wireframe=!1,n.wireframeLinewidth=1,n.wireframeLinecap="round",n.wireframeLinejoin="round",n.skinning=!1,n.morphTargets=!1,n.morphNormals=!1,n.setValues(e),n}return st(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},e}(Ue);ss.prototype.isMeshLambertMaterial=!0;var ls=function(t){function e(e){var n;return(n=t.call(this)||this).defines={MATCAP:""},n.type="MeshMatcapMaterial",n.color=new Qe(16777215),n.matcap=null,n.map=null,n.bumpMap=null,n.bumpScale=1,n.normalMap=null,n.normalMapType=0,n.normalScale=new mt(1,1),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.alphaMap=null,n.skinning=!1,n.morphTargets=!1,n.morphNormals=!1,n.flatShading=!1,n.setValues(e),n}return st(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this},e}(Ue);ls.prototype.isMeshMatcapMaterial=!0;var cs=function(t){function e(e){var n;return(n=t.call(this)||this).type="LineDashedMaterial",n.scale=1,n.dashSize=3,n.gapSize=1,n.setValues(e),n}return st(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this},e}(Io);cs.prototype.isLineDashedMaterial=!0;var us=Object.freeze({__proto__:null,ShadowMaterial:ts,SpriteMaterial:$i,RawShaderMaterial:es,ShaderMaterial:Wn,PointsMaterial:Go,MeshPhysicalMaterial:rs,MeshStandardMaterial:ns,MeshPhongMaterial:is,MeshToonMaterial:os,MeshNormalMaterial:as,MeshLambertMaterial:ss,MeshDepthMaterial:Pi,MeshDistanceMaterial:Oi,MeshBasicMaterial:Ze,MeshMatcapMaterial:ls,LineDashedMaterial:cs,LineBasicMaterial:Io,Material:Ue}),ps={arraySlice:function(t,e,n){return ps.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),r=0;r!==e;++r)n[r]=r;return n.sort(function(e,n){return t[e]-t[n]}),n},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*e,l=0;l!==e;++l)i[a++]=t[s+l];return i},flattenJSON:function(t,e,n,r){for(var i=1,o=t[0];void 0!==o&&void 0===o[r];)o=t[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[r])&&(e.push(o.time),n.push.apply(n,a)),o=t[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[r])&&(e.push(o.time),a.toArray(n,n.length)),o=t[i++]}while(void 0!==o);else do{void 0!==(a=o[r])&&(e.push(o.time),n.push(a)),o=t[i++]}while(void 0!==o)}},subclip:function(t,e,n,r,i){void 0===i&&(i=30);var o=t.clone();o.name=e;for(var a=[],s=0;s<o.tracks.length;++s){for(var l=o.tracks[s],c=l.getValueSize(),u=[],p=[],d=0;d<l.times.length;++d){var h=l.times[d]*i;if(!(h<n||h>=r)){u.push(l.times[d]);for(var f=0;f<c;++f)p.push(l.values[d*c+f])}}0!==u.length&&(l.times=ps.convertArray(u,l.times.constructor),l.values=ps.convertArray(p,l.values.constructor),a.push(l))}o.tracks=a;for(var m=1/0,y=0;y<o.tracks.length;++y)m>o.tracks[y].times[0]&&(m=o.tracks[y].times[0]);for(var _=0;_<o.tracks.length;++_)o.tracks[_].shift(-1*m);return o.resetDuration(),o},makeClipAdditive:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=t),void 0===r&&(r=30),r<=0&&(r=30);for(var i=n.tracks.length,o=e/r,a=function(e){var r=n.tracks[e],i=r.ValueTypeName;if("bool"===i||"string"===i)return"continue";var a=t.tracks.find(function(t){return t.name===r.name&&t.ValueTypeName===i});if(void 0===a)return"continue";var s=0,l=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=l/3);var c=0,u=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);var p=r.times.length-1,d=void 0;if(o<=r.times[0]){var h=s,f=l-s;d=ps.arraySlice(r.values,h,f)}else if(o>=r.times[p]){var m=p*l+s,y=m+l-s;d=ps.arraySlice(r.values,m,y)}else{var _=r.createInterpolant(),g=s,v=l-s;_.evaluate(o),d=ps.arraySlice(_.resultBuffer,g,v)}"quaternion"===i&&(new St).fromArray(d).normalize().conjugate().toArray(d);for(var b=a.times.length,x=0;x<b;++x){var w=x*u+c;if("quaternion"===i)St.multiplyQuaternionsFlat(a.values,w,d,0,a.values,w);else for(var E=u-2*c,T=0;T<E;++T)a.values[w+T]-=d[T]}},s=0;s<i;++s)a(s);return t.blendMode=q,t}};function ds(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function hs(t,e,n,r){ds.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function fs(t,e,n,r){ds.call(this,t,e,n,r)}function ms(t,e,n,r){ds.call(this,t,e,n,r)}Object.assign(ds.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{var o;n:{r:if(!(t<r)){for(var a=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===a)break;if(i=r,t<(r=e[++n]))break e}o=e.length;break n}if(t>=i)break t;var s=e[1];t<s&&(n=2,i=s);for(var l=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===l)break;if(r=i,t>=(i=e[--n-1]))break e}o=n,n=0}for(;n<o;){var c=n+o>>>1;t<e[c]?o=c:n=c+1}if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r,o=0;o!==r;++o)e[o]=n[i+o];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(ds.prototype,{beforeStart_:ds.prototype.copySampleValue_,afterEnd_:ds.prototype.copySampleValue_}),hs.prototype=Object.assign(Object.create(ds.prototype),{constructor:hs,DefaultSettings_:{endingStart:U,endingEnd:U},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,o=t+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case V:i=t,a=2*e-n;break;case G:a=e+r[i=r.length-2]-r[i+1];break;default:i=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case V:o=t,s=2*n-e;break;case G:o=1,s=n+r[1]-r[0];break;default:o=t-1,s=e}var l=.5*(n-e),c=this.valueSize;this._weightPrev=l/(e-a),this._weightNext=l/(s-n),this._offsetPrev=i*c,this._offsetNext=o*c},interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,l=s-a,c=this._offsetPrev,u=this._offsetNext,p=this._weightPrev,d=this._weightNext,h=(n-e)/(r-e),f=h*h,m=f*h,y=-p*m+2*p*f-p*h,_=(1+p)*m+(-1.5-2*p)*f+(-.5+p)*h+1,g=(-1-d)*m+(1.5+d)*f+.5*h,v=d*m-d*f,b=0;b!==a;++b)i[b]=y*o[c+b]+_*o[l+b]+g*o[s+b]+v*o[u+b];return i}}),fs.prototype=Object.assign(Object.create(ds.prototype),{constructor:fs,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,l=s-a,c=(n-e)/(r-e),u=1-c,p=0;p!==a;++p)i[p]=o[l+p]*u+o[s+p]*c;return i}}),ms.prototype=Object.assign(Object.create(ds.prototype),{constructor:ms,interpolate_:function(t){return this.copySampleValue_(t-1)}});var ys=function(){function t(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=ps.convertArray(e,this.TimeBufferType),this.values=ps.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}t.toJSON=function(t){var e,n=t.constructor;if(n.toJSON!==this.toJSON)e=n.toJSON(t);else{e={name:t.name,times:ps.convertArray(t.times,Array),values:ps.convertArray(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e};var e=t.prototype;return e.InterpolantFactoryMethodDiscrete=function(t){return new ms(this.times,this.values,this.getValueSize(),t)},e.InterpolantFactoryMethodLinear=function(t){return new fs(this.times,this.values,this.getValueSize(),t)},e.InterpolantFactoryMethodSmooth=function(t){return new hs(this.times,this.values,this.getValueSize(),t)},e.setInterpolation=function(t){var e;switch(t){case H:e=this.InterpolantFactoryMethodDiscrete;break;case F:e=this.InterpolantFactoryMethodLinear;break;case N:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this},e.getInterpolation=function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return H;case this.InterpolantFactoryMethodLinear:return F;case this.InterpolantFactoryMethodSmooth:return N}},e.getValueSize=function(){return this.values.length/this.times.length},e.shift=function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},e.scale=function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},e.trim=function(t,e){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==i||o!==r){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=ps.arraySlice(n,i,o),this.values=ps.arraySlice(this.values,i*a,o*a)}return this},e.validate=function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var o=null,a=0;a!==i;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),t=!1;break}if(null!==o&&o>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),t=!1;break}o=s}if(void 0!==r&&ps.isTypedArray(r))for(var l=0,c=r.length;l!==c;++l){var u=r[l];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,u),t=!1;break}}return t},e.optimize=function(){for(var t=ps.arraySlice(this.times),e=ps.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===N,i=t.length-1,o=1,a=1;a<i;++a){var s=!1,l=t[a];if(l!==t[a+1]&&(1!==a||l!==t[0]))if(r)s=!0;else for(var c=a*n,u=c-n,p=c+n,d=0;d!==n;++d){var h=e[c+d];if(h!==e[u+d]||h!==e[p+d]){s=!0;break}}if(s){if(a!==o){t[o]=t[a];for(var f=a*n,m=o*n,y=0;y!==n;++y)e[m+y]=e[f+y]}++o}}if(i>0){t[o]=t[i];for(var _=i*n,g=o*n,v=0;v!==n;++v)e[g+v]=e[_+v];++o}return o!==t.length?(this.times=ps.arraySlice(t,0,o),this.values=ps.arraySlice(e,0,o*n)):(this.times=t,this.values=e),this},e.clone=function(){var t=ps.arraySlice(this.times,0),e=ps.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n},t}();ys.prototype.TimeBufferType=Float32Array,ys.prototype.ValueBufferType=Float32Array,ys.prototype.DefaultInterpolation=F;var _s=function(t){function e(){return t.apply(this,arguments)||this}return st(e,t),e}(ys);_s.prototype.ValueTypeName="bool",_s.prototype.ValueBufferType=Array,_s.prototype.DefaultInterpolation=H,_s.prototype.InterpolantFactoryMethodLinear=void 0,_s.prototype.InterpolantFactoryMethodSmooth=void 0;var gs=function(t){function e(){return t.apply(this,arguments)||this}return st(e,t),e}(ys);gs.prototype.ValueTypeName="color";var vs=function(t){function e(){return t.apply(this,arguments)||this}return st(e,t),e}(ys);function bs(t,e,n,r){ds.call(this,t,e,n,r)}vs.prototype.ValueTypeName="number",bs.prototype=Object.assign(Object.create(ds.prototype),{constructor:bs,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(n-e)/(r-e),l=t*a,c=l+a;l!==c;l+=4)St.slerpFlat(i,0,o,l-a,o,l,s);return i}});var xs=function(t){function e(){return t.apply(this,arguments)||this}return st(e,t),e.prototype.InterpolantFactoryMethodLinear=function(t){return new bs(this.times,this.values,this.getValueSize(),t)},e}(ys);xs.prototype.ValueTypeName="quaternion",xs.prototype.DefaultInterpolation=F,xs.prototype.InterpolantFactoryMethodSmooth=void 0;var ws=function(t){function e(){return t.apply(this,arguments)||this}return st(e,t),e}(ys);ws.prototype.ValueTypeName="string",ws.prototype.ValueBufferType=Array,ws.prototype.DefaultInterpolation=H,ws.prototype.InterpolantFactoryMethodLinear=void 0,ws.prototype.InterpolantFactoryMethodSmooth=void 0;var Es=function(t){function e(){return t.apply(this,arguments)||this}return st(e,t),e}(ys);Es.prototype.ValueTypeName="vector";var Ts=function(){function t(t,e,n,r){void 0===e&&(e=-1),void 0===r&&(r=W),this.name=t,this.tracks=n,this.duration=e,this.blendMode=r,this.uuid=ft.generateUUID(),this.duration<0&&this.resetDuration()}t.parse=function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,o=n.length;i!==o;++i)e.push(Ss(n[i]).scale(r));var a=new this(t.name,t.duration,e,t.blendMode);return a.uuid=t.uuid,a},t.toJSON=function(t){for(var e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode},i=0,o=n.length;i!==o;++i)e.push(ys.toJSON(n[i]));return r},t.CreateFromMorphTargetSequence=function(t,e,n,r){for(var i=e.length,o=[],a=0;a<i;a++){var s=[],l=[];s.push((a+i-1)%i,a,(a+1)%i),l.push(0,1,0);var c=ps.getKeyframeOrder(s);s=ps.sortedArray(s,1,c),l=ps.sortedArray(l,1,c),r||0!==s[0]||(s.push(i),l.push(l[0])),o.push(new vs(".morphTargetInfluences["+e[a].name+"]",s,l).scale(1/n))}return new this(t,-1,o)},t.findByName=function(t,e){var n=t;if(!Array.isArray(t)){var r=t;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null},t.CreateClipsFromMorphTargetSequences=function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var s=t[o],l=s.name.match(i);if(l&&l.length>1){var c=l[1],u=r[c];u||(r[c]=u=[]),u.push(s)}}var p=[];for(var d in r)p.push(this.CreateFromMorphTargetSequence(d,r[d],e,n));return p},t.parseAnimation=function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,e,n,r,i){if(0!==n.length){var o=[],a=[];ps.flattenJSON(n,o,a,r),0!==o.length&&i.push(new t(e,o,a))}},r=[],i=t.name||"default",o=t.fps||30,a=t.blendMode,s=t.length||-1,l=t.hierarchy||[],c=0;c<l.length;c++){var u=l[c].keys;if(u&&0!==u.length)if(u[0].morphTargets){var p={},d=void 0;for(d=0;d<u.length;d++)if(u[d].morphTargets)for(var h=0;h<u[d].morphTargets.length;h++)p[u[d].morphTargets[h]]=-1;for(var f in p){for(var m=[],y=[],_=0;_!==u[d].morphTargets.length;++_){var g=u[d];m.push(g.time),y.push(g.morphTarget===f?1:0)}r.push(new vs(".morphTargetInfluence["+f+"]",m,y))}s=p.length*(o||1)}else{var v=".bones["+e[c].name+"]";n(Es,v+".position",u,"pos",r),n(xs,v+".quaternion",u,"rot",r),n(Es,v+".scale",u,"scl",r)}}return 0===r.length?null:new this(i,s,r,a)};var e=t.prototype;return e.resetDuration=function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this},e.trim=function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},e.validate=function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},e.optimize=function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},e.clone=function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)},e.toJSON=function(){return this.constructor.toJSON(this)},t}();function Ss(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return vs;case"vector":case"vector2":case"vector3":case"vector4":return Es;case"color":return gs;case"quaternion":return xs;case"bool":case"boolean":return _s;case"string":return ws}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){var n=[],r=[];ps.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}var Ms={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function js(t,e,n){var r=this,i=!1,o=0,a=0,s=void 0,l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===i&&void 0!==r.onStart&&r.onStart(t,o,a),i=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){var e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(var e=0,n=l.length;e<n;e+=2){var r=l[e],i=l[e+1];if(r.global&&(r.lastIndex=0),r.test(t))return i}return null}}var Cs=new js;function zs(t){this.manager=void 0!==t?t:Cs,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(zs.prototype,{load:function(){},loadAsync:function(t,e){var n=this;return new Promise(function(r,i){n.load(t,r,e,i)})},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});var Rs={};function As(t){zs.call(this,t)}As.prototype=Object.assign(Object.create(zs.prototype),{constructor:As,load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=Ms.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;if(void 0===Rs[t]){var a,s=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var l=s[1],c=!!s[2],u=s[3];u=decodeURIComponent(u),c&&(u=atob(u));try{var p,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":for(var h=new Uint8Array(u.length),f=0;f<u.length;f++)h[f]=u.charCodeAt(f);p="blob"===d?new Blob([h.buffer],{type:l}):h.buffer;break;case"document":var m=new DOMParser;p=m.parseFromString(u,l);break;case"json":p=JSON.parse(u);break;default:p=u}setTimeout(function(){e&&e(p),i.manager.itemEnd(t)},0)}catch(e){setTimeout(function(){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)},0)}}else{for(var y in Rs[t]=[],Rs[t].push({onLoad:e,onProgress:n,onError:r}),(a=new XMLHttpRequest).open("GET",t,!0),a.addEventListener("load",function(e){var n=this.response,r=Rs[t];if(delete Rs[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Ms.add(t,n);for(var o=0,a=r.length;o<a;o++){var s=r[o];s.onLoad&&s.onLoad(n)}i.manager.itemEnd(t)}else{for(var l=0,c=r.length;l<c;l++){var u=r[l];u.onError&&u.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}},!1),a.addEventListener("progress",function(e){for(var n=Rs[t],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(e)}},!1),a.addEventListener("error",function(e){var n=Rs[t];delete Rs[t];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)},!1),a.addEventListener("abort",function(e){var n=Rs[t];delete Rs[t];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)},!1),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.overrideMimeType&&a.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)a.setRequestHeader(y,this.requestHeader[y]);a.send(null)}return i.manager.itemStart(t),a}Rs[t].push({onLoad:e,onProgress:n,onError:r})},setResponseType:function(t){return this.responseType=t,this},setMimeType:function(t){return this.mimeType=t,this}});var Ls=function(t){function e(e){return t.call(this,e)||this}st(e,t);var n=e.prototype;return n.load=function(t,e,n,r){var i=this,o=new As(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,function(n){try{e(i.parse(JSON.parse(n)))}catch(e){r?r(e):console.error(e),i.manager.itemError(t)}},n,r)},n.parse=function(t){for(var e=[],n=0;n<t.length;n++){var r=Ts.parse(t[n]);e.push(r)}return e},e}(zs);function Is(t){zs.call(this,t)}Is.prototype=Object.assign(Object.create(zs.prototype),{constructor:Is,load:function(t,e,n,r){var i=this,o=[],a=new Ko,s=new As(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(i.withCredentials);var l=0;function c(c){s.load(t[c],function(t){var n=i.parse(t,!0);o[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(l+=1)&&(1===n.mipmapCount&&(a.minFilter=_),a.image=o,a.format=n.format,a.needsUpdate=!0,e&&e(a))},n,r)}if(Array.isArray(t))for(var u=0,p=t.length;u<p;++u)c(u);else s.load(t,function(t){var n=i.parse(t,!0);if(n.isCubemap){for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){o[s]={mipmaps:[]};for(var l=0;l<n.mipmapCount;l++)o[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+l]),o[s].format=n.format,o[s].width=n.width,o[s].height=n.height}a.image=o}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=_),a.format=n.format,a.needsUpdate=!0,e&&e(a)},n,r);return a}});var Ps=function(t){function e(e){return t.call(this,e)||this}return st(e,t),e.prototype.load=function(t,e,n,r){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=Ms.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",l,!1),Ms.add(t,this),e&&e(this),i.manager.itemEnd(t)}function l(e){a.removeEventListener("load",s,!1),a.removeEventListener("error",l,!1),r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}return a.addEventListener("load",s,!1),a.addEventListener("error",l,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(t),a.src=t,a},e}(zs),Os=function(t){function e(e){return t.call(this,e)||this}return st(e,t),e.prototype.load=function(t,e,n,r){var i=new Zn,o=new Ps(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(n){o.load(t[n],function(t){i.images[n]=t,6==++a&&(i.needsUpdate=!0,e&&e(i))},void 0,r)}for(var l=0;l<t.length;++l)s(l);return i},e}(zs);function ks(t){zs.call(this,t)}function Bs(t){zs.call(this,t)}function Ds(){this.type="Curve",this.arcLengthDivisions=200}ks.prototype=Object.assign(Object.create(zs.prototype),{constructor:ks,load:function(t,e,n,r){var i=this,o=new Kn,a=new As(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(i.withCredentials),a.load(t,function(t){var n=i.parse(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:d,o.wrapT=void 0!==n.wrapT?n.wrapT:d,o.magFilter=void 0!==n.magFilter?n.magFilter:_,o.minFilter=void 0!==n.minFilter?n.minFilter:_,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(o.encoding=n.encoding),void 0!==n.flipY&&(o.flipY=n.flipY),void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=g),1===n.mipmapCount&&(o.minFilter=_),o.needsUpdate=!0,e&&e(o,n))},n,r),o}}),Bs.prototype=Object.assign(Object.create(zs.prototype),{constructor:Bs,load:function(t,e,n,r){var i=new bt,o=new Ps(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,function(n){i.image=n;var r=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);i.format=r?S:M,i.needsUpdate=!0,void 0!==e&&e(i)},n,r),i}}),Object.assign(Ds.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n=[],r=this.getPoint(0),i=0;n.push(0);for(var o=1;o<=t;o++)i+=(e=this.getPoint(o/t)).distanceTo(r),n.push(i),r=e;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,r=this.getLengths(),i=0,o=r.length;n=e||t*r[o-1];for(var a,s=0,l=o-1;s<=l;)if((a=r[i=Math.floor(s+(l-s)/2)]-n)<0)s=i+1;else{if(!(a>0)){l=i;break}l=i-1}if(r[i=l]===n)return i/(o-1);var c=r[i];return(i+(n-c)/(r[i+1]-c))/(o-1)},getTangent:function(t,e){var n=t-1e-4,r=t+1e-4;n<0&&(n=0),r>1&&(r=1);var i=this.getPoint(n),o=this.getPoint(r),a=e||(i.isVector2?new mt:new Mt);return a.copy(o).sub(i).normalize(),a},getTangentAt:function(t,e){var n=this.getUtoTmapping(t);return this.getTangent(n,e)},computeFrenetFrames:function(t,e){for(var n=new Mt,r=[],i=[],o=[],a=new Mt,s=new te,l=0;l<=t;l++){var c=l/t;r[l]=this.getTangentAt(c,new Mt),r[l].normalize()}i[0]=new Mt,o[0]=new Mt;var u=Number.MAX_VALUE,p=Math.abs(r[0].x),d=Math.abs(r[0].y),h=Math.abs(r[0].z);p<=u&&(u=p,n.set(1,0,0)),d<=u&&(u=d,n.set(0,1,0)),h<=u&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],a),o[0].crossVectors(r[0],i[0]);for(var f=1;f<=t;f++){if(i[f]=i[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();var m=Math.acos(ft.clamp(r[f-1].dot(r[f]),-1,1));i[f].applyMatrix4(s.makeRotationAxis(a,m))}o[f].crossVectors(r[f],i[f])}if(!0===e){var y=Math.acos(ft.clamp(i[0].dot(i[t]),-1,1));y/=t,r[0].dot(a.crossVectors(i[0],i[t]))>0&&(y=-y);for(var _=1;_<=t;_++)i[_].applyMatrix4(s.makeRotationAxis(r[_],y*_)),o[_].crossVectors(r[_],i[_])}return{tangents:r,normals:i,binormals:o}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}});var Hs=function(t){function e(e,n,r,i,o,a,s,l){var c;return void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===o&&(o=0),void 0===a&&(a=2*Math.PI),void 0===s&&(s=!1),void 0===l&&(l=0),(c=t.call(this)||this).type="EllipseCurve",c.aX=e,c.aY=n,c.xRadius=r,c.yRadius=i,c.aStartAngle=o,c.aEndAngle=a,c.aClockwise=s,c.aRotation=l,c}st(e,t);var n=e.prototype;return n.getPoint=function(t,e){for(var n=e||new mt,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);var a=this.aStartAngle+t*i,s=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var c=Math.cos(this.aRotation),u=Math.sin(this.aRotation),p=s-this.aX,d=l-this.aY;s=p*c-d*u+this.aX,l=p*u+d*c+this.aY}return n.set(s,l)},n.copy=function(e){return t.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},n.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},n.fromJSON=function(e){return t.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},e}(Ds);Hs.prototype.isEllipseCurve=!0;var Fs=function(t){function e(e,n,r,i,o,a){var s;return(s=t.call(this,e,n,r,r,i,o,a)||this).type="ArcCurve",s}return st(e,t),e}(Hs);function Ns(){var t=0,e=0,n=0,r=0;function i(i,o,a,s){t=i,e=a,n=-3*i+3*o-2*a-s,r=2*i-2*o+a+s}return{initCatmullRom:function(t,e,n,r,o){i(e,n,o*(n-t),o*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,o,a,s){var l=(e-t)/o-(n-t)/(o+a)+(n-e)/a,c=(n-e)/a-(r-e)/(a+s)+(r-n)/s;i(e,n,l*=a,c*=a)},calc:function(i){var o=i*i;return t+e*i+n*o+r*(o*i)}}}Fs.prototype.isArcCurve=!0;var Us=new Mt,Vs=new Ns,Gs=new Ns,Ws=new Ns,qs=function(t){function e(e,n,r,i){var o;return void 0===e&&(e=[]),void 0===n&&(n=!1),void 0===r&&(r="centripetal"),void 0===i&&(i=.5),(o=t.call(this)||this).type="CatmullRomCurve3",o.points=e,o.closed=n,o.curveType=r,o.tension=i,o}st(e,t);var n=e.prototype;return n.getPoint=function(t,e){void 0===e&&(e=new Mt);var n,r,i=e,o=this.points,a=o.length,s=(a-(this.closed?0:1))*t,l=Math.floor(s),c=s-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/a)+1)*a:0===c&&l===a-1&&(l=a-2,c=1),this.closed||l>0?n=o[(l-1)%a]:(Us.subVectors(o[0],o[1]).add(o[0]),n=Us);var u=o[l%a],p=o[(l+1)%a];if(this.closed||l+2<a?r=o[(l+2)%a]:(Us.subVectors(o[a-1],o[a-2]).add(o[a-1]),r=Us),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,h=Math.pow(n.distanceToSquared(u),d),f=Math.pow(u.distanceToSquared(p),d),m=Math.pow(p.distanceToSquared(r),d);f<1e-4&&(f=1),h<1e-4&&(h=f),m<1e-4&&(m=f),Vs.initNonuniformCatmullRom(n.x,u.x,p.x,r.x,h,f,m),Gs.initNonuniformCatmullRom(n.y,u.y,p.y,r.y,h,f,m),Ws.initNonuniformCatmullRom(n.z,u.z,p.z,r.z,h,f,m)}else"catmullrom"===this.curveType&&(Vs.initCatmullRom(n.x,u.x,p.x,r.x,this.tension),Gs.initCatmullRom(n.y,u.y,p.y,r.y,this.tension),Ws.initCatmullRom(n.z,u.z,p.z,r.z,this.tension));return i.set(Vs.calc(c),Gs.calc(c),Ws.calc(c)),i},n.copy=function(e){t.prototype.copy.call(this,e),this.points=[];for(var n=0,r=e.points.length;n<r;n++){var i=e.points[n];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},n.toJSON=function(){var e=t.prototype.toJSON.call(this);e.points=[];for(var n=0,r=this.points.length;n<r;n++){var i=this.points[n];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},n.fromJSON=function(e){t.prototype.fromJSON.call(this,e),this.points=[];for(var n=0,r=e.points.length;n<r;n++){var i=e.points[n];this.points.push((new Mt).fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},e}(Ds);function Xs(t,e,n,r,i){var o=.5*(r-e),a=.5*(i-n),s=t*t;return(2*n-2*r+o+a)*(t*s)+(-3*n+3*r-2*o-a)*s+o*t+n}function Ys(t,e,n,r){return function(t,e){var n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*n}(t)+function(t,e){return t*t*r}(t)}function Qs(t,e,n,r,i){return function(t,e){var n=1-t;return n*n*n*e}(t,e)+function(t,e){var n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*r}(t)+function(t,e){return t*t*t*i}(t)}qs.prototype.isCatmullRomCurve3=!0;var Zs=function(t){function e(e,n,r,i){var o;return void 0===e&&(e=new mt),void 0===n&&(n=new mt),void 0===r&&(r=new mt),void 0===i&&(i=new mt),(o=t.call(this)||this).type="CubicBezierCurve",o.v0=e,o.v1=n,o.v2=r,o.v3=i,o}st(e,t);var n=e.prototype;return n.getPoint=function(t,e){void 0===e&&(e=new mt);var n=e,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Qs(t,r.x,i.x,o.x,a.x),Qs(t,r.y,i.y,o.y,a.y)),n},n.copy=function(e){return t.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},n.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},n.fromJSON=function(e){return t.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},e}(Ds);Zs.prototype.isCubicBezierCurve=!0;var Js=function(t){function e(e,n,r,i){var o;return void 0===e&&(e=new Mt),void 0===n&&(n=new Mt),void 0===r&&(r=new Mt),void 0===i&&(i=new Mt),(o=t.call(this)||this).type="CubicBezierCurve3",o.v0=e,o.v1=n,o.v2=r,o.v3=i,o}st(e,t);var n=e.prototype;return n.getPoint=function(t,e){void 0===e&&(e=new Mt);var n=e,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Qs(t,r.x,i.x,o.x,a.x),Qs(t,r.y,i.y,o.y,a.y),Qs(t,r.z,i.z,o.z,a.z)),n},n.copy=function(e){return t.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},n.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},n.fromJSON=function(e){return t.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},e}(Ds);Js.prototype.isCubicBezierCurve3=!0;var Ks=function(t){function e(e,n){var r;return void 0===e&&(e=new mt),void 0===n&&(n=new mt),(r=t.call(this)||this).type="LineCurve",r.v1=e,r.v2=n,r}st(e,t);var n=e.prototype;return n.getPoint=function(t,e){void 0===e&&(e=new mt);var n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},n.getPointAt=function(t,e){return this.getPoint(t,e)},n.getTangent=function(t,e){var n=e||new mt;return n.copy(this.v2).sub(this.v1).normalize(),n},n.copy=function(e){return t.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},n.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},n.fromJSON=function(e){return t.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},e}(Ds);Ks.prototype.isLineCurve=!0;var $s=function(t){function e(e,n){var r;return void 0===e&&(e=new Mt),void 0===n&&(n=new Mt),(r=t.call(this)||this).type="LineCurve3",r.isLineCurve3=!0,r.v1=e,r.v2=n,r}st(e,t);var n=e.prototype;return n.getPoint=function(t,e){void 0===e&&(e=new Mt);var n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},n.getPointAt=function(t,e){return this.getPoint(t,e)},n.copy=function(e){return t.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},n.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},n.fromJSON=function(e){return t.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},e}(Ds),tl=function(t){function e(e,n,r){var i;return void 0===e&&(e=new mt),void 0===n&&(n=new mt),void 0===r&&(r=new mt),(i=t.call(this)||this).type="QuadraticBezierCurve",i.v0=e,i.v1=n,i.v2=r,i}st(e,t);var n=e.prototype;return n.getPoint=function(t,e){void 0===e&&(e=new mt);var n=e,r=this.v0,i=this.v1,o=this.v2;return n.set(Ys(t,r.x,i.x,o.x),Ys(t,r.y,i.y,o.y)),n},n.copy=function(e){return t.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},n.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},n.fromJSON=function(e){return t.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},e}(Ds);tl.prototype.isQuadraticBezierCurve=!0;var el=function(t){function e(e,n,r){var i;return void 0===e&&(e=new Mt),void 0===n&&(n=new Mt),void 0===r&&(r=new Mt),(i=t.call(this)||this).type="QuadraticBezierCurve3",i.v0=e,i.v1=n,i.v2=r,i}st(e,t);var n=e.prototype;return n.getPoint=function(t,e){void 0===e&&(e=new Mt);var n=e,r=this.v0,i=this.v1,o=this.v2;return n.set(Ys(t,r.x,i.x,o.x),Ys(t,r.y,i.y,o.y),Ys(t,r.z,i.z,o.z)),n},n.copy=function(e){return t.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},n.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},n.fromJSON=function(e){return t.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},e}(Ds);el.prototype.isQuadraticBezierCurve3=!0;var nl=function(t){function e(e){var n;return void 0===e&&(e=[]),(n=t.call(this)||this).type="SplineCurve",n.points=e,n}st(e,t);var n=e.prototype;return n.getPoint=function(t,e){void 0===e&&(e=new mt);var n=e,r=this.points,i=(r.length-1)*t,o=Math.floor(i),a=i-o,s=r[0===o?o:o-1],l=r[o],c=r[o>r.length-2?r.length-1:o+1],u=r[o>r.length-3?r.length-1:o+2];return n.set(Xs(a,s.x,l.x,c.x,u.x),Xs(a,s.y,l.y,c.y,u.y)),n},n.copy=function(e){t.prototype.copy.call(this,e),this.points=[];for(var n=0,r=e.points.length;n<r;n++){var i=e.points[n];this.points.push(i.clone())}return this},n.toJSON=function(){var e=t.prototype.toJSON.call(this);e.points=[];for(var n=0,r=this.points.length;n<r;n++){var i=this.points[n];e.points.push(i.toArray())}return e},n.fromJSON=function(e){t.prototype.fromJSON.call(this,e),this.points=[];for(var n=0,r=e.points.length;n<r;n++){var i=e.points[n];this.points.push((new mt).fromArray(i))}return this},e}(Ds);nl.prototype.isSplineCurve=!0;var rl=Object.freeze({__proto__:null,ArcCurve:Fs,CatmullRomCurve3:qs,CubicBezierCurve:Zs,CubicBezierCurve3:Js,EllipseCurve:Hs,LineCurve:Ks,LineCurve3:$s,QuadraticBezierCurve:tl,QuadraticBezierCurve3:el,SplineCurve:nl}),il=function(t){function e(){var e;return(e=t.call(this)||this).type="CurvePath",e.curves=[],e.autoClose=!1,e}st(e,t);var n=e.prototype;return n.add=function(t){this.curves.push(t)},n.closePath=function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Ks(e,t))},n.getPoint=function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=e){var i=n[r]-e,o=this.curves[r],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}r++}return null},n.getLength=function(){var t=this.getCurveLengths();return t[t.length-1]},n.updateArcLengths=function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},n.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},n.getSpacedPoints=function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},n.getPoints=function(t){void 0===t&&(t=12);for(var e,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],a=o&&o.isEllipseCurve?2*t:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a),l=0;l<s.length;l++){var c=s[l];e&&e.equals(c)||(n.push(c),e=c)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},n.copy=function(e){t.prototype.copy.call(this,e),this.curves=[];for(var n=0,r=e.curves.length;n<r;n++){var i=e.curves[n];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this},n.toJSON=function(){var e=t.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var n=0,r=this.curves.length;n<r;n++){var i=this.curves[n];e.curves.push(i.toJSON())}return e},n.fromJSON=function(e){t.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var n=0,r=e.curves.length;n<r;n++){var i=e.curves[n];this.curves.push((new rl[i.type]).fromJSON(i))}return this},e}(Ds),ol=function(t){function e(e){var n;return(n=t.call(this)||this).type="Path",n.currentPoint=new mt,e&&n.setFromPoints(e),n}st(e,t);var n=e.prototype;return n.setFromPoints=function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this},n.moveTo=function(t,e){return this.currentPoint.set(t,e),this},n.lineTo=function(t,e){var n=new Ks(this.currentPoint.clone(),new mt(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this},n.quadraticCurveTo=function(t,e,n,r){var i=new tl(this.currentPoint.clone(),new mt(t,e),new mt(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this},n.bezierCurveTo=function(t,e,n,r,i,o){var a=new Zs(this.currentPoint.clone(),new mt(t,e),new mt(n,r),new mt(i,o));return this.curves.push(a),this.currentPoint.set(i,o),this},n.splineThru=function(t){var e=[this.currentPoint.clone()].concat(t),n=new nl(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this},n.arc=function(t,e,n,r,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+a,e+s,n,r,i,o),this},n.absarc=function(t,e,n,r,i,o){return this.absellipse(t,e,n,n,r,i,o),this},n.ellipse=function(t,e,n,r,i,o,a,s){var l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+l,e+c,n,r,i,o,a,s),this},n.absellipse=function(t,e,n,r,i,o,a,s){var l=new Hs(t,e,n,r,i,o,a,s);if(this.curves.length>0){var c=l.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(l);var u=l.getPoint(1);return this.currentPoint.copy(u),this},n.copy=function(e){return t.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},n.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},n.fromJSON=function(e){return t.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this},e}(il),al=function(t){function e(e){var n;return(n=t.call(this,e)||this).uuid=ft.generateUUID(),n.type="Shape",n.holes=[],n}st(e,t);var n=e.prototype;return n.getPointsHoles=function(t){for(var e=[],n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e},n.extractPoints=function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},n.copy=function(e){t.prototype.copy.call(this,e),this.holes=[];for(var n=0,r=e.holes.length;n<r;n++){var i=e.holes[n];this.holes.push(i.clone())}return this},n.toJSON=function(){var e=t.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var n=0,r=this.holes.length;n<r;n++){var i=this.holes[n];e.holes.push(i.toJSON())}return e},n.fromJSON=function(e){t.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var n=0,r=e.holes.length;n<r;n++){var i=e.holes[n];this.holes.push((new ol).fromJSON(i))}return this},e}(ol),sl=function(t){function e(e,n){var r;return void 0===n&&(n=1),(r=t.call(this)||this).type="Light",r.color=new Qe(e),r.intensity=n,r}st(e,t);var n=e.prototype;return n.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},n.toJSON=function(e){var n=t.prototype.toJSON.call(this,e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,void 0!==this.groundColor&&(n.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(n.object.distance=this.distance),void 0!==this.angle&&(n.object.angle=this.angle),void 0!==this.decay&&(n.object.decay=this.decay),void 0!==this.penumbra&&(n.object.penumbra=this.penumbra),void 0!==this.shadow&&(n.object.shadow=this.shadow.toJSON()),n},e}(Se);sl.prototype.isLight=!0;var ll=function(t){function e(e,n,r){var i;return(i=t.call(this,e,r)||this).type="HemisphereLight",i.position.copy(Se.DefaultUp),i.updateMatrix(),i.groundColor=new Qe(n),i}return st(e,t),e.prototype.copy=function(t){return sl.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this},e}(sl);ll.prototype.isHemisphereLight=!0;var cl=new te,ul=new Mt,pl=new Mt,dl=function(){function t(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new mt(512,512),this.map=null,this.mapPass=null,this.matrix=new te,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new er,this._frameExtents=new mt(1,1),this._viewportCount=1,this._viewports=[new wt(0,0,1,1)]}var e=t.prototype;return e.getViewportCount=function(){return this._viewportCount},e.getFrustum=function(){return this._frustum},e.updateMatrices=function(t){var e=this.camera,n=this.matrix;ul.setFromMatrixPosition(t.matrixWorld),e.position.copy(ul),pl.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(pl),e.updateMatrixWorld(),cl.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(cl),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)},e.getViewport=function(t){return this._viewports[t]},e.getFrameExtents=function(){return this._frameExtents},e.copy=function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},e.clone=function(){return(new this.constructor).copy(this)},e.toJSON=function(){var t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t},t}(),hl=function(t){function e(){var e;return(e=t.call(this,new Xn(50,1,.5,500))||this).focus=1,e}return st(e,t),e.prototype.updateMatrices=function(e){var n=this.camera,r=2*ft.RAD2DEG*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,o=e.distance||n.far;r===n.fov&&i===n.aspect&&o===n.far||(n.fov=r,n.aspect=i,n.far=o,n.updateProjectionMatrix()),t.prototype.updateMatrices.call(this,e)},e}(dl);hl.prototype.isSpotLightShadow=!0;var fl=function(t){function e(e,n,r,i,o,a){var s;return void 0===r&&(r=0),void 0===i&&(i=Math.PI/3),void 0===o&&(o=0),void 0===a&&(a=1),(s=t.call(this,e,n)||this).type="SpotLight",s.position.copy(Se.DefaultUp),s.updateMatrix(),s.target=new Se,s.distance=r,s.angle=i,s.penumbra=o,s.decay=a,s.shadow=new hl,s}return st(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this},at(e,[{key:"power",get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}]),e}(sl);fl.prototype.isSpotLight=!0;var ml=new te,yl=new Mt,_l=new Mt,gl=function(t){function e(){var e;return(e=t.call(this,new Xn(90,1,.5,500))||this)._frameExtents=new mt(4,2),e._viewportCount=6,e._viewports=[new wt(2,1,1,1),new wt(0,1,1,1),new wt(3,1,1,1),new wt(1,1,1,1),new wt(3,0,1,1),new wt(1,0,1,1)],e._cubeDirections=[new Mt(1,0,0),new Mt(-1,0,0),new Mt(0,0,1),new Mt(0,0,-1),new Mt(0,1,0),new Mt(0,-1,0)],e._cubeUps=[new Mt(0,1,0),new Mt(0,1,0),new Mt(0,1,0),new Mt(0,1,0),new Mt(0,0,1),new Mt(0,0,-1)],e}return st(e,t),e.prototype.updateMatrices=function(t,e){void 0===e&&(e=0);var n=this.camera,r=this.matrix;yl.setFromMatrixPosition(t.matrixWorld),n.position.copy(yl),_l.copy(n.position),_l.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(_l),n.updateMatrixWorld(),r.makeTranslation(-yl.x,-yl.y,-yl.z),ml.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ml)},e}(dl);gl.prototype.isPointLightShadow=!0;var vl=function(t){function e(e,n,r,i){var o;return void 0===r&&(r=0),void 0===i&&(i=1),(o=t.call(this,e,n)||this).type="PointLight",o.distance=r,o.decay=i,o.shadow=new gl,o}return st(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this},at(e,[{key:"power",get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}]),e}(sl);vl.prototype.isPointLight=!0;var bl=function(t){function e(e,n,r,i,o,a){var s;return void 0===e&&(e=-1),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=-1),void 0===o&&(o=.1),void 0===a&&(a=2e3),(s=t.call(this)||this).type="OrthographicCamera",s.zoom=1,s.view=null,s.left=e,s.right=n,s.top=r,s.bottom=i,s.near=o,s.far=a,s.updateProjectionMatrix(),s}st(e,t);var n=e.prototype;return n.copy=function(e,n){return t.prototype.copy.call(this,e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},n.setViewOffset=function(t,e,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},n.clearViewOffset=function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},n.updateProjectionMatrix=function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-t,o=n+t,a=r+e,s=r-e;if(null!==this.view&&this.view.enabled){var l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o=(i+=l*this.view.offsetX)+l*this.view.width,s=(a-=c*this.view.offsetY)-c*this.view.height}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},n.toJSON=function(t){var e=Se.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e},e}(qn);bl.prototype.isOrthographicCamera=!0;var xl=function(t){function e(){return t.call(this,new bl(-5,5,5,-5,.5,500))||this}return st(e,t),e}(dl);xl.prototype.isDirectionalLightShadow=!0;var wl=function(t){function e(e,n){var r;return(r=t.call(this,e,n)||this).type="DirectionalLight",r.position.copy(Se.DefaultUp),r.updateMatrix(),r.target=new Se,r.shadow=new xl,r}return st(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this},e}(sl);wl.prototype.isDirectionalLight=!0;var El=function(t){function e(e,n){var r;return(r=t.call(this,e,n)||this).type="AmbientLight",r}return st(e,t),e}(sl);El.prototype.isAmbientLight=!0;var Tl=function(t){function e(e,n,r,i){var o;return void 0===r&&(r=10),void 0===i&&(i=10),(o=t.call(this,e,n)||this).type="RectAreaLight",o.width=r,o.height=i,o}st(e,t);var n=e.prototype;return n.copy=function(e){return t.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},n.toJSON=function(e){var n=t.prototype.toJSON.call(this,e);return n.object.width=this.width,n.object.height=this.height,n},e}(sl);Tl.prototype.isRectAreaLight=!0;var Sl=function(){function t(){this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new Mt)}var e=t.prototype;return e.set=function(t){for(var e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this},e.zero=function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},e.getAt=function(t,e){var n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.282095),e.addScaledVector(o[1],.488603*r),e.addScaledVector(o[2],.488603*i),e.addScaledVector(o[3],.488603*n),e.addScaledVector(o[4],n*r*1.092548),e.addScaledVector(o[5],r*i*1.092548),e.addScaledVector(o[6],.315392*(3*i*i-1)),e.addScaledVector(o[7],n*i*1.092548),e.addScaledVector(o[8],.546274*(n*n-r*r)),e},e.getIrradianceAt=function(t,e){var n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.886227),e.addScaledVector(o[1],1.023328*r),e.addScaledVector(o[2],1.023328*i),e.addScaledVector(o[3],1.023328*n),e.addScaledVector(o[4],.858086*n*r),e.addScaledVector(o[5],.858086*r*i),e.addScaledVector(o[6],.743125*i*i-.247708),e.addScaledVector(o[7],.858086*n*i),e.addScaledVector(o[8],.429043*(n*n-r*r)),e},e.add=function(t){for(var e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this},e.addScaledSH=function(t,e){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this},e.scale=function(t){for(var e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this},e.lerp=function(t,e){for(var n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this},e.equals=function(t){for(var e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0},e.copy=function(t){return this.set(t.coefficients)},e.clone=function(){return(new this.constructor).copy(this)},e.fromArray=function(t,e){void 0===e&&(e=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this},e.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].toArray(t,e+3*r);return t},t.getBasisAt=function(t,e){var n=t.x,r=t.y,i=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*i,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*i,e[6]=.315392*(3*i*i-1),e[7]=1.092548*n*i,e[8]=.546274*(n*n-r*r)},t}();Sl.prototype.isSphericalHarmonics3=!0;var Ml=function(t){function e(e,n){var r;return void 0===e&&(e=new Sl),void 0===n&&(n=1),(r=t.call(this,void 0,n)||this).sh=e,r}st(e,t);var n=e.prototype;return n.copy=function(e){return t.prototype.copy.call(this,e),this.sh.copy(e.sh),this},n.fromJSON=function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},n.toJSON=function(e){var n=t.prototype.toJSON.call(this,e);return n.object.sh=this.sh.toArray(),n},e}(sl);Ml.prototype.isLightProbe=!0;var jl=function(t){function e(e){var n;return(n=t.call(this,e)||this).textures={},n}st(e,t);var n=e.prototype;return n.load=function(t,e,n,r){var i=this,o=new As(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(t,function(n){try{e(i.parse(JSON.parse(n)))}catch(e){r?r(e):console.error(e),i.manager.itemError(t)}},n,r)},n.parse=function(t){var e=this.textures;function n(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}var r=new us[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&void 0!==r.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.sheen&&(r.sheen=(new Qe).setHex(t.sheen)),void 0!==t.emissive&&void 0!==r.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&void 0!==r.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearcoat&&(r.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(r.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.combine&&(r.combine=t.combine),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(r.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(r.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(r.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(r.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(r.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(r.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(r.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(r.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(r.morphNormals=t.morphNormals),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.vertexTangents&&(r.vertexTangents=t.vertexTangents),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.toneMapped&&(r.toneMapped=t.toneMapped),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.vertexColors&&("number"==typeof t.vertexColors?r.vertexColors=t.vertexColors>0:r.vertexColors=t.vertexColors),void 0!==t.uniforms)for(var i in t.uniforms){var o=t.uniforms[i];switch(r.uniforms[i]={},o.type){case"t":r.uniforms[i].value=n(o.value);break;case"c":r.uniforms[i].value=(new Qe).setHex(o.value);break;case"v2":r.uniforms[i].value=(new mt).fromArray(o.value);break;case"v3":r.uniforms[i].value=(new Mt).fromArray(o.value);break;case"v4":r.uniforms[i].value=(new wt).fromArray(o.value);break;case"m3":r.uniforms[i].value=(new _t).fromArray(o.value);break;case"m4":r.uniforms[i].value=(new te).fromArray(o.value);break;default:r.uniforms[i].value=o.value}}if(void 0!==t.defines&&(r.defines=t.defines),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var a in t.extensions)r.extensions[a]=t.extensions[a];if(void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.matcap&&(r.matcap=n(t.matcap)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(r.normalMapType=t.normalMapType),void 0!==t.normalScale){var s=t.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new mt).fromArray(s)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(r.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(r.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(r.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(r.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(r.clearcoatNormalScale=(new mt).fromArray(t.clearcoatNormalScale)),void 0!==t.transmission&&(r.transmission=t.transmission),void 0!==t.transmissionMap&&(r.transmissionMap=n(t.transmissionMap)),r},n.setTextures=function(t){return this.textures=t,this},e}(zs),Cl={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(t){return e}},extractUrlBase:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}};function zl(){xn.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Rl(t,e,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),$e.call(this,t,e,n),this.meshPerAttribute=r||1}zl.prototype=Object.assign(Object.create(xn.prototype),{constructor:zl,isInstancedBufferGeometry:!0,copy:function(t){return xn.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t=xn.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}),Rl.prototype=Object.assign(Object.create($e.prototype),{constructor:Rl,isInstancedBufferAttribute:!0,copy:function(t){return $e.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=$e.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}});var Al=function(t){function e(e){return t.call(this,e)||this}st(e,t);var n=e.prototype;return n.load=function(t,e,n,r){var i=this,o=new As(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(t,function(n){try{e(i.parse(JSON.parse(n)))}catch(e){r?r(e):console.error(e),i.manager.itemError(t)}},n,r)},n.parse=function(t){var e={},n={};function r(t,r){if(void 0!==e[r])return e[r];var i=t.interleavedBuffers[r],o=function(t,e){if(void 0!==n[e])return n[e];var r=t.arrayBuffers[e],i=new Uint32Array(r).buffer;return n[e]=i,i}(t,i.buffer),a=new Qi(hn(i.type,o),i.stride);return a.uuid=i.uuid,e[r]=a,a}var i=t.isInstancedBufferGeometry?new zl:new xn,o=t.data.index;if(void 0!==o){var a=hn(o.type,o.array);i.setIndex(new $e(a,1))}var s=t.data.attributes;for(var l in s){var c=s[l],u=void 0;if(c.isInterleavedBufferAttribute)u=new Ji(r(t.data,c.data),c.itemSize,c.offset,c.normalized);else{var p=hn(c.type,c.array);u=new(c.isInstancedBufferAttribute?Rl:$e)(p,c.itemSize,c.normalized)}void 0!==c.name&&(u.name=c.name),i.setAttribute(l,u)}var d=t.data.morphAttributes;if(d)for(var h in d){for(var f=d[h],m=[],y=0,_=f.length;y<_;y++){var g=f[y],v=void 0;v=g.isInterleavedBufferAttribute?new Ji(r(t.data,g.data),g.itemSize,g.offset,g.normalized):new $e(hn(g.type,g.array),g.itemSize,g.normalized),void 0!==g.name&&(v.name=g.name),m.push(v)}i.morphAttributes[h]=m}t.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);var b=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==b)for(var x=0,w=b.length;x!==w;++x){var E=b[x];i.addGroup(E.start,E.count,E.materialIndex)}var T=t.data.boundingSphere;if(void 0!==T){var S=new Mt;void 0!==T.center&&S.fromArray(T.center),i.boundingSphere=new Wt(S,T.radius)}return t.name&&(i.name=t.name),t.userData&&(i.userData=t.userData),i},e}(zs),Ll=function(t){function e(e){return t.call(this,e)||this}st(e,t);var n=e.prototype;return n.load=function(t,e,n,r){var i=this,o=""===this.path?Cl.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||o;var a=new As(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,function(n){var o=null;try{o=JSON.parse(n)}catch(e){return void 0!==r&&r(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,e):console.error("THREE.ObjectLoader: Can't load "+t)},n,r)},n.parse=function(t,e){var n=this.parseAnimations(t.animations),r=this.parseShapes(t.shapes),i=this.parseGeometries(t.geometries,r),o=this.parseImages(t.images,function(){void 0!==e&&e(l)}),a=this.parseTextures(t.textures,o),s=this.parseMaterials(t.materials,a),l=this.parseObject(t.object,i,s,n),c=this.parseSkeletons(t.skeletons,l);if(this.bindSkeletons(l,c),void 0!==e){var u=!1;for(var p in o)if(o[p]instanceof HTMLImageElement){u=!0;break}!1===u&&e(l)}return l},n.parseShapes=function(t){var e={};if(void 0!==t)for(var n=0,r=t.length;n<r;n++){var i=(new al).fromJSON(t[n]);e[i.uuid]=i}return e},n.parseSkeletons=function(t,e){var n={},r={};if(e.traverse(function(t){t.isBone&&(r[t.uuid]=t)}),void 0!==t)for(var i=0,o=t.length;i<o;i++){var a=(new jo).fromJSON(t[i],r);n[a.uuid]=a}return n},n.parseGeometries=function(t,e){var n,r={};if(void 0!==t)for(var i=new Al,o=0,a=t.length;o<a;o++){var s=void 0,l=t[o];switch(l.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new $a[l.type](l.width,l.height,l.widthSegments,l.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":s=new $a[l.type](l.width,l.height,l.depth,l.widthSegments,l.heightSegments,l.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new $a[l.type](l.radius,l.segments,l.thetaStart,l.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new $a[l.type](l.radiusTop,l.radiusBottom,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new $a[l.type](l.radius,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new $a[l.type](l.radius,l.widthSegments,l.heightSegments,l.phiStart,l.phiLength,l.thetaStart,l.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new $a[l.type](l.radius,l.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new $a[l.type](l.innerRadius,l.outerRadius,l.thetaSegments,l.phiSegments,l.thetaStart,l.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new $a[l.type](l.radius,l.tube,l.radialSegments,l.tubularSegments,l.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new $a[l.type](l.radius,l.tube,l.tubularSegments,l.radialSegments,l.p,l.q);break;case"TubeGeometry":case"TubeBufferGeometry":s=new $a[l.type]((new rl[l.path.type]).fromJSON(l.path),l.tubularSegments,l.radius,l.radialSegments,l.closed);break;case"LatheGeometry":case"LatheBufferGeometry":s=new $a[l.type](l.points,l.segments,l.phiStart,l.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new $a[l.type](l.vertices,l.indices,l.radius,l.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":n=[];for(var c=0,u=l.shapes.length;c<u;c++){var p=e[l.shapes[c]];n.push(p)}s=new $a[l.type](n,l.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":n=[];for(var d=0,h=l.shapes.length;d<h;d++){var f=e[l.shapes[d]];n.push(f)}var m=l.options.extrudePath;void 0!==m&&(l.options.extrudePath=(new rl[m.type]).fromJSON(m)),s=new $a[l.type](n,l.options);break;case"BufferGeometry":case"InstancedBufferGeometry":s=i.parse(l);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+l.type+'"');continue}s.uuid=l.uuid,void 0!==l.name&&(s.name=l.name),!0===s.isBufferGeometry&&void 0!==l.userData&&(s.userData=l.userData),r[l.uuid]=s}return r},n.parseMaterials=function(t,e){var n={},r={};if(void 0!==t){var i=new jl;i.setTextures(e);for(var o=0,a=t.length;o<a;o++){var s=t[o];if("MultiMaterial"===s.type){for(var l=[],c=0;c<s.materials.length;c++){var u=s.materials[c];void 0===n[u.uuid]&&(n[u.uuid]=i.parse(u)),l.push(n[u.uuid])}r[s.uuid]=l}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r},n.parseAnimations=function(t){var e={};if(void 0!==t)for(var n=0;n<t.length;n++){var r=t[n],i=Ts.parse(r);e[i.uuid]=i}return e},n.parseImages=function(t,e){var n,r=this,i={};function o(t){if("string"==typeof t){var e=t;return function(t){return r.manager.itemStart(t),n.load(t,function(){r.manager.itemEnd(t)},void 0,function(){r.manager.itemError(t),r.manager.itemEnd(t)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(e)?e:r.resourcePath+e)}return t.data?{data:hn(t.type,t.data),width:t.width,height:t.height}:null}if(void 0!==t&&t.length>0){var a=new js(e);(n=new Ps(a)).setCrossOrigin(this.crossOrigin);for(var s=0,l=t.length;s<l;s++){var c=t[s],u=c.url;if(Array.isArray(u)){i[c.uuid]=[];for(var p=0,d=u.length;p<d;p++){var h=o(u[p]);null!==h&&(h instanceof HTMLImageElement?i[c.uuid].push(h):i[c.uuid].push(new Kn(h.data,h.width,h.height)))}}else{var f=o(c.url);null!==f&&(i[c.uuid]=f)}}}return i},n.parseTextures=function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var r={};if(void 0!==t)for(var i=0,o=t.length;i<o;i++){var a=t[i];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===e[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=void 0,l=e[a.image];Array.isArray(l)?(s=new Zn(l),6===l.length&&(s.needsUpdate=!0)):(s=l&&l.data?new Kn(l.data,l.width,l.height):new bt(l),l&&(s.needsUpdate=!0)),s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=n(a.mapping,Il)),void 0!==a.offset&&s.offset.fromArray(a.offset),void 0!==a.repeat&&s.repeat.fromArray(a.repeat),void 0!==a.center&&s.center.fromArray(a.center),void 0!==a.rotation&&(s.rotation=a.rotation),void 0!==a.wrap&&(s.wrapS=n(a.wrap[0],Pl),s.wrapT=n(a.wrap[1],Pl)),void 0!==a.format&&(s.format=a.format),void 0!==a.type&&(s.type=a.type),void 0!==a.encoding&&(s.encoding=a.encoding),void 0!==a.minFilter&&(s.minFilter=n(a.minFilter,Ol)),void 0!==a.magFilter&&(s.magFilter=n(a.magFilter,Ol)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),void 0!==a.flipY&&(s.flipY=a.flipY),void 0!==a.premultiplyAlpha&&(s.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(s.unpackAlignment=a.unpackAlignment),r[a.uuid]=s}return r},n.parseObject=function(t,e,n,r){var i,o,a;function s(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function l(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],r=0,i=t.length;r<i;r++){var o=t[r];void 0===n[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),e.push(n[o])}return e}return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}}switch(t.type){case"Scene":i=new Yi,void 0!==t.background&&Number.isInteger(t.background)&&(i.background=new Qe(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?i.fog=new Xi(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(i.fog=new qi(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":i=new Xn(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(i.focus=t.focus),void 0!==t.zoom&&(i.zoom=t.zoom),void 0!==t.filmGauge&&(i.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(i.filmOffset=t.filmOffset),void 0!==t.view&&(i.view=Object.assign({},t.view));break;case"OrthographicCamera":i=new bl(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(i.zoom=t.zoom),void 0!==t.view&&(i.view=Object.assign({},t.view));break;case"AmbientLight":i=new El(t.color,t.intensity);break;case"DirectionalLight":i=new wl(t.color,t.intensity);break;case"PointLight":i=new vl(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":i=new Tl(t.color,t.intensity,t.width,t.height);break;case"SpotLight":i=new fl(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":i=new ll(t.color,t.groundColor,t.intensity);break;case"LightProbe":i=(new Ml).fromJSON(t);break;case"SkinnedMesh":i=new Eo(o=s(t.geometry),a=l(t.material)),void 0!==t.bindMode&&(i.bindMode=t.bindMode),void 0!==t.bindMatrix&&i.bindMatrix.fromArray(t.bindMatrix),void 0!==t.skeleton&&(i.skeleton=t.skeleton);break;case"Mesh":i=new Hn(o=s(t.geometry),a=l(t.material));break;case"InstancedMesh":o=s(t.geometry),a=l(t.material);var c=t.count,u=t.instanceMatrix;(i=new Lo(o,a,c)).instanceMatrix=new $e(new Float32Array(u.array),16);break;case"LOD":i=new _o;break;case"Line":i=new Ho(s(t.geometry),l(t.material));break;case"LineLoop":i=new Vo(s(t.geometry),l(t.material));break;case"LineSegments":i=new Uo(s(t.geometry),l(t.material));break;case"PointCloud":case"Points":i=new Qo(s(t.geometry),l(t.material));break;case"Sprite":i=new ho(l(t.material));break;case"Group":i=new Ni;break;case"Bone":i=new To;break;default:i=new Se}if(i.uuid=t.uuid,void 0!==t.name&&(i.name=t.name),void 0!==t.matrix?(i.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(i.matrixAutoUpdate=t.matrixAutoUpdate),i.matrixAutoUpdate&&i.matrix.decompose(i.position,i.quaternion,i.scale)):(void 0!==t.position&&i.position.fromArray(t.position),void 0!==t.rotation&&i.rotation.fromArray(t.rotation),void 0!==t.quaternion&&i.quaternion.fromArray(t.quaternion),void 0!==t.scale&&i.scale.fromArray(t.scale)),void 0!==t.castShadow&&(i.castShadow=t.castShadow),void 0!==t.receiveShadow&&(i.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(i.shadow.bias=t.shadow.bias),void 0!==t.shadow.normalBias&&(i.shadow.normalBias=t.shadow.normalBias),void 0!==t.shadow.radius&&(i.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&i.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(i.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(i.visible=t.visible),void 0!==t.frustumCulled&&(i.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(i.renderOrder=t.renderOrder),void 0!==t.userData&&(i.userData=t.userData),void 0!==t.layers&&(i.layers.mask=t.layers),void 0!==t.children)for(var p=t.children,d=0;d<p.length;d++)i.add(this.parseObject(p[d],e,n,r));if(void 0!==t.animations)for(var h=t.animations,f=0;f<h.length;f++){var m=h[f];i.animations.push(r[m])}if("LOD"===t.type){void 0!==t.autoUpdate&&(i.autoUpdate=t.autoUpdate);for(var y=t.levels,_=0;_<y.length;_++){var g=y[_],v=i.getObjectByProperty("uuid",g.object);void 0!==v&&i.addLevel(v,g.distance)}}return i},n.bindSkeletons=function(t,e){0!==Object.keys(e).length&&t.traverse(function(t){if(!0===t.isSkinnedMesh&&void 0!==t.skeleton){var n=e[t.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",t.skeleton):t.bind(n,t.bindMatrix)}})},n.setTexturePath=function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)},e}(zs),Il={UVMapping:i,CubeReflectionMapping:o,CubeRefractionMapping:a,EquirectangularReflectionMapping:s,EquirectangularRefractionMapping:l,CubeUVReflectionMapping:c,CubeUVRefractionMapping:u},Pl={RepeatWrapping:p,ClampToEdgeWrapping:d,MirroredRepeatWrapping:h},Ol={NearestFilter:f,NearestMipmapNearestFilter:m,NearestMipmapLinearFilter:y,LinearFilter:_,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:g};function kl(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),zs.call(this,t),this.options={premultiplyAlpha:"none"}}kl.prototype=Object.assign(Object.create(zs.prototype),{constructor:kl,isImageBitmapLoader:!0,setOptions:function(t){return this.options=t,this},load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=Ms.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;var a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(t,a).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,Object.assign(i.options,{colorSpaceConversion:"none"}))}).then(function(n){Ms.add(t,n),e&&e(n),i.manager.itemEnd(t)}).catch(function(e){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}),i.manager.itemStart(t)}});var Bl=function(){function t(){this.type="ShapePath",this.color=new Qe,this.subPaths=[],this.currentPath=null}var e=t.prototype;return e.moveTo=function(t,e){return this.currentPath=new ol,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},e.lineTo=function(t,e){return this.currentPath.lineTo(t,e),this},e.quadraticCurveTo=function(t,e,n,r){return this.currentPath.quadraticCurveTo(t,e,n,r),this},e.bezierCurveTo=function(t,e,n,r,i,o){return this.currentPath.bezierCurveTo(t,e,n,r,i,o),this},e.splineThru=function(t){return this.currentPath.splineThru(t),this},e.toShapes=function(t,e){function n(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n],o=new al;o.curves=i.curves,e.push(o)}return e}function r(t,e){for(var n=e.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=e[i],s=e[o],l=s.x-a.x,c=s.y-a.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(a=e[o],l=-l,s=e[i],c=-c),t.y<a.y||t.y>s.y)continue;if(t.y===a.y){if(t.x===a.x)return!0}else{var u=c*(t.x-a.x)-l*(t.y-a.y);if(0===u)return!0;if(u<0)continue;r=!r}}else{if(t.y!==a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return r}var i,o,a,s=Oa.isClockWise,l=this.subPaths;if(0===l.length)return[];if(!0===e)return n(l);var c=[];if(1===l.length)return o=l[0],(a=new al).curves=o.curves,c.push(a),c;var u=!s(l[0].getPoints());u=t?!u:u;var p,d,h=[],f=[],m=[],y=0;f[y]=void 0,m[y]=[];for(var _=0,g=l.length;_<g;_++)i=s(p=(o=l[_]).getPoints()),(i=t?!i:i)?(!u&&f[y]&&y++,f[y]={s:new al,p:p},f[y].s.curves=o.curves,u&&y++,m[y]=[]):m[y].push({h:o,p:p[0]});if(!f[0])return n(l);if(f.length>1){for(var v=!1,b=[],x=0,w=f.length;x<w;x++)h[x]=[];for(var E=0,T=f.length;E<T;E++)for(var S=m[E],M=0;M<S.length;M++){for(var j=S[M],C=!0,z=0;z<f.length;z++)r(j.p,f[z].p)&&(E!==z&&b.push({froms:E,tos:z,hole:M}),C?(C=!1,h[z].push(j)):v=!0);C&&h[E].push(j)}b.length>0&&(v||(m=h))}for(var R=0,A=f.length;R<A;R++){a=f[R].s,c.push(a);for(var L=0,I=(d=m[R]).length;L<I;L++)a.holes.push(d[L].h)}return c},t}(),Dl=function(){function t(t){this.type="Font",this.data=t}return t.prototype.generateShapes=function(t,e){void 0===e&&(e=100);for(var n=[],r=function(t,e,n){for(var r=Array.from(t),i=e/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,a=[],s=0,l=0,c=0;c<r.length;c++){var u=r[c];if("\n"===u)s=0,l-=o;else{var p=Hl(u,i,s,l,n);s+=p.offsetX,a.push(p.path)}}return a}(t,e,this.data),i=0,o=r.length;i<o;i++)Array.prototype.push.apply(n,r[i].toShapes());return n},t}();function Hl(t,e,n,r,i){var o=i.glyphs[t]||i.glyphs["?"];if(o){var a,s,l,c,u,p,d,h,f=new Bl;if(o.o)for(var m=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),y=0,_=m.length;y<_;)switch(m[y++]){case"m":a=m[y++]*e+n,s=m[y++]*e+r,f.moveTo(a,s);break;case"l":a=m[y++]*e+n,s=m[y++]*e+r,f.lineTo(a,s);break;case"q":l=m[y++]*e+n,c=m[y++]*e+r,u=m[y++]*e+n,p=m[y++]*e+r,f.quadraticCurveTo(u,p,l,c);break;case"b":l=m[y++]*e+n,c=m[y++]*e+r,u=m[y++]*e+n,p=m[y++]*e+r,d=m[y++]*e+n,h=m[y++]*e+r,f.bezierCurveTo(u,p,d,h,l,c)}return{offsetX:o.ha*e,path:f}}console.error('THREE.Font: character "'+t+'" does not exists in font family '+i.familyName+".")}Dl.prototype.isFont=!0;var Fl,Nl=function(t){function e(e){return t.call(this,e)||this}st(e,t);var n=e.prototype;return n.load=function(t,e,n,r){var i=this,o=new As(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(i.withCredentials),o.load(t,function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}var r=i.parse(n);e&&e(r)},n,r)},n.parse=function(t){return new Dl(t)},e}(zs),Ul={getContext:function(){return void 0===Fl&&(Fl=new(window.AudioContext||window.webkitAudioContext)),Fl},setContext:function(t){Fl=t}},Vl=function(t){function e(e){return t.call(this,e)||this}return st(e,t),e.prototype.load=function(t,e,n,r){var i=this,o=new As(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,function(n){try{var o=n.slice(0);Ul.getContext().decodeAudioData(o,function(t){e(t)})}catch(e){r?r(e):console.error(e),i.manager.itemError(t)}},n,r)},e}(zs),Gl=function(t){function e(e,n,r){var i;void 0===r&&(r=1),i=t.call(this,void 0,r)||this;var o=(new Qe).set(e),a=(new Qe).set(n),s=new Mt(o.r,o.g,o.b),l=new Mt(a.r,a.g,a.b),c=Math.sqrt(Math.PI),u=c*Math.sqrt(.75);return i.sh.coefficients[0].copy(s).add(l).multiplyScalar(c),i.sh.coefficients[1].copy(s).sub(l).multiplyScalar(u),i}return st(e,t),e}(Ml);Gl.prototype.isHemisphereLightProbe=!0;var Wl=function(t){function e(e,n){var r;void 0===n&&(n=1),r=t.call(this,void 0,n)||this;var i=(new Qe).set(e);return r.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI)),r}return st(e,t),e}(Ml);Wl.prototype.isAmbientLightProbe=!0;var ql=new te,Xl=new te,Yl=function(){function t(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Xn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Xn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}return t.prototype.update=function(t){var e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep;var n,r,i=t.projectionMatrix.clone(),o=e.eyeSep/2,a=o*e.near/e.focus,s=e.near*Math.tan(ft.DEG2RAD*e.fov*.5)/e.zoom;Xl.elements[12]=-o,ql.elements[12]=o,n=-s*e.aspect+a,r=s*e.aspect+a,i.elements[0]=2*e.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(i),n=-s*e.aspect-a,r=s*e.aspect-a,i.elements[0]=2*e.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(Xl),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(ql)},t}(),Ql=function(){function t(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}var e=t.prototype;return e.start=function(){this.startTime=Zl(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},e.stop=function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},e.getElapsedTime=function(){return this.getDelta(),this.elapsedTime},e.getDelta=function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=Zl();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t},t}();function Zl(){return("undefined"==typeof performance?Date:performance).now()}var Jl=new Mt,Kl=new St,$l=new Mt,tc=new Mt,ec=function(t){function e(){var e;return(e=t.call(this)||this).type="AudioListener",e.context=Ul.getContext(),e.gain=e.context.createGain(),e.gain.connect(e.context.destination),e.filter=null,e.timeDelta=0,e._clock=new Ql,e}st(e,t);var n=e.prototype;return n.getInput=function(){return this.gain},n.removeFilter=function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},n.getFilter=function(){return this.filter},n.setFilter=function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},n.getMasterVolume=function(){return this.gain.gain.value},n.setMasterVolume=function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},n.updateMatrixWorld=function(e){t.prototype.updateMatrixWorld.call(this,e);var n=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Jl,Kl,$l),tc.set(0,0,-1).applyQuaternion(Kl),n.positionX){var i=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(Jl.x,i),n.positionY.linearRampToValueAtTime(Jl.y,i),n.positionZ.linearRampToValueAtTime(Jl.z,i),n.forwardX.linearRampToValueAtTime(tc.x,i),n.forwardY.linearRampToValueAtTime(tc.y,i),n.forwardZ.linearRampToValueAtTime(tc.z,i),n.upX.linearRampToValueAtTime(r.x,i),n.upY.linearRampToValueAtTime(r.y,i),n.upZ.linearRampToValueAtTime(r.z,i)}else n.setPosition(Jl.x,Jl.y,Jl.z),n.setOrientation(tc.x,tc.y,tc.z,r.x,r.y,r.z)},e}(Se),nc=function(t){function e(e){var n;return(n=t.call(this)||this).type="Audio",n.listener=e,n.context=e.context,n.gain=n.context.createGain(),n.gain.connect(e.getInput()),n.autoplay=!1,n.buffer=null,n.detune=0,n.loop=!1,n.loopStart=0,n.loopEnd=0,n.offset=0,n.duration=void 0,n.playbackRate=1,n.isPlaying=!1,n.hasPlaybackControl=!0,n.source=null,n.sourceType="empty",n._startedAt=0,n._progress=0,n._connected=!1,n.filters=[],n}st(e,t);var n=e.prototype;return n.getOutput=function(){return this.gain},n.setNodeSource=function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},n.setMediaElementSource=function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},n.setMediaStreamSource=function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},n.setBuffer=function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},n.play=function(t){if(void 0===t&&(t=0),!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+t;var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},n.pause=function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},n.stop=function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},n.connect=function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this},n.disconnect=function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this},n.getFilters=function(){return this.filters},n.setFilters=function(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this},n.setDetune=function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},n.getDetune=function(){return this.detune},n.getFilter=function(){return this.getFilters()[0]},n.setFilter=function(t){return this.setFilters(t?[t]:[])},n.setPlaybackRate=function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},n.getPlaybackRate=function(){return this.playbackRate},n.onEnded=function(){this.isPlaying=!1},n.getLoop=function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},n.setLoop=function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},n.setLoopStart=function(t){return this.loopStart=t,this},n.setLoopEnd=function(t){return this.loopEnd=t,this},n.getVolume=function(){return this.gain.gain.value},n.setVolume=function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},e}(Se),rc=new Mt,ic=new St,oc=new Mt,ac=new Mt,sc=function(t){function e(e){var n;return(n=t.call(this,e)||this).panner=n.context.createPanner(),n.panner.panningModel="HRTF",n.panner.connect(n.gain),n}st(e,t);var n=e.prototype;return n.getOutput=function(){return this.panner},n.getRefDistance=function(){return this.panner.refDistance},n.setRefDistance=function(t){return this.panner.refDistance=t,this},n.getRolloffFactor=function(){return this.panner.rolloffFactor},n.setRolloffFactor=function(t){return this.panner.rolloffFactor=t,this},n.getDistanceModel=function(){return this.panner.distanceModel},n.setDistanceModel=function(t){return this.panner.distanceModel=t,this},n.getMaxDistance=function(){return this.panner.maxDistance},n.setMaxDistance=function(t){return this.panner.maxDistance=t,this},n.setDirectionalCone=function(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this},n.updateMatrixWorld=function(e){if(t.prototype.updateMatrixWorld.call(this,e),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(rc,ic,oc),ac.set(0,0,1).applyQuaternion(ic);var n=this.panner;if(n.positionX){var r=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(rc.x,r),n.positionY.linearRampToValueAtTime(rc.y,r),n.positionZ.linearRampToValueAtTime(rc.z,r),n.orientationX.linearRampToValueAtTime(ac.x,r),n.orientationY.linearRampToValueAtTime(ac.y,r),n.orientationZ.linearRampToValueAtTime(ac.z,r)}else n.setPosition(rc.x,rc.y,rc.z),n.setOrientation(ac.x,ac.y,ac.z)}},e}(nc),lc=function(){function t(t,e){void 0===e&&(e=2048),this.analyser=t.context.createAnalyser(),this.analyser.fftSize=e,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}var e=t.prototype;return e.getFrequencyData=function(){return this.analyser.getByteFrequencyData(this.data),this.data},e.getAverageFrequency=function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length},t}(),cc=function(){function t(t,e,n){var r,i,o;switch(this.binding=t,this.valueSize=n,e){case"quaternion":r=this._slerp,i=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}var e=t.prototype;return e.accumulate=function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==r;++a)n[i+a]=n[a];o=e}else{var s=e/(o+=e);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=o},e.accumulateAdditive=function(t){var e=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,t,n),this.cumulativeWeightAdditive+=t},e.apply=function(t){var e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){var s=e*this._origIndex;this._mixBufferRegion(n,r,s,1-i,e)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*e,1,e);for(var l=e,c=e+e;l!==c;++l)if(n[l]!==n[l+e]){a.setValue(n,r);break}},e.saveOriginalState=function(){var t=this.binding,e=this.buffer,n=this.valueSize,r=n*this._origIndex;t.getValue(e,r);for(var i=n,o=r;i!==o;++i)e[i]=e[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},e.restoreOriginalState=function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},e._setAdditiveIdentityNumeric=function(){for(var t=this._addIndex*this.valueSize,e=t+this.valueSize,n=t;n<e;n++)this.buffer[n]=0},e._setAdditiveIdentityQuaternion=function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},e._setAdditiveIdentityOther=function(){for(var t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize,n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]},e._select=function(t,e,n,r,i){if(r>=.5)for(var o=0;o!==i;++o)t[e+o]=t[n+o]},e._slerp=function(t,e,n,r){St.slerpFlat(t,e,t,e,t,n,r)},e._slerpAdditive=function(t,e,n,r,i){var o=this._workIndex*i;St.multiplyQuaternionsFlat(t,o,t,e,t,n),St.slerpFlat(t,e,t,e,t,o,r)},e._lerp=function(t,e,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=e+a;t[s]=t[s]*o+t[n+a]*r}},e._lerpAdditive=function(t,e,n,r,i){for(var o=0;o!==i;++o){var a=e+o;t[a]=t[a]+t[n+o]*r}},t}(),uc=new RegExp("[\\[\\]\\.:\\/]","g"),pc="[^\\[\\]\\.:\\/]",dc="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",hc=/((?:WC+[\/:])*)/.source.replace("WC",pc),fc=/(WCOD+)?/.source.replace("WCOD",dc),mc=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",pc),yc=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",pc),_c=new RegExp("^"+hc+fc+mc+yc+"$"),gc=["material","materials","bones"];function vc(t,e,n){var r=n||bc.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function bc(t,e,n){this.path=e,this.parsedPath=n||bc.parseTrackName(e),this.node=bc.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}Object.assign(vc.prototype,{getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(bc,{Composite:vc,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new bc.Composite(t,e,n):new bc(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(uc,"")},parseTrackName:function(t){var e=_c.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==gc.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n},findNode:function(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){var r=function t(n){for(var r=0;r<n.length;r++){var i=n[r];if(i.name===e||i.uuid===e)return i;var o=t(i.children);if(o)return o}return null}(t.children);if(r)return r}return null}}),Object.assign(bc.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(t=bc.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var o=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var a=0;a<t.length;a++)if(t[a].name===o){o=a;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var s=t[r];if(void 0!==s){var l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[i]&&(i=t.morphTargetDictionary[i])}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}else{var u=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+r+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(bc.prototype,{_getValue_unbound:bc.prototype.getValue,_setValue_unbound:bc.prototype.setValue});var xc=function(){function t(){this.uuid=ft.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}var e=t.prototype;return e.add=function(){for(var t=this._objects,e=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,o=i.length,a=void 0,s=t.length,l=this.nCachedObjects_,c=0,u=arguments.length;c!==u;++c){var p=arguments[c],d=p.uuid,h=e[d];if(void 0===h){h=s++,e[d]=h,t.push(p);for(var f=0,m=o;f!==m;++f)i[f].push(new bc(p,n[f],r[f]))}else if(h<l){a=t[h];var y=--l,_=t[y];e[_.uuid]=h,t[h]=_,e[d]=y,t[y]=p;for(var g=0,v=o;g!==v;++g){var b=i[g],x=b[y],w=b[h];b[h]=x,void 0===w&&(w=new bc(p,n[g],r[g])),b[y]=w}}else t[h]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l},e.remove=function(){for(var t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],l=s.uuid,c=e[l];if(void 0!==c&&c>=i){var u=i++,p=t[u];e[p.uuid]=c,t[c]=p,e[l]=u,t[u]=s;for(var d=0,h=r;d!==h;++d){var f=n[d],m=f[u],y=f[c];f[c]=m,f[u]=y}}}this.nCachedObjects_=i},e.uncache=function(){for(var t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,o=t.length,a=0,s=arguments.length;a!==s;++a){var l=arguments[a].uuid,c=e[l];if(void 0!==c)if(delete e[l],c<i){var u=--i,p=t[u],d=--o,h=t[d];e[p.uuid]=c,t[c]=p,e[h.uuid]=u,t[u]=h,t.pop();for(var f=0,m=r;f!==m;++f){var y=n[f],_=y[u],g=y[d];y[c]=_,y[u]=g,y.pop()}}else{var v=--o,b=t[v];v>0&&(e[b.uuid]=c),t[c]=b,t.pop();for(var x=0,w=r;x!==w;++x){var E=n[x];E[c]=E[v],E.pop()}}}this.nCachedObjects_=i},e.subscribe_=function(t,e){var n=this._bindingsIndicesByPath,r=n[t],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,l=s.length,c=this.nCachedObjects_,u=new Array(l);r=i.length,n[t]=r,o.push(t),a.push(e),i.push(u);for(var p=c,d=s.length;p!==d;++p){var h=s[p];u[p]=new bc(h,t,e)}return u},e.unsubscribe_=function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}},t}();xc.prototype.isAnimationObjectGroup=!0;var wc=function(){function t(t,e,n,r){void 0===n&&(n=null),void 0===r&&(r=e.blendMode),this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=r;for(var i=e.tracks,o=i.length,a=new Array(o),s={endingStart:U,endingEnd:U},l=0;l!==o;++l){var c=i[l].createInterpolant(null);a[l]=c,c.settings=s}this._interpolantSettings=s,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}var e=t.prototype;return e.play=function(){return this._mixer._activateAction(this),this},e.stop=function(){return this._mixer._deactivateAction(this),this.reset()},e.reset=function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},e.isRunning=function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},e.isScheduled=function(){return this._mixer._isActiveAction(this)},e.startAt=function(t){return this._startTime=t,this},e.setLoop=function(t,e){return this.loop=t,this.repetitions=e,this},e.setEffectiveWeight=function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},e.getEffectiveWeight=function(){return this._effectiveWeight},e.fadeIn=function(t){return this._scheduleFading(t,0,1)},e.fadeOut=function(t){return this._scheduleFading(t,1,0)},e.crossFadeFrom=function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var r=this._clip.duration,i=t._clip.duration,o=i/r,a=r/i;t.warp(1,o,e),this.warp(a,1,e)}return this},e.crossFadeTo=function(t,e,n){return t.crossFadeFrom(this,e,n)},e.stopFading=function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},e.setEffectiveTimeScale=function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},e.getEffectiveTimeScale=function(){return this._effectiveTimeScale},e.setDuration=function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},e.syncWith=function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},e.halt=function(t){return this.warp(this._effectiveTimeScale,0,t)},e.warp=function(t,e,n){var r=this._mixer,i=r.time,o=this.timeScale,a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,l=a.sampleValues;return s[0]=i,s[1]=i+n,l[0]=t/o,l[1]=e/o,this},e.stopWarping=function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},e.getMixer=function(){return this._mixer},e.getClip=function(){return this._clip},e.getRoot=function(){return this._localRoot||this._mixer._root},e._update=function(t,e,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var o=(t-i)*n;if(o<0||0===n)return;this._startTime=null,e=n*o}e*=this._updateTimeScale(t);var a=this._updateTime(e),s=this._updateWeight(t);if(s>0){var l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case q:for(var u=0,p=l.length;u!==p;++u)l[u].evaluate(a),c[u].accumulateAdditive(s);break;case W:default:for(var d=0,h=l.length;d!==h;++d)l[d].evaluate(a),c[d].accumulate(r,s)}}}else this._updateWeight(t)},e._updateWeight=function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},e._updateTimeScale=function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;null!==n&&(e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e},e._updateTime=function(t){var e=this._clip.duration,n=this.loop,r=this.time+t,i=this._loopCount,o=2202===n;if(0===t)return-1===i?r:o&&1==(1&i)?e-r:r;if(2200===n){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(r>=e)r=e;else{if(!(r<0)){this.time=r;break t}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=e||r<0){var a=Math.floor(r/e);r-=e*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=t>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){var l=t<0;this._setEndings(l,!l,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&1==(1&i))return e-r}return r},e._setEndings=function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=V,r.endingEnd=V):(r.endingStart=t?this.zeroSlopeAtStart?V:U:G,r.endingEnd=e?this.zeroSlopeAtEnd?V:U:G)},e._scheduleFading=function(t,e,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=e,a[1]=i+t,s[1]=n,this},t}(),Ec=function(t){function e(e){var n;return(n=t.call(this)||this)._root=e,n._initMemoryManager(),n._accuIndex=0,n.time=0,n.timeScale=1,n}st(e,t);var n=e.prototype;return n._bindAction=function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,l=this._bindingsByRootAndName,c=l[s];void 0===c&&(c={},l[s]=c);for(var u=0;u!==i;++u){var p=r[u],d=p.name,h=c[d];if(void 0!==h)o[u]=h;else{if(void 0!==(h=o[u])){null===h._cacheIndex&&(++h.referenceCount,this._addInactiveBinding(h,s,d));continue}var f=e&&e._propertyBindings[u].binding.parsedPath;++(h=new cc(bc.create(n,d,f),p.ValueTypeName,p.getValueSize())).referenceCount,this._addInactiveBinding(h,s,d),o[u]=h}a[u].resultBuffer=h.buffer}},n._activateAction=function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(var i=t._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},n._deactivateAction=function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},n._initMemoryManager=function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},n._isActiveAction=function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},n._addInactiveAction=function(t,e,n){var r=this._actions,i=this._actionsByClip,o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{var a=o.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t},n._removeInactiveAction=function(t){var e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,l=s[s.length-1],c=t._byClipCacheIndex;l._byClipCacheIndex=c,s[c]=l,s.pop(),t._byClipCacheIndex=null,delete a.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(t)},n._removeInactiveBindingsForAction=function(t){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},n._lendAction=function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},n._takeBackAction=function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},n._addInactiveBinding=function(t,e,n){var r=this._bindingsByRootAndName,i=this._bindings,o=r[e];void 0===o&&(o={},r[e]=o),o[n]=t,t._cacheIndex=i.length,i.push(t)},n._removeInactiveBinding=function(t){var e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=e[e.length-1],l=t._cacheIndex;s._cacheIndex=l,e[l]=s,e.pop(),delete a[i],0===Object.keys(a).length&&delete o[r]},n._lendBinding=function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},n._takeBackBinding=function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},n._lendControlInterpolant=function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new fs(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},n._takeBackControlInterpolant=function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},n.clipAction=function(t,e,n){var r=e||this._root,i=r.uuid,o="string"==typeof t?Ts.findByName(r,t):t,a=null!==o?o.uuid:t,s=this._actionsByClip[a],l=null;if(void 0===n&&(n=null!==o?o.blendMode:W),void 0!==s){var c=s.actionByRoot[i];if(void 0!==c&&c.blendMode===n)return c;l=s.knownActions[0],null===o&&(o=l._clip)}if(null===o)return null;var u=new wc(this,o,e,n);return this._bindAction(u,l),this._addInactiveAction(u,a,i),u},n.existingAction=function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?Ts.findByName(n,t):t,o=i?i.uuid:t,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[r]||null},n.stopAllAction=function(){for(var t=this._actions,e=this._nActiveActions-1;e>=0;--e)t[e].stop();return this},n.update=function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),o=this._accuIndex^=1,a=0;a!==n;++a)e[a]._update(r,t,i,o);for(var s=this._bindings,l=this._nActiveBindings,c=0;c!==l;++c)s[c].apply(o);return this},n.setTime=function(t){this.time=0;for(var e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},n.getRoot=function(){return this._root},n.uncacheClip=function(t){var e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var l=o[a];this._deactivateAction(l);var c=l._cacheIndex,u=e[e.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,u._cacheIndex=c,e[c]=u,e.pop(),this._removeInactiveBindingsForAction(l)}delete r[n]}},n.uncacheRoot=function(t){var e=t.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[e];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},n.uncacheAction=function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))},e}(ut);Ec.prototype._controlInterpolantsResultBuffer=new Float32Array(1);var Tc=function(){function t(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}return t.prototype.clone=function(){return new t(void 0===this.value.clone?this.value:this.value.clone())},t}();function Sc(t,e,n){Qi.call(this,t,e),this.meshPerAttribute=n||1}function Mc(t,e,n,r,i){this.buffer=t,this.type=e,this.itemSize=n,this.elementSize=r,this.count=i,this.version=0}function jc(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=1/0),this.ray=new $t(t,e),this.near=n,this.far=r,this.camera=null,this.layers=new pe,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Cc(t,e){return t.distance-e.distance}function zc(t,e,n,r){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===r)for(var i=t.children,o=0,a=i.length;o<a;o++)zc(i[o],e,n,!0)}Sc.prototype=Object.assign(Object.create(Qi.prototype),{constructor:Sc,isInstancedInterleavedBuffer:!0,copy:function(t){return Qi.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},clone:function(t){var e=Qi.prototype.clone.call(this,t);return e.meshPerAttribute=this.meshPerAttribute,e},toJSON:function(t){var e=Qi.prototype.toJSON.call(this,t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}),Object.defineProperty(Mc.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Mc.prototype,{isGLBufferAttribute:!0,setBuffer:function(t){return this.buffer=t,this},setType:function(t,e){return this.type=t,this.elementSize=e,this},setItemSize:function(t){return this.itemSize=t,this},setCount:function(t){return this.count=t,this}}),Object.assign(jc.prototype,{set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)},intersectObject:function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=[]),zc(t,this,n,e),n.sort(Cc),n},intersectObjects:function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=[]);for(var r=0,i=t.length;r<i;r++)zc(t[r],this,n,e);return n.sort(Cc),n}});var Rc=function(){function t(t,e,n){return void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),this.radius=t,this.phi=e,this.theta=n,this}var e=t.prototype;return e.set=function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},e.copy=function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},e.makeSafe=function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},e.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},e.setFromCartesianCoords=function(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(ft.clamp(e/this.radius,-1,1))),this},e.clone=function(){return(new this.constructor).copy(this)},t}(),Ac=function(){function t(t,e,n){return void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),this.radius=t,this.theta=e,this.y=n,this}var e=t.prototype;return e.set=function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},e.copy=function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},e.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},e.setFromCartesianCoords=function(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this},e.clone=function(){return(new this.constructor).copy(this)},t}(),Lc=new mt,Ic=function(){function t(t,e){void 0===t&&(t=new mt(1/0,1/0)),void 0===e&&(e=new mt(-1/0,-1/0)),this.min=t,this.max=e}var e=t.prototype;return e.set=function(t,e){return this.min.copy(t),this.max.copy(e),this},e.setFromPoints=function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},e.setFromCenterAndSize=function(t,e){var n=Lc.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},e.clone=function(){return(new this.constructor).copy(this)},e.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},e.makeEmpty=function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},e.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},e.getCenter=function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new mt),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},e.getSize=function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new mt),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},e.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},e.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},e.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},e.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},e.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},e.getParameter=function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new mt),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},e.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},e.clampPoint=function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new mt),e.copy(t).clamp(this.min,this.max)},e.distanceToPoint=function(t){return Lc.copy(t).clamp(this.min,this.max).sub(t).length()},e.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this},e.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},e.translate=function(t){return this.min.add(t),this.max.add(t),this},e.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},t}();Ic.prototype.isBox2=!0;var Pc=new Mt,Oc=new Mt,kc=function(){function t(t,e){void 0===t&&(t=new Mt),void 0===e&&(e=new Mt),this.start=t,this.end=e}var e=t.prototype;return e.set=function(t,e){return this.start.copy(t),this.end.copy(e),this},e.copy=function(t){return this.start.copy(t.start),this.end.copy(t.end),this},e.getCenter=function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new Mt),t.addVectors(this.start,this.end).multiplyScalar(.5)},e.delta=function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new Mt),t.subVectors(this.end,this.start)},e.distanceSq=function(){return this.start.distanceToSquared(this.end)},e.distance=function(){return this.start.distanceTo(this.end)},e.at=function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new Mt),this.delta(e).multiplyScalar(t).add(this.start)},e.closestPointToPointParameter=function(t,e){Pc.subVectors(t,this.start),Oc.subVectors(this.end,this.start);var n=Oc.dot(Oc),r=Oc.dot(Pc)/n;return e&&(r=ft.clamp(r,0,1)),r},e.closestPointToPoint=function(t,e,n){var r=this.closestPointToPointParameter(t,e);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Mt),this.delta(n).multiplyScalar(r).add(this.start)},e.applyMatrix4=function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},e.equals=function(t){return t.start.equals(this.start)&&t.end.equals(this.end)},e.clone=function(){return(new this.constructor).copy(this)},t}();function Bc(t){Se.call(this),this.material=t,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Bc.prototype=Object.create(Se.prototype),Bc.prototype.constructor=Bc,Bc.prototype.isImmediateRenderObject=!0;var Dc=new Mt,Hc=function(t){function e(e,n){var r;(r=t.call(this)||this).light=e,r.light.updateMatrixWorld(),r.matrix=e.matrixWorld,r.matrixAutoUpdate=!1,r.color=n;for(var i=new xn,o=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],a=0,s=1;a<32;a++,s++){var l=a/32*Math.PI*2,c=s/32*Math.PI*2;o.push(Math.cos(l),Math.sin(l),1,Math.cos(c),Math.sin(c),1)}i.setAttribute("position",new cn(o,3));var u=new Io({fog:!1,toneMapped:!1});return r.cone=new Uo(i,u),r.add(r.cone),r.update(),r}st(e,t);var n=e.prototype;return n.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},n.update=function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),Dc.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Dc),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)},e}(Se),Fc=new Mt,Nc=new te,Uc=new te,Vc=function(t){function e(e){for(var n,r=function t(e){var n=[];e&&e.isBone&&n.push(e);for(var r=0;r<e.children.length;r++)n.push.apply(n,t(e.children[r]));return n}(e),i=new xn,o=[],a=[],s=new Qe(0,0,1),l=new Qe(0,1,0),c=0;c<r.length;c++){var u=r[c];u.parent&&u.parent.isBone&&(o.push(0,0,0),o.push(0,0,0),a.push(s.r,s.g,s.b),a.push(l.r,l.g,l.b))}i.setAttribute("position",new cn(o,3)),i.setAttribute("color",new cn(a,3));var p=new Io({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return(n=t.call(this,i,p)||this).type="SkeletonHelper",n.isSkeletonHelper=!0,n.root=e,n.bones=r,n.matrix=e.matrixWorld,n.matrixAutoUpdate=!1,n}return st(e,t),e.prototype.updateMatrixWorld=function(e){var n=this.bones,r=this.geometry,i=r.getAttribute("position");Uc.copy(this.root.matrixWorld).invert();for(var o=0,a=0;o<n.length;o++){var s=n[o];s.parent&&s.parent.isBone&&(Nc.multiplyMatrices(Uc,s.matrixWorld),Fc.setFromMatrixPosition(Nc),i.setXYZ(a,Fc.x,Fc.y,Fc.z),Nc.multiplyMatrices(Uc,s.parent.matrixWorld),Fc.setFromMatrixPosition(Nc),i.setXYZ(a+1,Fc.x,Fc.y,Fc.z),a+=2)}r.getAttribute("position").needsUpdate=!0,t.prototype.updateMatrixWorld.call(this,e)},e}(Uo),Gc=function(t){function e(e,n,r){var i,o=new qa(n,4,2),a=new Ze({wireframe:!0,fog:!1,toneMapped:!1});return(i=t.call(this,o,a)||this).light=e,i.light.updateMatrixWorld(),i.color=r,i.type="PointLightHelper",i.matrix=i.light.matrixWorld,i.matrixAutoUpdate=!1,i.update(),i}st(e,t);var n=e.prototype;return n.dispose=function(){this.geometry.dispose(),this.material.dispose()},n.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},e}(Hn),Wc=new Mt,qc=new Qe,Xc=new Qe,Yc=function(t){function e(e,n,r){var i;(i=t.call(this)||this).light=e,i.light.updateMatrixWorld(),i.matrix=e.matrixWorld,i.matrixAutoUpdate=!1,i.color=r;var o=new Ua(n);o.rotateY(.5*Math.PI),i.material=new Ze({wireframe:!0,fog:!1,toneMapped:!1}),void 0===i.color&&(i.material.vertexColors=!0);var a=o.getAttribute("position"),s=new Float32Array(3*a.count);return o.setAttribute("color",new $e(s,3)),i.add(new Hn(o,i.material)),i.update(),i}st(e,t);var n=e.prototype;return n.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},n.update=function(){var t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=t.geometry.getAttribute("color");qc.copy(this.light.color),Xc.copy(this.light.groundColor);for(var n=0,r=e.count;n<r;n++){var i=n<r/2?qc:Xc;e.setXYZ(n,i.r,i.g,i.b)}e.needsUpdate=!0}t.lookAt(Wc.setFromMatrixPosition(this.light.matrixWorld).negate())},e}(Se),Qc=function(t){function e(e,n,r,i){var o;void 0===e&&(e=10),void 0===n&&(n=10),void 0===r&&(r=4473924),void 0===i&&(i=8947848),r=new Qe(r),i=new Qe(i);for(var a=n/2,s=e/n,l=e/2,c=[],u=[],p=0,d=0,h=-l;p<=n;p++,h+=s){c.push(-l,0,h,l,0,h),c.push(h,0,-l,h,0,l);var f=p===a?r:i;f.toArray(u,d),d+=3,f.toArray(u,d),d+=3,f.toArray(u,d),d+=3,f.toArray(u,d),d+=3}var m=new xn;m.setAttribute("position",new cn(c,3)),m.setAttribute("color",new cn(u,3));var y=new Io({vertexColors:!0,toneMapped:!1});return(o=t.call(this,m,y)||this).type="GridHelper",o}return st(e,t),e}(Uo),Zc=function(t){function e(e,n,r,i,o,a){var s;void 0===e&&(e=10),void 0===n&&(n=16),void 0===r&&(r=8),void 0===i&&(i=64),void 0===o&&(o=4473924),void 0===a&&(a=8947848),o=new Qe(o),a=new Qe(a);for(var l=[],c=[],u=0;u<=n;u++){var p=u/n*(2*Math.PI),d=Math.sin(p)*e,h=Math.cos(p)*e;l.push(0,0,0),l.push(d,0,h);var f=1&u?o:a;c.push(f.r,f.g,f.b),c.push(f.r,f.g,f.b)}for(var m=0;m<=r;m++)for(var y=1&m?o:a,_=e-e/r*m,g=0;g<i;g++){var v=g/i*(2*Math.PI),b=Math.sin(v)*_,x=Math.cos(v)*_;l.push(b,0,x),c.push(y.r,y.g,y.b),v=(g+1)/i*(2*Math.PI),b=Math.sin(v)*_,x=Math.cos(v)*_,l.push(b,0,x),c.push(y.r,y.g,y.b)}var w=new xn;w.setAttribute("position",new cn(l,3)),w.setAttribute("color",new cn(c,3));var E=new Io({vertexColors:!0,toneMapped:!1});return(s=t.call(this,w,E)||this).type="PolarGridHelper",s}return st(e,t),e}(Uo),Jc=new Mt,Kc=new Mt,$c=new Mt,tu=function(t){function e(e,n,r){var i;(i=t.call(this)||this).light=e,i.light.updateMatrixWorld(),i.matrix=e.matrixWorld,i.matrixAutoUpdate=!1,i.color=r,void 0===n&&(n=1);var o=new xn;o.setAttribute("position",new cn([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));var a=new Io({fog:!1,toneMapped:!1});return i.lightPlane=new Ho(o,a),i.add(i.lightPlane),(o=new xn).setAttribute("position",new cn([0,0,0,0,0,1],3)),i.targetLine=new Ho(o,a),i.add(i.targetLine),i.update(),i}st(e,t);var n=e.prototype;return n.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},n.update=function(){Jc.setFromMatrixPosition(this.light.matrixWorld),Kc.setFromMatrixPosition(this.light.target.matrixWorld),$c.subVectors(Kc,Jc),this.lightPlane.lookAt(Kc),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Kc),this.targetLine.scale.z=$c.length()},e}(Se),eu=new Mt,nu=new qn,ru=function(t){function e(e){var n,r=new xn,i=new Io({color:16777215,vertexColors:!0,toneMapped:!1}),o=[],a=[],s={},l=new Qe(16755200),c=new Qe(16711680),u=new Qe(43775),p=new Qe(16777215),d=new Qe(3355443);function h(t,e,n){f(t,n),f(e,n)}function f(t,e){o.push(0,0,0),a.push(e.r,e.g,e.b),void 0===s[t]&&(s[t]=[]),s[t].push(o.length/3-1)}return h("n1","n2",l),h("n2","n4",l),h("n4","n3",l),h("n3","n1",l),h("f1","f2",l),h("f2","f4",l),h("f4","f3",l),h("f3","f1",l),h("n1","f1",l),h("n2","f2",l),h("n3","f3",l),h("n4","f4",l),h("p","n1",c),h("p","n2",c),h("p","n3",c),h("p","n4",c),h("u1","u2",u),h("u2","u3",u),h("u3","u1",u),h("c","t",p),h("p","c",d),h("cn1","cn2",d),h("cn3","cn4",d),h("cf1","cf2",d),h("cf3","cf4",d),r.setAttribute("position",new cn(o,3)),r.setAttribute("color",new cn(a,3)),(n=t.call(this,r,i)||this).type="CameraHelper",n.camera=e,n.camera.updateProjectionMatrix&&n.camera.updateProjectionMatrix(),n.matrix=e.matrixWorld,n.matrixAutoUpdate=!1,n.pointMap=s,n.update(),n}return st(e,t),e.prototype.update=function(){var t=this.geometry,e=this.pointMap;nu.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),iu("c",e,t,nu,0,0,-1),iu("t",e,t,nu,0,0,1),iu("n1",e,t,nu,-1,-1,-1),iu("n2",e,t,nu,1,-1,-1),iu("n3",e,t,nu,-1,1,-1),iu("n4",e,t,nu,1,1,-1),iu("f1",e,t,nu,-1,-1,1),iu("f2",e,t,nu,1,-1,1),iu("f3",e,t,nu,-1,1,1),iu("f4",e,t,nu,1,1,1),iu("u1",e,t,nu,.7,1.1,-1),iu("u2",e,t,nu,-.7,1.1,-1),iu("u3",e,t,nu,0,2,-1),iu("cf1",e,t,nu,-1,0,1),iu("cf2",e,t,nu,1,0,1),iu("cf3",e,t,nu,0,-1,1),iu("cf4",e,t,nu,0,1,1),iu("cn1",e,t,nu,-1,0,-1),iu("cn2",e,t,nu,1,0,-1),iu("cn3",e,t,nu,0,-1,-1),iu("cn4",e,t,nu,0,1,-1),t.getAttribute("position").needsUpdate=!0},e}(Uo);function iu(t,e,n,r,i,o,a){eu.set(i,o,a).unproject(r);var s=e[t];if(void 0!==s)for(var l=n.getAttribute("position"),c=0,u=s.length;c<u;c++)l.setXYZ(s[c],eu.x,eu.y,eu.z)}var ou,au,su,lu=new zt,cu=function(t){function e(e,n){var r;void 0===n&&(n=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=new Float32Array(24),a=new xn;return a.setIndex(new $e(i,1)),a.setAttribute("position",new $e(o,3)),(r=t.call(this,a,new Io({color:n,toneMapped:!1}))||this).object=e,r.type="BoxHelper",r.matrixAutoUpdate=!1,r.update(),r}st(e,t);var n=e.prototype;return n.update=function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&lu.setFromObject(this.object),!lu.isEmpty()){var e=lu.min,n=lu.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=e.x,i[4]=n.y,i[5]=n.z,i[6]=e.x,i[7]=e.y,i[8]=n.z,i[9]=n.x,i[10]=e.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=e.z,i[15]=e.x,i[16]=n.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=n.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}},n.setFromObject=function(t){return this.object=t,this.update(),this},n.copy=function(t){return Uo.prototype.copy.call(this,t),this.object=t.object,this},e}(Uo),uu=function(t){function e(e,n){var r;void 0===n&&(n=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=new xn;return o.setIndex(new $e(i,1)),o.setAttribute("position",new cn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),(r=t.call(this,o,new Io({color:n,toneMapped:!1}))||this).box=e,r.type="Box3Helper",r.geometry.computeBoundingSphere(),r}return st(e,t),e.prototype.updateMatrixWorld=function(e){var n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),t.prototype.updateMatrixWorld.call(this,e))},e}(Uo),pu=function(t){function e(e,n,r){var i;void 0===n&&(n=1),void 0===r&&(r=16776960);var o=r,a=new xn;a.setAttribute("position",new cn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),a.computeBoundingSphere(),(i=t.call(this,a,new Io({color:o,toneMapped:!1}))||this).type="PlaneHelper",i.plane=e,i.size=n;var s=new xn;return s.setAttribute("position",new cn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),s.computeBoundingSphere(),i.add(new Hn(s,new Ze({color:o,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),i}return st(e,t),e.prototype.updateMatrixWorld=function(e){var n=-this.plane.constant;Math.abs(n)<1e-8&&(n=1e-8),this.scale.set(.5*this.size,.5*this.size,n),this.children[0].material.side=n<0?1:0,this.lookAt(this.plane.normal),t.prototype.updateMatrixWorld.call(this,e)},e}(Ho),du=new Mt,hu=function(t){function e(e,n,r,i,o,a){var s;return void 0===e&&(e=new Mt(0,0,1)),void 0===n&&(n=new Mt(0,0,0)),void 0===r&&(r=1),void 0===i&&(i=16776960),void 0===o&&(o=.2*r),void 0===a&&(a=.2*o),(s=t.call(this)||this).type="ArrowHelper",void 0===ou&&((ou=new xn).setAttribute("position",new cn([0,0,0,0,1,0],3)),(au=new na(0,.5,1,5,1)).translate(0,-.5,0)),s.position.copy(n),s.line=new Ho(ou,new Io({color:i,toneMapped:!1})),s.line.matrixAutoUpdate=!1,s.add(s.line),s.cone=new Hn(au,new Ze({color:i,toneMapped:!1})),s.cone.matrixAutoUpdate=!1,s.add(s.cone),s.setDirection(e),s.setLength(r,o,a),s}st(e,t);var n=e.prototype;return n.setDirection=function(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{du.set(t.z,0,-t.x).normalize();var e=Math.acos(t.y);this.quaternion.setFromAxisAngle(du,e)}},n.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},n.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},n.copy=function(e){return t.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},e}(Se),fu=function(t){function e(e){var n;void 0===e&&(e=1);var r=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=new xn;i.setAttribute("position",new cn(r,3)),i.setAttribute("color",new cn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var o=new Io({vertexColors:!0,toneMapped:!1});return(n=t.call(this,i,o)||this).type="AxesHelper",n}return st(e,t),e}(Uo),mu=new Float32Array(1),yu=new Int32Array(mu.buffer),_u={toHalfFloat:function(t){mu[0]=t;var e=yu[0],n=e>>16&32768,r=e>>12&2047,i=e>>23&255;return i<103?n:i>142?(n|=31744,n|=(255==i?0:1)&&8388607&e):i<113?n|=((r|=2048)>>114-i)+(r>>113-i&1):(n|=i-112<<10|r>>1,n+=1&r)}},gu=Math.pow(2,8),vu=[.125,.215,.35,.446,.526,.582],bu=5+vu.length,xu=20,wu=((su={})[3e3]=0,su[3001]=1,su[3002]=2,su[3004]=3,su[3005]=4,su[3006]=5,su[3007]=6,su),Eu=new Ze({side:1,depthWrite:!1,depthTest:!1}),Tu=new Hn(new Nn,Eu),Su=new bl,Mu=function(){for(var t=[],e=[],n=[],r=8,i=0;i<bu;i++){var o=Math.pow(2,r);e.push(o);var a=1/o;i>4?a=vu[i-8+4-1]:0==i&&(a=0),n.push(a);for(var s=1/(o-1),l=-s/2,c=1+s/2,u=[l,l,c,l,c,c,l,l,c,c,l,c],p=new Float32Array(108),d=new Float32Array(72),h=new Float32Array(36),f=0;f<6;f++){var m=f%3*2/3-1,y=f>2?0:-1,_=[m,y,0,m+2/3,y,0,m+2/3,y+1,0,m,y,0,m+2/3,y+1,0,m,y+1,0];p.set(_,18*f),d.set(u,12*f);var g=[f,f,f,f,f,f];h.set(g,6*f)}var v=new xn;v.setAttribute("position",new $e(p,3)),v.setAttribute("uv",new $e(d,2)),v.setAttribute("faceIndex",new $e(h,1)),t.push(v),r>4&&r--}return{_lodPlanes:t,_sizeLods:e,_sigmas:n}}(),ju=Mu._lodPlanes,Cu=Mu._sizeLods,zu=Mu._sigmas,Ru=new Qe,Au=null,Lu=(1+Math.sqrt(5))/2,Iu=1/Lu,Pu=[new Mt(1,1,1),new Mt(-1,1,1),new Mt(1,1,-1),new Mt(-1,1,-1),new Mt(0,Lu,Iu),new Mt(0,Lu,-Iu),new Mt(Iu,0,Lu),new Mt(-Iu,0,Lu),new Mt(Lu,Iu,0),new Mt(-Lu,Iu,0)];function Ou(t){var e=Math.max(t.r,t.g,t.b),n=Math.min(Math.max(Math.ceil(Math.log2(e)),-128),127);return t.multiplyScalar(Math.pow(2,-n)),(n+128)/255}var ku=function(){function t(t){var e,n,r;this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=(e=xu,n=new Float32Array(e),r=new Mt(0,1,0),new es({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r},inputEncoding:{value:wu[3e3]},outputEncoding:{value:wu[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}var e=t.prototype;return e.fromScene=function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=.1),void 0===r&&(r=100),Au=this._renderer.getRenderTarget();var i=this._allocateTargets();return this._sceneToCubeUV(t,n,r,i),e>0&&this._blur(i,0,0,e),this._applyPMREM(i),this._cleanup(i),i},e.fromEquirectangular=function(t){return this._fromTexture(t)},e.fromCubemap=function(t){return this._fromTexture(t)},e.compileCubemapShader=function(){null===this._cubemapShader&&(this._cubemapShader=Fu(),this._compileMaterial(this._cubemapShader))},e.compileEquirectangularShader=function(){null===this._equirectShader&&(this._equirectShader=Hu(),this._compileMaterial(this._equirectShader))},e.dispose=function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var t=0;t<ju.length;t++)ju[t].dispose()},e._cleanup=function(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Au),t.scissorTest=!1,Du(t,0,0,t.width,t.height)},e._fromTexture=function(t){Au=this._renderer.getRenderTarget();var e=this._allocateTargets(t);return this._textureToCubeUV(t,e),this._applyPMREM(e),this._cleanup(e),e},e._allocateTargets=function(t){var e={magFilter:f,minFilter:f,generateMipmaps:!1,type:v,format:1023,encoding:function(t){return void 0!==t&&t.type===v&&(t.encoding===X||t.encoding===Y||t.encoding===Q)}(t)?t.encoding:Z,depthBuffer:!1},n=Bu(e);return n.depthBuffer=!t,this._pingPongRenderTarget=Bu(e),n},e._compileMaterial=function(t){var e=new Hn(ju[0],t);this._renderer.compile(e,Su)},e._sceneToCubeUV=function(t,e,n,r){var i=new Xn(90,1,e,n),o=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],s=this._renderer,l=s.autoClear,c=s.outputEncoding,u=s.toneMapping;s.getClearColor(Ru),s.toneMapping=0,s.outputEncoding=X,s.autoClear=!1;var p=!1,d=t.background;if(d){if(d.isColor){Eu.color.copy(d).convertSRGBToLinear(),t.background=null;var h=Ou(Eu.color);Eu.opacity=h,p=!0}}else{Eu.color.copy(Ru).convertSRGBToLinear();var f=Ou(Eu.color);Eu.opacity=f,p=!0}for(var m=0;m<6;m++){var y=m%3;0==y?(i.up.set(0,o[m],0),i.lookAt(a[m],0,0)):1==y?(i.up.set(0,0,o[m]),i.lookAt(0,a[m],0)):(i.up.set(0,o[m],0),i.lookAt(0,0,a[m])),Du(r,y*gu,m>2?gu:0,gu,gu),s.setRenderTarget(r),p&&s.render(Tu,i),s.render(t,i)}s.toneMapping=u,s.outputEncoding=c,s.autoClear=l},e._textureToCubeUV=function(t,e){var n=this._renderer;t.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=Fu()):null==this._equirectShader&&(this._equirectShader=Hu());var r=t.isCubeTexture?this._cubemapShader:this._equirectShader,i=new Hn(ju[0],r),o=r.uniforms;o.envMap.value=t,t.isCubeTexture||o.texelSize.value.set(1/t.image.width,1/t.image.height),o.inputEncoding.value=wu[t.encoding],o.outputEncoding.value=wu[e.texture.encoding],Du(e,0,0,3*gu,2*gu),n.setRenderTarget(e),n.render(i,Su)},e._applyPMREM=function(t){var e=this._renderer,n=e.autoClear;e.autoClear=!1;for(var r=1;r<bu;r++){var i=Math.sqrt(zu[r]*zu[r]-zu[r-1]*zu[r-1]),o=Pu[(r-1)%Pu.length];this._blur(t,r-1,r,i,o)}e.autoClear=n},e._blur=function(t,e,n,r,i){var o=this._pingPongRenderTarget;this._halfBlur(t,o,e,n,r,"latitudinal",i),this._halfBlur(o,t,n,n,r,"longitudinal",i)},e._halfBlur=function(t,e,n,r,i,o,a){var s=this._renderer,l=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");var c=new Hn(ju[r],l),u=l.uniforms,p=Cu[n]-1,d=isFinite(i)?Math.PI/(2*p):2*Math.PI/39,h=i/d,f=isFinite(i)?1+Math.floor(3*h):xu;f>xu&&console.warn("sigmaRadians, "+i+", is too large and will clip, as it requested "+f+" samples when the maximum is set to "+xu);for(var m=[],y=0,_=0;_<xu;++_){var g=_/h,v=Math.exp(-g*g/2);m.push(v),0==_?y+=v:_<f&&(y+=2*v)}for(var b=0;b<m.length;b++)m[b]=m[b]/y;u.envMap.value=t.texture,u.samples.value=f,u.weights.value=m,u.latitudinal.value="latitudinal"===o,a&&(u.poleAxis.value=a),u.dTheta.value=d,u.mipInt.value=8-n,u.inputEncoding.value=wu[t.texture.encoding],u.outputEncoding.value=wu[t.texture.encoding];var x=Cu[r];Du(e,3*Math.max(0,gu-2*x),(0===r?0:2*gu)+2*x*(r>4?r-8+4:0),3*x,2*x),s.setRenderTarget(e),s.render(c,Su)},t}();function Bu(t){var e=new Et(3*gu,3*gu,t);return e.texture.mapping=c,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function Du(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function Hu(){var t=new mt(1,1);return new es({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:t},inputEncoding:{value:wu[3e3]},outputEncoding:{value:wu[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Fu(){return new es({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:wu[3e3]},outputEncoding:{value:wu[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}Ds.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(Ds.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},ol.prototype.fromPoints=function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)},Qc.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Vc.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},zs.prototype.extractUrlBase=function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Cl.extractUrlBase(t)},zs.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Ic.prototype.center=function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},Ic.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ic.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},Ic.prototype.size=function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)},zt.prototype.center=function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},zt.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},zt.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},zt.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},zt.prototype.size=function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)},Wt.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},er.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},kc.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},ft.random16=function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},ft.nearestPowerOfTwo=function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),ft.floorPowerOfTwo(t)},ft.nextPowerOfTwo=function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),ft.ceilPowerOfTwo(t)},_t.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},_t.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},_t.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},_t.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},_t.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},_t.prototype.getInverse=function(t){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},te.prototype.extractPosition=function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},te.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},te.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Mt).setFromMatrixColumn(this,3)},te.prototype.setRotationFromQuaternion=function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},te.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},te.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},te.prototype.multiplyVector4=function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},te.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},te.prototype.rotateAxis=function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},te.prototype.crossVector=function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},te.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},te.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},te.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},te.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},te.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},te.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},te.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},te.prototype.makeFrustum=function(t,e,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,r,n,i,o)},te.prototype.getInverse=function(t){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},ze.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},St.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},St.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},$t.prototype.isIntersectionBox=function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},$t.prototype.isIntersectionPlane=function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},$t.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},Fe.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Fe.prototype.barycoordFromPoint=function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},Fe.prototype.midpoint=function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},Fe.prototypenormal=function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},Fe.prototype.plane=function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)},Fe.barycoordFromPoint=function(t,e,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Fe.getBarycoord(t,e,n,r,i)},Fe.normal=function(t,e,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Fe.getNormal(t,e,n,r)},al.prototype.extractAllPoints=function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},al.prototype.extrude=function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Da(this,t)},al.prototype.makeGeometry=function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Wa(this,t)},mt.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},mt.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},mt.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Mt.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},Mt.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},Mt.prototype.getPositionFromMatrix=function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},Mt.prototype.getScaleFromMatrix=function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},Mt.prototype.getColumnFromMatrix=function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},Mt.prototype.applyProjection=function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},Mt.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},Mt.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},Mt.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},wt.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},wt.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Se.prototype.getChildByName=function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},Se.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Se.prototype.translate=function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},Se.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Se.prototype.applyMatrix=function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(Se.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Hn.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Hn.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(_o.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(jo.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Eo.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Ds.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),Xn.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(sl.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties($e.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===nt},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(nt)}}}),$e.prototype.setDynamic=function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?nt:et),this},$e.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},$e.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},xn.prototype.addIndex=function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},xn.prototype.addAttribute=function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new $e(arguments[1],arguments[2])))},xn.prototype.addDrawCall=function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},xn.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},xn.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},xn.prototype.removeAttribute=function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},xn.prototype.applyMatrix=function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(xn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(zl.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),Object.defineProperties(jc.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Object.defineProperties(Qi.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===nt},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Qi.prototype.setDynamic=function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?nt:et),this},Qi.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Da.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Da.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Da.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Yi.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Object.defineProperties(Tc.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Ue.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Qe}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(is.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(rs.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(t){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=t}}}),Object.defineProperties(Wn.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Gi.prototype.clearTarget=function(t,e,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,n,r)},Gi.prototype.animate=function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},Gi.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Gi.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Gi.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Gi.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Gi.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Gi.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Gi.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Gi.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Gi.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Gi.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Gi.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Gi.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Gi.prototype.enableScissorTest=function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},Gi.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Gi.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Gi.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Gi.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Gi.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Gi.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Gi.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Gi.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Gi.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Gi.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Gi.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?Y:X}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(ki.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Et.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(nc.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new Vl).load(t,function(t){e.setBuffer(t)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),lc.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Qn.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},Qn.prototype.clear=function(t,e,n,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(t,e,n,r)},gt.crossOrigin=void 0,gt.loadTexture=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new Bs;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},gt.loadTextureCube=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Os;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},gt.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},gt.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var Nu={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:n}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=n),t.ACESFilmicToneMapping=4,t.AddEquation=r,t.AddOperation=2,t.AdditiveAnimationBlendMode=q,t.AdditiveBlending=2,t.AlphaFormat=1021,t.AlwaysDepth=1,t.AlwaysStencilFunc=519,t.AmbientLight=El,t.AmbientLightProbe=Wl,t.AnimationClip=Ts,t.AnimationLoader=Ls,t.AnimationMixer=Ec,t.AnimationObjectGroup=xc,t.AnimationUtils=ps,t.ArcCurve=Fs,t.ArrayCamera=Fi,t.ArrowHelper=hu,t.Audio=nc,t.AudioAnalyser=lc,t.AudioContext=Ul,t.AudioListener=ec,t.AudioLoader=Vl,t.AxesHelper=fu,t.AxisHelper=function(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new fu(t)},t.BackSide=1,t.BasicDepthPacking=3200,t.BasicShadowMap=0,t.BinaryTextureLoader=function(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new ks(t)},t.Bone=To,t.BooleanKeyframeTrack=_s,t.BoundingBoxHelper=function(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new cu(t,e)},t.Box2=Ic,t.Box3=zt,t.Box3Helper=uu,t.BoxBufferGeometry=Nn,t.BoxGeometry=Nn,t.BoxHelper=cu,t.BufferAttribute=$e,t.BufferGeometry=xn,t.BufferGeometryLoader=Al,t.ByteType=1010,t.Cache=Ms,t.Camera=qn,t.CameraHelper=ru,t.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},t.CanvasTexture=$o,t.CatmullRomCurve3=qs,t.CineonToneMapping=3,t.CircleBufferGeometry=ea,t.CircleGeometry=ea,t.ClampToEdgeWrapping=d,t.Clock=Ql,t.Color=Qe,t.ColorKeyframeTrack=gs,t.CompressedTexture=Ko,t.CompressedTextureLoader=Is,t.ConeBufferGeometry=ra,t.ConeGeometry=ra,t.CubeCamera=Qn,t.CubeReflectionMapping=o,t.CubeRefractionMapping=a,t.CubeTexture=Zn,t.CubeTextureLoader=Os,t.CubeUVReflectionMapping=c,t.CubeUVRefractionMapping=u,t.CubicBezierCurve=Zs,t.CubicBezierCurve3=Js,t.CubicInterpolant=hs,t.CullFaceBack=1,t.CullFaceFront=2,t.CullFaceFrontBack=3,t.CullFaceNone=0,t.Curve=Ds,t.CurvePath=il,t.CustomBlending=5,t.CustomToneMapping=5,t.CylinderBufferGeometry=na,t.CylinderGeometry=na,t.Cylindrical=Ac,t.DataTexture=Kn,t.DataTexture2DArray=dr,t.DataTexture3D=hr,t.DataTextureLoader=ks,t.DataUtils=_u,t.DecrementStencilOp=7683,t.DecrementWrapStencilOp=34056,t.DefaultLoadingManager=Cs,t.DepthFormat=j,t.DepthStencilFormat=C,t.DepthTexture=ta,t.DirectionalLight=wl,t.DirectionalLightHelper=tu,t.DiscreteInterpolant=ms,t.DodecahedronBufferGeometry=oa,t.DodecahedronGeometry=oa,t.DoubleSide=2,t.DstAlphaFactor=206,t.DstColorFactor=208,t.DynamicBufferAttribute=function(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new $e(t,e).setUsage(nt)},t.DynamicCopyUsage=35050,t.DynamicDrawUsage=nt,t.DynamicReadUsage=35049,t.EdgesGeometry=ua,t.EdgesHelper=function(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Uo(new ua(t.geometry),new Io({color:void 0!==e?e:16777215}))},t.EllipseCurve=Hs,t.EqualDepth=4,t.EqualStencilFunc=514,t.EquirectangularReflectionMapping=s,t.EquirectangularRefractionMapping=l,t.Euler=ue,t.EventDispatcher=ut,t.ExtrudeBufferGeometry=Da,t.ExtrudeGeometry=Da,t.FaceColors=1,t.FileLoader=As,t.FlatShading=1,t.Float16BufferAttribute=ln,t.Float32Attribute=function(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new cn(t,e)},t.Float32BufferAttribute=cn,t.Float64Attribute=function(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new un(t,e)},t.Float64BufferAttribute=un,t.FloatType=w,t.Fog=Xi,t.FogExp2=qi,t.Font=Dl,t.FontLoader=Nl,t.FrontSide=0,t.Frustum=er,t.GLBufferAttribute=Mc,t.GLSL1="100",t.GLSL3=rt,t.GammaEncoding=Q,t.GreaterDepth=6,t.GreaterEqualDepth=5,t.GreaterEqualStencilFunc=518,t.GreaterStencilFunc=516,t.GridHelper=Qc,t.Group=Ni,t.HalfFloatType=E,t.HemisphereLight=ll,t.HemisphereLightHelper=Yc,t.HemisphereLightProbe=Gl,t.IcosahedronBufferGeometry=Fa,t.IcosahedronGeometry=Fa,t.ImageBitmapLoader=kl,t.ImageLoader=Ps,t.ImageUtils=gt,t.ImmediateRenderObject=Bc,t.IncrementStencilOp=7682,t.IncrementWrapStencilOp=34055,t.InstancedBufferAttribute=Rl,t.InstancedBufferGeometry=zl,t.InstancedInterleavedBuffer=Sc,t.InstancedMesh=Lo,t.Int16Attribute=function(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new rn(t,e)},t.Int16BufferAttribute=rn,t.Int32Attribute=function(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new an(t,e)},t.Int32BufferAttribute=an,t.Int8Attribute=function(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new tn(t,e)},t.Int8BufferAttribute=tn,t.IntType=1013,t.InterleavedBuffer=Qi,t.InterleavedBufferAttribute=Ji,t.Interpolant=ds,t.InterpolateDiscrete=H,t.InterpolateLinear=F,t.InterpolateSmooth=N,t.InvertStencilOp=5386,t.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},t.KeepStencilOp=tt,t.KeyframeTrack=ys,t.LOD=_o,t.LatheBufferGeometry=Na,t.LatheGeometry=Na,t.Layers=pe,t.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},t.LessDepth=2,t.LessEqualDepth=3,t.LessEqualStencilFunc=515,t.LessStencilFunc=513,t.Light=sl,t.LightProbe=Ml,t.Line=Ho,t.Line3=kc,t.LineBasicMaterial=Io,t.LineCurve=Ks,t.LineCurve3=$s,t.LineDashedMaterial=cs,t.LineLoop=Vo,t.LinePieces=1,t.LineSegments=Uo,t.LineStrip=0,t.LinearEncoding=X,t.LinearFilter=_,t.LinearInterpolant=fs,t.LinearMipMapLinearFilter=1008,t.LinearMipMapNearestFilter=1007,t.LinearMipmapLinearFilter=g,t.LinearMipmapNearestFilter=1007,t.LinearToneMapping=1,t.Loader=zs,t.LoaderUtils=Cl,t.LoadingManager=js,t.LogLuvEncoding=3003,t.LoopOnce=2200,t.LoopPingPong=2202,t.LoopRepeat=2201,t.LuminanceAlphaFormat=1025,t.LuminanceFormat=1024,t.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},t.Material=Ue,t.MaterialLoader=jl,t.Math=ft,t.MathUtils=ft,t.Matrix3=_t,t.Matrix4=te,t.MaxEquation=104,t.Mesh=Hn,t.MeshBasicMaterial=Ze,t.MeshDepthMaterial=Pi,t.MeshDistanceMaterial=Oi,t.MeshFaceMaterial=function(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t},t.MeshLambertMaterial=ss,t.MeshMatcapMaterial=ls,t.MeshNormalMaterial=as,t.MeshPhongMaterial=is,t.MeshPhysicalMaterial=rs,t.MeshStandardMaterial=ns,t.MeshToonMaterial=os,t.MinEquation=103,t.MirroredRepeatWrapping=h,t.MixOperation=1,t.MultiMaterial=function(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t},t.MultiplyBlending=4,t.MultiplyOperation=0,t.NearestFilter=f,t.NearestMipMapLinearFilter=1005,t.NearestMipMapNearestFilter=1004,t.NearestMipmapLinearFilter=y,t.NearestMipmapNearestFilter=m,t.NeverDepth=0,t.NeverStencilFunc=512,t.NoBlending=0,t.NoColors=0,t.NoToneMapping=0,t.NormalAnimationBlendMode=W,t.NormalBlending=1,t.NotEqualDepth=7,t.NotEqualStencilFunc=517,t.NumberKeyframeTrack=vs,t.Object3D=Se,t.ObjectLoader=Ll,t.ObjectSpaceNormalMap=1,t.OctahedronBufferGeometry=Ua,t.OctahedronGeometry=Ua,t.OneFactor=201,t.OneMinusDstAlphaFactor=207,t.OneMinusDstColorFactor=209,t.OneMinusSrcAlphaFactor=205,t.OneMinusSrcColorFactor=203,t.OrthographicCamera=bl,t.PCFShadowMap=1,t.PCFSoftShadowMap=2,t.PMREMGenerator=ku,t.ParametricBufferGeometry=Va,t.ParametricGeometry=Va,t.Particle=function(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new ho(t)},t.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Go(t)},t.ParticleSystem=function(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Qo(t,e)},t.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Go(t)},t.Path=ol,t.PerspectiveCamera=Xn,t.Plane=ze,t.PlaneBufferGeometry=rr,t.PlaneGeometry=rr,t.PlaneHelper=pu,t.PointCloud=function(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Qo(t,e)},t.PointCloudMaterial=function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Go(t)},t.PointLight=vl,t.PointLightHelper=Gc,t.Points=Qo,t.PointsMaterial=Go,t.PolarGridHelper=Zc,t.PolyhedronBufferGeometry=ia,t.PolyhedronGeometry=ia,t.PositionalAudio=sc,t.PropertyBinding=bc,t.PropertyMixer=cc,t.QuadraticBezierCurve=tl,t.QuadraticBezierCurve3=el,t.Quaternion=St,t.QuaternionKeyframeTrack=xs,t.QuaternionLinearInterpolant=bs,t.REVISION=n,t.RGBADepthPacking=3201,t.RGBAFormat=M,t.RGBAIntegerFormat=1033,t.RGBA_ASTC_10x10_Format=37819,t.RGBA_ASTC_10x5_Format=37816,t.RGBA_ASTC_10x6_Format=37817,t.RGBA_ASTC_10x8_Format=37818,t.RGBA_ASTC_12x10_Format=37820,t.RGBA_ASTC_12x12_Format=37821,t.RGBA_ASTC_4x4_Format=37808,t.RGBA_ASTC_5x4_Format=37809,t.RGBA_ASTC_5x5_Format=37810,t.RGBA_ASTC_6x5_Format=37811,t.RGBA_ASTC_6x6_Format=37812,t.RGBA_ASTC_8x5_Format=37813,t.RGBA_ASTC_8x6_Format=37814,t.RGBA_ASTC_8x8_Format=37815,t.RGBA_BPTC_Format=36492,t.RGBA_ETC2_EAC_Format=D,t.RGBA_PVRTC_2BPPV1_Format=k,t.RGBA_PVRTC_4BPPV1_Format=O,t.RGBA_S3TC_DXT1_Format=R,t.RGBA_S3TC_DXT3_Format=A,t.RGBA_S3TC_DXT5_Format=L,t.RGBDEncoding=$,t.RGBEEncoding=Z,t.RGBEFormat=1023,t.RGBFormat=S,t.RGBIntegerFormat=1032,t.RGBM16Encoding=K,t.RGBM7Encoding=J,t.RGB_ETC1_Format=36196,t.RGB_ETC2_Format=B,t.RGB_PVRTC_2BPPV1_Format=P,t.RGB_PVRTC_4BPPV1_Format=I,t.RGB_S3TC_DXT1_Format=z,t.RGFormat=1030,t.RGIntegerFormat=1031,t.RawShaderMaterial=es,t.Ray=$t,t.Raycaster=jc,t.RectAreaLight=Tl,t.RedFormat=1028,t.RedIntegerFormat=1029,t.ReinhardToneMapping=2,t.RepeatWrapping=p,t.ReplaceStencilOp=7681,t.ReverseSubtractEquation=102,t.RingBufferGeometry=Ga,t.RingGeometry=Ga,t.SRGB8_ALPHA8_ASTC_10x10_Format=37851,t.SRGB8_ALPHA8_ASTC_10x5_Format=37848,t.SRGB8_ALPHA8_ASTC_10x6_Format=37849,t.SRGB8_ALPHA8_ASTC_10x8_Format=37850,t.SRGB8_ALPHA8_ASTC_12x10_Format=37852,t.SRGB8_ALPHA8_ASTC_12x12_Format=37853,t.SRGB8_ALPHA8_ASTC_4x4_Format=37840,t.SRGB8_ALPHA8_ASTC_5x4_Format=37841,t.SRGB8_ALPHA8_ASTC_5x5_Format=37842,t.SRGB8_ALPHA8_ASTC_6x5_Format=37843,t.SRGB8_ALPHA8_ASTC_6x6_Format=37844,t.SRGB8_ALPHA8_ASTC_8x5_Format=37845,t.SRGB8_ALPHA8_ASTC_8x6_Format=37846,t.SRGB8_ALPHA8_ASTC_8x8_Format=37847,t.Scene=Yi,t.SceneUtils=Nu,t.ShaderChunk=ir,t.ShaderLib=ar,t.ShaderMaterial=Wn,t.ShadowMaterial=ts,t.Shape=al,t.ShapeBufferGeometry=Wa,t.ShapeGeometry=Wa,t.ShapePath=Bl,t.ShapeUtils=Oa,t.ShortType=1011,t.Skeleton=jo,t.SkeletonHelper=Vc,t.SkinnedMesh=Eo,t.SmoothShading=2,t.Sphere=Wt,t.SphereBufferGeometry=qa,t.SphereGeometry=qa,t.Spherical=Rc,t.SphericalHarmonics3=Sl,t.SplineCurve=nl,t.SpotLight=fl,t.SpotLightHelper=Hc,t.Sprite=ho,t.SpriteMaterial=$i,t.SrcAlphaFactor=204,t.SrcAlphaSaturateFactor=210,t.SrcColorFactor=202,t.StaticCopyUsage=35046,t.StaticDrawUsage=et,t.StaticReadUsage=35045,t.StereoCamera=Yl,t.StreamCopyUsage=35042,t.StreamDrawUsage=35040,t.StreamReadUsage=35041,t.StringKeyframeTrack=ws,t.SubtractEquation=101,t.SubtractiveBlending=3,t.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},t.TangentSpaceNormalMap=0,t.TetrahedronBufferGeometry=Xa,t.TetrahedronGeometry=Xa,t.TextBufferGeometry=Ya,t.TextGeometry=Ya,t.Texture=bt,t.TextureLoader=Bs,t.TorusBufferGeometry=Qa,t.TorusGeometry=Qa,t.TorusKnotBufferGeometry=Za,t.TorusKnotGeometry=Za,t.Triangle=Fe,t.TriangleFanDrawMode=2,t.TriangleStripDrawMode=1,t.TrianglesDrawMode=0,t.TubeBufferGeometry=Ja,t.TubeGeometry=Ja,t.UVMapping=i,t.Uint16Attribute=function(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new on(t,e)},t.Uint16BufferAttribute=on,t.Uint32Attribute=function(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new sn(t,e)},t.Uint32BufferAttribute=sn,t.Uint8Attribute=function(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new en(t,e)},t.Uint8BufferAttribute=en,t.Uint8ClampedAttribute=function(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new nn(t,e)},t.Uint8ClampedBufferAttribute=nn,t.Uniform=Tc,t.UniformsLib=or,t.UniformsUtils=Gn,t.UnsignedByteType=v,t.UnsignedInt248Type=T,t.UnsignedIntType=x,t.UnsignedShort4444Type=1017,t.UnsignedShort5551Type=1018,t.UnsignedShort565Type=1019,t.UnsignedShortType=b,t.VSMShadowMap=3,t.Vector2=mt,t.Vector3=Mt,t.Vector4=wt,t.VectorKeyframeTrack=Es,t.Vertex=function(t,e,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Mt(t,e,n)},t.VertexColors=2,t.VideoTexture=Jo,t.WebGL1Renderer=Wi,t.WebGLCubeRenderTarget=Jn,t.WebGLMultisampleRenderTarget=Tt,t.WebGLRenderTarget=Et,t.WebGLRenderTargetCube=function(t,e,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Jn(t,n)},t.WebGLRenderer=Gi,t.WebGLUtils=Hi,t.WireframeGeometry=Ka,t.WireframeHelper=function(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Uo(new Ka(t.geometry),new Io({color:void 0!==e?e:16777215}))},t.WrapAroundEnding=G,t.XHRLoader=function(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new As(t)},t.ZeroCurvatureEnding=U,t.ZeroFactor=200,t.ZeroSlopeEnding=V,t.ZeroStencilOp=0,t.sRGBEncoding=Y,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).THREE={}),THREE.GLTFLoader=function(){function t(t){THREE.Loader.call(this,t),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new i(t)}),this.register(function(t){return new a(t)}),this.register(function(t){return new s(t)}),this.register(function(t){return new o(t)}),this.register(function(t){return new n(t)}),this.register(function(t){return new l(t)})}t.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:t,load:function(t,e,n,r){var i,o=this;i=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:THREE.LoaderUtils.extractUrlBase(t),this.manager.itemStart(t);var a=function(e){r?r(e):console.error(e),o.manager.itemError(t),o.manager.itemEnd(t)},s=new THREE.FileLoader(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,function(n){try{o.parse(n,i,function(n){e(n),o.manager.itemEnd(t)},a)}catch(t){a(t)}},n,a)},setDRACOLoader:function(t){return this.dracoLoader=t,this},setDDSLoader:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')},setKTX2Loader:function(t){return this.ktx2Loader=t,this},setMeshoptDecoder:function(t){return this.meshoptDecoder=t,this},register:function(t){return-1===this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.push(t),this},unregister:function(t){return-1!==this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this},parse:function(t,n,i,o){var a,s={},l={};if("string"==typeof t)a=t;else if(THREE.LoaderUtils.decodeText(new Uint8Array(t,0,4))===c){try{s[e.KHR_BINARY_GLTF]=new function(t){this.name=e.KHR_BINARY_GLTF,this.content=null,this.body=null;var n=new DataView(t,0,u);if(this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(t.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==c)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var r=this.header.length-u,i=new DataView(t,u),o=0;o<r;){var a=i.getUint32(o,!0);o+=4;var s=i.getUint32(o,!0);if(o+=4,s===p.JSON){var l=new Uint8Array(t,u+o,a);this.content=THREE.LoaderUtils.decodeText(l)}else if(s===p.BIN){var d=u+o;this.body=t.slice(d,d+a)}o+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}(t)}catch(t){return void(o&&o(t))}a=s[e.KHR_BINARY_GLTF].content}else a=THREE.LoaderUtils.decodeText(new Uint8Array(t));var f=JSON.parse(a);if(void 0===f.asset||f.asset.version[0]<2)o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var _=new R(f,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});_.fileLoader.setRequestHeader(this.requestHeader);for(var g=0;g<this.pluginCallbacks.length;g++){var v=this.pluginCallbacks[g](_);l[v.name]=v,s[v.name]=!0}if(f.extensionsUsed)for(g=0;g<f.extensionsUsed.length;++g){var b=f.extensionsUsed[g],x=f.extensionsRequired||[];switch(b){case e.KHR_MATERIALS_UNLIT:s[b]=new r;break;case e.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:s[b]=new m;break;case e.KHR_DRACO_MESH_COMPRESSION:s[b]=new d(f,this.dracoLoader);break;case e.KHR_TEXTURE_TRANSFORM:s[b]=new h;break;case e.KHR_MESH_QUANTIZATION:s[b]=new y;break;default:x.indexOf(b)>=0&&void 0===l[b]&&console.warn('THREE.GLTFLoader: Unknown extension "'+b+'".')}}_.setExtensions(s),_.setPlugins(l),_.parse(i,o)}}});var e={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};function n(t){this.parser=t,this.name=e.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}function r(){this.name=e.KHR_MATERIALS_UNLIT}function i(t){this.parser=t,this.name=e.KHR_MATERIALS_CLEARCOAT}function o(t){this.parser=t,this.name=e.KHR_MATERIALS_TRANSMISSION}function a(t){this.parser=t,this.name=e.KHR_TEXTURE_BASISU}function s(t){this.parser=t,this.name=e.EXT_TEXTURE_WEBP,this.isSupported=null}function l(t){this.name=e.EXT_MESHOPT_COMPRESSION,this.parser=t}n.prototype._markDefs=function(){for(var t=this.parser,e=this.parser.json.nodes||[],n=0,r=e.length;n<r;n++){var i=e[n];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&t._addNodeRef(this.cache,i.extensions[this.name].light)}},n.prototype._loadLight=function(t){var e=this.parser,n="light:"+t,r=e.cache.get(n);if(r)return r;var i,o=e.json,a=((o.extensions&&o.extensions[this.name]||{}).lights||[])[t],s=new THREE.Color(16777215);void 0!==a.color&&s.fromArray(a.color);var l=void 0!==a.range?a.range:0;switch(a.type){case"directional":(i=new THREE.DirectionalLight(s)).target.position.set(0,0,-1),i.add(i.target);break;case"point":(i=new THREE.PointLight(s)).distance=l;break;case"spot":(i=new THREE.SpotLight(s)).distance=l,a.spot=a.spot||{},a.spot.innerConeAngle=void 0!==a.spot.innerConeAngle?a.spot.innerConeAngle:0,a.spot.outerConeAngle=void 0!==a.spot.outerConeAngle?a.spot.outerConeAngle:Math.PI/4,i.angle=a.spot.outerConeAngle,i.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,i.target.position.set(0,0,-1),i.add(i.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return i.position.set(0,0,0),i.decay=2,void 0!==a.intensity&&(i.intensity=a.intensity),i.name=e.createUniqueName(a.name||"light_"+t),r=Promise.resolve(i),e.cache.add(n,r),r},n.prototype.createNodeAttachment=function(t){var e=this,n=this.parser,r=n.json.nodes[t],i=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===i?null:this._loadLight(i).then(function(t){return n._getNodeRef(e.cache,i,t)})},r.prototype.getMaterialType=function(){return THREE.MeshBasicMaterial},r.prototype.extendParams=function(t,e,n){var r=[];t.color=new THREE.Color(1,1,1),t.opacity=1;var i=e.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){var o=i.baseColorFactor;t.color.fromArray(o),t.opacity=o[3]}void 0!==i.baseColorTexture&&r.push(n.assignTexture(t,"map",i.baseColorTexture))}return Promise.all(r)},i.prototype.getMaterialType=function(t){var e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?THREE.MeshPhysicalMaterial:null},i.prototype.extendMaterialParams=function(t,e){var n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(e.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&i.push(n.assignTexture(e,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(e.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&i.push(n.assignTexture(e,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(i.push(n.assignTexture(e,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){var a=o.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new THREE.Vector2(a,-a)}return Promise.all(i)},o.prototype.getMaterialType=function(t){var e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?THREE.MeshPhysicalMaterial:null},o.prototype.extendMaterialParams=function(t,e){var n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(e.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&i.push(n.assignTexture(e,"transmissionMap",o.transmissionTexture)),Promise.all(i)},a.prototype.loadTexture=function(t){var e=this.parser,n=e.json,r=n.textures[t];if(!r.extensions||!r.extensions[this.name])return null;var i=r.extensions[this.name],o=n.images[i.source],a=e.options.ktx2Loader;if(!a){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return e.loadTextureImage(t,o,a)},s.prototype.loadTexture=function(t){var e=this.name,n=this.parser,r=n.json,i=r.textures[t];if(!i.extensions||!i.extensions[e])return null;var o=i.extensions[e],a=r.images[o.source],s=n.textureLoader;if(a.uri){var l=n.options.manager.getHandler(a.uri);null!==l&&(s=l)}return this.detectSupport().then(function(i){if(i)return n.loadTextureImage(t,a,s);if(r.extensionsRequired&&r.extensionsRequired.indexOf(e)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(t)})},s.prototype.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise(function(t){var e=new Image;e.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e.onload=e.onerror=function(){t(1===e.height)}})),this.isSupported},l.prototype.loadBufferView=function(t){var e=this.parser.json,n=e.bufferViews[t];if(n.extensions&&n.extensions[this.name]){var r=n.extensions[this.name],i=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(e.extensionsRequired&&e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([i,o.ready]).then(function(t){var e=r.byteOffset||0,n=r.byteLength||0,i=r.count,a=r.byteStride,s=new ArrayBuffer(i*a),l=new Uint8Array(t[0],e,n);return o.decodeGltfBuffer(new Uint8Array(s),i,a,l,r.mode,r.filter),s})}return null};var c="glTF",u=12,p={JSON:1313821514,BIN:5130562};function d(t,n){if(!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=e.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=n,this.dracoLoader.preload()}function h(){this.name=e.KHR_TEXTURE_TRANSFORM}function f(t){THREE.MeshStandardMaterial.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var e=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),r=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),i=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),a={specular:{value:(new THREE.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(t){for(var s in a)t.uniforms[s]=a[s];t.fragmentShader=t.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",e).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",r).replace("#include <metalnessmap_fragment>",i).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(t){a.specular.value=t}},specularMap:{get:function(){return a.specularMap.value},set:function(t){a.specularMap.value=t,t?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(t){a.glossiness.value=t}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(t){a.glossinessMap.value=t,t?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(t)}function m(){return{name:e.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return f},extendParams:function(t,e,n){var r=e.extensions[this.name];t.color=new THREE.Color(1,1,1),t.opacity=1;var i=[];if(Array.isArray(r.diffuseFactor)){var o=r.diffuseFactor;t.color.fromArray(o),t.opacity=o[3]}if(void 0!==r.diffuseTexture&&i.push(n.assignTexture(t,"map",r.diffuseTexture)),t.emissive=new THREE.Color(0,0,0),t.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,t.specular=new THREE.Color(1,1,1),Array.isArray(r.specularFactor)&&t.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){var a=r.specularGlossinessTexture;i.push(n.assignTexture(t,"glossinessMap",a)),i.push(n.assignTexture(t,"specularMap",a))}return Promise.all(i)},createMaterial:function(t){var e=new f(t);return e.fog=!0,e.color=t.color,e.map=void 0===t.map?null:t.map,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=void 0===t.aoMap?null:t.aoMap,e.aoMapIntensity=1,e.emissive=t.emissive,e.emissiveIntensity=1,e.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,e.bumpMap=void 0===t.bumpMap?null:t.bumpMap,e.bumpScale=1,e.normalMap=void 0===t.normalMap?null:t.normalMap,e.normalMapType=THREE.TangentSpaceNormalMap,t.normalScale&&(e.normalScale=t.normalScale),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.specularMap=void 0===t.specularMap?null:t.specularMap,e.specular=t.specular,e.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,e.glossiness=t.glossiness,e.alphaMap=null,e.envMap=void 0===t.envMap?null:t.envMap,e.envMapIntensity=1,e.refractionRatio=.98,e}}}function y(){this.name=e.KHR_MESH_QUANTIZATION}function _(t,e,n,r){THREE.Interpolant.call(this,t,e,n,r)}d.prototype.decodePrimitive=function(t,e){var n=this.json,r=this.dracoLoader,i=t.extensions[this.name].bufferView,o=t.extensions[this.name].attributes,a={},s={},l={};for(var c in o){var u=w[c]||c.toLowerCase();a[u]=o[c]}for(c in t.attributes)if(u=w[c]||c.toLowerCase(),void 0!==o[c]){var p=n.accessors[t.attributes[c]],d=g[p.componentType];l[u]=d,s[u]=!0===p.normalized}return e.getDependency("bufferView",i).then(function(t){return new Promise(function(e){r.decodeDracoFile(t,function(t){for(var n in t.attributes){var r=t.attributes[n],i=s[n];void 0!==i&&(r.normalized=i)}e(t)},a,l)})})},h.prototype.extendTexture=function(t,e){return t=t.clone(),void 0!==e.offset&&t.offset.fromArray(e.offset),void 0!==e.rotation&&(t.rotation=e.rotation),void 0!==e.scale&&t.repeat.fromArray(e.scale),void 0!==e.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.needsUpdate=!0,t},f.prototype=Object.create(THREE.MeshStandardMaterial.prototype),f.prototype.constructor=f,f.prototype.copy=function(t){return THREE.MeshStandardMaterial.prototype.copy.call(this,t),this.specularMap=t.specularMap,this.specular.copy(t.specular),this.glossinessMap=t.glossinessMap,this.glossiness=t.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},_.prototype=Object.create(THREE.Interpolant.prototype),_.prototype.constructor=_,_.prototype.copySampleValue_=function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r*3+r,o=0;o!==r;o++)e[o]=n[i+o];return e},_.prototype.beforeStart_=_.prototype.copySampleValue_,_.prototype.afterEnd_=_.prototype.copySampleValue_,_.prototype.interpolate_=function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=2*a,l=3*a,c=r-e,u=(n-e)/c,p=u*u,d=p*u,h=t*l,f=h-l,m=-2*d+3*p,y=d-p,_=1-m,g=y-p+u,v=0;v!==a;v++){var b=o[f+v+a],x=o[f+v+s]*c,w=o[h+v+a],E=o[h+v]*c;i[v]=_*b+g*x+m*w+y*E}return i};var g={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},v={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipmapNearestFilter,9985:THREE.LinearMipmapNearestFilter,9986:THREE.NearestMipmapLinearFilter,9987:THREE.LinearMipmapLinearFilter},b={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},x={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},w={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},E={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},T={CUBICSPLINE:void 0,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete};function S(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)?t:/^data:.*,.*$/i.test(t)?t:/^blob:.*$/i.test(t)?t:e+t)}function M(t,e,n){for(var r in n.extensions)void 0===t[r]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=n.extensions[r])}function j(t,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function C(t,e){if(t.updateMorphTargets(),void 0!==e.weights)for(var n=0,r=e.weights.length;n<r;n++)t.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){var i=e.extras.targetNames;if(t.morphTargetInfluences.length===i.length)for(t.morphTargetDictionary={},n=0,r=i.length;n<r;n++)t.morphTargetDictionary[i[n]]=n;else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function z(t){for(var e="",n=Object.keys(t).sort(),r=0,i=n.length;r<i;r++)e+=n[r]+":"+t[n[r]]+";";return e}function R(t,e){this.json=t||{},this.extensions={},this.plugins={},this.options=e||{},this.cache=new function(){var t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}},this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new THREE.ImageBitmapLoader(this.options.manager):this.textureLoader=new THREE.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new THREE.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function A(t,e,n){var r=e.attributes,i=[];function o(e,r){return n.getDependency("accessor",e).then(function(e){t.setAttribute(r,e)})}for(var a in r){var s=w[a]||a.toLowerCase();s in t.attributes||i.push(o(r[a],s))}if(void 0!==e.indices&&!t.index){var l=n.getDependency("accessor",e.indices).then(function(e){t.setIndex(e)});i.push(l)}return j(t,e),function(t,e,n){var r=e.attributes,i=new THREE.Box3;if(void 0!==r.POSITION){var o=(d=n.json.accessors[r.POSITION]).min,a=d.max;if(void 0!==o&&void 0!==a){i.set(new THREE.Vector3(o[0],o[1],o[2]),new THREE.Vector3(a[0],a[1],a[2]));var s=e.targets;if(void 0!==s){for(var l=new THREE.Vector3,c=new THREE.Vector3,u=0,p=s.length;u<p;u++){var d,h=s[u];void 0!==h.POSITION&&(o=(d=n.json.accessors[h.POSITION]).min,a=d.max,void 0!==o&&void 0!==a?(c.setX(Math.max(Math.abs(o[0]),Math.abs(a[0]))),c.setY(Math.max(Math.abs(o[1]),Math.abs(a[1]))),c.setZ(Math.max(Math.abs(o[2]),Math.abs(a[2]))),l.max(c)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION."))}i.expandByVector(l)}t.boundingBox=i;var f=new THREE.Sphere;i.getCenter(f.center),f.radius=i.min.distanceTo(i.max)/2,t.boundingSphere=f}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(t,e,n),Promise.all(i).then(function(){return void 0!==e.targets?function(t,e,n){for(var r=!1,i=!1,o=0,a=e.length;o<a&&(void 0!==(c=e[o]).POSITION&&(r=!0),void 0!==c.NORMAL&&(i=!0),!r||!i);o++);if(!r&&!i)return Promise.resolve(t);var s=[],l=[];for(o=0,a=e.length;o<a;o++){var c=e[o];if(r){var u=void 0!==c.POSITION?n.getDependency("accessor",c.POSITION):t.attributes.position;s.push(u)}i&&(u=void 0!==c.NORMAL?n.getDependency("accessor",c.NORMAL):t.attributes.normal,l.push(u))}return Promise.all([Promise.all(s),Promise.all(l)]).then(function(e){var n=e[0],o=e[1];return r&&(t.morphAttributes.position=n),i&&(t.morphAttributes.normal=o),t.morphTargetsRelative=!0,t})}(t,e.targets,n):t})}function L(t,e){var n=t.getIndex();if(null===n){var r=[],i=t.getAttribute("position");if(void 0===i)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(var o=0;o<i.count;o++)r.push(o);t.setIndex(r),n=t.getIndex()}var a=n.count-2,s=[];if(e===THREE.TriangleFanDrawMode)for(o=1;o<=a;o++)s.push(n.getX(0)),s.push(n.getX(o)),s.push(n.getX(o+1));else for(o=0;o<a;o++)o%2==0?(s.push(n.getX(o)),s.push(n.getX(o+1)),s.push(n.getX(o+2))):(s.push(n.getX(o+2)),s.push(n.getX(o+1)),s.push(n.getX(o)));s.length/3!==a&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var l=t.clone();return l.setIndex(s),l}return R.prototype.setExtensions=function(t){this.extensions=t},R.prototype.setPlugins=function(t){this.plugins=t},R.prototype.parse=function(t,e){var n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this._invokeAll(function(t){return t._markDefs&&t._markDefs()}),Promise.all(this._invokeAll(function(t){return t.beforeRoot&&t.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(e){var o={scene:e[0][r.scene||0],scenes:e[0],animations:e[1],cameras:e[2],asset:r.asset,parser:n,userData:{}};M(i,o,r),j(o,r),Promise.all(n._invokeAll(function(t){return t.afterRoot&&t.afterRoot(o)})).then(function(){t(o)})}).catch(e)},R.prototype._markDefs=function(){for(var t=this.json.nodes||[],e=this.json.skins||[],n=this.json.meshes||[],r=0,i=e.length;r<i;r++)for(var o=e[r].joints,a=0,s=o.length;a<s;a++)t[o[a]].isBone=!0;for(var l=0,c=t.length;l<c;l++){var u=t[l];void 0!==u.mesh&&(this._addNodeRef(this.meshCache,u.mesh),void 0!==u.skin&&(n[u.mesh].isSkinnedMesh=!0)),void 0!==u.camera&&this._addNodeRef(this.cameraCache,u.camera)}},R.prototype._addNodeRef=function(t,e){void 0!==e&&(void 0===t.refs[e]&&(t.refs[e]=t.uses[e]=0),t.refs[e]++)},R.prototype._getNodeRef=function(t,e,n){if(t.refs[e]<=1)return n;var r=n.clone();return r.name+="_instance_"+t.uses[e]++,r},R.prototype._invokeOne=function(t){var e=Object.values(this.plugins);e.push(this);for(var n=0;n<e.length;n++){var r=t(e[n]);if(r)return r}},R.prototype._invokeAll=function(t){var e=Object.values(this.plugins);e.unshift(this);for(var n=[],r=0;r<e.length;r++){var i=t(e[r]);i&&n.push(i)}return n},R.prototype.getDependency=function(t,e){var n=t+":"+e,r=this.cache.get(n);if(!r){switch(t){case"scene":r=this.loadScene(e);break;case"node":r=this.loadNode(e);break;case"mesh":r=this._invokeOne(function(t){return t.loadMesh&&t.loadMesh(e)});break;case"accessor":r=this.loadAccessor(e);break;case"bufferView":r=this._invokeOne(function(t){return t.loadBufferView&&t.loadBufferView(e)});break;case"buffer":r=this.loadBuffer(e);break;case"material":r=this._invokeOne(function(t){return t.loadMaterial&&t.loadMaterial(e)});break;case"texture":r=this._invokeOne(function(t){return t.loadTexture&&t.loadTexture(e)});break;case"skin":r=this.loadSkin(e);break;case"animation":r=this.loadAnimation(e);break;case"camera":r=this.loadCamera(e);break;default:throw new Error("Unknown type: "+t)}this.cache.add(n,r)}return r},R.prototype.getDependencies=function(t){var e=this.cache.get(t);if(!e){var n=this,r=this.json[t+("mesh"===t?"es":"s")]||[];e=Promise.all(r.map(function(e,r){return n.getDependency(t,r)})),this.cache.add(t,e)}return e},R.prototype.loadBuffer=function(t){var n=this.json.buffers[t],r=this.fileLoader;if(n.type&&"arraybuffer"!==n.type)throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(void 0===n.uri&&0===t)return Promise.resolve(this.extensions[e.KHR_BINARY_GLTF].body);var i=this.options;return new Promise(function(t,e){r.load(S(n.uri,i.path),t,void 0,function(){e(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})},R.prototype.loadBufferView=function(t){var e=this.json.bufferViews[t];return this.getDependency("buffer",e.buffer).then(function(t){var n=e.byteLength||0,r=e.byteOffset||0;return t.slice(r,r+n)})},R.prototype.loadAccessor=function(t){var e=this,n=this.json,r=this.json.accessors[t];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);var i=[];return void 0!==r.bufferView?i.push(this.getDependency("bufferView",r.bufferView)):i.push(null),void 0!==r.sparse&&(i.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(i).then(function(t){var i,o,a=t[0],s=x[r.type],l=g[r.componentType],c=l.BYTES_PER_ELEMENT,u=c*s,p=r.byteOffset||0,d=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,h=!0===r.normalized;if(d&&d!==u){var f=Math.floor(p/d),m="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+f+":"+r.count,y=e.cache.get(m);y||(i=new l(a,f*d,r.count*d/c),y=new THREE.InterleavedBuffer(i,d/c),e.cache.add(m,y)),o=new THREE.InterleavedBufferAttribute(y,s,p%d/c,h)}else i=null===a?new l(r.count*s):new l(a,p,r.count*s),o=new THREE.BufferAttribute(i,s,h);if(void 0!==r.sparse){var _=x.SCALAR,v=g[r.sparse.indices.componentType],b=r.sparse.indices.byteOffset||0,w=r.sparse.values.byteOffset||0,E=new v(t[1],b,r.sparse.count*_),T=new l(t[2],w,r.sparse.count*s);null!==a&&(o=new THREE.BufferAttribute(o.array.slice(),o.itemSize,o.normalized));for(var S=0,M=E.length;S<M;S++){var j=E[S];if(o.setX(j,T[S*s]),s>=2&&o.setY(j,T[S*s+1]),s>=3&&o.setZ(j,T[S*s+2]),s>=4&&o.setW(j,T[S*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return o})},R.prototype.loadTexture=function(t){var e=this.json,n=this.options,r=e.textures[t],i=e.images[r.source],o=this.textureLoader;if(i.uri){var a=n.manager.getHandler(i.uri);null!==a&&(o=a)}return this.loadTextureImage(t,i,o)},R.prototype.loadTextureImage=function(t,e,n){var r=this,i=this.json,o=this.options,a=i.textures[t],s=self.URL||self.webkitURL,l=e.uri,c=!1,u=!0;if("image/jpeg"===e.mimeType&&(u=!1),void 0!==e.bufferView)l=r.getDependency("bufferView",e.bufferView).then(function(t){if("image/png"===e.mimeType){var n=new DataView(t,25,1).getUint8(0,!1);u=6===n||4===n||3===n}c=!0;var r=new Blob([t],{type:e.mimeType});return l=s.createObjectURL(r)});else if(void 0===e.uri)throw new Error("THREE.GLTFLoader: Image "+t+" is missing URI and bufferView");return Promise.resolve(l).then(function(t){return new Promise(function(e,r){var i=e;!0===n.isImageBitmapLoader&&(i=function(t){e(new THREE.CanvasTexture(t))}),n.load(S(t,o.path),i,void 0,r)})}).then(function(e){!0===c&&s.revokeObjectURL(l),e.flipY=!1,a.name&&(e.name=a.name),u||(e.format=THREE.RGBFormat);var n=(i.samplers||{})[a.sampler]||{};return e.magFilter=v[n.magFilter]||THREE.LinearFilter,e.minFilter=v[n.minFilter]||THREE.LinearMipmapLinearFilter,e.wrapS=b[n.wrapS]||THREE.RepeatWrapping,e.wrapT=b[n.wrapT]||THREE.RepeatWrapping,r.associations.set(e,{type:"textures",index:t}),e})},R.prototype.assignTexture=function(t,n,r){var i=this;return this.getDependency("texture",r.index).then(function(o){if(void 0===r.texCoord||0==r.texCoord||"aoMap"===n&&1==r.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+r.texCoord+" for texture "+n+" not yet supported."),i.extensions[e.KHR_TEXTURE_TRANSFORM]){var a=void 0!==r.extensions?r.extensions[e.KHR_TEXTURE_TRANSFORM]:void 0;if(a){var s=i.associations.get(o);o=i.extensions[e.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),i.associations.set(o,s)}}t[n]=o})},R.prototype.assignFinalMaterial=function(t){var e=t.geometry,n=t.material,r=void 0!==e.attributes.tangent,i=void 0!==e.attributes.color,o=void 0===e.attributes.normal,a=!0===t.isSkinnedMesh,s=Object.keys(e.morphAttributes).length>0,l=s&&void 0!==e.morphAttributes.normal;if(t.isPoints){var c="PointsMaterial:"+n.uuid,u=this.cache.get(c);u||(u=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(u,n),u.color.copy(n.color),u.map=n.map,u.sizeAttenuation=!1,this.cache.add(c,u)),n=u}else if(t.isLine){c="LineBasicMaterial:"+n.uuid;var p=this.cache.get(c);p||(p=new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(p,n),p.color.copy(n.color),this.cache.add(c,p)),n=p}if(r||i||o||a||s){c="ClonedMaterial:"+n.uuid+":",n.isGLTFSpecularGlossinessMaterial&&(c+="specular-glossiness:"),a&&(c+="skinning:"),r&&(c+="vertex-tangents:"),i&&(c+="vertex-colors:"),o&&(c+="flat-shading:"),s&&(c+="morph-targets:"),l&&(c+="morph-normals:");var d=this.cache.get(c);d||(d=n.clone(),a&&(d.skinning=!0),i&&(d.vertexColors=!0),o&&(d.flatShading=!0),s&&(d.morphTargets=!0),l&&(d.morphNormals=!0),r&&(d.vertexTangents=!0,d.normalScale&&(d.normalScale.y*=-1),d.clearcoatNormalScale&&(d.clearcoatNormalScale.y*=-1)),this.cache.add(c,d),this.associations.set(d,this.associations.get(n))),n=d}n.aoMap&&void 0===e.attributes.uv2&&void 0!==e.attributes.uv&&e.setAttribute("uv2",e.attributes.uv),t.material=n},R.prototype.getMaterialType=function(){return THREE.MeshStandardMaterial},R.prototype.loadMaterial=function(t){var n,r=this,i=this.json,o=this.extensions,a=i.materials[t],s={},l=a.extensions||{},c=[];if(l[e.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var u=o[e.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];n=u.getMaterialType(),c.push(u.extendParams(s,a,r))}else if(l[e.KHR_MATERIALS_UNLIT]){var p=o[e.KHR_MATERIALS_UNLIT];n=p.getMaterialType(),c.push(p.extendParams(s,a,r))}else{var d=a.pbrMetallicRoughness||{};if(s.color=new THREE.Color(1,1,1),s.opacity=1,Array.isArray(d.baseColorFactor)){var h=d.baseColorFactor;s.color.fromArray(h),s.opacity=h[3]}void 0!==d.baseColorTexture&&c.push(r.assignTexture(s,"map",d.baseColorTexture)),s.metalness=void 0!==d.metallicFactor?d.metallicFactor:1,s.roughness=void 0!==d.roughnessFactor?d.roughnessFactor:1,void 0!==d.metallicRoughnessTexture&&(c.push(r.assignTexture(s,"metalnessMap",d.metallicRoughnessTexture)),c.push(r.assignTexture(s,"roughnessMap",d.metallicRoughnessTexture))),n=this._invokeOne(function(e){return e.getMaterialType&&e.getMaterialType(t)}),c.push(Promise.all(this._invokeAll(function(e){return e.extendMaterialParams&&e.extendMaterialParams(t,s)})))}!0===a.doubleSided&&(s.side=THREE.DoubleSide);var m=a.alphaMode||"OPAQUE";return"BLEND"===m?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,"MASK"===m&&(s.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&n!==THREE.MeshBasicMaterial&&(c.push(r.assignTexture(s,"normalMap",a.normalTexture)),s.normalScale=new THREE.Vector2(1,-1),void 0!==a.normalTexture.scale&&s.normalScale.set(a.normalTexture.scale,-a.normalTexture.scale)),void 0!==a.occlusionTexture&&n!==THREE.MeshBasicMaterial&&(c.push(r.assignTexture(s,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(s.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&n!==THREE.MeshBasicMaterial&&(s.emissive=(new THREE.Color).fromArray(a.emissiveFactor)),void 0!==a.emissiveTexture&&n!==THREE.MeshBasicMaterial&&c.push(r.assignTexture(s,"emissiveMap",a.emissiveTexture)),Promise.all(c).then(function(){var i;return i=n===f?o[e.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new n(s),a.name&&(i.name=a.name),i.map&&(i.map.encoding=THREE.sRGBEncoding),i.emissiveMap&&(i.emissiveMap.encoding=THREE.sRGBEncoding),j(i,a),r.associations.set(i,{type:"materials",index:t}),a.extensions&&M(o,i,a),i})},R.prototype.createUniqueName=function(t){for(var e=THREE.PropertyBinding.sanitizeNodeName(t||""),n=e,r=1;this.nodeNamesUsed[n];++r)n=e+"_"+r;return this.nodeNamesUsed[n]=!0,n},R.prototype.loadGeometries=function(t){var n=this,r=this.extensions,i=this.primitiveCache;function o(t){return r[e.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,n).then(function(e){return A(e,t,n)})}for(var a,s,l=[],c=0,u=t.length;c<u;c++){var p,d=t[c],h=(s=(a=d).extensions&&a.extensions[e.KHR_DRACO_MESH_COMPRESSION])?"draco:"+s.bufferView+":"+s.indices+":"+z(s.attributes):a.indices+":"+z(a.attributes)+":"+a.mode,f=i[h];f?l.push(f.promise):(p=d.extensions&&d.extensions[e.KHR_DRACO_MESH_COMPRESSION]?o(d):A(new THREE.BufferGeometry,d,n),i[h]={primitive:d,promise:p},l.push(p))}return Promise.all(l)},R.prototype.loadMesh=function(t){for(var e,n=this,r=this.json,i=this.extensions,o=r.meshes[t],a=o.primitives,s=[],l=0,c=a.length;l<c;l++){var u=void 0===a[l].material?(void 0===(e=this.cache).DefaultMaterial&&(e.DefaultMaterial=new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide})),e.DefaultMaterial):this.getDependency("material",a[l].material);s.push(u)}return s.push(n.loadGeometries(a)),Promise.all(s).then(function(e){for(var r=e.slice(0,e.length-1),s=e[e.length-1],l=[],c=0,u=s.length;c<u;c++){var p,d=s[c],h=a[c],f=r[c];if(4===h.mode||5===h.mode||6===h.mode||void 0===h.mode)!0!==(p=!0===o.isSkinnedMesh?new THREE.SkinnedMesh(d,f):new THREE.Mesh(d,f)).isSkinnedMesh||p.geometry.attributes.skinWeight.normalized||p.normalizeSkinWeights(),5===h.mode?p.geometry=L(p.geometry,THREE.TriangleStripDrawMode):6===h.mode&&(p.geometry=L(p.geometry,THREE.TriangleFanDrawMode));else if(1===h.mode)p=new THREE.LineSegments(d,f);else if(3===h.mode)p=new THREE.Line(d,f);else if(2===h.mode)p=new THREE.LineLoop(d,f);else{if(0!==h.mode)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+h.mode);p=new THREE.Points(d,f)}Object.keys(p.geometry.morphAttributes).length>0&&C(p,o),p.name=n.createUniqueName(o.name||"mesh_"+t),j(p,o),h.extensions&&M(i,p,h),n.assignFinalMaterial(p),l.push(p)}if(1===l.length)return l[0];var m=new THREE.Group;for(c=0,u=l.length;c<u;c++)m.add(l[c]);return m})},R.prototype.loadCamera=function(t){var e,n=this.json.cameras[t],r=n[n.type];if(r)return"perspective"===n.type?e=new THREE.PerspectiveCamera(THREE.MathUtils.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(e=new THREE.OrthographicCamera(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(e.name=this.createUniqueName(n.name)),j(e,n),Promise.resolve(e);console.warn("THREE.GLTFLoader: Missing camera parameters.")},R.prototype.loadSkin=function(t){var e=this.json.skins[t],n={joints:e.joints};return void 0===e.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",e.inverseBindMatrices).then(function(t){return n.inverseBindMatrices=t,n})},R.prototype.loadAnimation=function(t){for(var e=this.json.animations[t],n=[],r=[],i=[],o=[],a=[],s=0,l=e.channels.length;s<l;s++){var c=e.channels[s],u=e.samplers[c.sampler],p=c.target,d=void 0!==p.node?p.node:p.id,h=void 0!==e.parameters?e.parameters[u.input]:u.input,f=void 0!==e.parameters?e.parameters[u.output]:u.output;n.push(this.getDependency("node",d)),r.push(this.getDependency("accessor",h)),i.push(this.getDependency("accessor",f)),o.push(u),a.push(p)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(i),Promise.all(o),Promise.all(a)]).then(function(n){for(var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],l=[],c=0,u=r.length;c<u;c++){var p=r[c],d=i[c],h=o[c],f=a[c],m=s[c];if(void 0!==p){var y;switch(p.updateMatrix(),p.matrixAutoUpdate=!0,E[m.path]){case E.weights:y=THREE.NumberKeyframeTrack;break;case E.rotation:y=THREE.QuaternionKeyframeTrack;break;case E.position:case E.scale:default:y=THREE.VectorKeyframeTrack}var g=p.name?p.name:p.uuid,v=void 0!==f.interpolation?T[f.interpolation]:THREE.InterpolateLinear,b=[];E[m.path]===E.weights?p.traverse(function(t){!0===t.isMesh&&t.morphTargetInfluences&&b.push(t.name?t.name:t.uuid)}):b.push(g);var x=h.array;if(h.normalized){var w;if(x.constructor===Int8Array)w=1/127;else if(x.constructor===Uint8Array)w=1/255;else if(x.constructor==Int16Array)w=1/32767;else{if(x.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");w=1/65535}for(var S=new Float32Array(x.length),M=0,j=x.length;M<j;M++)S[M]=x[M]*w;x=S}for(M=0,j=b.length;M<j;M++){var C=new y(b[M]+"."+E[m.path],d.array,x,v);"CUBICSPLINE"===f.interpolation&&(C.createInterpolant=function(t){return new _(this.times,this.values,this.getValueSize()/3,t)},C.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(C)}}}var z=e.name?e.name:"animation_"+t;return new THREE.AnimationClip(z,void 0,l)})},R.prototype.loadNode=function(t){var e,n=this.json,r=this.extensions,i=this,o=n.nodes[t],a=o.name?i.createUniqueName(o.name):"";return(e=[],void 0!==o.mesh&&e.push(i.getDependency("mesh",o.mesh).then(function(t){var e=i._getNodeRef(i.meshCache,o.mesh,t);return void 0!==o.weights&&e.traverse(function(t){if(t.isMesh)for(var e=0,n=o.weights.length;e<n;e++)t.morphTargetInfluences[e]=o.weights[e]}),e})),void 0!==o.camera&&e.push(i.getDependency("camera",o.camera).then(function(t){return i._getNodeRef(i.cameraCache,o.camera,t)})),i._invokeAll(function(e){return e.createNodeAttachment&&e.createNodeAttachment(t)}).forEach(function(t){e.push(t)}),Promise.all(e)).then(function(e){var n;if((n=!0===o.isBone?new THREE.Bone:e.length>1?new THREE.Group:1===e.length?e[0]:new THREE.Object3D)!==e[0])for(var s=0,l=e.length;s<l;s++)n.add(e[s]);if(o.name&&(n.userData.name=o.name,n.name=a),j(n,o),o.extensions&&M(r,n,o),void 0!==o.matrix){var c=new THREE.Matrix4;c.fromArray(o.matrix),n.applyMatrix4(c)}else void 0!==o.translation&&n.position.fromArray(o.translation),void 0!==o.rotation&&n.quaternion.fromArray(o.rotation),void 0!==o.scale&&n.scale.fromArray(o.scale);return i.associations.set(n,{type:"nodes",index:t}),n})},R.prototype.loadScene=function(){function t(e,n,r,i){var o=r.nodes[e];return i.getDependency("node",e).then(function(t){return void 0===o.skin?t:i.getDependency("skin",o.skin).then(function(t){for(var n=[],r=0,o=(e=t).joints.length;r<o;r++)n.push(i.getDependency("node",e.joints[r]));return Promise.all(n)}).then(function(n){return t.traverse(function(t){if(t.isMesh){for(var r=[],i=[],o=0,a=n.length;o<a;o++){var s=n[o];if(s){r.push(s);var l=new THREE.Matrix4;void 0!==e.inverseBindMatrices&&l.fromArray(e.inverseBindMatrices.array,16*o),i.push(l)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',e.joints[o])}t.bind(new THREE.Skeleton(r,i),t.matrixWorld)}}),t});var e}).then(function(e){n.add(e);var a=[];if(o.children)for(var s=o.children,l=0,c=s.length;l<c;l++){var u=s[l];a.push(t(u,e,r,i))}return Promise.all(a)})}return function(e){var n=this.json,r=this.extensions,i=this.json.scenes[e],o=new THREE.Group;i.name&&(o.name=this.createUniqueName(i.name)),j(o,i),i.extensions&&M(r,o,i);for(var a=i.nodes||[],s=[],l=0,c=a.length;l<c;l++)s.push(t(a[l],o,n,this));return Promise.all(s).then(function(){return o})}}(),t}(),THREE.FBXLoader=function(){var t,e,n;function r(t){THREE.Loader.call(this,t)}function i(t,e){this.textureLoader=t,this.manager=e}function o(){}function a(){}function s(){}function l(){}function c(t,e){this.dv=new DataView(t),this.offset=0,this.littleEndian=void 0===e||e}function u(){}function p(t){var e=t.match(/FBXVersion: (\d+)/);if(e)return parseInt(e[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function d(t){return t/46186158e3}r.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:r,load:function(t,e,n,r){var i=this,o=""===i.path?THREE.LoaderUtils.extractUrlBase(t):i.path,a=new THREE.FileLoader(this.manager);a.setPath(i.path),a.setResponseType("arraybuffer"),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(t,function(n){try{e(i.parse(n,o))}catch(e){r?r(e):console.error(e),i.manager.itemError(t)}},n,r)},parse:function(e,n){if(a="Kaydara FBX Binary  \0",(o=e).byteLength>=a.length&&a===b(o,0,a.length))t=(new l).parse(e);else{var r=b(e);if(!function(t){for(var e,n,r=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],i=0,o=0;o<r.length;++o)if(n=t[(e=1)-1],t=t.slice(i+e),i++,n===r[o])return!1;return!0}(r))throw new Error("THREE.FBXLoader: Unknown format.");if(p(r)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+p(r));t=(new s).parse(r)}var o,a;return new i(new THREE.TextureLoader(this.manager).setPath(this.resourcePath||n).setCrossOrigin(this.crossOrigin),this.manager).parse(t)}}),i.prototype={constructor:i,parse:function(){e=this.parseConnections();var t=this.parseImages(),r=this.parseTextures(t),i=this.parseMaterials(r),a=this.parseDeformers(),s=(new o).parse(a);return this.parseScene(a,s,i),n},parseConnections:function(){var e=new Map;return"Connections"in t&&t.Connections.connections.forEach(function(t){var n=t[0],r=t[1],i=t[2];e.has(n)||e.set(n,{parents:[],children:[]});var o={ID:r,relationship:i};e.get(n).parents.push(o),e.has(r)||e.set(r,{parents:[],children:[]});var a={ID:n,relationship:i};e.get(r).children.push(a)}),e},parseImages:function(){var e={},n={};if("Video"in t.Objects){var r=t.Objects.Video;for(var i in r){var o=r[i];if(e[c=parseInt(i)]=o.RelativeFilename||o.Filename,"Content"in o){var a=o.Content instanceof ArrayBuffer&&o.Content.byteLength>0,s="string"==typeof o.Content&&""!==o.Content;if(a||s){var l=this.parseImage(r[i]);n[o.RelativeFilename||o.Filename]=l}}}}for(var c in e){var u=e[c];void 0!==n[u]?e[c]=n[u]:e[c]=e[c].split("\\").pop()}return e},parseImage:function(t){var e,n=t.Content,r=t.RelativeFilename||t.Filename,i=r.slice(r.lastIndexOf(".")+1).toLowerCase();switch(i){case"bmp":e="image/bmp";break;case"jpg":case"jpeg":e="image/jpeg";break;case"png":e="image/png";break;case"tif":e="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",r),e="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+i+'" is not supported.')}if("string"==typeof n)return"data:"+e+";base64,"+n;var o=new Uint8Array(n);return window.URL.createObjectURL(new Blob([o],{type:e}))},parseTextures:function(e){var n=new Map;if("Texture"in t.Objects){var r=t.Objects.Texture;for(var i in r){var o=this.parseTexture(r[i],e);n.set(parseInt(i),o)}}return n},parseTexture:function(t,e){var n=this.loadTexture(t,e);n.ID=t.id,n.name=t.attrName;var r=t.WrapModeU,i=t.WrapModeV,o=void 0!==r?r.value:0,a=void 0!==i?i.value:0;if(n.wrapS=0===o?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,n.wrapT=0===a?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,"Scaling"in t){var s=t.Scaling.value;n.repeat.x=s[0],n.repeat.y=s[1]}return n},loadTexture:function(t,n){var r,i,o=this.textureLoader.path,a=e.get(t.id).children;void 0!==a&&a.length>0&&void 0!==n[a[0].ID]&&(0!==(r=n[a[0].ID]).indexOf("blob:")&&0!==r.indexOf("data:")||this.textureLoader.setPath(void 0));var s=t.FileName.slice(-3).toLowerCase();if("tga"===s){var l=this.manager.getHandler(".tga");null===l?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",t.RelativeFilename),i=new THREE.Texture):i=l.load(r)}else"psd"===s?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",t.RelativeFilename),i=new THREE.Texture):i=this.textureLoader.load(r);return this.textureLoader.setPath(o),i},parseMaterials:function(e){var n=new Map;if("Material"in t.Objects){var r=t.Objects.Material;for(var i in r){var o=this.parseMaterial(r[i],e);null!==o&&n.set(parseInt(i),o)}}return n},parseMaterial:function(t,n){var r=t.id,i=t.attrName,o=t.ShadingModel;if("object"==typeof o&&(o=o.value),!e.has(r))return null;var a,s=this.parseParameters(t,n,r);switch(o.toLowerCase()){case"phong":a=new THREE.MeshPhongMaterial;break;case"lambert":a=new THREE.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),a=new THREE.MeshPhongMaterial}return a.setValues(s),a.name=i,a},parseParameters:function(t,n,r){var i={};t.BumpFactor&&(i.bumpScale=t.BumpFactor.value),t.Diffuse?i.color=(new THREE.Color).fromArray(t.Diffuse.value):!t.DiffuseColor||"Color"!==t.DiffuseColor.type&&"ColorRGB"!==t.DiffuseColor.type||(i.color=(new THREE.Color).fromArray(t.DiffuseColor.value)),t.DisplacementFactor&&(i.displacementScale=t.DisplacementFactor.value),t.Emissive?i.emissive=(new THREE.Color).fromArray(t.Emissive.value):!t.EmissiveColor||"Color"!==t.EmissiveColor.type&&"ColorRGB"!==t.EmissiveColor.type||(i.emissive=(new THREE.Color).fromArray(t.EmissiveColor.value)),t.EmissiveFactor&&(i.emissiveIntensity=parseFloat(t.EmissiveFactor.value)),t.Opacity&&(i.opacity=parseFloat(t.Opacity.value)),i.opacity<1&&(i.transparent=!0),t.ReflectionFactor&&(i.reflectivity=t.ReflectionFactor.value),t.Shininess&&(i.shininess=t.Shininess.value),t.Specular?i.specular=(new THREE.Color).fromArray(t.Specular.value):t.SpecularColor&&"Color"===t.SpecularColor.type&&(i.specular=(new THREE.Color).fromArray(t.SpecularColor.value));var o=this;return e.get(r).children.forEach(function(t){var e=t.relationship;switch(e){case"Bump":i.bumpMap=o.getTexture(n,t.ID);break;case"Maya|TEX_ao_map":i.aoMap=o.getTexture(n,t.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":i.map=o.getTexture(n,t.ID),i.map.encoding=THREE.sRGBEncoding;break;case"DisplacementColor":i.displacementMap=o.getTexture(n,t.ID);break;case"EmissiveColor":i.emissiveMap=o.getTexture(n,t.ID),i.emissiveMap.encoding=THREE.sRGBEncoding;break;case"NormalMap":case"Maya|TEX_normal_map":i.normalMap=o.getTexture(n,t.ID);break;case"ReflectionColor":i.envMap=o.getTexture(n,t.ID),i.envMap.mapping=THREE.EquirectangularReflectionMapping,i.envMap.encoding=THREE.sRGBEncoding;break;case"SpecularColor":i.specularMap=o.getTexture(n,t.ID),i.specularMap.encoding=THREE.sRGBEncoding;break;case"TransparentColor":case"TransparencyFactor":i.alphaMap=o.getTexture(n,t.ID),i.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",e)}}),i},getTexture:function(n,r){return"LayeredTexture"in t.Objects&&r in t.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),r=e.get(r).children[0].ID),n.get(r)},parseDeformers:function(){var n={},r={};if("Deformer"in t.Objects){var i=t.Objects.Deformer;for(var o in i){var a=i[o],s=e.get(parseInt(o));if("Skin"===a.attrType){var l=this.parseSkeleton(s,i);l.ID=o,s.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),l.geometryID=s.parents[0].ID,n[o]=l}else if("BlendShape"===a.attrType){var c={id:o};c.rawTargets=this.parseMorphTargets(s,i),c.id=o,s.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),r[o]=c}}}return{skeletons:n,morphTargets:r}},parseSkeleton:function(t,e){var n=[];return t.children.forEach(function(t){var r=e[t.ID];if("Cluster"===r.attrType){var i={ID:t.ID,indices:[],weights:[],transformLink:(new THREE.Matrix4).fromArray(r.TransformLink.a)};"Indexes"in r&&(i.indices=r.Indexes.a,i.weights=r.Weights.a),n.push(i)}}),{rawBones:n,bones:[]}},parseMorphTargets:function(t,n){for(var r=[],i=0;i<t.children.length;i++){var o=t.children[i],a=n[o.ID],s={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if("BlendShapeChannel"!==a.attrType)return;s.geoID=e.get(parseInt(o.ID)).children.filter(function(t){return void 0===t.relationship})[0].ID,r.push(s)}return r},parseScene:function(r,i,o){n=new THREE.Group;var s=this.parseModels(r.skeletons,i,o),l=t.Objects.Model,c=this;s.forEach(function(t){var r=l[t.ID];c.setLookAtProperties(t,r),e.get(t.ID).parents.forEach(function(e){var n=s.get(e.ID);void 0!==n&&n.add(t)}),null===t.parent&&n.add(t)}),this.bindSkeleton(r.skeletons,i,s),this.createAmbientLight(),this.setupMorphMaterials(),n.traverse(function(t){if(t.userData.transformData){t.parent&&(t.userData.transformData.parentMatrix=t.parent.matrix,t.userData.transformData.parentMatrixWorld=t.parent.matrixWorld);var e=_(t.userData.transformData);t.applyMatrix4(e),t.updateWorldMatrix()}});var u=(new a).parse();1===n.children.length&&n.children[0].isGroup&&(n.children[0].animations=u,n=n.children[0]),n.animations=u},parseModels:function(n,r,i){var o=new Map,a=t.Objects.Model;for(var s in a){var l=parseInt(s),c=a[s],u=e.get(l),p=this.buildSkeleton(u,n,l,c.attrName);if(!p){switch(c.attrType){case"Camera":p=this.createCamera(u);break;case"Light":p=this.createLight(u);break;case"Mesh":p=this.createMesh(u,r,i);break;case"NurbsCurve":p=this.createCurve(u,r);break;case"LimbNode":case"Root":p=new THREE.Bone;break;case"Null":default:p=new THREE.Group}p.name=c.attrName?THREE.PropertyBinding.sanitizeNodeName(c.attrName):"",p.ID=l}this.getTransformData(p,c),o.set(l,p)}return o},buildSkeleton:function(t,e,n,r){var i=null;return t.parents.forEach(function(t){for(var o in e){var a=e[o];a.rawBones.forEach(function(e,o){if(e.ID===t.ID){var s=i;(i=new THREE.Bone).matrixWorld.copy(e.transformLink),i.name=r?THREE.PropertyBinding.sanitizeNodeName(r):"",i.ID=n,a.bones[o]=i,null!==s&&i.add(s)}})}}),i},createCamera:function(e){var n,r;if(e.children.forEach(function(e){var n=t.Objects.NodeAttribute[e.ID];void 0!==n&&(r=n)}),void 0===r)n=new THREE.Object3D;else{var i=0;void 0!==r.CameraProjectionType&&1===r.CameraProjectionType.value&&(i=1);var o=1;void 0!==r.NearPlane&&(o=r.NearPlane.value/1e3);var a=1e3;void 0!==r.FarPlane&&(a=r.FarPlane.value/1e3);var s=window.innerWidth,l=window.innerHeight;void 0!==r.AspectWidth&&void 0!==r.AspectHeight&&(s=r.AspectWidth.value,l=r.AspectHeight.value);var c=s/l,u=45;void 0!==r.FieldOfView&&(u=r.FieldOfView.value);var p=r.FocalLength?r.FocalLength.value:null;switch(i){case 0:n=new THREE.PerspectiveCamera(u,c,o,a),null!==p&&n.setFocalLength(p);break;case 1:n=new THREE.OrthographicCamera(-s/2,s/2,l/2,-l/2,o,a);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+i+"."),n=new THREE.Object3D}}return n},createLight:function(e){var n,r;if(e.children.forEach(function(e){var n=t.Objects.NodeAttribute[e.ID];void 0!==n&&(r=n)}),void 0===r)n=new THREE.Object3D;else{var i;i=void 0===r.LightType?0:r.LightType.value;var o=16777215;void 0!==r.Color&&(o=(new THREE.Color).fromArray(r.Color.value));var a=void 0===r.Intensity?1:r.Intensity.value/100;void 0!==r.CastLightOnObject&&0===r.CastLightOnObject.value&&(a=0);var s=0;switch(void 0!==r.FarAttenuationEnd&&(s=void 0!==r.EnableFarAttenuation&&0===r.EnableFarAttenuation.value?0:r.FarAttenuationEnd.value),i){case 0:n=new THREE.PointLight(o,a,s,1);break;case 1:n=new THREE.DirectionalLight(o,a);break;case 2:var l=Math.PI/3;void 0!==r.InnerAngle&&(l=THREE.MathUtils.degToRad(r.InnerAngle.value));var c=0;void 0!==r.OuterAngle&&(c=THREE.MathUtils.degToRad(r.OuterAngle.value),c=Math.max(c,1)),n=new THREE.SpotLight(o,a,s,l,c,1);break;default:console.warn("THREE.FBXLoader: Unknown light type "+r.LightType.value+", defaulting to a THREE.PointLight."),n=new THREE.PointLight(o,a)}void 0!==r.CastShadows&&1===r.CastShadows.value&&(n.castShadow=!0)}return n},createMesh:function(t,e,n){var r,i=null,o=null,a=[];return t.children.forEach(function(t){e.has(t.ID)&&(i=e.get(t.ID)),n.has(t.ID)&&a.push(n.get(t.ID))}),a.length>1?o=a:a.length>0?o=a[0]:(o=new THREE.MeshPhongMaterial({color:13421772}),a.push(o)),"color"in i.attributes&&a.forEach(function(t){t.vertexColors=!0}),i.FBX_Deformer?(a.forEach(function(t){t.skinning=!0}),(r=new THREE.SkinnedMesh(i,o)).normalizeSkinWeights()):r=new THREE.Mesh(i,o),r},createCurve:function(t,e){var n=t.children.reduce(function(t,n){return e.has(n.ID)&&(t=e.get(n.ID)),t},null),r=new THREE.LineBasicMaterial({color:3342591,linewidth:1});return new THREE.Line(n,r)},getTransformData:function(t,e){var n={};"InheritType"in e&&(n.inheritType=parseInt(e.InheritType.value)),n.eulerOrder="RotationOrder"in e?g(e.RotationOrder.value):"ZYX","Lcl_Translation"in e&&(n.translation=e.Lcl_Translation.value),"PreRotation"in e&&(n.preRotation=e.PreRotation.value),"Lcl_Rotation"in e&&(n.rotation=e.Lcl_Rotation.value),"PostRotation"in e&&(n.postRotation=e.PostRotation.value),"Lcl_Scaling"in e&&(n.scale=e.Lcl_Scaling.value),"ScalingOffset"in e&&(n.scalingOffset=e.ScalingOffset.value),"ScalingPivot"in e&&(n.scalingPivot=e.ScalingPivot.value),"RotationOffset"in e&&(n.rotationOffset=e.RotationOffset.value),"RotationPivot"in e&&(n.rotationPivot=e.RotationPivot.value),t.userData.transformData=n},setLookAtProperties:function(r,i){"LookAtProperty"in i&&e.get(r.ID).children.forEach(function(e){if("LookAtProperty"===e.relationship){var i=t.Objects.Model[e.ID];if("Lcl_Translation"in i){var o=i.Lcl_Translation.value;void 0!==r.target?(r.target.position.fromArray(o),n.add(r.target)):r.lookAt((new THREE.Vector3).fromArray(o))}}})},bindSkeleton:function(t,n,r){var i=this.parsePoseNodes();for(var o in t){var a=t[o];e.get(parseInt(a.ID)).parents.forEach(function(t){if(n.has(t.ID)){var o=t.ID;e.get(o).parents.forEach(function(t){r.has(t.ID)&&r.get(t.ID).bind(new THREE.Skeleton(a.bones),i[t.ID])})}})}},parsePoseNodes:function(){var e={};if("Pose"in t.Objects){var n=t.Objects.Pose;for(var r in n)if("BindPose"===n[r].attrType){var i=n[r].PoseNode;Array.isArray(i)?i.forEach(function(t){e[t.Node]=(new THREE.Matrix4).fromArray(t.Matrix.a)}):e[i.Node]=(new THREE.Matrix4).fromArray(i.Matrix.a)}}return e},createAmbientLight:function(){if("GlobalSettings"in t&&"AmbientColor"in t.GlobalSettings){var e=t.GlobalSettings.AmbientColor.value,r=e[0],i=e[1],o=e[2];if(0!==r||0!==i||0!==o){var a=new THREE.Color(r,i,o);n.add(new THREE.AmbientLight(a,1))}}},setupMorphMaterials:function(){var t=this;n.traverse(function(e){e.isMesh&&e.geometry.morphAttributes.position&&e.geometry.morphAttributes.position.length&&(Array.isArray(e.material)?e.material.forEach(function(n,r){t.setupMorphMaterial(e,n,r)}):t.setupMorphMaterial(e,e.material))})},setupMorphMaterial:function(t,e,r){var i=t.uuid,o=e.uuid,a=!1;if(n.traverse(function(t){t.isMesh&&(Array.isArray(t.material)?t.material.forEach(function(e){e.uuid===o&&t.uuid!==i&&(a=!0)}):t.material.uuid===o&&t.uuid!==i&&(a=!0))}),!0===a){var s=e.clone();s.morphTargets=!0,void 0===r?t.material=s:t.material[r]=s}else e.morphTargets=!0}},o.prototype={constructor:o,parse:function(n){var r=new Map;if("Geometry"in t.Objects){var i=t.Objects.Geometry;for(var o in i){var a=e.get(parseInt(o)),s=this.parseGeometry(a,i[o],n);r.set(parseInt(o),s)}}return r},parseGeometry:function(t,e,n){switch(e.attrType){case"Mesh":return this.parseMeshGeometry(t,e,n);case"NurbsCurve":return this.parseNurbsGeometry(e)}},parseMeshGeometry:function(e,n,r){var i=r.skeletons,o=[],a=e.parents.map(function(e){return t.Objects.Model[e.ID]});if(0!==a.length){var s=e.children.reduce(function(t,e){return void 0!==i[e.ID]&&(t=i[e.ID]),t},null);e.children.forEach(function(t){void 0!==r.morphTargets[t.ID]&&o.push(r.morphTargets[t.ID])});var l=a[0],c={};"RotationOrder"in l&&(c.eulerOrder=g(l.RotationOrder.value)),"InheritType"in l&&(c.inheritType=parseInt(l.InheritType.value)),"GeometricTranslation"in l&&(c.translation=l.GeometricTranslation.value),"GeometricRotation"in l&&(c.rotation=l.GeometricRotation.value),"GeometricScaling"in l&&(c.scale=l.GeometricScaling.value);var u=_(c);return this.genGeometry(n,s,o,u)}},genGeometry:function(t,e,n,r){var i=new THREE.BufferGeometry;t.attrName&&(i.name=t.attrName);var o=this.parseGeoNode(t,e),a=this.genBuffers(o),s=new THREE.Float32BufferAttribute(a.vertex,3);if(s.applyMatrix4(r),i.setAttribute("position",s),a.colors.length>0&&i.setAttribute("color",new THREE.Float32BufferAttribute(a.colors,3)),e&&(i.setAttribute("skinIndex",new THREE.Uint16BufferAttribute(a.weightsIndices,4)),i.setAttribute("skinWeight",new THREE.Float32BufferAttribute(a.vertexWeights,4)),i.FBX_Deformer=e),a.normal.length>0){var l=(new THREE.Matrix3).getNormalMatrix(r),c=new THREE.Float32BufferAttribute(a.normal,3);c.applyNormalMatrix(l),i.setAttribute("normal",c)}if(a.uvs.forEach(function(t,e){var n="uv"+(e+1).toString();0===e&&(n="uv"),i.setAttribute(n,new THREE.Float32BufferAttribute(a.uvs[e],2))}),o.material&&"AllSame"!==o.material.mappingType){var u=a.materialIndex[0],p=0;if(a.materialIndex.forEach(function(t,e){t!==u&&(i.addGroup(p,e-p,u),u=t,p=e)}),i.groups.length>0){var d=i.groups[i.groups.length-1],h=d.start+d.count;h!==a.materialIndex.length&&i.addGroup(h,a.materialIndex.length-h,u)}0===i.groups.length&&i.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(i,t,n,r),i},parseGeoNode:function(t,e){var n={};if(n.vertexPositions=void 0!==t.Vertices?t.Vertices.a:[],n.vertexIndices=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],t.LayerElementColor&&(n.color=this.parseVertexColors(t.LayerElementColor[0])),t.LayerElementMaterial&&(n.material=this.parseMaterialIndices(t.LayerElementMaterial[0])),t.LayerElementNormal&&(n.normal=this.parseNormals(t.LayerElementNormal[0])),t.LayerElementUV){n.uv=[];for(var r=0;t.LayerElementUV[r];)t.LayerElementUV[r].UV&&n.uv.push(this.parseUVs(t.LayerElementUV[r])),r++}return n.weightTable={},null!==e&&(n.skeleton=e,e.rawBones.forEach(function(t,e){t.indices.forEach(function(r,i){void 0===n.weightTable[r]&&(n.weightTable[r]=[]),n.weightTable[r].push({id:e,weight:t.weights[i]})})})),n},genBuffers:function(t){var e={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},n=0,r=0,i=!1,o=[],a=[],s=[],l=[],c=[],u=[],p=this;return t.vertexIndices.forEach(function(d,h){var m=!1;d<0&&(d^=-1,m=!0);var y=[],_=[];if(o.push(3*d,3*d+1,3*d+2),t.color){var g=f(h,n,d,t.color);s.push(g[0],g[1],g[2])}if(t.skeleton){if(void 0!==t.weightTable[d]&&t.weightTable[d].forEach(function(t){_.push(t.weight),y.push(t.id)}),_.length>4){i||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),i=!0);var v=[0,0,0,0],b=[0,0,0,0];_.forEach(function(t,e){var n=t,r=y[e];b.forEach(function(t,e,i){if(n>t){i[e]=n,n=t;var o=v[e];v[e]=r,r=o}})}),y=v,_=b}for(;_.length<4;)_.push(0),y.push(0);for(var x=0;x<4;++x)c.push(_[x]),u.push(y[x])}if(t.normal&&(g=f(h,n,d,t.normal),a.push(g[0],g[1],g[2])),t.material&&"AllSame"!==t.material.mappingType)var w=f(h,n,d,t.material)[0];t.uv&&t.uv.forEach(function(t,e){var r=f(h,n,d,t);void 0===l[e]&&(l[e]=[]),l[e].push(r[0]),l[e].push(r[1])}),r++,m&&(p.genFace(e,t,o,w,a,s,l,c,u,r),n++,r=0,o=[],a=[],s=[],l=[],c=[],u=[])}),e},genFace:function(t,e,n,r,i,o,a,s,l,c){for(var u=2;u<c;u++)t.vertex.push(e.vertexPositions[n[0]]),t.vertex.push(e.vertexPositions[n[1]]),t.vertex.push(e.vertexPositions[n[2]]),t.vertex.push(e.vertexPositions[n[3*(u-1)]]),t.vertex.push(e.vertexPositions[n[3*(u-1)+1]]),t.vertex.push(e.vertexPositions[n[3*(u-1)+2]]),t.vertex.push(e.vertexPositions[n[3*u]]),t.vertex.push(e.vertexPositions[n[3*u+1]]),t.vertex.push(e.vertexPositions[n[3*u+2]]),e.skeleton&&(t.vertexWeights.push(s[0]),t.vertexWeights.push(s[1]),t.vertexWeights.push(s[2]),t.vertexWeights.push(s[3]),t.vertexWeights.push(s[4*(u-1)]),t.vertexWeights.push(s[4*(u-1)+1]),t.vertexWeights.push(s[4*(u-1)+2]),t.vertexWeights.push(s[4*(u-1)+3]),t.vertexWeights.push(s[4*u]),t.vertexWeights.push(s[4*u+1]),t.vertexWeights.push(s[4*u+2]),t.vertexWeights.push(s[4*u+3]),t.weightsIndices.push(l[0]),t.weightsIndices.push(l[1]),t.weightsIndices.push(l[2]),t.weightsIndices.push(l[3]),t.weightsIndices.push(l[4*(u-1)]),t.weightsIndices.push(l[4*(u-1)+1]),t.weightsIndices.push(l[4*(u-1)+2]),t.weightsIndices.push(l[4*(u-1)+3]),t.weightsIndices.push(l[4*u]),t.weightsIndices.push(l[4*u+1]),t.weightsIndices.push(l[4*u+2]),t.weightsIndices.push(l[4*u+3])),e.color&&(t.colors.push(o[0]),t.colors.push(o[1]),t.colors.push(o[2]),t.colors.push(o[3*(u-1)]),t.colors.push(o[3*(u-1)+1]),t.colors.push(o[3*(u-1)+2]),t.colors.push(o[3*u]),t.colors.push(o[3*u+1]),t.colors.push(o[3*u+2])),e.material&&"AllSame"!==e.material.mappingType&&(t.materialIndex.push(r),t.materialIndex.push(r),t.materialIndex.push(r)),e.normal&&(t.normal.push(i[0]),t.normal.push(i[1]),t.normal.push(i[2]),t.normal.push(i[3*(u-1)]),t.normal.push(i[3*(u-1)+1]),t.normal.push(i[3*(u-1)+2]),t.normal.push(i[3*u]),t.normal.push(i[3*u+1]),t.normal.push(i[3*u+2])),e.uv&&e.uv.forEach(function(e,n){void 0===t.uvs[n]&&(t.uvs[n]=[]),t.uvs[n].push(a[n][0]),t.uvs[n].push(a[n][1]),t.uvs[n].push(a[n][2*(u-1)]),t.uvs[n].push(a[n][2*(u-1)+1]),t.uvs[n].push(a[n][2*u]),t.uvs[n].push(a[n][2*u+1])})},addMorphTargets:function(e,n,r,i){if(0!==r.length){e.morphTargetsRelative=!0,e.morphAttributes.position=[];var o=this;r.forEach(function(r){r.rawTargets.forEach(function(r){var a=t.Objects.Geometry[r.geoID];void 0!==a&&o.genMorphGeometry(e,n,a,i,r.name)})})}},genMorphGeometry:function(t,e,n,r,i){for(var o=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],a=void 0!==n.Vertices?n.Vertices.a:[],s=void 0!==n.Indexes?n.Indexes.a:[],l=3*t.attributes.position.count,c=new Float32Array(l),u=0;u<s.length;u++){var p=3*s[u];c[p]=a[3*u],c[p+1]=a[3*u+1],c[p+2]=a[3*u+2]}var d={vertexIndices:o,vertexPositions:c},h=this.genBuffers(d),f=new THREE.Float32BufferAttribute(h.vertex,3);f.name=i||n.attrName,f.applyMatrix4(r),t.morphAttributes.position.push(f)},parseNormals:function(t){var e=t.MappingInformationType,n=t.ReferenceInformationType,r=t.Normals.a,i=[];return"IndexToDirect"===n&&("NormalIndex"in t?i=t.NormalIndex.a:"NormalsIndex"in t&&(i=t.NormalsIndex.a)),{dataSize:3,buffer:r,indices:i,mappingType:e,referenceType:n}},parseUVs:function(t){var e=t.MappingInformationType,n=t.ReferenceInformationType,r=t.UV.a,i=[];return"IndexToDirect"===n&&(i=t.UVIndex.a),{dataSize:2,buffer:r,indices:i,mappingType:e,referenceType:n}},parseVertexColors:function(t){var e=t.MappingInformationType,n=t.ReferenceInformationType,r=t.Colors.a,i=[];return"IndexToDirect"===n&&(i=t.ColorIndex.a),{dataSize:4,buffer:r,indices:i,mappingType:e,referenceType:n}},parseMaterialIndices:function(t){var e=t.MappingInformationType,n=t.ReferenceInformationType;if("NoMappingInformation"===e)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};for(var r=t.Materials.a,i=[],o=0;o<r.length;++o)i.push(o);return{dataSize:1,buffer:r,indices:i,mappingType:e,referenceType:n}},parseNurbsGeometry:function(t){if(void 0===THREE.NURBSCurve)return console.error("THREE.FBXLoader: The loader relies on THREE.NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new THREE.BufferGeometry;var e=parseInt(t.Order);if(isNaN(e))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",t.Order,t.id),new THREE.BufferGeometry;for(var n,r,i=e-1,o=t.KnotVector.a,a=[],s=t.Points.a,l=0,c=s.length;l<c;l+=4)a.push((new THREE.Vector4).fromArray(s,l));if("Closed"===t.Form)a.push(a[0]);else if("Periodic"===t.Form)for(n=i,r=o.length-1-n,l=0;l<i;++l)a.push(a[l]);var u=new THREE.NURBSCurve(i,o,a,n,r).getPoints(7*a.length),p=new Float32Array(3*u.length);u.forEach(function(t,e){t.toArray(p,3*e)});var d=new THREE.BufferGeometry;return d.setAttribute("position",new THREE.BufferAttribute(p,3)),d}},a.prototype={constructor:a,parse:function(){var t=[],e=this.parseClips();if(void 0!==e)for(var n in e){var r=e[n],i=this.addClip(r);t.push(i)}return t},parseClips:function(){if(void 0!==t.Objects.AnimationCurve){var e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);var n=this.parseAnimationLayers(e);return this.parseAnimStacks(n)}},parseAnimationCurveNodes:function(){var e=t.Objects.AnimationCurveNode,n=new Map;for(var r in e){var i=e[r];if(null!==i.attrName.match(/S|R|T|DeformPercent/)){var o={id:i.id,attr:i.attrName,curves:{}};n.set(o.id,o)}}return n},parseAnimationCurves:function(n){var r=t.Objects.AnimationCurve;for(var i in r){var o={id:r[i].id,times:r[i].KeyTime.a.map(d),values:r[i].KeyValueFloat.a},a=e.get(o.id);if(void 0!==a){var s=a.parents[0].ID,l=a.parents[0].relationship;l.match(/X/)?n.get(s).curves.x=o:l.match(/Y/)?n.get(s).curves.y=o:l.match(/Z/)?n.get(s).curves.z=o:l.match(/d|DeformPercent/)&&n.has(s)&&(n.get(s).curves.morph=o)}}},parseAnimationLayers:function(r){var i=t.Objects.AnimationLayer,o=new Map;for(var a in i){var s=[],l=e.get(parseInt(a));void 0!==l&&(l.children.forEach(function(i,o){if(r.has(i.ID)){var a=r.get(i.ID);if(void 0!==a.curves.x||void 0!==a.curves.y||void 0!==a.curves.z){if(void 0===s[o]&&void 0!==(h=e.get(i.ID).parents.filter(function(t){return void 0!==t.relationship})[0].ID)){if(void 0===(c=t.Objects.Model[h.toString()]))return void console.warn("THREE.FBXLoader: Encountered a unused curve.",i);var l={modelName:c.attrName?THREE.PropertyBinding.sanitizeNodeName(c.attrName):"",ID:c.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};n.traverse(function(t){t.ID===c.id&&(l.transform=t.matrix,t.userData.transformData&&(l.eulerOrder=t.userData.transformData.eulerOrder))}),l.transform||(l.transform=new THREE.Matrix4),"PreRotation"in c&&(l.preRotation=c.PreRotation.value),"PostRotation"in c&&(l.postRotation=c.PostRotation.value),s[o]=l}s[o]&&(s[o][a.attr]=a)}else if(void 0!==a.curves.morph){if(void 0===s[o]){var c,u=e.get(i.ID).parents.filter(function(t){return void 0!==t.relationship})[0].ID,p=e.get(u).parents[0].ID,d=e.get(p).parents[0].ID,h=e.get(d).parents[0].ID;l={modelName:(c=t.Objects.Model[h]).attrName?THREE.PropertyBinding.sanitizeNodeName(c.attrName):"",morphName:t.Objects.Deformer[u].attrName},s[o]=l}s[o][a.attr]=a}}}),o.set(parseInt(a),s))}return o},parseAnimStacks:function(n){var r=t.Objects.AnimationStack,i={};for(var o in r){var a=e.get(parseInt(o)).children;a.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var s=n.get(a[0].ID);i[o]={name:r[o].attrName,layer:s}}return i},addClip:function(t){var e=[],n=this;return t.layer.forEach(function(t){e=e.concat(n.generateTracks(t))}),new THREE.AnimationClip(t.name,-1,e)},generateTracks:function(t){var e=[],n=new THREE.Vector3,r=new THREE.Quaternion,i=new THREE.Vector3;if(t.transform&&t.transform.decompose(n,r,i),n=n.toArray(),r=(new THREE.Euler).setFromQuaternion(r,t.eulerOrder).toArray(),i=i.toArray(),void 0!==t.T&&Object.keys(t.T.curves).length>0){var o=this.generateVectorTrack(t.modelName,t.T.curves,n,"position");void 0!==o&&e.push(o)}if(void 0!==t.R&&Object.keys(t.R.curves).length>0){var a=this.generateRotationTrack(t.modelName,t.R.curves,r,t.preRotation,t.postRotation,t.eulerOrder);void 0!==a&&e.push(a)}if(void 0!==t.S&&Object.keys(t.S.curves).length>0){var s=this.generateVectorTrack(t.modelName,t.S.curves,i,"scale");void 0!==s&&e.push(s)}if(void 0!==t.DeformPercent){var l=this.generateMorphTrack(t);void 0!==l&&e.push(l)}return e},generateVectorTrack:function(t,e,n,r){var i=this.getTimesForAllAxes(e),o=this.getKeyframeTrackValues(i,e,n);return new THREE.VectorKeyframeTrack(t+"."+r,i,o)},generateRotationTrack:function(t,e,n,r,i,o){void 0!==e.x&&(this.interpolateRotations(e.x),e.x.values=e.x.values.map(THREE.MathUtils.degToRad)),void 0!==e.y&&(this.interpolateRotations(e.y),e.y.values=e.y.values.map(THREE.MathUtils.degToRad)),void 0!==e.z&&(this.interpolateRotations(e.z),e.z.values=e.z.values.map(THREE.MathUtils.degToRad));var a=this.getTimesForAllAxes(e),s=this.getKeyframeTrackValues(a,e,n);void 0!==r&&((r=r.map(THREE.MathUtils.degToRad)).push(o),r=(new THREE.Euler).fromArray(r),r=(new THREE.Quaternion).setFromEuler(r)),void 0!==i&&((i=i.map(THREE.MathUtils.degToRad)).push(o),i=(new THREE.Euler).fromArray(i),i=(new THREE.Quaternion).setFromEuler(i).invert());for(var l=new THREE.Quaternion,c=new THREE.Euler,u=[],p=0;p<s.length;p+=3)c.set(s[p],s[p+1],s[p+2],o),l.setFromEuler(c),void 0!==r&&l.premultiply(r),void 0!==i&&l.multiply(i),l.toArray(u,p/3*4);return new THREE.QuaternionKeyframeTrack(t+".quaternion",a,u)},generateMorphTrack:function(t){var e=t.DeformPercent.curves.morph,r=e.values.map(function(t){return t/100}),i=n.getObjectByName(t.modelName).morphTargetDictionary[t.morphName];return new THREE.NumberKeyframeTrack(t.modelName+".morphTargetInfluences["+i+"]",e.times,r)},getTimesForAllAxes:function(t){var e=[];if(void 0!==t.x&&(e=e.concat(t.x.times)),void 0!==t.y&&(e=e.concat(t.y.times)),void 0!==t.z&&(e=e.concat(t.z.times)),(e=e.sort(function(t,e){return t-e})).length>1){for(var n=1,r=e[0],i=1;i<e.length;i++){var o=e[i];o!==r&&(e[n]=o,r=o,n++)}e=e.slice(0,n)}return e},getKeyframeTrackValues:function(t,e,n){var r=n,i=[],o=-1,a=-1,s=-1;return t.forEach(function(t){if(e.x&&(o=e.x.times.indexOf(t)),e.y&&(a=e.y.times.indexOf(t)),e.z&&(s=e.z.times.indexOf(t)),-1!==o){var n=e.x.values[o];i.push(n),r[0]=n}else i.push(r[0]);if(-1!==a){var l=e.y.values[a];i.push(l),r[1]=l}else i.push(r[1]);if(-1!==s){var c=e.z.values[s];i.push(c),r[2]=c}else i.push(r[2])}),i},interpolateRotations:function(t){for(var e=1;e<t.values.length;e++){var n=t.values[e-1],r=t.values[e]-n,i=Math.abs(r);if(i>=180){for(var o=i/180,a=r/o,s=n+a,l=t.times[e-1],c=(t.times[e]-l)/o,u=l+c,p=[],d=[];u<t.times[e];)p.push(u),u+=c,d.push(s),s+=a;t.times=x(t.times,e,p),t.values=x(t.values,e,d)}}}},s.prototype={constructor:s,getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(t){this.nodeStack.push(t),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(t,e){this.currentProp=t,this.currentPropName=e},parse:function(t){this.currentIndent=0,this.allNodes=new u,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var e=this,n=t.split(/[\r\n]+/);return n.forEach(function(t,r){var i=t.match(/^[\s\t]*;/),o=t.match(/^[\s\t]*$/);if(!i&&!o){var a=t.match("^\\t{"+e.currentIndent+"}(\\w+):(.*){",""),s=t.match("^\\t{"+e.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),l=t.match("^\\t{"+(e.currentIndent-1)+"}}");a?e.parseNodeBegin(t,a):s?e.parseNodeProperty(t,s,n[++r]):l?e.popStack():t.match(/^[^\s\t}]/)&&e.parseNodePropertyContinued(t)}}),this.allNodes},parseNodeBegin:function(t,e){var n=e[1].trim().replace(/^"/,"").replace(/"$/,""),r=e[2].split(",").map(function(t){return t.trim().replace(/^"/,"").replace(/"$/,"")}),i={name:n},o=this.parseNodeAttr(r),a=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(n,i):n in a?("PoseNode"===n?a.PoseNode.push(i):void 0!==a[n].id&&(a[n]={},a[n][a[n].id]=a[n]),""!==o.id&&(a[n][o.id]=i)):"number"==typeof o.id?(a[n]={},a[n][o.id]=i):"Properties70"!==n&&(a[n]="PoseNode"===n?[i]:i),"number"==typeof o.id&&(i.id=o.id),""!==o.name&&(i.attrName=o.name),""!==o.type&&(i.attrType=o.type),this.pushStack(i)},parseNodeAttr:function(t){var e=t[0];""!==t[0]&&(e=parseInt(t[0]),isNaN(e)&&(e=t[0]));var n="",r="";return t.length>1&&(n=t[1].replace(/^(\w+)::/,""),r=t[2]),{id:e,name:n,type:r}},parseNodeProperty:function(t,e,n){var r=e[1].replace(/^"/,"").replace(/"$/,"").trim(),i=e[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===r&&","===i&&(i=n.replace(/"/g,"").replace(/,$/,"").trim());var o=this.getCurrentNode();if("Properties70"!==o.name){if("C"===r){var a=i.split(",").slice(1),s=parseInt(a[0]),l=parseInt(a[1]),c=i.split(",").slice(3);r="connections",function(t,e){for(var n=0,r=t.length,i=e.length;n<i;n++,r++)t[r]=e[n]}(i=[s,l],c=c.map(function(t){return t.trim().replace(/^"/,"")})),void 0===o[r]&&(o[r]=[])}"Node"===r&&(o.id=i),r in o&&Array.isArray(o[r])?o[r].push(i):"a"!==r?o[r]=i:o.a=i,this.setCurrentProp(o,r),"a"===r&&","!==i.slice(-1)&&(o.a=v(i))}else this.parseNodeSpecialProperty(t,r,i)},parseNodePropertyContinued:function(t){var e=this.getCurrentNode();e.a+=t,","!==t.slice(-1)&&(e.a=v(e.a))},parseNodeSpecialProperty:function(t,e,n){var r=n.split('",').map(function(t){return t.trim().replace(/^\"/,"").replace(/\s/,"_")}),i=r[0],o=r[1],a=r[2],s=r[3],l=r[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":l=parseFloat(l);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":l=v(l)}this.getPrevNode()[i]={type:o,type2:a,flag:s,value:l},this.setCurrentProp(this.getPrevNode(),i)}},l.prototype={constructor:l,parse:function(t){var e=new c(t);e.skip(23);var n=e.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);for(var r=new u;!this.endOfContent(e);){var i=this.parseNode(e,n);null!==i&&r.add(i.name,i)}return r},endOfContent:function(t){return t.size()%16==0?(t.getOffset()+160+16&-16)>=t.size():t.getOffset()+160+16>=t.size()},parseNode:function(t,e){var n={},r=e>=7500?t.getUint64():t.getUint32(),i=e>=7500?t.getUint64():t.getUint32();e>=7500?t.getUint64():t.getUint32();var o=t.getUint8(),a=t.getString(o);if(0===r)return null;for(var s=[],l=0;l<i;l++)s.push(this.parseProperty(t));var c=s.length>0?s[0]:"",u=s.length>1?s[1]:"",p=s.length>2?s[2]:"";for(n.singleProperty=1===i&&t.getOffset()===r;r>t.getOffset();){var d=this.parseNode(t,e);null!==d&&this.parseSubNode(a,n,d)}return n.propertyList=s,"number"==typeof c&&(n.id=c),""!==u&&(n.attrName=u),""!==p&&(n.attrType=p),""!==a&&(n.name=a),n},parseSubNode:function(t,e,n){if(!0===n.singleProperty){var r=n.propertyList[0];Array.isArray(r)?(e[n.name]=n,n.a=r):e[n.name]=r}else if("Connections"===t&&"C"===n.name){var i=[];n.propertyList.forEach(function(t,e){0!==e&&i.push(t)}),void 0===e.connections&&(e.connections=[]),e.connections.push(i)}else if("Properties70"===n.name)Object.keys(n).forEach(function(t){e[t]=n[t]});else if("Properties70"===t&&"P"===n.name){var o,a=n.propertyList[0],s=n.propertyList[1],l=n.propertyList[2],c=n.propertyList[3];0===a.indexOf("Lcl ")&&(a=a.replace("Lcl ","Lcl_")),0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),o="Color"===s||"ColorRGB"===s||"Vector"===s||"Vector3D"===s||0===s.indexOf("Lcl_")?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],e[a]={type:s,type2:l,flag:c,value:o}}else void 0===e[n.name]?"number"==typeof n.id?(e[n.name]={},e[n.name][n.id]=n):e[n.name]=n:"PoseNode"===n.name?(Array.isArray(e[n.name])||(e[n.name]=[e[n.name]]),e[n.name].push(n)):void 0===e[n.name][n.id]&&(e[n.name][n.id]=n)},parseProperty:function(t){var e=t.getString(1);switch(e){case"C":return t.getBoolean();case"D":return t.getFloat64();case"F":return t.getFloat32();case"I":return t.getInt32();case"L":return t.getInt64();case"R":var n=t.getUint32();return t.getArrayBuffer(n);case"S":return n=t.getUint32(),t.getString(n);case"Y":return t.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var r=t.getUint32(),i=t.getUint32(),o=t.getUint32();if(0===i)switch(e){case"b":case"c":return t.getBooleanArray(r);case"d":return t.getFloat64Array(r);case"f":return t.getFloat32Array(r);case"i":return t.getInt32Array(r);case"l":return t.getInt64Array(r)}"undefined"==typeof fflate&&console.error("THREE.FBXLoader: External library fflate.min.js required.");var a=new c(fflate.unzlibSync(new Uint8Array(t.getArrayBuffer(o))).buffer);switch(e){case"b":case"c":return a.getBooleanArray(r);case"d":return a.getFloat64Array(r);case"f":return a.getFloat32Array(r);case"i":return a.getInt32Array(r);case"l":return a.getInt64Array(r)}default:throw new Error("THREE.FBXLoader: Unknown property type "+e)}}},c.prototype={constructor:c,getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(t){this.offset+=t},getBoolean:function(){return 1==(1&this.getUint8())},getBooleanArray:function(t){for(var e=[],n=0;n<t;n++)e.push(this.getBoolean());return e},getUint8:function(){var t=this.dv.getUint8(this.offset);return this.offset+=1,t},getInt16:function(){var t=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,t},getInt32:function(){var t=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,t},getInt32Array:function(t){for(var e=[],n=0;n<t;n++)e.push(this.getInt32());return e},getUint32:function(){var t=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,t},getInt64:function(){var t,e;return this.littleEndian?(t=this.getUint32(),e=this.getUint32()):(e=this.getUint32(),t=this.getUint32()),2147483648&e?(e=4294967295&~e,4294967295==(t=4294967295&~t)&&(e=e+1&4294967295),-(4294967296*e+(t=t+1&4294967295))):4294967296*e+t},getInt64Array:function(t){for(var e=[],n=0;n<t;n++)e.push(this.getInt64());return e},getUint64:function(){var t,e;return this.littleEndian?(t=this.getUint32(),e=this.getUint32()):(e=this.getUint32(),t=this.getUint32()),4294967296*e+t},getFloat32:function(){var t=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t},getFloat32Array:function(t){for(var e=[],n=0;n<t;n++)e.push(this.getFloat32());return e},getFloat64:function(){var t=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t},getFloat64Array:function(t){for(var e=[],n=0;n<t;n++)e.push(this.getFloat64());return e},getArrayBuffer:function(t){var e=this.dv.buffer.slice(this.offset,this.offset+t);return this.offset+=t,e},getString:function(t){for(var e=[],n=0;n<t;n++)e[n]=this.getUint8();var r=e.indexOf(0);return r>=0&&(e=e.slice(0,r)),THREE.LoaderUtils.decodeText(new Uint8Array(e))}},u.prototype={constructor:u,add:function(t,e){this[t]=e}};var h=[];function f(t,e,n,r){var i;switch(r.mappingType){case"ByPolygonVertex":i=t;break;case"ByPolygon":i=e;break;case"ByVertice":i=n;break;case"AllSame":i=r.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+r.mappingType)}"IndexToDirect"===r.referenceType&&(i=r.indices[i]);var o=i*r.dataSize,a=o+r.dataSize;return function(t,e,n,r){for(var i=n,o=0;i<r;i++,o++)t[o]=e[i];return t}(h,r.buffer,o,a)}var m=new THREE.Euler,y=new THREE.Vector3;function _(t){var e,n=new THREE.Matrix4,r=new THREE.Matrix4,i=new THREE.Matrix4,o=new THREE.Matrix4,a=new THREE.Matrix4,s=new THREE.Matrix4,l=new THREE.Matrix4,c=new THREE.Matrix4,u=new THREE.Matrix4,p=new THREE.Matrix4,d=new THREE.Matrix4,h=new THREE.Matrix4,f=t.inheritType?t.inheritType:0;t.translation&&n.setPosition(y.fromArray(t.translation)),t.preRotation&&((e=t.preRotation.map(THREE.MathUtils.degToRad)).push(t.eulerOrder),r.makeRotationFromEuler(m.fromArray(e))),t.rotation&&((e=t.rotation.map(THREE.MathUtils.degToRad)).push(t.eulerOrder),i.makeRotationFromEuler(m.fromArray(e))),t.postRotation&&((e=t.postRotation.map(THREE.MathUtils.degToRad)).push(t.eulerOrder),o.makeRotationFromEuler(m.fromArray(e)),o.invert()),t.scale&&a.scale(y.fromArray(t.scale)),t.scalingOffset&&l.setPosition(y.fromArray(t.scalingOffset)),t.scalingPivot&&s.setPosition(y.fromArray(t.scalingPivot)),t.rotationOffset&&c.setPosition(y.fromArray(t.rotationOffset)),t.rotationPivot&&u.setPosition(y.fromArray(t.rotationPivot)),t.parentMatrixWorld&&(d.copy(t.parentMatrix),p.copy(t.parentMatrixWorld));var _=(new THREE.Matrix4).copy(r).multiply(i).multiply(o),g=new THREE.Matrix4;g.extractRotation(p);var v=new THREE.Matrix4;v.copyPosition(p);var b=new THREE.Matrix4,x=(new THREE.Matrix4).copy(v).invert().multiply(p);b.copy(g).invert().multiply(x);var w=a,E=new THREE.Matrix4;if(0===f)E.copy(g).multiply(_).multiply(b).multiply(w);else if(1===f)E.copy(g).multiply(b).multiply(_).multiply(w);else{var T=(new THREE.Matrix4).scale((new THREE.Vector3).setFromMatrixScale(d)),S=(new THREE.Matrix4).copy(T).invert(),M=(new THREE.Matrix4).copy(b).multiply(S);E.copy(g).multiply(_).multiply(M).multiply(w)}var j=new THREE.Matrix4;j.copy(u).invert();var C=new THREE.Matrix4;C.copy(s).invert();var z=new THREE.Matrix4;z.copy(n).multiply(c).multiply(u).multiply(r).multiply(i).multiply(o).multiply(j).multiply(l).multiply(s).multiply(a).multiply(C);var R=(new THREE.Matrix4).copyPosition(z),A=(new THREE.Matrix4).copy(p).multiply(R);return h.copyPosition(A),(z=(new THREE.Matrix4).copy(h).multiply(E)).premultiply(p.invert()),z}function g(t){var e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(t=t||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[t]}function v(t){return t.split(",").map(function(t){return parseFloat(t)})}function b(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=t.byteLength),THREE.LoaderUtils.decodeText(new Uint8Array(t,e,n))}function x(t,e,n){return t.slice(0,e).concat(n).concat(t.slice(e))}return r}(),THREE.ColladaLoader=function(t){THREE.Loader.call(this,t)},THREE.ColladaLoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:THREE.ColladaLoader,load:function(t,e,n,r){var i=this,o=""===i.path?THREE.LoaderUtils.extractUrlBase(t):i.path,a=new THREE.FileLoader(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(t,function(n){try{e(i.parse(n,o))}catch(e){r?r(e):console.error(e),i.manager.itemError(t)}},n,r)},options:{set convertUpAxis(t){console.warn("THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},parse:function(t,e){function n(t,e){for(var n=[],r=t.childNodes,i=0,o=r.length;i<o;i++){var a=r[i];a.nodeName===e&&n.push(a)}return n}function r(t){if(0===t.length)return[];for(var e=t.trim().split(/\s+/),n=new Array(e.length),r=0,i=e.length;r<i;r++)n[r]=e[r];return n}function i(t){if(0===t.length)return[];for(var e=t.trim().split(/\s+/),n=new Array(e.length),r=0,i=e.length;r<i;r++)n[r]=parseFloat(e[r]);return n}function o(t){if(0===t.length)return[];for(var e=t.trim().split(/\s+/),n=new Array(e.length),r=0,i=e.length;r<i;r++)n[r]=parseInt(e[r]);return n}function a(t){return t.substring(1)}function s(t){return 0===Object.keys(t).length}function l(t,e,r,i){var o=n(t,e)[0];if(void 0!==o)for(var a=n(o,r),s=0;s<a.length;s++)i(a[s])}function c(t,e){for(var n in t)t[n].build=e(t[n])}function u(t,e){return void 0!==t.build?t.build:(t.build=e(t),t.build)}function p(t){for(var e={inputs:{}},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"input":var o=a(i.getAttribute("source")),s=i.getAttribute("semantic");e.inputs[s]=o}}return e}function d(t){var e={},n=t.getAttribute("target").split("/"),r=n.shift(),i=n.shift(),o=-1!==i.indexOf("("),s=-1!==i.indexOf(".");if(s)i=(n=i.split(".")).shift(),e.member=n.shift();else if(o){var l=i.split("(");i=l.shift();for(var c=0;c<l.length;c++)l[c]=parseInt(l[c].replace(/\)/,""));e.indices=l}return e.id=r,e.sid=i,e.arraySyntax=o,e.memberSyntax=s,e.sampler=a(t.getAttribute("source")),e}function h(t){var e=[],n=t.channels,r=t.samplers,i=t.sources;for(var o in n)if(n.hasOwnProperty(o)){var a=n[o],s=r[a.sampler],l=s.inputs.INPUT,c=s.inputs.OUTPUT;v(m(a,i[l],i[c]),e)}return e}function f(t){return u(Xt.animations[t],h)}function m(t,e,n){var r,i,o,a,s,l,c=Xt.nodes[t.id],u=Lt(c.id),p=c.transforms[t.sid],d=c.matrix.clone().transpose(),h={};switch(p){case"matrix":for(o=0,a=e.array.length;o<a;o++)if(r=e.array[o],i=o*n.stride,void 0===h[r]&&(h[r]={}),!0===t.arraySyntax){var f=n.array[i],m=t.indices[0]+4*t.indices[1];h[r][m]=f}else for(s=0,l=n.stride;s<l;s++)h[r][s]=n.array[i+s];break;case"translate":case"rotate":case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',p)}var y=function(t,e){var n=[];for(var r in t)n.push({time:parseFloat(r),value:t[r]});n.sort(function(t,e){return t.time-e.time});for(var i=0;i<16;i++)b(n,i,e.elements[i]);return n}(h,d);return{name:u.uuid,keyframes:y}}var y=new THREE.Vector3,_=new THREE.Vector3,g=new THREE.Quaternion;function v(t,e){for(var n=t.keyframes,r=t.name,i=[],o=[],a=[],s=[],l=0,c=n.length;l<c;l++){var u=n[l],p=u.time,d=u.value;xt.fromArray(d).transpose(),xt.decompose(y,g,_),i.push(p),o.push(y.x,y.y,y.z),a.push(g.x,g.y,g.z,g.w),s.push(_.x,_.y,_.z)}return o.length>0&&e.push(new THREE.VectorKeyframeTrack(r+".position",i,o)),a.length>0&&e.push(new THREE.QuaternionKeyframeTrack(r+".quaternion",i,a)),s.length>0&&e.push(new THREE.VectorKeyframeTrack(r+".scale",i,s)),e}function b(t,e,n){var r,i,o,a=!0;for(i=0,o=t.length;i<o;i++)void 0===(r=t[i]).value[e]?r.value[e]=null:a=!1;if(!0===a)for(i=0,o=t.length;i<o;i++)(r=t[i]).value[e]=n;else!function(t,e){for(var n,r,i=0,o=t.length;i<o;i++){var a=t[i];if(null===a.value[e]){if(n=x(t,i,e),r=w(t,i,e),null===n){a.value[e]=r.value[e];continue}if(null===r){a.value[e]=n.value[e];continue}E(a,n,r,e)}}}(t,e)}function x(t,e,n){for(;e>=0;){var r=t[e];if(null!==r.value[n])return r;e--}return null}function w(t,e,n){for(;e<t.length;){var r=t[e];if(null!==r.value[n])return r;e++}return null}function E(t,e,n,r){n.time-e.time!=0?t.value[r]=(t.time-e.time)*(n.value[r]-e.value[r])/(n.time-e.time)+e.value[r]:t.value[r]=e.value[r]}function T(t){for(var e=[],n=t.name,r=t.end-t.start||-1,i=t.animations,o=0,a=i.length;o<a;o++)for(var s=f(i[o]),l=0,c=s.length;l<c;l++)e.push(s[l]);return new THREE.AnimationClip(n,r,e)}function S(t){return u(Xt.clips[t],T)}function M(t){for(var e={sources:{}},n=0,r=t.childNodes.length;n<r;n++){var o=t.childNodes[n];if(1===o.nodeType)switch(o.nodeName){case"bind_shape_matrix":e.bindShapeMatrix=i(o.textContent);break;case"source":var a=o.getAttribute("id");e.sources[a]=nt(o);break;case"joints":e.joints=j(o);break;case"vertex_weights":e.vertexWeights=C(o)}}return e}function j(t){for(var e={inputs:{}},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"input":var o=i.getAttribute("semantic"),s=a(i.getAttribute("source"));e.inputs[o]=s}}return e}function C(t){for(var e={inputs:{}},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"input":var s=i.getAttribute("semantic"),l=a(i.getAttribute("source")),c=parseInt(i.getAttribute("offset"));e.inputs[s]={id:l,offset:c};break;case"vcount":e.vcount=o(i.textContent);break;case"v":e.v=o(i.textContent)}}return e}function z(t){var e={id:t.id},n=Xt.geometries[e.id];return void 0!==t.skin&&(e.skin=function(t){var e,n,r,i={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},o=t.sources,a=t.vertexWeights,s=a.vcount,l=a.v,c=a.inputs.JOINT.offset,u=a.inputs.WEIGHT.offset,p=t.sources[t.joints.inputs.JOINT],d=t.sources[t.joints.inputs.INV_BIND_MATRIX],h=o[a.inputs.WEIGHT.id].array,f=0;for(e=0,r=s.length;e<r;e++){var m=s[e],y=[];for(n=0;n<m;n++){var _=l[f+c],g=h[l[f+u]];y.push({index:_,weight:g}),f+=2}for(y.sort(w),n=0;n<4;n++){var v=y[n];void 0!==v?(i.indices.array.push(v.index),i.weights.array.push(v.weight)):(i.indices.array.push(0),i.weights.array.push(0))}}for(t.bindShapeMatrix?i.bindMatrix=(new THREE.Matrix4).fromArray(t.bindShapeMatrix).transpose():i.bindMatrix=(new THREE.Matrix4).identity(),e=0,r=p.array.length;e<r;e++){var b=p.array[e],x=(new THREE.Matrix4).fromArray(d.array,e*d.stride).transpose();i.joints.push({name:b,boneInverse:x})}return i;function w(t,e){return e.weight-t.weight}}(t.skin),n.sources.skinIndices=e.skin.indices,n.sources.skinWeights=e.skin.weights),e}function R(t){return void 0!==t.build?t.build:t.init_from}function A(t){var e=Xt.images[t];return void 0!==e?u(e,R):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",t),null)}function L(t){for(var e={surfaces:{},samplers:{}},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"newparam":I(i,e);break;case"technique":e.technique=k(i);break;case"extra":e.extra=U(i)}}return e}function I(t,e){for(var n=t.getAttribute("sid"),r=0,i=t.childNodes.length;r<i;r++){var o=t.childNodes[r];if(1===o.nodeType)switch(o.nodeName){case"surface":e.surfaces[n]=P(o);break;case"sampler2D":e.samplers[n]=O(o)}}}function P(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"init_from":e.init_from=i.textContent}}return e}function O(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"source":e.source=i.textContent}}return e}function k(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"constant":case"lambert":case"blinn":case"phong":e.type=i.nodeName,e.parameters=B(i)}}return e}function B(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":e[i.nodeName]=D(i);break;case"transparent":e[i.nodeName]={opaque:i.getAttribute("opaque"),data:D(i)}}}return e}function D(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var o=t.childNodes[n];if(1===o.nodeType)switch(o.nodeName){case"color":e[o.nodeName]=i(o.textContent);break;case"float":e[o.nodeName]=parseFloat(o.textContent);break;case"texture":e[o.nodeName]={id:o.getAttribute("texture"),extra:H(o)}}}return e}function H(t){for(var e={technique:{}},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"extra":F(i,e)}}return e}function F(t,e){for(var n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"technique":N(i,e)}}}function N(t,e){for(var n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":e.technique[i.nodeName]=parseFloat(i.textContent);break;case"wrapU":case"wrapV":"TRUE"===i.textContent.toUpperCase()?e.technique[i.nodeName]=1:"FALSE"===i.textContent.toUpperCase()?e.technique[i.nodeName]=0:e.technique[i.nodeName]=parseInt(i.textContent)}}}function U(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"technique":e.technique=V(i)}}return e}function V(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"double_sided":e[i.nodeName]=parseInt(i.textContent)}}return e}function G(t){return t}function W(t){var e,n,r=(e=t.url,u(Xt.effects[e],G)),i=r.profile.technique,o=r.profile.extra;switch(i.type){case"phong":case"blinn":n=new THREE.MeshPhongMaterial;break;case"lambert":n=new THREE.MeshLambertMaterial;break;default:n=new THREE.MeshBasicMaterial}function a(t){var e=r.profile.samplers[t.id],n=null;if(void 0!==e?n=A(r.profile.surfaces[e.source].init_from):(console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),n=A(t.id)),null!==n){var i=function(t){var e,n=t.slice(2+(t.lastIndexOf(".")-1>>>0));switch(n=n.toLowerCase()){case"tga":e=Nt;break;default:e=Vt}return e}(n);if(void 0!==i){var o=i.load(n),a=t.extra;if(void 0!==a&&void 0!==a.technique&&!1===s(a.technique)){var l=a.technique;o.wrapS=l.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,o.wrapT=l.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,o.offset.set(l.offsetU||0,l.offsetV||0),o.repeat.set(l.repeatU||1,l.repeatV||1)}else o.wrapS=THREE.RepeatWrapping,o.wrapT=THREE.RepeatWrapping;return o}return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",n),null}return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",t.id),null}n.name=t.name||"";var l=i.parameters;for(var c in l){var p=l[c];switch(c){case"diffuse":p.color&&n.color.fromArray(p.color),p.texture&&(n.map=a(p.texture));break;case"specular":p.color&&n.specular&&n.specular.fromArray(p.color),p.texture&&(n.specularMap=a(p.texture));break;case"bump":p.texture&&(n.normalMap=a(p.texture));break;case"ambient":p.texture&&(n.lightMap=a(p.texture));break;case"shininess":p.float&&n.shininess&&(n.shininess=p.float);break;case"emission":p.color&&n.emissive&&n.emissive.fromArray(p.color),p.texture&&(n.emissiveMap=a(p.texture))}}var d=l.transparent,h=l.transparency;if(void 0===h&&d&&(h={float:1}),void 0===d&&h&&(d={opaque:"A_ONE",data:{color:[1,1,1,1]}}),d&&h)if(d.data.texture)n.transparent=!0;else{var f=d.data.color;switch(d.opaque){case"A_ONE":n.opacity=f[3]*h.float;break;case"RGB_ZERO":n.opacity=1-f[0]*h.float;break;case"A_ZERO":n.opacity=1-f[3]*h.float;break;case"RGB_ONE":n.opacity=f[0]*h.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',d.opaque)}n.opacity<1&&(n.transparent=!0)}return void 0!==o&&void 0!==o.technique&&1===o.technique.double_sided&&(n.side=THREE.DoubleSide),n}function q(t){return u(Xt.materials[t],W)}function X(t){for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];switch(n.nodeName){case"technique_common":return Y(n)}}return{}}function Y(t){for(var e={},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];switch(r.nodeName){case"perspective":case"orthographic":e.technique=r.nodeName,e.parameters=Q(r)}}return e}function Q(t){for(var e={},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];switch(r.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":e[r.nodeName]=parseFloat(r.textContent)}}return e}function Z(t){var e;switch(t.optics.technique){case"perspective":e=new THREE.PerspectiveCamera(t.optics.parameters.yfov,t.optics.parameters.aspect_ratio,t.optics.parameters.znear,t.optics.parameters.zfar);break;case"orthographic":var n=t.optics.parameters.ymag,r=t.optics.parameters.xmag,i=t.optics.parameters.aspect_ratio;r=void 0===r?n*i:r,n=void 0===n?r/i:n,r*=.5,n*=.5,e=new THREE.OrthographicCamera(-r,r,n,-n,t.optics.parameters.znear,t.optics.parameters.zfar);break;default:e=new THREE.PerspectiveCamera}return e.name=t.name||"",e}function J(t){var e=Xt.cameras[t];return void 0!==e?u(e,Z):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",t),null)}function K(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"directional":case"point":case"spot":case"ambient":e.technique=i.nodeName,e.parameters=$(i)}}return e}function $(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var o=t.childNodes[n];if(1===o.nodeType)switch(o.nodeName){case"color":var a=i(o.textContent);e.color=(new THREE.Color).fromArray(a);break;case"falloff_angle":e.falloffAngle=parseFloat(o.textContent);break;case"quadratic_attenuation":var s=parseFloat(o.textContent);e.distance=s?Math.sqrt(1/s):0}}return e}function tt(t){var e;switch(t.technique){case"directional":e=new THREE.DirectionalLight;break;case"point":e=new THREE.PointLight;break;case"spot":e=new THREE.SpotLight;break;case"ambient":e=new THREE.AmbientLight}return t.parameters.color&&e.color.copy(t.parameters.color),t.parameters.distance&&(e.distance=t.parameters.distance),e}function et(t){var e=Xt.lights[t];return void 0!==e?u(e,tt):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",t),null)}function nt(t){for(var e={array:[],stride:3},o=0;o<t.childNodes.length;o++){var a=t.childNodes[o];if(1===a.nodeType)switch(a.nodeName){case"float_array":e.array=i(a.textContent);break;case"Name_array":e.array=r(a.textContent);break;case"technique_common":var s=n(a,"accessor")[0];void 0!==s&&(e.stride=parseInt(s.getAttribute("stride")))}}return e}function rt(t){for(var e={},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];1===r.nodeType&&(e[r.getAttribute("semantic")]=a(r.getAttribute("source")))}return e}function it(t){for(var e={type:t.nodeName,material:t.getAttribute("material"),count:parseInt(t.getAttribute("count")),inputs:{},stride:0,hasUV:!1},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"input":var s=a(i.getAttribute("source")),l=i.getAttribute("semantic"),c=parseInt(i.getAttribute("offset")),u=parseInt(i.getAttribute("set")),p=u>0?l+u:l;e.inputs[p]={id:s,offset:c},e.stride=Math.max(e.stride,c+1),"TEXCOORD"===l&&(e.hasUV=!0);break;case"vcount":e.vcount=o(i.textContent);break;case"p":e.p=o(i.textContent)}}return e}function ot(t){for(var e=0,n=0,r=t.length;n<r;n++)!0===t[n].hasUV&&e++;e>0&&e<t.length&&(t.uvsNeedsFix=!0)}function at(t){var e={},n=t.sources,r=t.vertices,i=t.primitives;if(0===i.length)return{};var o=function(t){for(var e={},n=0;n<t.length;n++){var r=t[n];void 0===e[r.type]&&(e[r.type]=[]),e[r.type].push(r)}return e}(i);for(var a in o){var s=o[a];ot(s),e[a]=st(s,n,r)}return e}function st(t,e,n){for(var r={},i={array:[],stride:0},o={array:[],stride:0},a={array:[],stride:0},s={array:[],stride:0},l={array:[],stride:0},c=[],u=[],p=new THREE.BufferGeometry,d=[],h=0,f=0;f<t.length;f++){var m=t[f],y=m.inputs,_=0;switch(m.type){case"lines":case"linestrips":_=2*m.count;break;case"triangles":_=3*m.count;break;case"polylist":for(var g=0;g<m.count;g++){var v=m.vcount[g];switch(v){case 3:_+=3;break;case 4:_+=6;break;default:_+=3*(v-2)}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",m.type)}for(var b in p.addGroup(h,_,f),h+=_,m.material&&d.push(m.material),y){var x=y[b];switch(b){case"VERTEX":for(var w in n){var E=n[w];switch(w){case"POSITION":var T=i.array.length;if(lt(m,e[E],x.offset,i.array),i.stride=e[E].stride,e.skinWeights&&e.skinIndices&&(lt(m,e.skinIndices,x.offset,c),lt(m,e.skinWeights,x.offset,u)),!1===m.hasUV&&!0===t.uvsNeedsFix){_=(i.array.length-T)/i.stride;for(var S=0;S<_;S++)a.array.push(0,0)}break;case"NORMAL":lt(m,e[E],x.offset,o.array),o.stride=e[E].stride;break;case"COLOR":lt(m,e[E],x.offset,l.array),l.stride=e[E].stride;break;case"TEXCOORD":lt(m,e[E],x.offset,a.array),a.stride=e[E].stride;break;case"TEXCOORD1":lt(m,e[E],x.offset,s.array),a.stride=e[E].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',w)}}break;case"NORMAL":lt(m,e[x.id],x.offset,o.array),o.stride=e[x.id].stride;break;case"COLOR":lt(m,e[x.id],x.offset,l.array),l.stride=e[x.id].stride;break;case"TEXCOORD":lt(m,e[x.id],x.offset,a.array),a.stride=e[x.id].stride;break;case"TEXCOORD1":lt(m,e[x.id],x.offset,s.array),s.stride=e[x.id].stride}}}return i.array.length>0&&p.setAttribute("position",new THREE.Float32BufferAttribute(i.array,i.stride)),o.array.length>0&&p.setAttribute("normal",new THREE.Float32BufferAttribute(o.array,o.stride)),l.array.length>0&&p.setAttribute("color",new THREE.Float32BufferAttribute(l.array,l.stride)),a.array.length>0&&p.setAttribute("uv",new THREE.Float32BufferAttribute(a.array,a.stride)),s.array.length>0&&p.setAttribute("uv2",new THREE.Float32BufferAttribute(s.array,s.stride)),c.length>0&&p.setAttribute("skinIndex",new THREE.Float32BufferAttribute(c,4)),u.length>0&&p.setAttribute("skinWeight",new THREE.Float32BufferAttribute(u,4)),r.data=p,r.type=t[0].type,r.materialKeys=d,r}function lt(t,e,n,r){var i=t.p,o=t.stride,a=t.vcount;function s(t){for(var e=i[t+n]*c,o=e+c;e<o;e++)r.push(l[e])}var l=e.array,c=e.stride;if(void 0!==t.vcount)for(var u=0,p=0,d=a.length;p<d;p++){var h=a[p];if(4===h){var f=u+1*o,m=u+2*o,y=u+3*o;s(u+0*o),s(f),s(y),s(f),s(m),s(y)}else if(3===h)f=u+1*o,m=u+2*o,s(u+0*o),s(f),s(m);else if(h>4)for(var _=1,g=h-2;_<=g;_++)f=u+o*_,m=u+o*(_+1),s(u+0*o),s(f),s(m);u+=o*h}else for(p=0,d=i.length;p<d;p+=o)s(p)}function ct(t){return u(Xt.geometries[t],at)}function ut(t){return void 0!==t.build?t.build:t}function pt(t,e){for(var n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"joint":e.joints[r.getAttribute("sid")]=dt(r);break;case"link":e.links.push(ft(r))}}}function dt(t){for(var e,n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"prismatic":case"revolute":e=ht(r)}}return e}function ht(t,e){e={sid:t.getAttribute("sid"),name:t.getAttribute("name")||"",axis:new THREE.Vector3,limits:{min:0,max:0},type:t.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(var n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"axis":var o=i(r.textContent);e.axis.fromArray(o);break;case"limits":var a=r.getElementsByTagName("max")[0],s=r.getElementsByTagName("min")[0];e.limits.max=parseFloat(a.textContent),e.limits.min=parseFloat(s.textContent)}}return e.limits.min>=e.limits.max&&(e.static=!0),e.middlePosition=(e.limits.min+e.limits.max)/2,e}function ft(t){for(var e={sid:t.getAttribute("sid"),name:t.getAttribute("name")||"",attachments:[],transforms:[]},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"attachment_full":e.attachments.push(mt(r));break;case"matrix":case"translate":case"rotate":e.transforms.push(yt(r))}}return e}function mt(t){for(var e={joint:t.getAttribute("joint").split("/").pop(),transforms:[],links:[]},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"link":e.links.push(ft(r));break;case"matrix":case"translate":case"rotate":e.transforms.push(yt(r))}}return e}function yt(t){var e={type:t.nodeName},n=i(t.textContent);switch(e.type){case"matrix":e.obj=new THREE.Matrix4,e.obj.fromArray(n).transpose();break;case"translate":e.obj=new THREE.Vector3,e.obj.fromArray(n);break;case"rotate":e.obj=new THREE.Vector3,e.obj.fromArray(n),e.angle=THREE.MathUtils.degToRad(n[3])}return e}function _t(t,e){for(var n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"technique_common":gt(r,e)}}}function gt(t,e){for(var n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"inertia":e.inertia=i(r.textContent);break;case"mass":e.mass=i(r.textContent)[0]}}}function vt(t){for(var e={target:t.getAttribute("target").split("/").pop()},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"axis":var i=r.getElementsByTagName("param")[0];e.axis=i.textContent;var o=e.axis.split("inst_").pop().split("axis")[0];e.jointIndex=o.substr(0,o.length-1)}}return e}function bt(t){return void 0!==t.build?t.build:t}var xt=new THREE.Matrix4,wt=new THREE.Vector3;function Et(t){for(var e={name:t.getAttribute("name")||"",type:t.getAttribute("type"),id:t.getAttribute("id"),sid:t.getAttribute("sid"),matrix:new THREE.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"node":e.nodes.push(r.getAttribute("id")),Et(r);break;case"instance_camera":e.instanceCameras.push(a(r.getAttribute("url")));break;case"instance_controller":e.instanceControllers.push(Tt(r));break;case"instance_light":e.instanceLights.push(a(r.getAttribute("url")));break;case"instance_geometry":e.instanceGeometries.push(Tt(r));break;case"instance_node":e.instanceNodes.push(a(r.getAttribute("url")));break;case"matrix":var o=i(r.textContent);e.matrix.multiply(xt.fromArray(o).transpose()),e.transforms[r.getAttribute("sid")]=r.nodeName;break;case"translate":o=i(r.textContent),wt.fromArray(o),e.matrix.multiply(xt.makeTranslation(wt.x,wt.y,wt.z)),e.transforms[r.getAttribute("sid")]=r.nodeName;break;case"rotate":o=i(r.textContent);var s=THREE.MathUtils.degToRad(o[3]);e.matrix.multiply(xt.makeRotationAxis(wt.fromArray(o),s)),e.transforms[r.getAttribute("sid")]=r.nodeName;break;case"scale":o=i(r.textContent),e.matrix.scale(wt.fromArray(o)),e.transforms[r.getAttribute("sid")]=r.nodeName;break;case"extra":break;default:console.log(r)}}return At(e.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",e.id):Xt.nodes[e.id]=e,e}function Tt(t){for(var e={id:a(t.getAttribute("url")),materials:{},skeletons:[]},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];switch(r.nodeName){case"bind_material":for(var i=r.getElementsByTagName("instance_material"),o=0;o<i.length;o++){var s=i[o],l=s.getAttribute("symbol"),c=s.getAttribute("target");e.materials[l]=a(c)}break;case"skeleton":e.skeletons.push(a(r.textContent))}}return e}function St(t,e){var n,r,i,o=[],a=[];for(n=0;n<t.length;n++){var s=t[n];if(At(s))Mt(Lt(s),e,o);else if(i=s,void 0!==Xt.visualScenes[i])for(var l=Xt.visualScenes[s].children,c=0;c<l.length;c++){var u=l[c];"JOINT"===u.type&&Mt(Lt(u.id),e,o)}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",s)}for(n=0;n<e.length;n++)for(c=0;c<o.length;c++)if((r=o[c]).bone.name===e[n].name){a[n]=r,r.processed=!0;break}for(n=0;n<o.length;n++)!1===(r=o[n]).processed&&(a.push(r),r.processed=!0);var p=[],d=[];for(n=0;n<a.length;n++)r=a[n],p.push(r.bone),d.push(r.boneInverse);return new THREE.Skeleton(p,d)}function Mt(t,e,n){t.traverse(function(t){if(!0===t.isBone){for(var r,i=0;i<e.length;i++){var o=e[i];if(o.name===t.name){r=o.boneInverse;break}}void 0===r&&(r=new THREE.Matrix4),n.push({bone:t,boneInverse:r,processed:!1})}})}function jt(t){for(var e,n=[],r=t.matrix,i=t.nodes,o=t.type,a=t.instanceCameras,s=t.instanceControllers,l=t.instanceLights,c=t.instanceGeometries,p=t.instanceNodes,d=0,h=i.length;d<h;d++)n.push(Lt(i[d]));for(d=0,h=a.length;d<h;d++){var f=J(a[d]);null!==f&&n.push(f.clone())}for(d=0,h=s.length;d<h;d++)for(var m=s[d],y=(e=m.id,u(Xt.controllers[e],z)),_=Rt(ct(y.id),m.materials),g=St(m.skeletons,y.skin.joints),v=0,b=_.length;v<b;v++){var x;(x=_[v]).isSkinnedMesh&&(x.bind(g,y.skin.bindMatrix),x.normalizeSkinWeights()),n.push(x)}for(d=0,h=l.length;d<h;d++){var w=et(l[d]);null!==w&&n.push(w.clone())}for(d=0,h=c.length;d<h;d++)for(v=0,b=(_=Rt(ct((m=c[d]).id),m.materials)).length;v<b;v++)n.push(_[v]);for(d=0,h=p.length;d<h;d++)n.push(Lt(p[d]).clone());if(0===i.length&&1===n.length)x=n[0];else for(x="JOINT"===o?new THREE.Bone:new THREE.Group,d=0;d<n.length;d++)x.add(n[d]);return x.name="JOINT"===o?t.sid:t.name,x.matrix.copy(r),x.matrix.decompose(x.position,x.quaternion,x.scale),x}var Ct=new THREE.MeshBasicMaterial({color:16711935});function zt(t,e){for(var n=[],r=0,i=t.length;r<i;r++){var o=e[t[r]];void 0===o?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",t[r]),n.push(Ct)):n.push(q(o))}return n}function Rt(t,e){var n=[];for(var r in t){var i=t[r],o=zt(i.materialKeys,e);0===o.length&&("lines"===r||"linestrips"===r?o.push(new THREE.LineBasicMaterial):o.push(new THREE.MeshPhongMaterial));var a=void 0!==i.data.attributes.skinIndex;if(a)for(var s=0,l=o.length;s<l;s++)o[s].skinning=!0;var c,u=1===o.length?o[0]:o;switch(r){case"lines":c=new THREE.LineSegments(i.data,u);break;case"linestrips":c=new THREE.Line(i.data,u);break;case"triangles":case"polylist":c=a?new THREE.SkinnedMesh(i.data,u):new THREE.Mesh(i.data,u)}n.push(c)}return n}function At(t){return void 0!==Xt.nodes[t]}function Lt(t){return u(Xt.nodes[t],jt)}function It(t){var e=new THREE.Group;e.name=t.name;for(var n=t.children,r=0;r<n.length;r++){var i=n[r];e.add(Lt(i.id))}return e}function Pt(t){return u(Xt.visualScenes[t],It)}if(0===t.length)return{scene:new THREE.Scene};var Ot=(new DOMParser).parseFromString(t,"application/xml"),kt=n(Ot,"COLLADA")[0],Bt=Ot.getElementsByTagName("parsererror")[0];if(void 0!==Bt){var Dt,Ht=n(Bt,"div")[0];return Dt=Ht?Ht.textContent:function(t){for(var e="",n=[t];n.length;){var r=n.shift();r.nodeType===Node.TEXT_NODE?e+=r.textContent:(e+="\n",n.push.apply(n,r.childNodes))}return e.trim()}(Bt),console.error("THREE.ColladaLoader: Failed to parse collada file.\n",Dt),null}var Ft=kt.getAttribute("version");console.log("THREE.ColladaLoader: File version",Ft);var Nt,Ut=function(t){return{unit:function(t){return void 0!==t&&!0===t.hasAttribute("meter")?parseFloat(t.getAttribute("meter")):1}(n(t,"unit")[0]),upAxis:function(t){return void 0!==t?t.textContent:"Y_UP"}(n(t,"up_axis")[0])}}(n(kt,"asset")[0]),Vt=new THREE.TextureLoader(this.manager);Vt.setPath(this.resourcePath||e).setCrossOrigin(this.crossOrigin),THREE.TGALoader&&(Nt=new THREE.TGALoader(this.manager)).setPath(this.resourcePath||e);var Gt=[],Wt={},qt=0,Xt={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};l(kt,"library_animations","animation",function t(e){for(var n={sources:{},samplers:{},channels:{}},r=!1,i=0,o=e.childNodes.length;i<o;i++){var a,s=e.childNodes[i];if(1===s.nodeType)switch(s.nodeName){case"source":a=s.getAttribute("id"),n.sources[a]=nt(s);break;case"sampler":a=s.getAttribute("id"),n.samplers[a]=p(s);break;case"channel":a=s.getAttribute("target"),n.channels[a]=d(s);break;case"animation":t(s),r=!0;break;default:console.log(s)}}!1===r&&(Xt.animations[e.getAttribute("id")||THREE.MathUtils.generateUUID()]=n)}),l(kt,"library_animation_clips","animation_clip",function(t){for(var e={name:t.getAttribute("id")||"default",start:parseFloat(t.getAttribute("start")||0),end:parseFloat(t.getAttribute("end")||0),animations:[]},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"instance_animation":e.animations.push(a(i.getAttribute("url")))}}Xt.clips[t.getAttribute("id")]=e}),l(kt,"library_controllers","controller",function(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"skin":e.id=a(i.getAttribute("source")),e.skin=M(i);break;case"morph":e.id=a(i.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.")}}Xt.controllers[t.getAttribute("id")]=e}),l(kt,"library_images","image",function(t){var e={init_from:n(t,"init_from")[0].textContent};Xt.images[t.getAttribute("id")]=e}),l(kt,"library_effects","effect",function(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"profile_COMMON":e.profile=L(i)}}Xt.effects[t.getAttribute("id")]=e}),l(kt,"library_materials","material",function(t){for(var e={name:t.getAttribute("name")},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"instance_effect":e.url=a(i.getAttribute("url"))}}Xt.materials[t.getAttribute("id")]=e}),l(kt,"library_cameras","camera",function(t){for(var e={name:t.getAttribute("name")},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"optics":e.optics=X(i)}}Xt.cameras[t.getAttribute("id")]=e}),l(kt,"library_lights","light",function(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"technique_common":e=K(i)}}Xt.lights[t.getAttribute("id")]=e}),l(kt,"library_geometries","geometry",function(t){var e={name:t.getAttribute("name"),sources:{},vertices:{},primitives:[]},r=n(t,"mesh")[0];if(void 0!==r){for(var i=0;i<r.childNodes.length;i++){var o=r.childNodes[i];if(1===o.nodeType){var a=o.getAttribute("id");switch(o.nodeName){case"source":e.sources[a]=nt(o);break;case"vertices":e.vertices=rt(o);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",o.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":e.primitives.push(it(o));break;default:console.log(o)}}}Xt.geometries[t.getAttribute("id")]=e}}),l(kt,"library_nodes","node",Et),l(kt,"library_visual_scenes","visual_scene",function(t){var e={name:t.getAttribute("name"),children:[]};!function(t){for(var e=t.getElementsByTagName("node"),n=0;n<e.length;n++){var r=e[n];!1===r.hasAttribute("id")&&r.setAttribute("id","three_default_"+qt++)}}(t);for(var r=n(t,"node"),i=0;i<r.length;i++)e.children.push(Et(r[i]));Xt.visualScenes[t.getAttribute("id")]=e}),l(kt,"library_kinematics_models","kinematics_model",function(t){for(var e={name:t.getAttribute("name")||"",joints:{},links:[]},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"technique_common":pt(r,e)}}Xt.kinematicsModels[t.getAttribute("id")]=e}),l(kt,"library_physics_models","physics_model",function(t){for(var e={name:t.getAttribute("name")||"",rigidBodies:{}},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"rigid_body":e.rigidBodies[r.getAttribute("name")]={},_t(r,e.rigidBodies[r.getAttribute("name")])}}Xt.physicsModels[t.getAttribute("id")]=e}),l(kt,"scene","instance_kinematics_scene",function(t){for(var e={bindJointAxis:[]},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"bind_joint_axis":e.bindJointAxis.push(vt(r))}}Xt.kinematicsScenes[a(t.getAttribute("url"))]=e}),c(Xt.animations,h),c(Xt.clips,T),c(Xt.controllers,z),c(Xt.images,R),c(Xt.effects,G),c(Xt.materials,W),c(Xt.cameras,Z),c(Xt.lights,tt),c(Xt.geometries,at),c(Xt.visualScenes,It),function(){var t=Xt.clips;if(!0===s(t)){if(!1===s(Xt.animations)){var e=[];for(var n in Xt.animations)for(var r=f(n),i=0,o=r.length;i<o;i++)e.push(r[i]);Gt.push(new THREE.AnimationClip("default",-1,e))}}else for(var n in t)Gt.push(S(n))}(),function(){var t=Object.keys(Xt.kinematicsModels)[0],e=Object.keys(Xt.kinematicsScenes)[0],n=Object.keys(Xt.visualScenes)[0];if(void 0!==t&&void 0!==e){for(var r,o=(r=t,u(Xt.kinematicsModels[r],ut)),a=function(t){return u(Xt.kinematicsScenes[t],bt)}(e),s=Pt(n),l=a.bindJointAxis,c={},p=0,d=l.length;p<d;p++){var h=l[p],f=kt.querySelector('[sid="'+h.target+'"]');if(f){var m=f.parentElement;_(h.jointIndex,m)}}var y=new THREE.Matrix4;Wt={joints:o&&o.joints,getJointValue:function(t){var e=c[t];if(e)return e.position;console.warn("THREE.ColladaLoader: Joint "+t+" doesn't exist.")},setJointValue:function(t,e){var n=c[t];if(n){var r=n.joint;if(e>r.limits.max||e<r.limits.min)console.warn("THREE.ColladaLoader: Joint "+t+" value "+e+" outside of limits (min: "+r.limits.min+", max: "+r.limits.max+").");else if(r.static)console.warn("THREE.ColladaLoader: Joint "+t+" is static.");else{var i=n.object,o=r.axis,a=n.transforms;xt.identity();for(var s=0;s<a.length;s++){var l=a[s];if(l.sid&&-1!==l.sid.indexOf(t))switch(r.type){case"revolute":xt.multiply(y.makeRotationAxis(o,THREE.MathUtils.degToRad(e)));break;case"prismatic":xt.multiply(y.makeTranslation(o.x*e,o.y*e,o.z*e));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+r.type)}else switch(l.type){case"matrix":xt.multiply(l.obj);break;case"translate":xt.multiply(y.makeTranslation(l.obj.x,l.obj.y,l.obj.z));break;case"scale":xt.scale(l.obj);break;case"rotate":xt.multiply(y.makeRotationAxis(l.obj,l.angle))}}i.matrix.copy(xt),i.matrix.decompose(i.position,i.quaternion,i.scale),c[t].position=e}}else console.log("THREE.ColladaLoader: "+t+" does not exist.")}}}function _(t,e){var n=e.getAttribute("name"),r=o.joints[t];s.traverse(function(o){o.name===n&&(c[t]={object:o,transforms:function(t){for(var e=[],n=kt.querySelector('[id="'+t.id+'"]'),r=0;r<n.childNodes.length;r++){var o=n.childNodes[r];if(1===o.nodeType)switch(o.nodeName){case"matrix":var a=i(o.textContent),s=(new THREE.Matrix4).fromArray(a).transpose();e.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:s});break;case"translate":case"scale":a=i(o.textContent);var l=(new THREE.Vector3).fromArray(a);e.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:l});break;case"rotate":a=i(o.textContent),l=(new THREE.Vector3).fromArray(a);var c=THREE.MathUtils.degToRad(a[3]);e.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:l,angle:c})}}return e}(e),joint:r,position:r.zeroPosition})})}}();var Yt=Pt(a(n(n(kt,"scene")[0],"instance_visual_scene")[0].getAttribute("url")));return Yt.animations=Gt,"Z_UP"===Ut.upAxis&&Yt.quaternion.setFromEuler(new THREE.Euler(-Math.PI/2,0,0)),Yt.scale.multiplyScalar(Ut.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),Gt},kinematics:Wt,library:Xt,scene:Yt}}}),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Nebula=e():t.Nebula=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=41)}([function(t,e,n){var r=n(1),i=n(2);t.exports=function(t){return"number"==typeof t||i(t)&&"[object Number]"==r(t)}},function(t,e,n){var r=n(5),i=n(25),o=n(26),a=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":a&&a in Object(t)?i(t):o(t)}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,n){var r=n(4),i=n(15),o=n(8);t.exports=function(t){return(o(t)?r:i)(t)}},function(t,e,n){var r=n(14);t.exports=function(t){var e=t.length;return e?t[r(0,e-1)]:void 0}},function(t,e,n){var r=n(6).Symbol;t.exports=r},function(t,e,n){var r=n(7),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();t.exports=o},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n(24))},function(t,e){var n=Array.isArray;t.exports=n},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},function(t,e,n){var r,i,o=n(12),a=n(13),s=0,l=0;t.exports=function(t,e,n){var c=e&&n||0,u=e||[],p=(t=t||{}).node||r,d=void 0!==t.clockseq?t.clockseq:i;if(null==p||null==d){var h=o();null==p&&(p=r=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==d&&(d=i=16383&(h[6]<<8|h[7]))}var f=void 0!==t.msecs?t.msecs:(new Date).getTime(),m=void 0!==t.nsecs?t.nsecs:l+1,y=f-s+(m-l)/1e4;if(y<0&&void 0===t.clockseq&&(d=d+1&16383),(y<0||f>s)&&void 0===t.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=f,l=m,i=d;var _=(1e4*(268435455&(f+=122192928e5))+m)%4294967296;u[c++]=_>>>24&255,u[c++]=_>>>16&255,u[c++]=_>>>8&255,u[c++]=255&_;var g=f/4294967296*1e4&268435455;u[c++]=g>>>8&255,u[c++]=255&g,u[c++]=g>>>24&15|16,u[c++]=g>>>16&255,u[c++]=d>>>8|128,u[c++]=255&d;for(var v=0;v<6;++v)u[c+v]=p[v];return e||a(u)}},function(t,e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);t.exports=function(){return n(r),r}}else{var i=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),i[e]=t>>>((3&e)<<3)&255;return i}}},function(t,e){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);t.exports=function(t,e){var r=e||0,i=n;return[i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]]].join("")}},function(t,e){var n=Math.floor,r=Math.random;t.exports=function(t,e){return t+n(r()*(e-t+1))}},function(t,e,n){var r=n(4),i=n(16);t.exports=function(t){return r(i(t))}},function(t,e,n){var r=n(17),i=n(19);t.exports=function(t){return null==t?[]:r(t,i(t))}},function(t,e,n){var r=n(18);t.exports=function(t,e){return r(e,function(e){return t[e]})}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}},function(t,e,n){var r=n(20),i=n(34),o=n(38);t.exports=function(t){return o(t)?r(t):i(t)}},function(t,e,n){var r=n(21),i=n(22),o=n(8),a=n(27),s=n(29),l=n(30),c=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=o(t),u=!n&&i(t),p=!n&&!u&&a(t),d=!n&&!u&&!p&&l(t),h=n||u||p||d,f=h?r(t.length,String):[],m=f.length;for(var y in t)!e&&!c.call(t,y)||h&&("length"==y||p&&("offset"==y||"parent"==y)||d&&("buffer"==y||"byteLength"==y||"byteOffset"==y)||s(y,m))||f.push(y);return f}},function(t,e){t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},function(t,e,n){var r=n(23),i=n(2),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,l=r(function(){return arguments}())?r:function(t){return i(t)&&a.call(t,"callee")&&!s.call(t,"callee")};t.exports=l},function(t,e,n){var r=n(1),i=n(2);t.exports=function(t){return i(t)&&"[object Arguments]"==r(t)}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(5),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;t.exports=function(t){var e=o.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(t){}var i=a.call(t);return r&&(e?t[s]=n:delete t[s]),i}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e,n){(function(t){var r=n(6),i=n(28),o=e&&!e.nodeType&&e,a=o&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===o?r.Buffer:void 0,l=(s?s.isBuffer:void 0)||i;t.exports=l}).call(this,n(9)(t))},function(t,e){t.exports=function(){return!1}},function(t,e){var n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&n.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,n){var r=n(31),i=n(32),o=n(33),a=o&&o.isTypedArray,s=a?i(a):r;t.exports=s},function(t,e,n){var r=n(1),i=n(10),o=n(2),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(t){return o(t)&&i(t.length)&&!!a[r(t)]}},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,n){(function(t){var r=n(7),i=e&&!e.nodeType&&e,o=i&&"object"==typeof t&&t&&!t.nodeType&&t,a=o&&o.exports===i&&r.process,s=function(){try{return o&&o.require&&o.require("util").types||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=s}).call(this,n(9)(t))},function(t,e,n){var r=n(35),i=n(36),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return i(t);var e=[];for(var n in Object(t))o.call(t,n)&&"constructor"!=n&&e.push(n);return e}},function(t,e){var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},function(t,e,n){var r=n(37)(Object.keys,Object);t.exports=r},function(t,e){t.exports=function(t,e){return function(n){return t(e(n))}}},function(t,e,n){var r=n(39),i=n(10);t.exports=function(t){return null!=t&&i(t.length)&&!r(t)}},function(t,e,n){var r=n(1),i=n(40);t.exports=function(t){if(!i(t))return!1;var e=r(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"BoxZone",function(){return sn}),n.d(r,"LineZone",function(){return ln}),n.d(r,"MeshZone",function(){return cn}),n.d(r,"PointZone",function(){return un}),n.d(r,"ScreenZone",function(){return pn}),n.d(r,"SphereZone",function(){return dn});var i={};n.r(i),n.d(i,"Body",function(){return Fe}),n.d(i,"BodySprite",function(){return qe}),n.d(i,"InitializerUtil",function(){return nn}),n.d(i,"Life",function(){return rn}),n.d(i,"Mass",function(){return on}),n.d(i,"Position",function(){return hn}),n.d(i,"Radius",function(){return fn}),n.d(i,"Rate",function(){return mn}),n.d(i,"Texture",function(){return yn}),n.d(i,"VectorVelocity",function(){return bn}),n.d(i,"PolarVelocity",function(){return gn}),n.d(i,"RadialVelocity",function(){return vn});var o={};n.r(o),n.d(o,"Alpha",function(){return Hn}),n.d(o,"Attraction",function(){return Fn}),n.d(o,"Collision",function(){return Nn}),n.d(o,"Color",function(){return Un}),n.d(o,"CrossZone",function(){return Vn}),n.d(o,"Force",function(){return Gn}),n.d(o,"Gravity",function(){return Wn}),n.d(o,"RandomDrift",function(){return qn}),n.d(o,"Repulsion",function(){return Xn}),n.d(o,"Rotate",function(){return Yn}),n.d(o,"Scale",function(){return Qn}),n.d(o,"Spring",function(){return Zn});const a="Behaviour",s="Alpha",l="Attraction",c="Collision",u="Color",p="CrossZone",d="Force",h="Gravity",f="RandomDrift",m="Repulsion",y="Rotate",_="Scale",g="Spring",v="Initializer",b="Body",x="BodySprite",w="Texture",E="Life",T="Mass",S="Position",M="Radius",j="VectorVelocity",C="PolarVelocity",z="RadialVelocity",R="Rate",A=[x,w],L="Zone",I="BoxZone",P="LineZone",O="MeshZone",k="PointZone",B="ScreenZone",D="SphereZone",H="BaseRenderer",F="CustomRenderer",N="SpriteRenderer",U="MeshRenderer",V="PointsRenderer",G=3.142,W=500,q=G/180,X=100,Y="euler",Q={easeLinear:function(t){return t},easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return-(Math.pow(t-1,2)-1)},easeInOutQuad:function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return-(Math.pow(t-1,4)-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeInSine:function(t){return 1-Math.cos(t*(G/2))},easeOutSine:function(t){return Math.sin(t*(G/2))},easeInOutSine:function(t){return-.5*(Math.cos(G*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-Math.pow(t-1,2))},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInBack:function(t){var e=1.70158;return t*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)}},{easeLinear:Z,easeInQuad:J,easeOutQuad:K,easeInOutQuad:$,easeInCubic:tt,easeOutCubic:et,easeInOutCubic:nt,easeInQuart:rt,easeOutQuart:it,easeInOutQuart:ot,easeInSine:at,easeOutSine:st,easeInOutSine:lt,easeInExpo:ct,easeOutExpo:ut,easeInOutExpo:pt,easeInCirc:dt,easeOutCirc:ht,easeInOutCirc:ft,easeInBack:mt,easeOutBack:yt,easeInOutBack:_t}=Q,gt=t=>Q[t]?Q[t]:Q.easeLinear,vt=t=>Q[t]?Q[t]:Q.easeLinear,bt=1/0,xt=0,wt=1,Et=!1,Tt=!1,St=null,Mt=null,jt=1,Ct=10,zt=1,Rt=1,At=!1,Lt=!1,It=Z,Pt=.0167,Ot=[S,E,M,T,b,x,w,C,z,j],kt=[s,l,u,p,d,h,f,m,y,_,g],Bt=[I,P,O,k,D];var Dt,Ht,Ft,Nt,Ut,Vt,Gt,Wt,qt,Xt,Yt={getRGB:function(t){var e={};if("number"==typeof t)r=Math.floor(t),e.r=(t>>16&255)/255,e.g=(t>>8&255)/255,e.b=(255&t)/255;else if("string"==typeof t){var n;if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(t))e.r=Math.min(255,parseInt(n[1],10))/255,e.g=Math.min(255,parseInt(n[2],10))/255,e.b=Math.min(255,parseInt(n[3],10))/255;else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var r=n[1];e.r=parseInt(r.charAt(0)+r.charAt(1),16)/255,e.g=parseInt(r.charAt(2)+r.charAt(3),16)/255,e.b=parseInt(r.charAt(4)+r.charAt(5),16)/255}}else e.r=t.r,e.g=t.g,e.b=t.b;return e}},Qt={_id:0,_uids:new Map,id:function(t){if(this._uids.has(t))return this._uids.get(t);const e="PUID_"+this._id++;return this._uids.set(t,e),e}},Zt={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);return function(){var e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&n]+t[n>>8&255]+"-"+t[n>>16&15|64]+t[n>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]).toUpperCase()}}(),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*Zt.DEG2RAD},radToDeg:function(t){return t*Zt.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};function Jt(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}function Kt(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}function $t(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function te(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||te.DefaultOrder}Object.assign(Jt,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,o,a){var s=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3],p=i[o+0],d=i[o+1],h=i[o+2],f=i[o+3];if(u!==f||s!==p||l!==d||c!==h){var m=1-a,y=s*p+l*d+c*h+u*f,_=y>=0?1:-1,g=1-y*y;if(g>Number.EPSILON){var v=Math.sqrt(g),b=Math.atan2(v,y*_);m=Math.sin(m*b)/v,a=Math.sin(a*b)/v}var x=a*_;if(s=s*m+p*x,l=l*m+d*x,c=c*m+h*x,u=u*m+f*x,m===1-a){var w=1/Math.sqrt(s*s+l*l+c*c+u*u);s*=w,l*=w,c*=w,u*=w}}t[e]=s,t[e+1]=l,t[e+2]=c,t[e+3]=u}}),Object.defineProperties(Jt.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(Jt.prototype,{isQuaternion:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,o=t.order,a=Math.cos,s=Math.sin,l=a(n/2),c=a(r/2),u=a(i/2),p=s(n/2),d=s(r/2),h=s(i/2);return"XYZ"===o?(this._x=p*c*u+l*d*h,this._y=l*d*u-p*c*h,this._z=l*c*h+p*d*u,this._w=l*c*u-p*d*h):"YXZ"===o?(this._x=p*c*u+l*d*h,this._y=l*d*u-p*c*h,this._z=l*c*h-p*d*u,this._w=l*c*u+p*d*h):"ZXY"===o?(this._x=p*c*u-l*d*h,this._y=l*d*u+p*c*h,this._z=l*c*h+p*d*u,this._w=l*c*u-p*d*h):"ZYX"===o?(this._x=p*c*u-l*d*h,this._y=l*d*u+p*c*h,this._z=l*c*h-p*d*u,this._w=l*c*u+p*d*h):"YZX"===o?(this._x=p*c*u+l*d*h,this._y=l*d*u+p*c*h,this._z=l*c*h-p*d*u,this._w=l*c*u-p*d*h):"XZY"===o&&(this._x=p*c*u-l*d*h,this._y=l*d*u-p*c*h,this._z=l*c*h+p*d*u,this._w=l*c*u+p*d*h),!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],o=n[8],a=n[1],s=n[5],l=n[9],c=n[2],u=n[6],p=n[10],d=r+s+p;return d>0?(e=.5/Math.sqrt(d+1),this._w=.25/e,this._x=(u-l)*e,this._y=(o-c)*e,this._z=(a-i)*e):r>s&&r>p?(e=2*Math.sqrt(1+r-s-p),this._w=(u-l)/e,this._x=.25*e,this._y=(i+a)/e,this._z=(o+c)/e):s>p?(e=2*Math.sqrt(1+s-r-p),this._w=(o-c)/e,this._x=(i+a)/e,this._y=.25*e,this._z=(l+u)/e):(e=2*Math.sqrt(1+p-r-s),this._w=(a-i)/e,this._x=(o+c)/e,this._y=(l+u)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(Zt.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);if(0===n)return this;var r=Math.min(1,e/n);return this.slerp(t,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,o=t._w,a=e._x,s=e._y,l=e._z,c=e._w;return this._x=n*c+o*a+r*l-i*s,this._y=r*c+o*s+i*a-n*l,this._z=i*c+o*l+n*s-r*a,this._w=o*c-n*a-r*s-i*l,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*t._w+n*t._x+r*t._y+i*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=1-a*a;if(s<=Number.EPSILON){var l=1-e;return this._w=l*o+e*this._w,this._x=l*n+e*this._x,this._y=l*r+e*this._y,this._z=l*i+e*this._z,this.normalize(),this._onChangeCallback(),this}var c=Math.sqrt(s),u=Math.atan2(c,a),p=Math.sin((1-e)*u)/c,d=Math.sin(e*u)/c;return this._w=o*p+this._w*d,this._x=n*p+this._x*d,this._y=r*p+this._y*d,this._z=i*p+this._z*d,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(Kt.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:(Ht=new Jt,function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Ht.setFromEuler(t))}),applyAxisAngle:function(){var t=new Jt;return function(e,n){return this.applyQuaternion(t.setFromAxisAngle(e,n))}}(),applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z,s=t.w,l=s*e+o*r-a*n,c=s*n+a*e-i*r,u=s*r+i*n-o*e,p=-i*e-o*n-a*r;return this.x=l*s+p*-i+c*-a-u*-o,this.y=c*s+p*-o+u*-i-l*-a,this.z=u*s+p*-a+l*-o-c*-i,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:(Dt=new Kt,function(t){return Dt.copy(this).projectOnVector(t),this.sub(Dt)}),reflect:function(){var t=new Kt;return function(e){return this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(Zt.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}}),Object.assign($t.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,o,a,s,l,c,u,p,d,h,f,m){var y=this.elements;return y[0]=t,y[4]=e,y[8]=n,y[12]=r,y[1]=i,y[5]=o,y[9]=a,y[13]=s,y[2]=l,y[6]=c,y[10]=u,y[14]=p,y[3]=d,y[7]=h,y[11]=f,y[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new $t).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(){var t=new Kt;return function(e){var n=this.elements,r=e.elements,i=1/t.setFromMatrixColumn(e,0).length(),o=1/t.setFromMatrixColumn(e,1).length(),a=1/t.setFromMatrixColumn(e,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=0,n[4]=r[4]*o,n[5]=r[5]*o,n[6]=r[6]*o,n[7]=0,n[8]=r[8]*a,n[9]=r[9]*a,n[10]=r[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}}(),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),l=Math.sin(r),c=Math.cos(i),u=Math.sin(i);if("XYZ"===t.order){var p=o*c,d=o*u,h=a*c,f=a*u;e[0]=s*c,e[4]=-s*u,e[8]=l,e[1]=d+h*l,e[5]=p-f*l,e[9]=-a*s,e[2]=f-p*l,e[6]=h+d*l,e[10]=o*s}else if("YXZ"===t.order){var m=s*c,y=s*u,_=l*c,g=l*u;e[0]=m+g*a,e[4]=_*a-y,e[8]=o*l,e[1]=o*u,e[5]=o*c,e[9]=-a,e[2]=y*a-_,e[6]=g+m*a,e[10]=o*s}else if("ZXY"===t.order)m=s*c,y=s*u,_=l*c,g=l*u,e[0]=m-g*a,e[4]=-o*u,e[8]=_+y*a,e[1]=y+_*a,e[5]=o*c,e[9]=g-m*a,e[2]=-o*l,e[6]=a,e[10]=o*s;else if("ZYX"===t.order)p=o*c,d=o*u,h=a*c,f=a*u,e[0]=s*c,e[4]=h*l-d,e[8]=p*l+f,e[1]=s*u,e[5]=f*l+p,e[9]=d*l-h,e[2]=-l,e[6]=a*s,e[10]=o*s;else if("YZX"===t.order){var v=o*s,b=o*l,x=a*s,w=a*l;e[0]=s*c,e[4]=w-v*u,e[8]=x*u+b,e[1]=u,e[5]=o*c,e[9]=-a*c,e[2]=-l*c,e[6]=b*u+x,e[10]=v-w*u}else"XZY"===t.order&&(v=o*s,b=o*l,x=a*s,w=a*l,e[0]=s*c,e[4]=-u,e[8]=l*c,e[1]=v*u+w,e[5]=o*c,e[9]=b*u-x,e[2]=x*u-b,e[6]=a*c,e[10]=w*u+v);return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:(Wt=new Kt(0,0,0),qt=new Kt(1,1,1),function(t){return this.compose(Wt,t,qt)}),lookAt:(Ut=new Kt,Vt=new Kt,Gt=new Kt,function(t,e,n){var r=this.elements;return Gt.subVectors(t,e),0===Gt.lengthSq()&&(Gt.z=1),Gt.normalize(),Ut.crossVectors(n,Gt),0===Ut.lengthSq()&&(1===Math.abs(n.z)?Gt.x+=1e-4:Gt.z+=1e-4,Gt.normalize(),Ut.crossVectors(n,Gt)),Ut.normalize(),Vt.crossVectors(Gt,Ut),r[0]=Ut.x,r[4]=Vt.x,r[8]=Gt.x,r[1]=Ut.y,r[5]=Vt.y,r[9]=Gt.y,r[2]=Ut.z,r[6]=Vt.z,r[10]=Gt.z,this}),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[4],s=n[8],l=n[12],c=n[1],u=n[5],p=n[9],d=n[13],h=n[2],f=n[6],m=n[10],y=n[14],_=n[3],g=n[7],v=n[11],b=n[15],x=r[0],w=r[4],E=r[8],T=r[12],S=r[1],M=r[5],j=r[9],C=r[13],z=r[2],R=r[6],A=r[10],L=r[14],I=r[3],P=r[7],O=r[11],k=r[15];return i[0]=o*x+a*S+s*z+l*I,i[4]=o*w+a*M+s*R+l*P,i[8]=o*E+a*j+s*A+l*O,i[12]=o*T+a*C+s*L+l*k,i[1]=c*x+u*S+p*z+d*I,i[5]=c*w+u*M+p*R+d*P,i[9]=c*E+u*j+p*A+d*O,i[13]=c*T+u*C+p*L+d*k,i[2]=h*x+f*S+m*z+y*I,i[6]=h*w+f*M+m*R+y*P,i[10]=h*E+f*j+m*A+y*O,i[14]=h*T+f*C+m*L+y*k,i[3]=_*x+g*S+v*z+b*I,i[7]=_*w+g*M+v*R+b*P,i[11]=_*E+g*j+v*A+b*O,i[15]=_*T+g*C+v*L+b*k,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:function(){var t=new Kt;return function(e){for(var n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix4(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],a=t[5],s=t[9],l=t[13],c=t[2],u=t[6],p=t[10],d=t[14];return t[3]*(+i*s*u-r*l*u-i*a*p+n*l*p+r*a*d-n*s*d)+t[7]*(+e*s*d-e*l*p+i*o*p-r*o*d+r*l*c-i*s*c)+t[11]*(+e*l*u-e*a*d-i*o*u+n*o*d+i*a*c-n*l*c)+t[15]*(-r*a*c-e*s*u+e*a*p+r*o*u-n*o*p+n*s*c)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t,e,n){var r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this},getInverse:function(t,e){var n=this.elements,r=t.elements,i=r[0],o=r[1],a=r[2],s=r[3],l=r[4],c=r[5],u=r[6],p=r[7],d=r[8],h=r[9],f=r[10],m=r[11],y=r[12],_=r[13],g=r[14],v=r[15],b=h*g*p-_*f*p+_*u*m-c*g*m-h*u*v+c*f*v,x=y*f*p-d*g*p-y*u*m+l*g*m+d*u*v-l*f*v,w=d*_*p-y*h*p+y*c*m-l*_*m-d*c*v+l*h*v,E=y*h*u-d*_*u-y*c*f+l*_*f+d*c*g-l*h*g,T=i*b+o*x+a*w+s*E;if(0===T){var S="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(S);return console.warn(S),this.identity()}var M=1/T;return n[0]=b*M,n[1]=(_*f*s-h*g*s-_*a*m+o*g*m+h*a*v-o*f*v)*M,n[2]=(c*g*s-_*u*s+_*a*p-o*g*p-c*a*v+o*u*v)*M,n[3]=(h*u*s-c*f*s-h*a*p+o*f*p+c*a*m-o*u*m)*M,n[4]=x*M,n[5]=(d*g*s-y*f*s+y*a*m-i*g*m-d*a*v+i*f*v)*M,n[6]=(y*u*s-l*g*s-y*a*p+i*g*p+l*a*v-i*u*v)*M,n[7]=(l*f*s-d*u*s+d*a*p-i*f*p-l*a*m+i*u*m)*M,n[8]=w*M,n[9]=(y*h*s-d*_*s-y*o*m+i*_*m+d*o*v-i*h*v)*M,n[10]=(l*_*s-y*c*s+y*o*p-i*_*p-l*o*v+i*c*v)*M,n[11]=(d*c*s-l*h*s-d*o*p+i*h*p+l*o*m-i*c*m)*M,n[12]=E*M,n[13]=(d*_*a-y*h*a+y*o*f-i*_*f-d*o*g+i*h*g)*M,n[14]=(y*c*a-l*_*a-y*o*u+i*_*u+l*o*g-i*c*g)*M,n[15]=(l*h*a-d*c*a+d*o*u-i*h*u-l*o*f+i*c*f)*M,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,a=t.y,s=t.z,l=i*o,c=i*a;return this.set(l*o+n,l*a-r*s,l*s+r*a,0,l*a+r*s,c*a+n,c*s-r*o,0,l*s-r*a,c*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var r=this.elements,i=e._x,o=e._y,a=e._z,s=e._w,l=i+i,c=o+o,u=a+a,p=i*l,d=i*c,h=i*u,f=o*c,m=o*u,y=a*u,_=s*l,g=s*c,v=s*u,b=n.x,x=n.y,w=n.z;return r[0]=(1-(f+y))*b,r[1]=(d+v)*b,r[2]=(h-g)*b,r[3]=0,r[4]=(d-v)*x,r[5]=(1-(p+y))*x,r[6]=(m+_)*x,r[7]=0,r[8]=(h+g)*w,r[9]=(m-_)*w,r[10]=(1-(p+f))*w,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this},decompose:(Ft=new Kt,Nt=new $t,function(t,e,n){var r=this.elements,i=Ft.set(r[0],r[1],r[2]).length(),o=Ft.set(r[4],r[5],r[6]).length(),a=Ft.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],Nt.copy(this);var s=1/i,l=1/o,c=1/a;return Nt.elements[0]*=s,Nt.elements[1]*=s,Nt.elements[2]*=s,Nt.elements[4]*=l,Nt.elements[5]*=l,Nt.elements[6]*=l,Nt.elements[8]*=c,Nt.elements[9]*=c,Nt.elements[10]*=c,e.setFromRotationMatrix(Nt),n.x=i,n.y=o,n.z=a,this}),makePerspective:function(t,e,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(e-t),l=2*i/(n-r),c=(e+t)/(e-t),u=(n+r)/(n-r),p=-(o+i)/(o-i),d=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=p,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,n,r,i,o){var a=this.elements,s=1/(e-t),l=1/(n-r),c=1/(o-i),u=(e+t)*s,p=(n+r)*l,d=(o+i)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-p,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}),te.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],te.DefaultOrder="XYZ",Object.defineProperties(te.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(te.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=Zt.clamp,i=t.elements,o=i[0],a=i[4],s=i[8],l=i[1],c=i[5],u=i[9],p=i[2],d=i[6],h=i[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-u,h),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(d,c),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(s,h),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-p,o),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-p,h),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,o))):"ZYX"===e?(this._y=Math.asin(-r(p,-1,1)),Math.abs(p)<.99999?(this._x=Math.atan2(d,h),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,c))):"YZX"===e?(this._z=Math.asin(r(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-p,o)):(this._x=0,this._y=Math.atan2(s,h))):"XZY"===e?(this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(d,c),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-u,h),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(){var t=new $t;return function(e,n,r){return t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,n,r)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:(Xt=new Jt,function(t){return Xt.setFromEuler(this),this.setFromQuaternion(Xt,t)}),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new Kt(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var ee={toScreenPos:function(){var t=new Kt;return function(e,n,r){return t.copy(e),t.project(n),t.x=Math.round((t.x+1)*r.width/2),t.y=Math.round((1-t.y)*r.height/2),t.z=0,t}}(),toSpacePos:function(){var t,e=new Kt,n=new Kt;return function(r,i,o){return e.set(r.x/o.width*2-1,-r.y/o.height*2+1,.5),e.unproject(i),n.copy(e.sub(i.position).normalize()),t=-i.position.z/n.z,e.copy(i.position),e.add(n.multiplyScalar(t)),e}}()},ne={initValue:function(t,e){return null!=t&&null!=t?t:e},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},destroyArray:function(t){t.length=0},destroyObject:function(t){for(var e in t)delete t[e]},isUndefined:function(){for(var t in arguments)if(void 0!==arguments[t])return!1;return!0},setVectorByObj:function(t,e){void 0!==e.x&&(t.position.x=e.x),void 0!==e.y&&(t.position.y=e.y),void 0!==e.z&&(t.position.z=e.z),void 0!==e.vx&&(t.velocity.x=e.vx),void 0!==e.vy&&(t.velocity.y=e.vy),void 0!==e.vz&&(t.velocity.z=e.vz),void 0!==e.ax&&(t.acceleration.x=e.ax),void 0!==e.ay&&(t.acceleration.y=e.ay),void 0!==e.az&&(t.acceleration.z=e.az),void 0!==e.p&&t.position.copy(e.p),void 0!==e.v&&t.velocity.copy(e.v),void 0!==e.a&&t.acceleration.copy(e.a),void 0!==e.position&&t.position.copy(e.position),void 0!==e.velocity&&t.velocity.copy(e.velocity),void 0!==e.accelerate&&t.acceleration.copy(e.accelerate)},setPrototypeByObj:function(t,e,n){for(var r in e)t.hasOwnProperty(r)&&(n?n.indexOf(r)<0&&(t[r]=this._getValue(e[r])):t[r]=this._getValue(e[r]));return t},_getValue:function(t){return"Span"===t.constructor.type?t.getValue():t}},re=n(11),ie=n.n(re).a;const oe=(t,e)=>({...t,...e});var ae={randomAToB:function(t,e,n){return n?(Math.random()*(e-t)>>0)+t:t+Math.random()*(e-t)},randomFloating:function(t,e,n){return this.randomAToB(t-e,t+e,n)},randomZone:function(t){},degreeTransform:function(t){return t*G/180},toColor16:function(t){return"#"+t.toString(16)},randomColor:function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)},lerp:function(t,e,n){return e+(t-e)*n},getNormal:function(t,e){return 0==t.x&&0==t.y?0==t.z?e.set(1,0,1):e.set(1,1,-t.y/t.z):0==t.x?e.set(1,0,1):e.set(-t.y/t.x,1,1),e.normalize()},axisRotate:function(t,e,n,r){var i=Math.cos(r),o=Math.sin(r),a=n.dot(e)*(1-i);t.copy(n),t.cross(e).scalar(o),t.addValue(e.x*i,e.y*i,e.z*i),t.addValue(n.x*a,n.y*a,n.z*a)}};const se="ArraySpan",le="ColorSpan",ce="Box",ue="Polar3D",pe="Span";class de{constructor(t,e,n){this._isArray=!1,this.type=pe,ne.isArray(t)?(this._isArray=!0,this.a=t):(this.a=ne.initValue(t,1),this.b=ne.initValue(e,this.a),this._center=ne.initValue(n,!1))}getValue(t){return this._isArray?this.a[this.a.length*Math.random()>>0]:this._center?ae.randomFloating(this.a,this.b,t):ae.randomAToB(this.a,this.b,t)}}const he=(t,e,n)=>t instanceof de?t:void 0===e?new de(t):void 0===n?new de(t,e):new de(t,e,n);var fe=n(3),me=n.n(fe);class ye extends de{constructor(t){super(),this.type=se,this.items=Array.isArray(t)?t:[t]}getValue(){return me()(this.items)}}const _e=t=>t?t instanceof ye?t:new ye(t):null;class ge extends de{constructor(t){super(),this.type=le,this.shouldRandomize="random"===t,this.colors=Array.isArray(t)?t:[t]}getValue(){return this.shouldRandomize?ae.randomColor():me()(this.colors)}}const ve=t=>t?t instanceof ge?t:new ge(t):null;class be{constructor(t,e,n,r,i,o){this.type=ce,this.x=t,this.y=e,this.z=n,this.width=r,this.height=i,this.depth=o,this.bottom=this.y+this.height,this.right=this.x+this.width,this.right=this.x+this.width}contains(t,e,n){return t<=this.right&&t>=this.x&&e<=this.bottom&&e>=this.y&&n<=this.depth&&n>=this.z}}const xe="EULER",we=(t,e,n)=>{t.sleep||(t.old.position.copy(t.position),t.old.velocity.copy(t.velocity),t.acceleration.scalar(1/t.mass),t.velocity.add(t.acceleration.scalar(e)),t.position.add(t.old.velocity.scalar(e)),n&&t.velocity.scalar(n),t.acceleration.clear())},Ee=(t,e,n,r=xe)=>{switch(r){case xe:we(t,e,n);break;default:we(t,e,n)}};class Te extends Kt{clear(){return this.x=0,this.y=0,this.z=0,this}scalar(t){return this.x*=t,this.y*=t,this.z*=t,this}addValue(t,e,n){return this.x+=t,this.y+=e,this.z+=n,this}toString(){return"x:"+this.x+"y:"+this.y+"z:"+this.z}eulerFromDir(t){return(new te).setFromVector3(t)}}class Se{constructor(t,e,n){this.type=ue,this.radius=t||1,this.phi=n||0,this.theta=e||0}set(t,e,n){return this.radius=t||1,this.phi=n||0,this.theta=e||0,this}setRadius(t){return this.radius=t,this}setPhi(t){return this.phi=t,this}setTheta(t){return this.theta=t,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}toVector3D(){return new Te(this.getX(),this.getY(),this.getZ())}getX(){return this.radius*Math.sin(this.theta)*Math.cos(this.phi)}getY(){return-this.radius*Math.sin(this.theta)*Math.sin(this.phi)}getZ(){return this.radius*Math.cos(this.theta)}normalize(){return this.radius=1,this}equals(t){return t.radius===this.radius&&t.phi===this.phi&&t.theta===this.theta}clear(){return this.radius=0,this.phi=0,this.theta=0,this}clone(){return new Se(this.radius,this.phi,this.theta)}}const Me="Particle",je="Pool",Ce="System";class ze{constructor(t){this.id=`particle-${ie()}`,this.type=Me,this.life=bt,this.age=xt,this.energy=wt,this.dead=Et,this.sleep=Tt,this.body=St,this.parent=Mt,this.mass=jt,this.radius=Ct,this.alpha=zt,this.scale=Rt,this.useColor=At,this.useAlpha=Lt,this.easing=It,this.position=new Te,this.velocity=new Te,this.acceleration=new Te,this.old={},this.old.position=this.position.clone(),this.old.velocity=this.velocity.clone(),this.old.acceleration=this.acceleration.clone(),this.behaviours=[],this.transform={},this.color={r:0,g:0,b:0},this.rotation=new Te,ne.setPrototypeByObj(this,t)}getDirection(){return Math.atan2(this.velocity.x,-this.velocity.y)*(180/G)}reset(){return this.life=bt,this.age=xt,this.energy=wt,this.dead=Et,this.sleep=Tt,this.body=St,this.parent=Mt,this.mass=jt,this.radius=Ct,this.alpha=zt,this.scale=Rt,this.useColor=At,this.useAlpha=Lt,this.easing=It,this.position.set(0,0,0),this.velocity.set(0,0,0),this.acceleration.set(0,0,0),this.old.position.set(0,0,0),this.old.velocity.set(0,0,0),this.old.acceleration.set(0,0,0),this.color.r=0,this.color.g=0,this.color.b=0,this.rotation.clear(),ne.destroyObject(this.transform),this.removeAllBehaviours(),this}update(t,e){if(!this.sleep){this.age+=t;let n=this.behaviours.length;for(;n--;){let r=this.behaviours[n];r&&r.applyBehaviour(this,t,e)}}if(this.age>=this.life)this.destroy();else{const t=this.easing(this.age/this.life);this.energy=Math.max(1-t,0)}}addBehaviour(t){this.behaviours.push(t),t.initialize(this)}addBehaviours(t){let e=t.length;for(;e--;)this.addBehaviour(t[e])}removeBehaviour(t){const e=this.behaviours.indexOf(t);e>-1&&this.behaviours.splice(e,1)}removeAllBehaviours(){ne.destroyArray(this.behaviours)}destroy(){this.removeAllBehaviours(),this.energy=0,this.dead=!0,this.parent=null}}class Re{constructor(){this.type=je,this.cID=0,this.list={}}create(t){if(!this.canCreateNewObject(t))throw new Error("The pool is unable to create or clone the object supplied");return this.cID++,this.canInstantiateObject(t)?new t:this.canCloneObject(t)?t.clone():void 0}canInstantiateObject(t){return"function"==typeof t}canCloneObject(t){return t.clone&&"function"==typeof t.clone}canCreateNewObject(t){return!(!this.canInstantiateObject(t)&&!this.canCloneObject(t))}getCount(){var t=0;for(var e in this.list)t+=this.list[e].length;return t++}get(t){var e,n=t.__puid||Qt.id(t);return(e=this.list[n]&&this.list[n].length>0?this.list[n].pop():this.create(t)).__puid=t.__puid||n,e}expire(t){return this._getList(t.__puid).push(t)}destroy(){for(var t in this.list)this.list[t].length=0,delete this.list[t]}_getList(t){return t=t||"default",this.list[t]||(this.list[t]=[]),this.list[t]}}const Ae="SYSTEM_UPDATE",Le="PARTICLE_CREATED",Ie="PARTICLE_UPDATE",Pe="PARTICLE_DEAD",Oe="EMITTER_ADDED",ke="EMITTER_REMOVED",Be="SYSTEM_UPDATE_AFTER";var De=class{constructor(){this.listeners=null}set listeners(t){this._listeners=t}get listeners(){return this._listeners}addEventListener(t,e){return this.listeners?this.removeEventListener(t,e):this.listeners={},this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e),e}removeEventListener(t,e){if(this.listeners&&this.listeners[t])for(var n=this.listeners[t],r=0,i=n.length;r<i;r++)if(n[r]==e){1==i?delete this.listeners[t]:n.splice(r,1);break}}removeAllEventListeners(t){t?this.listeners&&delete this.listeners[t]:this.listeners=null}dispatchEvent(t,e){var n=!1,r=this.listeners;if(t&&r){var i=r[t];if(!i)return n;for(var o,a=(i=i.slice()).length;a--;)o=i[a],n=n||o(e)}return!!n}hasEventListener(t){var e=this.listeners;return!(!e||!e[t])}};class He{constructor(t=v,e=!0){this.type=t,this.isEnabled=e}init(t,e){this.isEnabled&&(e?(this.initialize(e),e.hasBeenInitialized=!0):(this.initialize(t),t.hasBeenInitialized=!0))}reset(){}initialize(t){}static requiresWebGlApi(){return!1}static fromJSON(t){}}class Fe extends He{constructor(t,e,n,r=!0){super(b,r),this.body=_e(t),this.w=e,this.h=n||e}initialize(t){var e=this.body.getValue();this.w?t.body={width:this.w,height:this.h,body:e}:t.body=e}static fromJSON(t){const{body:e,width:n,height:r,isEnabled:i=!0}=t;return new Fe(e,n,r,i)}}const Ne={AdditiveBlending:2,CustomBlending:5,MultiplyBlending:4,NoBlending:0,NormalBlending:1,SubtractiveBlending:3},Ue={color:16711680,blending:2,fog:!0},Ve={...Ue,blending:"AdditiveBlending"},Ge=1,We=1;class qe extends He{constructor(t,e,n=Ue,r=!0){super(x,r);const{Sprite:i,SpriteMaterial:o,TextureLoader:a}=t;this.materialProperties=oe(Ue,n),(new a).load(e,t=>{this.texture=t,this.material=new o({map:t,...this.materialProperties}),this.sprite=new i(this.material)},void 0,t=>{throw new Error(t)})}initialize(t){t.body=this.sprite}static fromJSON(t,e){const{texture:n,materialProperties:r=Ve,isEnabled:i=!0}=t;return new qe(e,n,oe(Ve,(t=>{const{blending:e}=t;return{...t,blending:e?Ne[e]:Ne[Ve.blending]}})(r)),i)}}const Xe=new te;var Ye,Qe,Ze,Je,Ke,$e,tn,en,nn={particleEuler:null,initialize:function(t,e,n){let r=n.length;for(;r--;)n[r].init(t,e);t.bindEmitter&&this.bindEmitter(t,e)},bindEmitter:function(t,e){const{rotation:{x:n,y:r,z:i}}=t;e.position.add(t.position),e.velocity.add(t.velocity),e.acceleration.add(t.acceleration),e.velocity.applyEuler(Xe.set(n,r,i))}};class rn extends He{constructor(t,e,n,r=!0){super(E,r),this.lifePan=he(t,e,n)}initialize(t){this.lifePan.a==1/0||"infi"==this.lifePan.a?t.life=1/0:t.life=this.lifePan.getValue()}static fromJSON(t){const{min:e,max:n,center:r=!1,isEnabled:i=!0}=t;return new rn(e,n,r,i)}}class on extends He{constructor(t,e,n=!1,r=!0){super(T,r),this.massPan=he(t,e,n)}initialize(t){t.mass=this.massPan.getValue()}static fromJSON(t){const{min:e,max:n,center:r=!1,isEnabled:i=!0}=t;return new on(e,n,r,i)}}class an{constructor(t=L){this.type=t,this.vector=new Te(0,0,0),this.random=0,this.crossType="dead",this.log=!0,this.supportsCrossing=!0}getPosition(){return null}crossing(t){if(!this.supportsCrossing)return console.warn(`${this.constructor.name} does not support the crossing method`);switch(this.crossType){case"bound":this._bound(t);break;case"cross":this._cross(t);break;case"dead":this._dead(t)}}isBoxZone(){return!1}isLineZone(){return!1}isMeshZone(){return!1}isPointZone(){return!1}isScreenZone(){return!1}isSphereZone(){return!1}_dead(t){}_bound(t){}_cross(t){}}class sn extends an{constructor(t,e,n,r,i,o){var a,s,l,c,u;super(I),ne.isUndefined(e,n,r,i,o)?(a=s=l=0,c=u=r=t||100):ne.isUndefined(r,i,o)?(a=s=l=0,c=t,u=e,r=n):(a=t,s=e,l=n,c=r,u=i,r=o),this.x=a,this.y=s,this.z=l,this.width=c,this.height=u,this.depth=r,this.friction=.85,this.max=6}isBoxZone(){return!0}getPosition(){return this.vector.x=this.x+ae.randomAToB(-.5,.5)*this.width,this.vector.y=this.y+ae.randomAToB(-.5,.5)*this.height,this.vector.z=this.z+ae.randomAToB(-.5,.5)*this.depth,this.vector}_dead(t){t.position.x+t.radius<this.x-this.width/2?t.dead=!0:t.position.x-t.radius>this.x+this.width/2&&(t.dead=!0),t.position.y+t.radius<this.y-this.height/2?t.dead=!0:t.position.y-t.radius>this.y+this.height/2&&(t.dead=!0),t.position.z+t.radius<this.z-this.depth/2?t.dead=!0:t.position.z-t.radius>this.z+this.depth/2&&(t.dead=!0)}_bound(t){t.position.x-t.radius<this.x-this.width/2?(t.position.x=this.x-this.width/2+t.radius,t.velocity.x*=-this.friction,this._static(t,"x")):t.position.x+t.radius>this.x+this.width/2&&(t.position.x=this.x+this.width/2-t.radius,t.velocity.x*=-this.friction,this._static(t,"x")),t.position.y-t.radius<this.y-this.height/2?(t.position.y=this.y-this.height/2+t.radius,t.velocity.y*=-this.friction,this._static(t,"y")):t.position.y+t.radius>this.y+this.height/2&&(t.position.y=this.y+this.height/2-t.radius,t.velocity.y*=-this.friction,this._static(t,"y")),t.position.z-t.radius<this.z-this.depth/2?(t.position.z=this.z-this.depth/2+t.radius,t.velocity.z*=-this.friction,this._static(t,"z")):t.position.z+t.radius>this.z+this.depth/2&&(t.position.z=this.z+this.depth/2-t.radius,t.velocity.z*=-this.friction,this._static(t,"z"))}_static(t,e){t.velocity[e]*t.acceleration[e]>0||Math.abs(t.velocity[e])<.0167*Math.abs(t.acceleration[e])*this.max&&(t.velocity[e]=0,t.acceleration[e]=0)}_cross(t){t.position.x+t.radius<this.x-this.width/2&&t.velocity.x<=0?t.position.x=this.x+this.width/2+t.radius:t.position.x-t.radius>this.x+this.width/2&&t.velocity.x>=0&&(t.position.x=this.x-this.width/2-t.radius),t.position.y+t.radius<this.y-this.height/2&&t.velocity.y<=0?t.position.y=this.y+this.height/2+t.radius:t.position.y-t.radius>this.y+this.height/2&&t.velocity.y>=0&&(t.position.y=this.y-this.height/2-t.radius),t.position.z+t.radius<this.z-this.depth/2&&t.velocity.z<=0?t.position.z=this.z+this.depth/2+t.radius:t.position.z-t.radius>this.z+this.depth/2&&t.velocity.z>=0&&(t.position.z=this.z-this.depth/2-t.radius)}}class ln extends an{constructor(t,e,n,r,i,o){super(P),t instanceof Te?(this.x1=t.x,this.y1=t.y,this.z1=t.z,this.x2=r.x,this.y2=r.y,this.z2=r.z):(this.x1=t,this.y1=e,this.z1=n,this.x2=r,this.y2=i,this.z2=o),this.supportsCrossing=!1}isLineZone(){return!0}getPosition(){return this.random=Math.random(),this.vector.x=this.x1+this.random*(this.x2-this.x1),this.vector.y=this.y1+this.random*(this.y2-this.y1),this.vector.z=this.z1+this.random*(this.z2-this.z1),this.vector}}class cn extends an{constructor(t,e=1){if(super(O),this.geometry=null,this.scale=e,this.supportsCrossing=!1,t.type&&"Geometry"===t.type&&(this.geometry=t),t.geometry&&(this.geometry=t.geometry),!this.geometry)throw new Error("MeshZone unable to set geometry from the supplied bounds")}isMeshZone(){return!0}getPosition(){var t=this.geometry.vertices,e=t[t.length*Math.random()>>0];return this.vector.x=e.x*this.scale,this.vector.y=e.y*this.scale,this.vector.z=e.z*this.scale,this.vector}}class un extends an{constructor(t,e,n){var r;super(k),r=ne.isUndefined(t,e,n)?0:t,this.x=r,this.y=r,this.z=r,this.supportsCrossing=!1}isPointZone(){return!0}getPosition(){return this.vector.x=this.x,this.vector.y=this.y,this.vector.z=this.z,this.vector}}class pn extends an{constructor(t,e,n,r){super(B),this.camera=t,this.renderer=e,this.dis=n||20,r=r||"1234";for(var i=1;i<5;i++)this["d"+i]=r.indexOf(i+"")>=0}isScreenZone(){return!0}_dead(t){var e=ee.toScreenPos(t.position,this.camera,this.renderer.domElement),n=this.renderer.domElement;e.y+t.radius<-this.dis&&this.d1?t.dead=!0:e.y-t.radius>n.height+this.dis&&this.d3&&(t.dead=!0),e.x+t.radius<-this.dis&&this.d4?t.dead=!0:e.x-t.radius>n.width+this.dis&&this.d2&&(t.dead=!0)}_bound(t){var e=ee.toScreenPos(t.position,this.camera,this.renderer.domElement),n=this.renderer.domElement;e.y+t.radius<-this.dis?t.velocity.y*=-1:e.y-t.radius>n.height+this.dis&&(t.velocity.y*=-1),e.x+t.radius<-this.dis?t.velocity.y*=-1:e.x-t.radius>n.width+this.dis&&(t.velocity.y*=-1)}}pn.prototype.getPosition=(Qe=new Te,function(){return Ye=this.renderer.domElement,Qe.x=Math.random()*Ye.width,Qe.y=Math.random()*Ye.height,this.vector.copy(ee.toSpacePos(Qe,this.camera,Ye)),this.vector}),pn.prototype._cross=function(){var t=new Te;return function(e){var n=ee.toScreenPos(e.position,this.camera,this.renderer.domElement),r=this.renderer.domElement;n.y+e.radius<-this.dis?(t.x=n.x,t.y=r.height+this.dis+e.radius,e.position.y=ee.toSpacePos(t,this.camera,r).y):n.y-e.radius>r.height+this.dis&&(t.x=n.x,t.y=-this.dis-e.radius,e.position.y=ee.toSpacePos(t,this.camera,r).y),n.x+e.radius<-this.dis?(t.y=n.y,t.x=r.width+this.dis+e.radius,e.position.x=ee.toSpacePos(t,this.camera,r).x):n.x-e.radius>r.width+this.dis&&(t.y=n.y,t.x=-this.dis-e.radius,e.position.x=ee.toSpacePos(t,this.camera,r).x)}}();class dn extends an{constructor(t,e,n,r){let i,o,a,s;super(D),ne.isUndefined(e,n,r)?(i=o=a=0,s=t||100):(i=t,o=e,a=n,s=r),this.x=i,this.y=i,this.z=i,this.radius=s,this.the=this.phi=0}isSphereZone(){return!0}_dead(t){t.position.distanceTo(this)-t.radius>this.radius&&(t.dead=!0)}_cross(){console.warn(`${this.constructor.name} does not support the _cross method`)}}dn.prototype.getPosition=function(){return this.random=Math.random(),Ke=this.random*this.radius,Ze=G*Math.random(),Je=2*G*Math.random(),this.vector.x=this.x+Ke*Math.sin(Ze)*Math.cos(Je),this.vector.y=this.y+Ke*Math.sin(Je)*Math.sin(Ze),this.vector.z=this.z+Ke*Math.cos(Ze),this.vector},dn.prototype._bound=(tn=new Te,en=new Te,function(t){t.position.distanceTo(this)+t.radius>=this.radius&&(tn.copy(t.position).sub(this).normalize(),en.copy(t.velocity),$e=2*en.dot(tn),t.velocity.sub(tn.scalar($e)))});class hn extends He{constructor(){super(S),this.reset.apply(this,arguments)}reset(){this.zones?this.zones.length=0:this.zones=[],this.zones=this.zones.concat(Array.prototype.slice.call(arguments))}addZone(){this.zones=this.zones.concat(Array.prototype.slice.call(arguments))}static fromJSON(t){const{zoneType:e,...n}=t;if(!Bt.includes(e))throw new Error(`The zone type ${e} is invalid or not yet supported`);return new hn(new r[e](...Object.values(n)))}}hn.prototype.initialize=function(){let t;return function(e){(t=this.zones[Math.random()*this.zones.length>>0]).getPosition(),e.position.x=t.vector.x,e.position.y=t.vector.y,e.position.z=t.vector.z}}();class fn extends He{constructor(t,e,n=!1,r=!0){super(M,r),this.radius=he(t,e,n)}reset(t,e,n=!1){this.radius=he(t,e,n)}initialize(t){t.radius=this.radius.getValue(),t.transform.oldRadius=t.radius}static fromJSON(t){const{width:e,height:n,center:r=!1,isEnabled:i=!0}=t;return new fn(e,n,r,i)}}class mn extends He{constructor(t=Ge,e=We){super(R),this.numPan=he(t),this.timePan=he(e),this.startTime=0,this.nextTime=0,this.init()}init(){this.startTime=0,this.nextTime=this.timePan.getValue()}getValue(t){return this.startTime+=t,this.startTime>=this.nextTime?(this.init(),1==this.numPan.b?this.numPan.getValue("Float")>.5?1:0:this.numPan.getValue("Int")):0}static fromJSON(t){const{particlesMin:e,particlesMax:n,perSecondMin:r,perSecondMax:i}=t;return new mn(new de(e,n),new de(r,i))}}class yn extends He{constructor(t,e,n=Ue,r=!0){super(w,r);const{Sprite:i,SpriteMaterial:o}=t;this.materialProperties=oe(Ue,n),this.texture=e,this.material=new o({map:e,...this.materialProperties}),this.sprite=new i(this.material)}initialize(t){t.body=this.sprite}static fromJSON(t,e){const{loadedTexture:n,materialProperties:r=Ve,isEnabled:i=!0}=t;return new yn(e,n,oe(Ve,(t=>{const{blending:e}=t;return{...t,blending:e?Ne[e]:Ne[Ve.blending]}})(r)),i)}}class _n extends He{constructor(t,e=!0){super(t,e),this.dirVec=new Te(0,0,0)}normalize(t){return t*X}}_n.prototype.initialize=function(){var t,e=new Te(0,0,1),n=new Te(0,0,0);return function(r){return t=this.tha*Math.random(),this._useV&&this.dirVec.copy(this.dir).scalar(this.radiusPan.getValue()),ae.getNormal(this.dirVec,e),n.copy(this.dirVec).applyAxisAngle(e,t),n.applyAxisAngle(this.dirVec.normalize(),Math.random()*G*2),r.velocity.copy(n),this}}();class gn extends _n{constructor(t,e,n=!0){super(C,n),this.tha=e*q,this.dirVec=t.toVector3D(),this._useV=!1}static fromJSON(t){const{polarRadius:e,polarTheta:n,polarPhi:r,velocityTheta:i,isEnabled:o=!0}=t;return new gn(new Se(e,n,r),i,o)}}class vn extends _n{constructor(t,e,n,r=!0){super(z,r),this.radiusPan=he(t),this.dir=e.clone().normalize(),this.tha=n*q,this._useV=!0}static fromJSON(t){const{radius:e,x:n,y:r,z:i,theta:o,isEnabled:a=!0}=t;return new vn(e,new Te(n,r,i),o,a)}}class bn extends _n{constructor(t,e,n=!0){super(j,n),this.radiusPan=he(1),this.dir=t.clone(),this.tha=e*q,this._useV=!0}static fromJSON(t){const{x:e,y:n,z:r,theta:i,isEnabled:o=!0}=t;return new bn(new Te(e,n,r),i,o)}}const xn=.006,wn=!0,En=new mn(1,.1),Tn=!1;var Sn=n(0),Mn=n.n(Sn);const jn="Emitter",Cn="FollowEmitter";class zn extends ze{constructor(t){super(t),this.type=jn,this.particles=[],this.initializers=[],this.behaviours=[],this.emitterBehaviours=[],this.currentEmitTime=0,this.totalEmitTimes=-1,this.damping=xn,this.bindEmitter=wn,this.bindEmitterEvent=Tn,this.rate=En,this.id=`emitter-${ie()}`,this.cID=0,this.name="Emitter",this.eventDispatcher=new De}dispatch(t,e=this){this.eventDispatcher.dispatchEvent(t,e)}setRate(t){return this.rate=t,this}setPosition(t={}){const{position:e}=this,{x:n=e.x,y:r=e.y,z:i=e.z}=t;return this.position.set(n,r,i),this}setRotation(t={}){const{rotation:e}=this,{x:n=e.x,y:r=e.y,z:i=e.z}=t;return this.rotation.set(n,r,i),this}emit(t=1/0,e=1/0){return this.currentEmitTime=0,this.totalEmitTimes=Mn()(t)?t:1/0,this.life=1===t?t:Mn()(e)?e:1/0,this.rate.init(),this}stopEmit(){this.totalEmitTimes=-1,this.currentEmitTime=0}removeAllParticles(){let t=this.particles.length;for(;t--;)this.particles[t].dead=!0}addInitializer(t){return this.initializers.push(t),this}addInitializers(t){let e=t.length;for(;e--;)this.addInitializer(t[e]);return this}setInitializers(t){return this.initializers=t,this}removeInitializer(t){const e=this.initializers.indexOf(t);return e>-1&&this.initializers.splice(e,1),this}removeAllInitializers(){return ne.destroyArray(this.initializers),this}addBehaviour(t){return this.behaviours.push(t),this}addBehaviours(t){let e=t.length;for(;e--;)this.addBehaviour(t[e]);return this}setBehaviours(t){return this.behaviours=t,this}removeBehaviour(t){const e=this.behaviours.indexOf(t);return e>-1&&this.behaviours.splice(e,1),this}removeAllBehaviours(){return ne.destroyArray(this.behaviours),this}addEmitterBehaviour(t){return this.emitterBehaviours.push(t),t.initialize(this),this}addEmitterBehaviours(t){let e=t.length;for(;e--;)this.addEmitterBehaviour(t[e]);return this}setEmitterBehaviours(t){const e=t.length;this.emitterBehaviours=t;for(let t=0;t<e;t++)this.emitterBehaviours[t].initialize(this);return this}removeEmitterBehaviour(t){const e=this.emitterBehaviours.indexOf(t);return e>-1&&this.emitterBehaviours.splice(e,1),this}removeAllEmitterBehaviours(){return ne.destroyArray(this.emitterBehaviours),this}createParticle(){const t=this.parent.pool.get(ze);return this.setupParticle(t),this.parent&&this.parent.dispatch(Le,t),this.bindEmitterEvent&&this.dispatch(Le,t),t}setupParticle(t){const{initializers:e,behaviours:n}=this;nn.initialize(this,t,e),t.addBehaviours(n),t.parent=this,this.particles.push(t)}update(t){this.age+=t,(this.dead||this.age>=this.life)&&this.destroy(),this.generate(t),this.integrate(t);let e=this.particles.length;for(;e--;){const t=this.particles[e];t.dead&&(this.parent&&this.parent.dispatch(Pe,t),this.bindEmitterEvent&&this.dispatch(Pe,t),this.parent.pool.expire(t.reset()),this.particles.splice(e,1))}this.updateEmitterBehaviours(t)}updateEmitterBehaviours(t){if(this.sleep)return;const e=this.emitterBehaviours.length;for(let n=0;n<e;n++)this.emitterBehaviours[n].applyBehaviour(this,t,n)}integrate(t){const e=this.parent?this.parent.integrationType:xe,n=1-this.damping;Ee(this,t,n,e);let r=this.particles.length;for(;r--;){const i=this.particles[r];i.update(t,r),Ee(i,t,n,e),this.parent&&this.parent.dispatch(Ie,i),this.bindEmitterEvent&&this.dispatch(Ie,i)}}generate(t){if(1!==this.totalEmitTimes){if(this.currentEmitTime+=t,this.currentEmitTime<this.totalEmitTimes){let e=this.rate.getValue(t);for(e>0&&(this.cID=e);e--;)this.createParticle()}}else{let t=this.rate.getValue(99999);for(t>0&&(this.cID=t);t--;)this.createParticle();this.totalEmitTimes=0}}destroy(){this.dead=!0,this.energy=0,this.totalEmitTimes=-1,0==this.particles.length&&(this.removeAllInitializers(),this.removeAllBehaviours(),this.parent&&this.parent.removeEmitter(this))}}const Rn=1/0,An=1e3,Ln=100,In=Z,Pn=.03,On=.002,kn=4e-6,Bn="dead";class Dn{constructor(t=1/0,e=In,n=a,r=!0){this.type=n,this.isEnabled=r,this.id=`behaviour-${ie()}`,this.life=t,this.easing=e,this.age=0,this.energy=1,this.dead=!1}reset(t=Rn,e=In){this.life=t,this.easing=e||In}set life(t){this._life=Mn()(t)?t:Rn}get life(){return this._life}normalizeForce(t){return t.scalar(X)}normalizeValue(t){return t*X}initialize(t){}applyBehaviour(t,e,n){this.isEnabled&&this.mutate(t,e,n)}mutate(t,e,n){}energize(t,e){if(this.dead)return;if(this.age+=e,this.age>=this.life)return this.energy=0,void(this.dead=!0);const n=this.easing(t.age/t.life);this.energy=Math.max(1-n,0)}destroy(){}fromJSON(t){}}class Hn extends Dn{constructor(t=1,e=null,n,r,i=!0){super(n,r,s,i),this.alphaA=t,this.alphaB=e,this.reset(t,e)}get same(){return this._same}set same(t){this._same=t}reset(t=1,e=null,n,r){this.same=null==e,this.alphaA=he(t),this.alphaB=he(e),n&&super.reset(n,r)}initialize(t){t.useAlpha=!0,t.transform.alphaA=this.alphaA.getValue(),t.transform.alphaB=this.same?t.transform.alphaA:this.alphaB.getValue()}mutate(t,e,n){this.energize(t,e,n),t.alpha=ae.lerp(t.transform.alphaA,t.transform.alphaB,this.energy),t.alpha<On&&(t.alpha=0)}static fromJSON(t){const{alphaA:e,alphaB:n,life:r,easing:i,isEnabled:o=!0}=t;return new Hn(e,n,r,vt(i),o)}}class Fn extends Dn{constructor(t=new Te,e=Ln,n=An,r=Rn,i=In,o=!0){super(r,i,l,o),this.targetPosition=t,this.radius=n,this.force=this.normalizeValue(e),this.radiusSq=this.radius*this.radius,this.attractionForce=new Te,this.lengthSq=0}reset(t=new Te,e=Ln,n=An,r,i){this.targetPosition=t,this.radius=n,this.force=this.normalizeValue(e),this.radiusSq=this.radius*this.radius,this.attractionForce=new Te,this.lengthSq=0,r&&super.reset(r,i)}mutate(t,e,n){this.energize(t,e,n),this.attractionForce.copy(this.targetPosition),this.attractionForce.sub(t.position),this.lengthSq=this.attractionForce.lengthSq(),this.lengthSq>kn&&this.lengthSq<this.radiusSq&&(this.attractionForce.normalize(),this.attractionForce.scalar(1-this.lengthSq/this.radiusSq),this.attractionForce.scalar(this.force),t.acceleration.add(this.attractionForce))}static fromJSON(t){const{x:e,y:n,z:r,force:i,radius:o,life:a,easing:s,isEnabled:l=!0}=t;return new Fn(new Te(e,n,r),i,o,a,vt(s),l)}}class Nn extends Dn{constructor(t,e,n,r,i,o=!0){super(r,i,c,o),this.reset(t,e,n)}reset(t,e,n,r,i){this.emitter=t,this.useMass=e,this.onCollide=n,this.particles=[],this.delta=new Te,r&&super.reset(r,i)}mutate(t,e,n){const r=this.emitter?this.emitter.particles.slice(n):this.particles.slice(n);let i,o,a,s,l,c,u=r.length;for(;u--;)(i=r[u])!=t&&(this.delta.copy(i.position).sub(t.position),(o=this.delta.lengthSq())<=(s=t.radius+i.radius)*s&&(a=s-Math.sqrt(o),a+=.5,l=this._getAverageMass(t,i),c=this._getAverageMass(i,t),t.position.add(this.delta.clone().normalize().scalar(a*-l)),i.position.add(this.delta.normalize().scalar(a*c)),this.onCollide&&this.onCollide(t,i)))}_getAverageMass(t,e){return this.useMass?e.mass/(t.mass+e.mass):.5}fromJSON(t){}}class Un extends Dn{constructor(t,e,n,r,i=!0){super(n,r,u,i),this.reset(t,e)}get same(){return this._same}set same(t){this._same=t}reset(t,e,n,r){this.same=null==e,this.colorA=ve(t),this.colorB=ve(e),n&&super.reset(n,r)}initialize(t){t.transform.colorA=Yt.getRGB(this.colorA.getValue()),t.useColor=!0,t.transform.colorB=this.same?t.transform.colorA:Yt.getRGB(this.colorB.getValue())}mutate(t,e,n){this.energize(t,e,n),this._same?(t.color.r=t.transform.colorA.r,t.color.g=t.transform.colorA.g,t.color.b=t.transform.colorA.b):(t.color.r=ae.lerp(t.transform.colorA.r,t.transform.colorB.r,this.energy),t.color.g=ae.lerp(t.transform.colorA.g,t.transform.colorB.g,this.energy),t.color.b=ae.lerp(t.transform.colorA.b,t.transform.colorB.b,this.energy))}static fromJSON(t){const{colorA:e,colorB:n,life:r,easing:i,isEnabled:o=!0}=t;return new Un(e,n,r,vt(i),o)}}class Vn extends Dn{constructor(t,e,n,r,i){super(n,r,p,i),this.reset(t,e)}reset(t,e=Bn,n,r){this.zone=t,this.zone.crossType=e,n&&super.reset(n,r)}mutate(t,e,n){this.energize(t,e,n),this.zone.crossing.call(this.zone,t)}static fromJSON(t){const{zoneType:e,zoneParams:n,crossType:i,life:o,easing:a,isEnabled:s=!0}=t,l=new r[e](...Object.values(n));return new Vn(l,i,o,vt(a),s)}}class Gn extends Dn{constructor(t,e,n,r,i,o=!0){super(r,i,d,o),this.reset(t,e,n)}reset(t,e,n){this.force=this.normalizeForce(new Te(t,e,n)),this.force.id=Math.random()}mutate(t,e,n){this.energize(t,e,n),t.acceleration.add(this.force)}static fromJSON(t){const{fx:e,fy:n,fz:r,life:i,easing:o,isEnabled:a=!0}=t;return new Gn(e,n,r,i,vt(o),a)}}class Wn extends Gn{constructor(t,e,n,r=!0){super(0,-t,0,e,n,r),this.type=h}static fromJSON(t){const{gravity:e,life:n,easing:r,isEnabled:i=!0}=t;return new Wn(e,n,vt(r),i)}}class qn extends Dn{constructor(t,e,n,r=Pn,i,o,a=!0){super(i,o,f,a),this.reset(t,e,n,r),this.time=0}reset(t,e,n,r=Pn,i,o){this.randomForce=this.normalizeForce(new Te(t,e,n)),this.delayPan=he(r),this.time=0,i&&super.reset(i,o)}mutate(t,e,n){if(this.energize(t,e,n),this.time+=e,this.time>=this.delayPan.getValue()){const e=ae.randomAToB(-this.randomForce.x,this.randomForce.x),n=ae.randomAToB(-this.randomForce.y,this.randomForce.y),r=ae.randomAToB(-this.randomForce.z,this.randomForce.z);t.acceleration.addValue(e,n,r),this.time=0}}static fromJSON(t){const{x:e,y:n,z:r,delay:i,life:o,easing:a,isEnabled:s=!0}=t;return new qn(e,n,r,i,o,vt(a),s)}}class Xn extends Fn{constructor(t,e,n,r,i,o=!0){super(t,e,n,r,i,o),this.force*=-1,this.type=m}reset(t,e,n,r,i){super.reset(t,e,n,r,i),this.force*=-1}static fromJSON(t){const{x:e,y:n,z:r,force:i,radius:o,life:a,easing:s,isEnabled:l=!0}=t;return new Xn(new Te(e,n,r),i,o,a,vt(s),l)}}class Yn extends Dn{constructor(t,e,n,r,i,o=!0){super(r,i,y,o),this.reset(t,e,n)}get rotationType(){return this._rotationType}set rotationType(t){this._rotationType=t}reset(t,e,n,r,i){this.x=t||0,this.y=e||0,this.z=n||0,void 0===t||"same"==t?this.rotationType="same":null==e?this.rotationType="set":void 0===n?this.rotationType="to":(this.rotationType="add",this.x=he(this.x*q),this.y=he(this.y*q),this.z=he(this.z*q)),r&&super.reset(r,i)}initialize(t){switch(this.rotationType){case"same":break;case"set":this._setRotation(t.rotation,this.x);break;case"to":t.transform.fR=t.transform.fR||new Te,t.transform.tR=t.transform.tR||new Te,this._setRotation(t.transform.fR,this.x),this._setRotation(t.transform.tR,this.y);break;case"add":t.transform.addR=new Te(this.x.getValue(),this.y.getValue(),this.z.getValue())}}_setRotation(t,e){if(t=t||new Te,"random"==e){var n=ae.randomAToB(-G,G),r=ae.randomAToB(-G,G),i=ae.randomAToB(-G,G);t.set(n,r,i)}else e instanceof Te&&t.copy(e)}mutate(t,e,n){switch(this.energize(t,e,n),this.rotationType){case"same":t.rotation||(t.rotation=new Te),t.rotation.eulerFromDir(t.velocity);break;case"set":break;case"to":t.rotation.x=ae.lerp(t.transform.fR.x,t.transform.tR.x,this.energy),t.rotation.y=ae.lerp(t.transform.fR.y,t.transform.tR.y,this.energy),t.rotation.z=ae.lerp(t.transform.fR.z,t.transform.tR.z,this.energy);break;case"add":t.rotation.add(t.transform.addR)}}static fromJSON(t){const{x:e,y:n,z:r,life:i,easing:o,isEnabled:a=!0}=t;return new Yn(e,n,r,i,vt(o),a)}}class Qn extends Dn{constructor(t,e,n,r,i=!0){super(n,r,_,i),this.reset(t,e)}get same(){return this._same}set same(t){this._same=t}reset(t,e,n,r){this.same=null==e,this.scaleA=he(t||1),this.scaleB=he(e),n&&super.reset(n,r)}initialize(t){t.transform.scaleA=this.scaleA.getValue(),t.transform.oldRadius=t.radius,t.transform.scaleB=this.same?t.transform.scaleA:this.scaleB.getValue()}mutate(t,e,n){this.energize(t,e,n),t.scale=ae.lerp(t.transform.scaleA,t.transform.scaleB,this.energy),t.scale<5e-4&&(t.scale=0),t.radius=t.transform.oldRadius*t.scale}static fromJSON(t){const{scaleA:e,scaleB:n,life:r,easing:i,isEnabled:o=!0}=t;return new Qn(e,n,r,vt(i),o)}}class Zn extends Dn{constructor(t,e,n,r,i,o,a,s=!0){super(o,a,g,s),this.reset(t,e,n,r,i)}reset(t,e,n,r,i){this.pos?this.pos.set(t,e,n):this.pos=new Te(t,e,n),this.spring=r||.1,this.friction=i||.98}mutate(t,e,n){this.energize(t,e,n),t.velocity.x+=(this.pos.x-t.position.x)*this.spring,t.velocity.y+=(this.pos.y-t.position.y)*this.spring,t.velocity.z+=(this.pos.z-t.position.z)*this.spring}static fromJSON(t){const{x:e,y:n,z:r,spring:i,friction:o,life:a,easing:s,isEnabled:l=!0}=t;return new Zn(e,n,r,i,o,a,vt(s),l)}}const Jn=t=>{const e=[];return t.forEach(t=>{const{type:n,properties:r}=t;if(!kt.includes(n))throw new Error(`The behaviour type ${n} is invalid or not yet supported`);e.push(new o[n].fromJSON(r))}),e};var Kn=(t,e,n,r)=>{const{preParticles:o=W,integrationType:a=Y,emitters:s=[]}=t,l=new n(e,o,a);return s.forEach(t=>{const n=new r,{rate:o,rotation:a,initializers:s,behaviours:c,emitterBehaviours:u=[],position:p,totalEmitTimes:d=1/0,life:h=1/0}=t;n.setRate((t=>new mn.fromJSON(t))(o)).setRotation(a).setInitializers(((t,e)=>{const n=[];return s.forEach(t=>{const{type:r,properties:o}=t;if(!Ot.includes(r))throw new Error(`The initializer type ${r} is invalid or not yet supported`);A.includes(r)?n.push(new i[r].fromJSON(o,e)):n.push(new i[r].fromJSON(o))}),n})(0,e)).setBehaviours(Jn(c)).setEmitterBehaviours(Jn(u)).setPosition(p).emit(d,h),l.addEmitter(n)}),l};const $n=t=>new Promise((e,n)=>{if(!t.length)return e([]);const r=t.length,i=[];t.forEach(t=>{const{type:a,properties:s}=t;return kt.includes(a)?(i.push(new o[a].fromJSON(s)),i.length===r?e(i):void 0):n(`The behaviour type ${a} is invalid or not yet supported`)})}),tr=(t,e,n)=>new Promise((r,o)=>{if(!t.length)return r([]);const a=[],s=t.length;if(!s)return r(a);t.forEach(t=>{const l=new e,{rate:c,rotation:u,initializers:p,behaviours:d,emitterBehaviours:h=[],position:f,totalEmitTimes:m=1/0,life:y=1/0}=t;l.setRate((t=>new mn.fromJSON(t))(c)).setRotation(u).setPosition(f),((t,e)=>new Promise((n,r)=>{if(!t.length)return n([]);const o=t.length,a=[],s=t.filter(({properties:t})=>!t.texture),l=t.filter(({properties:t})=>t.texture);s.forEach(t=>{const{type:s,properties:l}=t;return Ot.includes(s)?(A.includes(s)?a.push(new i[s].fromJSON(l,e)):a.push(new i[s].fromJSON(l)),a.length===o?n(a):void 0):r(`The initializer type ${s} is invalid or not yet supported`)}),l.forEach(t=>{const{type:i,properties:s,properties:{texture:l}}=t,c=new e.TextureLoader;if(!Ot.includes(i))return r(`The initializer type ${i} is invalid or not yet supported`);c.load(l,t=>{if(a.push(new yn.fromJSON({...s,loadedTexture:t},e)),a.length===o)return n(a)},void 0,r)})}))(p,n).then(t=>(l.setInitializers(t),$n(d))).then(t=>(l.setBehaviours(t),$n(h))).then(t=>(l.setEmitterBehaviours(t),Promise.resolve(l))).then(t=>{if(a.push(t.emit(m,y)),a.length===s)return r(a)}).catch(o)})});var er=(t,e,n,r)=>new Promise((i,o)=>{const{preParticles:a=W,integrationType:s=Y,emitters:l=[]}=t,c=new n(a,s);tr(l,r,e).then(t=>{const e=t.length;if(!e)return i(c);t.forEach(t=>{c.addEmitter(t),c.emitters.length===e&&i(c)})}).catch(o)});class nr{constructor(t=W,e=xe){this.type=Ce,this.canUpdate=!0,this.preParticles=t,this.integrationType=e,this.emitters=[],this.renderers=[],this.pool=new Re,this.eventDispatcher=new De}static fromJSON(t,e){return Kn(t,e,nr,zn)}static fromJSONAsync(t,e){return er(t,e,nr,zn)}dispatch(t,e=this){this.eventDispatcher.dispatchEvent(t,e)}addRenderer(t){return this.renderers.push(t),t.init(this),this}removeRenderer(t){return this.renderers.splice(this.renderers.indexOf(t),1),t.remove(this),this}addEmitter(t){return t.parent=this,this.emitters.push(t),this.dispatch(Oe,t),this}removeEmitter(t){return t.parent!==this?this:(t.parent=null,this.emitters.splice(this.emitters.indexOf(t),1),this.dispatch(ke,t),this)}update(t=Pt){const e=t||Pt;if(this.canUpdate){if(this.dispatch(Ae),e>0){let t=this.emitters.length;for(;t--;)this.emitters[t].update(e)}this.dispatch(Be)}return Promise.resolve()}getCount(){const t=this.emitters.length;let e,n=0;for(e=0;e<t;e++)n+=this.emitters[e].particles.length;return n}destroy(){const t=this.emitters.length;this.canUpdate=!1;for(let e=0;e<t;e++)this.emitters[e]&&this.emitters[e].destroy(),delete this.emitters[e];this.emitters.length=0,this.pool.destroy(),this.canUpdate=!0}}const rr=15,ir=0;var or={addEventListener:function(t,e){return t.eventDispatcher.addEventListener("SYSTEM_UPDATE",e),this},drawZone:function(t,e,n,r={}){const{width:i=rr,height:o=rr,depth:a=rr,radius:s=rr,x:l=ir,y:c=ir,z:u=ir}=r;let p;r.isPointZone()&&(p=new t.SphereGeometry(15)),r.isLineZone(),r.isBoxZone()&&(p=new t.BoxGeometry(i,o,a)),r.isSphereZone()&&(p=new t.SphereGeometry(s,rr,rr)),r.isMeshZone()&&(p=r.geometry.geometry?r.geometry.geometry.clone():r.geometry.clone()),p||(p=new t.BoxGeometry(i,o,a));const d=new t.MeshBasicMaterial({color:"#2194ce",wireframe:!0}),h=new t.Mesh(p.clone(),d);n.add(h),this.addEventListener(e,function(){h.position.set(l,c,u)})},drawEmitter:function(t,e,n,r,i){const o=new t.OctahedronGeometry(rr),a=new t.MeshBasicMaterial({color:i||"#aaa",wireframe:!0}),s=new t.Mesh(o.clone(),a);n.add(s),this.addEventListener(e,function(){s.position.copy(r.position),s.rotation.set(r.rotation.x,r.rotation.y,r.rotation.z)})},renderInfo:function(){function t(t,e){var n="material"==t?"_materialPool":"_targetPool";return e.renderers[0][n].cID}return function(e,n){this.addInfo(n);var r="";switch(this._infoType){case 2:r+="emitter:"+e.emitters.length+"<br>",r+="em speed:"+e.emitters[0].cID+"<br>",r+="pos:"+function(t){var e=t.emitters[0];return Math.round(e.p.x)+","+Math.round(e.p.y)+","+Math.round(e.p.z)}(e);break;case 3:r+=e.renderers[0].name+"<br>",r+="target:"+t("target")+"<br>",r+="material:"+t("material");break;default:r+="particles:"+e.getCount()+"<br>",r+="pool:"+e.pool.getCount()+"<br>",r+="total:"+(e.getCount()+e.pool.getCount())}this._infoCon.innerHTML=r}}(),addInfo:function(t){var e=this;if(!this._infoCon){var n,r;switch(this._infoCon=document.createElement("div"),this._infoCon.style.cssText=["position:fixed;bottom:0px;left:0;cursor:pointer;","opacity:0.9;z-index:10000;padding:10px;font-size:12px;","width:120px;height:50px;background-color:#002;color:#0ff;"].join(""),this._infoType=1,this._infoCon.addEventListener("click",function(){e._infoType++,e._infoType>3&&(e._infoType=1)},!1),t){case 2:n="#201",r="#f08";break;case 3:n="#020",r="#0f0";break;default:n="#002",r="#0ff"}this._infoCon.style["background-color"]=n,this._infoCon.style.color=r}this._infoCon.parentNode||document.body.appendChild(this._infoCon)}},ar=function(){let t=0;if(window.console&&window.console.trace){var e=Array.prototype.slice.call(arguments);0==(arguments[0]+"").indexOf("+")?t<parseInt(arguments[0])&&(e.shift(),console.trace.apply(console,e),t++):(e.unshift("+15"),this.apply(console,e))}};class sr extends zn{constructor(t,e,n){super(n),this.type=Cn,this.mouseTarget=ne.initValue(t,window),this.ease=ne.initValue(e,.7),this._allowEmitting=!1,this.initEventHandler()}initEventHandler(){var t=this;this.mousemoveHandler=function(e){t.mousemove.call(t,e)},this.mousedownHandler=function(e){t.mousedown.call(t,e)},this.mouseupHandler=function(e){t.mouseup.call(t,e)},this.mouseTarget.addEventListener("mousemove",this.mousemoveHandler,!1)}emit(){this._allowEmitting=!0}stopEmit(){this._allowEmitting=!1}setCameraAndCanvas(t,e){this.camera=t,this.canvas=e}mousemove(t){t.layerX||0==t.layerX?(this.position.x+=(t.layerX-this.position.x)*this.ease,this.position.y+=(t.layerY-this.position.y)*this.ease):(t.offsetX||0==t.offsetX)&&(this.position.x+=(t.offsetX-this.position.x)*this.ease,this.position.y+=(t.offsetY-this.position.y)*this.ease),this.position.copy(ee.toSpacePos(this.position,this.camera,this.canvas)),this._allowEmitting&&super.emit("once")}destroy(){super.destroy(),this.mouseTarget.removeEventListener("mousemove",this.mousemoveHandler,!1)}}class lr{constructor(t=H){this.type=t}init(t){var e=this;this.system=t,this.system.eventDispatcher.addEventListener(Ae,function(t){e.onSystemUpdate.call(e,t)}),this.system.eventDispatcher.addEventListener(Le,function(t){e.onParticleCreated.call(e,t)}),this.system.eventDispatcher.addEventListener(Ie,function(t){e.onParticleUpdate.call(e,t)}),this.system.eventDispatcher.addEventListener(Pe,function(t){e.onParticleDead.call(e,t)})}remove(){this.system=null}onParticleCreated(t){}onParticleUpdate(t){}onParticleDead(t){}onSystemUpdate(t){}}class cr extends lr{constructor(){super(F),this.targetPool=new Re,this.materialPool=new Re}onSystemUpdate(){}onParticleCreated(t){}onParticleUpdate(t){}onParticleDead(t){}}class ur extends lr{constructor(t,e){super(U),this.container=t,this._targetPool=new Re,this._materialPool=new Re,this._body=new e.Mesh(new e.BoxGeometry(50,50,50),new e.MeshLambertMaterial({color:"#ff0000"})),this._THREE=e}onSystemUpdate(){}onParticleCreated(t){t.target||(t.body||(t.body=this._body),t.target=this._targetPool.get(t.body),(t.useAlpha||t.useColor)&&(t.target.material.__puid=Qt.id(t.body.material),t.target.material=this._materialPool.get(t.target.material))),t.target&&(t.target.position.copy(t.position),this.container.add(t.target))}onParticleUpdate(t){t.target&&(t.target.position.copy(t.position),t.target instanceof this._THREE.Sprite||t.target.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z),this.scale(t),t.useAlpha&&(t.target.material.opacity=t.alpha,t.target.material.transparent=!0),t.useColor&&t.target.material.color.copy(t.color))}scale(t){t.target.scale.set(t.scale,t.scale,t.scale)}onParticleDead(t){t.target&&((t.useAlpha||t.useColor)&&this._materialPool.expire(t.target.material),this._targetPool.expire(t.target),this.container.remove(t.target),t.target=null)}}class pr extends lr{constructor(t){super(V),this.points=t}onSystemUpdate(){}onParticleCreated(t){t.target||(t.target=new Kt),t.target.copy(t.position),this.points.geometry.vertices.push(t.target)}onParticleUpdate(t){t.target&&t.target.copy(t.position)}onParticleDead(t){if(t.target){var e=this.points.geometry.vertices.indexOf(t.target);e>-1&&this.points.geometry.vertices.splice(e,1),t.target=null}}}class dr extends ur{constructor(t,e){super(t,e),this.type=N,this._body=new e.Sprite(new e.SpriteMaterial({color:16777215}))}scale(t){t.target.scale.set(t.scale*t.radius,t.scale*t.radius,1)}}n.d(e,"Alpha",function(){return Hn}),n.d(e,"Attraction",function(){return Fn}),n.d(e,"Collision",function(){return Nn}),n.d(e,"Color",function(){return Un}),n.d(e,"CrossZone",function(){return Vn}),n.d(e,"Force",function(){return Gn}),n.d(e,"Gravity",function(){return Wn}),n.d(e,"RandomDrift",function(){return qn}),n.d(e,"Repulsion",function(){return Xn}),n.d(e,"Rotate",function(){return Yn}),n.d(e,"Scale",function(){return Qn}),n.d(e,"Spring",function(){return Zn}),n.d(e,"Debug",function(){return or}),n.d(e,"log",function(){return ar}),n.d(e,"ease",function(){return Q}),n.d(e,"easeLinear",function(){return Z}),n.d(e,"easeInQuad",function(){return J}),n.d(e,"easeOutQuad",function(){return K}),n.d(e,"easeInOutQuad",function(){return $}),n.d(e,"easeInCubic",function(){return tt}),n.d(e,"easeOutCubic",function(){return et}),n.d(e,"easeInOutCubic",function(){return nt}),n.d(e,"easeInQuart",function(){return rt}),n.d(e,"easeOutQuart",function(){return it}),n.d(e,"easeInOutQuart",function(){return ot}),n.d(e,"easeInSine",function(){return at}),n.d(e,"easeOutSine",function(){return st}),n.d(e,"easeInOutSine",function(){return lt}),n.d(e,"easeInExpo",function(){return ct}),n.d(e,"easeOutExpo",function(){return ut}),n.d(e,"easeInOutExpo",function(){return pt}),n.d(e,"easeInCirc",function(){return dt}),n.d(e,"easeOutCirc",function(){return ht}),n.d(e,"easeInOutCirc",function(){return ft}),n.d(e,"easeInBack",function(){return mt}),n.d(e,"easeOutBack",function(){return yt}),n.d(e,"easeInOutBack",function(){return _t}),n.d(e,"setEasingByName",function(){return gt}),n.d(e,"getEasingByName",function(){return vt}),n.d(e,"FollowEmitter",function(){return sr}),n.d(e,"Emitter",function(){return zn}),n.d(e,"Body",function(){return Fe}),n.d(e,"BodySprite",function(){return qe}),n.d(e,"InitializerUtil",function(){return nn}),n.d(e,"Life",function(){return rn}),n.d(e,"Mass",function(){return on}),n.d(e,"Position",function(){return hn}),n.d(e,"Radius",function(){return fn}),n.d(e,"Rate",function(){return mn}),n.d(e,"Texture",function(){return yn}),n.d(e,"VectorVelocity",function(){return bn}),n.d(e,"PolarVelocity",function(){return gn}),n.d(e,"RadialVelocity",function(){return vn}),n.d(e,"ArraySpan",function(){return ye}),n.d(e,"createArraySpan",function(){return _e}),n.d(e,"ColorSpan",function(){return ge}),n.d(e,"createColorSpan",function(){return ve}),n.d(e,"Box",function(){return be}),n.d(e,"integrate",function(){return Ee}),n.d(e,"MathUtils",function(){return ae}),n.d(e,"Polar3D",function(){return Se}),n.d(e,"Span",function(){return de}),n.d(e,"createSpan",function(){return he}),n.d(e,"Vector3D",function(){return Te}),n.d(e,"INTEGRATION_TYPE_EULER",function(){return xe}),n.d(e,"INTEGRATION_TYPE_RK2",function(){return"RUNGE_KUTTA_2"}),n.d(e,"INTEGRATION_TYPE_RK4",function(){return"RUNGE_KUTTA_4"}),n.d(e,"INTEGRATION_TYPE_VERLET",function(){return"VERLET"}),n.d(e,"CustomRenderer",function(){return cr}),n.d(e,"MeshRenderer",function(){return ur}),n.d(e,"PointsRenderer",function(){return pr}),n.d(e,"SpriteRenderer",function(){return dr}),n.d(e,"ColorUtil",function(){return Yt}),n.d(e,"PUID",function(){return Qt}),n.d(e,"THREEUtil",function(){return ee}),n.d(e,"Util",function(){return ne}),n.d(e,"uid",function(){return ie}),n.d(e,"withDefaults",function(){return oe}),n.d(e,"BoxZone",function(){return sn}),n.d(e,"LineZone",function(){return ln}),n.d(e,"MeshZone",function(){return cn}),n.d(e,"PointZone",function(){return un}),n.d(e,"ScreenZone",function(){return pn}),n.d(e,"SphereZone",function(){return dn}),n.d(e,"System",function(){return nr}),n.d(e,"Particle",function(){return ze}),n.d(e,"Pool",function(){return Re}),e.default=nr}])}),particleVertexShader="\nuniform float heightOfNearPlane;\nattribute vec3  customColor;\nattribute float customOpacity;\nattribute float customSize;\nattribute float customAngle;\nattribute float customVisible; // float used as boolean (0 = false, 1 = true)\nvarying vec4 vColor;\nvarying float vAngle;\n\n#ifdef USE_MULTIPLES_TEXTURES\n    varying float vTexIndex;\n    attribute float texIndex;\n#endif\n\nvoid main() {\n    #ifdef USE_MULTIPLES_TEXTURES\n        vTexIndex = texIndex;\n    #endif\n\n    if ( customVisible > 0.5 )\n        vColor = vec4( customColor, customOpacity ); //     set color associated to vertex; use later in fragment shader.\n    else\n        vColor = vec4(0.0, 0.0, 0.0, 0.0); //     make particle invisible.\n\n    vAngle = customAngle;\n\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    //gl_PointSize = customSize * ( 1000.0 / length( mvPosition.xyz ) ); // scale particles as objects in 3D space\n    gl_PointSize = heightOfNearPlane * customSize / - mvPosition.z; // scale particles as objects in 3D space\n    gl_Position = projectionMatrix * mvPosition;\n}\n",particleFragmentShader="\n    #ifdef USE_MULTIPLES_TEXTURES\n        uniform sampler2D textures[$texture_count];\n        varying float vTexIndex;\n    #else\n        uniform sampler2D singleTexture;\n    #endif\n\n    varying vec4 vColor;\n    varying float vAngle;\n\n    void main()\n    {\n    float c = cos(vAngle);\n    float s = sin(vAngle);\n    vec2 rotatedUV = vec2(c * (gl_PointCoord.x - 0.5) + s * (gl_PointCoord.y - 0.5) + 0.5,\n    c * (gl_PointCoord.y - 0.5) - s * (gl_PointCoord.x - 0.5) + 0.5); // rotate UV coordinates to rotate texture\n    #ifdef USE_MULTIPLES_TEXTURES\n        vec4 rotatedTexture;\n        $foreachtextureindex\n    #else\n        vec4 rotatedTexture = texture2D( singleTexture,  rotatedUV );\n    #endif\n    gl_FragColor = vColor * rotatedTexture; // sets an otherwise white particle texture to desired color\n    }\n",n.prototype.lerp=function(t,e){for(var n=0,r=this.times.length;n<r&&t>this.times[n];)n++;if(0==n)return this.values[0];if(n==r)return this.values[r-1];var i=(t-this.times[n-1])/(this.times[n]-this.times[n-1]);return this.values[0]instanceof THREE.Vector3?e.copy(this.values[n-1]).lerp(this.values[n],i):this.values[n-1]+i*(this.values[n]-this.values[n-1])},n.prototype.lerpHSV=function(t,e){for(var n=0,r=this.times.length;n<r&&t>this.times[n];)n++;if(0==n)return this.values[0];if(n==r)return this.values[r-1];var i=(t-this.times[n-1])/(this.times[n]-this.times[n-1]);let o=this.values[n-1].x,a=this.values[n].x,s=a-o;if(o>a){let t=a;a=o,o=t,s=-s,i=1-i}return s>.5?(o+=1,e.x=o+t*(a-o)%1):e.x=o+t*s,e.y=this.values[n-1].y*(1-i)+this.values[n].y*i,e.z=this.values[n-1].z*(1-i)+this.values[n].z*i,e},r.prototype.update=function(t){if(this.position.x+=this.velocity.x*t,this.position.y+=this.velocity.y*t,this.position.z+=this.velocity.z*t,this.velocity.x+=this.acceleration.x*t,this.velocity.y+=this.acceleration.y*t,this.velocity.z+=this.acceleration.z*t,this.angle+=this.angleVelocity*t,this.angleVelocity+=this.angleAcceleration*t,this.age+=t,this.sizeTween.times.length>0&&(this.size=this.sizeTween.lerp(this.age)),this.colorTween.times.length>0){var e=this.colorTween.lerpHSV(this.age,a);this.color.setHSL(e.x,e.y,e.z)}this.opacityTween.times.length>0&&(this.opacity=this.opacityTween.lerp(this.age))};var i=Object.freeze({POINT:0,CUBE:1,SPHERE:2});function o(t){this.positionStyle=i.POINT,this.positionBase=new THREE.Vector3,this.positionBaseArrayIndex=0,this.lastPositionBase=null,this.positionBaseChanged=!1,this.interpolatePositions=!1,this.positionSpread=new THREE.Vector3,this.positionRadius=0,this.velocityStyle=i.CUBE,this.velocityBase=new THREE.Vector3,this.velocitySpread=new THREE.Vector3,this.speedBase=0,this.speedSpread=0,this.accelerationBase=new THREE.Vector3,this.accelerationSpread=new THREE.Vector3,this.angleBase=0,this.angleSpread=0,this.angleVelocityBase=0,this.angleVelocitySpread=0,this.angleAccelerationBase=0,this.angleAccelerationSpread=0,this.sizeBase=0,this.sizeSpread=0,this.sizeTween=new n,this.colorBase=new THREE.Vector3(0,1,.5),this.colorSpread=new THREE.Vector3(0,0,0),this.colorTween=new n,this.opacityBase=1,this.opacitySpread=0,this.opacityTween=new n,this.blendStyle=THREE.NormalBlending,this.particleArray=[],this.particlesPerSecond=100,this.particleDeathAge=1,this.emitterAge=0,this.emitterAlive=!0,this.emitting=!1,this.emitterDeathAge=3,this.emitterStopEmitAge=30,this.particleCount=this.particlesPerSecond*Math.min(0==this.emitterStopEmitAge?1e6:this.emitterStopEmitAge,Math.min(this.particleDeathAge,0==this.emitterDeathAge?1e6:this.emitterDeathAge))+1,this.particlePool=[],this.particlesToEmit=0,this.hasEmitted=!1,void 0!==t&&this.setValues(t)}o.prototype.setValues=function(t){if(void 0!==t){for(var e in this.sizeTween=new n,this.colorTween=new n,this.opacityTween=new n,t)this[e]=t[e];if(this.particleArray=[],this.emitterAge=0,this.emitterAlive=!0,this.particleCount=this.particlesPerSecond*Math.min(0==this.emitterStopEmitAge?1e6:this.emitterStopEmitAge,Math.min(this.particleDeathAge,0==this.emitterDeathAge?1e6:this.emitterDeathAge))+1,this.particleGeometry=new THREE.BufferGeometry,this.particleGeometry.setAttribute("position",new THREE.BufferAttribute(new Float32Array,3)),this.particleGeometry.setAttribute("customVisible",new THREE.BufferAttribute(new Float32Array,1)),this.particleGeometry.setAttribute("customAngle",new THREE.BufferAttribute(new Float32Array,1)),this.particleGeometry.setAttribute("customSize",new THREE.BufferAttribute(new Float32Array,1)),this.particleGeometry.setAttribute("customColor",new THREE.BufferAttribute(new Float32Array,3)),this.particleGeometry.setAttribute("customOpacity",new THREE.BufferAttribute(new Float32Array,1)),this.particleTextures){for(var r="",i=0;i<this.particleTextures.length;i++)r+=(0==i?"":"else ")+"if (vTexIndex < "+(i+.5)+") rotatedTexture = texture2D( textures["+i+"],  rotatedUV );\n";var o=particleFragmentShader.replace("$texture_count",this.particleTextures.length).replace("$foreachtextureindex",r);this.particleMaterial=new THREE.ShaderMaterial({uniforms:{textures:{type:"tv",value:this.particleTextures},heightOfNearPlane:{type:"f",value:1e3}},vertexShader:particleVertexShader.replace("$texture_count",this.particleTextures.length),fragmentShader:o,transparent:!0,alphaTest:.5,blending:THREE.NormalBlending,depthTest:!0,depthWrite:!1}),this.texturesCount=this.particleTextures.length,this.particleMaterial.defines.USE_MULTIPLES_TEXTURES=1,this.particleGeometry.setAttribute("texIndex",new THREE.BufferAttribute(new Float32Array,1))}else this.particleMaterial=new THREE.ShaderMaterial({uniforms:{singleTexture:{type:"t",value:this.particleTexture},heightOfNearPlane:{type:"f",value:1e3}},vertexShader:particleVertexShader.replace("$texture_count",1),fragmentShader:particleFragmentShader.replace("$texture_count",1).replace("$foreachtextureindex",""),transparent:!0,alphaTest:.5,blending:THREE.NormalBlending,depthTest:!0,depthWrite:!1}),this.texturesCount=1;return this.emitting=!0,this}},o.prototype.randomValue=function(t,e){return t+e*(Math.random()-.5)},o.prototype.randomVector3=function(t,e,n){return t.set(e.x+n.x*(Math.random()-.5),e.y+n.y*(Math.random()-.5),e.z+n.z*(Math.random()-.5))},o.prototype.createParticle=function(){var t=new r;return t.sizeTween=this.sizeTween,t.colorTween=this.colorTween,t.opacityTween=this.opacityTween,t};var a=new THREE.Vector3;o.prototype.respawnParticle=function(t){var e=this.particleArray[t],n=this.positionBase;if(this.positionBaseArray&&this.positionBaseArray.length>0&&(this.positionBaseArrayIndex=(this.positionBaseArrayIndex+1)%this.positionBaseArray.length,n=this.positionBaseArray[this.positionBaseArrayIndex]),this.positionStyle==i.POINT)e.position.copy(n);else if(this.positionStyle==i.CUBE)this.randomVector3(e.position,n,this.positionSpread);else if(this.positionStyle==i.SPHERE){var r=2*Math.random()-1,o=6.2832*Math.random(),s=Math.sqrt(1-r*r);e.position.set(n.x+s*Math.cos(o)*this.positionRadius,n.y+s*Math.sin(o)*this.positionRadius,n.z+r*this.positionRadius)}if(this.velocityStyle==i.CUBE&&("function"==typeof this.velocityBase?e.velocity=this.velocityBase():this.randomVector3(e.velocity,this.velocityBase,this.velocitySpread)),this.velocityStyle==i.SPHERE){var l=this.randomValue(this.speedBase,this.speedSpread);e.velocity.subVectors(e.position,n).normalize().multiplyScalar(l)}"function"==typeof this.accelerationBase?e.acceleration=this.accelerationBase():this.randomVector3(e.acceleration,this.accelerationBase,this.accelerationSpread),e.angle=this.randomValue(this.angleBase,this.angleSpread)*Math.PI/180,e.angleVelocity=this.randomValue(this.angleVelocityBase,this.angleVelocitySpread)*Math.PI/180,e.angleAcceleration=this.randomValue(this.angleAccelerationBase,this.angleAccelerationSpread)*Math.PI/180,e.size=this.randomValue(this.sizeBase,this.sizeSpread);var c=this.randomVector3(a,this.colorBase,this.colorSpread);e.color.setHSL(c.x,c.y,c.z),"function"==typeof this.colorTween&&(e.colorTween=this.colorTween()),"function"==typeof this.sizeTween&&(e.sizeTween=this.sizeTween()),"function"==typeof this.opacityTween&&(e.opacityTween=this.opacityTween()),e.opacity=this.randomValue(this.opacityBase,this.opacitySpread),e.age=0,e.alive=1;var u=t;return this.particleGeometry.attributes.position.setXYZ(u,this.particleArray[u].position.x,this.particleArray[u].position.y,this.particleArray[u].position.z),this.particleGeometry.attributes.customVisible.array[u]=this.particleArray[u].alive,this.particleGeometry.attributes.customColor.setXYZ(u,this.particleArray[u].color.r,this.particleArray[u].color.g,this.particleArray[u].color.b),this.particleGeometry.attributes.customOpacity.array[u]=this.particleArray[u].opacity,this.particleGeometry.attributes.customSize.array[u]=this.particleArray[u].size,this.particleGeometry.attributes.customAngle.array[u]=this.particleArray[u].angle,this.texturesCount>1&&(this.particleGeometry.attributes.texIndex.array[u]=Math.floor(Math.random()*this.texturesCount),this.particleGeometry.attributes.texIndex.needsUpdate=!0),e},o.prototype.initialize=function(t){this.particleGeometry.attributes.position.count=this.particleCount,this.particleGeometry.attributes.customVisible.count=this.particleCount,this.particleGeometry.attributes.customColor.count=this.particleCount,this.particleGeometry.attributes.customOpacity.count=this.particleCount,this.particleGeometry.attributes.customSize.count=this.particleCount,this.particleGeometry.attributes.customAngle.count=this.particleCount,this.particleGeometry.attributes.position.array=new Float32Array(3*this.particleCount),this.particleGeometry.attributes.customVisible.array=new Float32Array(this.particleCount),this.particleGeometry.attributes.customColor.array=new Float32Array(3*this.particleCount),this.particleGeometry.attributes.customOpacity.array=new Float32Array(this.particleCount),this.particleGeometry.attributes.customSize.array=new Float32Array(this.particleCount),this.particleGeometry.attributes.customAngle.array=new Float32Array(this.particleCount),this.texturesCount>1&&(this.particleGeometry.attributes.texIndex.array=new Float32Array(this.particleCount));for(var e=0;e<this.particleCount;e++)this.particleArray[e]=this.createParticle(),this.particlePool.push(e);return this.particleMaterial.blending=this.blendStyle,this.particleMesh=new THREE.Points(this.particleGeometry,this.particleMaterial),this.particleMesh.name="particles",t.add(this.particleMesh),this.particleMesh.matrixAutoUpdate=!1,this};var s=new THREE.Vector2;o.prototype.update=function(t){for(var e=!1,n=0;n<this.particleCount;n++)1==this.particleArray[n].alive&&(e=!0,this.particleArray[n].update(t),this.particleArray[n].age>=this.particleDeathAge?(this.particleArray[n].alive=0,this.particlePool.push(n),this.particleGeometry.attributes.customVisible.array[n]=this.particleArray[n].alive):(this.particleGeometry.attributes.position.setXYZ(n,this.particleArray[n].position.x,this.particleArray[n].position.y,this.particleArray[n].position.z),this.particleGeometry.attributes.customVisible.array[n]=this.particleArray[n].alive,this.particleGeometry.attributes.customColor.setXYZ(n,this.particleArray[n].color.r,this.particleArray[n].color.g,this.particleArray[n].color.b),this.particleGeometry.attributes.customOpacity.array[n]=this.particleArray[n].opacity,this.particleGeometry.attributes.customSize.array[n]=this.particleArray[n].size,this.particleGeometry.attributes.customAngle.array[n]=this.particleArray[n].angle));if(this.particleGeometry.attributes.position.needsUpdate=!0,this.particleGeometry.attributes.customVisible.needsUpdate=!0,this.particleGeometry.attributes.customColor.needsUpdate=!0,this.particleGeometry.attributes.customOpacity.needsUpdate=!0,this.particleGeometry.attributes.customSize.needsUpdate=!0,this.particleGeometry.attributes.customAngle.needsUpdate=!0,this.hasEmitted&&this.emitterAge>0&&!e&&(this.emitterAlive=!1),this.emitterAlive){if(this.emitterAge+=t,this.emitterDeathAge>0&&this.emitterAge>this.emitterDeathAge&&(this.emitterAlive=!1),this.emitterStopEmitAge>0&&this.emitterAge>this.emitterStopEmitAge&&(this.hasEmitted?this.emitting=!1:t=this.emitterStopEmitAge-(this.emitterAge-t)),this.emitting){var r=this.particlesToEmit;if(this.particlesToEmit+=this.particlesPerSecond*t,this.particlesToEmit>=1)if(this.hasEmitted=!0,this.interpolatePositions&&this.lastPositionBase&&this.particlesToEmit>1){let t=Math.floor(this.particlesToEmit);this.lastPositionBase&&this.positionBaseChanged||(t=1,this.particlesToEmit=1),this.lastPositionBase||(this.lastPositionBase=this.positionBase.clone());let e=this.positionBase.clone().sub(this.lastPositionBase).multiplyScalar(1/t);this.positionBase.copy(this.lastPositionBase);for(let n=0;n<t;n++)if(this.positionBase.add(e),0==this.particlePool.length);else{var i=this.particlePool.pop();this.respawnParticle(i)}this.lastPositionBase.copy(this.positionBase),this.particlesToEmit-=t}else for(var o=1/this.particlesPerSecond,a=0;this.particlesToEmit>=1;){if(0==this.particlePool.length){this.particlesToEmit=0;break}{i=this.particlePool.pop(),this.respawnParticle(i);let t=((0==r?0:1-r)+a)*o;this.particleArray[i].update(t),a++}this.particlesToEmit--}}this.particleMaterial.uniforms.heightOfNearPlane.value=bl.getSize(s).y/(2*Math.tan(.5*_l.fov*Math.PI/180)),this.particleGeometry.computeBoundingSphere()}},o.prototype.manuallyEmitOneParticle=function(t){if(t)for(var e in t)this[e]=t[e];if(0==this.particlePool.length)return null;var n=this.particlePool.pop();return this.respawnParticle(n),n},o.prototype.manuallyKillParticle=function(t){this.particleArray[t].age=this.particleDeathAge},o.prototype.manuallyDestroyASAP=function(){this.hasEmitted=!0},o.prototype.startEmit=function(){return this.emitting=!0,this.emitterAge=0,this},o.prototype.stopEmit=function(){return this.emitting=!1,this},o.prototype.setPosition=function(t){return this.positionBase.copy(t),this.positionShift&&this.positionBase.add(this.positionShift),this.positionBaseChanged=!0,this.particleMesh&&this.particleMesh.updateWorldMatrix(),this},o.prototype.destroy=function(){this.particleMesh.parent&&this.particleMesh.parent.remove(this.particleMesh),this.particleMesh.geometry.dispose()};var l,c,u,d,h,f,m,y,_;new THREE.Color("#FF1199"),THREE.EXRLoader=function(t){THREE.DataTextureLoader.call(this,t),this.type=THREE.FloatType},THREE.EXRLoader.prototype=Object.assign(Object.create(THREE.DataTextureLoader.prototype),{constructor:THREE.EXRLoader,parse:function(t){const e=14,n=65537,r=1<<e,i=r-1,o=32768,a=65535,s=59,l=63,c=2+l-s,u=8,p=4,d=4,h=2,f=1,m=0,y=1,_=0,g=1,v=2,b=Math.pow(2.7182818,2.2);var x=new DataView(new ArrayBuffer(8));function w(t){if(0===t)return[t,0];x.setFloat64(0,t);var e=x.getUint32(0)>>>20&2047;0===e&&(x.setFloat64(0,t*Math.pow(2,64)),e=(x.getUint32(0)>>>20&2047)-64);var n=e-1022;return[function(t,e){for(var n=Math.min(3,Math.ceil(Math.abs(e)/1023)),r=t,i=0;i<n;i++)r*=Math.pow(2,Math.floor((e+i)/n));return r}(t,-n),n]}const E={l:0,c:0,lc:0};function T(t,e,n,r,i){for(;n<t;)e=e<<8|K(r,i),n+=8;n-=t,E.l=e>>n&(1<<t)-1,E.c=e,E.lc=n}const S=new Array(59);function M(t){return 63&t}function j(t){return t>>6}const C={c:0,lc:0};function z(t,e,n,r){t=t<<8|K(n,r),e+=8,C.c=t,C.lc=e}const R={c:0,lc:0};function A(t,e,n,r,i,o,a,s,l,c){if(t==e){r<8&&(z(n,r,i,a),n=C.c,r=C.lc);var u=n>>(r-=8);if(u=new Uint8Array([u])[0],l.value+u>c)return!1;for(var p=s[l.value-1];u-- >0;)s[l.value++]=p}else{if(!(l.value<c))return!1;s[l.value++]=t}R.c=n,R.lc=r}function L(t){return 65535&t}function I(t){var e=L(t);return e>32767?e-65536:e}const P={a:0,b:0};function O(t,e){var n=I(t),r=I(e),i=n+(1&r)+(r>>1),o=i,a=i-r;P.a=o,P.b=a}function k(t,e){var n=L(t),r=L(e),i=n-(r>>1)&a,s=r+i-o&a;P.a=s,P.b=i}function B(t,e,n,r,i,o,a){for(var s,l=a<16384,c=n>i?i:n,u=1;u<=c;)u<<=1;for(s=u>>=1,u>>=1;u>=1;){for(var p,d,h,f,m=0,y=m+o*(i-s),_=o*u,g=o*s,v=r*u,b=r*s;m<=y;m+=g){for(var x=m,w=m+r*(n-s);x<=w;x+=b){var E=x+v,T=(S=x+_)+v;l?(O(t[x+e],t[S+e]),p=P.a,h=P.b,O(t[E+e],t[T+e]),d=P.a,f=P.b,O(p,d),t[x+e]=P.a,t[E+e]=P.b,O(h,f),t[S+e]=P.a,t[T+e]=P.b):(k(t[x+e],t[S+e]),p=P.a,h=P.b,k(t[E+e],t[T+e]),d=P.a,f=P.b,k(p,d),t[x+e]=P.a,t[E+e]=P.b,k(h,f),t[S+e]=P.a,t[T+e]=P.b)}if(n&u){var S=x+_;l?O(t[x+e],t[S+e]):k(t[x+e],t[S+e]),p=P.a,t[S+e]=P.b,t[x+e]=p}}if(i&u)for(x=m,w=m+r*(n-s);x<=w;x+=b)E=x+v,l?O(t[x+e],t[E+e]):k(t[x+e],t[E+e]),p=P.a,t[E+e]=P.b,t[x+e]=p;s=u,u>>=1}return m}function D(t,o,a,u,p,d){var h=a.value,f=J(o,a),m=J(o,a);a.value+=4;var y=J(o,a);if(a.value+=4,f<0||f>=n||m<0||m>=n)throw"Something wrong with HUF_ENCSIZE";var _=new Array(n),g=new Array(r);if(function(t){for(var e=0;e<r;e++)t[e]={},t[e].len=0,t[e].lit=0,t[e].p=null}(g),function(t,e,r,i,o,a,u){for(var p=r,d=0,h=0;o<=a;o++){if(p.value-r.value>i)return!1;T(6,d,h,t,p);var f=E.l;if(d=E.c,h=E.lc,u[o]=f,f==l){if(p.value-r.value>i)throw"Something wrong with hufUnpackEncTable";T(8,d,h,t,p);var m=E.l+c;if(d=E.c,h=E.lc,o+m>a+1)throw"Something wrong with hufUnpackEncTable";for(;m--;)u[o++]=0;o--}else if(f>=s){if(o+(m=f-s+2)>a+1)throw"Something wrong with hufUnpackEncTable";for(;m--;)u[o++]=0;o--}}!function(t){for(var e=0;e<=58;++e)S[e]=0;for(e=0;e<n;++e)S[t[e]]+=1;var r=0;for(e=58;e>0;--e){var i=r+S[e]>>1;S[e]=r,r=i}for(e=0;e<n;++e){var o=t[e];o>0&&(t[e]=o|S[o]++<<6)}}(u)}(t,0,a,u-(a.value-h),f,m,_),y>8*(u-(a.value-h)))throw"Something wrong with hufUncompress";!function(t,n,r,i){for(;n<=r;n++){var o=j(t[n]),a=M(t[n]);if(o>>a)throw"Invalid table entry";if(a>e){if((u=i[o>>a-e]).len)throw"Invalid table entry";if(u.lit++,u.p){var s=u.p;u.p=new Array(u.lit);for(var l=0;l<u.lit-1;++l)u.p[l]=s[l]}else u.p=new Array(1);u.p[u.lit-1]=n}else if(a){var c=0;for(l=1<<e-a;l>0;l--){var u;if((u=i[(o<<e-a)+c]).len||u.p)throw"Invalid table entry";u.len=a,u.lit=n,c++}}}}(_,f,m,g),function(t,n,r,o,a,s,l,c,u,p){for(var h=0,f=0,m=d,y=Math.trunc(a.value+(s+7)/8);a.value<y;)for(z(h,f,r,a),h=C.c,f=C.lc;f>=e;)if((b=n[h>>f-e&i]).len)f-=b.len,A(b.lit,l,h,f,r,0,a,u,p,m),h=R.c,f=R.lc;else{if(!b.p)throw"hufDecode issues";var _;for(_=0;_<b.lit;_++){for(var g=M(t[b.p[_]]);f<g&&a.value<y;)z(h,f,r,a),h=C.c,f=C.lc;if(f>=g&&j(t[b.p[_]])==(h>>f-g&(1<<g)-1)){f-=g,A(b.p[_],l,h,f,r,0,a,u,p,m),h=R.c,f=R.lc;break}}if(_==b.lit)throw"hufDecode issues"}var v=8-s&7;for(h>>=v,f-=v;f>0;){var b;if(!(b=n[h<<e-f&i]).len)throw"hufDecode issues";f-=b.len,A(b.lit,l,h,f,r,0,a,u,p,m),h=R.c,f=R.lc}}(_,g,t,0,a,y,m,0,p,{value:0})}function H(t){for(var e=1;e<t.length;e++){var n=t[e-1]+t[e]-128;t[e]=n}}function F(t,e){for(var n=0,r=Math.floor((t.length+1)/2),i=0,o=t.length-1;!(i>o||(e[i++]=t[n++],i>o));)e[i++]=t[r++]}function N(t){for(var e=t.byteLength,n=new Array,r=0,i=new DataView(t);e>0;){var o=i.getInt8(r++);if(o<0){e-=1+(s=-o);for(var a=0;a<s;a++)n.push(i.getUint8(r++))}else{var s=o;e-=2;var l=i.getUint8(r++);for(a=0;a<s+1;a++)n.push(l)}}return n}function U(t,e,n){for(var r,i=1;i<64;)65280==(r=e[t.value])?i=64:r>>8==255?i+=255&r:(n[i]=r,i++),t.value++}function V(t){const e=.5*Math.cos(.7853975),n=.5*Math.cos(.196349375),r=.5*Math.cos(.39269875),i=.5*Math.cos(3*3.14159/16),o=.5*Math.cos(.981746875),a=.5*Math.cos(3*3.14159/8),s=.5*Math.cos(1.374445625);for(var l=new Array(4),c=new Array(4),u=new Array(4),p=new Array(4),d=0;d<8;++d){var h=8*d;l[0]=r*t[h+2],l[1]=a*t[h+2],l[2]=r*t[h+6],l[3]=a*t[h+6],c[0]=n*t[h+1]+i*t[h+3]+o*t[h+5]+s*t[h+7],c[1]=i*t[h+1]-s*t[h+3]-n*t[h+5]-o*t[h+7],c[2]=o*t[h+1]-n*t[h+3]+s*t[h+5]+i*t[h+7],c[3]=s*t[h+1]-o*t[h+3]+i*t[h+5]-n*t[h+7],u[0]=e*(t[h+0]+t[h+4]),u[3]=e*(t[h+0]-t[h+4]),u[1]=l[0]+l[3],u[2]=l[1]-l[2],p[0]=u[0]+u[1],p[1]=u[3]+u[2],p[2]=u[3]-u[2],p[3]=u[0]-u[1],t[h+0]=p[0]+c[0],t[h+1]=p[1]+c[1],t[h+2]=p[2]+c[2],t[h+3]=p[3]+c[3],t[h+4]=p[3]-c[3],t[h+5]=p[2]-c[2],t[h+6]=p[1]-c[1],t[h+7]=p[0]-c[0]}for(var f=0;f<8;++f)l[0]=r*t[16+f],l[1]=a*t[16+f],l[2]=r*t[48+f],l[3]=a*t[48+f],c[0]=n*t[8+f]+i*t[24+f]+o*t[40+f]+s*t[56+f],c[1]=i*t[8+f]-s*t[24+f]-n*t[40+f]-o*t[56+f],c[2]=o*t[8+f]-n*t[24+f]+s*t[40+f]+i*t[56+f],c[3]=s*t[8+f]-o*t[24+f]+i*t[40+f]-n*t[56+f],u[0]=e*(t[f]+t[32+f]),u[3]=e*(t[f]-t[32+f]),u[1]=l[0]+l[3],u[2]=l[1]-l[2],p[0]=u[0]+u[1],p[1]=u[3]+u[2],p[2]=u[3]-u[2],p[3]=u[0]-u[1],t[0+f]=p[0]+c[0],t[8+f]=p[1]+c[1],t[16+f]=p[2]+c[2],t[24+f]=p[3]+c[3],t[32+f]=p[3]-c[3],t[40+f]=p[2]-c[2],t[48+f]=p[1]-c[1],t[56+f]=p[0]-c[0]}function G(t){for(var e=0;e<64;++e){var n=t[0][e],r=t[1][e],i=t[2][e];t[0][e]=n+1.5747*i,t[1][e]=n-.1873*r-.4682*i,t[2][e]=n+1.8556*r}}function W(t,e,n){for(var r=0;r<64;++r)e[n+r]=THREE.DataUtils.toHalfFloat((i=t[r])<=1?Math.sign(i)*Math.pow(Math.abs(i),2.2):Math.sign(i)*Math.pow(b,Math.abs(i)-1));var i}function q(t){var e=t.array.slice(t.offset.value,t.offset.value+t.size);"undefined"==typeof fflate&&console.error("THREE.EXRLoader: External library fflate.min.js required.");var n=fflate.unzlibSync(e),r=new Uint8Array(n.length);return H(n),F(n,r),new DataView(r.buffer)}function X(t){var e=t.viewer,n={value:t.offset.value},r=new Uint8Array(t.width*t.lines*(st.channels.length*t.type*h)),i={version:tt(e,n),unknownUncompressedSize:tt(e,n),unknownCompressedSize:tt(e,n),acCompressedSize:tt(e,n),dcCompressedSize:tt(e,n),rleCompressedSize:tt(e,n),rleUncompressedSize:tt(e,n),rleRawSize:tt(e,n),totalAcUncompressedCount:tt(e,n),totalDcUncompressedCount:tt(e,n),acCompression:tt(e,n)};if(i.version<2)throw"EXRLoader.parse: "+st.compression+" version "+i.version+" is unsupported";for(var o=new Array,a=rt(e,n)-h;a>0;){var s=Y(e.buffer,n),l=$(e,n),c=l>>2&3,u=new Int8Array([(l>>4)-1])[0],p=$(e,n);o.push({name:s,index:u,type:p,compression:c}),a-=s.length+3}for(var d=st.channels,f=new Array(t.channels),b=0;b<t.channels;++b){var x=f[b]={},w=d[b];x.name=w.name,x.compression=_,x.decoded=!1,x.type=w.pixelType,x.pLinear=w.pLinear,x.width=t.width,x.height=t.lines}for(var E={idx:new Array(3)},T=0;T<t.channels;++T)for(x=f[T],b=0;b<o.length;++b){var S=o[b];x.name==S.name&&(x.compression=S.compression,S.index>=0&&(E.idx[S.index]=T),x.offset=T)}if(i.acCompressedSize>0)switch(i.acCompression){case m:var M=new Uint16Array(i.totalAcUncompressedCount);D(t.array,e,n,i.acCompressedSize,M,i.totalAcUncompressedCount);break;case y:var j=t.array.slice(n.value,n.value+i.totalAcUncompressedCount),C=fflate.unzlibSync(j);M=new Uint16Array(C.buffer),n.value+=i.totalAcUncompressedCount}if(i.dcCompressedSize>0){var z={array:t.array,offset:n,size:i.dcCompressedSize},R=new Uint16Array(q(z).buffer);n.value+=i.dcCompressedSize}if(i.rleRawSize>0){j=t.array.slice(n.value,n.value+i.rleCompressedSize);var A=N((C=fflate.unzlibSync(j)).buffer);n.value+=i.rleCompressedSize}var L=0,I=new Array(f.length);for(b=0;b<I.length;++b)I[b]=new Array;for(var P=0;P<t.lines;++P)for(var O=0;O<f.length;++O)I[O].push(L),L+=f[O].width*t.type*h;for(function(t,e,n,r,i,o){var a,s,l=new DataView(o.buffer),c=n[t.idx[0]].width,u=n[t.idx[0]].height,p=Math.floor(c/8),d=Math.ceil(c/8),f=Math.ceil(u/8),m=c-8*(d-1),y=u-8*(f-1),_={value:0},g=new Array(3),v=new Array(3),b=new Array(3),x=new Array(3),w=new Array(3);for(let n=0;n<3;++n)w[n]=e[t.idx[n]],g[n]=n<1?0:g[n-1]+d*f,v[n]=new Float32Array(64),b[n]=new Uint16Array(64),x[n]=new Uint16Array(64*d);for(let e=0;e<f;++e){var E=8;e==f-1&&(E=y);var T=8;for(let t=0;t<d;++t){t==d-1&&(T=m);for(let t=0;t<3;++t)b[t].fill(0),b[t][0]=i[g[t]++],U(_,r,b[t]),a=b[t],(s=v[t])[0]=nt(a[0]),s[1]=nt(a[1]),s[2]=nt(a[5]),s[3]=nt(a[6]),s[4]=nt(a[14]),s[5]=nt(a[15]),s[6]=nt(a[27]),s[7]=nt(a[28]),s[8]=nt(a[2]),s[9]=nt(a[4]),s[10]=nt(a[7]),s[11]=nt(a[13]),s[12]=nt(a[16]),s[13]=nt(a[26]),s[14]=nt(a[29]),s[15]=nt(a[42]),s[16]=nt(a[3]),s[17]=nt(a[8]),s[18]=nt(a[12]),s[19]=nt(a[17]),s[20]=nt(a[25]),s[21]=nt(a[30]),s[22]=nt(a[41]),s[23]=nt(a[43]),s[24]=nt(a[9]),s[25]=nt(a[11]),s[26]=nt(a[18]),s[27]=nt(a[24]),s[28]=nt(a[31]),s[29]=nt(a[40]),s[30]=nt(a[44]),s[31]=nt(a[53]),s[32]=nt(a[10]),s[33]=nt(a[19]),s[34]=nt(a[23]),s[35]=nt(a[32]),s[36]=nt(a[39]),s[37]=nt(a[45]),s[38]=nt(a[52]),s[39]=nt(a[54]),s[40]=nt(a[20]),s[41]=nt(a[22]),s[42]=nt(a[33]),s[43]=nt(a[38]),s[44]=nt(a[46]),s[45]=nt(a[51]),s[46]=nt(a[55]),s[47]=nt(a[60]),s[48]=nt(a[21]),s[49]=nt(a[34]),s[50]=nt(a[37]),s[51]=nt(a[47]),s[52]=nt(a[50]),s[53]=nt(a[56]),s[54]=nt(a[59]),s[55]=nt(a[61]),s[56]=nt(a[35]),s[57]=nt(a[36]),s[58]=nt(a[48]),s[59]=nt(a[49]),s[60]=nt(a[57]),s[61]=nt(a[58]),s[62]=nt(a[62]),s[63]=nt(a[63]),V(v[t]);G(v);for(let e=0;e<3;++e)W(v[e],x[e],64*t)}let o=0;for(let r=0;r<3;++r){const i=n[t.idx[r]].type;for(let t=8*e;t<8*e+E;++t){o=w[r][t];for(let e=0;e<p;++e){const n=64*e+8*(7&t);l.setUint16(o+0*h*i,x[r][n+0],!0),l.setUint16(o+1*h*i,x[r][n+1],!0),l.setUint16(o+2*h*i,x[r][n+2],!0),l.setUint16(o+3*h*i,x[r][n+3],!0),l.setUint16(o+4*h*i,x[r][n+4],!0),l.setUint16(o+5*h*i,x[r][n+5],!0),l.setUint16(o+6*h*i,x[r][n+6],!0),l.setUint16(o+7*h*i,x[r][n+7],!0),o+=8*h*i}}if(p!=d)for(let t=8*e;t<8*e+E;++t){const e=w[r][t]+8*p*h*i,n=64*p+8*(7&t);for(let t=0;t<T;++t)l.setUint16(e+t*h*i,x[r][n+t],!0)}}}for(var S=new Uint16Array(c),M=(l=new DataView(o.buffer),0);M<3;++M){n[t.idx[M]].decoded=!0;var j=n[t.idx[M]].type;if(2==n[M].type)for(var C=0;C<u;++C){const t=w[M][C];for(var z=0;z<c;++z)S[z]=l.getUint16(t+z*h*j,!0);for(z=0;z<c;++z)l.setFloat32(t+z*h*j,nt(S[z]),!0)}}}(E,I,f,M,R,r),b=0;b<f.length;++b)if(!(x=f[b]).decoded)switch(x.compression){case v:var k=0,B=0;for(P=0;P<t.lines;++P){for(var H=I[b][k],F=0;F<x.width;++F){for(var X=0;X<h*x.type;++X)r[H++]=A[B+X*x.width*x.height];B++}k++}break;case g:default:throw"EXRLoader.parse: unsupported channel compression"}return new DataView(r.buffer)}function Y(t,e){for(var n=new Uint8Array(t),r=0;0!=n[e.value+r];)r+=1;var i=(new TextDecoder).decode(n.slice(e.value,e.value+r));return e.value=e.value+r+1,i}function Q(t,e){var n=t.getUint32(0,!0);return e.value=e.value+u,n}function Z(t,e){var n=t.getInt32(e.value,!0);return e.value=e.value+d,n}function J(t,e){var n=t.getUint32(e.value,!0);return e.value=e.value+d,n}function K(t,e){var n=t[e.value];return e.value=e.value+f,n}function $(t,e){var n=t.getUint8(e.value);return e.value=e.value+f,n}function tt(t,e){var n=Number(t.getBigInt64(e.value,!0));return e.value+=u,n}function et(t,e){var n=t.getFloat32(e.value,!0);return e.value+=p,n}function nt(t){var e=(31744&t)>>10,n=1023&t;return(t>>15?-1:1)*(e?31===e?n?NaN:1/0:Math.pow(2,e-15)*(1+n/1024):n/1024*6103515625e-14)}function rt(t,e){var n=t.getUint16(e.value,!0);return e.value+=h,n}function it(t,e,n,r,i){return"string"===r||"stringvector"===r||"iccProfile"===r?function(t,e,n){var r=(new TextDecoder).decode(new Uint8Array(t).slice(e.value,e.value+n));return e.value=e.value+n,r}(e,n,i):"chlist"===r?function(t,e,n,r){for(var i=n.value,o=[];n.value<i+r-1;){var a=Y(e,n),s=Z(t,n),l=$(t,n);n.value+=3;var c=Z(t,n),u=Z(t,n);o.push({name:a,pixelType:s,pLinear:l,xSampling:c,ySampling:u})}return n.value+=1,o}(t,e,n,i):"chromaticities"===r?function(t,e){return{redX:et(t,e),redY:et(t,e),greenX:et(t,e),greenY:et(t,e),blueX:et(t,e),blueY:et(t,e),whiteX:et(t,e),whiteY:et(t,e)}}(t,n):"compression"===r?function(t,e){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][$(t,e)]}(t,n):"box2i"===r?function(t,e){return{xMin:J(t,e),yMin:J(t,e),xMax:J(t,e),yMax:J(t,e)}}(t,n):"lineOrder"===r?function(t,e){return["INCREASING_Y"][$(t,e)]}(t,n):"float"===r?et(t,n):"v2f"===r?function(t,e){return[et(t,e),et(t,e)]}(t,n):"v3f"===r?function(t,e){return[et(t,e),et(t,e),et(t,e)]}(t,n):"int"===r?Z(t,n):"rational"===r?function(t,e){return[Z(t,e),J(t,e)]}(t,n):"timecode"===r?function(t,e){return[J(t,e),J(t,e)]}(t,n):"preview"===r?(n.value+=i,"skipped"):void(n.value+=i)}var ot=new DataView(t),at=new Uint8Array(t),st={};ot.getUint32(0,!0),ot.getUint8(4,!0),ot.getUint8(5,!0);for(var lt={value:8},ct=!0;ct;){var ut=Y(t,lt);if(0==ut)ct=!1;else{var pt=Y(t,lt),dt=it(ot,t,lt,pt,J(ot,lt));void 0===dt?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${pt}'.`):st[ut]=dt}}var ht,ft,mt,yt,_t=st.dataWindow.yMax+1;switch(st.compression){case"NO_COMPRESSION":ft=1,ht=function(t){return new DataView(t.array.buffer,t.offset.value,t.size)};break;case"RLE_COMPRESSION":ft=1,ht=function(t){var e=t.viewer.buffer.slice(t.offset.value,t.offset.value+t.size),n=new Uint8Array(N(e)),r=new Uint8Array(n.length);return H(n),F(n,r),new DataView(r.buffer)};break;case"ZIPS_COMPRESSION":ft=1,ht=q;break;case"ZIP_COMPRESSION":ft=16,ht=q;break;case"PIZ_COMPRESSION":ft=32,ht=function(t){for(var e=t.viewer,n={value:t.offset.value},r=t.width*ft*(st.channels.length*t.type),i=new Uint16Array(r),o=new Uint8Array(8192),a=0,s=new Array(t.channels),l=0;l<t.channels;l++)s[l]={},s[l].start=a,s[l].end=s[l].start,s[l].nx=t.width,s[l].ny=t.lines,s[l].size=t.type,a+=s[l].nx*s[l].ny*s[l].size;var c=rt(e,n),u=rt(e,n);if(u>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(c<=u)for(l=0;l<u-c+1;l++)o[l+c]=$(e,n);var p=new Uint16Array(65536),d=function(t,e){for(var n=0,r=0;r<65536;++r)(0==r||t[r>>3]&1<<(7&r))&&(e[n++]=r);for(var i=n-1;n<65536;)e[n++]=0;return i}(o,p),f=J(e,n);for(D(t.array,e,n,f,i,a),l=0;l<t.channels;++l)for(var m=s[l],y=0;y<s[l].size;++y)B(i,m.start+y,m.nx,m.size,m.ny,m.nx*m.size,d);!function(t,e,n){for(var r=0;r<n;++r)e[r]=t[e[r]]}(p,i,a);for(var _=0,g=new Uint8Array(i.buffer.byteLength),v=0;v<t.lines;v++)for(var b=0;b<t.channels;b++){var x=(m=s[b]).nx*m.size,w=new Uint8Array(i.buffer,m.end*h,x*h);g.set(w,_),_+=x*h,m.end+=x}return new DataView(g.buffer)};break;case"PXR24_COMPRESSION":ft=16,ht=function(t){var e=t.array.slice(t.offset.value,t.offset.value+t.size);"undefined"==typeof fflate&&console.error("THREE.EXRLoader: External library fflate.min.js required.");var n=fflate.unzlibSync(e);const r=t.lines*t.channels*t.width,i=1==t.type?new Uint16Array(r):new Uint32Array(r);let o=0,a=0;const s=new Array(4);for(let e=0;e<t.lines;e++)for(let e=0;e<t.channels;e++){let e=0;switch(t.type){case 1:s[0]=o,s[1]=s[0]+t.width,o=s[1]+t.width;for(let r=0;r<t.width;++r)e+=n[s[0]++]<<8|n[s[1]++],i[a]=e,a++;break;case 2:s[0]=o,s[1]=s[0]+t.width,s[2]=s[1]+t.width,o=s[2]+t.width;for(let r=0;r<t.width;++r)e+=n[s[0]++]<<24|n[s[1]++]<<16|n[s[2]++]<<8,i[a]=e,a++}}return new DataView(i.buffer)};break;case"DWAA_COMPRESSION":ft=32,ht=X;break;case"DWAB_COMPRESSION":ft=256,ht=X;break;default:throw"EXRLoader.parse: "+st.compression+" is unsupported"}var gt=st.channels[0].pixelType;if(1===gt)switch(this.type){case THREE.UnsignedByteType:case THREE.FloatType:yt=function(t,e){return nt(rt(t,e))},mt=h;break;case THREE.HalfFloatType:yt=rt,mt=h}else{if(2!==gt)throw"EXRLoader.parse: unsupported pixelType "+gt+" for "+st.compression+".";switch(this.type){case THREE.UnsignedByteType:case THREE.FloatType:yt=et,mt=p;break;case THREE.HalfFloatType:yt=function(t,e){return THREE.DataUtils.toHalfFloat(et(t,e))},mt=p}}for(var vt=_t/ft,bt=0;bt<vt;bt++)Q(ot,lt);var xt=st.dataWindow.xMax-st.dataWindow.xMin+1,wt=st.dataWindow.yMax-st.dataWindow.yMin+1,Et=xt*wt*4;switch(this.type){case THREE.UnsignedByteType:case THREE.FloatType:var Tt=new Float32Array(Et);st.channels.length<4&&Tt.fill(1,0,Et);break;case THREE.HalfFloatType:Tt=new Uint16Array(Et),st.channels.length<4&&Tt.fill(15360,0,Et);break;default:console.error("THREE.EXRLoader: unsupported type: ",this.type)}for(var St,Mt,jt={R:0,G:1,B:2,A:3},Ct={size:0,width:xt,lines:ft,offset:lt,array:at,viewer:ot,type:gt,channels:st.channels.length},zt={value:0},Rt=0;Rt<wt/ft;Rt++){St=J(ot,lt),Et=J(ot,lt),Ct.lines=St+ft>wt?wt-St:ft,Ct.offset=lt,Ct.size=Et,Mt=ht(Ct),lt.value+=Et;for(var At=0;At<ft;At++){var Lt=At+Rt*ft;if(Lt>=wt)break;for(var It=0;It<st.channels.length;It++)for(var Pt=jt[st.channels[It].name],Ot=0;Ot<xt;Ot++){var kt=At*(st.channels.length*xt)+It*xt+Ot;zt.value=kt*mt;var Bt=yt(Mt,zt);Tt[4*xt*(wt-1-Lt)+4*Ot+Pt]=Bt}}}if(this.type===THREE.UnsignedByteType){let t,e;const n=Tt.length,r=new Uint8Array(n);for(let n=0;n<wt;++n)for(let i=0;i<xt;++i){const o=Tt[e=n*xt*4+4*i],a=Tt[e+1],s=Tt[e+2];if((t=s>(t=o>a?o:a)?s:t)<1e-32)r[e]=r[e+1]=r[e+2]=r[e+3]=0;else{const n=w(t);t=256*n[0]/t,r[e]=o*t,r[e+1]=a*t,r[e+2]=s*t,r[e+3]=n[1]+128}}Tt=r}const Dt=this.type===THREE.UnsignedByteType?THREE.RGBEFormat:THREE.RGBAFormat;return{header:st,width:xt,height:wt,data:Tt,format:Dt,type:this.type}},setDataType:function(t){return this.type=t,this},load:function(t,e,n,r){return THREE.DataTextureLoader.prototype.load.call(this,t,function(t,n){switch(t.type){case THREE.UnsignedByteType:t.encoding=THREE.RGBEEncoding,t.minFilter=THREE.NearestFilter,t.magFilter=THREE.NearestFilter,t.generateMipmaps=!1,t.flipY=!1;break;case THREE.FloatType:case THREE.HalfFloatType:t.encoding=THREE.LinearEncoding,t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,t.generateMipmaps=!1,t.flipY=!1}e&&e(t,n)},n,r)}}),THREE.SceneUtils={createMeshesFromInstancedMesh:function(t){for(var e=new THREE.Group,n=t.count,r=t.geometry,i=t.material,o=0;o<n;o++){var a=new THREE.Mesh(r,i);t.getMatrixAt(o,a.matrix),a.matrix.decompose(a.position,a.quaternion,a.scale),e.add(a)}return e.copy(t),e.updateMatrixWorld(),e},createMultiMaterialObject:function(t,e){for(var n=new THREE.Group,r=0,i=e.length;r<i;r++)n.add(new THREE.Mesh(t,e[r]));return n},detach:function(t,e,n){console.warn("THREE.SceneUtils: detach() has been deprecated. Use scene.attach( child ) instead."),n.attach(t)},attach:function(t,e,n){console.warn("THREE.SceneUtils: attach() has been deprecated. Use parent.attach( child ) instead."),n.attach(t)}},THREE.BufferGeometryUtils={computeTangents:function(t){t.computeTangents(),console.warn("THREE.BufferGeometryUtils: .computeTangents() has been removed. Use BufferGeometry.computeTangents() instead.")},mergeBufferGeometries:function(t,e){for(var n=null!==t[0].index,r=new Set(Object.keys(t[0].attributes)),i=new Set(Object.keys(t[0].morphAttributes)),o={},a={},s=t[0].morphTargetsRelative,l=new THREE.BufferGeometry,c=0,u=0;u<t.length;++u){var p=t[u],d=0;if(n!==(null!==p.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(var h in p.attributes){if(!r.has(h))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+h+'" attribute exists among all geometries, or in none of them.'),null;void 0===o[h]&&(o[h]=[]),o[h].push(p.attributes[h]),d++}if(d!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(s!==p.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(var h in p.morphAttributes){if(!i.has(h))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===a[h]&&(a[h]=[]),a[h].push(p.morphAttributes[h])}if(l.userData.mergedUserData=l.userData.mergedUserData||[],l.userData.mergedUserData.push(p.userData),e){var f;if(n)f=p.index.count;else{if(void 0===p.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;f=p.attributes.position.count}l.addGroup(c,f,u),c+=f}}if(n){var m=0,y=[];for(u=0;u<t.length;++u){for(var _=t[u].index,g=0;g<_.count;++g)y.push(_.getX(g)+m);m+=t[u].attributes.position.count}l.setIndex(y)}for(var h in o){var v=this.mergeBufferAttributes(o[h]);if(!v)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" attribute."),null;l.setAttribute(h,v)}for(var h in a){var b=a[h][0].length;if(0===b)break;for(l.morphAttributes=l.morphAttributes||{},l.morphAttributes[h]=[],u=0;u<b;++u){var x=[];for(g=0;g<a[h].length;++g)x.push(a[h][g][u]);var w=this.mergeBufferAttributes(x);if(!w)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" morphAttribute."),null;l.morphAttributes[h].push(w)}}return l},mergeBufferAttributes:function(t){for(var e,n,r,i=0,o=0;o<t.length;++o){var a=t[o];if(a.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===e&&(e=a.array.constructor),e!==a.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===n&&(n=a.itemSize),n!==a.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===r&&(r=a.normalized),r!==a.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;i+=a.array.length}var s=new e(i),l=0;for(o=0;o<t.length;++o)s.set(t[o].array,l),l+=t[o].array.length;return new THREE.BufferAttribute(s,n,r)},interleaveAttributes:function(t){for(var e,n=0,r=0,i=0,o=t.length;i<o;++i){var a=t[i];if(void 0===e&&(e=a.array.constructor),e!==a.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;n+=a.array.length,r+=a.itemSize}var s=new THREE.InterleavedBuffer(new e(n),r),l=0,c=[],u=["getX","getY","getZ","getW"],p=["setX","setY","setZ","setW"],d=0;for(o=t.length;d<o;d++){var h=(a=t[d]).itemSize,f=a.count,m=new THREE.InterleavedBufferAttribute(s,h,l,a.normalized);c.push(m),l+=h;for(var y=0;y<f;y++)for(var _=0;_<h;_++)m[p[_]](y,a[u[_]](y))}return c},estimateBytesUsed:function(t){var e=0;for(var n in t.attributes){var r=t.getAttribute(n);e+=r.count*r.itemSize*r.array.BYTES_PER_ELEMENT}var i=t.getIndex();return e+(i?i.count*i.itemSize*i.array.BYTES_PER_ELEMENT:0)},mergeVertices:function(t,e=1e-4){e=Math.max(e,Number.EPSILON);for(var n={},r=t.getIndex(),i=t.getAttribute("position"),o=r?r.count:i.count,a=0,s=Object.keys(t.attributes),l={},c={},u=[],p=["getX","getY","getZ","getW"],d=0,h=s.length;d<h;d++)l[v=s[d]]=[],(E=t.morphAttributes[v])&&(c[v]=new Array(E.length).fill().map(()=>[]));var f=Math.log10(1/e),m=Math.pow(10,f);for(d=0;d<o;d++){var y=r?r.getX(d):d,_="",g=0;for(h=s.length;g<h;g++)for(var v=s[g],b=(w=t.getAttribute(v)).itemSize,x=0;x<b;x++)_+=`${~~(w[p[x]](y)*m)},`;if(_ in n)u.push(n[_]);else{for(g=0,h=s.length;g<h;g++){v=s[g];var w=t.getAttribute(v),E=t.morphAttributes[v],T=(b=w.itemSize,l[v]),S=c[v];for(x=0;x<b;x++){var M=p[x];if(T.push(w[M](y)),E)for(var j=0,C=E.length;j<C;j++)S[j].push(E[j][M](y))}}n[_]=a,u.push(a),a++}}const z=t.clone();for(d=0,h=s.length;d<h;d++){v=s[d];var R=t.getAttribute(v),A=new R.array.constructor(l[v]);if(w=new THREE.BufferAttribute(A,R.itemSize,R.normalized),z.setAttribute(v,w),v in c)for(g=0;g<c[v].length;g++){var L=t.morphAttributes[v][g],I=(A=new L.array.constructor(c[v][g]),new THREE.BufferAttribute(A,L.itemSize,L.normalized));z.morphAttributes[v][g]=I}}return z.setIndex(u),z},toTrianglesDrawMode:function(t,e){if(e===THREE.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(e===THREE.TriangleFanDrawMode||e===THREE.TriangleStripDrawMode){var n=t.getIndex();if(null===n){var r=[],i=t.getAttribute("position");if(void 0===i)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(var o=0;o<i.count;o++)r.push(o);t.setIndex(r),n=t.getIndex()}var a=n.count-2,s=[];if(e===THREE.TriangleFanDrawMode)for(o=1;o<=a;o++)s.push(n.getX(0)),s.push(n.getX(o)),s.push(n.getX(o+1));else for(o=0;o<a;o++)o%2==0?(s.push(n.getX(o)),s.push(n.getX(o+1)),s.push(n.getX(o+2))):(s.push(n.getX(o+2)),s.push(n.getX(o+1)),s.push(n.getX(o)));s.length/3!==a&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var l=t.clone();return l.setIndex(s),l.clearGroups(),l}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),t},computeMorphedAttributes:function(t){if(!0!==t.geometry.isBufferGeometry)return console.error("THREE.BufferGeometryUtils: Geometry is not of type THREE.BufferGeometry."),null;var e=new THREE.Vector3,n=new THREE.Vector3,r=new THREE.Vector3,i=new THREE.Vector3,o=new THREE.Vector3,a=new THREE.Vector3,s=new THREE.Vector3,l=new THREE.Vector3,c=new THREE.Vector3;function u(t,u,p,d,h,f,m,y,_){e.fromBufferAttribute(p,f),n.fromBufferAttribute(p,m),r.fromBufferAttribute(p,y);var g=t.morphTargetInfluences;if(u.morphTargets&&d&&g){s.set(0,0,0),l.set(0,0,0),c.set(0,0,0);for(var v=0,b=d.length;v<b;v++){var x=g[v],w=d[v];0!==x&&(i.fromBufferAttribute(w,f),o.fromBufferAttribute(w,m),a.fromBufferAttribute(w,y),h?(s.addScaledVector(i,x),l.addScaledVector(o,x),c.addScaledVector(a,x)):(s.addScaledVector(i.sub(e),x),l.addScaledVector(o.sub(n),x),c.addScaledVector(a.sub(r),x)))}e.add(s),n.add(l),r.add(c)}t.isSkinnedMesh&&(t.boneTransform(f,e),t.boneTransform(m,n),t.boneTransform(y,r)),_[3*f+0]=e.x,_[3*f+1]=e.y,_[3*f+2]=e.z,_[3*m+0]=n.x,_[3*m+1]=n.y,_[3*m+2]=n.z,_[3*y+0]=r.x,_[3*y+1]=r.y,_[3*y+2]=r.z}var p,d,h,f,m,y,_,g,v,b=t.geometry,x=t.material,w=b.index,E=b.attributes.position,T=b.morphAttributes.position,S=b.morphTargetsRelative,M=b.attributes.normal,j=b.morphAttributes.position,C=b.groups,z=b.drawRange,R=new Float32Array(E.count*E.itemSize),A=new Float32Array(M.count*M.itemSize);if(null!==w)if(Array.isArray(x))for(f=0,y=C.length;f<y;f++)for(v=x[(g=C[f]).materialIndex],m=Math.max(g.start,z.start),_=Math.min(g.start+g.count,z.start+z.count);m<_;m+=3)u(t,v,E,T,S,p=w.getX(m),d=w.getX(m+1),h=w.getX(m+2),R),u(t,v,M,j,S,p,d,h,A);else for(f=Math.max(0,z.start),y=Math.min(w.count,z.start+z.count);f<y;f+=3)u(t,x,E,T,S,p=w.getX(f),d=w.getX(f+1),h=w.getX(f+2),R),u(t,x,M,j,S,p,d,h,A);else if(void 0!==E)if(Array.isArray(x))for(f=0,y=C.length;f<y;f++)for(v=x[(g=C[f]).materialIndex],m=Math.max(g.start,z.start),_=Math.min(g.start+g.count,z.start+z.count);m<_;m+=3)u(t,v,E,T,S,p=m,d=m+1,h=m+2,R),u(t,v,M,j,S,p,d,h,A);else for(f=Math.max(0,z.start),y=Math.min(E.count,z.start+z.count);f<y;f+=3)u(t,x,E,T,S,p=f,d=f+1,h=f+2,R),u(t,x,M,j,S,p,d,h,A);return{positionAttribute:E,normalAttribute:M,morphedPositionAttribute:new THREE.Float32BufferAttribute(R,3),morphedNormalAttribute:new THREE.Float32BufferAttribute(A,3)}}},THREE.SkeletonUtils={retarget:function(){var t=new THREE.Vector3,e=new THREE.Quaternion,n=new THREE.Vector3,r=new THREE.Matrix4,i=new THREE.Matrix4,o=new THREE.Matrix4;return function(a,s,l){(l=l||{}).preserveMatrix=void 0===l.preserveMatrix||l.preserveMatrix,l.preservePosition=void 0===l.preservePosition||l.preservePosition,l.preserveHipPosition=void 0!==l.preserveHipPosition&&l.preserveHipPosition,l.useTargetMatrix=void 0!==l.useTargetMatrix&&l.useTargetMatrix,l.hip=void 0!==l.hip?l.hip:"hip",l.names=l.names||{};var c,u,p,d,h,f,m=s.isObject3D?s.skeleton.bones:this.getBones(s),y=a.isObject3D?a.skeleton.bones:this.getBones(a);if(a.isObject3D?a.skeleton.pose():(l.useTargetMatrix=!0,l.preserveMatrix=!1),l.preservePosition)for(h=[],f=0;f<y.length;f++)h.push(y[f].position.clone());if(l.preserveMatrix)for(a.updateMatrixWorld(),a.matrixWorld.identity(),f=0;f<a.children.length;++f)a.children[f].updateMatrixWorld(!0);if(l.offsets)for(c=[],f=0;f<y.length;++f)u=y[f],p=l.names[u.name]||u.name,l.offsets&&l.offsets[p]&&(u.matrix.multiply(l.offsets[p]),u.matrix.decompose(u.position,u.quaternion,u.scale),u.updateMatrixWorld()),c.push(u.matrixWorld.clone());for(f=0;f<y.length;++f){if(u=y[f],p=l.names[u.name]||u.name,d=this.getBoneByName(p,m),o.copy(u.matrixWorld),d){if(d.updateMatrixWorld(),l.useTargetMatrix?i.copy(d.matrixWorld):(i.copy(a.matrixWorld).invert(),i.multiply(d.matrixWorld)),n.setFromMatrixScale(i),i.scale(n.set(1/n.x,1/n.y,1/n.z)),o.makeRotationFromQuaternion(e.setFromRotationMatrix(i)),a.isObject3D){var _=y.indexOf(u),g=c?c[_]:r.copy(a.skeleton.boneInverses[_]).invert();o.multiply(g)}o.copyPosition(i)}u.parent&&u.parent.isBone?(u.matrix.copy(u.parent.matrixWorld).invert(),u.matrix.multiply(o)):u.matrix.copy(o),l.preserveHipPosition&&p===l.hip&&u.matrix.setPosition(t.set(0,u.position.y,0)),u.matrix.decompose(u.position,u.quaternion,u.scale),u.updateMatrixWorld()}if(l.preservePosition)for(f=0;f<y.length;++f)u=y[f],(p=l.names[u.name]||u.name)!==l.hip&&u.position.copy(h[f]);l.preserveMatrix&&a.updateMatrixWorld(!0)}}(),retargetClip:function(t,e,n,r){(r=r||{}).useFirstFramePosition=void 0!==r.useFirstFramePosition&&r.useFirstFramePosition,r.fps=void 0!==r.fps?r.fps:30,r.names=r.names||[],e.isObject3D||(e=this.getHelperFromSkeleton(e));var i,o,a,s,l,c,u=Math.round(n.duration*(r.fps/1e3)*1e3),p=1/r.fps,d=[],h=new THREE.AnimationMixer(e),f=this.getBones(t.skeleton),m=[];for(h.clipAction(n).play(),h.update(0),e.updateMatrixWorld(),l=0;l<u;++l){var y=l*p;for(this.retarget(t,e,r),c=0;c<f.length;++c)s=r.names[f[c].name]||f[c].name,this.getBoneByName(s,e.skeleton)&&(o=f[c],a=m[c]=m[c]||{bone:o},r.hip===s&&(a.pos||(a.pos={times:new Float32Array(u),values:new Float32Array(3*u)}),r.useFirstFramePosition&&(0===l&&(i=o.position.clone()),o.position.sub(i)),a.pos.times[l]=y,o.position.toArray(a.pos.values,3*l)),a.quat||(a.quat={times:new Float32Array(u),values:new Float32Array(4*u)}),a.quat.times[l]=y,o.quaternion.toArray(a.quat.values,4*l));h.update(p),e.updateMatrixWorld()}for(l=0;l<m.length;++l)(a=m[l])&&(a.pos&&d.push(new THREE.VectorKeyframeTrack(".bones["+a.bone.name+"].position",a.pos.times,a.pos.values)),d.push(new THREE.QuaternionKeyframeTrack(".bones["+a.bone.name+"].quaternion",a.quat.times,a.quat.values)));return h.uncacheAction(n),new THREE.AnimationClip(n.name,-1,d)},getHelperFromSkeleton:function(t){var e=new THREE.SkeletonHelper(t.bones[0]);return e.skeleton=t,e},getSkeletonOffsets:(l=new THREE.Vector3,c=new THREE.Vector3,u=new THREE.Vector3,d=new THREE.Vector3,h=new THREE.Vector2,f=new THREE.Vector2,function(t,e,n){(n=n||{}).hip=void 0!==n.hip?n.hip:"hip",n.names=n.names||{},e.isObject3D||(e=this.getHelperFromSkeleton(e));var r,i,o,a,s=Object.keys(n.names),p=Object.values(n.names),m=e.isObject3D?e.skeleton.bones:this.getBones(e),y=t.isObject3D?t.skeleton.bones:this.getBones(t),_=[];for(t.skeleton.pose(),a=0;a<y.length;++a)if(r=y[a],o=n.names[r.name]||r.name,(i=this.getBoneByName(o,m))&&o!==n.hip){var g=this.getNearestBone(r.parent,s),v=this.getNearestBone(i.parent,p);g.updateMatrixWorld(),v.updateMatrixWorld(),l.setFromMatrixPosition(g.matrixWorld),c.setFromMatrixPosition(r.matrixWorld),u.setFromMatrixPosition(v.matrixWorld),d.setFromMatrixPosition(i.matrixWorld),h.subVectors(new THREE.Vector2(c.x,c.y),new THREE.Vector2(l.x,l.y)).normalize(),f.subVectors(new THREE.Vector2(d.x,d.y),new THREE.Vector2(u.x,u.y)).normalize();var b=h.angle()-f.angle(),x=(new THREE.Matrix4).makeRotationFromEuler(new THREE.Euler(0,0,b));r.matrix.multiply(x),r.matrix.decompose(r.position,r.quaternion,r.scale),r.updateMatrixWorld(),_[o]=x}return _}),renameBones:function(t,e){for(var n=this.getBones(t),r=0;r<n.length;++r){var i=n[r];e[i.name]&&(i.name=e[i.name])}return this},getBones:function(t){return Array.isArray(t)?t:t.bones},getBoneByName:function(t,e){for(var n=0,r=this.getBones(e);n<r.length;n++)if(t===r[n].name)return r[n]},getNearestBone:function(t,e){for(;t.isBone;){if(-1!==e.indexOf(t.name))return t;t=t.parent}},findBoneTrackData:function(t,e){for(var n=/\[(.*)\]\.(.*)/,r={name:t},i=0;i<e.length;++i){var o=n.exec(e[i].name);o&&t===o[1]&&(r[o[2]]=i)}return r},getEqualsBonesNames:function(t,e){var n=this.getBones(t),r=this.getBones(e),i=[];t:for(var o=0;o<n.length;o++)for(var a=n[o].name,s=0;s<r.length;s++)if(a===r[s].name){i.push(a);continue t}return i},clone:function(t){var e=new Map,n=new Map,r=t.clone();return function t(e,n,r){r(e,n);for(var i=0;i<e.children.length;i++)t(e.children[i],n.children[i],r)}(t,r,function(t,r){e.set(r,t),n.set(t,r)}),r.traverse(function(t){if(t.isSkinnedMesh){var r=t,i=e.get(t),o=i.skeleton.bones;r.skeleton=i.skeleton.clone(),r.bindMatrix.copy(i.bindMatrix),r.skeleton.bones=o.map(function(t){return n.get(t)}),r.bind(r.skeleton,r.bindMatrix)}}),r}},function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.dat=e():t.dat=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t:{default:t}}(n(1));t.exports=r.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(2)),o=r(n(6)),a=r(n(3)),s=r(n(7)),l=r(n(8)),c=r(n(10)),u=r(n(11)),p=r(n(12)),d=r(n(13)),h=r(n(14)),f=r(n(15)),m=r(n(16)),y=r(n(9)),_=r(n(17));e.default={color:{Color:i.default,math:o.default,interpret:a.default},controllers:{Controller:s.default,BooleanController:l.default,OptionController:c.default,StringController:u.default,NumberController:p.default,NumberControllerBox:d.default,NumberControllerSlider:h.default,FunctionController:f.default,ColorController:m.default},dom:{dom:y.default},gui:{GUI:_.default},GUI:_.default}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(u.recalculateRGB(this,e,n),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(u.recalculateRGB(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function o(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(u.recalculateHSV(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(u.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=t}})}e.__esModule=!0;var a=r(n(3)),s=r(n(6)),l=r(n(4)),c=r(n(5)),u=function(){function t(){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.__state=a.default.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return t.prototype.toString=function(){return(0,l.default)(this)},t.prototype.toHexString=function(){return(0,l.default)(this,!0)},t.prototype.toOriginal=function(){return this.__state.conversion.write(this)},t}();u.recalculateRGB=function(t,e,n){if("HEX"===t.__state.space)t.__state[e]=s.default.component_from_hex(t.__state.hex,n);else{if("HSV"!==t.__state.space)throw new Error("Corrupted color state");c.default.extend(t.__state,s.default.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}},u.recalculateHSV=function(t){var e=s.default.rgb_to_hsv(t.r,t.g,t.b);c.default.extend(t.__state,{s:e.s,v:e.v}),c.default.isNaN(e.h)?c.default.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=e.h},u.COMPONENTS=["r","g","b","h","s","v","hex","a"],i(u.prototype,"r",2),i(u.prototype,"g",1),i(u.prototype,"b",0),o(u.prototype,"h"),o(u.prototype,"s"),o(u.prototype,"v"),Object.defineProperty(u.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(u.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=s.default.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}}),e.default=u},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(4)),o=r(n(5)),a=[{litmus:o.default.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString(),0)}},write:i.default},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString(),0)}},write:i.default},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:i.default},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:i.default}}},{litmus:o.default.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:o.default.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:o.default.isObject,conversions:{RGBA_OBJ:{read:function(t){return!!(o.default.isNumber(t.r)&&o.default.isNumber(t.g)&&o.default.isNumber(t.b)&&o.default.isNumber(t.a))&&{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return!!(o.default.isNumber(t.r)&&o.default.isNumber(t.g)&&o.default.isNumber(t.b))&&{space:"RGB",r:t.r,g:t.g,b:t.b}},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return!!(o.default.isNumber(t.h)&&o.default.isNumber(t.s)&&o.default.isNumber(t.v)&&o.default.isNumber(t.a))&&{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return!!(o.default.isNumber(t.h)&&o.default.isNumber(t.s)&&o.default.isNumber(t.v))&&{space:"HSV",h:t.h,s:t.s,v:t.v}},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}],s=void 0,l=void 0;e.default=function(){l=!1;var t=arguments.length>1?o.default.toArray(arguments):arguments[0];return o.default.each(a,function(e){if(e.litmus(t))return o.default.each(e.conversions,function(e,n){if(s=e.read(t),!1===l&&!1!==s)return l=s,s.conversionName=n,s.conversion=e,o.default.BREAK}),o.default.BREAK}),l}},function(t,e){"use strict";e.__esModule=!0,e.default=function(t,e){var n=t.__state.conversionName.toString(),r=Math.round(t.r),i=Math.round(t.g),o=Math.round(t.b),a=t.a,s=Math.round(t.h),l=t.s.toFixed(1),c=t.v.toFixed(1);if(e||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var u=t.hex.toString(16);u.length<6;)u="0"+u;return"#"+u}return"CSS_RGB"===n?"rgb("+r+","+i+","+o+")":"CSS_RGBA"===n?"rgba("+r+","+i+","+o+","+a+")":"HEX"===n?"0x"+t.hex.toString(16):"RGB_ARRAY"===n?"["+r+","+i+","+o+"]":"RGBA_ARRAY"===n?"["+r+","+i+","+o+","+a+"]":"RGB_OBJ"===n?"{r:"+r+",g:"+i+",b:"+o+"}":"RGBA_OBJ"===n?"{r:"+r+",g:"+i+",b:"+o+",a:"+a+"}":"HSV_OBJ"===n?"{h:"+s+",s:"+l+",v:"+c+"}":"HSVA_OBJ"===n?"{h:"+s+",s:"+l+",v:"+c+",a:"+a+"}":"unknown format"}},function(t,e){"use strict";e.__esModule=!0;var n=Array.prototype.forEach,r=Array.prototype.slice,i={BREAK:{},extend:function(t){return this.each(r.call(arguments,1),function(e){(this.isObject(e)?Object.keys(e):[]).forEach(function(n){this.isUndefined(e[n])||(t[n]=e[n])}.bind(this))},this),t},defaults:function(t){return this.each(r.call(arguments,1),function(e){(this.isObject(e)?Object.keys(e):[]).forEach(function(n){this.isUndefined(t[n])&&(t[n]=e[n])}.bind(this))},this),t},compose:function(){var t=r.call(arguments);return function(){for(var e=r.call(arguments),n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},each:function(t,e,r){if(t)if(n&&t.forEach&&t.forEach===n)t.forEach(e,r);else if(t.length===t.length+0){var i,o=void 0;for(o=0,i=t.length;o<i;o++)if(o in t&&e.call(r,t[o],o)===this.BREAK)return}else for(var a in t)if(e.call(r,t[a],a)===this.BREAK)return},defer:function(t){setTimeout(t,0)},debounce:function(t,e){var n=void 0;return function(){var r=arguments,i=!n;clearTimeout(n),n=setTimeout(function(){n=null},e),i&&t.apply(this,r)}},toArray:function(t){return t.toArray?t.toArray():r.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return isNaN(t)}),isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return!1===t||!0===t},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}};e.default=i},function(t,e){"use strict";e.__esModule=!0;var n=void 0,r={hsv_to_rgb:function(t,e,n){var r=Math.floor(t/60)%6,i=t/60-Math.floor(t/60),o=n*(1-e),a=n*(1-i*e),s=n*(1-(1-i)*e),l=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][r];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(t,e,n){var r=Math.min(t,e,n),i=Math.max(t,e,n),o=i-r,a=void 0;return 0===i?{h:NaN,s:0,v:0}:(a=t===i?(e-n)/o:e===i?2+(n-t)/o:4+(t-e)/o,(a/=6)<0&&(a+=1),{h:360*a,s:o/i,v:i/255})},rgb_to_hex:function(t,e,n){var r=this.hex_with_component(0,2,t);return r=this.hex_with_component(r,1,e),this.hex_with_component(r,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(t,e,r){return r<<(n=8*e)|t&~(255<<n)}};e.default=r},function(t,e){"use strict";e.__esModule=!0;var n=function(){function t(e,n){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.initialValue=e[n],this.domElement=document.createElement("div"),this.object=e,this.property=n,this.__onChange=void 0,this.__onFinishChange=void 0}return t.prototype.onChange=function(t){return this.__onChange=t,this},t.prototype.onFinishChange=function(t){return this.__onFinishChange=t,this},t.prototype.setValue=function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this},t.prototype.getValue=function(){return this.object[this.property]},t.prototype.updateDisplay=function(){return this},t.prototype.isModified=function(){return this.initialValue!==this.getValue()},t}();e.default=n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(7)),o=r(n(9)),a=function(t){function e(n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r)),a=i;return i.__prev=i.getValue(),i.__checkbox=document.createElement("input"),i.__checkbox.setAttribute("type","checkbox"),o.default.bind(i.__checkbox,"change",function(){a.setValue(!a.__prev)},!1),i.domElement.appendChild(i.__checkbox),i.updateDisplay(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setValue=function(e){var n=t.prototype.setValue.call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n},e.prototype.updateDisplay=function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,t.prototype.updateDisplay.call(this)},e}(i.default);e.default=a},function(t,e,n){"use strict";function r(t){if("0"===t||i.default.isUndefined(t))return 0;var e=t.match(a);return i.default.isNull(e)?0:parseFloat(e[1])}e.__esModule=!0;var i=function(t){return t&&t.__esModule?t:{default:t}}(n(5)),o={};i.default.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(t,e){i.default.each(t,function(t){o[t]=e})});var a=/(\d+(\.\d+)?)px/,s={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(t,e,n){var r=n,o=e;i.default.isUndefined(o)&&(o=!0),i.default.isUndefined(r)&&(r=!0),t.style.position="absolute",o&&(t.style.left=0,t.style.right=0),r&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,e,n,r){var a=n||{},s=o[e];if(!s)throw new Error("Event type "+e+" not supported.");var l=document.createEvent(s);switch(s){case"MouseEvents":var c=a.x||a.clientX||0,u=a.y||a.clientY||0;l.initMouseEvent(e,a.bubbles||!1,a.cancelable||!0,window,a.clickCount||1,0,0,c,u,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var p=l.initKeyboardEvent||l.initKeyEvent;i.default.defaults(a,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),p(e,a.bubbles||!1,a.cancelable,window,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.keyCode,a.charCode);break;default:l.initEvent(e,a.bubbles||!1,a.cancelable||!0)}i.default.defaults(l,r),t.dispatchEvent(l)},bind:function(t,e,n,r){var i=r||!1;return t.addEventListener?t.addEventListener(e,n,i):t.attachEvent&&t.attachEvent("on"+e,n),s},unbind:function(t,e,n,r){var i=r||!1;return t.removeEventListener?t.removeEventListener(e,n,i):t.detachEvent&&t.detachEvent("on"+e,n),s},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var n=t.className.split(/ +/);-1===n.indexOf(e)&&(n.push(e),t.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return s},removeClass:function(t,e){if(e)if(t.className===e)t.removeAttribute("class");else{var n=t.className.split(/ +/),r=n.indexOf(e);-1!==r&&(n.splice(r,1),t.className=n.join(" "))}else t.className=void 0;return s},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var e=getComputedStyle(t);return r(e["border-left-width"])+r(e["border-right-width"])+r(e["padding-left"])+r(e["padding-right"])+r(e.width)},getHeight:function(t){var e=getComputedStyle(t);return r(e["border-top-width"])+r(e["border-bottom-width"])+r(e["padding-top"])+r(e["padding-bottom"])+r(e.height)},getOffset:function(t){var e=t,n={left:0,top:0};if(e.offsetParent)do{n.left+=e.offsetLeft,n.top+=e.offsetTop,e=e.offsetParent}while(e);return n},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}};e.default=s},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(7)),o=r(n(9)),a=r(n(5)),s=function(t){function e(n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r)),l=i,c=s;return s.__select=document.createElement("select"),a.default.isArray(l)&&function(){var t={};a.default.each(l,function(e){t[e]=e}),l=t}(),a.default.each(l,function(t,e){var n=document.createElement("option");n.innerHTML=e,n.setAttribute("value",t),c.__select.appendChild(n)}),s.updateDisplay(),o.default.bind(s.__select,"change",function(){var t=this.options[this.selectedIndex].value;c.setValue(t)}),s.domElement.appendChild(s.__select),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setValue=function(e){var n=t.prototype.setValue.call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n},e.prototype.updateDisplay=function(){return o.default.isActive(this.__select)?this:(this.__select.value=this.getValue(),t.prototype.updateDisplay.call(this))},e}(i.default);e.default=s},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(7)),o=r(n(9)),a=function(t){function e(n,r){function i(){s.setValue(s.__input.value)}!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r)),s=a;return a.__input=document.createElement("input"),a.__input.setAttribute("type","text"),o.default.bind(a.__input,"keyup",i),o.default.bind(a.__input,"change",i),o.default.bind(a.__input,"blur",function(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}),o.default.bind(a.__input,"keydown",function(t){13===t.keyCode&&this.blur()}),a.updateDisplay(),a.domElement.appendChild(a.__input),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateDisplay=function(){return o.default.isActive(this.__input)||(this.__input.value=this.getValue()),t.prototype.updateDisplay.call(this)},e}(i.default);e.default=a},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){var e=t.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}e.__esModule=!0;var o=r(n(7)),a=r(n(5)),s=function(t){function e(n,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r)),l=o||{};return s.__min=l.min,s.__max=l.max,s.__step=l.step,a.default.isUndefined(s.__step)?0===s.initialValue?s.__impliedStep=1:s.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(s.initialValue))/Math.LN10))/10:s.__impliedStep=s.__step,s.__precision=i(s.__impliedStep),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setValue=function(e){var n=e;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),t.prototype.setValue.call(this,n)},e.prototype.min=function(t){return this.__min=t,this},e.prototype.max=function(t){return this.__max=t,this},e.prototype.step=function(t){return this.__step=t,this.__impliedStep=t,this.__precision=i(t),this},e}(o.default);e.default=s},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(12)),o=r(n(9)),a=r(n(5)),s=function(t){function e(n,r,i){function s(){p.__onFinishChange&&p.__onFinishChange.call(p,p.getValue())}function l(t){var e=d-t.clientY;p.setValue(p.getValue()+e*p.__impliedStep),d=t.clientY}function c(){o.default.unbind(window,"mousemove",l),o.default.unbind(window,"mouseup",c),s()}!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r,i));u.__truncationSuspended=!1;var p=u,d=void 0;return u.__input=document.createElement("input"),u.__input.setAttribute("type","text"),o.default.bind(u.__input,"change",function(){var t=parseFloat(p.__input.value);a.default.isNaN(t)||p.setValue(t)}),o.default.bind(u.__input,"blur",function(){s()}),o.default.bind(u.__input,"mousedown",function(t){o.default.bind(window,"mousemove",l),o.default.bind(window,"mouseup",c),d=t.clientY}),o.default.bind(u.__input,"keydown",function(t){13===t.keyCode&&(p.__truncationSuspended=!0,this.blur(),p.__truncationSuspended=!1,s())}),u.updateDisplay(),u.domElement.appendChild(u.__input),u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateDisplay=function(){return this.__input.value=this.__truncationSuspended?this.getValue():function(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}(this.getValue(),this.__precision),t.prototype.updateDisplay.call(this)},e}(i.default);e.default=s},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(12)),o=r(n(9)),a=function(t){function e(n,r,i,a,s){function l(t){t.preventDefault();var e=p.__background.getBoundingClientRect();return p.setValue(function(t,e,n,r,i){return r+(t-e)/(n-e)*(p.__max-r)}(t.clientX,e.left,e.right,p.__min)),!1}function c(){o.default.unbind(window,"mousemove",l),o.default.unbind(window,"mouseup",c),p.__onFinishChange&&p.__onFinishChange.call(p,p.getValue())}!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r,{min:i,max:a,step:s})),p=u;return u.__background=document.createElement("div"),u.__foreground=document.createElement("div"),o.default.bind(u.__background,"mousedown",function(t){document.activeElement.blur(),o.default.bind(window,"mousemove",l),o.default.bind(window,"mouseup",c),l(t)}),o.default.addClass(u.__background,"slider"),o.default.addClass(u.__foreground,"slider-fg"),u.updateDisplay(),u.__background.appendChild(u.__foreground),u.domElement.appendChild(u.__background),u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateDisplay=function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",t.prototype.updateDisplay.call(this)},e}(i.default);e.default=a},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(7)),o=r(n(9)),a=function(t){function e(n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r)),s=a;return a.__button=document.createElement("div"),a.__button.innerHTML=void 0===i?"Fire":i,o.default.bind(a.__button,"click",function(t){return t.preventDefault(),s.fire(),!1}),o.default.addClass(a.__button,"button"),a.domElement.appendChild(a.__button),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.fire=function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())},e}(i.default);e.default=a},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n,r){t.style.background="",c.default.each(p,function(i){t.style.cssText+="background: "+i+"linear-gradient("+e+", "+n+" 0%, "+r+" 100%); "})}e.__esModule=!0;var o=r(n(7)),a=r(n(9)),s=r(n(2)),l=r(n(3)),c=r(n(5)),u=function(t){function e(n,r){function o(t){f(t),a.default.bind(window,"mousemove",f),a.default.bind(window,"mouseup",u)}function u(){a.default.unbind(window,"mousemove",f),a.default.unbind(window,"mouseup",u),h()}function p(){var t=(0,l.default)(this.value);!1!==t?(_.__color.__state=t,_.setValue(_.__color.toOriginal())):this.value=_.__color.toString()}function d(){a.default.unbind(window,"mousemove",m),a.default.unbind(window,"mouseup",d),h()}function h(){_.__onFinishChange&&_.__onFinishChange.call(_,_.__color.toOriginal())}function f(t){t.preventDefault();var e=_.__saturation_field.getBoundingClientRect(),n=(t.clientX-e.left)/(e.right-e.left),r=1-(t.clientY-e.top)/(e.bottom-e.top);return r>1?r=1:r<0&&(r=0),n>1?n=1:n<0&&(n=0),_.__color.v=r,_.__color.s=n,_.setValue(_.__color.toOriginal()),!1}function m(t){t.preventDefault();var e=_.__hue_field.getBoundingClientRect(),n=1-(t.clientY-e.top)/(e.bottom-e.top);return n>1?n=1:n<0&&(n=0),_.__color.h=360*n,_.setValue(_.__color.toOriginal()),!1}!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var y=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r));y.__color=new s.default(y.getValue()),y.__temp=new s.default(0);var _=y;y.domElement=document.createElement("div"),a.default.makeSelectable(y.domElement,!1),y.__selector=document.createElement("div"),y.__selector.className="selector",y.__saturation_field=document.createElement("div"),y.__saturation_field.className="saturation-field",y.__field_knob=document.createElement("div"),y.__field_knob.className="field-knob",y.__field_knob_border="2px solid ",y.__hue_knob=document.createElement("div"),y.__hue_knob.className="hue-knob",y.__hue_field=document.createElement("div"),y.__hue_field.className="hue-field",y.__input=document.createElement("input"),y.__input.type="text",y.__input_textShadow="0 1px 1px ",a.default.bind(y.__input,"keydown",function(t){13===t.keyCode&&p.call(this)}),a.default.bind(y.__input,"blur",p),a.default.bind(y.__selector,"mousedown",function(){a.default.addClass(this,"drag").bind(window,"mouseup",function(){a.default.removeClass(_.__selector,"drag")})});var g=document.createElement("div");return c.default.extend(y.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),c.default.extend(y.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:y.__field_knob_border+(y.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),c.default.extend(y.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),c.default.extend(y.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),c.default.extend(g.style,{width:"100%",height:"100%",background:"none"}),i(g,"top","rgba(0,0,0,0)","#000"),c.default.extend(y.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),function(t){t.style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}(y.__hue_field),c.default.extend(y.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:y.__input_textShadow+"rgba(0,0,0,0.7)"}),a.default.bind(y.__saturation_field,"mousedown",o),a.default.bind(y.__field_knob,"mousedown",o),a.default.bind(y.__hue_field,"mousedown",function(t){m(t),a.default.bind(window,"mousemove",m),a.default.bind(window,"mouseup",d)}),y.__saturation_field.appendChild(g),y.__selector.appendChild(y.__field_knob),y.__selector.appendChild(y.__saturation_field),y.__selector.appendChild(y.__hue_field),y.__hue_field.appendChild(y.__hue_knob),y.domElement.appendChild(y.__input),y.domElement.appendChild(y.__selector),y.updateDisplay(),y}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateDisplay=function(){var t=(0,l.default)(this.getValue());if(!1!==t){var e=!1;c.default.each(s.default.COMPONENTS,function(n){if(!c.default.isUndefined(t[n])&&!c.default.isUndefined(this.__color.__state[n])&&t[n]!==this.__color.__state[n])return e=!0,{}},this),e&&c.default.extend(this.__color.__state,t)}c.default.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,r=255-n;c.default.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,i(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),c.default.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+r+","+r+","+r+",.7)"})},e}(o.default),p=["-moz-","-o-","-webkit-","-ms-",""];e.default=u},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n){var r=document.createElement("li");return e&&r.appendChild(e),n?t.__ul.insertBefore(r,n):t.__ul.appendChild(r),t.onResize(),r}function o(t,e){var n=t.__preset_select[t.__preset_select.selectedIndex];n.innerHTML=e?n.value+"*":n.value}function a(t,e,n){if(n.__li=e,n.__gui=t,j.default.extend(n,{options:function(e){if(arguments.length>1){var r=n.__li.nextElementSibling;return n.remove(),l(t,n.object,n.property,{before:r,factoryArgs:[j.default.toArray(arguments)]})}if(j.default.isArray(e)||j.default.isObject(e)){var i=n.__li.nextElementSibling;return n.remove(),l(t,n.object,n.property,{before:i,factoryArgs:[e]})}},name:function(t){return n.__li.firstElementChild.firstElementChild.innerHTML=t,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof w.default)!function(){var t=new x.default(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});j.default.each(["updateDisplay","onChange","onFinishChange","step"],function(e){var r=n[e],i=t[e];n[e]=t[e]=function(){var e=Array.prototype.slice.call(arguments);return i.apply(t,e),r.apply(n,e)}}),M.default.addClass(e,"has-slider"),n.domElement.insertBefore(t.domElement,n.domElement.firstElementChild)}();else if(n instanceof x.default){var r=function(e){if(j.default.isNumber(n.__min)&&j.default.isNumber(n.__max)){var r=n.__li.firstElementChild.firstElementChild.innerHTML,i=n.__gui.__listening.indexOf(n)>-1;n.remove();var o=l(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return o.name(r),i&&o.listen(),o}return e};n.min=j.default.compose(r,n.min),n.max=j.default.compose(r,n.max)}else n instanceof v.default?(M.default.bind(e,"click",function(){M.default.fakeEvent(n.__checkbox,"click")}),M.default.bind(n.__checkbox,"click",function(t){t.stopPropagation()})):n instanceof b.default?(M.default.bind(e,"click",function(){M.default.fakeEvent(n.__button,"click")}),M.default.bind(e,"mouseover",function(){M.default.addClass(n.__button,"hover")}),M.default.bind(e,"mouseout",function(){M.default.removeClass(n.__button,"hover")})):n instanceof E.default&&(M.default.addClass(e,"color"),n.updateDisplay=j.default.compose(function(t){return e.style.borderLeftColor=n.__color.toString(),t},n.updateDisplay),n.updateDisplay());n.setValue=j.default.compose(function(e){return t.getRoot().__preset_select&&n.isModified()&&o(t.getRoot(),!0),e},n.setValue)}function s(t,e){var n=t.getRoot(),r=n.__rememberedObjects.indexOf(e.object);if(-1!==r){var i=n.__rememberedObjectIndecesToControllers[r];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[r]=i),i[e.property]=e,n.load&&n.load.remembered){var o=n.load.remembered,a=void 0;if(o[t.preset])a=o[t.preset];else{if(!o[z])return;a=o[z]}if(a[r]&&void 0!==a[r][e.property]){var s=a[r][e.property];e.initialValue=s,e.setValue(s)}}}}function l(t,e,n,r){if(void 0===e[n])throw new Error('Object "'+e+'" has no property "'+n+'"');var o=void 0;if(r.color)o=new E.default(e,n);else{var l=[e,n].concat(r.factoryArgs);o=_.default.apply(t,l)}r.before instanceof g.default&&(r.before=r.before.__li),s(t,o),M.default.addClass(o.domElement,"c");var c=document.createElement("span");M.default.addClass(c,"property-name"),c.innerHTML=o.property;var u=document.createElement("div");u.appendChild(c),u.appendChild(o.domElement);var p=i(t,u,r.before);return M.default.addClass(p,k.CLASS_CONTROLLER_ROW),o instanceof E.default?M.default.addClass(p,"color"):M.default.addClass(p,f(o.getValue())),a(t,p,o),t.__controllers.push(o),o}function c(t,e){return document.location.href+"."+e}function u(t,e,n){var r=document.createElement("option");r.innerHTML=e,r.value=e,t.__preset_select.appendChild(r),n&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function p(t,e){e.style.display=t.useLocalStorage?"block":"none"}function d(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function h(t,e){var n={};return j.default.each(t.__rememberedObjects,function(r,i){var o={},a=t.__rememberedObjectIndecesToControllers[i];j.default.each(a,function(t,n){o[n]=e?t.initialValue:t.getValue()}),n[i]=o}),n}var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},m=r(n(18)),y=r(n(19)),_=r(n(20)),g=r(n(7)),v=r(n(8)),b=r(n(15)),x=r(n(13)),w=r(n(14)),E=r(n(16)),T=r(n(21)),S=r(n(22)),M=r(n(9)),j=r(n(5)),C=r(n(23));m.default.inject(C.default);var z="Default",R=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}}(),A=void 0,L=!0,I=void 0,P=!1,O=[],k=function t(e){var n=this,r=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),M.default.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],r=j.default.defaults(r,{autoPlace:!0,width:t.DEFAULT_WIDTH}),r=j.default.defaults(r,{resizable:r.autoPlace,hideable:r.autoPlace}),j.default.isUndefined(r.load)?r.load={preset:z}:r.preset&&(r.load.preset=r.preset),j.default.isUndefined(r.parent)&&r.hideable&&O.push(this),r.resizable=j.default.isUndefined(r.parent)&&r.resizable,r.autoPlace&&j.default.isUndefined(r.scrollable)&&(r.scrollable=!0);var o=R&&"true"===localStorage.getItem(c(0,"isLocal")),a=void 0;if(Object.defineProperties(this,{parent:{get:function(){return r.parent}},scrollable:{get:function(){return r.scrollable}},autoPlace:{get:function(){return r.autoPlace}},preset:{get:function(){return n.parent?n.getRoot().preset:r.load.preset},set:function(t){n.parent?n.getRoot().preset=t:r.load.preset=t,function(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value===t.preset&&(t.__preset_select.selectedIndex=e)}(this),n.revert()}},width:{get:function(){return r.width},set:function(t){r.width=t,d(n,t)}},name:{get:function(){return r.name},set:function(t){r.name=t,titleRowName&&(titleRowName.innerHTML=r.name)}},closed:{get:function(){return r.closed},set:function(e){r.closed=e,r.closed?M.default.addClass(n.__ul,t.CLASS_CLOSED):M.default.removeClass(n.__ul,t.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=e?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return r.load}},useLocalStorage:{get:function(){return o},set:function(t){R&&(o=t,t?M.default.bind(window,"unload",a):M.default.unbind(window,"unload",a),localStorage.setItem(c(0,"isLocal"),t))}}}),j.default.isUndefined(r.parent)){if(r.closed=!1,M.default.addClass(this.domElement,t.CLASS_MAIN),M.default.makeSelectable(this.domElement,!1),R&&o){n.useLocalStorage=!0;var s=localStorage.getItem(c(0,"gui"));s&&(r.load=JSON.parse(s))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,M.default.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),M.default.bind(this.__closeButton,"click",function(){n.closed=!n.closed})}else{void 0===r.closed&&(r.closed=!0);var l=document.createTextNode(r.name);M.default.addClass(l,"controller-name");var u=i(n,l);M.default.addClass(this.__ul,t.CLASS_CLOSED),M.default.addClass(u,"title"),M.default.bind(u,"click",function(t){return t.preventDefault(),n.closed=!n.closed,!1}),r.closed||(this.closed=!1)}r.autoPlace&&(j.default.isUndefined(r.parent)&&(L&&(I=document.createElement("div"),M.default.addClass(I,"dg"),M.default.addClass(I,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(I),L=!1),I.appendChild(this.domElement),M.default.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||d(n,r.width)),this.__resizeHandler=function(){n.onResizeDebounced()},M.default.bind(window,"resize",this.__resizeHandler),M.default.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),M.default.bind(this.__ul,"transitionend",this.__resizeHandler),M.default.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),r.resizable&&function(t){function e(e){return e.preventDefault(),t.width+=i-e.clientX,t.onResize(),i=e.clientX,!1}function n(){M.default.removeClass(t.__closeButton,k.CLASS_DRAG),M.default.unbind(window,"mousemove",e),M.default.unbind(window,"mouseup",n)}function r(r){return r.preventDefault(),i=r.clientX,M.default.addClass(t.__closeButton,k.CLASS_DRAG),M.default.bind(window,"mousemove",e),M.default.bind(window,"mouseup",n),!1}var i=void 0;t.__resize_handle=document.createElement("div"),j.default.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),M.default.bind(t.__resize_handle,"mousedown",r),M.default.bind(t.__closeButton,"mousedown",r),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}(this),a=function(){R&&"true"===localStorage.getItem(c(0,"isLocal"))&&localStorage.setItem(c(0,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=a,r.parent||function(){var t=n.getRoot();t.width+=1,j.default.defer(function(){t.width-=1})}()};k.toggleHide=function(){P=!P,j.default.each(O,function(t){t.domElement.style.display=P?"none":""})},k.CLASS_AUTO_PLACE="a",k.CLASS_AUTO_PLACE_CONTAINER="ac",k.CLASS_MAIN="main",k.CLASS_CONTROLLER_ROW="cr",k.CLASS_TOO_TALL="taller-than-window",k.CLASS_CLOSED="closed",k.CLASS_CLOSE_BUTTON="close-button",k.CLASS_DRAG="drag",k.DEFAULT_WIDTH=245,k.TEXT_CLOSED="Close Controls",k.TEXT_OPEN="Open Controls",k._keydownHandler=function(t){"text"===document.activeElement.type||72!==t.which&&72!==t.keyCode||k.toggleHide()},M.default.bind(window,"keydown",k._keydownHandler,!1),j.default.extend(k.prototype,{add:function(t,e){return l(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return l(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.splice(this.__controllers.indexOf(t),1);var e=this;j.default.defer(function(){e.onResize()})},destroy:function(){this.autoPlace&&I.removeChild(this.domElement),M.default.unbind(window,"keydown",k._keydownHandler,!1),M.default.unbind(window,"resize",this.__resizeHandler),this.saveToLocalStorageIfPossible&&M.default.unbind(window,"unload",this.saveToLocalStorageIfPossible)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var n=new k(e);this.__folders[t]=n;var r=i(this,n.domElement);return M.default.addClass(r,"folder"),n},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=M.default.getOffset(t.__ul).top,n=0;j.default.each(t.__ul.childNodes,function(e){t.autoPlace&&e===t.__save_row||(n+=M.default.getHeight(e))}),window.innerHeight-e-20<n?(M.default.addClass(t.domElement,k.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-20+"px"):(M.default.removeClass(t.domElement,k.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&j.default.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"}),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},onResizeDebounced:j.default.debounce(function(){this.onResize()},200),remember:function(){if(j.default.isUndefined(A)&&((A=new S.default).domElement.innerHTML=y.default),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;j.default.each(Array.prototype.slice.call(arguments),function(e){0===t.__rememberedObjects.length&&function(t){var e=t.__save_row=document.createElement("li");M.default.addClass(t.domElement,"has-save"),t.__ul.insertBefore(e,t.__ul.firstChild),M.default.addClass(e,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",M.default.addClass(n,"button gears");var r=document.createElement("span");r.innerHTML="Save",M.default.addClass(r,"button"),M.default.addClass(r,"save");var i=document.createElement("span");i.innerHTML="New",M.default.addClass(i,"button"),M.default.addClass(i,"save-as");var o=document.createElement("span");o.innerHTML="Revert",M.default.addClass(o,"button"),M.default.addClass(o,"revert");var a=t.__preset_select=document.createElement("select");t.load&&t.load.remembered?j.default.each(t.load.remembered,function(e,n){u(t,n,n===t.preset)}):u(t,z,!1),M.default.bind(a,"change",function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value}),e.appendChild(a),e.appendChild(n),e.appendChild(r),e.appendChild(i),e.appendChild(o),R&&function(){var e=document.getElementById("dg-local-explain"),n=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(c(0,"isLocal"))&&n.setAttribute("checked","checked"),p(t,e),M.default.bind(n,"change",function(){t.useLocalStorage=!t.useLocalStorage,p(t,e)})}();var s=document.getElementById("dg-new-constructor");M.default.bind(s,"keydown",function(t){!t.metaKey||67!==t.which&&67!==t.keyCode||A.hide()}),M.default.bind(n,"click",function(){s.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),A.show(),s.focus(),s.select()}),M.default.bind(r,"click",function(){t.save()}),M.default.bind(i,"click",function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)}),M.default.bind(o,"click",function(){t.revert()})}(t),-1===t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&d(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=h(this)),t.folders={},j.default.each(this.__folders,function(e,n){t.folders[n]=e.getSaveObject()}),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=h(this),o(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered[z]=h(this,!0)),this.load.remembered[t]=h(this),this.preset=t,u(this,t,!0),this.saveToLocalStorageIfPossible()},revert:function(t){j.default.each(this.__controllers,function(e){this.getRoot().load.remembered?s(t||this.getRoot(),e):e.setValue(e.initialValue),e.__onFinishChange&&e.__onFinishChange.call(e,e.getValue())},this),j.default.each(this.__folders,function(t){t.revert(t)}),t||o(this.getRoot(),!1)},listen:function(t){var e=0===this.__listening.length;this.__listening.push(t),e&&function t(e){0!==e.length&&T.default.call(window,function(){t(e)}),j.default.each(e,function(t){t.updateDisplay()})}(this.__listening)},updateDisplay:function(){j.default.each(this.__controllers,function(t){t.updateDisplay()}),j.default.each(this.__folders,function(t){t.updateDisplay()})}}),t.exports=k},function(t,e){"use strict";t.exports={load:function(t,e){var n=e||document,r=n.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=t,n.getElementsByTagName("head")[0].appendChild(r)},inject:function(t,e){var n=e||document,r=document.createElement("style");r.type="text/css",r.innerHTML=t;var i=n.getElementsByTagName("head")[0];try{i.appendChild(r)}catch(t){}}}},function(t,e){t.exports="<div id=dg-save class=\"dg dialogue\"> Here's the new load parameter for your <code>GUI</code>'s constructor: <textarea id=dg-new-constructor></textarea> <div id=dg-save-locally> <input id=dg-local-storage type=checkbox /> Automatically save values to <code>localStorage</code> on exit. <div id=dg-local-explain>The values saved to <code>localStorage</code> will override those passed to <code>dat.GUI</code>'s constructor. This makes it easier to work incrementally, but <code>localStorage</code> is fragile, and your friends may not see the same values you do. </div> </div> </div>"},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(10)),o=r(n(13)),a=r(n(14)),s=r(n(11)),l=r(n(15)),c=r(n(8)),u=r(n(5));e.default=function(t,e){var n=t[e];return u.default.isArray(arguments[2])||u.default.isObject(arguments[2])?new i.default(t,e,arguments[2]):u.default.isNumber(n)?u.default.isNumber(arguments[2])&&u.default.isNumber(arguments[3])?u.default.isNumber(arguments[4])?new a.default(t,e,arguments[2],arguments[3],arguments[4]):new a.default(t,e,arguments[2],arguments[3]):u.default.isNumber(arguments[4])?new o.default(t,e,{min:arguments[2],max:arguments[3],step:arguments[4]}):new o.default(t,e,{min:arguments[2],max:arguments[3]}):u.default.isString(n)?new s.default(t,e):u.default.isFunction(n)?new l.default(t,e,""):u.default.isBoolean(n)?new c.default(t,e):null}},function(t,e){"use strict";e.__esModule=!0,e.default=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,1e3/60)}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(9)),o=r(n(5)),a=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.backgroundElement=document.createElement("div"),o.default.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),i.default.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),o.default.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;i.default.bind(this.backgroundElement,"click",function(){e.hide()})}return t.prototype.show=function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),o.default.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})},t.prototype.hide=function(){var t=this,e=function e(){t.domElement.style.display="none",t.backgroundElement.style.display="none",i.default.unbind(t.domElement,"webkitTransitionEnd",e),i.default.unbind(t.domElement,"transitionend",e),i.default.unbind(t.domElement,"oTransitionEnd",e)};i.default.bind(this.domElement,"webkitTransitionEnd",e),i.default.bind(this.domElement,"transitionend",e),i.default.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},t.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-i.default.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-i.default.getHeight(this.domElement)/2+"px"},t}();e.default=a},function(t,e,n){(t.exports=n(24)()).push([t.id,".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1!important}.dg.main .close-button.drag,.dg.main:hover .close-button{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;transition:opacity .1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save>ul{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height .1s ease-out;transition:height .1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid transparent}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.boolean,.dg .cr.boolean *,.dg .cr.function,.dg .cr.function *,.dg .cr.function .property-name{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco,monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px Lucida Grande,sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid hsla(0,0%,100%,.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.boolean:hover,.dg .cr.function:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}",""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<e.length;i++){var a=e[i];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}}])}),THREE.OrbitControls=function(t,e){var n,r,i,o,a,s;void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=e,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:THREE.MOUSE.ROTATE,MIDDLE:THREE.MOUSE.DOLLY,RIGHT:THREE.MOUSE.PAN},this.touches={ONE:THREE.TOUCH.ROTATE,TWO:THREE.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return m.phi},this.getAzimuthalAngle=function(){return m.theta},this.listenToKeyEvents=function(t){t.addEventListener("keydown",Z),this._domElementKeyEvents=t},this.saveState=function(){l.target0.copy(l.target),l.position0.copy(l.object.position),l.zoom0=l.object.zoom},this.reset=function(){l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.zoom=l.zoom0,l.object.updateProjectionMatrix(),l.dispatchEvent(c),l.update(),h=d.NONE},this.update=(n=new THREE.Vector3,r=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),i=r.clone().invert(),o=new THREE.Vector3,a=new THREE.Quaternion,s=2*Math.PI,function(){var t=l.object.position;n.copy(t).sub(l.target),n.applyQuaternion(r),m.setFromVector3(n),l.autoRotate&&h===d.NONE&&R(2*Math.PI/60/60*l.autoRotateSpeed),l.enableDamping?(m.theta+=y.theta*l.dampingFactor,m.phi+=y.phi*l.dampingFactor):(m.theta+=y.theta,m.phi+=y.phi);var e=l.minAzimuthAngle,u=l.maxAzimuthAngle;return isFinite(e)&&isFinite(u)&&(e<-Math.PI?e+=s:e>Math.PI&&(e-=s),u<-Math.PI?u+=s:u>Math.PI&&(u-=s),m.theta=e<=u?Math.max(e,Math.min(u,m.theta)):m.theta>(e+u)/2?Math.max(e,m.theta):Math.min(u,m.theta)),m.phi=Math.max(l.minPolarAngle,Math.min(l.maxPolarAngle,m.phi)),m.makeSafe(),m.radius*=_,m.radius=Math.max(l.minDistance,Math.min(l.maxDistance,m.radius)),!0===l.enableDamping?l.target.addScaledVector(g,l.dampingFactor):l.target.add(g),n.setFromSpherical(m),n.applyQuaternion(i),t.copy(l.target).add(n),l.object.lookAt(l.target),!0===l.enableDamping?(y.theta*=1-l.dampingFactor,y.phi*=1-l.dampingFactor,g.multiplyScalar(1-l.dampingFactor)):(y.set(0,0,0),g.set(0,0,0)),_=1,!!(v||o.distanceToSquared(l.object.position)>f||8*(1-a.dot(l.object.quaternion))>f)&&(l.dispatchEvent(c),o.copy(l.object.position),a.copy(l.object.quaternion),v=!1,!0)}),this.dispose=function(){l.domElement.removeEventListener("contextmenu",tt),l.domElement.removeEventListener("pointerdown",q),l.domElement.removeEventListener("wheel",Q),l.domElement.removeEventListener("touchstart",J),l.domElement.removeEventListener("touchend",$),l.domElement.removeEventListener("touchmove",K),l.domElement.ownerDocument.removeEventListener("pointermove",X),l.domElement.ownerDocument.removeEventListener("pointerup",Y),null!==l._domElementKeyEvents&&l._domElementKeyEvents.removeEventListener("keydown",Z)};var l=this,c={type:"change"},u={type:"start"},p={type:"end"},d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},h=d.NONE,f=1e-6,m=new THREE.Spherical,y=new THREE.Spherical,_=1,g=new THREE.Vector3,v=!1,b=new THREE.Vector2,x=new THREE.Vector2,w=new THREE.Vector2,E=new THREE.Vector2,T=new THREE.Vector2,S=new THREE.Vector2,M=new THREE.Vector2,j=new THREE.Vector2,C=new THREE.Vector2;function z(){return Math.pow(.95,l.zoomSpeed)}function R(t){y.theta-=t}function A(t){y.phi-=t}var L,I=(L=new THREE.Vector3,function(t,e){L.setFromMatrixColumn(e,0),L.multiplyScalar(-t),g.add(L)}),P=function(){var t=new THREE.Vector3;return function(e,n){!0===l.screenSpacePanning?t.setFromMatrixColumn(n,1):(t.setFromMatrixColumn(n,0),t.crossVectors(l.object.up,t)),t.multiplyScalar(e),g.add(t)}}(),O=function(){var t=new THREE.Vector3;return function(e,n){var r=l.domElement;if(l.object.isPerspectiveCamera){var i=l.object.position;t.copy(i).sub(l.target);var o=t.length();o*=Math.tan(l.object.fov/2*Math.PI/180),I(2*e*o/r.clientHeight,l.object.matrix),P(2*n*o/r.clientHeight,l.object.matrix)}else l.object.isOrthographicCamera?(I(e*(l.object.right-l.object.left)/l.object.zoom/r.clientWidth,l.object.matrix),P(n*(l.object.top-l.object.bottom)/l.object.zoom/r.clientHeight,l.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),l.enablePan=!1)}}();function k(t){l.object.isPerspectiveCamera?_/=t:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom*t)),l.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function B(t){l.object.isPerspectiveCamera?_*=t:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/t)),l.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function D(t){b.set(t.clientX,t.clientY)}function H(t){E.set(t.clientX,t.clientY)}function F(t){if(1==t.touches.length)b.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);b.set(e,n)}}function N(t){if(1==t.touches.length)E.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);E.set(e,n)}}function U(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);M.set(0,r)}function V(t){if(1==t.touches.length)x.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);x.set(e,n)}w.subVectors(x,b).multiplyScalar(l.rotateSpeed);var r=l.domElement;R(2*Math.PI*w.x/r.clientHeight),A(2*Math.PI*w.y/r.clientHeight),b.copy(x)}function G(t){if(1==t.touches.length)T.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);T.set(e,n)}S.subVectors(T,E).multiplyScalar(l.panSpeed),O(S.x,S.y),E.copy(T)}function W(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);j.set(0,r),C.set(0,Math.pow(j.y/M.y,l.zoomSpeed)),k(C.y),M.copy(j)}function q(t){if(!1!==l.enabled)switch(t.pointerType){case"mouse":case"pen":!function(t){var e;switch(t.preventDefault(),l.domElement.focus?l.domElement.focus():window.focus(),t.button){case 0:e=l.mouseButtons.LEFT;break;case 1:e=l.mouseButtons.MIDDLE;break;case 2:e=l.mouseButtons.RIGHT;break;default:e=-1}switch(e){case THREE.MOUSE.DOLLY:if(!1===l.enableZoom)return;!function(t){M.set(t.clientX,t.clientY)}(t),h=d.DOLLY;break;case THREE.MOUSE.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===l.enablePan)return;H(t),h=d.PAN}else{if(!1===l.enableRotate)return;D(t),h=d.ROTATE}break;case THREE.MOUSE.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===l.enableRotate)return;D(t),h=d.ROTATE}else{if(!1===l.enablePan)return;H(t),h=d.PAN}break;default:h=d.NONE}h!==d.NONE&&(l.domElement.ownerDocument.addEventListener("pointermove",X),l.domElement.ownerDocument.addEventListener("pointerup",Y),l.dispatchEvent(u))}(t)}}function X(t){if(!1!==l.enabled)switch(t.pointerType){case"mouse":case"pen":!function(t){if(!1!==l.enabled)switch(t.preventDefault(),h){case d.ROTATE:if(!1===l.enableRotate)return;!function(t){x.set(t.clientX,t.clientY),w.subVectors(x,b).multiplyScalar(l.rotateSpeed);var e=l.domElement;R(2*Math.PI*w.x/e.clientHeight),A(2*Math.PI*w.y/e.clientHeight),b.copy(x),l.update()}(t);break;case d.DOLLY:if(!1===l.enableZoom)return;!function(t){j.set(t.clientX,t.clientY),C.subVectors(j,M),C.y>0?k(z()):C.y<0&&B(z()),M.copy(j),l.update()}(t);break;case d.PAN:if(!1===l.enablePan)return;!function(t){T.set(t.clientX,t.clientY),S.subVectors(T,E).multiplyScalar(l.panSpeed),O(S.x,S.y),E.copy(T),l.update()}(t)}}(t)}}function Y(t){switch(t.pointerType){case"mouse":case"pen":l.domElement.ownerDocument.removeEventListener("pointermove",X),l.domElement.ownerDocument.removeEventListener("pointerup",Y),!1!==l.enabled&&(l.dispatchEvent(p),h=d.NONE)}}function Q(t){!1===l.enabled||!1===l.enableZoom||h!==d.NONE&&h!==d.ROTATE||(t.preventDefault(),t.stopPropagation(),l.dispatchEvent(u),function(t){t.deltaY<0?B(z()):t.deltaY>0&&k(z()),l.update()}(t),l.dispatchEvent(p))}function Z(t){!1!==l.enabled&&!1!==l.enablePan&&function(t){var e=!1;switch(t.keyCode){case l.keys.UP:O(0,l.keyPanSpeed),e=!0;break;case l.keys.BOTTOM:O(0,-l.keyPanSpeed),e=!0;break;case l.keys.LEFT:O(l.keyPanSpeed,0),e=!0;break;case l.keys.RIGHT:O(-l.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),l.update())}(t)}function J(t){if(!1!==l.enabled){switch(t.preventDefault(),t.touches.length){case 1:switch(l.touches.ONE){case THREE.TOUCH.ROTATE:if(!1===l.enableRotate)return;F(t),h=d.TOUCH_ROTATE;break;case THREE.TOUCH.PAN:if(!1===l.enablePan)return;N(t),h=d.TOUCH_PAN;break;default:h=d.NONE}break;case 2:switch(l.touches.TWO){case THREE.TOUCH.DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(t){l.enableZoom&&U(t),l.enablePan&&N(t)}(t),h=d.TOUCH_DOLLY_PAN;break;case THREE.TOUCH.DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(t){l.enableZoom&&U(t),l.enableRotate&&F(t)}(t),h=d.TOUCH_DOLLY_ROTATE;break;default:h=d.NONE}break;default:h=d.NONE}h!==d.NONE&&l.dispatchEvent(u)}}function K(t){if(!1!==l.enabled)switch(t.preventDefault(),t.stopPropagation(),h){case d.TOUCH_ROTATE:if(!1===l.enableRotate)return;V(t),l.update();break;case d.TOUCH_PAN:if(!1===l.enablePan)return;G(t),l.update();break;case d.TOUCH_DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(t){l.enableZoom&&W(t),l.enablePan&&G(t)}(t),l.update();break;case d.TOUCH_DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(t){l.enableZoom&&W(t),l.enableRotate&&V(t)}(t),l.update();break;default:h=d.NONE}}function $(t){!1!==l.enabled&&(l.dispatchEvent(p),h=d.NONE)}function tt(t){!1!==l.enabled&&t.preventDefault()}l.domElement.addEventListener("contextmenu",tt),l.domElement.addEventListener("pointerdown",q),l.domElement.addEventListener("wheel",Q),l.domElement.addEventListener("touchstart",J),l.domElement.addEventListener("touchend",$),l.domElement.addEventListener("touchmove",K),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,THREE.MapControls=function(t,e){THREE.OrbitControls.call(this,t,e),this.screenSpacePanning=!1,this.mouseButtons.LEFT=THREE.MOUSE.PAN,this.mouseButtons.RIGHT=THREE.MOUSE.ROTATE,this.touches.ONE=THREE.TOUCH.PAN,this.touches.TWO=THREE.TOUCH.DOLLY_ROTATE},THREE.MapControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.MapControls.prototype.constructor=THREE.MapControls,m=function(t){"use strict";function e(e,n,r,i,o,a,s,l,c){t.BufferGeometry.call(this),this.type="CapsuleBufferGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:r,radialSegments:i,heightSegments:o,thetaStart:l,thetaLength:c},e=void 0!==e?e:1,n=void 0!==n?n:1,r=void 0!==r?r:2,i=Math.floor(i)||8,o=Math.floor(o)||1,a=Math.floor(a)||2,s=Math.floor(s)||2,l=void 0!==l?l:0,c=void 0!==c?c:2*Math.PI;var u=Math.acos((n-e)/r),p=(i+1)*(o+1+s+a),d=i*(o+s+a)*2*3,h=new t.BufferAttribute(new(d>65535?Uint32Array:Uint16Array)(d),1),f=new t.BufferAttribute(new Float32Array(3*p),3),m=new t.BufferAttribute(new Float32Array(3*p),3),y=new t.BufferAttribute(new Float32Array(2*p),2),_=0,g=0,v=[],b=r/2;!function(){var p,d,x=new t.Vector3,w=new t.Vector3,E=Math.cos(u),T=Math.sin(u),S=new t.Vector2(e*T,b+e*E).sub(new t.Vector2(n*T,n*E-b)).length(),M=e*u+S+n*(Math.PI/2-u),j=0;for(d=0;d<=a;d++){var C=[],z=Math.PI/2-u*(d/a);j+=e*u/a;var R=Math.cos(z),A=Math.sin(z),L=R*e;for(p=0;p<=i;p++){var I=(D=p/i)*c+l,P=Math.sin(I),O=Math.cos(I);w.x=L*P,w.y=b+A*e,w.z=L*O,f.setXYZ(_,w.x,w.y,w.z),x.set(R*P,A,R*O),m.setXYZ(_,x.x,x.y,x.z),y.setXY(_,D,1-j/M),C.push(_),_++}v.push(C)}var k=r+E*e-E*n,B=T*(n-e)/k;for(d=1;d<=o;d++){for(C=[],j+=S/o,L=T*(d*(n-e)/o+e),p=0;p<=i;p++)I=(D=p/i)*c+l,P=Math.sin(I),O=Math.cos(I),w.x=L*P,w.y=b+E*e-d*k/o,w.z=L*O,f.setXYZ(_,w.x,w.y,w.z),x.set(P,B,O).normalize(),m.setXYZ(_,x.x,x.y,x.z),y.setXY(_,D,1-j/M),C.push(_),_++;v.push(C)}for(d=1;d<=s;d++){for(C=[],z=Math.PI/2-u-(Math.PI-u)*(d/s),j+=n*u/s,R=Math.cos(z),A=Math.sin(z),L=R*n,p=0;p<=i;p++){var D;I=(D=p/i)*c+l,P=Math.sin(I),O=Math.cos(I),w.x=L*P,w.y=A*n-b,w.z=L*O,f.setXYZ(_,w.x,w.y,w.z),x.set(R*P,A,R*O),m.setXYZ(_,x.x,x.y,x.z),y.setXY(_,D,1-j/M),C.push(_),_++}v.push(C)}for(p=0;p<i;p++)for(d=0;d<a+o+s;d++){var H=v[d][p],F=v[d+1][p],N=v[d+1][p+1],U=v[d][p+1];h.setX(g,H),g++,h.setX(g,F),g++,h.setX(g,U),g++,h.setX(g,F),g++,h.setX(g,N),g++,h.setX(g,U),g++}}(),this.setIndex(h),this.addAttribute("position",f),this.addAttribute("normal",m),this.addAttribute("uv",y)}t=t&&t.hasOwnProperty("default")?t.default:t,e.prototype=Object.create(t.BufferGeometry.prototype),e.prototype.constructor=e;var n=e;return t.CapsuleBufferGeometry=n,n},"object"==typeof exports&&"undefined"!=typeof module?module.exports=m(require("three-full/builds/Three.cjs.js")):"function"==typeof define&&define.amd?define(["three-full/builds/Three.cjs.js"],m):this.THREECapsuleBufferGeometry=m(this.THREE),THREE.TrailRenderer=function(t,e){THREE.Object3D.call(this),this.active=!1,this.orientToMovement=!1,e&&(this.orientToMovement=!0),this.scene=t,this.geometry=null,this.mesh=null,this.nodeCenters=null,this.lastNodeCenter=null,this.currentNodeCenter=null,this.lastOrientationDir=null,this.nodeIDs=null,this.currentLength=0,this.currentEnd=0,this.currentNodeID=0},THREE.TrailRenderer.prototype=Object.create(THREE.Object3D.prototype),THREE.TrailRenderer.prototype.constructor=THREE.TrailRenderer,THREE.TrailRenderer.MaxHeadVertices=128,THREE.TrailRenderer.LocalOrientationTangent=new THREE.Vector3(1,0,0),THREE.TrailRenderer.LocalOrientationDirection=new THREE.Vector3(0,0,-1),THREE.TrailRenderer.LocalHeadOrigin=new THREE.Vector3(0,0,0),THREE.TrailRenderer.PositionComponentCount=3,THREE.TrailRenderer.UVComponentCount=2,THREE.TrailRenderer.IndicesPerFace=3,THREE.TrailRenderer.FacesPerQuad=2,THREE.TrailRenderer.Shader={},THREE.TrailRenderer.Shader.BaseVertexVars=["attribute float nodeID;","attribute float nodeVertexID;","attribute vec3 nodeCenter;","uniform float minID;","uniform float maxID;","uniform float trailLength;","uniform float maxTrailLength;","uniform float verticesPerNode;","uniform vec2 textureTileFactor;","uniform vec4 headColor;","uniform vec4 tailColor;","varying vec4 vColor;"].join("\n"),THREE.TrailRenderer.Shader.TexturedVertexVars=[THREE.TrailRenderer.Shader.BaseVertexVars,"varying vec2 vUV;","uniform float dragTexture;"].join("\n"),THREE.TrailRenderer.Shader.BaseFragmentVars=["varying vec4 vColor;","uniform sampler2D texture;"].join("\n"),THREE.TrailRenderer.Shader.TexturedFragmentVars=[THREE.TrailRenderer.Shader.BaseFragmentVars,"varying vec2 vUV;"].join("\n"),THREE.TrailRenderer.Shader.VertexShaderCore=["float fraction = ( maxID - nodeID ) / ( maxID - minID );","vColor = (( 1.0 - fraction ) * headColor + fraction * tailColor);","vec4 realPosition = vec4(position.xyz, 1.0 ); "].join("\n"),THREE.TrailRenderer.Shader.BaseVertexShader=[THREE.TrailRenderer.Shader.BaseVertexVars,"void main() { ",THREE.TrailRenderer.Shader.VertexShaderCore,"gl_Position = projectionMatrix * viewMatrix * realPosition;","}"].join("\n"),THREE.TrailRenderer.Shader.BaseFragmentShader=[THREE.TrailRenderer.Shader.BaseFragmentVars,"void main() { ","gl_FragColor = vColor;","}"].join("\n"),THREE.TrailRenderer.Shader.TexturedVertexShader=[THREE.TrailRenderer.Shader.TexturedVertexVars,"void main() { ",THREE.TrailRenderer.Shader.VertexShaderCore,"float s = 0.0;","float t = 0.0;","if ( dragTexture == 1.0 ) { ","   s = fraction *  textureTileFactor.s; "," \tt = ( nodeVertexID / verticesPerNode ) * textureTileFactor.t;","} else { ","\ts = nodeID / maxTrailLength * textureTileFactor.s;"," \tt = ( nodeVertexID / verticesPerNode ) * textureTileFactor.t;","}","vUV = vec2( s, t ); ","gl_Position = projectionMatrix * viewMatrix * realPosition;","}"].join("\n"),THREE.TrailRenderer.Shader.TexturedFragmentShader=[THREE.TrailRenderer.Shader.TexturedFragmentVars,"void main() { ","vec4 textureColor = texture2D( texture, vUV );","gl_FragColor = vColor * textureColor;","}"].join("\n"),THREE.TrailRenderer.createMaterial=function(t,e,n){return(n=n||{}).trailLength={type:"f",value:null},n.verticesPerNode={type:"f",value:null},n.minID={type:"f",value:null},n.maxID={type:"f",value:null},n.dragTexture={type:"f",value:null},n.maxTrailLength={type:"f",value:null},n.textureTileFactor={type:"v2",value:null},n.headColor={type:"v4",value:new THREE.Vector4},n.tailColor={type:"v4",value:new THREE.Vector4},t=t||THREE.TrailRenderer.Shader.BaseVertexShader,e=e||THREE.TrailRenderer.Shader.BaseFragmentShader,new THREE.ShaderMaterial({uniforms:n,vertexShader:t,fragmentShader:e,transparent:!0,blending:THREE.CustomBlending,blendSrc:THREE.SrcAlphaFactor,blendDst:THREE.OneMinusSrcAlphaFactor,blendEquation:THREE.AddEquation,depthTest:!0,depthWrite:!1,side:THREE.DoubleSide})},THREE.TrailRenderer.createBaseMaterial=function(t){return this.createMaterial(THREE.TrailRenderer.Shader.BaseVertexShader,THREE.TrailRenderer.Shader.BaseFragmentShader,t)},THREE.TrailRenderer.createTexturedMaterial=function(t){return(t={}).texture={type:"t",value:null},this.createMaterial(THREE.TrailRenderer.Shader.TexturedVertexShader,THREE.TrailRenderer.Shader.TexturedFragmentShader,t)},THREE.TrailRenderer.prototype.initialize=function(t,e,n,r,i,o){this.deactivate(),this.destroyMesh(),this.length=e>0?e+1:0,this.dragTexture=n?1:0,this.targetObject=o,this.initializeLocalHeadGeometry(r,i),this.nodeIDs=[],this.nodeCenters=[];for(var a=0;a<this.length;a++)this.nodeIDs[a]=-1,this.nodeCenters[a]=new THREE.Vector3;this.material=t,this.initializeGeometry(),this.initializeMesh(),this.material.uniforms.trailLength.value=0,this.material.uniforms.minID.value=0,this.material.uniforms.maxID.value=0,this.material.uniforms.dragTexture.value=this.dragTexture,this.material.uniforms.maxTrailLength.value=this.length,this.material.uniforms.verticesPerNode.value=this.VerticesPerNode,this.material.uniforms.textureTileFactor.value=new THREE.Vector2(1,1),this.reset()},THREE.TrailRenderer.prototype.initializeLocalHeadGeometry=function(t,e){if(this.localHeadGeometry=[],e){this.VerticesPerNode=0;for(var n=0;n<e.length&&n<THREE.TrailRenderer.MaxHeadVertices;n++){var r=e[n];if(r&&r instanceof THREE.Vector3){var i=new THREE.Vector3;i.copy(r),this.localHeadGeometry.push(i),this.VerticesPerNode++}}}else{var o=t||1;o/=2,this.localHeadGeometry.push(new THREE.Vector3(-o,0,0)),this.localHeadGeometry.push(new THREE.Vector3(o,0,0)),this.VerticesPerNode=2}this.FacesPerNode=2*(this.VerticesPerNode-1),this.FaceIndicesPerNode=3*this.FacesPerNode},THREE.TrailRenderer.prototype.initializeGeometry=function(){this.vertexCount=this.length*this.VerticesPerNode,this.faceCount=this.length*this.FacesPerNode;var t=new THREE.BufferGeometry,e=new Float32Array(this.vertexCount),n=new Float32Array(this.vertexCount*this.VerticesPerNode),r=new Float32Array(this.vertexCount*THREE.TrailRenderer.PositionComponentCount),i=new Float32Array(this.vertexCount*THREE.TrailRenderer.PositionComponentCount),o=new Float32Array(this.vertexCount*THREE.TrailRenderer.UVComponentCount),a=new Uint32Array(this.faceCount*THREE.TrailRenderer.IndicesPerFace),s=new THREE.BufferAttribute(e,1);s.setUsage(THREE.DynamicDrawUsage),t.setAttribute("nodeID",s);var l=new THREE.BufferAttribute(n,1);l.setUsage(THREE.DynamicDrawUsage),t.setAttribute("nodeVertexID",l);var c=new THREE.BufferAttribute(i,THREE.TrailRenderer.PositionComponentCount);c.setUsage(THREE.DynamicDrawUsage),t.setAttribute("nodeCenter",c);var u=new THREE.BufferAttribute(r,THREE.TrailRenderer.PositionComponentCount);u.setUsage(THREE.DynamicDrawUsage),t.setAttribute("position",u);var p=new THREE.BufferAttribute(o,THREE.TrailRenderer.UVComponentCount);p.setUsage(THREE.DynamicDrawUsage),t.setAttribute("uv",p);var d=new THREE.BufferAttribute(a,1);d.setUsage(THREE.DynamicDrawUsage),t.setIndex(d),this.geometry=t},THREE.TrailRenderer.prototype.zeroVertices=function(){for(var t=this.geometry.getAttribute("position"),e=0;e<this.vertexCount;e++){var n=3*e;t.array[n]=0,t.array[n+1]=0,t.array[n+2]=0}t.needsUpdate=!0,t.updateRange.count=-1},THREE.TrailRenderer.prototype.zeroIndices=function(){for(var t=this.geometry.getIndex(),e=0;e<this.faceCount;e++){var n=3*e;t.array[n]=0,t.array[n+1]=0,t.array[n+2]=0}t.needsUpdate=!0,t.updateRange.count=-1},THREE.TrailRenderer.prototype.formInitialFaces=function(){this.zeroIndices();for(var t=this.geometry.getIndex(),e=0;e<this.length-1;e++)this.connectNodes(e,e+1);t.needsUpdate=!0,t.updateRange.count=-1},THREE.TrailRenderer.prototype.initializeMesh=function(){this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.dynamic=!0,this.mesh.matrixAutoUpdate=!1},THREE.TrailRenderer.prototype.destroyMesh=function(){this.mesh&&(this.scene.remove(this.mesh),this.mesh=null)},THREE.TrailRenderer.prototype.reset=function(){this.currentLength=0,this.currentEnd=-1,this.lastNodeCenter=null,this.currentNodeCenter=null,this.lastOrientationDir=null,this.currentNodeID=0,this.formInitialFaces(),this.zeroVertices(),this.geometry.setDrawRange(0,0)},THREE.TrailRenderer.prototype.updateUniforms=function(){this.currentLength<this.length?this.material.uniforms.minID.value=0:this.material.uniforms.minID.value=this.currentNodeID-this.length,this.currentLength<this.length?this.material.uniforms.maxID.value=this.currentNodeID-1:this.material.uniforms.maxID.value=this.currentNodeID,this.material.uniforms.trailLength.value=this.currentLength,this.material.uniforms.maxTrailLength.value=this.length,this.material.uniforms.verticesPerNode.value=this.VerticesPerNode},THREE.TrailRenderer.prototype.advance=function(){new THREE.Vector3,new THREE.Vector3,new THREE.Vector3;var t=new THREE.Matrix4;return function(){this.targetObject.updateMatrixWorld(),t.copy(this.targetObject.matrixWorld),this.advanceWithTransform(t),this.updateUniforms()}}(),THREE.TrailRenderer.prototype.advanceWithPositionAndOrientation=function(t,e){this.advanceGeometry({position:t,tangent:e},null)},THREE.TrailRenderer.prototype.advanceWithTransform=function(t){this.advanceGeometry(null,t)},THREE.TrailRenderer.prototype.advanceGeometry=(new THREE.Vector3,new THREE.Vector3,function(t,e){var n=this.currentEnd+1>=this.length?0:this.currentEnd+1;if(e?this.updateNodePositionsFromTransformMatrix(n,e):this.updateNodePositionsFromOrientationTangent(n,t.position,t.tangent),this.currentLength>=1&&(this.connectNodes(this.currentEnd,n),this.currentLength>=this.length)){var r=this.currentEnd+1>=this.length?0:this.currentEnd+1;this.disconnectNodes(r)}this.currentLength<this.length&&this.currentLength++,this.currentEnd++,this.currentEnd>=this.length&&(this.currentEnd=0),this.currentLength>=1&&(this.currentLength<this.length?this.geometry.setDrawRange(0,(this.currentLength-1)*this.FaceIndicesPerNode):this.geometry.setDrawRange(0,this.currentLength*this.FaceIndicesPerNode)),this.updateNodeID(this.currentEnd,this.currentNodeID),this.currentNodeID++}),THREE.TrailRenderer.prototype.updateHead=(y=new THREE.Matrix4,function(){this.currentEnd<0||(this.targetObject.updateMatrixWorld(),y.copy(this.targetObject.matrixWorld),this.updateNodePositionsFromTransformMatrix(this.currentEnd,y))}),THREE.TrailRenderer.prototype.updateNodeID=function(t,e){this.nodeIDs[t]=e;for(var n=this.geometry.getAttribute("nodeID"),r=this.geometry.getAttribute("nodeVertexID"),i=0;i<this.VerticesPerNode;i++){var o=t*this.VerticesPerNode+i;n.array[o]=e,r.array[o]=i}n.needsUpdate=!0,r.needsUpdate=!0,n.updateRange.offset=t*this.VerticesPerNode,r.updateRange.offset=t*this.VerticesPerNode},THREE.TrailRenderer.prototype.updateNodeCenter=function(t,e){this.lastNodeCenter=this.currentNodeCenter,this.currentNodeCenter=this.nodeCenters[t],this.currentNodeCenter.copy(e);for(var n=this.geometry.getAttribute("nodeCenter"),r=0;r<this.VerticesPerNode;r++){var i=3*(t*this.VerticesPerNode+r);n.array[i]=e.x,n.array[i+1]=e.y,n.array[i+2]=e.z}n.needsUpdate=!0,n.updateRange.offset=t*this.VerticesPerNode*THREE.TrailRenderer.PositionComponentCount},THREE.TrailRenderer.prototype.updateNodePositionsFromOrientationTangent=function(){new THREE.Matrix4;for(var t=new THREE.Quaternion,e=new THREE.Vector3,n=[],r=0;r<THREE.TrailRenderer.MaxHeadVertices;r++){var i=new THREE.Vector3;n.push(i)}return function(r,i,o){var a=this.geometry.getAttribute("position");this.updateNodeCenter(r,i),e.copy(i),e.sub(THREE.TrailRenderer.LocalHeadOrigin),t.setFromUnitVectors(THREE.TrailRenderer.LocalOrientationTangent,o);for(var s=0;s<this.localHeadGeometry.length;s++){var l=n[s];l.copy(this.localHeadGeometry[s]),l.applyQuaternion(t),l.add(e)}for(s=0;s<this.localHeadGeometry.length;s++){var c=(this.VerticesPerNode*r+s)*THREE.TrailRenderer.PositionComponentCount,u=n[s];a.array[c]=u.x,a.array[c+1]=u.y,a.array[c+2]=u.z}a.needsUpdate=!0}}(),THREE.TrailRenderer.prototype.updateNodePositionsFromTransformMatrix=function(){new THREE.Matrix4;for(var t=new THREE.Matrix3,e=new THREE.Quaternion,n=new THREE.Vector3,r=new THREE.Vector3,i=new THREE.Vector3,o=new THREE.Vector3,a=[],s=0;s<THREE.TrailRenderer.MaxHeadVertices;s++){var l=new THREE.Vector3;a.push(l)}return function(s,l){var c,u,p=this.geometry.getAttribute("position");n.set(0,0,0),n.applyMatrix4(l),this.updateNodeCenter(s,n);for(var d=0;d<this.localHeadGeometry.length;d++)(h=a[d]).copy(this.localHeadGeometry[d]);for(d=0;d<this.localHeadGeometry.length;d++)(h=a[d]).applyMatrix4(l);if(this.lastNodeCenter&&this.orientToMovement&&(c=t,u=l.elements,c.set(u[0],u[1],u[2],u[4],u[5],u[6],u[8],u[9],u[10]),i.set(0,0,-1),i.applyMatrix3(t),o.copy(this.currentNodeCenter),o.sub(this.lastNodeCenter),o.normalize(),o.lengthSq()<=1e-4&&this.lastOrientationDir&&o.copy(this.lastOrientationDir),o.lengthSq()>1e-4))for(this.lastOrientationDir||(this.lastOrientationDir=new THREE.Vector3),e.setFromUnitVectors(i,o),r.copy(this.currentNodeCenter),d=0;d<this.localHeadGeometry.length;d++){var h;(h=a[d]).sub(r),h.applyQuaternion(e),h.add(r)}for(d=0;d<this.localHeadGeometry.length;d++){var f=(this.VerticesPerNode*s+d)*THREE.TrailRenderer.PositionComponentCount,m=a[d];p.array[f]=m.x,p.array[f+1]=m.y,p.array[f+2]=m.z}p.needsUpdate=!0,p.updateRange.offset=s*this.VerticesPerNode*THREE.TrailRenderer.PositionComponentCount,this.geometry.computeBoundingSphere()}}(),THREE.TrailRenderer.prototype.connectNodes=(_={attribute:null,offset:0,count:-1},function(t,e){for(var n=this.geometry.getIndex(),r=0;r<this.localHeadGeometry.length-1;r++){var i=this.VerticesPerNode*t+r,o=this.VerticesPerNode*e+r,a=(t*this.FacesPerNode+r*THREE.TrailRenderer.FacesPerQuad)*THREE.TrailRenderer.IndicesPerFace;n.array[a]=i,n.array[a+1]=o,n.array[a+2]=i+1,n.array[a+3]=o,n.array[a+4]=o+1,n.array[a+5]=i+1}return n.needsUpdate=!0,n.updateRange.count=-1,_.attribute=n,_.offset=t*this.FacesPerNode*THREE.TrailRenderer.IndicesPerFace,_.count=this.FacesPerNode*THREE.TrailRenderer.IndicesPerFace,_}),THREE.TrailRenderer.prototype.disconnectNodes=function(t){var e={attribute:null,offset:0,count:-1};return function(t){for(var n=this.geometry.getIndex(),r=0;r<this.localHeadGeometry.length-1;r++){this.VerticesPerNode;var i=(t*this.FacesPerNode+r*THREE.TrailRenderer.FacesPerQuad)*THREE.TrailRenderer.IndicesPerFace;n.array[i]=0,n.array[i+1]=0,n.array[i+2]=0,n.array[i+3]=0,n.array[i+4]=0,n.array[i+5]=0}return n.needsUpdate=!0,n.updateRange.count=-1,e.attribute=n,e.offset=t*this.FacesPerNode*THREE.TrailRenderer.IndicesPerFace,e.count=this.FacesPerNode*THREE.TrailRenderer.IndicesPerFace,e}}(),THREE.TrailRenderer.prototype.deactivate=function(){this.isActive&&(this.scene.remove(this.mesh),this.isActive=!1)},THREE.TrailRenderer.prototype.activate=function(){this.isActive||(this.scene.add(this.mesh),this.isActive=!0)},function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.anime=e()}(this,function(){"use strict";var t={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},e={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},n=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],r={CSS:{},springs:{}};function i(t,e,n){return Math.min(Math.max(t,e),n)}function o(t,e){return t.indexOf(e)>-1}function a(t,e){return t.apply(null,e)}var s={arr:function(t){return Array.isArray(t)},obj:function(t){return o(Object.prototype.toString.call(t),"Object")},pth:function(t){return s.obj(t)&&t.hasOwnProperty("totalLength")},svg:function(t){return t instanceof SVGElement},inp:function(t){return t instanceof HTMLInputElement},dom:function(t){return t.nodeType||s.svg(t)},str:function(t){return"string"==typeof t},fnc:function(t){return"function"==typeof t},und:function(t){return void 0===t},nil:function(t){return s.und(t)||null===t},hex:function(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)},rgb:function(t){return/^rgb/.test(t)},hsl:function(t){return/^hsl/.test(t)},col:function(t){return s.hex(t)||s.rgb(t)||s.hsl(t)},key:function(n){return!t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&"targets"!==n&&"keyframes"!==n}};function l(t){var e=/\(([^)]+)\)/.exec(t);return e?e[1].split(",").map(function(t){return parseFloat(t)}):[]}function c(t,e){var n=l(t),o=i(s.und(n[0])?1:n[0],.1,100),a=i(s.und(n[1])?100:n[1],.1,100),c=i(s.und(n[2])?10:n[2],.1,100),u=i(s.und(n[3])?0:n[3],.1,100),p=Math.sqrt(a/o),d=c/(2*Math.sqrt(a*o)),h=d<1?p*Math.sqrt(1-d*d):0,f=1,m=d<1?(d*p-u)/h:-u+p;function y(t){var n=e?e*t/1e3:t;return n=d<1?Math.exp(-n*d*p)*(f*Math.cos(h*n)+m*Math.sin(h*n)):(f+m*n)*Math.exp(-n*p),0===t||1===t?t:1-n}return e?y:function(){var e=r.springs[t];if(e)return e;for(var n=0,i=0;;)if(1===y(n+=1/6)){if(++i>=16)break}else i=0;var o=n*(1/6)*1e3;return r.springs[t]=o,o}}function u(t){return void 0===t&&(t=10),function(e){return Math.ceil(i(e,1e-6,1)*t)*(1/t)}}var p,d,h=function(){var t=11,e=1/(t-1);function n(t,e){return 1-3*e+3*t}function r(t,e){return 3*e-6*t}function i(t){return 3*t}function o(t,e,o){return((n(e,o)*t+r(e,o))*t+i(e))*t}function a(t,e,o){return 3*n(e,o)*t*t+2*r(e,o)*t+i(e)}return function(n,r,i,s){if(0<=n&&n<=1&&0<=i&&i<=1){var l=new Float32Array(t);if(n!==r||i!==s)for(var c=0;c<t;++c)l[c]=o(c*e,n,i);return function(t){return n===r&&i===s?t:0===t||1===t?t:o(u(t),r,s)}}function u(r){for(var s=0,c=1,u=t-1;c!==u&&l[c]<=r;++c)s+=e;var p=s+(r-l[--c])/(l[c+1]-l[c])*e,d=a(p,n,i);return d>=.001?function(t,e,n,r){for(var i=0;i<4;++i){var s=a(e,n,r);if(0===s)return e;e-=(o(e,n,r)-t)/s}return e}(r,p,n,i):0===d?p:function(t,e,n,r,i){for(var a,s,l=0;(a=o(s=e+(n-e)/2,r,i)-t)>0?n=s:e=s,Math.abs(a)>1e-7&&++l<10;);return s}(r,s,s+e,n,i)}}}(),f=(p={linear:function(){return function(t){return t}}},d={Sine:function(){return function(t){return 1-Math.cos(t*Math.PI/2)}},Circ:function(){return function(t){return 1-Math.sqrt(1-t*t)}},Back:function(){return function(t){return t*t*(3*t-2)}},Bounce:function(){return function(t){for(var e,n=4;t<((e=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*e-2)/22-t,2)}},Elastic:function(t,e){void 0===t&&(t=1),void 0===e&&(e=.5);var n=i(t,1,10),r=i(e,.1,2);return function(t){return 0===t||1===t?t:-n*Math.pow(2,10*(t-1))*Math.sin((t-1-r/(2*Math.PI)*Math.asin(1/n))*(2*Math.PI)/r)}}},["Quad","Cubic","Quart","Quint","Expo"].forEach(function(t,e){d[t]=function(){return function(t){return Math.pow(t,e+2)}}}),Object.keys(d).forEach(function(t){var e=d[t];p["easeIn"+t]=e,p["easeOut"+t]=function(t,n){return function(r){return 1-e(t,n)(1-r)}},p["easeInOut"+t]=function(t,n){return function(r){return r<.5?e(t,n)(2*r)/2:1-e(t,n)(-2*r+2)/2}},p["easeOutIn"+t]=function(t,n){return function(r){return r<.5?(1-e(t,n)(1-2*r))/2:(e(t,n)(2*r-1)+1)/2}}}),p);function m(t,e){if(s.fnc(t))return t;var n=t.split("(")[0],r=f[n],i=l(t);switch(n){case"spring":return c(t,e);case"cubicBezier":return a(h,i);case"steps":return a(u,i);default:return a(r,i)}}function y(t){try{return document.querySelectorAll(t)}catch(t){return}}function _(t,e){for(var n=t.length,r=arguments.length>=2?arguments[1]:void 0,i=[],o=0;o<n;o++)if(o in t){var a=t[o];e.call(r,a,o,t)&&i.push(a)}return i}function g(t){return t.reduce(function(t,e){return t.concat(s.arr(e)?g(e):e)},[])}function v(t){return s.arr(t)?t:(s.str(t)&&(t=y(t)||t),t instanceof NodeList||t instanceof HTMLCollection?[].slice.call(t):[t])}function b(t,e){return t.some(function(t){return t===e})}function x(t){var e={};for(var n in t)e[n]=t[n];return e}function w(t,e){var n=x(t);for(var r in t)n[r]=e.hasOwnProperty(r)?e[r]:t[r];return n}function E(t,e){var n=x(t);for(var r in e)n[r]=s.und(t[r])?e[r]:t[r];return n}function T(t){var e=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(t);if(e)return e[1]}function S(t,e){return s.fnc(t)?t(e.target,e.id,e.total):t}function M(t,e){return t.getAttribute(e)}function j(t,e,n){if(b([n,"deg","rad","turn"],T(e)))return e;var i=r.CSS[e+n];if(!s.und(i))return i;var o=document.createElement(t.tagName),a=t.parentNode&&t.parentNode!==document?t.parentNode:document.body;a.appendChild(o),o.style.position="absolute",o.style.width=100+n;var l=100/o.offsetWidth;a.removeChild(o);var c=l*parseFloat(e);return r.CSS[e+n]=c,c}function C(t,e,n){if(e in t.style){var r=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),i=t.style[e]||getComputedStyle(t).getPropertyValue(r)||"0";return n?j(t,i,n):i}}function z(t,e){return s.dom(t)&&!s.inp(t)&&(!s.nil(M(t,e))||s.svg(t)&&t[e])?"attribute":s.dom(t)&&b(n,e)?"transform":s.dom(t)&&"transform"!==e&&C(t,e)?"css":null!=t[e]?"object":void 0}function R(t){if(s.dom(t)){for(var e,n=t.style.transform||"",r=/(\w+)\(([^)]*)\)/g,i=new Map;e=r.exec(n);)i.set(e[1],e[2]);return i}}function A(t,e,n,r){switch(z(t,e)){case"transform":return function(t,e,n,r){var i,a=o(e,"scale")?1:0+(o(i=e,"translate")||"perspective"===i?"px":o(i,"rotate")||o(i,"skew")?"deg":void 0),s=R(t).get(e)||a;return n&&(n.transforms.list.set(e,s),n.transforms.last=e),r?j(t,s,r):s}(t,e,r,n);case"css":return C(t,e,n);case"attribute":return M(t,e);default:return t[e]||0}}function L(t,e){var n=/^(\*=|\+=|-=)/.exec(t);if(!n)return t;var r=T(t)||0,i=parseFloat(e),o=parseFloat(t.replace(n[0],""));switch(n[0][0]){case"+":return i+o+r;case"-":return i-o+r;case"*":return i*o+r}}function I(t,e){if(s.col(t))return function(t){return s.rgb(t)?(n=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e=t))?"rgba("+n[1]+",1)":e:s.hex(t)?(r=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,n,r){return e+e+n+n+r+r}),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r),"rgba("+parseInt(i[1],16)+","+parseInt(i[2],16)+","+parseInt(i[3],16)+",1)"):s.hsl(t)?function(t){var e,n,r,i=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(t),o=parseInt(i[1],10)/360,a=parseInt(i[2],10)/100,s=parseInt(i[3],10)/100,l=i[4]||1;function c(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}if(0==a)e=n=r=s;else{var u=s<.5?s*(1+a):s+a-s*a,p=2*s-u;e=c(p,u,o+1/3),n=c(p,u,o),r=c(p,u,o-1/3)}return"rgba("+255*e+","+255*n+","+255*r+","+l+")"}(t):void 0;var e,n,r,i}(t);if(/\s/g.test(t))return t;var n=T(t),r=n?t.substr(0,t.length-n.length):t;return e?r+e:r}function P(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function O(t){for(var e,n=t.points,r=0,i=0;i<n.numberOfItems;i++){var o=n.getItem(i);i>0&&(r+=P(e,o)),e=o}return r}function k(t){if(t.getTotalLength)return t.getTotalLength();switch(t.tagName.toLowerCase()){case"circle":return o=t,2*Math.PI*M(o,"r");case"rect":return 2*M(i=t,"width")+2*M(i,"height");case"line":return P({x:M(r=t,"x1"),y:M(r,"y1")},{x:M(r,"x2"),y:M(r,"y2")});case"polyline":return O(t);case"polygon":return n=(e=t).points,O(e)+P(n.getItem(n.numberOfItems-1),n.getItem(0))}var e,n,r,i,o}function B(t,e){var n=e||{},r=n.el||function(t){for(var e=t.parentNode;s.svg(e)&&s.svg(e.parentNode);)e=e.parentNode;return e}(t),i=r.getBoundingClientRect(),o=M(r,"viewBox"),a=i.width,l=i.height,c=n.viewBox||(o?o.split(" "):[0,0,a,l]);return{el:r,viewBox:c,x:c[0]/1,y:c[1]/1,w:a,h:l,vW:c[2],vH:c[3]}}function D(t,e,n){function r(n){void 0===n&&(n=0);var r=e+n>=1?e+n:0;return t.el.getPointAtLength(r)}var i=B(t.el,t.svg),o=r(),a=r(-1),s=r(1),l=n?1:i.w/i.vW,c=n?1:i.h/i.vH;switch(t.property){case"x":return(o.x-i.x)*l;case"y":return(o.y-i.y)*c;case"angle":return 180*Math.atan2(s.y-a.y,s.x-a.x)/Math.PI}}function H(t,e){var n=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,r=I(s.pth(t)?t.totalLength:t,e)+"";return{original:r,numbers:r.match(n)?r.match(n).map(Number):[0],strings:s.str(t)||e?r.split(n):[]}}function F(t){return _(t?g(s.arr(t)?t.map(v):v(t)):[],function(t,e,n){return n.indexOf(t)===e})}function N(t){var e=F(t);return e.map(function(t,n){return{target:t,id:n,total:e.length,transforms:{list:R(t)}}})}function U(t,e){var n=x(e);if(/^spring/.test(n.easing)&&(n.duration=c(n.easing)),s.arr(t)){var r=t.length;2!==r||s.obj(t[0])?s.fnc(e.duration)||(n.duration=e.duration/r):t={value:t}}var i=s.arr(t)?t:[t];return i.map(function(t,n){var r=s.obj(t)&&!s.pth(t)?t:{value:t};return s.und(r.delay)&&(r.delay=n?0:e.delay),s.und(r.endDelay)&&(r.endDelay=n===i.length-1?e.endDelay:0),r}).map(function(t){return E(t,n)})}function V(t,e){var n=[],r=e.keyframes;for(var i in r&&(e=E(function(t){for(var e=_(g(t.map(function(t){return Object.keys(t)})),function(t){return s.key(t)}).reduce(function(t,e){return t.indexOf(e)<0&&t.push(e),t},[]),n={},r=function(r){var i=e[r];n[i]=t.map(function(t){var e={};for(var n in t)s.key(n)?n==i&&(e.value=t[n]):e[n]=t[n];return e})},i=0;i<e.length;i++)r(i);return n}(r),e)),e)s.key(i)&&n.push({name:i,tweens:U(e[i],t)});return n}var G={css:function(t,e,n){return t.style[e]=n},attribute:function(t,e,n){return t.setAttribute(e,n)},object:function(t,e,n){return t[e]=n},transform:function(t,e,n,r,i){if(r.list.set(e,n),e===r.last||i){var o="";r.list.forEach(function(t,e){o+=e+"("+t+") "}),t.style.transform=o}}};function W(t,e){N(t).forEach(function(t){for(var n in e){var r=S(e[n],t),i=t.target,o=T(r),a=A(i,n,o,t),s=L(I(r,o||T(a)),a),l=z(i,n);G[l](i,n,s,t.transforms,!0)}})}function q(t,e){return _(g(t.map(function(t){return e.map(function(e){return function(t,e){var n=z(t.target,e.name);if(n){var r=function(t,e){var n;return t.tweens.map(function(r){var i=function(t,e){var n={};for(var r in t){var i=S(t[r],e);s.arr(i)&&1===(i=i.map(function(t){return S(t,e)})).length&&(i=i[0]),n[r]=i}return n.duration=parseFloat(n.duration),n.delay=parseFloat(n.delay),n}(r,e),o=i.value,a=s.arr(o)?o[1]:o,l=T(a),c=A(e.target,t.name,l,e),u=n?n.to.original:c,p=s.arr(o)?o[0]:u,d=T(p)||T(c),h=l||d;return s.und(a)&&(a=u),i.from=H(p,h),i.to=H(L(a,p),h),i.start=n?n.end:0,i.end=i.start+i.delay+i.duration+i.endDelay,i.easing=m(i.easing,i.duration),i.isPath=s.pth(o),i.isPathTargetInsideSVG=i.isPath&&s.svg(e.target),i.isColor=s.col(i.from.original),i.isColor&&(i.round=1),n=i,i})}(e,t),i=r[r.length-1];return{type:n,property:e.name,animatable:t,tweens:r,duration:i.end,delay:r[0].delay,endDelay:i.endDelay}}}(t,e)})})),function(t){return!s.und(t)})}function X(t,e){var n=t.length,r=function(t){return t.timelineOffset?t.timelineOffset:0},i={};return i.duration=n?Math.max.apply(Math,t.map(function(t){return r(t)+t.duration})):e.duration,i.delay=n?Math.min.apply(Math,t.map(function(t){return r(t)+t.delay})):e.delay,i.endDelay=n?i.duration-Math.max.apply(Math,t.map(function(t){return r(t)+t.duration-t.endDelay})):e.endDelay,i}var Y=0,Q=[],Z=function(){var t;function e(n){for(var r=Q.length,i=0;i<r;){var o=Q[i];o.paused?(Q.splice(i,1),r--):(o.tick(n),i++)}t=i>0?requestAnimationFrame(e):void 0}return"undefined"!=typeof document&&document.addEventListener("visibilitychange",function(){K.suspendWhenDocumentHidden&&(J()?t=cancelAnimationFrame(t):(Q.forEach(function(t){return t._onDocumentVisibility()}),Z()))}),function(){t||J()&&K.suspendWhenDocumentHidden||!(Q.length>0)||(t=requestAnimationFrame(e))}}();function J(){return!!document&&document.hidden}function K(n){void 0===n&&(n={});var r,o=0,a=0,s=0,l=0,c=null;function u(t){var e=window.Promise&&new Promise(function(t){return c=t});return t.finished=e,e}var p,d,h,f,m,y,g,v,b=(d=w(t,p=n),f=V(h=w(e,p),p),g=X(y=q(m=N(p.targets),f),h),v=Y,Y++,E(d,{id:v,children:[],animatables:m,animations:y,duration:g.duration,delay:g.delay,endDelay:g.endDelay}));function x(){var t=b.direction;"alternate"!==t&&(b.direction="normal"!==t?"normal":"reverse"),b.reversed=!b.reversed,r.forEach(function(t){return t.reversed=b.reversed})}function T(t){return b.reversed?b.duration-t:t}function S(){o=0,a=T(b.currentTime)*(1/K.speed)}function M(t,e){e&&e.seek(t-e.timelineOffset)}function j(t){for(var e=0,n=b.animations,r=n.length;e<r;){var o=n[e],a=o.animatable,s=o.tweens,l=s.length-1,c=s[l];l&&(c=_(s,function(e){return t<e.end})[0]||c);for(var u=i(t-c.start-c.delay,0,c.duration)/c.duration,p=isNaN(u)?1:c.easing(u),d=c.to.strings,h=c.round,f=[],m=c.to.numbers.length,y=void 0,g=0;g<m;g++){var v=void 0,x=c.to.numbers[g],w=c.from.numbers[g]||0;v=c.isPath?D(c.value,p*x,c.isPathTargetInsideSVG):w+p*(x-w),h&&(c.isColor&&g>2||(v=Math.round(v*h)/h)),f.push(v)}var E=d.length;if(E){y=d[0];for(var T=0;T<E;T++){d[T];var S=d[T+1],M=f[T];isNaN(M)||(y+=S?M+S:M+" ")}}else y=f[0];G[o.type](a.target,o.property,y,a.transforms),o.currentValue=y,e++}}function C(t){b[t]&&!b.passThrough&&b[t](b)}function z(t){var e=b.duration,n=b.delay,p=e-b.endDelay,d=T(t);b.progress=i(d/e*100,0,100),b.reversePlayback=d<b.currentTime,r&&function(t){if(b.reversePlayback)for(var e=l;e--;)M(t,r[e]);else for(var n=0;n<l;n++)M(t,r[n])}(d),!b.began&&b.currentTime>0&&(b.began=!0,C("begin")),!b.loopBegan&&b.currentTime>0&&(b.loopBegan=!0,C("loopBegin")),d<=n&&0!==b.currentTime&&j(0),(d>=p&&b.currentTime!==e||!e)&&j(e),d>n&&d<p?(b.changeBegan||(b.changeBegan=!0,b.changeCompleted=!1,C("changeBegin")),C("change"),j(d)):b.changeBegan&&(b.changeCompleted=!0,b.changeBegan=!1,C("changeComplete")),b.currentTime=i(d,0,e),b.began&&C("update"),t>=e&&(a=0,b.remaining&&!0!==b.remaining&&b.remaining--,b.remaining?(o=s,C("loopComplete"),b.loopBegan=!1,"alternate"===b.direction&&x()):(b.paused=!0,b.completed||(b.completed=!0,C("loopComplete"),C("complete"),!b.passThrough&&"Promise"in window&&(c(),u(b)))))}return u(b),b.reset=function(){var t=b.direction;b.passThrough=!1,b.currentTime=0,b.progress=0,b.paused=!0,b.began=!1,b.loopBegan=!1,b.changeBegan=!1,b.completed=!1,b.changeCompleted=!1,b.reversePlayback=!1,b.reversed="reverse"===t,b.remaining=b.loop,r=b.children;for(var e=l=r.length;e--;)b.children[e].reset();(b.reversed&&!0!==b.loop||"alternate"===t&&1===b.loop)&&b.remaining++,j(b.reversed?b.duration:0)},b._onDocumentVisibility=S,b.set=function(t,e){return W(t,e),b},b.tick=function(t){s=t,o||(o=s),z((s+(a-o))*K.speed)},b.seek=function(t){z(T(t))},b.pause=function(){b.paused=!0,S()},b.play=function(){b.paused&&(b.completed&&b.reset(),b.paused=!1,Q.push(b),S(),Z())},b.reverse=function(){x(),b.completed=!b.reversed,S()},b.restart=function(){b.reset(),b.play()},b.remove=function(t){tt(F(t),b)},b.reset(),b.autoplay&&b.play(),b}function $(t,e){for(var n=e.length;n--;)b(t,e[n].animatable.target)&&e.splice(n,1)}function tt(t,e){var n=e.animations,r=e.children;$(t,n);for(var i=r.length;i--;){var o=r[i],a=o.animations;$(t,a),a.length||o.children.length||r.splice(i,1)}n.length||r.length||e.pause()}return K.version="3.2.1",K.speed=1,K.suspendWhenDocumentHidden=!0,K.running=Q,K.remove=function(t){for(var e=F(t),n=Q.length;n--;)tt(e,Q[n])},K.get=A,K.set=W,K.convertPx=j,K.path=function(t,e){var n=s.str(t)?y(t)[0]:t,r=e||100;return function(t){return{property:t,el:n,svg:B(n),totalLength:k(n)*(r/100)}}},K.setDashoffset=function(t){var e=k(t);return t.setAttribute("stroke-dasharray",e),e},K.stagger=function(t,e){void 0===e&&(e={});var n=e.direction||"normal",r=e.easing?m(e.easing):null,i=e.grid,o=e.axis,a=e.from||0,l="first"===a,c="center"===a,u="last"===a,p=s.arr(t),d=p?parseFloat(t[0]):parseFloat(t),h=p?parseFloat(t[1]):0,f=T(p?t[1]:t)||0,y=e.start||0+(p?d:0),_=[],g=0;return function(t,e,s){if(l&&(a=0),c&&(a=(s-1)/2),u&&(a=s-1),!_.length){for(var m=0;m<s;m++){if(i){var v=c?(i[0]-1)/2:a%i[0],b=c?(i[1]-1)/2:Math.floor(a/i[0]),x=v-m%i[0],w=b-Math.floor(m/i[0]),E=Math.sqrt(x*x+w*w);"x"===o&&(E=-x),"y"===o&&(E=-w),_.push(E)}else _.push(Math.abs(a-m));g=Math.max.apply(Math,_)}r&&(_=_.map(function(t){return r(t/g)*g})),"reverse"===n&&(_=_.map(function(t){return o?t<0?-1*t:-t:Math.abs(g-t)}))}return y+(p?(h-d)/g:d)*(Math.round(100*_[e])/100)+f}},K.timeline=function(t){void 0===t&&(t={});var n=K(t);return n.duration=0,n.add=function(r,i){var o=Q.indexOf(n),a=n.children;function l(t){t.passThrough=!0}o>-1&&Q.splice(o,1);for(var c=0;c<a.length;c++)l(a[c]);var u=E(r,w(e,t));u.targets=u.targets||t.targets;var p=n.duration;u.autoplay=!1,u.direction=n.direction,u.timelineOffset=s.und(i)?p:L(i,p),l(n),n.seek(u.timelineOffset);var d=K(u);l(d),a.push(d);var h=X(a,t);return n.delay=h.delay,n.endDelay=h.endDelay,n.duration=h.duration,n.seek(0),n.reset(),n.autoplay&&n.play(),n},n},K.easing=m,K.penner=f,K.random=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},K});var g,v=(g="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(t){var e,n;t=t||{},n||(n=void 0!==t?t:{});var r,i={};for(r in n)n.hasOwnProperty(r)&&(i[r]=n[r]);var o,a,s=!1,l=!1;s="object"==typeof window,l="function"==typeof importScripts,o="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node&&!s&&!l,a=!s&&!o&&!l;var c,u,p,d,h="";o?(h=__dirname+"/",c=function(t,e){return p||(p=require("fs")),d||(d=require("path")),t=d.normalize(t),t=p.readFileSync(t),e?t:t.toString()},u=function(t){return(t=c(t,!0)).buffer||(t=new Uint8Array(t)),w(t.buffer),t},1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(t){throw t}),process.on("unhandledRejection",G),n.inspect=function(){return"[Emscripten Module object]"}):a?("undefined"!=typeof read&&(c=function(t){return read(t)}),u=function(t){return"function"==typeof readbuffer?new Uint8Array(readbuffer(t)):(w("object"==typeof(t=read(t,"binary"))),t)},"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)):(s||l)&&(l?h=self.location.href:document.currentScript&&(h=document.currentScript.src),g&&(h=g),h=0!==h.indexOf("blob:")?h.substr(0,h.lastIndexOf("/")+1):"",c=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},l&&(u=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}));var f=n.print||console.log.bind(console),m=n.printErr||console.warn.bind(console);for(r in i)i.hasOwnProperty(r)&&(n[r]=i[r]);i=null;var y,_={"f64-rem":function(t,e){return t%e},debugger:function(){}};n.wasmBinary&&(y=n.wasmBinary),"object"!=typeof WebAssembly&&m("no native wasm support detected");var v,b=new WebAssembly.Table({initial:1422,maximum:1422,element:"anyfunc"}),x=!1;function w(t,e){t||G("Assertion failed: "+e)}var E="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function T(t,e,n){var r=e+n;for(n=e;t[n]&&!(n>=r);)++n;if(16<n-e&&t.subarray&&E)return E.decode(t.subarray(e,n));for(r="";e<n;){var i=t[e++];if(128&i){var o=63&t[e++];if(192==(224&i))r+=String.fromCharCode((31&i)<<6|o);else{var a=63&t[e++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|a:(7&i)<<18|o<<12|a<<6|63&t[e++])?r+=String.fromCharCode(i):(i-=65536,r+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else r+=String.fromCharCode(i)}return r}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var S,M,j,C,z,R=n.TOTAL_MEMORY||67108864;(v=n.wasmMemory?n.wasmMemory:new WebAssembly.Memory({initial:R/65536,maximum:R/65536}))&&(S=v.buffer),R=S.byteLength;var A=S;function L(t){for(;0<t.length;){var e=t.shift();if("function"==typeof e)e();else{var r=e.iA;"number"==typeof r?void 0===e.Oz?n.dynCall_v(r):n.dynCall_vi(r,e.Oz):r(void 0===e.Oz?null:e.Oz)}}}S=A,n.HEAP8=M=new Int8Array(A),n.HEAP16=new Int16Array(A),n.HEAP32=C=new Int32Array(A),n.HEAPU8=j=new Uint8Array(A),n.HEAPU16=new Uint16Array(A),n.HEAPU32=new Uint32Array(A),n.HEAPF32=z=new Float32Array(A),n.HEAPF64=new Float64Array(A),C[7612]=5273536;var I=[],P=[],O=[],k=[],B=!1;function D(){var t=n.preRun.shift();I.unshift(t)}var H=Math.cos,F=Math.sin,N=0,U=null,V=null;function G(t){throw n.onAbort&&n.onAbort(t),f(t+=""),m(t),x=!0,"abort("+t+"). Build with -s ASSERTIONS=1 for more info."}function W(){var t=q;return String.prototype.startsWith?t.startsWith("data:application/octet-stream;base64,"):0===t.indexOf("data:application/octet-stream;base64,")}n.preloadedImages={},n.preloadedAudios={};var q="ammo.wasm.wasm";if(!W()){var X=q;q=n.locateFile?n.locateFile(X,h):h+X}function Y(){try{if(y)return new Uint8Array(y);if(u)return u(q);throw"both async and sync fetching of the wasm failed"}catch(t){G(t)}}n.asm=function(){function t(t){n.asm=t.exports,N--,n.monitorRunDependencies&&n.monitorRunDependencies(N),0==N&&(null!==U&&(clearInterval(U),U=null),V&&(t=V,V=null,t()))}function e(e){t(e.instance)}function r(t){return(y||!s&&!l||"function"!=typeof fetch?new Promise(function(t){t(Y())}):fetch(q,{credentials:"same-origin"}).then(function(t){if(!t.ok)throw"failed to load wasm binary file at '"+q+"'";return t.arrayBuffer()}).catch(function(){return Y()})).then(function(t){return WebAssembly.instantiate(t,i)}).then(t,function(t){m("failed to asynchronously prepare wasm: "+t),G(t)})}var i={env:J,wasi_unstable:J,global:{NaN:NaN,Infinity:1/0},"global.Math":Math,asm2wasm:_};if(N++,n.monitorRunDependencies&&n.monitorRunDependencies(N),n.instantiateWasm)try{return n.instantiateWasm(i,t)}catch(t){return m("Module.instantiateWasm callback failed with error: "+t),!1}return function(){if(y||"function"!=typeof WebAssembly.instantiateStreaming||W()||"function"!=typeof fetch)return r(e);fetch(q,{credentials:"same-origin"}).then(function(t){return WebAssembly.instantiateStreaming(t,i).then(e,function(t){m("wasm streaming compile failed: "+t),m("falling back to ArrayBuffer instantiation"),r(e)})})}(),{}};var Q=[function(t,e,r,i,o,a,s,l){if(!(t=n.getCache(n.ConcreteContactResultCallback)[t]).hasOwnProperty("addSingleResult"))throw"a JSImplementation must implement all functions, you forgot ConcreteContactResultCallback::addSingleResult.";return t.addSingleResult(e,r,i,o,a,s,l)},function(t,e,r,i){if(!(t=n.getCache(n.DebugDrawer)[t]).hasOwnProperty("drawLine"))throw"a JSImplementation must implement all functions, you forgot DebugDrawer::drawLine.";t.drawLine(e,r,i)},function(t,e,r,i,o,a){if(!(t=n.getCache(n.DebugDrawer)[t]).hasOwnProperty("drawContactPoint"))throw"a JSImplementation must implement all functions, you forgot DebugDrawer::drawContactPoint.";t.drawContactPoint(e,r,i,o,a)},function(t,e){if(!(t=n.getCache(n.DebugDrawer)[t]).hasOwnProperty("reportErrorWarning"))throw"a JSImplementation must implement all functions, you forgot DebugDrawer::reportErrorWarning.";t.reportErrorWarning(e)},function(t,e,r){if(!(t=n.getCache(n.DebugDrawer)[t]).hasOwnProperty("draw3dText"))throw"a JSImplementation must implement all functions, you forgot DebugDrawer::draw3dText.";t.draw3dText(e,r)},function(t,e){if(!(t=n.getCache(n.DebugDrawer)[t]).hasOwnProperty("setDebugMode"))throw"a JSImplementation must implement all functions, you forgot DebugDrawer::setDebugMode.";t.setDebugMode(e)},function(t){if(!(t=n.getCache(n.DebugDrawer)[t]).hasOwnProperty("getDebugMode"))throw"a JSImplementation must implement all functions, you forgot DebugDrawer::getDebugMode.";return t.getDebugMode()}];P.push({iA:function(){tt()}});var Z=[null,[],[]],J={r:function(){return function(){return 0}.apply(null,arguments)},n:function(){return function(){return 0}.apply(null,arguments)},m:function(){return function(t,e,n,r){try{for(var i=0,o=0;o<n;o++){for(var a=C[e+8*o>>2],s=C[e+(8*o+4)>>2],l=0;l<s;l++){var c=j[a+l],u=Z[t];0===c||10===c?((1===t?f:m)(T(u,0)),u.length=0):u.push(c)}i+=s}return C[r>>2]=i,0}catch(t){return G(t),t.EF}}.apply(null,arguments)},__memory_base:1024,__table_base:0,l:function(){G()},k:function(t,e,n,r,i,o,a,s,l){return Q[t](e,n,r,i,o,a,s,l)},j:function(t,e){return Q[t](e)},f:function(t,e,n){return Q[t](e,n)},i:function(t,e,n,r){return Q[t](e,n,r)},h:function(t,e,n,r,i,o,a){return Q[t](e,n,r,i,o,a)},g:function(t,e,n,r,i){return Q[t](e,n,r,i)},d:function(){return M.length},q:function(t,e,n){j.set(j.subarray(e,e+n),t)},c:function(){G("OOM")},b:function(t){var e=Date.now();return C[t>>2]=e/1e3|0,C[t+4>>2]=e%1e3*1e3|0,0},p:H,o:F,e:function(){G("trap!")},a:G,memory:v,table:b},K=n.asm({},J,S);n.asm=K;var $,tt=n.__GLOBAL__sub_I_btQuickprof_cpp=function(){return n.asm.s.apply(null,arguments)},et=n._emscripten_bind_AllHitsRayResultCallback_AllHitsRayResultCallback_2=function(){return n.asm.t.apply(null,arguments)},nt=n._emscripten_bind_AllHitsRayResultCallback___destroy___0=function(){return n.asm.u.apply(null,arguments)},rt=n._emscripten_bind_AllHitsRayResultCallback_get_m_closestHitFraction_0=function(){return n.asm.v.apply(null,arguments)},it=n._emscripten_bind_AllHitsRayResultCallback_get_m_collisionFilterGroup_0=function(){return n.asm.w.apply(null,arguments)},ot=n._emscripten_bind_AllHitsRayResultCallback_get_m_collisionFilterMask_0=function(){return n.asm.x.apply(null,arguments)},at=n._emscripten_bind_AllHitsRayResultCallback_get_m_collisionObject_0=function(){return n.asm.y.apply(null,arguments)},st=n._emscripten_bind_AllHitsRayResultCallback_get_m_collisionObjects_0=function(){return n.asm.z.apply(null,arguments)},lt=n._emscripten_bind_AllHitsRayResultCallback_get_m_hitFractions_0=function(){return n.asm.A.apply(null,arguments)},ct=n._emscripten_bind_AllHitsRayResultCallback_get_m_hitNormalWorld_0=function(){return n.asm.B.apply(null,arguments)},ut=n._emscripten_bind_AllHitsRayResultCallback_get_m_hitPointWorld_0=function(){return n.asm.C.apply(null,arguments)},pt=n._emscripten_bind_AllHitsRayResultCallback_get_m_rayFromWorld_0=function(){return n.asm.D.apply(null,arguments)},dt=n._emscripten_bind_AllHitsRayResultCallback_get_m_rayToWorld_0=function(){return n.asm.E.apply(null,arguments)},ht=n._emscripten_bind_AllHitsRayResultCallback_hasHit_0=function(){return n.asm.F.apply(null,arguments)},ft=n._emscripten_bind_AllHitsRayResultCallback_set_m_closestHitFraction_1=function(){return n.asm.G.apply(null,arguments)},mt=n._emscripten_bind_AllHitsRayResultCallback_set_m_collisionFilterGroup_1=function(){return n.asm.H.apply(null,arguments)},yt=n._emscripten_bind_AllHitsRayResultCallback_set_m_collisionFilterMask_1=function(){return n.asm.I.apply(null,arguments)},_t=n._emscripten_bind_AllHitsRayResultCallback_set_m_collisionObject_1=function(){return n.asm.J.apply(null,arguments)},gt=n._emscripten_bind_AllHitsRayResultCallback_set_m_collisionObjects_1=function(){return n.asm.K.apply(null,arguments)},vt=n._emscripten_bind_AllHitsRayResultCallback_set_m_hitFractions_1=function(){return n.asm.L.apply(null,arguments)},bt=n._emscripten_bind_AllHitsRayResultCallback_set_m_hitNormalWorld_1=function(){return n.asm.M.apply(null,arguments)},xt=n._emscripten_bind_AllHitsRayResultCallback_set_m_hitPointWorld_1=function(){return n.asm.N.apply(null,arguments)},wt=n._emscripten_bind_AllHitsRayResultCallback_set_m_rayFromWorld_1=function(){return n.asm.O.apply(null,arguments)},Et=n._emscripten_bind_AllHitsRayResultCallback_set_m_rayToWorld_1=function(){return n.asm.P.apply(null,arguments)},Tt=n._emscripten_bind_Anchor___destroy___0=function(){return n.asm.Q.apply(null,arguments)},St=n._emscripten_bind_Anchor_get_m_body_0=function(){return n.asm.R.apply(null,arguments)},Mt=n._emscripten_bind_Anchor_get_m_c0_0=function(){return n.asm.S.apply(null,arguments)},jt=n._emscripten_bind_Anchor_get_m_c1_0=function(){return n.asm.T.apply(null,arguments)},Ct=n._emscripten_bind_Anchor_get_m_c2_0=function(){return n.asm.U.apply(null,arguments)},zt=n._emscripten_bind_Anchor_get_m_influence_0=function(){return n.asm.V.apply(null,arguments)},Rt=n._emscripten_bind_Anchor_get_m_local_0=function(){return n.asm.W.apply(null,arguments)},At=n._emscripten_bind_Anchor_get_m_node_0=function(){return n.asm.X.apply(null,arguments)},Lt=n._emscripten_bind_Anchor_set_m_body_1=function(){return n.asm.Y.apply(null,arguments)},It=n._emscripten_bind_Anchor_set_m_c0_1=function(){return n.asm.Z.apply(null,arguments)},Pt=n._emscripten_bind_Anchor_set_m_c1_1=function(){return n.asm._.apply(null,arguments)},Ot=n._emscripten_bind_Anchor_set_m_c2_1=function(){return n.asm.$.apply(null,arguments)},kt=n._emscripten_bind_Anchor_set_m_influence_1=function(){return n.asm.aa.apply(null,arguments)},Bt=n._emscripten_bind_Anchor_set_m_local_1=function(){return n.asm.ba.apply(null,arguments)},Dt=n._emscripten_bind_Anchor_set_m_node_1=function(){return n.asm.ca.apply(null,arguments)},Ht=n._emscripten_bind_ClosestConvexResultCallback_ClosestConvexResultCallback_2=function(){return n.asm.da.apply(null,arguments)},Ft=n._emscripten_bind_ClosestConvexResultCallback___destroy___0=function(){return n.asm.ea.apply(null,arguments)},Nt=n._emscripten_bind_ClosestConvexResultCallback_get_m_closestHitFraction_0=function(){return n.asm.fa.apply(null,arguments)},Ut=n._emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterGroup_0=function(){return n.asm.ga.apply(null,arguments)},Vt=n._emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterMask_0=function(){return n.asm.ha.apply(null,arguments)},Gt=n._emscripten_bind_ClosestConvexResultCallback_get_m_convexFromWorld_0=function(){return n.asm.ia.apply(null,arguments)},Wt=n._emscripten_bind_ClosestConvexResultCallback_get_m_convexToWorld_0=function(){return n.asm.ja.apply(null,arguments)},qt=n._emscripten_bind_ClosestConvexResultCallback_get_m_hitCollisionObject_0=function(){return n.asm.ka.apply(null,arguments)},Xt=n._emscripten_bind_ClosestConvexResultCallback_get_m_hitNormalWorld_0=function(){return n.asm.la.apply(null,arguments)},Yt=n._emscripten_bind_ClosestConvexResultCallback_get_m_hitPointWorld_0=function(){return n.asm.ma.apply(null,arguments)},Qt=n._emscripten_bind_ClosestConvexResultCallback_hasHit_0=function(){return n.asm.na.apply(null,arguments)},Zt=n._emscripten_bind_ClosestConvexResultCallback_set_m_closestHitFraction_1=function(){return n.asm.oa.apply(null,arguments)},Jt=n._emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterGroup_1=function(){return n.asm.pa.apply(null,arguments)},Kt=n._emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterMask_1=function(){return n.asm.qa.apply(null,arguments)},$t=n._emscripten_bind_ClosestConvexResultCallback_set_m_convexFromWorld_1=function(){return n.asm.ra.apply(null,arguments)},te=n._emscripten_bind_ClosestConvexResultCallback_set_m_convexToWorld_1=function(){return n.asm.sa.apply(null,arguments)},ee=n._emscripten_bind_ClosestConvexResultCallback_set_m_hitCollisionObject_1=function(){return n.asm.ta.apply(null,arguments)},ne=n._emscripten_bind_ClosestConvexResultCallback_set_m_hitNormalWorld_1=function(){return n.asm.ua.apply(null,arguments)},re=n._emscripten_bind_ClosestConvexResultCallback_set_m_hitPointWorld_1=function(){return n.asm.va.apply(null,arguments)},ie=n._emscripten_bind_ClosestRayResultCallback_ClosestRayResultCallback_2=function(){return n.asm.wa.apply(null,arguments)},oe=n._emscripten_bind_ClosestRayResultCallback___destroy___0=function(){return n.asm.xa.apply(null,arguments)},ae=n._emscripten_bind_ClosestRayResultCallback_get_m_closestHitFraction_0=function(){return n.asm.ya.apply(null,arguments)},se=n._emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterGroup_0=function(){return n.asm.za.apply(null,arguments)},le=n._emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterMask_0=function(){return n.asm.Aa.apply(null,arguments)},ce=n._emscripten_bind_ClosestRayResultCallback_get_m_collisionObject_0=function(){return n.asm.Ba.apply(null,arguments)},ue=n._emscripten_bind_ClosestRayResultCallback_get_m_hitNormalWorld_0=function(){return n.asm.Ca.apply(null,arguments)},pe=n._emscripten_bind_ClosestRayResultCallback_get_m_hitPointWorld_0=function(){return n.asm.Da.apply(null,arguments)},de=n._emscripten_bind_ClosestRayResultCallback_get_m_rayFromWorld_0=function(){return n.asm.Ea.apply(null,arguments)},he=n._emscripten_bind_ClosestRayResultCallback_get_m_rayToWorld_0=function(){return n.asm.Fa.apply(null,arguments)},fe=n._emscripten_bind_ClosestRayResultCallback_hasHit_0=function(){return n.asm.Ga.apply(null,arguments)},me=n._emscripten_bind_ClosestRayResultCallback_set_m_closestHitFraction_1=function(){return n.asm.Ha.apply(null,arguments)},ye=n._emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterGroup_1=function(){return n.asm.Ia.apply(null,arguments)},_e=n._emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterMask_1=function(){return n.asm.Ja.apply(null,arguments)},ge=n._emscripten_bind_ClosestRayResultCallback_set_m_collisionObject_1=function(){return n.asm.Ka.apply(null,arguments)},ve=n._emscripten_bind_ClosestRayResultCallback_set_m_hitNormalWorld_1=function(){return n.asm.La.apply(null,arguments)},be=n._emscripten_bind_ClosestRayResultCallback_set_m_hitPointWorld_1=function(){return n.asm.Ma.apply(null,arguments)},xe=n._emscripten_bind_ClosestRayResultCallback_set_m_rayFromWorld_1=function(){return n.asm.Na.apply(null,arguments)},we=n._emscripten_bind_ClosestRayResultCallback_set_m_rayToWorld_1=function(){return n.asm.Oa.apply(null,arguments)},Ee=n._emscripten_bind_ConcreteContactResultCallback_ConcreteContactResultCallback_0=function(){return n.asm.Pa.apply(null,arguments)},Te=n._emscripten_bind_ConcreteContactResultCallback___destroy___0=function(){return n.asm.Qa.apply(null,arguments)},Se=n._emscripten_bind_ConcreteContactResultCallback_addSingleResult_7=function(){return n.asm.Ra.apply(null,arguments)},Me=n._emscripten_bind_Config___destroy___0=function(){return n.asm.Sa.apply(null,arguments)},je=n._emscripten_bind_Config_get_citerations_0=function(){return n.asm.Ta.apply(null,arguments)},Ce=n._emscripten_bind_Config_get_collisions_0=function(){return n.asm.Ua.apply(null,arguments)},ze=n._emscripten_bind_Config_get_diterations_0=function(){return n.asm.Va.apply(null,arguments)},Re=n._emscripten_bind_Config_get_kAHR_0=function(){return n.asm.Wa.apply(null,arguments)},Ae=n._emscripten_bind_Config_get_kCHR_0=function(){return n.asm.Xa.apply(null,arguments)},Le=n._emscripten_bind_Config_get_kDF_0=function(){return n.asm.Ya.apply(null,arguments)},Ie=n._emscripten_bind_Config_get_kDG_0=function(){return n.asm.Za.apply(null,arguments)},Pe=n._emscripten_bind_Config_get_kDP_0=function(){return n.asm._a.apply(null,arguments)},Oe=n._emscripten_bind_Config_get_kKHR_0=function(){return n.asm.$a.apply(null,arguments)},ke=n._emscripten_bind_Config_get_kLF_0=function(){return n.asm.ab.apply(null,arguments)},Be=n._emscripten_bind_Config_get_kMT_0=function(){return n.asm.bb.apply(null,arguments)},De=n._emscripten_bind_Config_get_kPR_0=function(){return n.asm.cb.apply(null,arguments)},He=n._emscripten_bind_Config_get_kSHR_0=function(){return n.asm.db.apply(null,arguments)},Fe=n._emscripten_bind_Config_get_kSKHR_CL_0=function(){return n.asm.eb.apply(null,arguments)},Ne=n._emscripten_bind_Config_get_kSK_SPLT_CL_0=function(){return n.asm.fb.apply(null,arguments)},Ue=n._emscripten_bind_Config_get_kSRHR_CL_0=function(){return n.asm.gb.apply(null,arguments)},Ve=n._emscripten_bind_Config_get_kSR_SPLT_CL_0=function(){return n.asm.hb.apply(null,arguments)},Ge=n._emscripten_bind_Config_get_kSSHR_CL_0=function(){return n.asm.ib.apply(null,arguments)},We=n._emscripten_bind_Config_get_kSS_SPLT_CL_0=function(){return n.asm.jb.apply(null,arguments)},qe=n._emscripten_bind_Config_get_kVCF_0=function(){return n.asm.kb.apply(null,arguments)},Xe=n._emscripten_bind_Config_get_kVC_0=function(){return n.asm.lb.apply(null,arguments)},Ye=n._emscripten_bind_Config_get_maxvolume_0=function(){return n.asm.mb.apply(null,arguments)},Qe=n._emscripten_bind_Config_get_piterations_0=function(){return n.asm.nb.apply(null,arguments)},Ze=n._emscripten_bind_Config_get_timescale_0=function(){return n.asm.ob.apply(null,arguments)},Je=n._emscripten_bind_Config_get_viterations_0=function(){return n.asm.pb.apply(null,arguments)},Ke=n._emscripten_bind_Config_set_citerations_1=function(){return n.asm.qb.apply(null,arguments)},$e=n._emscripten_bind_Config_set_collisions_1=function(){return n.asm.rb.apply(null,arguments)},tn=n._emscripten_bind_Config_set_diterations_1=function(){return n.asm.sb.apply(null,arguments)},en=n._emscripten_bind_Config_set_kAHR_1=function(){return n.asm.tb.apply(null,arguments)},nn=n._emscripten_bind_Config_set_kCHR_1=function(){return n.asm.ub.apply(null,arguments)},rn=n._emscripten_bind_Config_set_kDF_1=function(){return n.asm.vb.apply(null,arguments)},on=n._emscripten_bind_Config_set_kDG_1=function(){return n.asm.wb.apply(null,arguments)},an=n._emscripten_bind_Config_set_kDP_1=function(){return n.asm.xb.apply(null,arguments)},sn=n._emscripten_bind_Config_set_kKHR_1=function(){return n.asm.yb.apply(null,arguments)},ln=n._emscripten_bind_Config_set_kLF_1=function(){return n.asm.zb.apply(null,arguments)},cn=n._emscripten_bind_Config_set_kMT_1=function(){return n.asm.Ab.apply(null,arguments)},un=n._emscripten_bind_Config_set_kPR_1=function(){return n.asm.Bb.apply(null,arguments)},pn=n._emscripten_bind_Config_set_kSHR_1=function(){return n.asm.Cb.apply(null,arguments)},dn=n._emscripten_bind_Config_set_kSKHR_CL_1=function(){return n.asm.Db.apply(null,arguments)},hn=n._emscripten_bind_Config_set_kSK_SPLT_CL_1=function(){return n.asm.Eb.apply(null,arguments)},fn=n._emscripten_bind_Config_set_kSRHR_CL_1=function(){return n.asm.Fb.apply(null,arguments)},mn=n._emscripten_bind_Config_set_kSR_SPLT_CL_1=function(){return n.asm.Gb.apply(null,arguments)},yn=n._emscripten_bind_Config_set_kSSHR_CL_1=function(){return n.asm.Hb.apply(null,arguments)},_n=n._emscripten_bind_Config_set_kSS_SPLT_CL_1=function(){return n.asm.Ib.apply(null,arguments)},gn=n._emscripten_bind_Config_set_kVCF_1=function(){return n.asm.Jb.apply(null,arguments)},vn=n._emscripten_bind_Config_set_kVC_1=function(){return n.asm.Kb.apply(null,arguments)},bn=n._emscripten_bind_Config_set_maxvolume_1=function(){return n.asm.Lb.apply(null,arguments)},xn=n._emscripten_bind_Config_set_piterations_1=function(){return n.asm.Mb.apply(null,arguments)},wn=n._emscripten_bind_Config_set_timescale_1=function(){return n.asm.Nb.apply(null,arguments)},En=n._emscripten_bind_Config_set_viterations_1=function(){return n.asm.Ob.apply(null,arguments)},Tn=n._emscripten_bind_ContactResultCallback___destroy___0=function(){return n.asm.Pb.apply(null,arguments)},Sn=n._emscripten_bind_ContactResultCallback_addSingleResult_7=function(){return n.asm.Qb.apply(null,arguments)},Mn=n._emscripten_bind_ContactResultCallback_get_m_collisionFilterGroup_0=function(){return n.asm.Rb.apply(null,arguments)},jn=n._emscripten_bind_ContactResultCallback_get_m_collisionFilterMask_0=function(){return n.asm.Sb.apply(null,arguments)},Cn=n._emscripten_bind_ContactResultCallback_set_m_collisionFilterGroup_1=function(){return n.asm.Tb.apply(null,arguments)},zn=n._emscripten_bind_ContactResultCallback_set_m_collisionFilterMask_1=function(){return n.asm.Ub.apply(null,arguments)},Rn=n._emscripten_bind_ConvexResultCallback___destroy___0=function(){return n.asm.Vb.apply(null,arguments)},An=n._emscripten_bind_ConvexResultCallback_get_m_closestHitFraction_0=function(){return n.asm.Wb.apply(null,arguments)},Ln=n._emscripten_bind_ConvexResultCallback_get_m_collisionFilterGroup_0=function(){return n.asm.Xb.apply(null,arguments)},In=n._emscripten_bind_ConvexResultCallback_get_m_collisionFilterMask_0=function(){return n.asm.Yb.apply(null,arguments)},Pn=n._emscripten_bind_ConvexResultCallback_hasHit_0=function(){return n.asm.Zb.apply(null,arguments)},On=n._emscripten_bind_ConvexResultCallback_set_m_closestHitFraction_1=function(){return n.asm._b.apply(null,arguments)},kn=n._emscripten_bind_ConvexResultCallback_set_m_collisionFilterGroup_1=function(){return n.asm.$b.apply(null,arguments)},Bn=n._emscripten_bind_ConvexResultCallback_set_m_collisionFilterMask_1=function(){return n.asm.ac.apply(null,arguments)},Dn=n._emscripten_bind_DebugDrawer_DebugDrawer_0=function(){return n.asm.bc.apply(null,arguments)},Hn=n._emscripten_bind_DebugDrawer___destroy___0=function(){return n.asm.cc.apply(null,arguments)},Fn=n._emscripten_bind_DebugDrawer_draw3dText_2=function(){return n.asm.dc.apply(null,arguments)},Nn=n._emscripten_bind_DebugDrawer_drawContactPoint_5=function(){return n.asm.ec.apply(null,arguments)},Un=n._emscripten_bind_DebugDrawer_drawLine_3=function(){return n.asm.fc.apply(null,arguments)},Vn=n._emscripten_bind_DebugDrawer_getDebugMode_0=function(){return n.asm.gc.apply(null,arguments)},Gn=n._emscripten_bind_DebugDrawer_reportErrorWarning_1=function(){return n.asm.hc.apply(null,arguments)},Wn=n._emscripten_bind_DebugDrawer_setDebugMode_1=function(){return n.asm.ic.apply(null,arguments)},qn=n._emscripten_bind_LocalConvexResult_LocalConvexResult_5=function(){return n.asm.jc.apply(null,arguments)},Xn=n._emscripten_bind_LocalConvexResult___destroy___0=function(){return n.asm.kc.apply(null,arguments)},Yn=n._emscripten_bind_LocalConvexResult_get_m_hitCollisionObject_0=function(){return n.asm.lc.apply(null,arguments)},Qn=n._emscripten_bind_LocalConvexResult_get_m_hitFraction_0=function(){return n.asm.mc.apply(null,arguments)},Zn=n._emscripten_bind_LocalConvexResult_get_m_hitNormalLocal_0=function(){return n.asm.nc.apply(null,arguments)},Jn=n._emscripten_bind_LocalConvexResult_get_m_hitPointLocal_0=function(){return n.asm.oc.apply(null,arguments)},Kn=n._emscripten_bind_LocalConvexResult_get_m_localShapeInfo_0=function(){return n.asm.pc.apply(null,arguments)},$n=n._emscripten_bind_LocalConvexResult_set_m_hitCollisionObject_1=function(){return n.asm.qc.apply(null,arguments)},tr=n._emscripten_bind_LocalConvexResult_set_m_hitFraction_1=function(){return n.asm.rc.apply(null,arguments)},er=n._emscripten_bind_LocalConvexResult_set_m_hitNormalLocal_1=function(){return n.asm.sc.apply(null,arguments)},nr=n._emscripten_bind_LocalConvexResult_set_m_hitPointLocal_1=function(){return n.asm.tc.apply(null,arguments)},rr=n._emscripten_bind_LocalConvexResult_set_m_localShapeInfo_1=function(){return n.asm.uc.apply(null,arguments)},ir=n._emscripten_bind_LocalShapeInfo___destroy___0=function(){return n.asm.vc.apply(null,arguments)},or=n._emscripten_bind_LocalShapeInfo_get_m_shapePart_0=function(){return n.asm.wc.apply(null,arguments)},ar=n._emscripten_bind_LocalShapeInfo_get_m_triangleIndex_0=function(){return n.asm.xc.apply(null,arguments)},sr=n._emscripten_bind_LocalShapeInfo_set_m_shapePart_1=function(){return n.asm.yc.apply(null,arguments)},lr=n._emscripten_bind_LocalShapeInfo_set_m_triangleIndex_1=function(){return n.asm.zc.apply(null,arguments)},cr=n._emscripten_bind_Material___destroy___0=function(){return n.asm.Ac.apply(null,arguments)},ur=n._emscripten_bind_Material_get_m_flags_0=function(){return n.asm.Bc.apply(null,arguments)},pr=n._emscripten_bind_Material_get_m_kAST_0=function(){return n.asm.Cc.apply(null,arguments)},dr=n._emscripten_bind_Material_get_m_kLST_0=function(){return n.asm.Dc.apply(null,arguments)},hr=n._emscripten_bind_Material_get_m_kVST_0=function(){return n.asm.Ec.apply(null,arguments)},fr=n._emscripten_bind_Material_set_m_flags_1=function(){return n.asm.Fc.apply(null,arguments)},mr=n._emscripten_bind_Material_set_m_kAST_1=function(){return n.asm.Gc.apply(null,arguments)},yr=n._emscripten_bind_Material_set_m_kLST_1=function(){return n.asm.Hc.apply(null,arguments)},_r=n._emscripten_bind_Material_set_m_kVST_1=function(){return n.asm.Ic.apply(null,arguments)},gr=n._emscripten_bind_Node___destroy___0=function(){return n.asm.Jc.apply(null,arguments)},vr=n._emscripten_bind_Node_get_m_area_0=function(){return n.asm.Kc.apply(null,arguments)},br=n._emscripten_bind_Node_get_m_f_0=function(){return n.asm.Lc.apply(null,arguments)},xr=n._emscripten_bind_Node_get_m_im_0=function(){return n.asm.Mc.apply(null,arguments)},wr=n._emscripten_bind_Node_get_m_n_0=function(){return n.asm.Nc.apply(null,arguments)},Er=n._emscripten_bind_Node_get_m_q_0=function(){return n.asm.Oc.apply(null,arguments)},Tr=n._emscripten_bind_Node_get_m_v_0=function(){return n.asm.Pc.apply(null,arguments)},Sr=n._emscripten_bind_Node_get_m_x_0=function(){return n.asm.Qc.apply(null,arguments)},Mr=n._emscripten_bind_Node_set_m_area_1=function(){return n.asm.Rc.apply(null,arguments)},jr=n._emscripten_bind_Node_set_m_f_1=function(){return n.asm.Sc.apply(null,arguments)},Cr=n._emscripten_bind_Node_set_m_im_1=function(){return n.asm.Tc.apply(null,arguments)},zr=n._emscripten_bind_Node_set_m_n_1=function(){return n.asm.Uc.apply(null,arguments)},Rr=n._emscripten_bind_Node_set_m_q_1=function(){return n.asm.Vc.apply(null,arguments)},Ar=n._emscripten_bind_Node_set_m_v_1=function(){return n.asm.Wc.apply(null,arguments)},Lr=n._emscripten_bind_Node_set_m_x_1=function(){return n.asm.Xc.apply(null,arguments)},Ir=n._emscripten_bind_RayResultCallback___destroy___0=function(){return n.asm.Yc.apply(null,arguments)},Pr=n._emscripten_bind_RayResultCallback_get_m_closestHitFraction_0=function(){return n.asm.Zc.apply(null,arguments)},Or=n._emscripten_bind_RayResultCallback_get_m_collisionFilterGroup_0=function(){return n.asm._c.apply(null,arguments)},kr=n._emscripten_bind_RayResultCallback_get_m_collisionFilterMask_0=function(){return n.asm.$c.apply(null,arguments)},Br=n._emscripten_bind_RayResultCallback_get_m_collisionObject_0=function(){return n.asm.ad.apply(null,arguments)},Dr=n._emscripten_bind_RayResultCallback_hasHit_0=function(){return n.asm.bd.apply(null,arguments)},Hr=n._emscripten_bind_RayResultCallback_set_m_closestHitFraction_1=function(){return n.asm.cd.apply(null,arguments)},Fr=n._emscripten_bind_RayResultCallback_set_m_collisionFilterGroup_1=function(){return n.asm.dd.apply(null,arguments)},Nr=n._emscripten_bind_RayResultCallback_set_m_collisionFilterMask_1=function(){return n.asm.ed.apply(null,arguments)},Ur=n._emscripten_bind_RayResultCallback_set_m_collisionObject_1=function(){return n.asm.fd.apply(null,arguments)},Vr=n._emscripten_bind_RaycastInfo___destroy___0=function(){return n.asm.gd.apply(null,arguments)},Gr=n._emscripten_bind_RaycastInfo_get_m_contactNormalWS_0=function(){return n.asm.hd.apply(null,arguments)},Wr=n._emscripten_bind_RaycastInfo_get_m_contactPointWS_0=function(){return n.asm.id.apply(null,arguments)},qr=n._emscripten_bind_RaycastInfo_get_m_groundObject_0=function(){return n.asm.jd.apply(null,arguments)},Xr=n._emscripten_bind_RaycastInfo_get_m_hardPointWS_0=function(){return n.asm.kd.apply(null,arguments)},Yr=n._emscripten_bind_RaycastInfo_get_m_isInContact_0=function(){return n.asm.ld.apply(null,arguments)},Qr=n._emscripten_bind_RaycastInfo_get_m_suspensionLength_0=function(){return n.asm.md.apply(null,arguments)},Zr=n._emscripten_bind_RaycastInfo_get_m_wheelAxleWS_0=function(){return n.asm.nd.apply(null,arguments)},Jr=n._emscripten_bind_RaycastInfo_get_m_wheelDirectionWS_0=function(){return n.asm.od.apply(null,arguments)},Kr=n._emscripten_bind_RaycastInfo_set_m_contactNormalWS_1=function(){return n.asm.pd.apply(null,arguments)},$r=n._emscripten_bind_RaycastInfo_set_m_contactPointWS_1=function(){return n.asm.qd.apply(null,arguments)},ti=n._emscripten_bind_RaycastInfo_set_m_groundObject_1=function(){return n.asm.rd.apply(null,arguments)},ei=n._emscripten_bind_RaycastInfo_set_m_hardPointWS_1=function(){return n.asm.sd.apply(null,arguments)},ni=n._emscripten_bind_RaycastInfo_set_m_isInContact_1=function(){return n.asm.td.apply(null,arguments)},ri=n._emscripten_bind_RaycastInfo_set_m_suspensionLength_1=function(){return n.asm.ud.apply(null,arguments)},ii=n._emscripten_bind_RaycastInfo_set_m_wheelAxleWS_1=function(){return n.asm.vd.apply(null,arguments)},oi=n._emscripten_bind_RaycastInfo_set_m_wheelDirectionWS_1=function(){return n.asm.wd.apply(null,arguments)},ai=n._emscripten_bind_VoidPtr___destroy___0=function(){return n.asm.xd.apply(null,arguments)},si=n._emscripten_bind_btActionInterface___destroy___0=function(){return n.asm.yd.apply(null,arguments)},li=n._emscripten_bind_btActionInterface_updateAction_2=function(){return n.asm.zd.apply(null,arguments)},ci=n._emscripten_bind_btAxisSweep3___destroy___0=function(){return n.asm.Ad.apply(null,arguments)},ui=n._emscripten_bind_btAxisSweep3_btAxisSweep3_2=function(){return n.asm.Bd.apply(null,arguments)},pi=n._emscripten_bind_btAxisSweep3_btAxisSweep3_3=function(){return n.asm.Cd.apply(null,arguments)},di=n._emscripten_bind_btAxisSweep3_btAxisSweep3_4=function(){return n.asm.Dd.apply(null,arguments)},hi=n._emscripten_bind_btAxisSweep3_btAxisSweep3_5=function(){return n.asm.Ed.apply(null,arguments)},fi=n._emscripten_bind_btBoxShape___destroy___0=function(){return n.asm.Fd.apply(null,arguments)},mi=n._emscripten_bind_btBoxShape_btBoxShape_1=function(){return n.asm.Gd.apply(null,arguments)},yi=n._emscripten_bind_btBoxShape_calculateLocalInertia_2=function(){return n.asm.Hd.apply(null,arguments)},_i=n._emscripten_bind_btBoxShape_getLocalScaling_0=function(){return n.asm.Id.apply(null,arguments)},gi=n._emscripten_bind_btBoxShape_getMargin_0=function(){return n.asm.Jd.apply(null,arguments)},vi=n._emscripten_bind_btBoxShape_setLocalScaling_1=function(){return n.asm.Kd.apply(null,arguments)},bi=n._emscripten_bind_btBoxShape_setMargin_1=function(){return n.asm.Ld.apply(null,arguments)},xi=n._emscripten_bind_btBroadphaseInterface___destroy___0=function(){return n.asm.Md.apply(null,arguments)},wi=n._emscripten_bind_btBroadphaseInterface_getOverlappingPairCache_0=function(){return n.asm.Nd.apply(null,arguments)},Ei=n._emscripten_bind_btBroadphaseProxy___destroy___0=function(){return n.asm.Od.apply(null,arguments)},Ti=n._emscripten_bind_btBroadphaseProxy_get_m_collisionFilterGroup_0=function(){return n.asm.Pd.apply(null,arguments)},Si=n._emscripten_bind_btBroadphaseProxy_get_m_collisionFilterMask_0=function(){return n.asm.Qd.apply(null,arguments)},Mi=n._emscripten_bind_btBroadphaseProxy_set_m_collisionFilterGroup_1=function(){return n.asm.Rd.apply(null,arguments)},ji=n._emscripten_bind_btBroadphaseProxy_set_m_collisionFilterMask_1=function(){return n.asm.Sd.apply(null,arguments)},Ci=n._emscripten_bind_btBvhTriangleMeshShape___destroy___0=function(){return n.asm.Td.apply(null,arguments)},zi=n._emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_2=function(){return n.asm.Ud.apply(null,arguments)},Ri=n._emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_3=function(){return n.asm.Vd.apply(null,arguments)},Ai=n._emscripten_bind_btBvhTriangleMeshShape_calculateLocalInertia_2=function(){return n.asm.Wd.apply(null,arguments)},Li=n._emscripten_bind_btBvhTriangleMeshShape_getLocalScaling_0=function(){return n.asm.Xd.apply(null,arguments)},Ii=n._emscripten_bind_btBvhTriangleMeshShape_setLocalScaling_1=function(){return n.asm.Yd.apply(null,arguments)},Pi=n._emscripten_bind_btCapsuleShapeX___destroy___0=function(){return n.asm.Zd.apply(null,arguments)},Oi=n._emscripten_bind_btCapsuleShapeX_btCapsuleShapeX_2=function(){return n.asm._d.apply(null,arguments)},ki=n._emscripten_bind_btCapsuleShapeX_calculateLocalInertia_2=function(){return n.asm.$d.apply(null,arguments)},Bi=n._emscripten_bind_btCapsuleShapeX_getHalfHeight_0=function(){return n.asm.ae.apply(null,arguments)},Di=n._emscripten_bind_btCapsuleShapeX_getLocalScaling_0=function(){return n.asm.be.apply(null,arguments)},Hi=n._emscripten_bind_btCapsuleShapeX_getMargin_0=function(){return n.asm.ce.apply(null,arguments)},Fi=n._emscripten_bind_btCapsuleShapeX_getRadius_0=function(){return n.asm.de.apply(null,arguments)},Ni=n._emscripten_bind_btCapsuleShapeX_getUpAxis_0=function(){return n.asm.ee.apply(null,arguments)},Ui=n._emscripten_bind_btCapsuleShapeX_setLocalScaling_1=function(){return n.asm.fe.apply(null,arguments)},Vi=n._emscripten_bind_btCapsuleShapeX_setMargin_1=function(){return n.asm.ge.apply(null,arguments)},Gi=n._emscripten_bind_btCapsuleShapeZ___destroy___0=function(){return n.asm.he.apply(null,arguments)},Wi=n._emscripten_bind_btCapsuleShapeZ_btCapsuleShapeZ_2=function(){return n.asm.ie.apply(null,arguments)},qi=n._emscripten_bind_btCapsuleShapeZ_calculateLocalInertia_2=function(){return n.asm.je.apply(null,arguments)},Xi=n._emscripten_bind_btCapsuleShapeZ_getHalfHeight_0=function(){return n.asm.ke.apply(null,arguments)},Yi=n._emscripten_bind_btCapsuleShapeZ_getLocalScaling_0=function(){return n.asm.le.apply(null,arguments)},Qi=n._emscripten_bind_btCapsuleShapeZ_getMargin_0=function(){return n.asm.me.apply(null,arguments)},Zi=n._emscripten_bind_btCapsuleShapeZ_getRadius_0=function(){return n.asm.ne.apply(null,arguments)},Ji=n._emscripten_bind_btCapsuleShapeZ_getUpAxis_0=function(){return n.asm.oe.apply(null,arguments)},Ki=n._emscripten_bind_btCapsuleShapeZ_setLocalScaling_1=function(){return n.asm.pe.apply(null,arguments)},$i=n._emscripten_bind_btCapsuleShapeZ_setMargin_1=function(){return n.asm.qe.apply(null,arguments)},to=n._emscripten_bind_btCapsuleShape___destroy___0=function(){return n.asm.re.apply(null,arguments)},eo=n._emscripten_bind_btCapsuleShape_btCapsuleShape_2=function(){return n.asm.se.apply(null,arguments)},no=n._emscripten_bind_btCapsuleShape_calculateLocalInertia_2=function(){return n.asm.te.apply(null,arguments)},ro=n._emscripten_bind_btCapsuleShape_getHalfHeight_0=function(){return n.asm.ue.apply(null,arguments)},io=n._emscripten_bind_btCapsuleShape_getLocalScaling_0=function(){return n.asm.ve.apply(null,arguments)},oo=n._emscripten_bind_btCapsuleShape_getMargin_0=function(){return n.asm.we.apply(null,arguments)},ao=n._emscripten_bind_btCapsuleShape_getRadius_0=function(){return n.asm.xe.apply(null,arguments)},so=n._emscripten_bind_btCapsuleShape_getUpAxis_0=function(){return n.asm.ye.apply(null,arguments)},lo=n._emscripten_bind_btCapsuleShape_setLocalScaling_1=function(){return n.asm.ze.apply(null,arguments)},co=n._emscripten_bind_btCapsuleShape_setMargin_1=function(){return n.asm.Ae.apply(null,arguments)},uo=n._emscripten_bind_btClosestNotMeConvexResultCallback___destroy___0=function(){return n.asm.Be.apply(null,arguments)},po=n._emscripten_bind_btClosestNotMeConvexResultCallback_btClosestNotMeConvexResultCallback_5=function(){return n.asm.Ce.apply(null,arguments)},ho=n._emscripten_bind_btClosestNotMeConvexResultCallback_get_m_closestHitFraction_0=function(){return n.asm.De.apply(null,arguments)},fo=n._emscripten_bind_btClosestNotMeConvexResultCallback_get_m_collisionFilterGroup_0=function(){return n.asm.Ee.apply(null,arguments)},mo=n._emscripten_bind_btClosestNotMeConvexResultCallback_get_m_collisionFilterMask_0=function(){return n.asm.Fe.apply(null,arguments)},yo=n._emscripten_bind_btClosestNotMeConvexResultCallback_get_m_convexFromWorld_0=function(){return n.asm.Ge.apply(null,arguments)},_o=n._emscripten_bind_btClosestNotMeConvexResultCallback_get_m_convexToWorld_0=function(){return n.asm.He.apply(null,arguments)},go=n._emscripten_bind_btClosestNotMeConvexResultCallback_get_m_dispatcher_0=function(){return n.asm.Ie.apply(null,arguments)},vo=n._emscripten_bind_btClosestNotMeConvexResultCallback_get_m_hitCollisionObject_0=function(){return n.asm.Je.apply(null,arguments)},bo=n._emscripten_bind_btClosestNotMeConvexResultCallback_get_m_hitNormalWorld_0=function(){return n.asm.Ke.apply(null,arguments)},xo=n._emscripten_bind_btClosestNotMeConvexResultCallback_get_m_hitPointWorld_0=function(){return n.asm.Le.apply(null,arguments)},wo=n._emscripten_bind_btClosestNotMeConvexResultCallback_get_m_me_0=function(){return n.asm.Me.apply(null,arguments)},Eo=n._emscripten_bind_btClosestNotMeConvexResultCallback_get_m_pairCache_0=function(){return n.asm.Ne.apply(null,arguments)},To=n._emscripten_bind_btClosestNotMeConvexResultCallback_hasHit_0=function(){return n.asm.Oe.apply(null,arguments)},So=n._emscripten_bind_btClosestNotMeConvexResultCallback_set_m_closestHitFraction_1=function(){return n.asm.Pe.apply(null,arguments)},Mo=n._emscripten_bind_btClosestNotMeConvexResultCallback_set_m_collisionFilterGroup_1=function(){return n.asm.Qe.apply(null,arguments)},jo=n._emscripten_bind_btClosestNotMeConvexResultCallback_set_m_collisionFilterMask_1=function(){return n.asm.Re.apply(null,arguments)},Co=n._emscripten_bind_btClosestNotMeConvexResultCallback_set_m_convexFromWorld_1=function(){return n.asm.Se.apply(null,arguments)},zo=n._emscripten_bind_btClosestNotMeConvexResultCallback_set_m_convexToWorld_1=function(){return n.asm.Te.apply(null,arguments)},Ro=n._emscripten_bind_btClosestNotMeConvexResultCallback_set_m_dispatcher_1=function(){return n.asm.Ue.apply(null,arguments)},Ao=n._emscripten_bind_btClosestNotMeConvexResultCallback_set_m_hitCollisionObject_1=function(){return n.asm.Ve.apply(null,arguments)},Lo=n._emscripten_bind_btClosestNotMeConvexResultCallback_set_m_hitNormalWorld_1=function(){return n.asm.We.apply(null,arguments)},Io=n._emscripten_bind_btClosestNotMeConvexResultCallback_set_m_hitPointWorld_1=function(){return n.asm.Xe.apply(null,arguments)},Po=n._emscripten_bind_btClosestNotMeConvexResultCallback_set_m_me_1=function(){return n.asm.Ye.apply(null,arguments)},Oo=n._emscripten_bind_btClosestNotMeConvexResultCallback_set_m_pairCache_1=function(){return n.asm.Ze.apply(null,arguments)},ko=n._emscripten_bind_btCollisionConfiguration___destroy___0=function(){return n.asm._e.apply(null,arguments)},Bo=n._emscripten_bind_btCollisionDispatcher___destroy___0=function(){return n.asm.$e.apply(null,arguments)},Do=n._emscripten_bind_btCollisionDispatcher_btCollisionDispatcher_1=function(){return n.asm.af.apply(null,arguments)},Ho=n._emscripten_bind_btCollisionDispatcher_getManifoldByIndexInternal_1=function(){return n.asm.bf.apply(null,arguments)},Fo=n._emscripten_bind_btCollisionDispatcher_getNumManifolds_0=function(){return n.asm.cf.apply(null,arguments)},No=n._emscripten_bind_btCollisionObjectWrapper_getCollisionObject_0=function(){return n.asm.df.apply(null,arguments)},Uo=n._emscripten_bind_btCollisionObjectWrapper_getCollisionShape_0=function(){return n.asm.ef.apply(null,arguments)},Vo=n._emscripten_bind_btCollisionObjectWrapper_getWorldTransform_0=function(){return n.asm.ff.apply(null,arguments)},Go=n._emscripten_bind_btCollisionObject___destroy___0=function(){return n.asm.gf.apply(null,arguments)},Wo=n._emscripten_bind_btCollisionObject_activate_0=function(){return n.asm.hf.apply(null,arguments)},qo=n._emscripten_bind_btCollisionObject_activate_1=function(){return n.asm.jf.apply(null,arguments)},Xo=n._emscripten_bind_btCollisionObject_btCollisionObject_0=function(){return n.asm.kf.apply(null,arguments)},Yo=n._emscripten_bind_btCollisionObject_forceActivationState_1=function(){return n.asm.lf.apply(null,arguments)},Qo=n._emscripten_bind_btCollisionObject_getBroadphaseHandle_0=function(){return n.asm.mf.apply(null,arguments)},Zo=n._emscripten_bind_btCollisionObject_getCollisionFlags_0=function(){return n.asm.nf.apply(null,arguments)},Jo=n._emscripten_bind_btCollisionObject_getCollisionShape_0=function(){return n.asm.of.apply(null,arguments)},Ko=n._emscripten_bind_btCollisionObject_getFriction_0=function(){return n.asm.pf.apply(null,arguments)},$o=n._emscripten_bind_btCollisionObject_getRestitution_0=function(){return n.asm.qf.apply(null,arguments)},ta=n._emscripten_bind_btCollisionObject_getRollingFriction_0=function(){return n.asm.rf.apply(null,arguments)},ea=n._emscripten_bind_btCollisionObject_getUserIndex_0=function(){return n.asm.sf.apply(null,arguments)},na=n._emscripten_bind_btCollisionObject_getUserPointer_0=function(){return n.asm.tf.apply(null,arguments)},ra=n._emscripten_bind_btCollisionObject_getWorldTransform_0=function(){return n.asm.uf.apply(null,arguments)},ia=n._emscripten_bind_btCollisionObject_isActive_0=function(){return n.asm.vf.apply(null,arguments)},oa=n._emscripten_bind_btCollisionObject_isKinematicObject_0=function(){return n.asm.wf.apply(null,arguments)},aa=n._emscripten_bind_btCollisionObject_isStaticObject_0=function(){return n.asm.xf.apply(null,arguments)},sa=n._emscripten_bind_btCollisionObject_isStaticOrKinematicObject_0=function(){return n.asm.yf.apply(null,arguments)},la=n._emscripten_bind_btCollisionObject_setActivationState_1=function(){return n.asm.zf.apply(null,arguments)},ca=n._emscripten_bind_btCollisionObject_setAnisotropicFriction_2=function(){return n.asm.Af.apply(null,arguments)},ua=n._emscripten_bind_btCollisionObject_setCcdMotionThreshold_1=function(){return n.asm.Bf.apply(null,arguments)},pa=n._emscripten_bind_btCollisionObject_setCcdSweptSphereRadius_1=function(){return n.asm.Cf.apply(null,arguments)},da=n._emscripten_bind_btCollisionObject_setCollisionFlags_1=function(){return n.asm.Df.apply(null,arguments)},ha=n._emscripten_bind_btCollisionObject_setCollisionShape_1=function(){return n.asm.Ef.apply(null,arguments)},fa=n._emscripten_bind_btCollisionObject_setContactProcessingThreshold_1=function(){return n.asm.Ff.apply(null,arguments)},ma=n._emscripten_bind_btCollisionObject_setFriction_1=function(){return n.asm.Gf.apply(null,arguments)},ya=n._emscripten_bind_btCollisionObject_setIgnoreCollisionCheck_2=function(){return n.asm.Hf.apply(null,arguments)},_a=n._emscripten_bind_btCollisionObject_setRestitution_1=function(){return n.asm.If.apply(null,arguments)},ga=n._emscripten_bind_btCollisionObject_setRollingFriction_1=function(){return n.asm.Jf.apply(null,arguments)},va=n._emscripten_bind_btCollisionObject_setUserIndex_1=function(){return n.asm.Kf.apply(null,arguments)},ba=n._emscripten_bind_btCollisionObject_setUserPointer_1=function(){return n.asm.Lf.apply(null,arguments)},xa=n._emscripten_bind_btCollisionObject_setWorldTransform_1=function(){return n.asm.Mf.apply(null,arguments)},wa=n._emscripten_bind_btCollisionShape___destroy___0=function(){return n.asm.Nf.apply(null,arguments)},Ea=n._emscripten_bind_btCollisionShape_calculateLocalInertia_2=function(){return n.asm.Of.apply(null,arguments)},Ta=n._emscripten_bind_btCollisionShape_getLocalScaling_0=function(){return n.asm.Pf.apply(null,arguments)},Sa=n._emscripten_bind_btCollisionShape_getMargin_0=function(){return n.asm.Qf.apply(null,arguments)},Ma=n._emscripten_bind_btCollisionShape_setLocalScaling_1=function(){return n.asm.Rf.apply(null,arguments)},ja=n._emscripten_bind_btCollisionShape_setMargin_1=function(){return n.asm.Sf.apply(null,arguments)},Ca=n._emscripten_bind_btCollisionWorld___destroy___0=function(){return n.asm.Tf.apply(null,arguments)},za=n._emscripten_bind_btCollisionWorld_addCollisionObject_1=function(){return n.asm.Uf.apply(null,arguments)},Ra=n._emscripten_bind_btCollisionWorld_addCollisionObject_2=function(){return n.asm.Vf.apply(null,arguments)},Aa=n._emscripten_bind_btCollisionWorld_addCollisionObject_3=function(){return n.asm.Wf.apply(null,arguments)},La=n._emscripten_bind_btCollisionWorld_contactPairTest_3=function(){return n.asm.Xf.apply(null,arguments)},Ia=n._emscripten_bind_btCollisionWorld_contactTest_2=function(){return n.asm.Yf.apply(null,arguments)},Pa=n._emscripten_bind_btCollisionWorld_convexSweepTest_5=function(){return n.asm.Zf.apply(null,arguments)},Oa=n._emscripten_bind_btCollisionWorld_debugDrawObject_3=function(){return n.asm._f.apply(null,arguments)},ka=n._emscripten_bind_btCollisionWorld_debugDrawWorld_0=function(){return n.asm.$f.apply(null,arguments)},Ba=n._emscripten_bind_btCollisionWorld_getBroadphase_0=function(){return n.asm.ag.apply(null,arguments)},Da=n._emscripten_bind_btCollisionWorld_getDebugDrawer_0=function(){return n.asm.bg.apply(null,arguments)},Ha=n._emscripten_bind_btCollisionWorld_getDispatchInfo_0=function(){return n.asm.cg.apply(null,arguments)},Fa=n._emscripten_bind_btCollisionWorld_getDispatcher_0=function(){return n.asm.dg.apply(null,arguments)},Na=n._emscripten_bind_btCollisionWorld_getForceUpdateAllAabbs_0=function(){return n.asm.eg.apply(null,arguments)},Ua=n._emscripten_bind_btCollisionWorld_getPairCache_0=function(){return n.asm.fg.apply(null,arguments)},Va=n._emscripten_bind_btCollisionWorld_rayTest_3=function(){return n.asm.gg.apply(null,arguments)},Ga=n._emscripten_bind_btCollisionWorld_removeCollisionObject_1=function(){return n.asm.hg.apply(null,arguments)},Wa=n._emscripten_bind_btCollisionWorld_setDebugDrawer_1=function(){return n.asm.ig.apply(null,arguments)},qa=n._emscripten_bind_btCollisionWorld_setForceUpdateAllAabbs_1=function(){return n.asm.jg.apply(null,arguments)},Xa=n._emscripten_bind_btCollisionWorld_updateSingleAabb_1=function(){return n.asm.kg.apply(null,arguments)},Ya=n._emscripten_bind_btCompoundShape___destroy___0=function(){return n.asm.lg.apply(null,arguments)},Qa=n._emscripten_bind_btCompoundShape_addChildShape_2=function(){return n.asm.mg.apply(null,arguments)},Za=n._emscripten_bind_btCompoundShape_btCompoundShape_0=function(){return n.asm.ng.apply(null,arguments)},Ja=n._emscripten_bind_btCompoundShape_btCompoundShape_1=function(){return n.asm.og.apply(null,arguments)},Ka=n._emscripten_bind_btCompoundShape_calculateLocalInertia_2=function(){return n.asm.pg.apply(null,arguments)},$a=n._emscripten_bind_btCompoundShape_getChildShape_1=function(){return n.asm.qg.apply(null,arguments)},ts=n._emscripten_bind_btCompoundShape_getLocalScaling_0=function(){return n.asm.rg.apply(null,arguments)},es=n._emscripten_bind_btCompoundShape_getMargin_0=function(){return n.asm.sg.apply(null,arguments)},ns=n._emscripten_bind_btCompoundShape_getNumChildShapes_0=function(){return n.asm.tg.apply(null,arguments)},rs=n._emscripten_bind_btCompoundShape_removeChildShapeByIndex_1=function(){return n.asm.ug.apply(null,arguments)},is=n._emscripten_bind_btCompoundShape_removeChildShape_1=function(){return n.asm.vg.apply(null,arguments)},os=n._emscripten_bind_btCompoundShape_setLocalScaling_1=function(){return n.asm.wg.apply(null,arguments)},as=n._emscripten_bind_btCompoundShape_setMargin_1=function(){return n.asm.xg.apply(null,arguments)},ss=n._emscripten_bind_btCompoundShape_updateChildTransform_2=function(){return n.asm.yg.apply(null,arguments)},ls=n._emscripten_bind_btCompoundShape_updateChildTransform_3=function(){return n.asm.zg.apply(null,arguments)},cs=n._emscripten_bind_btConcaveShape___destroy___0=function(){return n.asm.Ag.apply(null,arguments)},us=n._emscripten_bind_btConcaveShape_calculateLocalInertia_2=function(){return n.asm.Bg.apply(null,arguments)},ps=n._emscripten_bind_btConcaveShape_getLocalScaling_0=function(){return n.asm.Cg.apply(null,arguments)},ds=n._emscripten_bind_btConcaveShape_setLocalScaling_1=function(){return n.asm.Dg.apply(null,arguments)},hs=n._emscripten_bind_btConeShapeX___destroy___0=function(){return n.asm.Eg.apply(null,arguments)},fs=n._emscripten_bind_btConeShapeX_btConeShapeX_2=function(){return n.asm.Fg.apply(null,arguments)},ms=n._emscripten_bind_btConeShapeX_calculateLocalInertia_2=function(){return n.asm.Gg.apply(null,arguments)},ys=n._emscripten_bind_btConeShapeX_getLocalScaling_0=function(){return n.asm.Hg.apply(null,arguments)},_s=n._emscripten_bind_btConeShapeX_setLocalScaling_1=function(){return n.asm.Ig.apply(null,arguments)},gs=n._emscripten_bind_btConeShapeZ___destroy___0=function(){return n.asm.Jg.apply(null,arguments)},vs=n._emscripten_bind_btConeShapeZ_btConeShapeZ_2=function(){return n.asm.Kg.apply(null,arguments)},bs=n._emscripten_bind_btConeShapeZ_calculateLocalInertia_2=function(){return n.asm.Lg.apply(null,arguments)},xs=n._emscripten_bind_btConeShapeZ_getLocalScaling_0=function(){return n.asm.Mg.apply(null,arguments)},ws=n._emscripten_bind_btConeShapeZ_setLocalScaling_1=function(){return n.asm.Ng.apply(null,arguments)},Es=n._emscripten_bind_btConeShape___destroy___0=function(){return n.asm.Og.apply(null,arguments)},Ts=n._emscripten_bind_btConeShape_btConeShape_2=function(){return n.asm.Pg.apply(null,arguments)},Ss=n._emscripten_bind_btConeShape_calculateLocalInertia_2=function(){return n.asm.Qg.apply(null,arguments)},Ms=n._emscripten_bind_btConeShape_getLocalScaling_0=function(){return n.asm.Rg.apply(null,arguments)},js=n._emscripten_bind_btConeShape_setLocalScaling_1=function(){return n.asm.Sg.apply(null,arguments)},Cs=n._emscripten_bind_btConeTwistConstraint___destroy___0=function(){return n.asm.Tg.apply(null,arguments)},zs=n._emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_2=function(){return n.asm.Ug.apply(null,arguments)},Rs=n._emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_4=function(){return n.asm.Vg.apply(null,arguments)},As=n._emscripten_bind_btConeTwistConstraint_enableFeedback_1=function(){return n.asm.Wg.apply(null,arguments)},Ls=n._emscripten_bind_btConeTwistConstraint_enableMotor_1=function(){return n.asm.Xg.apply(null,arguments)},Is=n._emscripten_bind_btConeTwistConstraint_getBreakingImpulseThreshold_0=function(){return n.asm.Yg.apply(null,arguments)},Ps=n._emscripten_bind_btConeTwistConstraint_getParam_2=function(){return n.asm.Zg.apply(null,arguments)},Os=n._emscripten_bind_btConeTwistConstraint_setAngularOnly_1=function(){return n.asm._g.apply(null,arguments)},ks=n._emscripten_bind_btConeTwistConstraint_setBreakingImpulseThreshold_1=function(){return n.asm.$g.apply(null,arguments)},Bs=n._emscripten_bind_btConeTwistConstraint_setDamping_1=function(){return n.asm.ah.apply(null,arguments)},Ds=n._emscripten_bind_btConeTwistConstraint_setLimit_2=function(){return n.asm.bh.apply(null,arguments)},Hs=n._emscripten_bind_btConeTwistConstraint_setMaxMotorImpulseNormalized_1=function(){return n.asm.ch.apply(null,arguments)},Fs=n._emscripten_bind_btConeTwistConstraint_setMaxMotorImpulse_1=function(){return n.asm.dh.apply(null,arguments)},Ns=n._emscripten_bind_btConeTwistConstraint_setMotorTargetInConstraintSpace_1=function(){return n.asm.eh.apply(null,arguments)},Us=n._emscripten_bind_btConeTwistConstraint_setMotorTarget_1=function(){return n.asm.fh.apply(null,arguments)},Vs=n._emscripten_bind_btConeTwistConstraint_setParam_3=function(){return n.asm.gh.apply(null,arguments)},Gs=n._emscripten_bind_btConstCollisionObjectArray___destroy___0=function(){return n.asm.hh.apply(null,arguments)},Ws=n._emscripten_bind_btConstCollisionObjectArray_at_1=function(){return n.asm.ih.apply(null,arguments)},qs=n._emscripten_bind_btConstCollisionObjectArray_size_0=function(){return n.asm.jh.apply(null,arguments)},Xs=n._emscripten_bind_btConstraintSetting___destroy___0=function(){return n.asm.kh.apply(null,arguments)},Ys=n._emscripten_bind_btConstraintSetting_btConstraintSetting_0=function(){return n.asm.lh.apply(null,arguments)},Qs=n._emscripten_bind_btConstraintSetting_get_m_damping_0=function(){return n.asm.mh.apply(null,arguments)},Zs=n._emscripten_bind_btConstraintSetting_get_m_impulseClamp_0=function(){return n.asm.nh.apply(null,arguments)},Js=n._emscripten_bind_btConstraintSetting_get_m_tau_0=function(){return n.asm.oh.apply(null,arguments)},Ks=n._emscripten_bind_btConstraintSetting_set_m_damping_1=function(){return n.asm.ph.apply(null,arguments)},$s=n._emscripten_bind_btConstraintSetting_set_m_impulseClamp_1=function(){return n.asm.qh.apply(null,arguments)},tl=n._emscripten_bind_btConstraintSetting_set_m_tau_1=function(){return n.asm.rh.apply(null,arguments)},el=n._emscripten_bind_btConstraintSolver___destroy___0=function(){return n.asm.sh.apply(null,arguments)},nl=n._emscripten_bind_btContactSolverInfo___destroy___0=function(){return n.asm.th.apply(null,arguments)},rl=n._emscripten_bind_btContactSolverInfo_get_m_numIterations_0=function(){return n.asm.uh.apply(null,arguments)},il=n._emscripten_bind_btContactSolverInfo_get_m_splitImpulsePenetrationThreshold_0=function(){return n.asm.vh.apply(null,arguments)},ol=n._emscripten_bind_btContactSolverInfo_get_m_splitImpulse_0=function(){return n.asm.wh.apply(null,arguments)},al=n._emscripten_bind_btContactSolverInfo_set_m_numIterations_1=function(){return n.asm.xh.apply(null,arguments)},sl=n._emscripten_bind_btContactSolverInfo_set_m_splitImpulsePenetrationThreshold_1=function(){return n.asm.yh.apply(null,arguments)},ll=n._emscripten_bind_btContactSolverInfo_set_m_splitImpulse_1=function(){return n.asm.zh.apply(null,arguments)},cl=n._emscripten_bind_btConvexHullShape___destroy___0=function(){return n.asm.Ah.apply(null,arguments)},ul=n._emscripten_bind_btConvexHullShape_addPoint_1=function(){return n.asm.Bh.apply(null,arguments)},pl=n._emscripten_bind_btConvexHullShape_addPoint_2=function(){return n.asm.Ch.apply(null,arguments)},dl=n._emscripten_bind_btConvexHullShape_btConvexHullShape_0=function(){return n.asm.Dh.apply(null,arguments)},hl=n._emscripten_bind_btConvexHullShape_btConvexHullShape_1=function(){return n.asm.Eh.apply(null,arguments)},fl=n._emscripten_bind_btConvexHullShape_btConvexHullShape_2=function(){return n.asm.Fh.apply(null,arguments)},ml=n._emscripten_bind_btConvexHullShape_calculateLocalInertia_2=function(){return n.asm.Gh.apply(null,arguments)},yl=n._emscripten_bind_btConvexHullShape_getConvexPolyhedron_0=function(){return n.asm.Hh.apply(null,arguments)},_l=n._emscripten_bind_btConvexHullShape_getLocalScaling_0=function(){return n.asm.Ih.apply(null,arguments)},gl=n._emscripten_bind_btConvexHullShape_getMargin_0=function(){return n.asm.Jh.apply(null,arguments)},vl=n._emscripten_bind_btConvexHullShape_getNumVertices_0=function(){return n.asm.Kh.apply(null,arguments)},bl=n._emscripten_bind_btConvexHullShape_initializePolyhedralFeatures_1=function(){return n.asm.Lh.apply(null,arguments)},xl=n._emscripten_bind_btConvexHullShape_recalcLocalAabb_0=function(){return n.asm.Mh.apply(null,arguments)},wl=n._emscripten_bind_btConvexHullShape_setLocalScaling_1=function(){return n.asm.Nh.apply(null,arguments)},El=n._emscripten_bind_btConvexHullShape_setMargin_1=function(){return n.asm.Oh.apply(null,arguments)},Tl=n._emscripten_bind_btConvexPolyhedron___destroy___0=function(){return n.asm.Ph.apply(null,arguments)},Sl=n._emscripten_bind_btConvexPolyhedron_get_m_faces_0=function(){return n.asm.Qh.apply(null,arguments)},Ml=n._emscripten_bind_btConvexPolyhedron_get_m_vertices_0=function(){return n.asm.Rh.apply(null,arguments)},jl=n._emscripten_bind_btConvexPolyhedron_set_m_faces_1=function(){return n.asm.Sh.apply(null,arguments)},Cl=n._emscripten_bind_btConvexPolyhedron_set_m_vertices_1=function(){return n.asm.Th.apply(null,arguments)},zl=n._emscripten_bind_btConvexShape___destroy___0=function(){return n.asm.Uh.apply(null,arguments)},Rl=n._emscripten_bind_btConvexShape_calculateLocalInertia_2=function(){return n.asm.Vh.apply(null,arguments)},Al=n._emscripten_bind_btConvexShape_getLocalScaling_0=function(){return n.asm.Wh.apply(null,arguments)},Ll=n._emscripten_bind_btConvexShape_getMargin_0=function(){return n.asm.Xh.apply(null,arguments)},Il=n._emscripten_bind_btConvexShape_setLocalScaling_1=function(){return n.asm.Yh.apply(null,arguments)},Pl=n._emscripten_bind_btConvexShape_setMargin_1=function(){return n.asm.Zh.apply(null,arguments)},Ol=n._emscripten_bind_btConvexTriangleMeshShape___destroy___0=function(){return n.asm._h.apply(null,arguments)},kl=n._emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_1=function(){return n.asm.$h.apply(null,arguments)},Bl=n._emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_2=function(){return n.asm.ai.apply(null,arguments)},Dl=n._emscripten_bind_btConvexTriangleMeshShape_calculateLocalInertia_2=function(){return n.asm.bi.apply(null,arguments)},Hl=n._emscripten_bind_btConvexTriangleMeshShape_getLocalScaling_0=function(){return n.asm.ci.apply(null,arguments)},Fl=n._emscripten_bind_btConvexTriangleMeshShape_getMargin_0=function(){return n.asm.di.apply(null,arguments)},Nl=n._emscripten_bind_btConvexTriangleMeshShape_setLocalScaling_1=function(){return n.asm.ei.apply(null,arguments)},Ul=n._emscripten_bind_btConvexTriangleMeshShape_setMargin_1=function(){return n.asm.fi.apply(null,arguments)},Vl=n._emscripten_bind_btCylinderShapeX___destroy___0=function(){return n.asm.gi.apply(null,arguments)},Gl=n._emscripten_bind_btCylinderShapeX_btCylinderShapeX_1=function(){return n.asm.hi.apply(null,arguments)},Wl=n._emscripten_bind_btCylinderShapeX_calculateLocalInertia_2=function(){return n.asm.ii.apply(null,arguments)},ql=n._emscripten_bind_btCylinderShapeX_getLocalScaling_0=function(){return n.asm.ji.apply(null,arguments)},Xl=n._emscripten_bind_btCylinderShapeX_getMargin_0=function(){return n.asm.ki.apply(null,arguments)},Yl=n._emscripten_bind_btCylinderShapeX_setLocalScaling_1=function(){return n.asm.li.apply(null,arguments)},Ql=n._emscripten_bind_btCylinderShapeX_setMargin_1=function(){return n.asm.mi.apply(null,arguments)},Zl=n._emscripten_bind_btCylinderShapeZ___destroy___0=function(){return n.asm.ni.apply(null,arguments)},Jl=n._emscripten_bind_btCylinderShapeZ_btCylinderShapeZ_1=function(){return n.asm.oi.apply(null,arguments)},Kl=n._emscripten_bind_btCylinderShapeZ_calculateLocalInertia_2=function(){return n.asm.pi.apply(null,arguments)},$l=n._emscripten_bind_btCylinderShapeZ_getLocalScaling_0=function(){return n.asm.qi.apply(null,arguments)},tc=n._emscripten_bind_btCylinderShapeZ_getMargin_0=function(){return n.asm.ri.apply(null,arguments)},ec=n._emscripten_bind_btCylinderShapeZ_setLocalScaling_1=function(){return n.asm.si.apply(null,arguments)},nc=n._emscripten_bind_btCylinderShapeZ_setMargin_1=function(){return n.asm.ti.apply(null,arguments)},rc=n._emscripten_bind_btCylinderShape___destroy___0=function(){return n.asm.ui.apply(null,arguments)},ic=n._emscripten_bind_btCylinderShape_btCylinderShape_1=function(){return n.asm.vi.apply(null,arguments)},oc=n._emscripten_bind_btCylinderShape_calculateLocalInertia_2=function(){return n.asm.wi.apply(null,arguments)},ac=n._emscripten_bind_btCylinderShape_getLocalScaling_0=function(){return n.asm.xi.apply(null,arguments)},sc=n._emscripten_bind_btCylinderShape_getMargin_0=function(){return n.asm.yi.apply(null,arguments)},lc=n._emscripten_bind_btCylinderShape_setLocalScaling_1=function(){return n.asm.zi.apply(null,arguments)},cc=n._emscripten_bind_btCylinderShape_setMargin_1=function(){return n.asm.Ai.apply(null,arguments)},uc=n._emscripten_bind_btDbvtBroadphase___destroy___0=function(){return n.asm.Bi.apply(null,arguments)},pc=n._emscripten_bind_btDbvtBroadphase_btDbvtBroadphase_0=function(){return n.asm.Ci.apply(null,arguments)},dc=n._emscripten_bind_btDefaultCollisionConfiguration___destroy___0=function(){return n.asm.Di.apply(null,arguments)},hc=n._emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_0=function(){return n.asm.Ei.apply(null,arguments)},fc=n._emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_1=function(){return n.asm.Fi.apply(null,arguments)},mc=n._emscripten_bind_btDefaultCollisionConstructionInfo___destroy___0=function(){return n.asm.Gi.apply(null,arguments)},yc=n._emscripten_bind_btDefaultCollisionConstructionInfo_btDefaultCollisionConstructionInfo_0=function(){return n.asm.Hi.apply(null,arguments)},_c=n._emscripten_bind_btDefaultMotionState___destroy___0=function(){return n.asm.Ii.apply(null,arguments)},gc=n._emscripten_bind_btDefaultMotionState_btDefaultMotionState_0=function(){return n.asm.Ji.apply(null,arguments)},vc=n._emscripten_bind_btDefaultMotionState_btDefaultMotionState_1=function(){return n.asm.Ki.apply(null,arguments)},bc=n._emscripten_bind_btDefaultMotionState_btDefaultMotionState_2=function(){return n.asm.Li.apply(null,arguments)},xc=n._emscripten_bind_btDefaultMotionState_getWorldTransform_1=function(){return n.asm.Mi.apply(null,arguments)},wc=n._emscripten_bind_btDefaultMotionState_get_m_graphicsWorldTrans_0=function(){return n.asm.Ni.apply(null,arguments)},Ec=n._emscripten_bind_btDefaultMotionState_setWorldTransform_1=function(){return n.asm.Oi.apply(null,arguments)},Tc=n._emscripten_bind_btDefaultMotionState_set_m_graphicsWorldTrans_1=function(){return n.asm.Pi.apply(null,arguments)},Sc=n._emscripten_bind_btDefaultSoftBodySolver___destroy___0=function(){return n.asm.Qi.apply(null,arguments)},Mc=n._emscripten_bind_btDefaultSoftBodySolver_btDefaultSoftBodySolver_0=function(){return n.asm.Ri.apply(null,arguments)},jc=n._emscripten_bind_btDefaultVehicleRaycaster___destroy___0=function(){return n.asm.Si.apply(null,arguments)},Cc=n._emscripten_bind_btDefaultVehicleRaycaster_btDefaultVehicleRaycaster_1=function(){return n.asm.Ti.apply(null,arguments)},zc=n._emscripten_bind_btDefaultVehicleRaycaster_castRay_3=function(){return n.asm.Ui.apply(null,arguments)},Rc=n._emscripten_bind_btDiscreteDynamicsWorld___destroy___0=function(){return n.asm.Vi.apply(null,arguments)},Ac=n._emscripten_bind_btDiscreteDynamicsWorld_activateContactAddedCallbackAdjustInternalEdgeContacts_0=function(){return n.asm.Wi.apply(null,arguments)},Lc=n._emscripten_bind_btDiscreteDynamicsWorld_addAction_1=function(){return n.asm.Xi.apply(null,arguments)},Ic=n._emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_1=function(){return n.asm.Yi.apply(null,arguments)},Pc=n._emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_2=function(){return n.asm.Zi.apply(null,arguments)},Oc=n._emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_3=function(){return n.asm._i.apply(null,arguments)},kc=n._emscripten_bind_btDiscreteDynamicsWorld_addConstraint_1=function(){return n.asm.$i.apply(null,arguments)},Bc=n._emscripten_bind_btDiscreteDynamicsWorld_addConstraint_2=function(){return n.asm.aj.apply(null,arguments)},Dc=n._emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_1=function(){return n.asm.bj.apply(null,arguments)},Hc=n._emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_3=function(){return n.asm.cj.apply(null,arguments)},Fc=n._emscripten_bind_btDiscreteDynamicsWorld_btDiscreteDynamicsWorld_4=function(){return n.asm.dj.apply(null,arguments)},Nc=n._emscripten_bind_btDiscreteDynamicsWorld_contactPairTest_3=function(){return n.asm.ej.apply(null,arguments)},Uc=n._emscripten_bind_btDiscreteDynamicsWorld_contactTest_2=function(){return n.asm.fj.apply(null,arguments)},Vc=n._emscripten_bind_btDiscreteDynamicsWorld_convexSweepTest_5=function(){return n.asm.gj.apply(null,arguments)},Gc=n._emscripten_bind_btDiscreteDynamicsWorld_debugDrawObject_3=function(){return n.asm.hj.apply(null,arguments)},Wc=n._emscripten_bind_btDiscreteDynamicsWorld_debugDrawWorld_0=function(){return n.asm.ij.apply(null,arguments)},qc=n._emscripten_bind_btDiscreteDynamicsWorld_getBroadphase_0=function(){return n.asm.jj.apply(null,arguments)},Xc=n._emscripten_bind_btDiscreteDynamicsWorld_getDebugDrawer_0=function(){return n.asm.kj.apply(null,arguments)},Yc=n._emscripten_bind_btDiscreteDynamicsWorld_getDispatchInfo_0=function(){return n.asm.lj.apply(null,arguments)},Qc=n._emscripten_bind_btDiscreteDynamicsWorld_getDispatcher_0=function(){return n.asm.mj.apply(null,arguments)},Zc=n._emscripten_bind_btDiscreteDynamicsWorld_getForceUpdateAllAabbs_0=function(){return n.asm.nj.apply(null,arguments)},Jc=n._emscripten_bind_btDiscreteDynamicsWorld_getGravity_0=function(){return n.asm.oj.apply(null,arguments)},Kc=n._emscripten_bind_btDiscreteDynamicsWorld_getPairCache_0=function(){return n.asm.pj.apply(null,arguments)},$c=n._emscripten_bind_btDiscreteDynamicsWorld_getSolverInfo_0=function(){return n.asm.qj.apply(null,arguments)},tu=n._emscripten_bind_btDiscreteDynamicsWorld_rayTest_3=function(){return n.asm.rj.apply(null,arguments)},eu=n._emscripten_bind_btDiscreteDynamicsWorld_removeAction_1=function(){return n.asm.sj.apply(null,arguments)},nu=n._emscripten_bind_btDiscreteDynamicsWorld_removeCollisionObject_1=function(){return n.asm.tj.apply(null,arguments)},ru=n._emscripten_bind_btDiscreteDynamicsWorld_removeConstraint_1=function(){return n.asm.uj.apply(null,arguments)},iu=n._emscripten_bind_btDiscreteDynamicsWorld_removeRigidBody_1=function(){return n.asm.vj.apply(null,arguments)},ou=n._emscripten_bind_btDiscreteDynamicsWorld_setContactAddedCallback_1=function(){return n.asm.wj.apply(null,arguments)},au=n._emscripten_bind_btDiscreteDynamicsWorld_setContactDestroyedCallback_1=function(){return n.asm.xj.apply(null,arguments)},su=n._emscripten_bind_btDiscreteDynamicsWorld_setContactProcessedCallback_1=function(){return n.asm.yj.apply(null,arguments)},lu=n._emscripten_bind_btDiscreteDynamicsWorld_setDebugDrawer_1=function(){return n.asm.zj.apply(null,arguments)},cu=n._emscripten_bind_btDiscreteDynamicsWorld_setForceUpdateAllAabbs_1=function(){return n.asm.Aj.apply(null,arguments)},uu=n._emscripten_bind_btDiscreteDynamicsWorld_setGravity_1=function(){return n.asm.Bj.apply(null,arguments)},pu=n._emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_1=function(){return n.asm.Cj.apply(null,arguments)},du=n._emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_2=function(){return n.asm.Dj.apply(null,arguments)},hu=n._emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_3=function(){return n.asm.Ej.apply(null,arguments)},fu=n._emscripten_bind_btDiscreteDynamicsWorld_updateSingleAabb_1=function(){return n.asm.Fj.apply(null,arguments)},mu=n._emscripten_bind_btDispatcherInfo___destroy___0=function(){return n.asm.Gj.apply(null,arguments)},yu=n._emscripten_bind_btDispatcherInfo_get_m_allowedCcdPenetration_0=function(){return n.asm.Hj.apply(null,arguments)},_u=n._emscripten_bind_btDispatcherInfo_get_m_convexConservativeDistanceThreshold_0=function(){return n.asm.Ij.apply(null,arguments)},gu=n._emscripten_bind_btDispatcherInfo_get_m_dispatchFunc_0=function(){return n.asm.Jj.apply(null,arguments)},vu=n._emscripten_bind_btDispatcherInfo_get_m_enableSPU_0=function(){return n.asm.Kj.apply(null,arguments)},bu=n._emscripten_bind_btDispatcherInfo_get_m_enableSatConvex_0=function(){return n.asm.Lj.apply(null,arguments)},xu=n._emscripten_bind_btDispatcherInfo_get_m_stepCount_0=function(){return n.asm.Mj.apply(null,arguments)},wu=n._emscripten_bind_btDispatcherInfo_get_m_timeOfImpact_0=function(){return n.asm.Nj.apply(null,arguments)},Eu=n._emscripten_bind_btDispatcherInfo_get_m_timeStep_0=function(){return n.asm.Oj.apply(null,arguments)},Tu=n._emscripten_bind_btDispatcherInfo_get_m_useContinuous_0=function(){return n.asm.Pj.apply(null,arguments)},Su=n._emscripten_bind_btDispatcherInfo_get_m_useConvexConservativeDistanceUtil_0=function(){return n.asm.Qj.apply(null,arguments)},Mu=n._emscripten_bind_btDispatcherInfo_get_m_useEpa_0=function(){return n.asm.Rj.apply(null,arguments)},ju=n._emscripten_bind_btDispatcherInfo_set_m_allowedCcdPenetration_1=function(){return n.asm.Sj.apply(null,arguments)},Cu=n._emscripten_bind_btDispatcherInfo_set_m_convexConservativeDistanceThreshold_1=function(){return n.asm.Tj.apply(null,arguments)},zu=n._emscripten_bind_btDispatcherInfo_set_m_dispatchFunc_1=function(){return n.asm.Uj.apply(null,arguments)},Ru=n._emscripten_bind_btDispatcherInfo_set_m_enableSPU_1=function(){return n.asm.Vj.apply(null,arguments)},Au=n._emscripten_bind_btDispatcherInfo_set_m_enableSatConvex_1=function(){return n.asm.Wj.apply(null,arguments)},Lu=n._emscripten_bind_btDispatcherInfo_set_m_stepCount_1=function(){return n.asm.Xj.apply(null,arguments)},Iu=n._emscripten_bind_btDispatcherInfo_set_m_timeOfImpact_1=function(){return n.asm.Yj.apply(null,arguments)},Pu=n._emscripten_bind_btDispatcherInfo_set_m_timeStep_1=function(){return n.asm.Zj.apply(null,arguments)},Ou=n._emscripten_bind_btDispatcherInfo_set_m_useContinuous_1=function(){return n.asm._j.apply(null,arguments)},ku=n._emscripten_bind_btDispatcherInfo_set_m_useConvexConservativeDistanceUtil_1=function(){return n.asm.$j.apply(null,arguments)},Bu=n._emscripten_bind_btDispatcherInfo_set_m_useEpa_1=function(){return n.asm.ak.apply(null,arguments)},Du=n._emscripten_bind_btDispatcher___destroy___0=function(){return n.asm.bk.apply(null,arguments)},Hu=n._emscripten_bind_btDispatcher_getManifoldByIndexInternal_1=function(){return n.asm.ck.apply(null,arguments)},Fu=n._emscripten_bind_btDispatcher_getNumManifolds_0=function(){return n.asm.dk.apply(null,arguments)},Nu=n._emscripten_bind_btDynamicsWorld___destroy___0=function(){return n.asm.ek.apply(null,arguments)},Uu=n._emscripten_bind_btDynamicsWorld_addAction_1=function(){return n.asm.fk.apply(null,arguments)},Vu=n._emscripten_bind_btDynamicsWorld_addCollisionObject_1=function(){return n.asm.gk.apply(null,arguments)},Gu=n._emscripten_bind_btDynamicsWorld_addCollisionObject_2=function(){return n.asm.hk.apply(null,arguments)},Wu=n._emscripten_bind_btDynamicsWorld_addCollisionObject_3=function(){return n.asm.ik.apply(null,arguments)},qu=n._emscripten_bind_btDynamicsWorld_contactPairTest_3=function(){return n.asm.jk.apply(null,arguments)},Xu=n._emscripten_bind_btDynamicsWorld_contactTest_2=function(){return n.asm.kk.apply(null,arguments)},Yu=n._emscripten_bind_btDynamicsWorld_convexSweepTest_5=function(){return n.asm.lk.apply(null,arguments)},Qu=n._emscripten_bind_btDynamicsWorld_debugDrawObject_3=function(){return n.asm.mk.apply(null,arguments)},Zu=n._emscripten_bind_btDynamicsWorld_debugDrawWorld_0=function(){return n.asm.nk.apply(null,arguments)},Ju=n._emscripten_bind_btDynamicsWorld_getBroadphase_0=function(){return n.asm.ok.apply(null,arguments)},Ku=n._emscripten_bind_btDynamicsWorld_getDebugDrawer_0=function(){return n.asm.pk.apply(null,arguments)},$u=n._emscripten_bind_btDynamicsWorld_getDispatchInfo_0=function(){return n.asm.qk.apply(null,arguments)},tp=n._emscripten_bind_btDynamicsWorld_getDispatcher_0=function(){return n.asm.rk.apply(null,arguments)},ep=n._emscripten_bind_btDynamicsWorld_getForceUpdateAllAabbs_0=function(){return n.asm.sk.apply(null,arguments)},np=n._emscripten_bind_btDynamicsWorld_getPairCache_0=function(){return n.asm.tk.apply(null,arguments)},rp=n._emscripten_bind_btDynamicsWorld_getSolverInfo_0=function(){return n.asm.uk.apply(null,arguments)},ip=n._emscripten_bind_btDynamicsWorld_rayTest_3=function(){return n.asm.vk.apply(null,arguments)},op=n._emscripten_bind_btDynamicsWorld_removeAction_1=function(){return n.asm.wk.apply(null,arguments)},ap=n._emscripten_bind_btDynamicsWorld_removeCollisionObject_1=function(){return n.asm.xk.apply(null,arguments)},sp=n._emscripten_bind_btDynamicsWorld_setDebugDrawer_1=function(){return n.asm.yk.apply(null,arguments)},lp=n._emscripten_bind_btDynamicsWorld_setForceUpdateAllAabbs_1=function(){return n.asm.zk.apply(null,arguments)},cp=n._emscripten_bind_btDynamicsWorld_updateSingleAabb_1=function(){return n.asm.Ak.apply(null,arguments)},up=n._emscripten_bind_btEmptyShape___destroy___0=function(){return n.asm.Bk.apply(null,arguments)},pp=n._emscripten_bind_btEmptyShape_btEmptyShape_0=function(){return n.asm.Ck.apply(null,arguments)},dp=n._emscripten_bind_btEmptyShape_calculateLocalInertia_2=function(){return n.asm.Dk.apply(null,arguments)},hp=n._emscripten_bind_btEmptyShape_getLocalScaling_0=function(){return n.asm.Ek.apply(null,arguments)},fp=n._emscripten_bind_btEmptyShape_setLocalScaling_1=function(){return n.asm.Fk.apply(null,arguments)},mp=n._emscripten_bind_btFaceArray___destroy___0=function(){return n.asm.Gk.apply(null,arguments)},yp=n._emscripten_bind_btFaceArray_at_1=function(){return n.asm.Hk.apply(null,arguments)},_p=n._emscripten_bind_btFaceArray_size_0=function(){return n.asm.Ik.apply(null,arguments)},gp=n._emscripten_bind_btFace___destroy___0=function(){return n.asm.Jk.apply(null,arguments)},vp=n._emscripten_bind_btFace_get_m_indices_0=function(){return n.asm.Kk.apply(null,arguments)},bp=n._emscripten_bind_btFace_get_m_plane_1=function(){return n.asm.Lk.apply(null,arguments)},xp=n._emscripten_bind_btFace_set_m_indices_1=function(){return n.asm.Mk.apply(null,arguments)},wp=n._emscripten_bind_btFace_set_m_plane_2=function(){return n.asm.Nk.apply(null,arguments)},Ep=n._emscripten_bind_btFixedConstraint___destroy___0=function(){return n.asm.Ok.apply(null,arguments)},Tp=n._emscripten_bind_btFixedConstraint_btFixedConstraint_4=function(){return n.asm.Pk.apply(null,arguments)},Sp=n._emscripten_bind_btFixedConstraint_enableFeedback_1=function(){return n.asm.Qk.apply(null,arguments)},Mp=n._emscripten_bind_btFixedConstraint_getBreakingImpulseThreshold_0=function(){return n.asm.Rk.apply(null,arguments)},jp=n._emscripten_bind_btFixedConstraint_getParam_2=function(){return n.asm.Sk.apply(null,arguments)},Cp=n._emscripten_bind_btFixedConstraint_setBreakingImpulseThreshold_1=function(){return n.asm.Tk.apply(null,arguments)},zp=n._emscripten_bind_btFixedConstraint_setParam_3=function(){return n.asm.Uk.apply(null,arguments)},Rp=n._emscripten_bind_btGeneric6DofConstraint___destroy___0=function(){return n.asm.Vk.apply(null,arguments)},Ap=n._emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_3=function(){return n.asm.Wk.apply(null,arguments)},Lp=n._emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_5=function(){return n.asm.Xk.apply(null,arguments)},Ip=n._emscripten_bind_btGeneric6DofConstraint_enableFeedback_1=function(){return n.asm.Yk.apply(null,arguments)},Pp=n._emscripten_bind_btGeneric6DofConstraint_getBreakingImpulseThreshold_0=function(){return n.asm.Zk.apply(null,arguments)},Op=n._emscripten_bind_btGeneric6DofConstraint_getFrameOffsetA_0=function(){return n.asm._k.apply(null,arguments)},kp=n._emscripten_bind_btGeneric6DofConstraint_getParam_2=function(){return n.asm.$k.apply(null,arguments)},Bp=n._emscripten_bind_btGeneric6DofConstraint_setAngularLowerLimit_1=function(){return n.asm.al.apply(null,arguments)},Dp=n._emscripten_bind_btGeneric6DofConstraint_setAngularUpperLimit_1=function(){return n.asm.bl.apply(null,arguments)},Hp=n._emscripten_bind_btGeneric6DofConstraint_setBreakingImpulseThreshold_1=function(){return n.asm.cl.apply(null,arguments)},Fp=n._emscripten_bind_btGeneric6DofConstraint_setLinearLowerLimit_1=function(){return n.asm.dl.apply(null,arguments)},Np=n._emscripten_bind_btGeneric6DofConstraint_setLinearUpperLimit_1=function(){return n.asm.el.apply(null,arguments)},Up=n._emscripten_bind_btGeneric6DofConstraint_setParam_3=function(){return n.asm.fl.apply(null,arguments)},Vp=n._emscripten_bind_btGeneric6DofSpringConstraint___destroy___0=function(){return n.asm.gl.apply(null,arguments)},Gp=n._emscripten_bind_btGeneric6DofSpringConstraint_btGeneric6DofSpringConstraint_3=function(){return n.asm.hl.apply(null,arguments)},Wp=n._emscripten_bind_btGeneric6DofSpringConstraint_btGeneric6DofSpringConstraint_5=function(){return n.asm.il.apply(null,arguments)},qp=n._emscripten_bind_btGeneric6DofSpringConstraint_enableFeedback_1=function(){return n.asm.jl.apply(null,arguments)},Xp=n._emscripten_bind_btGeneric6DofSpringConstraint_enableSpring_2=function(){return n.asm.kl.apply(null,arguments)},Yp=n._emscripten_bind_btGeneric6DofSpringConstraint_getBreakingImpulseThreshold_0=function(){return n.asm.ll.apply(null,arguments)},Qp=n._emscripten_bind_btGeneric6DofSpringConstraint_getFrameOffsetA_0=function(){return n.asm.ml.apply(null,arguments)},Zp=n._emscripten_bind_btGeneric6DofSpringConstraint_getParam_2=function(){return n.asm.nl.apply(null,arguments)},Jp=n._emscripten_bind_btGeneric6DofSpringConstraint_setAngularLowerLimit_1=function(){return n.asm.ol.apply(null,arguments)},Kp=n._emscripten_bind_btGeneric6DofSpringConstraint_setAngularUpperLimit_1=function(){return n.asm.pl.apply(null,arguments)},$p=n._emscripten_bind_btGeneric6DofSpringConstraint_setBreakingImpulseThreshold_1=function(){return n.asm.ql.apply(null,arguments)},td=n._emscripten_bind_btGeneric6DofSpringConstraint_setDamping_2=function(){return n.asm.rl.apply(null,arguments)},ed=n._emscripten_bind_btGeneric6DofSpringConstraint_setEquilibriumPoint_0=function(){return n.asm.sl.apply(null,arguments)},nd=n._emscripten_bind_btGeneric6DofSpringConstraint_setEquilibriumPoint_1=function(){return n.asm.tl.apply(null,arguments)},rd=n._emscripten_bind_btGeneric6DofSpringConstraint_setEquilibriumPoint_2=function(){return n.asm.ul.apply(null,arguments)},id=n._emscripten_bind_btGeneric6DofSpringConstraint_setLinearLowerLimit_1=function(){return n.asm.vl.apply(null,arguments)},od=n._emscripten_bind_btGeneric6DofSpringConstraint_setLinearUpperLimit_1=function(){return n.asm.wl.apply(null,arguments)},ad=n._emscripten_bind_btGeneric6DofSpringConstraint_setParam_3=function(){return n.asm.xl.apply(null,arguments)},sd=n._emscripten_bind_btGeneric6DofSpringConstraint_setStiffness_2=function(){return n.asm.yl.apply(null,arguments)},ld=n._emscripten_bind_btGhostObject___destroy___0=function(){return n.asm.zl.apply(null,arguments)},cd=n._emscripten_bind_btGhostObject_activate_0=function(){return n.asm.Al.apply(null,arguments)},ud=n._emscripten_bind_btGhostObject_activate_1=function(){return n.asm.Bl.apply(null,arguments)},pd=n._emscripten_bind_btGhostObject_btGhostObject_0=function(){return n.asm.Cl.apply(null,arguments)},dd=n._emscripten_bind_btGhostObject_forceActivationState_1=function(){return n.asm.Dl.apply(null,arguments)},hd=n._emscripten_bind_btGhostObject_getBroadphaseHandle_0=function(){return n.asm.El.apply(null,arguments)},fd=n._emscripten_bind_btGhostObject_getCollisionFlags_0=function(){return n.asm.Fl.apply(null,arguments)},md=n._emscripten_bind_btGhostObject_getCollisionShape_0=function(){return n.asm.Gl.apply(null,arguments)},yd=n._emscripten_bind_btGhostObject_getFriction_0=function(){return n.asm.Hl.apply(null,arguments)},_d=n._emscripten_bind_btGhostObject_getNumOverlappingObjects_0=function(){return n.asm.Il.apply(null,arguments)},gd=n._emscripten_bind_btGhostObject_getOverlappingObject_1=function(){return n.asm.Jl.apply(null,arguments)},vd=n._emscripten_bind_btGhostObject_getRestitution_0=function(){return n.asm.Kl.apply(null,arguments)},bd=n._emscripten_bind_btGhostObject_getRollingFriction_0=function(){return n.asm.Ll.apply(null,arguments)},xd=n._emscripten_bind_btGhostObject_getUserIndex_0=function(){return n.asm.Ml.apply(null,arguments)},wd=n._emscripten_bind_btGhostObject_getUserPointer_0=function(){return n.asm.Nl.apply(null,arguments)},Ed=n._emscripten_bind_btGhostObject_getWorldTransform_0=function(){return n.asm.Ol.apply(null,arguments)},Td=n._emscripten_bind_btGhostObject_isActive_0=function(){return n.asm.Pl.apply(null,arguments)},Sd=n._emscripten_bind_btGhostObject_isKinematicObject_0=function(){return n.asm.Ql.apply(null,arguments)},Md=n._emscripten_bind_btGhostObject_isStaticObject_0=function(){return n.asm.Rl.apply(null,arguments)},jd=n._emscripten_bind_btGhostObject_isStaticOrKinematicObject_0=function(){return n.asm.Sl.apply(null,arguments)},Cd=n._emscripten_bind_btGhostObject_setActivationState_1=function(){return n.asm.Tl.apply(null,arguments)},zd=n._emscripten_bind_btGhostObject_setAnisotropicFriction_2=function(){return n.asm.Ul.apply(null,arguments)},Rd=n._emscripten_bind_btGhostObject_setCcdMotionThreshold_1=function(){return n.asm.Vl.apply(null,arguments)},Ad=n._emscripten_bind_btGhostObject_setCcdSweptSphereRadius_1=function(){return n.asm.Wl.apply(null,arguments)},Ld=n._emscripten_bind_btGhostObject_setCollisionFlags_1=function(){return n.asm.Xl.apply(null,arguments)},Id=n._emscripten_bind_btGhostObject_setCollisionShape_1=function(){return n.asm.Yl.apply(null,arguments)},Pd=n._emscripten_bind_btGhostObject_setContactProcessingThreshold_1=function(){return n.asm.Zl.apply(null,arguments)},Od=n._emscripten_bind_btGhostObject_setFriction_1=function(){return n.asm._l.apply(null,arguments)},kd=n._emscripten_bind_btGhostObject_setIgnoreCollisionCheck_2=function(){return n.asm.$l.apply(null,arguments)},Bd=n._emscripten_bind_btGhostObject_setRestitution_1=function(){return n.asm.am.apply(null,arguments)},Dd=n._emscripten_bind_btGhostObject_setRollingFriction_1=function(){return n.asm.bm.apply(null,arguments)},Hd=n._emscripten_bind_btGhostObject_setUserIndex_1=function(){return n.asm.cm.apply(null,arguments)},Fd=n._emscripten_bind_btGhostObject_setUserPointer_1=function(){return n.asm.dm.apply(null,arguments)},Nd=n._emscripten_bind_btGhostObject_setWorldTransform_1=function(){return n.asm.em.apply(null,arguments)},Ud=n._emscripten_bind_btGhostPairCallback___destroy___0=function(){return n.asm.fm.apply(null,arguments)},Vd=n._emscripten_bind_btGhostPairCallback_btGhostPairCallback_0=function(){return n.asm.gm.apply(null,arguments)},Gd=n._emscripten_bind_btHeightfieldTerrainShape___destroy___0=function(){return n.asm.hm.apply(null,arguments)},Wd=n._emscripten_bind_btHeightfieldTerrainShape_btHeightfieldTerrainShape_9=function(){return n.asm.im.apply(null,arguments)},qd=n._emscripten_bind_btHeightfieldTerrainShape_calculateLocalInertia_2=function(){return n.asm.jm.apply(null,arguments)},Xd=n._emscripten_bind_btHeightfieldTerrainShape_getLocalScaling_0=function(){return n.asm.km.apply(null,arguments)},Yd=n._emscripten_bind_btHeightfieldTerrainShape_getMargin_0=function(){return n.asm.lm.apply(null,arguments)},Qd=n._emscripten_bind_btHeightfieldTerrainShape_setLocalScaling_1=function(){return n.asm.mm.apply(null,arguments)},Zd=n._emscripten_bind_btHeightfieldTerrainShape_setMargin_1=function(){return n.asm.nm.apply(null,arguments)},Jd=n._emscripten_bind_btHingeConstraint___destroy___0=function(){return n.asm.om.apply(null,arguments)},Kd=n._emscripten_bind_btHingeConstraint_btHingeConstraint_3=function(){return n.asm.pm.apply(null,arguments)},$d=n._emscripten_bind_btHingeConstraint_btHingeConstraint_4=function(){return n.asm.qm.apply(null,arguments)},th=n._emscripten_bind_btHingeConstraint_btHingeConstraint_5=function(){return n.asm.rm.apply(null,arguments)},eh=n._emscripten_bind_btHingeConstraint_btHingeConstraint_6=function(){return n.asm.sm.apply(null,arguments)},nh=n._emscripten_bind_btHingeConstraint_btHingeConstraint_7=function(){return n.asm.tm.apply(null,arguments)},rh=n._emscripten_bind_btHingeConstraint_enableAngularMotor_3=function(){return n.asm.um.apply(null,arguments)},ih=n._emscripten_bind_btHingeConstraint_enableFeedback_1=function(){return n.asm.vm.apply(null,arguments)},oh=n._emscripten_bind_btHingeConstraint_enableMotor_1=function(){return n.asm.wm.apply(null,arguments)},ah=n._emscripten_bind_btHingeConstraint_getBreakingImpulseThreshold_0=function(){return n.asm.xm.apply(null,arguments)},sh=n._emscripten_bind_btHingeConstraint_getParam_2=function(){return n.asm.ym.apply(null,arguments)},lh=n._emscripten_bind_btHingeConstraint_setAngularOnly_1=function(){return n.asm.zm.apply(null,arguments)},ch=n._emscripten_bind_btHingeConstraint_setBreakingImpulseThreshold_1=function(){return n.asm.Am.apply(null,arguments)},uh=n._emscripten_bind_btHingeConstraint_setLimit_2=function(){return n.asm.Bm.apply(null,arguments)},ph=n._emscripten_bind_btHingeConstraint_setLimit_3=function(){return n.asm.Cm.apply(null,arguments)},dh=n._emscripten_bind_btHingeConstraint_setLimit_4=function(){return n.asm.Dm.apply(null,arguments)},hh=n._emscripten_bind_btHingeConstraint_setLimit_5=function(){return n.asm.Em.apply(null,arguments)},fh=n._emscripten_bind_btHingeConstraint_setMaxMotorImpulse_1=function(){return n.asm.Fm.apply(null,arguments)},mh=n._emscripten_bind_btHingeConstraint_setMotorTarget_2=function(){return n.asm.Gm.apply(null,arguments)},yh=n._emscripten_bind_btHingeConstraint_setParam_3=function(){return n.asm.Hm.apply(null,arguments)},_h=n._emscripten_bind_btIDebugDraw___destroy___0=function(){return n.asm.Im.apply(null,arguments)},gh=n._emscripten_bind_btIDebugDraw_draw3dText_2=function(){return n.asm.Jm.apply(null,arguments)},vh=n._emscripten_bind_btIDebugDraw_drawContactPoint_5=function(){return n.asm.Km.apply(null,arguments)},bh=n._emscripten_bind_btIDebugDraw_drawLine_3=function(){return n.asm.Lm.apply(null,arguments)},xh=n._emscripten_bind_btIDebugDraw_getDebugMode_0=function(){return n.asm.Mm.apply(null,arguments)},wh=n._emscripten_bind_btIDebugDraw_reportErrorWarning_1=function(){return n.asm.Nm.apply(null,arguments)},Eh=n._emscripten_bind_btIDebugDraw_setDebugMode_1=function(){return n.asm.Om.apply(null,arguments)},Th=n._emscripten_bind_btIndexedMeshArray___destroy___0=function(){return n.asm.Pm.apply(null,arguments)},Sh=n._emscripten_bind_btIndexedMeshArray_at_1=function(){return n.asm.Qm.apply(null,arguments)},Mh=n._emscripten_bind_btIndexedMeshArray_size_0=function(){return n.asm.Rm.apply(null,arguments)},jh=n._emscripten_bind_btIndexedMesh___destroy___0=function(){return n.asm.Sm.apply(null,arguments)},Ch=n._emscripten_bind_btIndexedMesh_get_m_numTriangles_0=function(){return n.asm.Tm.apply(null,arguments)},zh=n._emscripten_bind_btIndexedMesh_set_m_numTriangles_1=function(){return n.asm.Um.apply(null,arguments)},Rh=n._emscripten_bind_btIntArray___destroy___0=function(){return n.asm.Vm.apply(null,arguments)},Ah=n._emscripten_bind_btIntArray_at_1=function(){return n.asm.Wm.apply(null,arguments)},Lh=n._emscripten_bind_btIntArray_size_0=function(){return n.asm.Xm.apply(null,arguments)},Ih=n._emscripten_bind_btKinematicCharacterController___destroy___0=function(){return n.asm.Ym.apply(null,arguments)},Ph=n._emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_3=function(){return n.asm.Zm.apply(null,arguments)},Oh=n._emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_4=function(){return n.asm._m.apply(null,arguments)},kh=n._emscripten_bind_btKinematicCharacterController_canJump_0=function(){return n.asm.$m.apply(null,arguments)},Bh=n._emscripten_bind_btKinematicCharacterController_getGhostObject_0=function(){return n.asm.an.apply(null,arguments)},Dh=n._emscripten_bind_btKinematicCharacterController_getGravity_0=function(){return n.asm.bn.apply(null,arguments)},Hh=n._emscripten_bind_btKinematicCharacterController_getMaxSlope_0=function(){return n.asm.cn.apply(null,arguments)},Fh=n._emscripten_bind_btKinematicCharacterController_jump_0=function(){return n.asm.dn.apply(null,arguments)},Nh=n._emscripten_bind_btKinematicCharacterController_onGround_0=function(){return n.asm.en.apply(null,arguments)},Uh=n._emscripten_bind_btKinematicCharacterController_playerStep_2=function(){return n.asm.fn.apply(null,arguments)},Vh=n._emscripten_bind_btKinematicCharacterController_preStep_1=function(){return n.asm.gn.apply(null,arguments)},Gh=n._emscripten_bind_btKinematicCharacterController_setFallSpeed_1=function(){return n.asm.hn.apply(null,arguments)},Wh=n._emscripten_bind_btKinematicCharacterController_setGravity_1=function(){return n.asm.jn.apply(null,arguments)},qh=n._emscripten_bind_btKinematicCharacterController_setJumpSpeed_1=function(){return n.asm.kn.apply(null,arguments)},Xh=n._emscripten_bind_btKinematicCharacterController_setMaxJumpHeight_1=function(){return n.asm.ln.apply(null,arguments)},Yh=n._emscripten_bind_btKinematicCharacterController_setMaxSlope_1=function(){return n.asm.mn.apply(null,arguments)},Qh=n._emscripten_bind_btKinematicCharacterController_setUpAxis_1=function(){return n.asm.nn.apply(null,arguments)},Zh=n._emscripten_bind_btKinematicCharacterController_setUpInterpolate_1=function(){return n.asm.on.apply(null,arguments)},Jh=n._emscripten_bind_btKinematicCharacterController_setUseGhostSweepTest_1=function(){return n.asm.pn.apply(null,arguments)},Kh=n._emscripten_bind_btKinematicCharacterController_setVelocityForTimeInterval_2=function(){return n.asm.qn.apply(null,arguments)},$h=n._emscripten_bind_btKinematicCharacterController_setWalkDirection_1=function(){return n.asm.rn.apply(null,arguments)},tf=n._emscripten_bind_btKinematicCharacterController_updateAction_2=function(){return n.asm.sn.apply(null,arguments)},ef=n._emscripten_bind_btKinematicCharacterController_warp_1=function(){return n.asm.tn.apply(null,arguments)},nf=n._emscripten_bind_btManifoldPoint___destroy___0=function(){return n.asm.un.apply(null,arguments)},rf=n._emscripten_bind_btManifoldPoint_getAppliedImpulse_0=function(){return n.asm.vn.apply(null,arguments)},of=n._emscripten_bind_btManifoldPoint_getDistance_0=function(){return n.asm.wn.apply(null,arguments)},af=n._emscripten_bind_btManifoldPoint_getPositionWorldOnA_0=function(){return n.asm.xn.apply(null,arguments)},sf=n._emscripten_bind_btManifoldPoint_getPositionWorldOnB_0=function(){return n.asm.yn.apply(null,arguments)},lf=n._emscripten_bind_btManifoldPoint_get_m_localPointA_0=function(){return n.asm.zn.apply(null,arguments)},cf=n._emscripten_bind_btManifoldPoint_get_m_localPointB_0=function(){return n.asm.An.apply(null,arguments)},uf=n._emscripten_bind_btManifoldPoint_get_m_normalWorldOnB_0=function(){return n.asm.Bn.apply(null,arguments)},pf=n._emscripten_bind_btManifoldPoint_get_m_positionWorldOnA_0=function(){return n.asm.Cn.apply(null,arguments)},df=n._emscripten_bind_btManifoldPoint_get_m_positionWorldOnB_0=function(){return n.asm.Dn.apply(null,arguments)},hf=n._emscripten_bind_btManifoldPoint_get_m_userPersistentData_0=function(){return n.asm.En.apply(null,arguments)},ff=n._emscripten_bind_btManifoldPoint_set_m_localPointA_1=function(){return n.asm.Fn.apply(null,arguments)},mf=n._emscripten_bind_btManifoldPoint_set_m_localPointB_1=function(){return n.asm.Gn.apply(null,arguments)},yf=n._emscripten_bind_btManifoldPoint_set_m_normalWorldOnB_1=function(){return n.asm.Hn.apply(null,arguments)},_f=n._emscripten_bind_btManifoldPoint_set_m_positionWorldOnA_1=function(){return n.asm.In.apply(null,arguments)},gf=n._emscripten_bind_btManifoldPoint_set_m_positionWorldOnB_1=function(){return n.asm.Jn.apply(null,arguments)},vf=n._emscripten_bind_btManifoldPoint_set_m_userPersistentData_1=function(){return n.asm.Kn.apply(null,arguments)},bf=n._emscripten_bind_btMatrix3x3___destroy___0=function(){return n.asm.Ln.apply(null,arguments)},xf=n._emscripten_bind_btMatrix3x3_getRotation_1=function(){return n.asm.Mn.apply(null,arguments)},wf=n._emscripten_bind_btMatrix3x3_getRow_1=function(){return n.asm.Nn.apply(null,arguments)},Ef=n._emscripten_bind_btMatrix3x3_setEulerZYX_3=function(){return n.asm.On.apply(null,arguments)},Tf=n._emscripten_bind_btMotionState___destroy___0=function(){return n.asm.Pn.apply(null,arguments)},Sf=n._emscripten_bind_btMotionState_getWorldTransform_1=function(){return n.asm.Qn.apply(null,arguments)},Mf=n._emscripten_bind_btMotionState_setWorldTransform_1=function(){return n.asm.Rn.apply(null,arguments)},jf=n._emscripten_bind_btMultiSphereShape___destroy___0=function(){return n.asm.Sn.apply(null,arguments)},Cf=n._emscripten_bind_btMultiSphereShape_btMultiSphereShape_3=function(){return n.asm.Tn.apply(null,arguments)},zf=n._emscripten_bind_btMultiSphereShape_calculateLocalInertia_2=function(){return n.asm.Un.apply(null,arguments)},Rf=n._emscripten_bind_btMultiSphereShape_getLocalScaling_0=function(){return n.asm.Vn.apply(null,arguments)},Af=n._emscripten_bind_btMultiSphereShape_setLocalScaling_1=function(){return n.asm.Wn.apply(null,arguments)},Lf=n._emscripten_bind_btOverlappingPairCache___destroy___0=function(){return n.asm.Xn.apply(null,arguments)},If=n._emscripten_bind_btOverlappingPairCache_getNumOverlappingPairs_0=function(){return n.asm.Yn.apply(null,arguments)},Pf=n._emscripten_bind_btOverlappingPairCache_setInternalGhostPairCallback_1=function(){return n.asm.Zn.apply(null,arguments)},Of=n._emscripten_bind_btOverlappingPairCallback___destroy___0=function(){return n.asm._n.apply(null,arguments)},kf=n._emscripten_bind_btPairCachingGhostObject___destroy___0=function(){return n.asm.$n.apply(null,arguments)},Bf=n._emscripten_bind_btPairCachingGhostObject_activate_0=function(){return n.asm.ao.apply(null,arguments)},Df=n._emscripten_bind_btPairCachingGhostObject_activate_1=function(){return n.asm.bo.apply(null,arguments)},Hf=n._emscripten_bind_btPairCachingGhostObject_btPairCachingGhostObject_0=function(){return n.asm.co.apply(null,arguments)},Ff=n._emscripten_bind_btPairCachingGhostObject_forceActivationState_1=function(){return n.asm.eo.apply(null,arguments)},Nf=n._emscripten_bind_btPairCachingGhostObject_getBroadphaseHandle_0=function(){return n.asm.fo.apply(null,arguments)},Uf=n._emscripten_bind_btPairCachingGhostObject_getCollisionFlags_0=function(){return n.asm.go.apply(null,arguments)},Vf=n._emscripten_bind_btPairCachingGhostObject_getCollisionShape_0=function(){return n.asm.ho.apply(null,arguments)},Gf=n._emscripten_bind_btPairCachingGhostObject_getFriction_0=function(){return n.asm.io.apply(null,arguments)},Wf=n._emscripten_bind_btPairCachingGhostObject_getNumOverlappingObjects_0=function(){return n.asm.jo.apply(null,arguments)},qf=n._emscripten_bind_btPairCachingGhostObject_getOverlappingObject_1=function(){return n.asm.ko.apply(null,arguments)},Xf=n._emscripten_bind_btPairCachingGhostObject_getRestitution_0=function(){return n.asm.lo.apply(null,arguments)},Yf=n._emscripten_bind_btPairCachingGhostObject_getRollingFriction_0=function(){return n.asm.mo.apply(null,arguments)},Qf=n._emscripten_bind_btPairCachingGhostObject_getUserIndex_0=function(){return n.asm.no.apply(null,arguments)},Zf=n._emscripten_bind_btPairCachingGhostObject_getUserPointer_0=function(){return n.asm.oo.apply(null,arguments)},Jf=n._emscripten_bind_btPairCachingGhostObject_getWorldTransform_0=function(){return n.asm.po.apply(null,arguments)},Kf=n._emscripten_bind_btPairCachingGhostObject_isActive_0=function(){return n.asm.qo.apply(null,arguments)},$f=n._emscripten_bind_btPairCachingGhostObject_isKinematicObject_0=function(){return n.asm.ro.apply(null,arguments)},tm=n._emscripten_bind_btPairCachingGhostObject_isStaticObject_0=function(){return n.asm.so.apply(null,arguments)},em=n._emscripten_bind_btPairCachingGhostObject_isStaticOrKinematicObject_0=function(){return n.asm.to.apply(null,arguments)},nm=n._emscripten_bind_btPairCachingGhostObject_setActivationState_1=function(){return n.asm.uo.apply(null,arguments)},rm=n._emscripten_bind_btPairCachingGhostObject_setAnisotropicFriction_2=function(){return n.asm.vo.apply(null,arguments)},im=n._emscripten_bind_btPairCachingGhostObject_setCcdMotionThreshold_1=function(){return n.asm.wo.apply(null,arguments)},om=n._emscripten_bind_btPairCachingGhostObject_setCcdSweptSphereRadius_1=function(){return n.asm.xo.apply(null,arguments)},am=n._emscripten_bind_btPairCachingGhostObject_setCollisionFlags_1=function(){return n.asm.yo.apply(null,arguments)},sm=n._emscripten_bind_btPairCachingGhostObject_setCollisionShape_1=function(){return n.asm.zo.apply(null,arguments)},lm=n._emscripten_bind_btPairCachingGhostObject_setContactProcessingThreshold_1=function(){return n.asm.Ao.apply(null,arguments)},cm=n._emscripten_bind_btPairCachingGhostObject_setFriction_1=function(){return n.asm.Bo.apply(null,arguments)},um=n._emscripten_bind_btPairCachingGhostObject_setIgnoreCollisionCheck_2=function(){return n.asm.Co.apply(null,arguments)},pm=n._emscripten_bind_btPairCachingGhostObject_setRestitution_1=function(){return n.asm.Do.apply(null,arguments)},dm=n._emscripten_bind_btPairCachingGhostObject_setRollingFriction_1=function(){return n.asm.Eo.apply(null,arguments)},hm=n._emscripten_bind_btPairCachingGhostObject_setUserIndex_1=function(){return n.asm.Fo.apply(null,arguments)},fm=n._emscripten_bind_btPairCachingGhostObject_setUserPointer_1=function(){return n.asm.Go.apply(null,arguments)},mm=n._emscripten_bind_btPairCachingGhostObject_setWorldTransform_1=function(){return n.asm.Ho.apply(null,arguments)},ym=n._emscripten_bind_btPersistentManifold___destroy___0=function(){return n.asm.Io.apply(null,arguments)},_m=n._emscripten_bind_btPersistentManifold_btPersistentManifold_0=function(){return n.asm.Jo.apply(null,arguments)},gm=n._emscripten_bind_btPersistentManifold_getBody0_0=function(){return n.asm.Ko.apply(null,arguments)},vm=n._emscripten_bind_btPersistentManifold_getBody1_0=function(){return n.asm.Lo.apply(null,arguments)},bm=n._emscripten_bind_btPersistentManifold_getContactPoint_1=function(){return n.asm.Mo.apply(null,arguments)},xm=n._emscripten_bind_btPersistentManifold_getNumContacts_0=function(){return n.asm.No.apply(null,arguments)},wm=n._emscripten_bind_btPoint2PointConstraint___destroy___0=function(){return n.asm.Oo.apply(null,arguments)},Em=n._emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_2=function(){return n.asm.Po.apply(null,arguments)},Tm=n._emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_4=function(){return n.asm.Qo.apply(null,arguments)},Sm=n._emscripten_bind_btPoint2PointConstraint_enableFeedback_1=function(){return n.asm.Ro.apply(null,arguments)},Mm=n._emscripten_bind_btPoint2PointConstraint_getBreakingImpulseThreshold_0=function(){return n.asm.So.apply(null,arguments)},jm=n._emscripten_bind_btPoint2PointConstraint_getParam_2=function(){return n.asm.To.apply(null,arguments)},Cm=n._emscripten_bind_btPoint2PointConstraint_getPivotInA_0=function(){return n.asm.Uo.apply(null,arguments)},zm=n._emscripten_bind_btPoint2PointConstraint_getPivotInB_0=function(){return n.asm.Vo.apply(null,arguments)},Rm=n._emscripten_bind_btPoint2PointConstraint_get_m_setting_0=function(){return n.asm.Wo.apply(null,arguments)},Am=n._emscripten_bind_btPoint2PointConstraint_setBreakingImpulseThreshold_1=function(){return n.asm.Xo.apply(null,arguments)},Lm=n._emscripten_bind_btPoint2PointConstraint_setParam_3=function(){return n.asm.Yo.apply(null,arguments)},Im=n._emscripten_bind_btPoint2PointConstraint_setPivotA_1=function(){return n.asm.Zo.apply(null,arguments)},Pm=n._emscripten_bind_btPoint2PointConstraint_setPivotB_1=function(){return n.asm._o.apply(null,arguments)},Om=n._emscripten_bind_btPoint2PointConstraint_set_m_setting_1=function(){return n.asm.$o.apply(null,arguments)},km=n._emscripten_bind_btQuadWord___destroy___0=function(){return n.asm.ap.apply(null,arguments)},Bm=n._emscripten_bind_btQuadWord_setW_1=function(){return n.asm.bp.apply(null,arguments)},Dm=n._emscripten_bind_btQuadWord_setX_1=function(){return n.asm.cp.apply(null,arguments)},Hm=n._emscripten_bind_btQuadWord_setY_1=function(){return n.asm.dp.apply(null,arguments)},Fm=n._emscripten_bind_btQuadWord_setZ_1=function(){return n.asm.ep.apply(null,arguments)},Nm=n._emscripten_bind_btQuadWord_w_0=function(){return n.asm.fp.apply(null,arguments)},Um=n._emscripten_bind_btQuadWord_x_0=function(){return n.asm.gp.apply(null,arguments)},Vm=n._emscripten_bind_btQuadWord_y_0=function(){return n.asm.hp.apply(null,arguments)},Gm=n._emscripten_bind_btQuadWord_z_0=function(){return n.asm.ip.apply(null,arguments)},Wm=n._emscripten_bind_btQuaternion___destroy___0=function(){return n.asm.jp.apply(null,arguments)},qm=n._emscripten_bind_btQuaternion_angleShortestPath_1=function(){return n.asm.kp.apply(null,arguments)},Xm=n._emscripten_bind_btQuaternion_angle_1=function(){return n.asm.lp.apply(null,arguments)},Ym=n._emscripten_bind_btQuaternion_btQuaternion_4=function(){return n.asm.mp.apply(null,arguments)},Qm=n._emscripten_bind_btQuaternion_dot_1=function(){return n.asm.np.apply(null,arguments)},Zm=n._emscripten_bind_btQuaternion_getAngleShortestPath_0=function(){return n.asm.op.apply(null,arguments)},Jm=n._emscripten_bind_btQuaternion_getAngle_0=function(){return n.asm.pp.apply(null,arguments)},Km=n._emscripten_bind_btQuaternion_getAxis_0=function(){return n.asm.qp.apply(null,arguments)},$m=n._emscripten_bind_btQuaternion_inverse_0=function(){return n.asm.rp.apply(null,arguments)},ty=n._emscripten_bind_btQuaternion_length2_0=function(){return n.asm.sp.apply(null,arguments)},ey=n._emscripten_bind_btQuaternion_length_0=function(){return n.asm.tp.apply(null,arguments)},ny=n._emscripten_bind_btQuaternion_normalize_0=function(){return n.asm.up.apply(null,arguments)},ry=n._emscripten_bind_btQuaternion_normalized_0=function(){return n.asm.vp.apply(null,arguments)},iy=n._emscripten_bind_btQuaternion_op_add_1=function(){return n.asm.wp.apply(null,arguments)},oy=n._emscripten_bind_btQuaternion_op_div_1=function(){return n.asm.xp.apply(null,arguments)},ay=n._emscripten_bind_btQuaternion_op_mul_1=function(){return n.asm.yp.apply(null,arguments)},sy=n._emscripten_bind_btQuaternion_op_mulq_1=function(){return n.asm.zp.apply(null,arguments)},ly=n._emscripten_bind_btQuaternion_op_sub_1=function(){return n.asm.Ap.apply(null,arguments)},cy=n._emscripten_bind_btQuaternion_setEulerZYX_3=function(){return n.asm.Bp.apply(null,arguments)},uy=n._emscripten_bind_btQuaternion_setRotation_2=function(){return n.asm.Cp.apply(null,arguments)},py=n._emscripten_bind_btQuaternion_setValue_4=function(){return n.asm.Dp.apply(null,arguments)},dy=n._emscripten_bind_btQuaternion_setW_1=function(){return n.asm.Ep.apply(null,arguments)},hy=n._emscripten_bind_btQuaternion_setX_1=function(){return n.asm.Fp.apply(null,arguments)},fy=n._emscripten_bind_btQuaternion_setY_1=function(){return n.asm.Gp.apply(null,arguments)},my=n._emscripten_bind_btQuaternion_setZ_1=function(){return n.asm.Hp.apply(null,arguments)},yy=n._emscripten_bind_btQuaternion_w_0=function(){return n.asm.Ip.apply(null,arguments)},_y=n._emscripten_bind_btQuaternion_x_0=function(){return n.asm.Jp.apply(null,arguments)},gy=n._emscripten_bind_btQuaternion_y_0=function(){return n.asm.Kp.apply(null,arguments)},vy=n._emscripten_bind_btQuaternion_z_0=function(){return n.asm.Lp.apply(null,arguments)},by=n._emscripten_bind_btRaycastVehicle___destroy___0=function(){return n.asm.Mp.apply(null,arguments)},xy=n._emscripten_bind_btRaycastVehicle_addWheel_7=function(){return n.asm.Np.apply(null,arguments)},wy=n._emscripten_bind_btRaycastVehicle_applyEngineForce_2=function(){return n.asm.Op.apply(null,arguments)},Ey=n._emscripten_bind_btRaycastVehicle_btRaycastVehicle_3=function(){return n.asm.Pp.apply(null,arguments)},Ty=n._emscripten_bind_btRaycastVehicle_getChassisWorldTransform_0=function(){return n.asm.Qp.apply(null,arguments)},Sy=n._emscripten_bind_btRaycastVehicle_getCurrentSpeedKmHour_0=function(){return n.asm.Rp.apply(null,arguments)},My=n._emscripten_bind_btRaycastVehicle_getForwardAxis_0=function(){return n.asm.Sp.apply(null,arguments)},jy=n._emscripten_bind_btRaycastVehicle_getForwardVector_0=function(){return n.asm.Tp.apply(null,arguments)},Cy=n._emscripten_bind_btRaycastVehicle_getNumWheels_0=function(){return n.asm.Up.apply(null,arguments)},zy=n._emscripten_bind_btRaycastVehicle_getRightAxis_0=function(){return n.asm.Vp.apply(null,arguments)},Ry=n._emscripten_bind_btRaycastVehicle_getRigidBody_0=function(){return n.asm.Wp.apply(null,arguments)},Ay=n._emscripten_bind_btRaycastVehicle_getSteeringValue_1=function(){return n.asm.Xp.apply(null,arguments)},Ly=n._emscripten_bind_btRaycastVehicle_getUpAxis_0=function(){return n.asm.Yp.apply(null,arguments)},Iy=n._emscripten_bind_btRaycastVehicle_getUserConstraintId_0=function(){return n.asm.Zp.apply(null,arguments)},Py=n._emscripten_bind_btRaycastVehicle_getUserConstraintType_0=function(){return n.asm._p.apply(null,arguments)},Oy=n._emscripten_bind_btRaycastVehicle_getWheelInfo_1=function(){return n.asm.$p.apply(null,arguments)},ky=n._emscripten_bind_btRaycastVehicle_getWheelTransformWS_1=function(){return n.asm.aq.apply(null,arguments)},By=n._emscripten_bind_btRaycastVehicle_rayCast_1=function(){return n.asm.bq.apply(null,arguments)},Dy=n._emscripten_bind_btRaycastVehicle_resetSuspension_0=function(){return n.asm.cq.apply(null,arguments)},Hy=n._emscripten_bind_btRaycastVehicle_setBrake_2=function(){return n.asm.dq.apply(null,arguments)},Fy=n._emscripten_bind_btRaycastVehicle_setCoordinateSystem_3=function(){return n.asm.eq.apply(null,arguments)},Ny=n._emscripten_bind_btRaycastVehicle_setPitchControl_1=function(){return n.asm.fq.apply(null,arguments)},Uy=n._emscripten_bind_btRaycastVehicle_setSteeringValue_2=function(){return n.asm.gq.apply(null,arguments)},Vy=n._emscripten_bind_btRaycastVehicle_setUserConstraintId_1=function(){return n.asm.hq.apply(null,arguments)},Gy=n._emscripten_bind_btRaycastVehicle_setUserConstraintType_1=function(){return n.asm.iq.apply(null,arguments)},Wy=n._emscripten_bind_btRaycastVehicle_updateAction_2=function(){return n.asm.jq.apply(null,arguments)},qy=n._emscripten_bind_btRaycastVehicle_updateFriction_1=function(){return n.asm.kq.apply(null,arguments)},Xy=n._emscripten_bind_btRaycastVehicle_updateSuspension_1=function(){return n.asm.lq.apply(null,arguments)},Yy=n._emscripten_bind_btRaycastVehicle_updateVehicle_1=function(){return n.asm.mq.apply(null,arguments)},Qy=n._emscripten_bind_btRaycastVehicle_updateWheelTransform_2=function(){return n.asm.nq.apply(null,arguments)},Zy=n._emscripten_bind_btRaycastVehicle_updateWheelTransformsWS_1=function(){return n.asm.oq.apply(null,arguments)},Jy=n._emscripten_bind_btRaycastVehicle_updateWheelTransformsWS_2=function(){return n.asm.pq.apply(null,arguments)},Ky=n._emscripten_bind_btRigidBodyConstructionInfo___destroy___0=function(){return n.asm.qq.apply(null,arguments)},$y=n._emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_3=function(){return n.asm.rq.apply(null,arguments)},t_=n._emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_4=function(){return n.asm.sq.apply(null,arguments)},e_=n._emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingFactor_0=function(){return n.asm.tq.apply(null,arguments)},n_=n._emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingThresholdSqr_0=function(){return n.asm.uq.apply(null,arguments)},r_=n._emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDampingFactor_0=function(){return n.asm.vq.apply(null,arguments)},i_=n._emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDamping_0=function(){return n.asm.wq.apply(null,arguments)},o_=n._emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalLinearDampingThresholdSqr_0=function(){return n.asm.xq.apply(null,arguments)},a_=n._emscripten_bind_btRigidBodyConstructionInfo_get_m_angularDamping_0=function(){return n.asm.yq.apply(null,arguments)},s_=n._emscripten_bind_btRigidBodyConstructionInfo_get_m_angularSleepingThreshold_0=function(){return n.asm.zq.apply(null,arguments)},l_=n._emscripten_bind_btRigidBodyConstructionInfo_get_m_friction_0=function(){return n.asm.Aq.apply(null,arguments)},c_=n._emscripten_bind_btRigidBodyConstructionInfo_get_m_linearDamping_0=function(){return n.asm.Bq.apply(null,arguments)},u_=n._emscripten_bind_btRigidBodyConstructionInfo_get_m_linearSleepingThreshold_0=function(){return n.asm.Cq.apply(null,arguments)},p_=n._emscripten_bind_btRigidBodyConstructionInfo_get_m_restitution_0=function(){return n.asm.Dq.apply(null,arguments)},d_=n._emscripten_bind_btRigidBodyConstructionInfo_get_m_rollingFriction_0=function(){return n.asm.Eq.apply(null,arguments)},h_=n._emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingFactor_1=function(){return n.asm.Fq.apply(null,arguments)},f_=n._emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingThresholdSqr_1=function(){return n.asm.Gq.apply(null,arguments)},m_=n._emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDampingFactor_1=function(){return n.asm.Hq.apply(null,arguments)},y_=n._emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDamping_1=function(){return n.asm.Iq.apply(null,arguments)},__=n._emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalLinearDampingThresholdSqr_1=function(){return n.asm.Jq.apply(null,arguments)},g_=n._emscripten_bind_btRigidBodyConstructionInfo_set_m_angularDamping_1=function(){return n.asm.Kq.apply(null,arguments)},v_=n._emscripten_bind_btRigidBodyConstructionInfo_set_m_angularSleepingThreshold_1=function(){return n.asm.Lq.apply(null,arguments)},b_=n._emscripten_bind_btRigidBodyConstructionInfo_set_m_friction_1=function(){return n.asm.Mq.apply(null,arguments)},x_=n._emscripten_bind_btRigidBodyConstructionInfo_set_m_linearDamping_1=function(){return n.asm.Nq.apply(null,arguments)},w_=n._emscripten_bind_btRigidBodyConstructionInfo_set_m_linearSleepingThreshold_1=function(){return n.asm.Oq.apply(null,arguments)},E_=n._emscripten_bind_btRigidBodyConstructionInfo_set_m_restitution_1=function(){return n.asm.Pq.apply(null,arguments)},T_=n._emscripten_bind_btRigidBodyConstructionInfo_set_m_rollingFriction_1=function(){return n.asm.Qq.apply(null,arguments)},S_=n._emscripten_bind_btRigidBody___destroy___0=function(){return n.asm.Rq.apply(null,arguments)},M_=n._emscripten_bind_btRigidBody_activate_0=function(){return n.asm.Sq.apply(null,arguments)},j_=n._emscripten_bind_btRigidBody_activate_1=function(){return n.asm.Tq.apply(null,arguments)},C_=n._emscripten_bind_btRigidBody_applyCentralForce_1=function(){return n.asm.Uq.apply(null,arguments)},z_=n._emscripten_bind_btRigidBody_applyCentralImpulse_1=function(){return n.asm.Vq.apply(null,arguments)},R_=n._emscripten_bind_btRigidBody_applyCentralLocalForce_1=function(){return n.asm.Wq.apply(null,arguments)},A_=n._emscripten_bind_btRigidBody_applyForce_2=function(){return n.asm.Xq.apply(null,arguments)},L_=n._emscripten_bind_btRigidBody_applyGravity_0=function(){return n.asm.Yq.apply(null,arguments)},I_=n._emscripten_bind_btRigidBody_applyImpulse_2=function(){return n.asm.Zq.apply(null,arguments)},P_=n._emscripten_bind_btRigidBody_applyLocalTorque_1=function(){return n.asm._q.apply(null,arguments)},O_=n._emscripten_bind_btRigidBody_applyTorqueImpulse_1=function(){return n.asm.$q.apply(null,arguments)},k_=n._emscripten_bind_btRigidBody_applyTorque_1=function(){return n.asm.ar.apply(null,arguments)},B_=n._emscripten_bind_btRigidBody_btRigidBody_1=function(){return n.asm.br.apply(null,arguments)},D_=n._emscripten_bind_btRigidBody_clearForces_0=function(){return n.asm.cr.apply(null,arguments)},H_=n._emscripten_bind_btRigidBody_forceActivationState_1=function(){return n.asm.dr.apply(null,arguments)},F_=n._emscripten_bind_btRigidBody_getAabb_2=function(){return n.asm.er.apply(null,arguments)},N_=n._emscripten_bind_btRigidBody_getAngularDamping_0=function(){return n.asm.fr.apply(null,arguments)},U_=n._emscripten_bind_btRigidBody_getAngularFactor_0=function(){return n.asm.gr.apply(null,arguments)},V_=n._emscripten_bind_btRigidBody_getAngularVelocity_0=function(){return n.asm.hr.apply(null,arguments)},G_=n._emscripten_bind_btRigidBody_getBroadphaseHandle_0=function(){return n.asm.ir.apply(null,arguments)},W_=n._emscripten_bind_btRigidBody_getBroadphaseProxy_0=function(){return n.asm.jr.apply(null,arguments)},q_=n._emscripten_bind_btRigidBody_getCenterOfMassTransform_0=function(){return n.asm.kr.apply(null,arguments)},X_=n._emscripten_bind_btRigidBody_getCollisionFlags_0=function(){return n.asm.lr.apply(null,arguments)},Y_=n._emscripten_bind_btRigidBody_getCollisionShape_0=function(){return n.asm.mr.apply(null,arguments)},Q_=n._emscripten_bind_btRigidBody_getFriction_0=function(){return n.asm.nr.apply(null,arguments)},Z_=n._emscripten_bind_btRigidBody_getGravity_0=function(){return n.asm.or.apply(null,arguments)},J_=n._emscripten_bind_btRigidBody_getLinearDamping_0=function(){return n.asm.pr.apply(null,arguments)},K_=n._emscripten_bind_btRigidBody_getLinearFactor_0=function(){return n.asm.qr.apply(null,arguments)},$_=n._emscripten_bind_btRigidBody_getLinearVelocity_0=function(){return n.asm.rr.apply(null,arguments)},tg=n._emscripten_bind_btRigidBody_getMotionState_0=function(){return n.asm.sr.apply(null,arguments)},eg=n._emscripten_bind_btRigidBody_getRestitution_0=function(){return n.asm.tr.apply(null,arguments)},ng=n._emscripten_bind_btRigidBody_getRollingFriction_0=function(){return n.asm.ur.apply(null,arguments)},rg=n._emscripten_bind_btRigidBody_getUserIndex_0=function(){return n.asm.vr.apply(null,arguments)},ig=n._emscripten_bind_btRigidBody_getUserPointer_0=function(){return n.asm.wr.apply(null,arguments)},og=n._emscripten_bind_btRigidBody_getWorldTransform_0=function(){return n.asm.xr.apply(null,arguments)},ag=n._emscripten_bind_btRigidBody_isActive_0=function(){return n.asm.yr.apply(null,arguments)},sg=n._emscripten_bind_btRigidBody_isKinematicObject_0=function(){return n.asm.zr.apply(null,arguments)},lg=n._emscripten_bind_btRigidBody_isStaticObject_0=function(){return n.asm.Ar.apply(null,arguments)},cg=n._emscripten_bind_btRigidBody_isStaticOrKinematicObject_0=function(){return n.asm.Br.apply(null,arguments)},ug=n._emscripten_bind_btRigidBody_setActivationState_1=function(){return n.asm.Cr.apply(null,arguments)},pg=n._emscripten_bind_btRigidBody_setAngularFactor_1=function(){return n.asm.Dr.apply(null,arguments)},dg=n._emscripten_bind_btRigidBody_setAngularVelocity_1=function(){return n.asm.Er.apply(null,arguments)},hg=n._emscripten_bind_btRigidBody_setAnisotropicFriction_2=function(){return n.asm.Fr.apply(null,arguments)},fg=n._emscripten_bind_btRigidBody_setCcdMotionThreshold_1=function(){return n.asm.Gr.apply(null,arguments)},mg=n._emscripten_bind_btRigidBody_setCcdSweptSphereRadius_1=function(){return n.asm.Hr.apply(null,arguments)},yg=n._emscripten_bind_btRigidBody_setCenterOfMassTransform_1=function(){return n.asm.Ir.apply(null,arguments)},_g=n._emscripten_bind_btRigidBody_setCollisionFlags_1=function(){return n.asm.Jr.apply(null,arguments)},gg=n._emscripten_bind_btRigidBody_setCollisionShape_1=function(){return n.asm.Kr.apply(null,arguments)},vg=n._emscripten_bind_btRigidBody_setContactProcessingThreshold_1=function(){return n.asm.Lr.apply(null,arguments)},bg=n._emscripten_bind_btRigidBody_setDamping_2=function(){return n.asm.Mr.apply(null,arguments)},xg=n._emscripten_bind_btRigidBody_setFriction_1=function(){return n.asm.Nr.apply(null,arguments)},wg=n._emscripten_bind_btRigidBody_setGravity_1=function(){return n.asm.Or.apply(null,arguments)},Eg=n._emscripten_bind_btRigidBody_setIgnoreCollisionCheck_2=function(){return n.asm.Pr.apply(null,arguments)},Tg=n._emscripten_bind_btRigidBody_setLinearFactor_1=function(){return n.asm.Qr.apply(null,arguments)},Sg=n._emscripten_bind_btRigidBody_setLinearVelocity_1=function(){return n.asm.Rr.apply(null,arguments)},Mg=n._emscripten_bind_btRigidBody_setMassProps_2=function(){return n.asm.Sr.apply(null,arguments)},jg=n._emscripten_bind_btRigidBody_setMotionState_1=function(){return n.asm.Tr.apply(null,arguments)},Cg=n._emscripten_bind_btRigidBody_setRestitution_1=function(){return n.asm.Ur.apply(null,arguments)},zg=n._emscripten_bind_btRigidBody_setRollingFriction_1=function(){return n.asm.Vr.apply(null,arguments)},Rg=n._emscripten_bind_btRigidBody_setSleepingThresholds_2=function(){return n.asm.Wr.apply(null,arguments)},Ag=n._emscripten_bind_btRigidBody_setUserIndex_1=function(){return n.asm.Xr.apply(null,arguments)},Lg=n._emscripten_bind_btRigidBody_setUserPointer_1=function(){return n.asm.Yr.apply(null,arguments)},Ig=n._emscripten_bind_btRigidBody_setWorldTransform_1=function(){return n.asm.Zr.apply(null,arguments)},Pg=n._emscripten_bind_btRigidBody_upcast_1=function(){return n.asm._r.apply(null,arguments)},Og=n._emscripten_bind_btRigidBody_updateInertiaTensor_0=function(){return n.asm.$r.apply(null,arguments)},kg=n._emscripten_bind_btScalarArray___destroy___0=function(){return n.asm.as.apply(null,arguments)},Bg=n._emscripten_bind_btScalarArray_at_1=function(){return n.asm.bs.apply(null,arguments)},Dg=n._emscripten_bind_btScalarArray_size_0=function(){return n.asm.cs.apply(null,arguments)},Hg=n._emscripten_bind_btSequentialImpulseConstraintSolver___destroy___0=function(){return n.asm.ds.apply(null,arguments)},Fg=n._emscripten_bind_btSequentialImpulseConstraintSolver_btSequentialImpulseConstraintSolver_0=function(){return n.asm.es.apply(null,arguments)},Ng=n._emscripten_bind_btShapeHull___destroy___0=function(){return n.asm.fs.apply(null,arguments)},Ug=n._emscripten_bind_btShapeHull_btShapeHull_1=function(){return n.asm.gs.apply(null,arguments)},Vg=n._emscripten_bind_btShapeHull_buildHull_1=function(){return n.asm.hs.apply(null,arguments)},Gg=n._emscripten_bind_btShapeHull_getVertexPointer_0=function(){return n.asm.is.apply(null,arguments)},Wg=n._emscripten_bind_btShapeHull_numVertices_0=function(){return n.asm.js.apply(null,arguments)},qg=n._emscripten_bind_btSliderConstraint___destroy___0=function(){return n.asm.ks.apply(null,arguments)},Xg=n._emscripten_bind_btSliderConstraint_btSliderConstraint_3=function(){return n.asm.ls.apply(null,arguments)},Yg=n._emscripten_bind_btSliderConstraint_btSliderConstraint_5=function(){return n.asm.ms.apply(null,arguments)},Qg=n._emscripten_bind_btSliderConstraint_enableFeedback_1=function(){return n.asm.ns.apply(null,arguments)},Zg=n._emscripten_bind_btSliderConstraint_getBreakingImpulseThreshold_0=function(){return n.asm.os.apply(null,arguments)},Jg=n._emscripten_bind_btSliderConstraint_getParam_2=function(){return n.asm.ps.apply(null,arguments)},Kg=n._emscripten_bind_btSliderConstraint_setBreakingImpulseThreshold_1=function(){return n.asm.qs.apply(null,arguments)},$g=n._emscripten_bind_btSliderConstraint_setLowerAngLimit_1=function(){return n.asm.rs.apply(null,arguments)},tv=n._emscripten_bind_btSliderConstraint_setLowerLinLimit_1=function(){return n.asm.ss.apply(null,arguments)},ev=n._emscripten_bind_btSliderConstraint_setParam_3=function(){return n.asm.ts.apply(null,arguments)},nv=n._emscripten_bind_btSliderConstraint_setUpperAngLimit_1=function(){return n.asm.us.apply(null,arguments)},rv=n._emscripten_bind_btSliderConstraint_setUpperLinLimit_1=function(){return n.asm.vs.apply(null,arguments)},iv=n._emscripten_bind_btSoftBodyArray___destroy___0=function(){return n.asm.ws.apply(null,arguments)},ov=n._emscripten_bind_btSoftBodyArray_at_1=function(){return n.asm.xs.apply(null,arguments)},av=n._emscripten_bind_btSoftBodyArray_size_0=function(){return n.asm.ys.apply(null,arguments)},sv=n._emscripten_bind_btSoftBodyHelpers_CreateEllipsoid_4=function(){return n.asm.zs.apply(null,arguments)},lv=n._emscripten_bind_btSoftBodyHelpers_CreateFromConvexHull_4=function(){return n.asm.As.apply(null,arguments)},cv=n._emscripten_bind_btSoftBodyHelpers_CreateFromTriMesh_5=function(){return n.asm.Bs.apply(null,arguments)},uv=n._emscripten_bind_btSoftBodyHelpers_CreatePatchUV_10=function(){return n.asm.Cs.apply(null,arguments)},pv=n._emscripten_bind_btSoftBodyHelpers_CreatePatch_9=function(){return n.asm.Ds.apply(null,arguments)},dv=n._emscripten_bind_btSoftBodyHelpers_CreateRope_5=function(){return n.asm.Es.apply(null,arguments)},hv=n._emscripten_bind_btSoftBodyHelpers___destroy___0=function(){return n.asm.Fs.apply(null,arguments)},fv=n._emscripten_bind_btSoftBodyHelpers_btSoftBodyHelpers_0=function(){return n.asm.Gs.apply(null,arguments)},mv=n._emscripten_bind_btSoftBodyRigidBodyCollisionConfiguration___destroy___0=function(){return n.asm.Hs.apply(null,arguments)},yv=n._emscripten_bind_btSoftBodyRigidBodyCollisionConfiguration_btSoftBodyRigidBodyCollisionConfiguration_0=function(){return n.asm.Is.apply(null,arguments)},_v=n._emscripten_bind_btSoftBodyRigidBodyCollisionConfiguration_btSoftBodyRigidBodyCollisionConfiguration_1=function(){return n.asm.Js.apply(null,arguments)},gv=n._emscripten_bind_btSoftBodySolver___destroy___0=function(){return n.asm.Ks.apply(null,arguments)},vv=n._emscripten_bind_btSoftBodyWorldInfo___destroy___0=function(){return n.asm.Ls.apply(null,arguments)},bv=n._emscripten_bind_btSoftBodyWorldInfo_btSoftBodyWorldInfo_0=function(){return n.asm.Ms.apply(null,arguments)},xv=n._emscripten_bind_btSoftBodyWorldInfo_get_air_density_0=function(){return n.asm.Ns.apply(null,arguments)},wv=n._emscripten_bind_btSoftBodyWorldInfo_get_m_broadphase_0=function(){return n.asm.Os.apply(null,arguments)},Ev=n._emscripten_bind_btSoftBodyWorldInfo_get_m_dispatcher_0=function(){return n.asm.Ps.apply(null,arguments)},Tv=n._emscripten_bind_btSoftBodyWorldInfo_get_m_gravity_0=function(){return n.asm.Qs.apply(null,arguments)},Sv=n._emscripten_bind_btSoftBodyWorldInfo_get_m_maxDisplacement_0=function(){return n.asm.Rs.apply(null,arguments)},Mv=n._emscripten_bind_btSoftBodyWorldInfo_get_water_density_0=function(){return n.asm.Ss.apply(null,arguments)},jv=n._emscripten_bind_btSoftBodyWorldInfo_get_water_normal_0=function(){return n.asm.Ts.apply(null,arguments)},Cv=n._emscripten_bind_btSoftBodyWorldInfo_get_water_offset_0=function(){return n.asm.Us.apply(null,arguments)},zv=n._emscripten_bind_btSoftBodyWorldInfo_set_air_density_1=function(){return n.asm.Vs.apply(null,arguments)},Rv=n._emscripten_bind_btSoftBodyWorldInfo_set_m_broadphase_1=function(){return n.asm.Ws.apply(null,arguments)},Av=n._emscripten_bind_btSoftBodyWorldInfo_set_m_dispatcher_1=function(){return n.asm.Xs.apply(null,arguments)},Lv=n._emscripten_bind_btSoftBodyWorldInfo_set_m_gravity_1=function(){return n.asm.Ys.apply(null,arguments)},Iv=n._emscripten_bind_btSoftBodyWorldInfo_set_m_maxDisplacement_1=function(){return n.asm.Zs.apply(null,arguments)},Pv=n._emscripten_bind_btSoftBodyWorldInfo_set_water_density_1=function(){return n.asm._s.apply(null,arguments)},Ov=n._emscripten_bind_btSoftBodyWorldInfo_set_water_normal_1=function(){return n.asm.$s.apply(null,arguments)},kv=n._emscripten_bind_btSoftBodyWorldInfo_set_water_offset_1=function(){return n.asm.at.apply(null,arguments)},Bv=n._emscripten_bind_btSoftBody___destroy___0=function(){return n.asm.bt.apply(null,arguments)},Dv=n._emscripten_bind_btSoftBody_activate_0=function(){return n.asm.ct.apply(null,arguments)},Hv=n._emscripten_bind_btSoftBody_activate_1=function(){return n.asm.dt.apply(null,arguments)},Fv=n._emscripten_bind_btSoftBody_addAeroForceToNode_2=function(){return n.asm.et.apply(null,arguments)},Nv=n._emscripten_bind_btSoftBody_addForce_1=function(){return n.asm.ft.apply(null,arguments)},Uv=n._emscripten_bind_btSoftBody_addForce_2=function(){return n.asm.gt.apply(null,arguments)},Vv=n._emscripten_bind_btSoftBody_appendAnchor_4=function(){return n.asm.ht.apply(null,arguments)},Gv=n._emscripten_bind_btSoftBody_appendFace_4=function(){return n.asm.it.apply(null,arguments)},Wv=n._emscripten_bind_btSoftBody_appendLink_4=function(){return n.asm.jt.apply(null,arguments)},qv=n._emscripten_bind_btSoftBody_appendMaterial_0=function(){return n.asm.kt.apply(null,arguments)},Xv=n._emscripten_bind_btSoftBody_appendNode_2=function(){return n.asm.lt.apply(null,arguments)},Yv=n._emscripten_bind_btSoftBody_appendTetra_5=function(){return n.asm.mt.apply(null,arguments)},Qv=n._emscripten_bind_btSoftBody_btSoftBody_4=function(){return n.asm.nt.apply(null,arguments)},Zv=n._emscripten_bind_btSoftBody_checkFace_3=function(){return n.asm.ot.apply(null,arguments)},Jv=n._emscripten_bind_btSoftBody_checkLink_2=function(){return n.asm.pt.apply(null,arguments)},Kv=n._emscripten_bind_btSoftBody_forceActivationState_1=function(){return n.asm.qt.apply(null,arguments)},$v=n._emscripten_bind_btSoftBody_generateBendingConstraints_2=function(){return n.asm.rt.apply(null,arguments)},tb=n._emscripten_bind_btSoftBody_generateClusters_1=function(){return n.asm.st.apply(null,arguments)},eb=n._emscripten_bind_btSoftBody_generateClusters_2=function(){return n.asm.tt.apply(null,arguments)},nb=n._emscripten_bind_btSoftBody_getBroadphaseHandle_0=function(){return n.asm.ut.apply(null,arguments)},rb=n._emscripten_bind_btSoftBody_getCollisionFlags_0=function(){return n.asm.vt.apply(null,arguments)},ib=n._emscripten_bind_btSoftBody_getCollisionShape_0=function(){return n.asm.wt.apply(null,arguments)},ob=n._emscripten_bind_btSoftBody_getFriction_0=function(){return n.asm.xt.apply(null,arguments)},ab=n._emscripten_bind_btSoftBody_getRestitution_0=function(){return n.asm.yt.apply(null,arguments)},sb=n._emscripten_bind_btSoftBody_getRollingFriction_0=function(){return n.asm.zt.apply(null,arguments)},lb=n._emscripten_bind_btSoftBody_getTotalMass_0=function(){return n.asm.At.apply(null,arguments)},cb=n._emscripten_bind_btSoftBody_getUserIndex_0=function(){return n.asm.Bt.apply(null,arguments)},ub=n._emscripten_bind_btSoftBody_getUserPointer_0=function(){return n.asm.Ct.apply(null,arguments)},pb=n._emscripten_bind_btSoftBody_getWorldTransform_0=function(){return n.asm.Dt.apply(null,arguments)},db=n._emscripten_bind_btSoftBody_get_m_anchors_0=function(){return n.asm.Et.apply(null,arguments)},hb=n._emscripten_bind_btSoftBody_get_m_cfg_0=function(){return n.asm.Ft.apply(null,arguments)},fb=n._emscripten_bind_btSoftBody_get_m_materials_0=function(){return n.asm.Gt.apply(null,arguments)},mb=n._emscripten_bind_btSoftBody_get_m_nodes_0=function(){return n.asm.Ht.apply(null,arguments)},yb=n._emscripten_bind_btSoftBody_isActive_0=function(){return n.asm.It.apply(null,arguments)},_b=n._emscripten_bind_btSoftBody_isKinematicObject_0=function(){return n.asm.Jt.apply(null,arguments)},gb=n._emscripten_bind_btSoftBody_isStaticObject_0=function(){return n.asm.Kt.apply(null,arguments)},vb=n._emscripten_bind_btSoftBody_isStaticOrKinematicObject_0=function(){return n.asm.Lt.apply(null,arguments)},bb=n._emscripten_bind_btSoftBody_rotate_1=function(){return n.asm.Mt.apply(null,arguments)},xb=n._emscripten_bind_btSoftBody_scale_1=function(){return n.asm.Nt.apply(null,arguments)},wb=n._emscripten_bind_btSoftBody_setActivationState_1=function(){return n.asm.Ot.apply(null,arguments)},Eb=n._emscripten_bind_btSoftBody_setAnisotropicFriction_2=function(){return n.asm.Pt.apply(null,arguments)},Tb=n._emscripten_bind_btSoftBody_setCcdMotionThreshold_1=function(){return n.asm.Qt.apply(null,arguments)},Sb=n._emscripten_bind_btSoftBody_setCcdSweptSphereRadius_1=function(){return n.asm.Rt.apply(null,arguments)},Mb=n._emscripten_bind_btSoftBody_setCollisionFlags_1=function(){return n.asm.St.apply(null,arguments)},jb=n._emscripten_bind_btSoftBody_setCollisionShape_1=function(){return n.asm.Tt.apply(null,arguments)},Cb=n._emscripten_bind_btSoftBody_setContactProcessingThreshold_1=function(){return n.asm.Ut.apply(null,arguments)},zb=n._emscripten_bind_btSoftBody_setFriction_1=function(){return n.asm.Vt.apply(null,arguments)},Rb=n._emscripten_bind_btSoftBody_setIgnoreCollisionCheck_2=function(){return n.asm.Wt.apply(null,arguments)},Ab=n._emscripten_bind_btSoftBody_setMass_2=function(){return n.asm.Xt.apply(null,arguments)},Lb=n._emscripten_bind_btSoftBody_setRestitution_1=function(){return n.asm.Yt.apply(null,arguments)},Ib=n._emscripten_bind_btSoftBody_setRollingFriction_1=function(){return n.asm.Zt.apply(null,arguments)},Pb=n._emscripten_bind_btSoftBody_setTotalMass_2=function(){return n.asm._t.apply(null,arguments)},Ob=n._emscripten_bind_btSoftBody_setUserIndex_1=function(){return n.asm.$t.apply(null,arguments)},kb=n._emscripten_bind_btSoftBody_setUserPointer_1=function(){return n.asm.au.apply(null,arguments)},Bb=n._emscripten_bind_btSoftBody_setWorldTransform_1=function(){return n.asm.bu.apply(null,arguments)},Db=n._emscripten_bind_btSoftBody_set_m_anchors_1=function(){return n.asm.cu.apply(null,arguments)},Hb=n._emscripten_bind_btSoftBody_set_m_cfg_1=function(){return n.asm.du.apply(null,arguments)},Fb=n._emscripten_bind_btSoftBody_set_m_materials_1=function(){return n.asm.eu.apply(null,arguments)},Nb=n._emscripten_bind_btSoftBody_set_m_nodes_1=function(){return n.asm.fu.apply(null,arguments)},Ub=n._emscripten_bind_btSoftBody_transform_1=function(){return n.asm.gu.apply(null,arguments)},Vb=n._emscripten_bind_btSoftBody_translate_1=function(){return n.asm.hu.apply(null,arguments)},Gb=n._emscripten_bind_btSoftBody_upcast_1=function(){return n.asm.iu.apply(null,arguments)},Wb=n._emscripten_bind_btSoftRigidDynamicsWorld___destroy___0=function(){return n.asm.ju.apply(null,arguments)},qb=n._emscripten_bind_btSoftRigidDynamicsWorld_activateContactAddedCallbackAdjustInternalEdgeContacts_0=function(){return n.asm.ku.apply(null,arguments)},Xb=n._emscripten_bind_btSoftRigidDynamicsWorld_addAction_1=function(){return n.asm.lu.apply(null,arguments)},Yb=n._emscripten_bind_btSoftRigidDynamicsWorld_addCollisionObject_1=function(){return n.asm.mu.apply(null,arguments)},Qb=n._emscripten_bind_btSoftRigidDynamicsWorld_addCollisionObject_2=function(){return n.asm.nu.apply(null,arguments)},Zb=n._emscripten_bind_btSoftRigidDynamicsWorld_addCollisionObject_3=function(){return n.asm.ou.apply(null,arguments)},Jb=n._emscripten_bind_btSoftRigidDynamicsWorld_addConstraint_1=function(){return n.asm.pu.apply(null,arguments)},Kb=n._emscripten_bind_btSoftRigidDynamicsWorld_addConstraint_2=function(){return n.asm.qu.apply(null,arguments)},$b=n._emscripten_bind_btSoftRigidDynamicsWorld_addRigidBody_1=function(){return n.asm.ru.apply(null,arguments)},tx=n._emscripten_bind_btSoftRigidDynamicsWorld_addRigidBody_3=function(){return n.asm.su.apply(null,arguments)},ex=n._emscripten_bind_btSoftRigidDynamicsWorld_addSoftBody_3=function(){return n.asm.tu.apply(null,arguments)},nx=n._emscripten_bind_btSoftRigidDynamicsWorld_btSoftRigidDynamicsWorld_5=function(){return n.asm.uu.apply(null,arguments)},rx=n._emscripten_bind_btSoftRigidDynamicsWorld_contactPairTest_3=function(){return n.asm.vu.apply(null,arguments)},ix=n._emscripten_bind_btSoftRigidDynamicsWorld_contactTest_2=function(){return n.asm.wu.apply(null,arguments)},ox=n._emscripten_bind_btSoftRigidDynamicsWorld_convexSweepTest_5=function(){return n.asm.xu.apply(null,arguments)},ax=n._emscripten_bind_btSoftRigidDynamicsWorld_debugDrawObject_3=function(){return n.asm.yu.apply(null,arguments)},sx=n._emscripten_bind_btSoftRigidDynamicsWorld_debugDrawWorld_0=function(){return n.asm.zu.apply(null,arguments)},lx=n._emscripten_bind_btSoftRigidDynamicsWorld_getBroadphase_0=function(){return n.asm.Au.apply(null,arguments)},cx=n._emscripten_bind_btSoftRigidDynamicsWorld_getDebugDrawer_0=function(){return n.asm.Bu.apply(null,arguments)},ux=n._emscripten_bind_btSoftRigidDynamicsWorld_getDispatchInfo_0=function(){return n.asm.Cu.apply(null,arguments)},px=n._emscripten_bind_btSoftRigidDynamicsWorld_getDispatcher_0=function(){return n.asm.Du.apply(null,arguments)},dx=n._emscripten_bind_btSoftRigidDynamicsWorld_getForceUpdateAllAabbs_0=function(){return n.asm.Eu.apply(null,arguments)},hx=n._emscripten_bind_btSoftRigidDynamicsWorld_getGravity_0=function(){return n.asm.Fu.apply(null,arguments)},fx=n._emscripten_bind_btSoftRigidDynamicsWorld_getPairCache_0=function(){return n.asm.Gu.apply(null,arguments)},mx=n._emscripten_bind_btSoftRigidDynamicsWorld_getSoftBodyArray_0=function(){return n.asm.Hu.apply(null,arguments)},yx=n._emscripten_bind_btSoftRigidDynamicsWorld_getSolverInfo_0=function(){return n.asm.Iu.apply(null,arguments)},_x=n._emscripten_bind_btSoftRigidDynamicsWorld_getWorldInfo_0=function(){return n.asm.Ju.apply(null,arguments)},gx=n._emscripten_bind_btSoftRigidDynamicsWorld_rayTest_3=function(){return n.asm.Ku.apply(null,arguments)},vx=n._emscripten_bind_btSoftRigidDynamicsWorld_removeAction_1=function(){return n.asm.Lu.apply(null,arguments)},bx=n._emscripten_bind_btSoftRigidDynamicsWorld_removeCollisionObject_1=function(){return n.asm.Mu.apply(null,arguments)},xx=n._emscripten_bind_btSoftRigidDynamicsWorld_removeConstraint_1=function(){return n.asm.Nu.apply(null,arguments)},wx=n._emscripten_bind_btSoftRigidDynamicsWorld_removeRigidBody_1=function(){return n.asm.Ou.apply(null,arguments)},Ex=n._emscripten_bind_btSoftRigidDynamicsWorld_removeSoftBody_1=function(){return n.asm.Pu.apply(null,arguments)},Tx=n._emscripten_bind_btSoftRigidDynamicsWorld_setContactAddedCallback_1=function(){return n.asm.Qu.apply(null,arguments)},Sx=n._emscripten_bind_btSoftRigidDynamicsWorld_setContactDestroyedCallback_1=function(){return n.asm.Ru.apply(null,arguments)},Mx=n._emscripten_bind_btSoftRigidDynamicsWorld_setContactProcessedCallback_1=function(){return n.asm.Su.apply(null,arguments)},jx=n._emscripten_bind_btSoftRigidDynamicsWorld_setDebugDrawer_1=function(){return n.asm.Tu.apply(null,arguments)},Cx=n._emscripten_bind_btSoftRigidDynamicsWorld_setForceUpdateAllAabbs_1=function(){return n.asm.Uu.apply(null,arguments)},zx=n._emscripten_bind_btSoftRigidDynamicsWorld_setGravity_1=function(){return n.asm.Vu.apply(null,arguments)},Rx=n._emscripten_bind_btSoftRigidDynamicsWorld_stepSimulation_1=function(){return n.asm.Wu.apply(null,arguments)},Ax=n._emscripten_bind_btSoftRigidDynamicsWorld_stepSimulation_2=function(){return n.asm.Xu.apply(null,arguments)},Lx=n._emscripten_bind_btSoftRigidDynamicsWorld_stepSimulation_3=function(){return n.asm.Yu.apply(null,arguments)},Ix=n._emscripten_bind_btSoftRigidDynamicsWorld_updateSingleAabb_1=function(){return n.asm.Zu.apply(null,arguments)},Px=n._emscripten_bind_btSphereShape___destroy___0=function(){return n.asm._u.apply(null,arguments)},Ox=n._emscripten_bind_btSphereShape_btSphereShape_1=function(){return n.asm.$u.apply(null,arguments)},kx=n._emscripten_bind_btSphereShape_calculateLocalInertia_2=function(){return n.asm.av.apply(null,arguments)},Bx=n._emscripten_bind_btSphereShape_getLocalScaling_0=function(){return n.asm.bv.apply(null,arguments)},Dx=n._emscripten_bind_btSphereShape_getMargin_0=function(){return n.asm.cv.apply(null,arguments)},Hx=n._emscripten_bind_btSphereShape_setLocalScaling_1=function(){return n.asm.dv.apply(null,arguments)},Fx=n._emscripten_bind_btSphereShape_setMargin_1=function(){return n.asm.ev.apply(null,arguments)},Nx=n._emscripten_bind_btStaticPlaneShape___destroy___0=function(){return n.asm.fv.apply(null,arguments)},Ux=n._emscripten_bind_btStaticPlaneShape_btStaticPlaneShape_2=function(){return n.asm.gv.apply(null,arguments)},Vx=n._emscripten_bind_btStaticPlaneShape_calculateLocalInertia_2=function(){return n.asm.hv.apply(null,arguments)},Gx=n._emscripten_bind_btStaticPlaneShape_getLocalScaling_0=function(){return n.asm.iv.apply(null,arguments)},Wx=n._emscripten_bind_btStaticPlaneShape_setLocalScaling_1=function(){return n.asm.jv.apply(null,arguments)},qx=n._emscripten_bind_btStridingMeshInterface___destroy___0=function(){return n.asm.kv.apply(null,arguments)},Xx=n._emscripten_bind_btStridingMeshInterface_setScaling_1=function(){return n.asm.lv.apply(null,arguments)},Yx=n._emscripten_bind_btTransform___destroy___0=function(){return n.asm.mv.apply(null,arguments)},Qx=n._emscripten_bind_btTransform_btTransform_0=function(){return n.asm.nv.apply(null,arguments)},Zx=n._emscripten_bind_btTransform_btTransform_2=function(){return n.asm.ov.apply(null,arguments)},Jx=n._emscripten_bind_btTransform_getBasis_0=function(){return n.asm.pv.apply(null,arguments)},Kx=n._emscripten_bind_btTransform_getOrigin_0=function(){return n.asm.qv.apply(null,arguments)},$x=n._emscripten_bind_btTransform_getRotation_0=function(){return n.asm.rv.apply(null,arguments)},tw=n._emscripten_bind_btTransform_inverse_0=function(){return n.asm.sv.apply(null,arguments)},ew=n._emscripten_bind_btTransform_op_mul_1=function(){return n.asm.tv.apply(null,arguments)},nw=n._emscripten_bind_btTransform_setFromOpenGLMatrix_1=function(){return n.asm.uv.apply(null,arguments)},rw=n._emscripten_bind_btTransform_setIdentity_0=function(){return n.asm.vv.apply(null,arguments)},iw=n._emscripten_bind_btTransform_setOrigin_1=function(){return n.asm.wv.apply(null,arguments)},ow=n._emscripten_bind_btTransform_setRotation_1=function(){return n.asm.xv.apply(null,arguments)},aw=n._emscripten_bind_btTriangleIndexVertexArray___destroy___0=function(){return n.asm.yv.apply(null,arguments)},sw=n._emscripten_bind_btTriangleIndexVertexArray_btTriangleIndexVertexArray_6=function(){return n.asm.zv.apply(null,arguments)},lw=n._emscripten_bind_btTriangleIndexVertexArray_setScaling_1=function(){return n.asm.Av.apply(null,arguments)},cw=n._emscripten_bind_btTriangleInfoMap___destroy___0=function(){return n.asm.Bv.apply(null,arguments)},uw=n._emscripten_bind_btTriangleInfoMap_btTriangleInfoMap_0=function(){return n.asm.Cv.apply(null,arguments)},pw=n._emscripten_bind_btTriangleInfoMap_generateInternalEdgeInfo_1=function(){return n.asm.Dv.apply(null,arguments)},dw=n._emscripten_bind_btTriangleInfoMap_get_m_convexEpsilon_0=function(){return n.asm.Ev.apply(null,arguments)},hw=n._emscripten_bind_btTriangleInfoMap_get_m_edgeDistanceThreshold_0=function(){return n.asm.Fv.apply(null,arguments)},fw=n._emscripten_bind_btTriangleInfoMap_get_m_equalVertexThreshold_0=function(){return n.asm.Gv.apply(null,arguments)},mw=n._emscripten_bind_btTriangleInfoMap_get_m_maxEdgeAngleThreshold_0=function(){return n.asm.Hv.apply(null,arguments)},yw=n._emscripten_bind_btTriangleInfoMap_get_m_planarEpsilon_0=function(){return n.asm.Iv.apply(null,arguments)},_w=n._emscripten_bind_btTriangleInfoMap_get_m_zeroAreaThreshold_0=function(){return n.asm.Jv.apply(null,arguments)},gw=n._emscripten_bind_btTriangleInfoMap_set_m_convexEpsilon_1=function(){return n.asm.Kv.apply(null,arguments)},vw=n._emscripten_bind_btTriangleInfoMap_set_m_edgeDistanceThreshold_1=function(){return n.asm.Lv.apply(null,arguments)},bw=n._emscripten_bind_btTriangleInfoMap_set_m_equalVertexThreshold_1=function(){return n.asm.Mv.apply(null,arguments)},xw=n._emscripten_bind_btTriangleInfoMap_set_m_maxEdgeAngleThreshold_1=function(){return n.asm.Nv.apply(null,arguments)},ww=n._emscripten_bind_btTriangleInfoMap_set_m_planarEpsilon_1=function(){return n.asm.Ov.apply(null,arguments)},Ew=n._emscripten_bind_btTriangleInfoMap_set_m_zeroAreaThreshold_1=function(){return n.asm.Pv.apply(null,arguments)},Tw=n._emscripten_bind_btTriangleMeshShape___destroy___0=function(){return n.asm.Qv.apply(null,arguments)},Sw=n._emscripten_bind_btTriangleMeshShape_calculateLocalInertia_2=function(){return n.asm.Rv.apply(null,arguments)},Mw=n._emscripten_bind_btTriangleMeshShape_getLocalScaling_0=function(){return n.asm.Sv.apply(null,arguments)},jw=n._emscripten_bind_btTriangleMeshShape_setLocalScaling_1=function(){return n.asm.Tv.apply(null,arguments)},Cw=n._emscripten_bind_btTriangleMesh___destroy___0=function(){return n.asm.Uv.apply(null,arguments)},zw=n._emscripten_bind_btTriangleMesh_addIndex_1=function(){return n.asm.Vv.apply(null,arguments)},Rw=n._emscripten_bind_btTriangleMesh_addTriangle_3=function(){return n.asm.Wv.apply(null,arguments)},Aw=n._emscripten_bind_btTriangleMesh_addTriangle_4=function(){return n.asm.Xv.apply(null,arguments)},Lw=n._emscripten_bind_btTriangleMesh_btTriangleMesh_0=function(){return n.asm.Yv.apply(null,arguments)},Iw=n._emscripten_bind_btTriangleMesh_btTriangleMesh_1=function(){return n.asm.Zv.apply(null,arguments)},Pw=n._emscripten_bind_btTriangleMesh_btTriangleMesh_2=function(){return n.asm._v.apply(null,arguments)},Ow=n._emscripten_bind_btTriangleMesh_findOrAddVertex_2=function(){return n.asm.$v.apply(null,arguments)},kw=n._emscripten_bind_btTriangleMesh_getIndexedMeshArray_0=function(){return n.asm.aw.apply(null,arguments)},Bw=n._emscripten_bind_btTriangleMesh_setScaling_1=function(){return n.asm.bw.apply(null,arguments)},Dw=n._emscripten_bind_btTypedConstraint___destroy___0=function(){return n.asm.cw.apply(null,arguments)},Hw=n._emscripten_bind_btTypedConstraint_enableFeedback_1=function(){return n.asm.dw.apply(null,arguments)},Fw=n._emscripten_bind_btTypedConstraint_getBreakingImpulseThreshold_0=function(){return n.asm.ew.apply(null,arguments)},Nw=n._emscripten_bind_btTypedConstraint_getParam_2=function(){return n.asm.fw.apply(null,arguments)},Uw=n._emscripten_bind_btTypedConstraint_setBreakingImpulseThreshold_1=function(){return n.asm.gw.apply(null,arguments)},Vw=n._emscripten_bind_btTypedConstraint_setParam_3=function(){return n.asm.hw.apply(null,arguments)},Gw=n._emscripten_bind_btVector3Array___destroy___0=function(){return n.asm.iw.apply(null,arguments)},Ww=n._emscripten_bind_btVector3Array_at_1=function(){return n.asm.jw.apply(null,arguments)},qw=n._emscripten_bind_btVector3Array_size_0=function(){return n.asm.kw.apply(null,arguments)},Xw=n._emscripten_bind_btVector3___destroy___0=function(){return n.asm.lw.apply(null,arguments)},Yw=n._emscripten_bind_btVector3_btVector3_0=function(){return n.asm.mw.apply(null,arguments)},Qw=n._emscripten_bind_btVector3_btVector3_3=function(){return n.asm.nw.apply(null,arguments)},Zw=n._emscripten_bind_btVector3_dot_1=function(){return n.asm.ow.apply(null,arguments)},Jw=n._emscripten_bind_btVector3_length_0=function(){return n.asm.pw.apply(null,arguments)},Kw=n._emscripten_bind_btVector3_normalize_0=function(){return n.asm.qw.apply(null,arguments)},$w=n._emscripten_bind_btVector3_op_add_1=function(){return n.asm.rw.apply(null,arguments)},tE=n._emscripten_bind_btVector3_op_mul_1=function(){return n.asm.sw.apply(null,arguments)},eE=n._emscripten_bind_btVector3_op_sub_1=function(){return n.asm.tw.apply(null,arguments)},nE=n._emscripten_bind_btVector3_rotate_2=function(){return n.asm.uw.apply(null,arguments)},rE=n._emscripten_bind_btVector3_setValue_3=function(){return n.asm.vw.apply(null,arguments)},iE=n._emscripten_bind_btVector3_setX_1=function(){return n.asm.ww.apply(null,arguments)},oE=n._emscripten_bind_btVector3_setY_1=function(){return n.asm.xw.apply(null,arguments)},aE=n._emscripten_bind_btVector3_setZ_1=function(){return n.asm.yw.apply(null,arguments)},sE=n._emscripten_bind_btVector3_x_0=function(){return n.asm.zw.apply(null,arguments)},lE=n._emscripten_bind_btVector3_y_0=function(){return n.asm.Aw.apply(null,arguments)},cE=n._emscripten_bind_btVector3_z_0=function(){return n.asm.Bw.apply(null,arguments)},uE=n._emscripten_bind_btVector4___destroy___0=function(){return n.asm.Cw.apply(null,arguments)},pE=n._emscripten_bind_btVector4_btVector4_0=function(){return n.asm.Dw.apply(null,arguments)},dE=n._emscripten_bind_btVector4_btVector4_4=function(){return n.asm.Ew.apply(null,arguments)},hE=n._emscripten_bind_btVector4_dot_1=function(){return n.asm.Fw.apply(null,arguments)},fE=n._emscripten_bind_btVector4_length_0=function(){return n.asm.Gw.apply(null,arguments)},mE=n._emscripten_bind_btVector4_normalize_0=function(){return n.asm.Hw.apply(null,arguments)},yE=n._emscripten_bind_btVector4_op_add_1=function(){return n.asm.Iw.apply(null,arguments)},_E=n._emscripten_bind_btVector4_op_mul_1=function(){return n.asm.Jw.apply(null,arguments)},gE=n._emscripten_bind_btVector4_op_sub_1=function(){return n.asm.Kw.apply(null,arguments)},vE=n._emscripten_bind_btVector4_rotate_2=function(){return n.asm.Lw.apply(null,arguments)},bE=n._emscripten_bind_btVector4_setValue_4=function(){return n.asm.Mw.apply(null,arguments)},xE=n._emscripten_bind_btVector4_setX_1=function(){return n.asm.Nw.apply(null,arguments)},wE=n._emscripten_bind_btVector4_setY_1=function(){return n.asm.Ow.apply(null,arguments)},EE=n._emscripten_bind_btVector4_setZ_1=function(){return n.asm.Pw.apply(null,arguments)},TE=n._emscripten_bind_btVector4_w_0=function(){return n.asm.Qw.apply(null,arguments)},SE=n._emscripten_bind_btVector4_x_0=function(){return n.asm.Rw.apply(null,arguments)},ME=n._emscripten_bind_btVector4_y_0=function(){return n.asm.Sw.apply(null,arguments)},jE=n._emscripten_bind_btVector4_z_0=function(){return n.asm.Tw.apply(null,arguments)},CE=n._emscripten_bind_btVehicleRaycasterResult___destroy___0=function(){return n.asm.Uw.apply(null,arguments)},zE=n._emscripten_bind_btVehicleRaycasterResult_get_m_distFraction_0=function(){return n.asm.Vw.apply(null,arguments)},RE=n._emscripten_bind_btVehicleRaycasterResult_get_m_hitNormalInWorld_0=function(){return n.asm.Ww.apply(null,arguments)},AE=n._emscripten_bind_btVehicleRaycasterResult_get_m_hitPointInWorld_0=function(){return n.asm.Xw.apply(null,arguments)},LE=n._emscripten_bind_btVehicleRaycasterResult_set_m_distFraction_1=function(){return n.asm.Yw.apply(null,arguments)},IE=n._emscripten_bind_btVehicleRaycasterResult_set_m_hitNormalInWorld_1=function(){return n.asm.Zw.apply(null,arguments)},PE=n._emscripten_bind_btVehicleRaycasterResult_set_m_hitPointInWorld_1=function(){return n.asm._w.apply(null,arguments)},OE=n._emscripten_bind_btVehicleRaycaster___destroy___0=function(){return n.asm.$w.apply(null,arguments)},kE=n._emscripten_bind_btVehicleRaycaster_castRay_3=function(){return n.asm.ax.apply(null,arguments)},BE=n._emscripten_bind_btVehicleTuning_btVehicleTuning_0=function(){return n.asm.bx.apply(null,arguments)},DE=n._emscripten_bind_btVehicleTuning_get_m_frictionSlip_0=function(){return n.asm.cx.apply(null,arguments)},HE=n._emscripten_bind_btVehicleTuning_get_m_maxSuspensionForce_0=function(){return n.asm.dx.apply(null,arguments)},FE=n._emscripten_bind_btVehicleTuning_get_m_maxSuspensionTravelCm_0=function(){return n.asm.ex.apply(null,arguments)},NE=n._emscripten_bind_btVehicleTuning_get_m_suspensionCompression_0=function(){return n.asm.fx.apply(null,arguments)},UE=n._emscripten_bind_btVehicleTuning_get_m_suspensionDamping_0=function(){return n.asm.gx.apply(null,arguments)},VE=n._emscripten_bind_btVehicleTuning_get_m_suspensionStiffness_0=function(){return n.asm.hx.apply(null,arguments)},GE=n._emscripten_bind_btVehicleTuning_set_m_frictionSlip_1=function(){return n.asm.ix.apply(null,arguments)},WE=n._emscripten_bind_btVehicleTuning_set_m_maxSuspensionForce_1=function(){return n.asm.jx.apply(null,arguments)},qE=n._emscripten_bind_btVehicleTuning_set_m_maxSuspensionTravelCm_1=function(){return n.asm.kx.apply(null,arguments)},XE=n._emscripten_bind_btVehicleTuning_set_m_suspensionCompression_1=function(){return n.asm.lx.apply(null,arguments)},YE=n._emscripten_bind_btVehicleTuning_set_m_suspensionDamping_1=function(){return n.asm.mx.apply(null,arguments)},QE=n._emscripten_bind_btVehicleTuning_set_m_suspensionStiffness_1=function(){return n.asm.nx.apply(null,arguments)},ZE=n._emscripten_bind_btWheelInfoConstructionInfo___destroy___0=function(){return n.asm.ox.apply(null,arguments)},JE=n._emscripten_bind_btWheelInfoConstructionInfo_get_m_bIsFrontWheel_0=function(){return n.asm.px.apply(null,arguments)},KE=n._emscripten_bind_btWheelInfoConstructionInfo_get_m_chassisConnectionCS_0=function(){return n.asm.qx.apply(null,arguments)},$E=n._emscripten_bind_btWheelInfoConstructionInfo_get_m_frictionSlip_0=function(){return n.asm.rx.apply(null,arguments)},tT=n._emscripten_bind_btWheelInfoConstructionInfo_get_m_maxSuspensionForce_0=function(){return n.asm.sx.apply(null,arguments)},eT=n._emscripten_bind_btWheelInfoConstructionInfo_get_m_maxSuspensionTravelCm_0=function(){return n.asm.tx.apply(null,arguments)},nT=n._emscripten_bind_btWheelInfoConstructionInfo_get_m_suspensionRestLength_0=function(){return n.asm.ux.apply(null,arguments)},rT=n._emscripten_bind_btWheelInfoConstructionInfo_get_m_suspensionStiffness_0=function(){return n.asm.vx.apply(null,arguments)},iT=n._emscripten_bind_btWheelInfoConstructionInfo_get_m_wheelAxleCS_0=function(){return n.asm.wx.apply(null,arguments)},oT=n._emscripten_bind_btWheelInfoConstructionInfo_get_m_wheelDirectionCS_0=function(){return n.asm.xx.apply(null,arguments)},aT=n._emscripten_bind_btWheelInfoConstructionInfo_get_m_wheelRadius_0=function(){return n.asm.yx.apply(null,arguments)},sT=n._emscripten_bind_btWheelInfoConstructionInfo_get_m_wheelsDampingCompression_0=function(){return n.asm.zx.apply(null,arguments)},lT=n._emscripten_bind_btWheelInfoConstructionInfo_get_m_wheelsDampingRelaxation_0=function(){return n.asm.Ax.apply(null,arguments)},cT=n._emscripten_bind_btWheelInfoConstructionInfo_set_m_bIsFrontWheel_1=function(){return n.asm.Bx.apply(null,arguments)},uT=n._emscripten_bind_btWheelInfoConstructionInfo_set_m_chassisConnectionCS_1=function(){return n.asm.Cx.apply(null,arguments)},pT=n._emscripten_bind_btWheelInfoConstructionInfo_set_m_frictionSlip_1=function(){return n.asm.Dx.apply(null,arguments)},dT=n._emscripten_bind_btWheelInfoConstructionInfo_set_m_maxSuspensionForce_1=function(){return n.asm.Ex.apply(null,arguments)},hT=n._emscripten_bind_btWheelInfoConstructionInfo_set_m_maxSuspensionTravelCm_1=function(){return n.asm.Fx.apply(null,arguments)},fT=n._emscripten_bind_btWheelInfoConstructionInfo_set_m_suspensionRestLength_1=function(){return n.asm.Gx.apply(null,arguments)},mT=n._emscripten_bind_btWheelInfoConstructionInfo_set_m_suspensionStiffness_1=function(){return n.asm.Hx.apply(null,arguments)},yT=n._emscripten_bind_btWheelInfoConstructionInfo_set_m_wheelAxleCS_1=function(){return n.asm.Ix.apply(null,arguments)},_T=n._emscripten_bind_btWheelInfoConstructionInfo_set_m_wheelDirectionCS_1=function(){return n.asm.Jx.apply(null,arguments)},gT=n._emscripten_bind_btWheelInfoConstructionInfo_set_m_wheelRadius_1=function(){return n.asm.Kx.apply(null,arguments)},vT=n._emscripten_bind_btWheelInfoConstructionInfo_set_m_wheelsDampingCompression_1=function(){return n.asm.Lx.apply(null,arguments)},bT=n._emscripten_bind_btWheelInfoConstructionInfo_set_m_wheelsDampingRelaxation_1=function(){return n.asm.Mx.apply(null,arguments)},xT=n._emscripten_bind_btWheelInfo___destroy___0=function(){return n.asm.Nx.apply(null,arguments)},wT=n._emscripten_bind_btWheelInfo_btWheelInfo_1=function(){return n.asm.Ox.apply(null,arguments)},ET=n._emscripten_bind_btWheelInfo_getSuspensionRestLength_0=function(){return n.asm.Px.apply(null,arguments)},TT=n._emscripten_bind_btWheelInfo_get_m_bIsFrontWheel_0=function(){return n.asm.Qx.apply(null,arguments)},ST=n._emscripten_bind_btWheelInfo_get_m_brake_0=function(){return n.asm.Rx.apply(null,arguments)},MT=n._emscripten_bind_btWheelInfo_get_m_chassisConnectionPointCS_0=function(){return n.asm.Sx.apply(null,arguments)},jT=n._emscripten_bind_btWheelInfo_get_m_clippedInvContactDotSuspension_0=function(){return n.asm.Tx.apply(null,arguments)},CT=n._emscripten_bind_btWheelInfo_get_m_deltaRotation_0=function(){return n.asm.Ux.apply(null,arguments)},zT=n._emscripten_bind_btWheelInfo_get_m_engineForce_0=function(){return n.asm.Vx.apply(null,arguments)},RT=n._emscripten_bind_btWheelInfo_get_m_frictionSlip_0=function(){return n.asm.Wx.apply(null,arguments)},AT=n._emscripten_bind_btWheelInfo_get_m_maxSuspensionForce_0=function(){return n.asm.Xx.apply(null,arguments)},LT=n._emscripten_bind_btWheelInfo_get_m_maxSuspensionTravelCm_0=function(){return n.asm.Yx.apply(null,arguments)},IT=n._emscripten_bind_btWheelInfo_get_m_raycastInfo_0=function(){return n.asm.Zx.apply(null,arguments)},PT=n._emscripten_bind_btWheelInfo_get_m_rollInfluence_0=function(){return n.asm._x.apply(null,arguments)},OT=n._emscripten_bind_btWheelInfo_get_m_rotation_0=function(){return n.asm.$x.apply(null,arguments)},kT=n._emscripten_bind_btWheelInfo_get_m_skidInfo_0=function(){return n.asm.ay.apply(null,arguments)},BT=n._emscripten_bind_btWheelInfo_get_m_steering_0=function(){return n.asm.by.apply(null,arguments)},DT=n._emscripten_bind_btWheelInfo_get_m_suspensionRelativeVelocity_0=function(){return n.asm.cy.apply(null,arguments)},HT=n._emscripten_bind_btWheelInfo_get_m_suspensionRestLength1_0=function(){return n.asm.dy.apply(null,arguments)},FT=n._emscripten_bind_btWheelInfo_get_m_suspensionStiffness_0=function(){return n.asm.ey.apply(null,arguments)},NT=n._emscripten_bind_btWheelInfo_get_m_wheelAxleCS_0=function(){return n.asm.fy.apply(null,arguments)},UT=n._emscripten_bind_btWheelInfo_get_m_wheelDirectionCS_0=function(){return n.asm.gy.apply(null,arguments)},VT=n._emscripten_bind_btWheelInfo_get_m_wheelsDampingCompression_0=function(){return n.asm.hy.apply(null,arguments)},GT=n._emscripten_bind_btWheelInfo_get_m_wheelsDampingRelaxation_0=function(){return n.asm.iy.apply(null,arguments)},WT=n._emscripten_bind_btWheelInfo_get_m_wheelsRadius_0=function(){return n.asm.jy.apply(null,arguments)},qT=n._emscripten_bind_btWheelInfo_get_m_wheelsSuspensionForce_0=function(){return n.asm.ky.apply(null,arguments)},XT=n._emscripten_bind_btWheelInfo_get_m_worldTransform_0=function(){return n.asm.ly.apply(null,arguments)},YT=n._emscripten_bind_btWheelInfo_set_m_bIsFrontWheel_1=function(){return n.asm.my.apply(null,arguments)},QT=n._emscripten_bind_btWheelInfo_set_m_brake_1=function(){return n.asm.ny.apply(null,arguments)},ZT=n._emscripten_bind_btWheelInfo_set_m_chassisConnectionPointCS_1=function(){return n.asm.oy.apply(null,arguments)},JT=n._emscripten_bind_btWheelInfo_set_m_clippedInvContactDotSuspension_1=function(){return n.asm.py.apply(null,arguments)},KT=n._emscripten_bind_btWheelInfo_set_m_deltaRotation_1=function(){return n.asm.qy.apply(null,arguments)},$T=n._emscripten_bind_btWheelInfo_set_m_engineForce_1=function(){return n.asm.ry.apply(null,arguments)},tS=n._emscripten_bind_btWheelInfo_set_m_frictionSlip_1=function(){return n.asm.sy.apply(null,arguments)},eS=n._emscripten_bind_btWheelInfo_set_m_maxSuspensionForce_1=function(){return n.asm.ty.apply(null,arguments)},nS=n._emscripten_bind_btWheelInfo_set_m_maxSuspensionTravelCm_1=function(){return n.asm.uy.apply(null,arguments)},rS=n._emscripten_bind_btWheelInfo_set_m_raycastInfo_1=function(){return n.asm.vy.apply(null,arguments)},iS=n._emscripten_bind_btWheelInfo_set_m_rollInfluence_1=function(){return n.asm.wy.apply(null,arguments)},oS=n._emscripten_bind_btWheelInfo_set_m_rotation_1=function(){return n.asm.xy.apply(null,arguments)},aS=n._emscripten_bind_btWheelInfo_set_m_skidInfo_1=function(){return n.asm.yy.apply(null,arguments)},sS=n._emscripten_bind_btWheelInfo_set_m_steering_1=function(){return n.asm.zy.apply(null,arguments)},lS=n._emscripten_bind_btWheelInfo_set_m_suspensionRelativeVelocity_1=function(){return n.asm.Ay.apply(null,arguments)},cS=n._emscripten_bind_btWheelInfo_set_m_suspensionRestLength1_1=function(){return n.asm.By.apply(null,arguments)},uS=n._emscripten_bind_btWheelInfo_set_m_suspensionStiffness_1=function(){return n.asm.Cy.apply(null,arguments)},pS=n._emscripten_bind_btWheelInfo_set_m_wheelAxleCS_1=function(){return n.asm.Dy.apply(null,arguments)},dS=n._emscripten_bind_btWheelInfo_set_m_wheelDirectionCS_1=function(){return n.asm.Ey.apply(null,arguments)},hS=n._emscripten_bind_btWheelInfo_set_m_wheelsDampingCompression_1=function(){return n.asm.Fy.apply(null,arguments)},fS=n._emscripten_bind_btWheelInfo_set_m_wheelsDampingRelaxation_1=function(){return n.asm.Gy.apply(null,arguments)},mS=n._emscripten_bind_btWheelInfo_set_m_wheelsRadius_1=function(){return n.asm.Hy.apply(null,arguments)},yS=n._emscripten_bind_btWheelInfo_set_m_wheelsSuspensionForce_1=function(){return n.asm.Iy.apply(null,arguments)},_S=n._emscripten_bind_btWheelInfo_set_m_worldTransform_1=function(){return n.asm.Jy.apply(null,arguments)},gS=n._emscripten_bind_btWheelInfo_updateWheel_2=function(){return n.asm.Ky.apply(null,arguments)},vS=n._emscripten_bind_tAnchorArray___destroy___0=function(){return n.asm.Ly.apply(null,arguments)},bS=n._emscripten_bind_tAnchorArray_at_1=function(){return n.asm.My.apply(null,arguments)},xS=n._emscripten_bind_tAnchorArray_clear_0=function(){return n.asm.Ny.apply(null,arguments)},wS=n._emscripten_bind_tAnchorArray_pop_back_0=function(){return n.asm.Oy.apply(null,arguments)},ES=n._emscripten_bind_tAnchorArray_push_back_1=function(){return n.asm.Py.apply(null,arguments)},TS=n._emscripten_bind_tAnchorArray_size_0=function(){return n.asm.Qy.apply(null,arguments)},SS=n._emscripten_bind_tMaterialArray___destroy___0=function(){return n.asm.Ry.apply(null,arguments)},MS=n._emscripten_bind_tMaterialArray_at_1=function(){return n.asm.Sy.apply(null,arguments)},jS=n._emscripten_bind_tMaterialArray_size_0=function(){return n.asm.Ty.apply(null,arguments)},CS=n._emscripten_bind_tNodeArray___destroy___0=function(){return n.asm.Uy.apply(null,arguments)},zS=n._emscripten_bind_tNodeArray_at_1=function(){return n.asm.Vy.apply(null,arguments)},RS=n._emscripten_bind_tNodeArray_size_0=function(){return n.asm.Wy.apply(null,arguments)},AS=n._emscripten_enum_PHY_ScalarType_PHY_DOUBLE=function(){return n.asm.Xy.apply(null,arguments)},LS=n._emscripten_enum_PHY_ScalarType_PHY_FIXEDPOINT88=function(){return n.asm.Yy.apply(null,arguments)},IS=n._emscripten_enum_PHY_ScalarType_PHY_FLOAT=function(){return n.asm.Zy.apply(null,arguments)},PS=n._emscripten_enum_PHY_ScalarType_PHY_INTEGER=function(){return n.asm._y.apply(null,arguments)},OS=n._emscripten_enum_PHY_ScalarType_PHY_SHORT=function(){return n.asm.$y.apply(null,arguments)},kS=n._emscripten_enum_PHY_ScalarType_PHY_UCHAR=function(){return n.asm.az.apply(null,arguments)},BS=n._emscripten_enum_btConstraintParams_BT_CONSTRAINT_CFM=function(){return n.asm.bz.apply(null,arguments)},DS=n._emscripten_enum_btConstraintParams_BT_CONSTRAINT_ERP=function(){return n.asm.cz.apply(null,arguments)},HS=n._emscripten_enum_btConstraintParams_BT_CONSTRAINT_STOP_CFM=function(){return n.asm.dz.apply(null,arguments)},FS=n._emscripten_enum_btConstraintParams_BT_CONSTRAINT_STOP_ERP=function(){return n.asm.ez.apply(null,arguments)};function NS(){function t(){if(!$&&($=!0,!x)){if(B=!0,L(P),L(O),n.onRuntimeInitialized&&n.onRuntimeInitialized(),n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;){var t=n.postRun.shift();k.unshift(t)}L(k)}}if(!(0<N)){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)D();L(I),0<N||(n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),t()},1)):t())}}if(n._free=function(){return n.asm.fz.apply(null,arguments)},n._malloc=function(){return n.asm.gz.apply(null,arguments)},n.dynCall_v=function(){return n.asm.hz.apply(null,arguments)},n.dynCall_vi=function(){return n.asm.iz.apply(null,arguments)},n.asm=K,n.UTF8ToString=function(t,e){return t?T(j,t,e):""},n.then=function(t){if($)t(n);else{var e=n.onRuntimeInitialized;n.onRuntimeInitialized=function(){e&&e(),t(n)}}return n},V=function t(){$||NS(),$||(V=t)},n.run=NS,n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);0<n.preInit.length;)n.preInit.pop()();function US(){}function VS(t){return(t||US).lz}function GS(t,e){var n=VS(e),r=n[t];return r||((r=Object.create((e||US).prototype)).jz=t,n[t]=r)}function WS(t){if("string"==typeof t){for(var n=0,r=0;r<t.length;++r){var i=t.charCodeAt(r);55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&t.charCodeAt(++r)),127>=i?++n:n=2047>=i?n+2:65535>=i?n+3:n+4}if(r=0,0<(i=(n=Array(n+1)).length)){i=r+i-1;for(var o=0;o<t.length;++o){var a=t.charCodeAt(o);if(55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&t.charCodeAt(++o)),127>=a){if(r>=i)break;n[r++]=a}else{if(2047>=a){if(r+1>=i)break;n[r++]=192|a>>6}else{if(65535>=a){if(r+2>=i)break;n[r++]=224|a>>12}else{if(r+3>=i)break;n[r++]=240|a>>18,n[r++]=128|a>>12&63}n[r++]=128|a>>6&63}n[r++]=128|63&a}}n[r]=0}t=e.Nz(n,M),e.copy(n,M,t)}return t}function qS(t){if("object"==typeof t){var n=e.Nz(t,z);return e.copy(t,z,n),n}return t}function XS(){throw"cannot construct a btCollisionWorld, no constructor in IDL"}function YS(){throw"cannot construct a btCollisionShape, no constructor in IDL"}function QS(){this.jz=Xo(),VS(QS)[this.jz]=this}function ZS(){throw"cannot construct a btDynamicsWorld, no constructor in IDL"}function JS(){throw"cannot construct a btTypedConstraint, no constructor in IDL"}function KS(){throw"cannot construct a ConvexResultCallback, no constructor in IDL"}function $S(){throw"cannot construct a btConcaveShape, no constructor in IDL"}function tM(t,e){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),this.jz=eo(t,e),VS(tM)[this.jz]=this}function eM(){throw"cannot construct a btIDebugDraw, no constructor in IDL"}function nM(t){t&&"object"==typeof t&&(t=t.jz),this.jz=void 0===t?hc():fc(t),VS(nM)[this.jz]=this}function rM(t,e){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),this.jz=Ht(t,e),VS(rM)[this.jz]=this}function iM(){throw"cannot construct a btTriangleMeshShape, no constructor in IDL"}function oM(){this.jz=pd(),VS(oM)[this.jz]=this}function aM(t,e){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),this.jz=Ts(t,e),VS(aM)[this.jz]=this}function sM(){throw"cannot construct a btActionInterface, no constructor in IDL"}function lM(t,e,n){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),this.jz=void 0===t?Yw():void 0===e?_emscripten_bind_btVector3_btVector3_1(t):void 0===n?_emscripten_bind_btVector3_btVector3_2(t,e):Qw(t,e,n),VS(lM)[this.jz]=this}function cM(){throw"cannot construct a btVehicleRaycaster, no constructor in IDL"}function uM(){throw"cannot construct a btQuadWord, no constructor in IDL"}function pM(t){t&&"object"==typeof t&&(t=t.jz),this.jz=ic(t),VS(pM)[this.jz]=this}function dM(t,e,n,r){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),this.jz=Fc(t,e,n,r),VS(dM)[this.jz]=this}function hM(){throw"cannot construct a btConvexShape, no constructor in IDL"}function fM(){throw"cannot construct a btDispatcher, no constructor in IDL"}function mM(t,e,n,r,i){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),this.jz=void 0===r?Ap(t,e,n):void 0===i?_emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_4(t,e,n,r):Lp(t,e,n,r,i),VS(mM)[this.jz]=this}function yM(){throw"cannot construct a btStridingMeshInterface, no constructor in IDL"}function _M(){throw"cannot construct a btMotionState, no constructor in IDL"}function gM(){throw"cannot construct a ContactResultCallback, no constructor in IDL"}function vM(){throw"cannot construct a btSoftBodySolver, no constructor in IDL"}function bM(){throw"cannot construct a RayResultCallback, no constructor in IDL"}function xM(){throw"cannot construct a btMatrix3x3, no constructor in IDL"}function wM(){throw"cannot construct a btScalarArray, no constructor in IDL"}function EM(){throw"cannot construct a Material, no constructor in IDL"}function TM(){throw"cannot construct a tNodeArray, no constructor in IDL"}function SM(){throw"cannot construct a btDispatcherInfo, no constructor in IDL"}function MM(){throw"cannot construct a btWheelInfoConstructionInfo, no constructor in IDL"}function jM(t,e){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),this.jz=void 0===e?kl(t):Bl(t,e),VS(jM)[this.jz]=this}function CM(){throw"cannot construct a btBroadphaseInterface, no constructor in IDL"}function zM(t,e,n,r){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),this.jz=void 0===r?$y(t,e,n):t_(t,e,n,r),VS(zM)[this.jz]=this}function RM(){throw"cannot construct a btCollisionConfiguration, no constructor in IDL"}function AM(){this.jz=_m(),VS(AM)[this.jz]=this}function LM(t){t&&"object"==typeof t&&(t=t.jz),this.jz=void 0===t?Za():Ja(t),VS(LM)[this.jz]=this}function IM(t,e){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),this.jz=et(t,e),VS(IM)[this.jz]=this}function PM(){throw"cannot construct a tMaterialArray, no constructor in IDL"}function OM(t){t&&"object"==typeof t&&(t=t.jz),this.jz=Cc(t),VS(OM)[this.jz]=this}function kM(){this.jz=pp(),VS(kM)[this.jz]=this}function BM(){this.jz=Ys(),VS(BM)[this.jz]=this}function DM(){throw"cannot construct a LocalShapeInfo, no constructor in IDL"}function HM(t){t&&"object"==typeof t&&(t=t.jz),this.jz=B_(t),VS(HM)[this.jz]=this}function FM(){throw"cannot construct a btIndexedMeshArray, no constructor in IDL"}function NM(){this.jz=pc(),VS(NM)[this.jz]=this}function UM(t,e,n,r,i,o,a,s,l){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),o&&"object"==typeof o&&(o=o.jz),a&&"object"==typeof a&&(a=a.jz),s&&"object"==typeof s&&(s=s.jz),l&&"object"==typeof l&&(l=l.jz),this.jz=Wd(t,e,n,r,i,o,a,s,l),VS(UM)[this.jz]=this}function VM(){this.jz=Mc(),VS(VM)[this.jz]=this}function GM(t){t&&"object"==typeof t&&(t=t.jz),this.jz=Do(t),VS(GM)[this.jz]=this}function WM(t,e,n,r,i){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),this.jz=void 0===n?ui(t,e):void 0===r?pi(t,e,n):void 0===i?di(t,e,n,r):hi(t,e,n,r,i),VS(WM)[this.jz]=this}function qM(){throw"cannot construct a VoidPtr, no constructor in IDL"}function XM(){this.jz=bv(),VS(XM)[this.jz]=this}function YM(t,e,n,r){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),this.jz=void 0===n?zs(t,e):void 0===r?_emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_3(t,e,n):Rs(t,e,n,r),VS(YM)[this.jz]=this}function QM(t,e,n,r,i,o,a){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),o&&"object"==typeof o&&(o=o.jz),a&&"object"==typeof a&&(a=a.jz),this.jz=void 0===r?Kd(t,e,n):void 0===i?$d(t,e,n,r):void 0===o?th(t,e,n,r,i):void 0===a?eh(t,e,n,r,i,o):nh(t,e,n,r,i,o,a),VS(QM)[this.jz]=this}function ZM(t,e){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),this.jz=vs(t,e),VS(ZM)[this.jz]=this}function JM(t,e){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),this.jz=fs(t,e),VS(JM)[this.jz]=this}function KM(t,e){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),this.jz=void 0===t?Lw():void 0===e?Iw(t):Pw(t,e),VS(KM)[this.jz]=this}function $M(t,n){e.rz(),"object"==typeof t&&(t=qS(t)),n&&"object"==typeof n&&(n=n.jz),this.jz=void 0===t?dl():void 0===n?hl(t):fl(t,n),VS($M)[this.jz]=this}function tj(){this.jz=BE(),VS(tj)[this.jz]=this}function ej(){throw"cannot construct a btCollisionObjectWrapper, no constructor in IDL"}function nj(t){t&&"object"==typeof t&&(t=t.jz),this.jz=Ug(t),VS(nj)[this.jz]=this}function rj(t,e){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),this.jz=void 0===t?gc():void 0===e?vc(t):bc(t,e),VS(rj)[this.jz]=this}function ij(t){t&&"object"==typeof t&&(t=t.jz),this.jz=wT(t),VS(ij)[this.jz]=this}function oj(t,e,n,r){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),this.jz=void 0===t?pE():void 0===e?_emscripten_bind_btVector4_btVector4_1(t):void 0===n?_emscripten_bind_btVector4_btVector4_2(t,e):void 0===r?_emscripten_bind_btVector4_btVector4_3(t,e,n):dE(t,e,n,r),VS(oj)[this.jz]=this}function aj(){this.jz=yc(),VS(aj)[this.jz]=this}function sj(){throw"cannot construct a Anchor, no constructor in IDL"}function lj(){throw"cannot construct a btVehicleRaycasterResult, no constructor in IDL"}function cj(){throw"cannot construct a btVector3Array, no constructor in IDL"}function uj(){throw"cannot construct a btConstraintSolver, no constructor in IDL"}function pj(t,e,n){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),this.jz=Ey(t,e,n),VS(pj)[this.jz]=this}function dj(t){t&&"object"==typeof t&&(t=t.jz),this.jz=Gl(t),VS(dj)[this.jz]=this}function hj(t){t&&"object"==typeof t&&(t=t.jz),this.jz=Jl(t),VS(hj)[this.jz]=this}function fj(){throw"cannot construct a btConvexPolyhedron, no constructor in IDL"}function mj(){this.jz=Fg(),VS(mj)[this.jz]=this}function yj(){throw"cannot construct a tAnchorArray, no constructor in IDL"}function _j(){throw"cannot construct a RaycastInfo, no constructor in IDL"}function gj(t,n,r){e.rz(),t&&"object"==typeof t&&(t=t.jz),"object"==typeof n&&(n=qS(n)),r&&"object"==typeof r&&(r=r.jz),this.jz=Cf(t,n,r),VS(gj)[this.jz]=this}function vj(t,n,r,i){e.rz(),t&&"object"==typeof t&&(t=t.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),"object"==typeof i&&(i=qS(i)),this.jz=Qv(t,n,r,i),VS(vj)[this.jz]=this}function bj(){throw"cannot construct a btIntArray, no constructor in IDL"}function xj(){throw"cannot construct a Config, no constructor in IDL"}function wj(t,e,n,r,i){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),this.jz=po(t,e,n,r,i),VS(wj)[this.jz]=this}function Ej(){throw"cannot construct a Node, no constructor in IDL"}function Tj(){this.jz=Vd(),VS(Tj)[this.jz]=this}function Sj(){throw"cannot construct a btOverlappingPairCallback, no constructor in IDL"}function Mj(t,e,n,r){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),this.jz=void 0===r?Ph(t,e,n):Oh(t,e,n,r),VS(Mj)[this.jz]=this}function jj(){throw"cannot construct a btSoftBodyArray, no constructor in IDL"}function Cj(){throw"cannot construct a btFaceArray, no constructor in IDL"}function zj(t,e){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),this.jz=Ux(t,e),VS(zj)[this.jz]=this}function Rj(){throw"cannot construct a btOverlappingPairCache, no constructor in IDL"}function Aj(){throw"cannot construct a btIndexedMesh, no constructor in IDL"}function Lj(t,e,n,r,i){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),this.jz=nx(t,e,n,r,i),VS(Lj)[this.jz]=this}function Ij(t,e,n,r){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),this.jz=Tp(t,e,n,r),VS(Ij)[this.jz]=this}function Pj(t,e){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),this.jz=void 0===t?Qx():void 0===e?_emscripten_bind_btTransform_btTransform_1(t):Zx(t,e),VS(Pj)[this.jz]=this}function Oj(t,e){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),this.jz=ie(t,e),VS(Oj)[this.jz]=this}function kj(t){t&&"object"==typeof t&&(t=t.jz),this.jz=void 0===t?yv():_v(t),VS(kj)[this.jz]=this}function Bj(){this.jz=Ee(),VS(Bj)[this.jz]=this}function Dj(t,e,n){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),this.jz=void 0===n?zi(t,e):Ri(t,e,n),VS(Dj)[this.jz]=this}function Hj(){throw"cannot construct a btConstCollisionObjectArray, no constructor in IDL"}function Fj(t,e,n,r,i){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),this.jz=void 0===r?Xg(t,e,n):void 0===i?_emscripten_bind_btSliderConstraint_btSliderConstraint_4(t,e,n,r):Yg(t,e,n,r,i),VS(Fj)[this.jz]=this}function Nj(){this.jz=Hf(),VS(Nj)[this.jz]=this}function Uj(){throw"cannot construct a btManifoldPoint, no constructor in IDL"}function Vj(t,e,n,r){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),this.jz=void 0===n?Em(t,e):void 0===r?_emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_3(t,e,n):Tm(t,e,n,r),VS(Vj)[this.jz]=this}function Gj(){this.jz=fv(),VS(Gj)[this.jz]=this}function Wj(){throw"cannot construct a btBroadphaseProxy, no constructor in IDL"}function qj(t,e,n,r,i,o){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),o&&"object"==typeof o&&(o=o.jz),this.jz=sw(t,e,n,r,i,o),VS(qj)[this.jz]=this}function Xj(t){t&&"object"==typeof t&&(t=t.jz),this.jz=mi(t),VS(Xj)[this.jz]=this}function Yj(){throw"cannot construct a btFace, no constructor in IDL"}function Qj(){this.jz=Dn(),VS(Qj)[this.jz]=this}function Zj(t,e){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),this.jz=Oi(t,e),VS(Zj)[this.jz]=this}function Jj(t,e,n,r){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),this.jz=Ym(t,e,n,r),VS(Jj)[this.jz]=this}function Kj(t,e){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),this.jz=Wi(t,e),VS(Kj)[this.jz]=this}function $j(){throw"cannot construct a btContactSolverInfo, no constructor in IDL"}function tC(){this.jz=uw(),VS(tC)[this.jz]=this}function eC(t,e,n,r,i){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),this.jz=void 0===r?Gp(t,e,n):void 0===i?_emscripten_bind_btGeneric6DofSpringConstraint_btGeneric6DofSpringConstraint_4(t,e,n,r):Wp(t,e,n,r,i),VS(eC)[this.jz]=this}function nC(t){t&&"object"==typeof t&&(t=t.jz),this.jz=Ox(t),VS(nC)[this.jz]=this}function rC(t,e,n,r,i){t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),this.jz=qn(t,e,n,r,i),VS(rC)[this.jz]=this}return NS(),US.prototype=Object.create(US.prototype),US.prototype.constructor=US,US.prototype.kz=US,US.lz={},n.WrapperObject=US,n.getCache=VS,n.wrapPointer=GS,n.castObject=function(t,e){return GS(t.jz,e)},n.NULL=GS(0),n.destroy=function(t){if(!t.__destroy__)throw"Error: Cannot destroy object. (Did you create it yourself?)";t.__destroy__(),delete VS(t.kz)[t.jz]},n.compare=function(t,e){return t.jz===e.jz},n.getPointer=function(t){return t.jz},n.getClass=function(t){return t.kz},e={buffer:0,size:0,Fz:0,Mz:[],Ez:0,rz:function(){if(e.Ez){for(var t=0;t<e.Mz.length;t++)n._free(e.Mz[t]);e.Mz.length=0,n._free(e.buffer),e.buffer=0,e.size+=e.Ez,e.Ez=0}e.buffer||(e.size+=128,e.buffer=n._malloc(e.size),w(e.buffer)),e.Fz=0},Nz:function(t,r){return w(e.buffer),t=7+(t=t.length*r.BYTES_PER_ELEMENT)&-8,e.Fz+t>=e.size?(w(0<t),e.Ez+=t,r=n._malloc(t),e.Mz.push(r)):(r=e.buffer+e.Fz,e.Fz+=t),r},copy:function(t,e,n){switch(e.BYTES_PER_ELEMENT){case 2:n>>=1;break;case 4:n>>=2;break;case 8:n>>=3}for(var r=0;r<t.length;r++)e[n+r]=t[r]}},XS.prototype=Object.create(US.prototype),XS.prototype.constructor=XS,XS.prototype.kz=XS,XS.lz={},n.btCollisionWorld=XS,XS.prototype.getDispatcher=function(){return GS(Fa(this.jz),fM)},XS.prototype.rayTest=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),Va(r,t,e,n)},XS.prototype.getPairCache=function(){return GS(Ua(this.jz),Rj)},XS.prototype.getDispatchInfo=function(){return GS(Ha(this.jz),SM)},XS.prototype.addCollisionObject=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),void 0===e?za(r,t):void 0===n?Ra(r,t,e):Aa(r,t,e,n)},XS.prototype.removeCollisionObject=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ga(e,t)},XS.prototype.getBroadphase=function(){return GS(Ba(this.jz),CM)},XS.prototype.convexSweepTest=function(t,e,n,r,i){var o=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),Pa(o,t,e,n,r,i)},XS.prototype.contactPairTest=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),La(r,t,e,n)},XS.prototype.contactTest=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Ia(n,t,e)},XS.prototype.updateSingleAabb=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Xa(e,t)},XS.prototype.setDebugDrawer=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Wa(e,t)},XS.prototype.getDebugDrawer=function(){return GS(Da(this.jz),eM)},XS.prototype.debugDrawWorld=function(){ka(this.jz)},XS.prototype.debugDrawObject=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),Oa(r,t,e,n)},XS.prototype.getForceUpdateAllAabbs=function(){return!!Na(this.jz)},XS.prototype.setForceUpdateAllAabbs=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),qa(e,t)},XS.prototype.__destroy__=function(){Ca(this.jz)},YS.prototype=Object.create(US.prototype),YS.prototype.constructor=YS,YS.prototype.kz=YS,YS.lz={},n.btCollisionShape=YS,YS.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ma(e,t)},YS.prototype.getLocalScaling=function(){return GS(Ta(this.jz),lM)},YS.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Ea(n,t,e)},YS.prototype.setMargin=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ja(e,t)},YS.prototype.getMargin=function(){return Sa(this.jz)},YS.prototype.__destroy__=function(){wa(this.jz)},QS.prototype=Object.create(US.prototype),QS.prototype.constructor=QS,QS.prototype.kz=QS,QS.lz={},n.btCollisionObject=QS,QS.prototype.setAnisotropicFriction=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),ca(n,t,e)},QS.prototype.getCollisionShape=function(){return GS(Jo(this.jz),YS)},QS.prototype.setContactProcessingThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),fa(e,t)},QS.prototype.setActivationState=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),la(e,t)},QS.prototype.forceActivationState=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Yo(e,t)},QS.prototype.activate=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),void 0===t?Wo(e):qo(e,t)},QS.prototype.isActive=function(){return!!ia(this.jz)},QS.prototype.isKinematicObject=function(){return!!oa(this.jz)},QS.prototype.isStaticObject=function(){return!!aa(this.jz)},QS.prototype.isStaticOrKinematicObject=function(){return!!sa(this.jz)},QS.prototype.getRestitution=function(){return $o(this.jz)},QS.prototype.getFriction=function(){return Ko(this.jz)},QS.prototype.getRollingFriction=function(){return ta(this.jz)},QS.prototype.setRestitution=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),_a(e,t)},QS.prototype.setFriction=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ma(e,t)},QS.prototype.setRollingFriction=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ga(e,t)},QS.prototype.getWorldTransform=function(){return GS(ra(this.jz),Pj)},QS.prototype.getCollisionFlags=function(){return Zo(this.jz)},QS.prototype.setCollisionFlags=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),da(e,t)},QS.prototype.setWorldTransform=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),xa(e,t)},QS.prototype.setCollisionShape=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ha(e,t)},QS.prototype.setCcdMotionThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ua(e,t)},QS.prototype.setCcdSweptSphereRadius=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),pa(e,t)},QS.prototype.getUserIndex=function(){return ea(this.jz)},QS.prototype.setUserIndex=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),va(e,t)},QS.prototype.getUserPointer=function(){return GS(na(this.jz),qM)},QS.prototype.setUserPointer=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ba(e,t)},QS.prototype.getBroadphaseHandle=function(){return GS(Qo(this.jz),Wj)},QS.prototype.setIgnoreCollisionCheck=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),ya(n,t,e)},QS.prototype.__destroy__=function(){Go(this.jz)},ZS.prototype=Object.create(XS.prototype),ZS.prototype.constructor=ZS,ZS.prototype.kz=ZS,ZS.lz={},n.btDynamicsWorld=ZS,ZS.prototype.addAction=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Uu(e,t)},ZS.prototype.removeAction=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),op(e,t)},ZS.prototype.getSolverInfo=function(){return GS(rp(this.jz),$j)},ZS.prototype.getDispatcher=function(){return GS(tp(this.jz),fM)},ZS.prototype.rayTest=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),ip(r,t,e,n)},ZS.prototype.getPairCache=function(){return GS(np(this.jz),Rj)},ZS.prototype.getDispatchInfo=function(){return GS($u(this.jz),SM)},ZS.prototype.addCollisionObject=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),void 0===e?Vu(r,t):void 0===n?Gu(r,t,e):Wu(r,t,e,n)},ZS.prototype.removeCollisionObject=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ap(e,t)},ZS.prototype.getBroadphase=function(){return GS(Ju(this.jz),CM)},ZS.prototype.convexSweepTest=function(t,e,n,r,i){var o=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),Yu(o,t,e,n,r,i)},ZS.prototype.contactPairTest=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),qu(r,t,e,n)},ZS.prototype.contactTest=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Xu(n,t,e)},ZS.prototype.updateSingleAabb=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),cp(e,t)},ZS.prototype.setDebugDrawer=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),sp(e,t)},ZS.prototype.getDebugDrawer=function(){return GS(Ku(this.jz),eM)},ZS.prototype.debugDrawWorld=function(){Zu(this.jz)},ZS.prototype.debugDrawObject=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),Qu(r,t,e,n)},ZS.prototype.getForceUpdateAllAabbs=function(){return!!ep(this.jz)},ZS.prototype.setForceUpdateAllAabbs=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),lp(e,t)},ZS.prototype.__destroy__=function(){Nu(this.jz)},JS.prototype=Object.create(US.prototype),JS.prototype.constructor=JS,JS.prototype.kz=JS,JS.lz={},n.btTypedConstraint=JS,JS.prototype.enableFeedback=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Hw(e,t)},JS.prototype.getBreakingImpulseThreshold=function(){return Fw(this.jz)},JS.prototype.setBreakingImpulseThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Uw(e,t)},JS.prototype.getParam=function(t,e){var n=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Nw(n,t,e)},JS.prototype.setParam=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),Vw(r,t,e,n)},JS.prototype.__destroy__=function(){Dw(this.jz)},KS.prototype=Object.create(US.prototype),KS.prototype.constructor=KS,KS.prototype.kz=KS,KS.lz={},n.ConvexResultCallback=KS,KS.prototype.hasHit=function(){return!!Pn(this.jz)},KS.prototype.get_m_collisionFilterGroup=KS.prototype.mz=function(){return Ln(this.jz)},KS.prototype.set_m_collisionFilterGroup=KS.prototype.oz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),kn(e,t)},Object.defineProperty(KS.prototype,"m_collisionFilterGroup",{get:KS.prototype.mz,set:KS.prototype.oz}),KS.prototype.get_m_collisionFilterMask=KS.prototype.nz=function(){return In(this.jz)},KS.prototype.set_m_collisionFilterMask=KS.prototype.pz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Bn(e,t)},Object.defineProperty(KS.prototype,"m_collisionFilterMask",{get:KS.prototype.nz,set:KS.prototype.pz}),KS.prototype.get_m_closestHitFraction=KS.prototype.qz=function(){return An(this.jz)},KS.prototype.set_m_closestHitFraction=KS.prototype.sz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),On(e,t)},Object.defineProperty(KS.prototype,"m_closestHitFraction",{get:KS.prototype.qz,set:KS.prototype.sz}),KS.prototype.__destroy__=function(){Rn(this.jz)},$S.prototype=Object.create(YS.prototype),$S.prototype.constructor=$S,$S.prototype.kz=$S,$S.lz={},n.btConcaveShape=$S,$S.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ds(e,t)},$S.prototype.getLocalScaling=function(){return GS(ps(this.jz),lM)},$S.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),us(n,t,e)},$S.prototype.__destroy__=function(){cs(this.jz)},tM.prototype=Object.create(YS.prototype),tM.prototype.constructor=tM,tM.prototype.kz=tM,tM.lz={},n.btCapsuleShape=tM,tM.prototype.setMargin=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),co(e,t)},tM.prototype.getMargin=function(){return oo(this.jz)},tM.prototype.getUpAxis=function(){return so(this.jz)},tM.prototype.getRadius=function(){return ao(this.jz)},tM.prototype.getHalfHeight=function(){return ro(this.jz)},tM.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),lo(e,t)},tM.prototype.getLocalScaling=function(){return GS(io(this.jz),lM)},tM.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),no(n,t,e)},tM.prototype.__destroy__=function(){to(this.jz)},eM.prototype=Object.create(US.prototype),eM.prototype.constructor=eM,eM.prototype.kz=eM,eM.lz={},n.btIDebugDraw=eM,eM.prototype.drawLine=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),bh(r,t,e,n)},eM.prototype.drawContactPoint=function(t,e,n,r,i){var o=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),vh(o,t,e,n,r,i)},eM.prototype.reportErrorWarning=function(t){var n=this.jz;e.rz(),t=t&&"object"==typeof t?t.jz:WS(t),wh(n,t)},eM.prototype.draw3dText=function(t,n){var r=this.jz;e.rz(),t&&"object"==typeof t&&(t=t.jz),n=n&&"object"==typeof n?n.jz:WS(n),gh(r,t,n)},eM.prototype.setDebugMode=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Eh(e,t)},eM.prototype.getDebugMode=function(){return xh(this.jz)},eM.prototype.__destroy__=function(){_h(this.jz)},nM.prototype=Object.create(US.prototype),nM.prototype.constructor=nM,nM.prototype.kz=nM,nM.lz={},n.btDefaultCollisionConfiguration=nM,nM.prototype.__destroy__=function(){dc(this.jz)},rM.prototype=Object.create(KS.prototype),rM.prototype.constructor=rM,rM.prototype.kz=rM,rM.lz={},n.ClosestConvexResultCallback=rM,rM.prototype.hasHit=function(){return!!Qt(this.jz)},rM.prototype.get_m_convexFromWorld=rM.prototype.Qz=function(){return GS(Gt(this.jz),lM)},rM.prototype.set_m_convexFromWorld=rM.prototype.$z=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),$t(e,t)},Object.defineProperty(rM.prototype,"m_convexFromWorld",{get:rM.prototype.Qz,set:rM.prototype.$z}),rM.prototype.get_m_convexToWorld=rM.prototype.Rz=function(){return GS(Wt(this.jz),lM)},rM.prototype.set_m_convexToWorld=rM.prototype.aA=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),te(e,t)},Object.defineProperty(rM.prototype,"m_convexToWorld",{get:rM.prototype.Rz,set:rM.prototype.aA}),rM.prototype.get_m_hitNormalWorld=rM.prototype.uz=function(){return GS(Xt(this.jz),lM)},rM.prototype.set_m_hitNormalWorld=rM.prototype.wz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ne(e,t)},Object.defineProperty(rM.prototype,"m_hitNormalWorld",{get:rM.prototype.uz,set:rM.prototype.wz}),rM.prototype.get_m_hitPointWorld=rM.prototype.vz=function(){return GS(Yt(this.jz),lM)},rM.prototype.set_m_hitPointWorld=rM.prototype.xz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),re(e,t)},Object.defineProperty(rM.prototype,"m_hitPointWorld",{get:rM.prototype.vz,set:rM.prototype.xz}),rM.prototype.get_m_hitCollisionObject=rM.prototype.Az=function(){return GS(qt(this.jz),QS)},rM.prototype.set_m_hitCollisionObject=rM.prototype.Iz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ee(e,t)},Object.defineProperty(rM.prototype,"m_hitCollisionObject",{get:rM.prototype.Az,set:rM.prototype.Iz}),rM.prototype.get_m_collisionFilterGroup=rM.prototype.mz=function(){return Ut(this.jz)},rM.prototype.set_m_collisionFilterGroup=rM.prototype.oz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Jt(e,t)},Object.defineProperty(rM.prototype,"m_collisionFilterGroup",{get:rM.prototype.mz,set:rM.prototype.oz}),rM.prototype.get_m_collisionFilterMask=rM.prototype.nz=function(){return Vt(this.jz)},rM.prototype.set_m_collisionFilterMask=rM.prototype.pz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Kt(e,t)},Object.defineProperty(rM.prototype,"m_collisionFilterMask",{get:rM.prototype.nz,set:rM.prototype.pz}),rM.prototype.get_m_closestHitFraction=rM.prototype.qz=function(){return Nt(this.jz)},rM.prototype.set_m_closestHitFraction=rM.prototype.sz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Zt(e,t)},Object.defineProperty(rM.prototype,"m_closestHitFraction",{get:rM.prototype.qz,set:rM.prototype.sz}),rM.prototype.__destroy__=function(){Ft(this.jz)},iM.prototype=Object.create($S.prototype),iM.prototype.constructor=iM,iM.prototype.kz=iM,iM.lz={},n.btTriangleMeshShape=iM,iM.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),jw(e,t)},iM.prototype.getLocalScaling=function(){return GS(Mw(this.jz),lM)},iM.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Sw(n,t,e)},iM.prototype.__destroy__=function(){Tw(this.jz)},oM.prototype=Object.create(QS.prototype),oM.prototype.constructor=oM,oM.prototype.kz=oM,oM.lz={},n.btGhostObject=oM,oM.prototype.getNumOverlappingObjects=function(){return _d(this.jz)},oM.prototype.getOverlappingObject=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(gd(e,t),QS)},oM.prototype.setAnisotropicFriction=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),zd(n,t,e)},oM.prototype.getCollisionShape=function(){return GS(md(this.jz),YS)},oM.prototype.setContactProcessingThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Pd(e,t)},oM.prototype.setActivationState=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Cd(e,t)},oM.prototype.forceActivationState=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),dd(e,t)},oM.prototype.activate=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),void 0===t?cd(e):ud(e,t)},oM.prototype.isActive=function(){return!!Td(this.jz)},oM.prototype.isKinematicObject=function(){return!!Sd(this.jz)},oM.prototype.isStaticObject=function(){return!!Md(this.jz)},oM.prototype.isStaticOrKinematicObject=function(){return!!jd(this.jz)},oM.prototype.getRestitution=function(){return vd(this.jz)},oM.prototype.getFriction=function(){return yd(this.jz)},oM.prototype.getRollingFriction=function(){return bd(this.jz)},oM.prototype.setRestitution=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Bd(e,t)},oM.prototype.setFriction=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Od(e,t)},oM.prototype.setRollingFriction=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Dd(e,t)},oM.prototype.getWorldTransform=function(){return GS(Ed(this.jz),Pj)},oM.prototype.getCollisionFlags=function(){return fd(this.jz)},oM.prototype.setCollisionFlags=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ld(e,t)},oM.prototype.setWorldTransform=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Nd(e,t)},oM.prototype.setCollisionShape=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Id(e,t)},oM.prototype.setCcdMotionThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Rd(e,t)},oM.prototype.setCcdSweptSphereRadius=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ad(e,t)},oM.prototype.getUserIndex=function(){return xd(this.jz)},oM.prototype.setUserIndex=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Hd(e,t)},oM.prototype.getUserPointer=function(){return GS(wd(this.jz),qM)},oM.prototype.setUserPointer=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Fd(e,t)},oM.prototype.getBroadphaseHandle=function(){return GS(hd(this.jz),Wj)},oM.prototype.setIgnoreCollisionCheck=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),kd(n,t,e)},oM.prototype.__destroy__=function(){ld(this.jz)},aM.prototype=Object.create(YS.prototype),aM.prototype.constructor=aM,aM.prototype.kz=aM,aM.lz={},n.btConeShape=aM,aM.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),js(e,t)},aM.prototype.getLocalScaling=function(){return GS(Ms(this.jz),lM)},aM.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Ss(n,t,e)},aM.prototype.__destroy__=function(){Es(this.jz)},sM.prototype=Object.create(US.prototype),sM.prototype.constructor=sM,sM.prototype.kz=sM,sM.lz={},n.btActionInterface=sM,sM.prototype.updateAction=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),li(n,t,e)},sM.prototype.__destroy__=function(){si(this.jz)},lM.prototype=Object.create(US.prototype),lM.prototype.constructor=lM,lM.prototype.kz=lM,lM.lz={},n.btVector3=lM,lM.prototype.length=lM.prototype.length=function(){return Jw(this.jz)},lM.prototype.x=lM.prototype.x=function(){return sE(this.jz)},lM.prototype.y=lM.prototype.y=function(){return lE(this.jz)},lM.prototype.z=lM.prototype.z=function(){return cE(this.jz)},lM.prototype.setX=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),iE(e,t)},lM.prototype.setY=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),oE(e,t)},lM.prototype.setZ=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),aE(e,t)},lM.prototype.setValue=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),rE(r,t,e,n)},lM.prototype.normalize=lM.prototype.normalize=function(){Kw(this.jz)},lM.prototype.rotate=lM.prototype.rotate=function(t,e){var n=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),GS(nE(n,t,e),lM)},lM.prototype.dot=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),Zw(e,t)},lM.prototype.op_mul=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(tE(e,t),lM)},lM.prototype.op_add=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS($w(e,t),lM)},lM.prototype.op_sub=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(eE(e,t),lM)},lM.prototype.__destroy__=function(){Xw(this.jz)},cM.prototype=Object.create(US.prototype),cM.prototype.constructor=cM,cM.prototype.kz=cM,cM.lz={},n.btVehicleRaycaster=cM,cM.prototype.castRay=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),kE(r,t,e,n)},cM.prototype.__destroy__=function(){OE(this.jz)},uM.prototype=Object.create(US.prototype),uM.prototype.constructor=uM,uM.prototype.kz=uM,uM.lz={},n.btQuadWord=uM,uM.prototype.x=uM.prototype.x=function(){return Um(this.jz)},uM.prototype.y=uM.prototype.y=function(){return Vm(this.jz)},uM.prototype.z=uM.prototype.z=function(){return Gm(this.jz)},uM.prototype.w=function(){return Nm(this.jz)},uM.prototype.setX=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Dm(e,t)},uM.prototype.setY=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Hm(e,t)},uM.prototype.setZ=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Fm(e,t)},uM.prototype.setW=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Bm(e,t)},uM.prototype.__destroy__=function(){km(this.jz)},pM.prototype=Object.create(YS.prototype),pM.prototype.constructor=pM,pM.prototype.kz=pM,pM.lz={},n.btCylinderShape=pM,pM.prototype.setMargin=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),cc(e,t)},pM.prototype.getMargin=function(){return sc(this.jz)},pM.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),lc(e,t)},pM.prototype.getLocalScaling=function(){return GS(ac(this.jz),lM)},pM.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),oc(n,t,e)},pM.prototype.__destroy__=function(){rc(this.jz)},dM.prototype=Object.create(ZS.prototype),dM.prototype.constructor=dM,dM.prototype.kz=dM,dM.lz={},n.btDiscreteDynamicsWorld=dM,dM.prototype.setGravity=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),uu(e,t)},dM.prototype.getGravity=function(){return GS(Jc(this.jz),lM)},dM.prototype.addRigidBody=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),void 0===e?Dc(r,t):void 0===n?_emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_2(r,t,e):Hc(r,t,e,n)},dM.prototype.removeRigidBody=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),iu(e,t)},dM.prototype.addConstraint=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),void 0===e?kc(n,t):Bc(n,t,e)},dM.prototype.removeConstraint=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ru(e,t)},dM.prototype.stepSimulation=function(t,e,n){var r=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),void 0===e?pu(r,t):void 0===n?du(r,t,e):hu(r,t,e,n)},dM.prototype.setContactAddedCallback=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ou(e,t)},dM.prototype.setContactProcessedCallback=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),su(e,t)},dM.prototype.setContactDestroyedCallback=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),au(e,t)},dM.prototype.activateContactAddedCallbackAdjustInternalEdgeContacts=function(){Ac(this.jz)},dM.prototype.getDispatcher=function(){return GS(Qc(this.jz),fM)},dM.prototype.rayTest=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),tu(r,t,e,n)},dM.prototype.getPairCache=function(){return GS(Kc(this.jz),Rj)},dM.prototype.getDispatchInfo=function(){return GS(Yc(this.jz),SM)},dM.prototype.addCollisionObject=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),void 0===e?Ic(r,t):void 0===n?Pc(r,t,e):Oc(r,t,e,n)},dM.prototype.removeCollisionObject=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),nu(e,t)},dM.prototype.getBroadphase=function(){return GS(qc(this.jz),CM)},dM.prototype.convexSweepTest=function(t,e,n,r,i){var o=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),Vc(o,t,e,n,r,i)},dM.prototype.contactPairTest=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),Nc(r,t,e,n)},dM.prototype.contactTest=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Uc(n,t,e)},dM.prototype.updateSingleAabb=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),fu(e,t)},dM.prototype.setDebugDrawer=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),lu(e,t)},dM.prototype.getDebugDrawer=function(){return GS(Xc(this.jz),eM)},dM.prototype.debugDrawWorld=function(){Wc(this.jz)},dM.prototype.debugDrawObject=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),Gc(r,t,e,n)},dM.prototype.getForceUpdateAllAabbs=function(){return!!Zc(this.jz)},dM.prototype.setForceUpdateAllAabbs=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),cu(e,t)},dM.prototype.addAction=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Lc(e,t)},dM.prototype.removeAction=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),eu(e,t)},dM.prototype.getSolverInfo=function(){return GS($c(this.jz),$j)},dM.prototype.__destroy__=function(){Rc(this.jz)},hM.prototype=Object.create(YS.prototype),hM.prototype.constructor=hM,hM.prototype.kz=hM,hM.lz={},n.btConvexShape=hM,hM.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Il(e,t)},hM.prototype.getLocalScaling=function(){return GS(Al(this.jz),lM)},hM.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Rl(n,t,e)},hM.prototype.setMargin=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Pl(e,t)},hM.prototype.getMargin=function(){return Ll(this.jz)},hM.prototype.__destroy__=function(){zl(this.jz)},fM.prototype=Object.create(US.prototype),fM.prototype.constructor=fM,fM.prototype.kz=fM,fM.lz={},n.btDispatcher=fM,fM.prototype.getNumManifolds=function(){return Fu(this.jz)},fM.prototype.getManifoldByIndexInternal=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(Hu(e,t),AM)},fM.prototype.__destroy__=function(){Du(this.jz)},mM.prototype=Object.create(JS.prototype),mM.prototype.constructor=mM,mM.prototype.kz=mM,mM.lz={},n.btGeneric6DofConstraint=mM,mM.prototype.setLinearLowerLimit=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Fp(e,t)},mM.prototype.setLinearUpperLimit=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Np(e,t)},mM.prototype.setAngularLowerLimit=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Bp(e,t)},mM.prototype.setAngularUpperLimit=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Dp(e,t)},mM.prototype.getFrameOffsetA=function(){return GS(Op(this.jz),Pj)},mM.prototype.enableFeedback=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ip(e,t)},mM.prototype.getBreakingImpulseThreshold=function(){return Pp(this.jz)},mM.prototype.setBreakingImpulseThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Hp(e,t)},mM.prototype.getParam=function(t,e){var n=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),kp(n,t,e)},mM.prototype.setParam=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),Up(r,t,e,n)},mM.prototype.__destroy__=function(){Rp(this.jz)},yM.prototype=Object.create(US.prototype),yM.prototype.constructor=yM,yM.prototype.kz=yM,yM.lz={},n.btStridingMeshInterface=yM,yM.prototype.setScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Xx(e,t)},yM.prototype.__destroy__=function(){qx(this.jz)},_M.prototype=Object.create(US.prototype),_M.prototype.constructor=_M,_M.prototype.kz=_M,_M.lz={},n.btMotionState=_M,_M.prototype.getWorldTransform=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Sf(e,t)},_M.prototype.setWorldTransform=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Mf(e,t)},_M.prototype.__destroy__=function(){Tf(this.jz)},gM.prototype=Object.create(US.prototype),gM.prototype.constructor=gM,gM.prototype.kz=gM,gM.lz={},n.ContactResultCallback=gM,gM.prototype.addSingleResult=function(t,e,n,r,i,o,a){var s=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),o&&"object"==typeof o&&(o=o.jz),a&&"object"==typeof a&&(a=a.jz),Sn(s,t,e,n,r,i,o,a)},gM.prototype.get_m_collisionFilterGroup=gM.prototype.mz=function(){return Mn(this.jz)},gM.prototype.set_m_collisionFilterGroup=gM.prototype.oz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Cn(e,t)},Object.defineProperty(gM.prototype,"m_collisionFilterGroup",{get:gM.prototype.mz,set:gM.prototype.oz}),gM.prototype.get_m_collisionFilterMask=gM.prototype.nz=function(){return jn(this.jz)},gM.prototype.set_m_collisionFilterMask=gM.prototype.pz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),zn(e,t)},Object.defineProperty(gM.prototype,"m_collisionFilterMask",{get:gM.prototype.nz,set:gM.prototype.pz}),gM.prototype.__destroy__=function(){Tn(this.jz)},vM.prototype=Object.create(US.prototype),vM.prototype.constructor=vM,vM.prototype.kz=vM,vM.lz={},n.btSoftBodySolver=vM,vM.prototype.__destroy__=function(){gv(this.jz)},bM.prototype=Object.create(US.prototype),bM.prototype.constructor=bM,bM.prototype.kz=bM,bM.lz={},n.RayResultCallback=bM,bM.prototype.hasHit=function(){return!!Dr(this.jz)},bM.prototype.get_m_collisionFilterGroup=bM.prototype.mz=function(){return Or(this.jz)},bM.prototype.set_m_collisionFilterGroup=bM.prototype.oz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Fr(e,t)},Object.defineProperty(bM.prototype,"m_collisionFilterGroup",{get:bM.prototype.mz,set:bM.prototype.oz}),bM.prototype.get_m_collisionFilterMask=bM.prototype.nz=function(){return kr(this.jz)},bM.prototype.set_m_collisionFilterMask=bM.prototype.pz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Nr(e,t)},Object.defineProperty(bM.prototype,"m_collisionFilterMask",{get:bM.prototype.nz,set:bM.prototype.pz}),bM.prototype.get_m_closestHitFraction=bM.prototype.qz=function(){return Pr(this.jz)},bM.prototype.set_m_closestHitFraction=bM.prototype.sz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Hr(e,t)},Object.defineProperty(bM.prototype,"m_closestHitFraction",{get:bM.prototype.qz,set:bM.prototype.sz}),bM.prototype.get_m_collisionObject=bM.prototype.yz=function(){return GS(Br(this.jz),QS)},bM.prototype.set_m_collisionObject=bM.prototype.Gz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ur(e,t)},Object.defineProperty(bM.prototype,"m_collisionObject",{get:bM.prototype.yz,set:bM.prototype.Gz}),bM.prototype.__destroy__=function(){Ir(this.jz)},xM.prototype=Object.create(US.prototype),xM.prototype.constructor=xM,xM.prototype.kz=xM,xM.lz={},n.btMatrix3x3=xM,xM.prototype.setEulerZYX=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),Ef(r,t,e,n)},xM.prototype.getRotation=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),xf(e,t)},xM.prototype.getRow=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(wf(e,t),lM)},xM.prototype.__destroy__=function(){bf(this.jz)},wM.prototype=Object.create(US.prototype),wM.prototype.constructor=wM,wM.prototype.kz=wM,wM.lz={},n.btScalarArray=wM,wM.prototype.size=wM.prototype.size=function(){return Dg(this.jz)},wM.prototype.at=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),Bg(e,t)},wM.prototype.__destroy__=function(){kg(this.jz)},EM.prototype=Object.create(US.prototype),EM.prototype.constructor=EM,EM.prototype.kz=EM,EM.lz={},n.Material=EM,EM.prototype.get_m_kLST=EM.prototype.GB=function(){return dr(this.jz)},EM.prototype.set_m_kLST=EM.prototype.qE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),yr(e,t)},Object.defineProperty(EM.prototype,"m_kLST",{get:EM.prototype.GB,set:EM.prototype.qE}),EM.prototype.get_m_kAST=EM.prototype.FB=function(){return pr(this.jz)},EM.prototype.set_m_kAST=EM.prototype.pE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),mr(e,t)},Object.defineProperty(EM.prototype,"m_kAST",{get:EM.prototype.FB,set:EM.prototype.pE}),EM.prototype.get_m_kVST=EM.prototype.HB=function(){return hr(this.jz)},EM.prototype.set_m_kVST=EM.prototype.rE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),_r(e,t)},Object.defineProperty(EM.prototype,"m_kVST",{get:EM.prototype.HB,set:EM.prototype.rE}),EM.prototype.get_m_flags=EM.prototype.oB=function(){return ur(this.jz)},EM.prototype.set_m_flags=EM.prototype.ZD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),fr(e,t)},Object.defineProperty(EM.prototype,"m_flags",{get:EM.prototype.oB,set:EM.prototype.ZD}),EM.prototype.__destroy__=function(){cr(this.jz)},TM.prototype=Object.create(US.prototype),TM.prototype.constructor=TM,TM.prototype.kz=TM,TM.lz={},n.tNodeArray=TM,TM.prototype.size=TM.prototype.size=function(){return RS(this.jz)},TM.prototype.at=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(zS(e,t),Ej)},TM.prototype.__destroy__=function(){CS(this.jz)},SM.prototype=Object.create(US.prototype),SM.prototype.constructor=SM,SM.prototype.kz=SM,SM.lz={},n.btDispatcherInfo=SM,SM.prototype.get_m_timeStep=SM.prototype.xC=function(){return Eu(this.jz)},SM.prototype.set_m_timeStep=SM.prototype.hF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Pu(e,t)},Object.defineProperty(SM.prototype,"m_timeStep",{get:SM.prototype.xC,set:SM.prototype.hF}),SM.prototype.get_m_stepCount=SM.prototype.oC=function(){return xu(this.jz)},SM.prototype.set_m_stepCount=SM.prototype.ZE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Lu(e,t)},Object.defineProperty(SM.prototype,"m_stepCount",{get:SM.prototype.oC,set:SM.prototype.ZE}),SM.prototype.get_m_dispatchFunc=SM.prototype.fB=function(){return gu(this.jz)},SM.prototype.set_m_dispatchFunc=SM.prototype.QD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),zu(e,t)},Object.defineProperty(SM.prototype,"m_dispatchFunc",{get:SM.prototype.fB,set:SM.prototype.QD}),SM.prototype.get_m_timeOfImpact=SM.prototype.wC=function(){return wu(this.jz)},SM.prototype.set_m_timeOfImpact=SM.prototype.gF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Iu(e,t)},Object.defineProperty(SM.prototype,"m_timeOfImpact",{get:SM.prototype.wC,set:SM.prototype.gF}),SM.prototype.get_m_useContinuous=SM.prototype.zC=function(){return!!Tu(this.jz)},SM.prototype.set_m_useContinuous=SM.prototype.jF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ou(e,t)},Object.defineProperty(SM.prototype,"m_useContinuous",{get:SM.prototype.zC,set:SM.prototype.jF}),SM.prototype.get_m_enableSatConvex=SM.prototype.jB=function(){return!!bu(this.jz)},SM.prototype.set_m_enableSatConvex=SM.prototype.UD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Au(e,t)},Object.defineProperty(SM.prototype,"m_enableSatConvex",{get:SM.prototype.jB,set:SM.prototype.UD}),SM.prototype.get_m_enableSPU=SM.prototype.iB=function(){return!!vu(this.jz)},SM.prototype.set_m_enableSPU=SM.prototype.TD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ru(e,t)},Object.defineProperty(SM.prototype,"m_enableSPU",{get:SM.prototype.iB,set:SM.prototype.TD}),SM.prototype.get_m_useEpa=SM.prototype.BC=function(){return!!Mu(this.jz)},SM.prototype.set_m_useEpa=SM.prototype.lF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Bu(e,t)},Object.defineProperty(SM.prototype,"m_useEpa",{get:SM.prototype.BC,set:SM.prototype.lF}),SM.prototype.get_m_allowedCcdPenetration=SM.prototype.KA=function(){return yu(this.jz)},SM.prototype.set_m_allowedCcdPenetration=SM.prototype.uD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ju(e,t)},Object.defineProperty(SM.prototype,"m_allowedCcdPenetration",{get:SM.prototype.KA,set:SM.prototype.uD}),SM.prototype.get_m_useConvexConservativeDistanceUtil=SM.prototype.AC=function(){return!!Su(this.jz)},SM.prototype.set_m_useConvexConservativeDistanceUtil=SM.prototype.kF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ku(e,t)},Object.defineProperty(SM.prototype,"m_useConvexConservativeDistanceUtil",{get:SM.prototype.AC,set:SM.prototype.kF}),SM.prototype.get_m_convexConservativeDistanceThreshold=SM.prototype.bB=function(){return _u(this.jz)},SM.prototype.set_m_convexConservativeDistanceThreshold=SM.prototype.MD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Cu(e,t)},Object.defineProperty(SM.prototype,"m_convexConservativeDistanceThreshold",{get:SM.prototype.bB,set:SM.prototype.MD}),SM.prototype.__destroy__=function(){mu(this.jz)},MM.prototype=Object.create(US.prototype),MM.prototype.constructor=MM,MM.prototype.kz=MM,MM.lz={},n.btWheelInfoConstructionInfo=MM,MM.prototype.get_m_chassisConnectionCS=MM.prototype.WA=function(){return GS(KE(this.jz),lM)},MM.prototype.set_m_chassisConnectionCS=MM.prototype.GD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),uT(e,t)},Object.defineProperty(MM.prototype,"m_chassisConnectionCS",{get:MM.prototype.WA,set:MM.prototype.GD}),MM.prototype.get_m_wheelDirectionCS=MM.prototype.Wz=function(){return GS(oT(this.jz),lM)},MM.prototype.set_m_wheelDirectionCS=MM.prototype.fA=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),_T(e,t)},Object.defineProperty(MM.prototype,"m_wheelDirectionCS",{get:MM.prototype.Wz,set:MM.prototype.fA}),MM.prototype.get_m_wheelAxleCS=MM.prototype.Vz=function(){return GS(iT(this.jz),lM)},MM.prototype.set_m_wheelAxleCS=MM.prototype.eA=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),yT(e,t)},Object.defineProperty(MM.prototype,"m_wheelAxleCS",{get:MM.prototype.Vz,set:MM.prototype.eA}),MM.prototype.get_m_suspensionRestLength=MM.prototype.tC=function(){return nT(this.jz)},MM.prototype.set_m_suspensionRestLength=MM.prototype.dF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),fT(e,t)},Object.defineProperty(MM.prototype,"m_suspensionRestLength",{get:MM.prototype.tC,set:MM.prototype.dF}),MM.prototype.get_m_maxSuspensionTravelCm=MM.prototype.Cz=function(){return eT(this.jz)},MM.prototype.set_m_maxSuspensionTravelCm=MM.prototype.Kz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),hT(e,t)},Object.defineProperty(MM.prototype,"m_maxSuspensionTravelCm",{get:MM.prototype.Cz,set:MM.prototype.Kz}),MM.prototype.get_m_wheelRadius=MM.prototype.HC=function(){return aT(this.jz)},MM.prototype.set_m_wheelRadius=MM.prototype.rF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),gT(e,t)},Object.defineProperty(MM.prototype,"m_wheelRadius",{get:MM.prototype.HC,set:MM.prototype.rF}),MM.prototype.get_m_suspensionStiffness=MM.prototype.Dz=function(){return rT(this.jz)},MM.prototype.set_m_suspensionStiffness=MM.prototype.Lz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),mT(e,t)},Object.defineProperty(MM.prototype,"m_suspensionStiffness",{get:MM.prototype.Dz,set:MM.prototype.Lz}),MM.prototype.get_m_wheelsDampingCompression=MM.prototype.Xz=function(){return sT(this.jz)},MM.prototype.set_m_wheelsDampingCompression=MM.prototype.gA=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),vT(e,t)},Object.defineProperty(MM.prototype,"m_wheelsDampingCompression",{get:MM.prototype.Xz,set:MM.prototype.gA}),MM.prototype.get_m_wheelsDampingRelaxation=MM.prototype.Yz=function(){return lT(this.jz)},MM.prototype.set_m_wheelsDampingRelaxation=MM.prototype.hA=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),bT(e,t)},Object.defineProperty(MM.prototype,"m_wheelsDampingRelaxation",{get:MM.prototype.Yz,set:MM.prototype.hA}),MM.prototype.get_m_frictionSlip=MM.prototype.zz=function(){return $E(this.jz)},MM.prototype.set_m_frictionSlip=MM.prototype.Hz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),pT(e,t)},Object.defineProperty(MM.prototype,"m_frictionSlip",{get:MM.prototype.zz,set:MM.prototype.Hz}),MM.prototype.get_m_maxSuspensionForce=MM.prototype.Bz=function(){return tT(this.jz)},MM.prototype.set_m_maxSuspensionForce=MM.prototype.Jz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),dT(e,t)},Object.defineProperty(MM.prototype,"m_maxSuspensionForce",{get:MM.prototype.Bz,set:MM.prototype.Jz}),MM.prototype.get_m_bIsFrontWheel=MM.prototype.Pz=function(){return!!JE(this.jz)},MM.prototype.set_m_bIsFrontWheel=MM.prototype.Zz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),cT(e,t)},Object.defineProperty(MM.prototype,"m_bIsFrontWheel",{get:MM.prototype.Pz,set:MM.prototype.Zz}),MM.prototype.__destroy__=function(){ZE(this.jz)},jM.prototype=Object.create(hM.prototype),jM.prototype.constructor=jM,jM.prototype.kz=jM,jM.lz={},n.btConvexTriangleMeshShape=jM,jM.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Nl(e,t)},jM.prototype.getLocalScaling=function(){return GS(Hl(this.jz),lM)},jM.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Dl(n,t,e)},jM.prototype.setMargin=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ul(e,t)},jM.prototype.getMargin=function(){return Fl(this.jz)},jM.prototype.__destroy__=function(){Ol(this.jz)},CM.prototype=Object.create(US.prototype),CM.prototype.constructor=CM,CM.prototype.kz=CM,CM.lz={},n.btBroadphaseInterface=CM,CM.prototype.getOverlappingPairCache=function(){return GS(wi(this.jz),Rj)},CM.prototype.__destroy__=function(){xi(this.jz)},zM.prototype=Object.create(US.prototype),zM.prototype.constructor=zM,zM.prototype.kz=zM,zM.lz={},n.btRigidBodyConstructionInfo=zM,zM.prototype.get_m_linearDamping=zM.prototype.IB=function(){return c_(this.jz)},zM.prototype.set_m_linearDamping=zM.prototype.sE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),x_(e,t)},Object.defineProperty(zM.prototype,"m_linearDamping",{get:zM.prototype.IB,set:zM.prototype.sE}),zM.prototype.get_m_angularDamping=zM.prototype.MA=function(){return a_(this.jz)},zM.prototype.set_m_angularDamping=zM.prototype.wD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),g_(e,t)},Object.defineProperty(zM.prototype,"m_angularDamping",{get:zM.prototype.MA,set:zM.prototype.wD}),zM.prototype.get_m_friction=zM.prototype.pB=function(){return l_(this.jz)},zM.prototype.set_m_friction=zM.prototype.$D=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),b_(e,t)},Object.defineProperty(zM.prototype,"m_friction",{get:zM.prototype.pB,set:zM.prototype.$D}),zM.prototype.get_m_rollingFriction=zM.prototype.gC=function(){return d_(this.jz)},zM.prototype.set_m_rollingFriction=zM.prototype.RE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),T_(e,t)},Object.defineProperty(zM.prototype,"m_rollingFriction",{get:zM.prototype.gC,set:zM.prototype.RE}),zM.prototype.get_m_restitution=zM.prototype.eC=function(){return p_(this.jz)},zM.prototype.set_m_restitution=zM.prototype.PE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),E_(e,t)},Object.defineProperty(zM.prototype,"m_restitution",{get:zM.prototype.eC,set:zM.prototype.PE}),zM.prototype.get_m_linearSleepingThreshold=zM.prototype.JB=function(){return u_(this.jz)},zM.prototype.set_m_linearSleepingThreshold=zM.prototype.tE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),w_(e,t)},Object.defineProperty(zM.prototype,"m_linearSleepingThreshold",{get:zM.prototype.JB,set:zM.prototype.tE}),zM.prototype.get_m_angularSleepingThreshold=zM.prototype.NA=function(){return s_(this.jz)},zM.prototype.set_m_angularSleepingThreshold=zM.prototype.xD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),v_(e,t)},Object.defineProperty(zM.prototype,"m_angularSleepingThreshold",{get:zM.prototype.NA,set:zM.prototype.xD}),zM.prototype.get_m_additionalDamping=zM.prototype.HA=function(){return!!i_(this.jz)},zM.prototype.set_m_additionalDamping=zM.prototype.rD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),y_(e,t)},Object.defineProperty(zM.prototype,"m_additionalDamping",{get:zM.prototype.HA,set:zM.prototype.rD}),zM.prototype.get_m_additionalDampingFactor=zM.prototype.IA=function(){return r_(this.jz)},zM.prototype.set_m_additionalDampingFactor=zM.prototype.sD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),m_(e,t)},Object.defineProperty(zM.prototype,"m_additionalDampingFactor",{get:zM.prototype.IA,set:zM.prototype.sD}),zM.prototype.get_m_additionalLinearDampingThresholdSqr=zM.prototype.JA=function(){return o_(this.jz)},zM.prototype.set_m_additionalLinearDampingThresholdSqr=zM.prototype.tD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),__(e,t)},Object.defineProperty(zM.prototype,"m_additionalLinearDampingThresholdSqr",{get:zM.prototype.JA,set:zM.prototype.tD}),zM.prototype.get_m_additionalAngularDampingThresholdSqr=zM.prototype.GA=function(){return n_(this.jz)},zM.prototype.set_m_additionalAngularDampingThresholdSqr=zM.prototype.qD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),f_(e,t)},Object.defineProperty(zM.prototype,"m_additionalAngularDampingThresholdSqr",{get:zM.prototype.GA,set:zM.prototype.qD}),zM.prototype.get_m_additionalAngularDampingFactor=zM.prototype.FA=function(){return e_(this.jz)},zM.prototype.set_m_additionalAngularDampingFactor=zM.prototype.pD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),h_(e,t)},Object.defineProperty(zM.prototype,"m_additionalAngularDampingFactor",{get:zM.prototype.FA,set:zM.prototype.pD}),zM.prototype.__destroy__=function(){Ky(this.jz)},RM.prototype=Object.create(US.prototype),RM.prototype.constructor=RM,RM.prototype.kz=RM,RM.lz={},n.btCollisionConfiguration=RM,RM.prototype.__destroy__=function(){ko(this.jz)},AM.prototype=Object.create(US.prototype),AM.prototype.constructor=AM,AM.prototype.kz=AM,AM.lz={},n.btPersistentManifold=AM,AM.prototype.getBody0=function(){return GS(gm(this.jz),QS)},AM.prototype.getBody1=function(){return GS(vm(this.jz),QS)},AM.prototype.getNumContacts=function(){return xm(this.jz)},AM.prototype.getContactPoint=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(bm(e,t),Uj)},AM.prototype.__destroy__=function(){ym(this.jz)},LM.prototype=Object.create(YS.prototype),LM.prototype.constructor=LM,LM.prototype.kz=LM,LM.lz={},n.btCompoundShape=LM,LM.prototype.addChildShape=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Qa(n,t,e)},LM.prototype.removeChildShape=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),is(e,t)},LM.prototype.removeChildShapeByIndex=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),rs(e,t)},LM.prototype.getNumChildShapes=function(){return ns(this.jz)},LM.prototype.getChildShape=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS($a(e,t),YS)},LM.prototype.updateChildTransform=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),void 0===n?ss(r,t,e):ls(r,t,e,n)},LM.prototype.setMargin=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),as(e,t)},LM.prototype.getMargin=function(){return es(this.jz)},LM.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),os(e,t)},LM.prototype.getLocalScaling=function(){return GS(ts(this.jz),lM)},LM.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Ka(n,t,e)},LM.prototype.__destroy__=function(){Ya(this.jz)},IM.prototype=Object.create(bM.prototype),IM.prototype.constructor=IM,IM.prototype.kz=IM,IM.lz={},n.AllHitsRayResultCallback=IM,IM.prototype.hasHit=function(){return!!ht(this.jz)},IM.prototype.get_m_collisionObjects=IM.prototype.ZA=function(){return GS(st(this.jz),Hj)},IM.prototype.set_m_collisionObjects=IM.prototype.JD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),gt(e,t)},Object.defineProperty(IM.prototype,"m_collisionObjects",{get:IM.prototype.ZA,set:IM.prototype.JD}),IM.prototype.get_m_rayFromWorld=IM.prototype.Tz=function(){return GS(pt(this.jz),lM)},IM.prototype.set_m_rayFromWorld=IM.prototype.cA=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),wt(e,t)},Object.defineProperty(IM.prototype,"m_rayFromWorld",{get:IM.prototype.Tz,set:IM.prototype.cA}),IM.prototype.get_m_rayToWorld=IM.prototype.Uz=function(){return GS(dt(this.jz),lM)},IM.prototype.set_m_rayToWorld=IM.prototype.dA=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Et(e,t)},Object.defineProperty(IM.prototype,"m_rayToWorld",{get:IM.prototype.Uz,set:IM.prototype.dA}),IM.prototype.get_m_hitNormalWorld=IM.prototype.uz=function(){return GS(ct(this.jz),cj)},IM.prototype.set_m_hitNormalWorld=IM.prototype.wz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),bt(e,t)},Object.defineProperty(IM.prototype,"m_hitNormalWorld",{get:IM.prototype.uz,set:IM.prototype.wz}),IM.prototype.get_m_hitPointWorld=IM.prototype.vz=function(){return GS(ut(this.jz),cj)},IM.prototype.set_m_hitPointWorld=IM.prototype.xz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),xt(e,t)},Object.defineProperty(IM.prototype,"m_hitPointWorld",{get:IM.prototype.vz,set:IM.prototype.xz}),IM.prototype.get_m_hitFractions=IM.prototype.vB=function(){return GS(lt(this.jz),wM)},IM.prototype.set_m_hitFractions=IM.prototype.fE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),vt(e,t)},Object.defineProperty(IM.prototype,"m_hitFractions",{get:IM.prototype.vB,set:IM.prototype.fE}),IM.prototype.get_m_collisionFilterGroup=IM.prototype.mz=function(){return it(this.jz)},IM.prototype.set_m_collisionFilterGroup=IM.prototype.oz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),mt(e,t)},Object.defineProperty(IM.prototype,"m_collisionFilterGroup",{get:IM.prototype.mz,set:IM.prototype.oz}),IM.prototype.get_m_collisionFilterMask=IM.prototype.nz=function(){return ot(this.jz)},IM.prototype.set_m_collisionFilterMask=IM.prototype.pz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),yt(e,t)},Object.defineProperty(IM.prototype,"m_collisionFilterMask",{get:IM.prototype.nz,set:IM.prototype.pz}),IM.prototype.get_m_closestHitFraction=IM.prototype.qz=function(){return rt(this.jz)},IM.prototype.set_m_closestHitFraction=IM.prototype.sz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ft(e,t)},Object.defineProperty(IM.prototype,"m_closestHitFraction",{get:IM.prototype.qz,set:IM.prototype.sz}),IM.prototype.get_m_collisionObject=IM.prototype.yz=function(){return GS(at(this.jz),QS)},IM.prototype.set_m_collisionObject=IM.prototype.Gz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),_t(e,t)},Object.defineProperty(IM.prototype,"m_collisionObject",{get:IM.prototype.yz,set:IM.prototype.Gz}),IM.prototype.__destroy__=function(){nt(this.jz)},PM.prototype=Object.create(US.prototype),PM.prototype.constructor=PM,PM.prototype.kz=PM,PM.lz={},n.tMaterialArray=PM,PM.prototype.size=PM.prototype.size=function(){return jS(this.jz)},PM.prototype.at=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(MS(e,t),EM)},PM.prototype.__destroy__=function(){SS(this.jz)},OM.prototype=Object.create(cM.prototype),OM.prototype.constructor=OM,OM.prototype.kz=OM,OM.lz={},n.btDefaultVehicleRaycaster=OM,OM.prototype.castRay=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),zc(r,t,e,n)},OM.prototype.__destroy__=function(){jc(this.jz)},kM.prototype=Object.create($S.prototype),kM.prototype.constructor=kM,kM.prototype.kz=kM,kM.lz={},n.btEmptyShape=kM,kM.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),fp(e,t)},kM.prototype.getLocalScaling=function(){return GS(hp(this.jz),lM)},kM.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),dp(n,t,e)},kM.prototype.__destroy__=function(){up(this.jz)},BM.prototype=Object.create(US.prototype),BM.prototype.constructor=BM,BM.prototype.kz=BM,BM.lz={},n.btConstraintSetting=BM,BM.prototype.get_m_tau=BM.prototype.vC=function(){return Js(this.jz)},BM.prototype.set_m_tau=BM.prototype.fF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),tl(e,t)},Object.defineProperty(BM.prototype,"m_tau",{get:BM.prototype.vC,set:BM.prototype.fF}),BM.prototype.get_m_damping=BM.prototype.dB=function(){return Qs(this.jz)},BM.prototype.set_m_damping=BM.prototype.OD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ks(e,t)},Object.defineProperty(BM.prototype,"m_damping",{get:BM.prototype.dB,set:BM.prototype.OD}),BM.prototype.get_m_impulseClamp=BM.prototype.BB=function(){return Zs(this.jz)},BM.prototype.set_m_impulseClamp=BM.prototype.lE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),$s(e,t)},Object.defineProperty(BM.prototype,"m_impulseClamp",{get:BM.prototype.BB,set:BM.prototype.lE}),BM.prototype.__destroy__=function(){Xs(this.jz)},DM.prototype=Object.create(US.prototype),DM.prototype.constructor=DM,DM.prototype.kz=DM,DM.lz={},n.LocalShapeInfo=DM,DM.prototype.get_m_shapePart=DM.prototype.jC=function(){return or(this.jz)},DM.prototype.set_m_shapePart=DM.prototype.UE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),sr(e,t)},Object.defineProperty(DM.prototype,"m_shapePart",{get:DM.prototype.jC,set:DM.prototype.UE}),DM.prototype.get_m_triangleIndex=DM.prototype.yC=function(){return ar(this.jz)},DM.prototype.set_m_triangleIndex=DM.prototype.iF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),lr(e,t)},Object.defineProperty(DM.prototype,"m_triangleIndex",{get:DM.prototype.yC,set:DM.prototype.iF}),DM.prototype.__destroy__=function(){ir(this.jz)},HM.prototype=Object.create(QS.prototype),HM.prototype.constructor=HM,HM.prototype.kz=HM,HM.lz={},n.btRigidBody=HM,HM.prototype.getCenterOfMassTransform=function(){return GS(q_(this.jz),Pj)},HM.prototype.setCenterOfMassTransform=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),yg(e,t)},HM.prototype.setSleepingThresholds=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Rg(n,t,e)},HM.prototype.getLinearDamping=function(){return J_(this.jz)},HM.prototype.getAngularDamping=function(){return N_(this.jz)},HM.prototype.setDamping=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),bg(n,t,e)},HM.prototype.setMassProps=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Mg(n,t,e)},HM.prototype.getLinearFactor=function(){return GS(K_(this.jz),lM)},HM.prototype.setLinearFactor=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Tg(e,t)},HM.prototype.applyTorque=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),k_(e,t)},HM.prototype.applyLocalTorque=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),P_(e,t)},HM.prototype.applyForce=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),A_(n,t,e)},HM.prototype.applyCentralForce=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),C_(e,t)},HM.prototype.applyCentralLocalForce=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),R_(e,t)},HM.prototype.applyTorqueImpulse=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),O_(e,t)},HM.prototype.applyImpulse=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),I_(n,t,e)},HM.prototype.applyCentralImpulse=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),z_(e,t)},HM.prototype.updateInertiaTensor=function(){Og(this.jz)},HM.prototype.getLinearVelocity=function(){return GS($_(this.jz),lM)},HM.prototype.getAngularVelocity=function(){return GS(V_(this.jz),lM)},HM.prototype.setLinearVelocity=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Sg(e,t)},HM.prototype.setAngularVelocity=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),dg(e,t)},HM.prototype.getMotionState=function(){return GS(tg(this.jz),_M)},HM.prototype.setMotionState=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),jg(e,t)},HM.prototype.getAngularFactor=function(){return GS(U_(this.jz),lM)},HM.prototype.setAngularFactor=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),pg(e,t)},HM.prototype.upcast=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(Pg(e,t),HM)},HM.prototype.getAabb=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),F_(n,t,e)},HM.prototype.applyGravity=function(){L_(this.jz)},HM.prototype.getGravity=function(){return GS(Z_(this.jz),lM)},HM.prototype.setGravity=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),wg(e,t)},HM.prototype.getBroadphaseProxy=function(){return GS(W_(this.jz),Wj)},HM.prototype.clearForces=function(){D_(this.jz)},HM.prototype.setAnisotropicFriction=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),hg(n,t,e)},HM.prototype.getCollisionShape=function(){return GS(Y_(this.jz),YS)},HM.prototype.setContactProcessingThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),vg(e,t)},HM.prototype.setActivationState=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ug(e,t)},HM.prototype.forceActivationState=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),H_(e,t)},HM.prototype.activate=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),void 0===t?M_(e):j_(e,t)},HM.prototype.isActive=function(){return!!ag(this.jz)},HM.prototype.isKinematicObject=function(){return!!sg(this.jz)},HM.prototype.isStaticObject=function(){return!!lg(this.jz)},HM.prototype.isStaticOrKinematicObject=function(){return!!cg(this.jz)},HM.prototype.getRestitution=function(){return eg(this.jz)},HM.prototype.getFriction=function(){return Q_(this.jz)},HM.prototype.getRollingFriction=function(){return ng(this.jz)},HM.prototype.setRestitution=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Cg(e,t)},HM.prototype.setFriction=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),xg(e,t)},HM.prototype.setRollingFriction=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),zg(e,t)},HM.prototype.getWorldTransform=function(){return GS(og(this.jz),Pj)},HM.prototype.getCollisionFlags=function(){return X_(this.jz)},HM.prototype.setCollisionFlags=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),_g(e,t)},HM.prototype.setWorldTransform=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ig(e,t)},HM.prototype.setCollisionShape=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),gg(e,t)},HM.prototype.setCcdMotionThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),fg(e,t)},HM.prototype.setCcdSweptSphereRadius=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),mg(e,t)},HM.prototype.getUserIndex=function(){return rg(this.jz)},HM.prototype.setUserIndex=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ag(e,t)},HM.prototype.getUserPointer=function(){return GS(ig(this.jz),qM)},HM.prototype.setUserPointer=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Lg(e,t)},HM.prototype.getBroadphaseHandle=function(){return GS(G_(this.jz),Wj)},HM.prototype.setIgnoreCollisionCheck=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Eg(n,t,e)},HM.prototype.__destroy__=function(){S_(this.jz)},FM.prototype=Object.create(US.prototype),FM.prototype.constructor=FM,FM.prototype.kz=FM,FM.lz={},n.btIndexedMeshArray=FM,FM.prototype.size=FM.prototype.size=function(){return Mh(this.jz)},FM.prototype.at=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(Sh(e,t),Aj)},FM.prototype.__destroy__=function(){Th(this.jz)},NM.prototype=Object.create(US.prototype),NM.prototype.constructor=NM,NM.prototype.kz=NM,NM.lz={},n.btDbvtBroadphase=NM,NM.prototype.__destroy__=function(){uc(this.jz)},UM.prototype=Object.create($S.prototype),UM.prototype.constructor=UM,UM.prototype.kz=UM,UM.lz={},n.btHeightfieldTerrainShape=UM,UM.prototype.setMargin=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Zd(e,t)},UM.prototype.getMargin=function(){return Yd(this.jz)},UM.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Qd(e,t)},UM.prototype.getLocalScaling=function(){return GS(Xd(this.jz),lM)},UM.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),qd(n,t,e)},UM.prototype.__destroy__=function(){Gd(this.jz)},VM.prototype=Object.create(vM.prototype),VM.prototype.constructor=VM,VM.prototype.kz=VM,VM.lz={},n.btDefaultSoftBodySolver=VM,VM.prototype.__destroy__=function(){Sc(this.jz)},GM.prototype=Object.create(fM.prototype),GM.prototype.constructor=GM,GM.prototype.kz=GM,GM.lz={},n.btCollisionDispatcher=GM,GM.prototype.getNumManifolds=function(){return Fo(this.jz)},GM.prototype.getManifoldByIndexInternal=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(Ho(e,t),AM)},GM.prototype.__destroy__=function(){Bo(this.jz)},WM.prototype=Object.create(US.prototype),WM.prototype.constructor=WM,WM.prototype.kz=WM,WM.lz={},n.btAxisSweep3=WM,WM.prototype.__destroy__=function(){ci(this.jz)},qM.prototype=Object.create(US.prototype),qM.prototype.constructor=qM,qM.prototype.kz=qM,qM.lz={},n.VoidPtr=qM,qM.prototype.__destroy__=function(){ai(this.jz)},XM.prototype=Object.create(US.prototype),XM.prototype.constructor=XM,XM.prototype.kz=XM,XM.lz={},n.btSoftBodyWorldInfo=XM,XM.prototype.get_air_density=XM.prototype.jA=function(){return xv(this.jz)},XM.prototype.set_air_density=XM.prototype.UC=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),zv(e,t)},Object.defineProperty(XM.prototype,"air_density",{get:XM.prototype.jA,set:XM.prototype.UC}),XM.prototype.get_water_density=XM.prototype.RC=function(){return Mv(this.jz)},XM.prototype.set_water_density=XM.prototype.BF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Pv(e,t)},Object.defineProperty(XM.prototype,"water_density",{get:XM.prototype.RC,set:XM.prototype.BF}),XM.prototype.get_water_offset=XM.prototype.TC=function(){return Cv(this.jz)},XM.prototype.set_water_offset=XM.prototype.DF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),kv(e,t)},Object.defineProperty(XM.prototype,"water_offset",{get:XM.prototype.TC,set:XM.prototype.DF}),XM.prototype.get_m_maxDisplacement=XM.prototype.PB=function(){return Sv(this.jz)},XM.prototype.set_m_maxDisplacement=XM.prototype.zE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Iv(e,t)},Object.defineProperty(XM.prototype,"m_maxDisplacement",{get:XM.prototype.PB,set:XM.prototype.zE}),XM.prototype.get_water_normal=XM.prototype.SC=function(){return GS(jv(this.jz),lM)},XM.prototype.set_water_normal=XM.prototype.CF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ov(e,t)},Object.defineProperty(XM.prototype,"water_normal",{get:XM.prototype.SC,set:XM.prototype.CF}),XM.prototype.get_m_broadphase=XM.prototype.RA=function(){return GS(wv(this.jz),CM)},XM.prototype.set_m_broadphase=XM.prototype.BD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Rv(e,t)},Object.defineProperty(XM.prototype,"m_broadphase",{get:XM.prototype.RA,set:XM.prototype.BD}),XM.prototype.get_m_dispatcher=XM.prototype.Sz=function(){return GS(Ev(this.jz),fM)},XM.prototype.set_m_dispatcher=XM.prototype.bA=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Av(e,t)},Object.defineProperty(XM.prototype,"m_dispatcher",{get:XM.prototype.Sz,set:XM.prototype.bA}),XM.prototype.get_m_gravity=XM.prototype.rB=function(){return GS(Tv(this.jz),lM)},XM.prototype.set_m_gravity=XM.prototype.bE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Lv(e,t)},Object.defineProperty(XM.prototype,"m_gravity",{get:XM.prototype.rB,set:XM.prototype.bE}),XM.prototype.__destroy__=function(){vv(this.jz)},YM.prototype=Object.create(JS.prototype),YM.prototype.constructor=YM,YM.prototype.kz=YM,YM.lz={},n.btConeTwistConstraint=YM,YM.prototype.setLimit=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Ds(n,t,e)},YM.prototype.setAngularOnly=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Os(e,t)},YM.prototype.setDamping=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Bs(e,t)},YM.prototype.enableMotor=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ls(e,t)},YM.prototype.setMaxMotorImpulse=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Fs(e,t)},YM.prototype.setMaxMotorImpulseNormalized=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Hs(e,t)},YM.prototype.setMotorTarget=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Us(e,t)},YM.prototype.setMotorTargetInConstraintSpace=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ns(e,t)},YM.prototype.enableFeedback=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),As(e,t)},YM.prototype.getBreakingImpulseThreshold=function(){return Is(this.jz)},YM.prototype.setBreakingImpulseThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ks(e,t)},YM.prototype.getParam=function(t,e){var n=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Ps(n,t,e)},YM.prototype.setParam=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),Vs(r,t,e,n)},YM.prototype.__destroy__=function(){Cs(this.jz)},QM.prototype=Object.create(JS.prototype),QM.prototype.constructor=QM,QM.prototype.kz=QM,QM.lz={},n.btHingeConstraint=QM,QM.prototype.setLimit=function(t,e,n,r,i){var o=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),void 0===n?uh(o,t,e):void 0===r?ph(o,t,e,n):void 0===i?dh(o,t,e,n,r):hh(o,t,e,n,r,i)},QM.prototype.enableAngularMotor=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),rh(r,t,e,n)},QM.prototype.setAngularOnly=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),lh(e,t)},QM.prototype.enableMotor=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),oh(e,t)},QM.prototype.setMaxMotorImpulse=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),fh(e,t)},QM.prototype.setMotorTarget=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),mh(n,t,e)},QM.prototype.enableFeedback=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ih(e,t)},QM.prototype.getBreakingImpulseThreshold=function(){return ah(this.jz)},QM.prototype.setBreakingImpulseThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ch(e,t)},QM.prototype.getParam=function(t,e){var n=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),sh(n,t,e)},QM.prototype.setParam=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),yh(r,t,e,n)},QM.prototype.__destroy__=function(){Jd(this.jz)},ZM.prototype=Object.create(aM.prototype),ZM.prototype.constructor=ZM,ZM.prototype.kz=ZM,ZM.lz={},n.btConeShapeZ=ZM,ZM.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ws(e,t)},ZM.prototype.getLocalScaling=function(){return GS(xs(this.jz),lM)},ZM.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),bs(n,t,e)},ZM.prototype.__destroy__=function(){gs(this.jz)},JM.prototype=Object.create(aM.prototype),JM.prototype.constructor=JM,JM.prototype.kz=JM,JM.lz={},n.btConeShapeX=JM,JM.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),_s(e,t)},JM.prototype.getLocalScaling=function(){return GS(ys(this.jz),lM)},JM.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),ms(n,t,e)},JM.prototype.__destroy__=function(){hs(this.jz)},KM.prototype=Object.create(yM.prototype),KM.prototype.constructor=KM,KM.prototype.kz=KM,KM.lz={},n.btTriangleMesh=KM,KM.prototype.addTriangle=function(t,e,n,r){var i=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),void 0===r?Rw(i,t,e,n):Aw(i,t,e,n,r)},KM.prototype.findOrAddVertex=function(t,e){var n=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Ow(n,t,e)},KM.prototype.addIndex=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),zw(e,t)},KM.prototype.getIndexedMeshArray=function(){return GS(kw(this.jz),FM)},KM.prototype.setScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Bw(e,t)},KM.prototype.__destroy__=function(){Cw(this.jz)},$M.prototype=Object.create(YS.prototype),$M.prototype.constructor=$M,$M.prototype.kz=$M,$M.lz={},n.btConvexHullShape=$M,$M.prototype.addPoint=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),void 0===e?ul(n,t):pl(n,t,e)},$M.prototype.setMargin=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),El(e,t)},$M.prototype.getMargin=function(){return gl(this.jz)},$M.prototype.getNumVertices=function(){return vl(this.jz)},$M.prototype.initializePolyhedralFeatures=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),!!bl(e,t)},$M.prototype.recalcLocalAabb=function(){xl(this.jz)},$M.prototype.getConvexPolyhedron=function(){return GS(yl(this.jz),fj)},$M.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),wl(e,t)},$M.prototype.getLocalScaling=function(){return GS(_l(this.jz),lM)},$M.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),ml(n,t,e)},$M.prototype.__destroy__=function(){cl(this.jz)},tj.prototype=Object.create(US.prototype),tj.prototype.constructor=tj,tj.prototype.kz=tj,tj.lz={},n.btVehicleTuning=tj,tj.prototype.get_m_suspensionStiffness=tj.prototype.Dz=function(){return VE(this.jz)},tj.prototype.set_m_suspensionStiffness=tj.prototype.Lz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),QE(e,t)},Object.defineProperty(tj.prototype,"m_suspensionStiffness",{get:tj.prototype.Dz,set:tj.prototype.Lz}),tj.prototype.get_m_suspensionCompression=tj.prototype.pC=function(){return NE(this.jz)},tj.prototype.set_m_suspensionCompression=tj.prototype.$E=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),XE(e,t)},Object.defineProperty(tj.prototype,"m_suspensionCompression",{get:tj.prototype.pC,set:tj.prototype.$E}),tj.prototype.get_m_suspensionDamping=tj.prototype.qC=function(){return UE(this.jz)},tj.prototype.set_m_suspensionDamping=tj.prototype.aF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),YE(e,t)},Object.defineProperty(tj.prototype,"m_suspensionDamping",{get:tj.prototype.qC,set:tj.prototype.aF}),tj.prototype.get_m_maxSuspensionTravelCm=tj.prototype.Cz=function(){return FE(this.jz)},tj.prototype.set_m_maxSuspensionTravelCm=tj.prototype.Kz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),qE(e,t)},Object.defineProperty(tj.prototype,"m_maxSuspensionTravelCm",{get:tj.prototype.Cz,set:tj.prototype.Kz}),tj.prototype.get_m_frictionSlip=tj.prototype.zz=function(){return DE(this.jz)},tj.prototype.set_m_frictionSlip=tj.prototype.Hz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),GE(e,t)},Object.defineProperty(tj.prototype,"m_frictionSlip",{get:tj.prototype.zz,set:tj.prototype.Hz}),tj.prototype.get_m_maxSuspensionForce=tj.prototype.Bz=function(){return HE(this.jz)},tj.prototype.set_m_maxSuspensionForce=tj.prototype.Jz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),WE(e,t)},Object.defineProperty(tj.prototype,"m_maxSuspensionForce",{get:tj.prototype.Bz,set:tj.prototype.Jz}),ej.prototype=Object.create(US.prototype),ej.prototype.constructor=ej,ej.prototype.kz=ej,ej.lz={},n.btCollisionObjectWrapper=ej,ej.prototype.getWorldTransform=function(){return GS(Vo(this.jz),Pj)},ej.prototype.getCollisionObject=function(){return GS(No(this.jz),QS)},ej.prototype.getCollisionShape=function(){return GS(Uo(this.jz),YS)},nj.prototype=Object.create(US.prototype),nj.prototype.constructor=nj,nj.prototype.kz=nj,nj.lz={},n.btShapeHull=nj,nj.prototype.buildHull=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),!!Vg(e,t)},nj.prototype.numVertices=function(){return Wg(this.jz)},nj.prototype.getVertexPointer=function(){return GS(Gg(this.jz),lM)},nj.prototype.__destroy__=function(){Ng(this.jz)},rj.prototype=Object.create(_M.prototype),rj.prototype.constructor=rj,rj.prototype.kz=rj,rj.lz={},n.btDefaultMotionState=rj,rj.prototype.getWorldTransform=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),xc(e,t)},rj.prototype.setWorldTransform=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ec(e,t)},rj.prototype.get_m_graphicsWorldTrans=rj.prototype.qB=function(){return GS(wc(this.jz),Pj)},rj.prototype.set_m_graphicsWorldTrans=rj.prototype.aE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Tc(e,t)},Object.defineProperty(rj.prototype,"m_graphicsWorldTrans",{get:rj.prototype.qB,set:rj.prototype.aE}),rj.prototype.__destroy__=function(){_c(this.jz)},ij.prototype=Object.create(US.prototype),ij.prototype.constructor=ij,ij.prototype.kz=ij,ij.lz={},n.btWheelInfo=ij,ij.prototype.getSuspensionRestLength=function(){return ET(this.jz)},ij.prototype.updateWheel=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),gS(n,t,e)},ij.prototype.get_m_suspensionStiffness=ij.prototype.Dz=function(){return FT(this.jz)},ij.prototype.set_m_suspensionStiffness=ij.prototype.Lz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),uS(e,t)},Object.defineProperty(ij.prototype,"m_suspensionStiffness",{get:ij.prototype.Dz,set:ij.prototype.Lz}),ij.prototype.get_m_frictionSlip=ij.prototype.zz=function(){return RT(this.jz)},ij.prototype.set_m_frictionSlip=ij.prototype.Hz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),tS(e,t)},Object.defineProperty(ij.prototype,"m_frictionSlip",{get:ij.prototype.zz,set:ij.prototype.Hz}),ij.prototype.get_m_engineForce=ij.prototype.kB=function(){return zT(this.jz)},ij.prototype.set_m_engineForce=ij.prototype.VD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),$T(e,t)},Object.defineProperty(ij.prototype,"m_engineForce",{get:ij.prototype.kB,set:ij.prototype.VD}),ij.prototype.get_m_rollInfluence=ij.prototype.fC=function(){return PT(this.jz)},ij.prototype.set_m_rollInfluence=ij.prototype.QE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),iS(e,t)},Object.defineProperty(ij.prototype,"m_rollInfluence",{get:ij.prototype.fC,set:ij.prototype.QE}),ij.prototype.get_m_suspensionRestLength1=ij.prototype.uC=function(){return HT(this.jz)},ij.prototype.set_m_suspensionRestLength1=ij.prototype.eF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),cS(e,t)},Object.defineProperty(ij.prototype,"m_suspensionRestLength1",{get:ij.prototype.uC,set:ij.prototype.eF}),ij.prototype.get_m_wheelsRadius=ij.prototype.IC=function(){return WT(this.jz)},ij.prototype.set_m_wheelsRadius=ij.prototype.sF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),mS(e,t)},Object.defineProperty(ij.prototype,"m_wheelsRadius",{get:ij.prototype.IC,set:ij.prototype.sF}),ij.prototype.get_m_wheelsDampingCompression=ij.prototype.Xz=function(){return VT(this.jz)},ij.prototype.set_m_wheelsDampingCompression=ij.prototype.gA=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),hS(e,t)},Object.defineProperty(ij.prototype,"m_wheelsDampingCompression",{get:ij.prototype.Xz,set:ij.prototype.gA}),ij.prototype.get_m_wheelsDampingRelaxation=ij.prototype.Yz=function(){return GT(this.jz)},ij.prototype.set_m_wheelsDampingRelaxation=ij.prototype.hA=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),fS(e,t)},Object.defineProperty(ij.prototype,"m_wheelsDampingRelaxation",{get:ij.prototype.Yz,set:ij.prototype.hA}),ij.prototype.get_m_steering=ij.prototype.nC=function(){return BT(this.jz)},ij.prototype.set_m_steering=ij.prototype.YE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),sS(e,t)},Object.defineProperty(ij.prototype,"m_steering",{get:ij.prototype.nC,set:ij.prototype.YE}),ij.prototype.get_m_maxSuspensionForce=ij.prototype.Bz=function(){return AT(this.jz)},ij.prototype.set_m_maxSuspensionForce=ij.prototype.Jz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),eS(e,t)},Object.defineProperty(ij.prototype,"m_maxSuspensionForce",{get:ij.prototype.Bz,set:ij.prototype.Jz}),ij.prototype.get_m_maxSuspensionTravelCm=ij.prototype.Cz=function(){return LT(this.jz)},ij.prototype.set_m_maxSuspensionTravelCm=ij.prototype.Kz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),nS(e,t)},Object.defineProperty(ij.prototype,"m_maxSuspensionTravelCm",{get:ij.prototype.Cz,set:ij.prototype.Kz}),ij.prototype.get_m_wheelsSuspensionForce=ij.prototype.JC=function(){return qT(this.jz)},ij.prototype.set_m_wheelsSuspensionForce=ij.prototype.tF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),yS(e,t)},Object.defineProperty(ij.prototype,"m_wheelsSuspensionForce",{get:ij.prototype.JC,set:ij.prototype.tF}),ij.prototype.get_m_bIsFrontWheel=ij.prototype.Pz=function(){return!!TT(this.jz)},ij.prototype.set_m_bIsFrontWheel=ij.prototype.Zz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),YT(e,t)},Object.defineProperty(ij.prototype,"m_bIsFrontWheel",{get:ij.prototype.Pz,set:ij.prototype.Zz}),ij.prototype.get_m_raycastInfo=ij.prototype.dC=function(){return GS(IT(this.jz),_j)},ij.prototype.set_m_raycastInfo=ij.prototype.OE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),rS(e,t)},Object.defineProperty(ij.prototype,"m_raycastInfo",{get:ij.prototype.dC,set:ij.prototype.OE}),ij.prototype.get_m_chassisConnectionPointCS=ij.prototype.XA=function(){return GS(MT(this.jz),lM)},ij.prototype.set_m_chassisConnectionPointCS=ij.prototype.HD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ZT(e,t)},Object.defineProperty(ij.prototype,"m_chassisConnectionPointCS",{get:ij.prototype.XA,set:ij.prototype.HD}),ij.prototype.get_m_worldTransform=ij.prototype.KC=function(){return GS(XT(this.jz),Pj)},ij.prototype.set_m_worldTransform=ij.prototype.uF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),_S(e,t)},Object.defineProperty(ij.prototype,"m_worldTransform",{get:ij.prototype.KC,set:ij.prototype.uF}),ij.prototype.get_m_wheelDirectionCS=ij.prototype.Wz=function(){return GS(UT(this.jz),lM)},ij.prototype.set_m_wheelDirectionCS=ij.prototype.fA=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),dS(e,t)},Object.defineProperty(ij.prototype,"m_wheelDirectionCS",{get:ij.prototype.Wz,set:ij.prototype.fA}),ij.prototype.get_m_wheelAxleCS=ij.prototype.Vz=function(){return GS(NT(this.jz),lM)},ij.prototype.set_m_wheelAxleCS=ij.prototype.eA=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),pS(e,t)},Object.defineProperty(ij.prototype,"m_wheelAxleCS",{get:ij.prototype.Vz,set:ij.prototype.eA}),ij.prototype.get_m_rotation=ij.prototype.hC=function(){return OT(this.jz)},ij.prototype.set_m_rotation=ij.prototype.SE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),oS(e,t)},Object.defineProperty(ij.prototype,"m_rotation",{get:ij.prototype.hC,set:ij.prototype.SE}),ij.prototype.get_m_deltaRotation=ij.prototype.eB=function(){return CT(this.jz)},ij.prototype.set_m_deltaRotation=ij.prototype.PD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),KT(e,t)},Object.defineProperty(ij.prototype,"m_deltaRotation",{get:ij.prototype.eB,set:ij.prototype.PD}),ij.prototype.get_m_brake=ij.prototype.QA=function(){return ST(this.jz)},ij.prototype.set_m_brake=ij.prototype.AD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),QT(e,t)},Object.defineProperty(ij.prototype,"m_brake",{get:ij.prototype.QA,set:ij.prototype.AD}),ij.prototype.get_m_clippedInvContactDotSuspension=ij.prototype.YA=function(){return jT(this.jz)},ij.prototype.set_m_clippedInvContactDotSuspension=ij.prototype.ID=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),JT(e,t)},Object.defineProperty(ij.prototype,"m_clippedInvContactDotSuspension",{get:ij.prototype.YA,set:ij.prototype.ID}),ij.prototype.get_m_suspensionRelativeVelocity=ij.prototype.sC=function(){return DT(this.jz)},ij.prototype.set_m_suspensionRelativeVelocity=ij.prototype.cF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),lS(e,t)},Object.defineProperty(ij.prototype,"m_suspensionRelativeVelocity",{get:ij.prototype.sC,set:ij.prototype.cF}),ij.prototype.get_m_skidInfo=ij.prototype.kC=function(){return kT(this.jz)},ij.prototype.set_m_skidInfo=ij.prototype.VE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),aS(e,t)},Object.defineProperty(ij.prototype,"m_skidInfo",{get:ij.prototype.kC,set:ij.prototype.VE}),ij.prototype.__destroy__=function(){xT(this.jz)},oj.prototype=Object.create(lM.prototype),oj.prototype.constructor=oj,oj.prototype.kz=oj,oj.lz={},n.btVector4=oj,oj.prototype.w=function(){return TE(this.jz)},oj.prototype.setValue=function(t,e,n,r){var i=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),bE(i,t,e,n,r)},oj.prototype.length=oj.prototype.length=function(){return fE(this.jz)},oj.prototype.x=oj.prototype.x=function(){return SE(this.jz)},oj.prototype.y=oj.prototype.y=function(){return ME(this.jz)},oj.prototype.z=oj.prototype.z=function(){return jE(this.jz)},oj.prototype.setX=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),xE(e,t)},oj.prototype.setY=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),wE(e,t)},oj.prototype.setZ=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),EE(e,t)},oj.prototype.normalize=oj.prototype.normalize=function(){mE(this.jz)},oj.prototype.rotate=oj.prototype.rotate=function(t,e){var n=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),GS(vE(n,t,e),lM)},oj.prototype.dot=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),hE(e,t)},oj.prototype.op_mul=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(_E(e,t),lM)},oj.prototype.op_add=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(yE(e,t),lM)},oj.prototype.op_sub=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(gE(e,t),lM)},oj.prototype.__destroy__=function(){uE(this.jz)},aj.prototype=Object.create(US.prototype),aj.prototype.constructor=aj,aj.prototype.kz=aj,aj.lz={},n.btDefaultCollisionConstructionInfo=aj,aj.prototype.__destroy__=function(){mc(this.jz)},sj.prototype=Object.create(US.prototype),sj.prototype.constructor=sj,sj.prototype.kz=sj,sj.lz={},n.Anchor=sj,sj.prototype.get_m_node=sj.prototype.TB=function(){return GS(At(this.jz),Ej)},sj.prototype.set_m_node=sj.prototype.DE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Dt(e,t)},Object.defineProperty(sj.prototype,"m_node",{get:sj.prototype.TB,set:sj.prototype.DE}),sj.prototype.get_m_local=sj.prototype.KB=function(){return GS(Rt(this.jz),lM)},sj.prototype.set_m_local=sj.prototype.uE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Bt(e,t)},Object.defineProperty(sj.prototype,"m_local",{get:sj.prototype.KB,set:sj.prototype.uE}),sj.prototype.get_m_body=sj.prototype.PA=function(){return GS(St(this.jz),HM)},sj.prototype.set_m_body=sj.prototype.zD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Lt(e,t)},Object.defineProperty(sj.prototype,"m_body",{get:sj.prototype.PA,set:sj.prototype.zD}),sj.prototype.get_m_influence=sj.prototype.DB=function(){return zt(this.jz)},sj.prototype.set_m_influence=sj.prototype.nE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),kt(e,t)},Object.defineProperty(sj.prototype,"m_influence",{get:sj.prototype.DB,set:sj.prototype.nE}),sj.prototype.get_m_c0=sj.prototype.SA=function(){return GS(Mt(this.jz),xM)},sj.prototype.set_m_c0=sj.prototype.CD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),It(e,t)},Object.defineProperty(sj.prototype,"m_c0",{get:sj.prototype.SA,set:sj.prototype.CD}),sj.prototype.get_m_c1=sj.prototype.TA=function(){return GS(jt(this.jz),lM)},sj.prototype.set_m_c1=sj.prototype.DD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Pt(e,t)},Object.defineProperty(sj.prototype,"m_c1",{get:sj.prototype.TA,set:sj.prototype.DD}),sj.prototype.get_m_c2=sj.prototype.UA=function(){return Ct(this.jz)},sj.prototype.set_m_c2=sj.prototype.ED=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ot(e,t)},Object.defineProperty(sj.prototype,"m_c2",{get:sj.prototype.UA,set:sj.prototype.ED}),sj.prototype.__destroy__=function(){Tt(this.jz)},lj.prototype=Object.create(US.prototype),lj.prototype.constructor=lj,lj.prototype.kz=lj,lj.lz={},n.btVehicleRaycasterResult=lj,lj.prototype.get_m_hitPointInWorld=lj.prototype.yB=function(){return GS(AE(this.jz),lM)},lj.prototype.set_m_hitPointInWorld=lj.prototype.iE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),PE(e,t)},Object.defineProperty(lj.prototype,"m_hitPointInWorld",{get:lj.prototype.yB,set:lj.prototype.iE}),lj.prototype.get_m_hitNormalInWorld=lj.prototype.wB=function(){return GS(RE(this.jz),lM)},lj.prototype.set_m_hitNormalInWorld=lj.prototype.gE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),IE(e,t)},Object.defineProperty(lj.prototype,"m_hitNormalInWorld",{get:lj.prototype.wB,set:lj.prototype.gE}),lj.prototype.get_m_distFraction=lj.prototype.gB=function(){return zE(this.jz)},lj.prototype.set_m_distFraction=lj.prototype.RD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),LE(e,t)},Object.defineProperty(lj.prototype,"m_distFraction",{get:lj.prototype.gB,set:lj.prototype.RD}),lj.prototype.__destroy__=function(){CE(this.jz)},cj.prototype=Object.create(US.prototype),cj.prototype.constructor=cj,cj.prototype.kz=cj,cj.lz={},n.btVector3Array=cj,cj.prototype.size=cj.prototype.size=function(){return qw(this.jz)},cj.prototype.at=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(Ww(e,t),lM)},cj.prototype.__destroy__=function(){Gw(this.jz)},uj.prototype=Object.create(US.prototype),uj.prototype.constructor=uj,uj.prototype.kz=uj,uj.lz={},n.btConstraintSolver=uj,uj.prototype.__destroy__=function(){el(this.jz)},pj.prototype=Object.create(sM.prototype),pj.prototype.constructor=pj,pj.prototype.kz=pj,pj.lz={},n.btRaycastVehicle=pj,pj.prototype.applyEngineForce=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),wy(n,t,e)},pj.prototype.setSteeringValue=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Uy(n,t,e)},pj.prototype.getWheelTransformWS=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(ky(e,t),Pj)},pj.prototype.updateWheelTransform=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Qy(n,t,e)},pj.prototype.addWheel=function(t,e,n,r,i,o,a){var s=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),o&&"object"==typeof o&&(o=o.jz),a&&"object"==typeof a&&(a=a.jz),GS(xy(s,t,e,n,r,i,o,a),ij)},pj.prototype.getNumWheels=function(){return Cy(this.jz)},pj.prototype.getRigidBody=function(){return GS(Ry(this.jz),HM)},pj.prototype.getWheelInfo=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(Oy(e,t),ij)},pj.prototype.setBrake=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Hy(n,t,e)},pj.prototype.setCoordinateSystem=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),Fy(r,t,e,n)},pj.prototype.getCurrentSpeedKmHour=function(){return Sy(this.jz)},pj.prototype.getChassisWorldTransform=function(){return GS(Ty(this.jz),Pj)},pj.prototype.rayCast=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),By(e,t)},pj.prototype.updateVehicle=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Yy(e,t)},pj.prototype.resetSuspension=function(){Dy(this.jz)},pj.prototype.getSteeringValue=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),Ay(e,t)},pj.prototype.updateWheelTransformsWS=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),void 0===e?Zy(n,t):Jy(n,t,e)},pj.prototype.setPitchControl=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ny(e,t)},pj.prototype.updateSuspension=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Xy(e,t)},pj.prototype.updateFriction=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),qy(e,t)},pj.prototype.getRightAxis=function(){return zy(this.jz)},pj.prototype.getUpAxis=function(){return Ly(this.jz)},pj.prototype.getForwardAxis=function(){return My(this.jz)},pj.prototype.getForwardVector=function(){return GS(jy(this.jz),lM)},pj.prototype.getUserConstraintType=function(){return Py(this.jz)},pj.prototype.setUserConstraintType=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Gy(e,t)},pj.prototype.setUserConstraintId=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Vy(e,t)},pj.prototype.getUserConstraintId=function(){return Iy(this.jz)},pj.prototype.updateAction=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Wy(n,t,e)},pj.prototype.__destroy__=function(){by(this.jz)},dj.prototype=Object.create(pM.prototype),dj.prototype.constructor=dj,dj.prototype.kz=dj,dj.lz={},n.btCylinderShapeX=dj,dj.prototype.setMargin=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ql(e,t)},dj.prototype.getMargin=function(){return Xl(this.jz)},dj.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Yl(e,t)},dj.prototype.getLocalScaling=function(){return GS(ql(this.jz),lM)},dj.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Wl(n,t,e)},dj.prototype.__destroy__=function(){Vl(this.jz)},hj.prototype=Object.create(pM.prototype),hj.prototype.constructor=hj,hj.prototype.kz=hj,hj.lz={},n.btCylinderShapeZ=hj,hj.prototype.setMargin=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),nc(e,t)},hj.prototype.getMargin=function(){return tc(this.jz)},hj.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ec(e,t)},hj.prototype.getLocalScaling=function(){return GS($l(this.jz),lM)},hj.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Kl(n,t,e)},hj.prototype.__destroy__=function(){Zl(this.jz)},fj.prototype=Object.create(US.prototype),fj.prototype.constructor=fj,fj.prototype.kz=fj,fj.lz={},n.btConvexPolyhedron=fj,fj.prototype.get_m_vertices=fj.prototype.EC=function(){return GS(Ml(this.jz),cj)},fj.prototype.set_m_vertices=fj.prototype.oF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Cl(e,t)},Object.defineProperty(fj.prototype,"m_vertices",{get:fj.prototype.EC,set:fj.prototype.oF}),fj.prototype.get_m_faces=fj.prototype.nB=function(){return GS(Sl(this.jz),Cj)},fj.prototype.set_m_faces=fj.prototype.YD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),jl(e,t)},Object.defineProperty(fj.prototype,"m_faces",{get:fj.prototype.nB,set:fj.prototype.YD}),fj.prototype.__destroy__=function(){Tl(this.jz)},mj.prototype=Object.create(US.prototype),mj.prototype.constructor=mj,mj.prototype.kz=mj,mj.lz={},n.btSequentialImpulseConstraintSolver=mj,mj.prototype.__destroy__=function(){Hg(this.jz)},yj.prototype=Object.create(US.prototype),yj.prototype.constructor=yj,yj.prototype.kz=yj,yj.lz={},n.tAnchorArray=yj,yj.prototype.size=yj.prototype.size=function(){return TS(this.jz)},yj.prototype.at=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(bS(e,t),sj)},yj.prototype.clear=yj.prototype.clear=function(){xS(this.jz)},yj.prototype.push_back=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ES(e,t)},yj.prototype.pop_back=function(){wS(this.jz)},yj.prototype.__destroy__=function(){vS(this.jz)},_j.prototype=Object.create(US.prototype),_j.prototype.constructor=_j,_j.prototype.kz=_j,_j.lz={},n.RaycastInfo=_j,_j.prototype.get_m_contactNormalWS=_j.prototype.$A=function(){return GS(Gr(this.jz),lM)},_j.prototype.set_m_contactNormalWS=_j.prototype.KD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Kr(e,t)},Object.defineProperty(_j.prototype,"m_contactNormalWS",{get:_j.prototype.$A,set:_j.prototype.KD}),_j.prototype.get_m_contactPointWS=_j.prototype.aB=function(){return GS(Wr(this.jz),lM)},_j.prototype.set_m_contactPointWS=_j.prototype.LD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),$r(e,t)},Object.defineProperty(_j.prototype,"m_contactPointWS",{get:_j.prototype.aB,set:_j.prototype.LD}),_j.prototype.get_m_suspensionLength=_j.prototype.rC=function(){return Qr(this.jz)},_j.prototype.set_m_suspensionLength=_j.prototype.bF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ri(e,t)},Object.defineProperty(_j.prototype,"m_suspensionLength",{get:_j.prototype.rC,set:_j.prototype.bF}),_j.prototype.get_m_hardPointWS=_j.prototype.tB=function(){return GS(Xr(this.jz),lM)},_j.prototype.set_m_hardPointWS=_j.prototype.dE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ei(e,t)},Object.defineProperty(_j.prototype,"m_hardPointWS",{get:_j.prototype.tB,set:_j.prototype.dE}),_j.prototype.get_m_wheelDirectionWS=_j.prototype.GC=function(){return GS(Jr(this.jz),lM)},_j.prototype.set_m_wheelDirectionWS=_j.prototype.qF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),oi(e,t)},Object.defineProperty(_j.prototype,"m_wheelDirectionWS",{get:_j.prototype.GC,set:_j.prototype.qF}),_j.prototype.get_m_wheelAxleWS=_j.prototype.FC=function(){return GS(Zr(this.jz),lM)},_j.prototype.set_m_wheelAxleWS=_j.prototype.pF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ii(e,t)},Object.defineProperty(_j.prototype,"m_wheelAxleWS",{get:_j.prototype.FC,set:_j.prototype.pF}),_j.prototype.get_m_isInContact=_j.prototype.EB=function(){return!!Yr(this.jz)},_j.prototype.set_m_isInContact=_j.prototype.oE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ni(e,t)},Object.defineProperty(_j.prototype,"m_isInContact",{get:_j.prototype.EB,set:_j.prototype.oE}),_j.prototype.get_m_groundObject=_j.prototype.sB=function(){return qr(this.jz)},_j.prototype.set_m_groundObject=_j.prototype.cE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ti(e,t)},Object.defineProperty(_j.prototype,"m_groundObject",{get:_j.prototype.sB,set:_j.prototype.cE}),_j.prototype.__destroy__=function(){Vr(this.jz)},gj.prototype=Object.create(YS.prototype),gj.prototype.constructor=gj,gj.prototype.kz=gj,gj.lz={},n.btMultiSphereShape=gj,gj.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Af(e,t)},gj.prototype.getLocalScaling=function(){return GS(Rf(this.jz),lM)},gj.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),zf(n,t,e)},gj.prototype.__destroy__=function(){jf(this.jz)},vj.prototype=Object.create(QS.prototype),vj.prototype.constructor=vj,vj.prototype.kz=vj,vj.lz={},n.btSoftBody=vj,vj.prototype.checkLink=function(t,e){var n=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),!!Jv(n,t,e)},vj.prototype.checkFace=function(t,e,n){var r=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),!!Zv(r,t,e,n)},vj.prototype.appendMaterial=function(){return GS(qv(this.jz),EM)},vj.prototype.appendNode=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Xv(n,t,e)},vj.prototype.appendLink=function(t,e,n,r){var i=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),Wv(i,t,e,n,r)},vj.prototype.appendFace=function(t,e,n,r){var i=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),Gv(i,t,e,n,r)},vj.prototype.appendTetra=function(t,e,n,r,i){var o=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),Yv(o,t,e,n,r,i)},vj.prototype.appendAnchor=function(t,e,n,r){var i=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),Vv(i,t,e,n,r)},vj.prototype.addForce=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),void 0===e?Nv(n,t):Uv(n,t,e)},vj.prototype.addAeroForceToNode=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Fv(n,t,e)},vj.prototype.getTotalMass=function(){return lb(this.jz)},vj.prototype.setTotalMass=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Pb(n,t,e)},vj.prototype.setMass=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Ab(n,t,e)},vj.prototype.transform=vj.prototype.transform=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ub(e,t)},vj.prototype.translate=vj.prototype.translate=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Vb(e,t)},vj.prototype.rotate=vj.prototype.rotate=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),bb(e,t)},vj.prototype.scale=vj.prototype.scale=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),xb(e,t)},vj.prototype.generateClusters=function(t,e){var n=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),void 0===e?tb(n,t):eb(n,t,e)},vj.prototype.generateBendingConstraints=function(t,e){var n=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),$v(n,t,e)},vj.prototype.upcast=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(Gb(e,t),vj)},vj.prototype.setAnisotropicFriction=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Eb(n,t,e)},vj.prototype.getCollisionShape=function(){return GS(ib(this.jz),YS)},vj.prototype.setContactProcessingThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Cb(e,t)},vj.prototype.setActivationState=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),wb(e,t)},vj.prototype.forceActivationState=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Kv(e,t)},vj.prototype.activate=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),void 0===t?Dv(e):Hv(e,t)},vj.prototype.isActive=function(){return!!yb(this.jz)},vj.prototype.isKinematicObject=function(){return!!_b(this.jz)},vj.prototype.isStaticObject=function(){return!!gb(this.jz)},vj.prototype.isStaticOrKinematicObject=function(){return!!vb(this.jz)},vj.prototype.getRestitution=function(){return ab(this.jz)},vj.prototype.getFriction=function(){return ob(this.jz)},vj.prototype.getRollingFriction=function(){return sb(this.jz)},vj.prototype.setRestitution=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Lb(e,t)},vj.prototype.setFriction=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),zb(e,t)},vj.prototype.setRollingFriction=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ib(e,t)},vj.prototype.getWorldTransform=function(){return GS(pb(this.jz),Pj)},vj.prototype.getCollisionFlags=function(){return rb(this.jz)},vj.prototype.setCollisionFlags=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Mb(e,t)},vj.prototype.setWorldTransform=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Bb(e,t)},vj.prototype.setCollisionShape=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),jb(e,t)},vj.prototype.setCcdMotionThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Tb(e,t)},vj.prototype.setCcdSweptSphereRadius=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Sb(e,t)},vj.prototype.getUserIndex=function(){return cb(this.jz)},vj.prototype.setUserIndex=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ob(e,t)},vj.prototype.getUserPointer=function(){return GS(ub(this.jz),qM)},vj.prototype.setUserPointer=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),kb(e,t)},vj.prototype.getBroadphaseHandle=function(){return GS(nb(this.jz),Wj)},vj.prototype.setIgnoreCollisionCheck=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Rb(n,t,e)},vj.prototype.get_m_cfg=vj.prototype.VA=function(){return GS(hb(this.jz),xj)},vj.prototype.set_m_cfg=vj.prototype.FD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Hb(e,t)},Object.defineProperty(vj.prototype,"m_cfg",{get:vj.prototype.VA,set:vj.prototype.FD}),vj.prototype.get_m_nodes=vj.prototype.UB=function(){return GS(mb(this.jz),TM)},vj.prototype.set_m_nodes=vj.prototype.EE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Nb(e,t)},Object.defineProperty(vj.prototype,"m_nodes",{get:vj.prototype.UB,set:vj.prototype.EE}),vj.prototype.get_m_materials=vj.prototype.OB=function(){return GS(fb(this.jz),PM)},vj.prototype.set_m_materials=vj.prototype.yE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Fb(e,t)},Object.defineProperty(vj.prototype,"m_materials",{get:vj.prototype.OB,set:vj.prototype.yE}),vj.prototype.get_m_anchors=vj.prototype.LA=function(){return GS(db(this.jz),yj)},vj.prototype.set_m_anchors=vj.prototype.vD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Db(e,t)},Object.defineProperty(vj.prototype,"m_anchors",{get:vj.prototype.LA,set:vj.prototype.vD}),vj.prototype.__destroy__=function(){Bv(this.jz)},bj.prototype=Object.create(US.prototype),bj.prototype.constructor=bj,bj.prototype.kz=bj,bj.lz={},n.btIntArray=bj,bj.prototype.size=bj.prototype.size=function(){return Lh(this.jz)},bj.prototype.at=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),Ah(e,t)},bj.prototype.__destroy__=function(){Rh(this.jz)},xj.prototype=Object.create(US.prototype),xj.prototype.constructor=xj,xj.prototype.kz=xj,xj.lz={},n.Config=xj,xj.prototype.get_kVCF=xj.prototype.EA=function(){return qe(this.jz)},xj.prototype.set_kVCF=xj.prototype.oD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),gn(e,t)},Object.defineProperty(xj.prototype,"kVCF",{get:xj.prototype.EA,set:xj.prototype.oD}),xj.prototype.get_kDP=xj.prototype.rA=function(){return Pe(this.jz)},xj.prototype.set_kDP=xj.prototype.bD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),an(e,t)},Object.defineProperty(xj.prototype,"kDP",{get:xj.prototype.rA,set:xj.prototype.bD}),xj.prototype.get_kDG=xj.prototype.qA=function(){return Ie(this.jz)},xj.prototype.set_kDG=xj.prototype.aD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),on(e,t)},Object.defineProperty(xj.prototype,"kDG",{get:xj.prototype.qA,set:xj.prototype.aD}),xj.prototype.get_kLF=xj.prototype.tA=function(){return ke(this.jz)},xj.prototype.set_kLF=xj.prototype.dD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ln(e,t)},Object.defineProperty(xj.prototype,"kLF",{get:xj.prototype.tA,set:xj.prototype.dD}),xj.prototype.get_kPR=xj.prototype.vA=function(){return De(this.jz)},xj.prototype.set_kPR=xj.prototype.fD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),un(e,t)},Object.defineProperty(xj.prototype,"kPR",{get:xj.prototype.vA,set:xj.prototype.fD}),xj.prototype.get_kVC=xj.prototype.DA=function(){return Xe(this.jz)},xj.prototype.set_kVC=xj.prototype.nD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),vn(e,t)},Object.defineProperty(xj.prototype,"kVC",{get:xj.prototype.DA,set:xj.prototype.nD}),xj.prototype.get_kDF=xj.prototype.pA=function(){return Le(this.jz)},xj.prototype.set_kDF=xj.prototype.$C=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),rn(e,t)},Object.defineProperty(xj.prototype,"kDF",{get:xj.prototype.pA,set:xj.prototype.$C}),xj.prototype.get_kMT=xj.prototype.uA=function(){return Be(this.jz)},xj.prototype.set_kMT=xj.prototype.eD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),cn(e,t)},Object.defineProperty(xj.prototype,"kMT",{get:xj.prototype.uA,set:xj.prototype.eD}),xj.prototype.get_kCHR=xj.prototype.oA=function(){return Ae(this.jz)},xj.prototype.set_kCHR=xj.prototype.ZC=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),nn(e,t)},Object.defineProperty(xj.prototype,"kCHR",{get:xj.prototype.oA,set:xj.prototype.ZC}),xj.prototype.get_kKHR=xj.prototype.sA=function(){return Oe(this.jz)},xj.prototype.set_kKHR=xj.prototype.cD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),sn(e,t)},Object.defineProperty(xj.prototype,"kKHR",{get:xj.prototype.sA,set:xj.prototype.cD}),xj.prototype.get_kSHR=xj.prototype.wA=function(){return He(this.jz)},xj.prototype.set_kSHR=xj.prototype.gD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),pn(e,t)},Object.defineProperty(xj.prototype,"kSHR",{get:xj.prototype.wA,set:xj.prototype.gD}),xj.prototype.get_kAHR=xj.prototype.nA=function(){return Re(this.jz)},xj.prototype.set_kAHR=xj.prototype.YC=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),en(e,t)},Object.defineProperty(xj.prototype,"kAHR",{get:xj.prototype.nA,set:xj.prototype.YC}),xj.prototype.get_kSRHR_CL=xj.prototype.zA=function(){return Ue(this.jz)},xj.prototype.set_kSRHR_CL=xj.prototype.jD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),fn(e,t)},Object.defineProperty(xj.prototype,"kSRHR_CL",{get:xj.prototype.zA,set:xj.prototype.jD}),xj.prototype.get_kSKHR_CL=xj.prototype.xA=function(){return Fe(this.jz)},xj.prototype.set_kSKHR_CL=xj.prototype.hD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),dn(e,t)},Object.defineProperty(xj.prototype,"kSKHR_CL",{get:xj.prototype.xA,set:xj.prototype.hD}),xj.prototype.get_kSSHR_CL=xj.prototype.BA=function(){return Ge(this.jz)},xj.prototype.set_kSSHR_CL=xj.prototype.lD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),yn(e,t)},Object.defineProperty(xj.prototype,"kSSHR_CL",{get:xj.prototype.BA,set:xj.prototype.lD}),xj.prototype.get_kSR_SPLT_CL=xj.prototype.AA=function(){return Ve(this.jz)},xj.prototype.set_kSR_SPLT_CL=xj.prototype.kD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),mn(e,t)},Object.defineProperty(xj.prototype,"kSR_SPLT_CL",{get:xj.prototype.AA,set:xj.prototype.kD}),xj.prototype.get_kSK_SPLT_CL=xj.prototype.yA=function(){return Ne(this.jz)},xj.prototype.set_kSK_SPLT_CL=xj.prototype.iD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),hn(e,t)},Object.defineProperty(xj.prototype,"kSK_SPLT_CL",{get:xj.prototype.yA,set:xj.prototype.iD}),xj.prototype.get_kSS_SPLT_CL=xj.prototype.CA=function(){return We(this.jz)},xj.prototype.set_kSS_SPLT_CL=xj.prototype.mD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),_n(e,t)},Object.defineProperty(xj.prototype,"kSS_SPLT_CL",{get:xj.prototype.CA,set:xj.prototype.mD}),xj.prototype.get_maxvolume=xj.prototype.NC=function(){return Ye(this.jz)},xj.prototype.set_maxvolume=xj.prototype.xF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),bn(e,t)},Object.defineProperty(xj.prototype,"maxvolume",{get:xj.prototype.NC,set:xj.prototype.xF}),xj.prototype.get_timescale=xj.prototype.PC=function(){return Ze(this.jz)},xj.prototype.set_timescale=xj.prototype.zF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),wn(e,t)},Object.defineProperty(xj.prototype,"timescale",{get:xj.prototype.PC,set:xj.prototype.zF}),xj.prototype.get_viterations=xj.prototype.QC=function(){return Je(this.jz)},xj.prototype.set_viterations=xj.prototype.AF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),En(e,t)},Object.defineProperty(xj.prototype,"viterations",{get:xj.prototype.QC,set:xj.prototype.AF}),xj.prototype.get_piterations=xj.prototype.OC=function(){return Qe(this.jz)},xj.prototype.set_piterations=xj.prototype.yF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),xn(e,t)},Object.defineProperty(xj.prototype,"piterations",{get:xj.prototype.OC,set:xj.prototype.yF}),xj.prototype.get_diterations=xj.prototype.mA=function(){return ze(this.jz)},xj.prototype.set_diterations=xj.prototype.XC=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),tn(e,t)},Object.defineProperty(xj.prototype,"diterations",{get:xj.prototype.mA,set:xj.prototype.XC}),xj.prototype.get_citerations=xj.prototype.kA=function(){return je(this.jz)},xj.prototype.set_citerations=xj.prototype.VC=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ke(e,t)},Object.defineProperty(xj.prototype,"citerations",{get:xj.prototype.kA,set:xj.prototype.VC}),xj.prototype.get_collisions=xj.prototype.lA=function(){return Ce(this.jz)},xj.prototype.set_collisions=xj.prototype.WC=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),$e(e,t)},Object.defineProperty(xj.prototype,"collisions",{get:xj.prototype.lA,set:xj.prototype.WC}),xj.prototype.__destroy__=function(){Me(this.jz)},wj.prototype=Object.create(rM.prototype),wj.prototype.constructor=wj,wj.prototype.kz=wj,wj.lz={},n.btClosestNotMeConvexResultCallback=wj,wj.prototype.hasHit=function(){return!!To(this.jz)},wj.prototype.get_m_me=wj.prototype.RB=function(){return GS(wo(this.jz),QS)},wj.prototype.set_m_me=wj.prototype.BE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Po(e,t)},Object.defineProperty(wj.prototype,"m_me",{get:wj.prototype.RB,set:wj.prototype.BE}),wj.prototype.get_m_pairCache=wj.prototype.YB=function(){return GS(Eo(this.jz),Rj)},wj.prototype.set_m_pairCache=wj.prototype.IE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Oo(e,t)},Object.defineProperty(wj.prototype,"m_pairCache",{get:wj.prototype.YB,set:wj.prototype.IE}),wj.prototype.get_m_dispatcher=wj.prototype.Sz=function(){return GS(go(this.jz),fM)},wj.prototype.set_m_dispatcher=wj.prototype.bA=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ro(e,t)},Object.defineProperty(wj.prototype,"m_dispatcher",{get:wj.prototype.Sz,set:wj.prototype.bA}),wj.prototype.get_m_convexFromWorld=wj.prototype.Qz=function(){return GS(yo(this.jz),lM)},wj.prototype.set_m_convexFromWorld=wj.prototype.$z=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Co(e,t)},Object.defineProperty(wj.prototype,"m_convexFromWorld",{get:wj.prototype.Qz,set:wj.prototype.$z}),wj.prototype.get_m_convexToWorld=wj.prototype.Rz=function(){return GS(_o(this.jz),lM)},wj.prototype.set_m_convexToWorld=wj.prototype.aA=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),zo(e,t)},Object.defineProperty(wj.prototype,"m_convexToWorld",{get:wj.prototype.Rz,set:wj.prototype.aA}),wj.prototype.get_m_hitNormalWorld=wj.prototype.uz=function(){return GS(bo(this.jz),lM)},wj.prototype.set_m_hitNormalWorld=wj.prototype.wz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Lo(e,t)},Object.defineProperty(wj.prototype,"m_hitNormalWorld",{get:wj.prototype.uz,set:wj.prototype.wz}),wj.prototype.get_m_hitPointWorld=wj.prototype.vz=function(){return GS(xo(this.jz),lM)},wj.prototype.set_m_hitPointWorld=wj.prototype.xz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Io(e,t)},Object.defineProperty(wj.prototype,"m_hitPointWorld",{get:wj.prototype.vz,set:wj.prototype.xz}),wj.prototype.get_m_hitCollisionObject=wj.prototype.Az=function(){return GS(vo(this.jz),QS)},wj.prototype.set_m_hitCollisionObject=wj.prototype.Iz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ao(e,t)},Object.defineProperty(wj.prototype,"m_hitCollisionObject",{get:wj.prototype.Az,set:wj.prototype.Iz}),wj.prototype.get_m_collisionFilterGroup=wj.prototype.mz=function(){return fo(this.jz)},wj.prototype.set_m_collisionFilterGroup=wj.prototype.oz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Mo(e,t)},Object.defineProperty(wj.prototype,"m_collisionFilterGroup",{get:wj.prototype.mz,set:wj.prototype.oz}),wj.prototype.get_m_collisionFilterMask=wj.prototype.nz=function(){return mo(this.jz)},wj.prototype.set_m_collisionFilterMask=wj.prototype.pz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),jo(e,t)},Object.defineProperty(wj.prototype,"m_collisionFilterMask",{get:wj.prototype.nz,set:wj.prototype.pz}),wj.prototype.get_m_closestHitFraction=wj.prototype.qz=function(){return ho(this.jz)},wj.prototype.set_m_closestHitFraction=wj.prototype.sz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),So(e,t)},Object.defineProperty(wj.prototype,"m_closestHitFraction",{get:wj.prototype.qz,set:wj.prototype.sz}),wj.prototype.__destroy__=function(){uo(this.jz)},Ej.prototype=Object.create(US.prototype),Ej.prototype.constructor=Ej,Ej.prototype.kz=Ej,Ej.lz={},n.Node=Ej,Ej.prototype.get_m_x=Ej.prototype.LC=function(){return GS(Sr(this.jz),lM)},Ej.prototype.set_m_x=Ej.prototype.vF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Lr(e,t)},Object.defineProperty(Ej.prototype,"m_x",{get:Ej.prototype.LC,set:Ej.prototype.vF}),Ej.prototype.get_m_q=Ej.prototype.cC=function(){return GS(Er(this.jz),lM)},Ej.prototype.set_m_q=Ej.prototype.NE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Rr(e,t)},Object.defineProperty(Ej.prototype,"m_q",{get:Ej.prototype.cC,set:Ej.prototype.NE}),Ej.prototype.get_m_v=Ej.prototype.DC=function(){return GS(Tr(this.jz),lM)},Ej.prototype.set_m_v=Ej.prototype.nF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ar(e,t)},Object.defineProperty(Ej.prototype,"m_v",{get:Ej.prototype.DC,set:Ej.prototype.nF}),Ej.prototype.get_m_f=Ej.prototype.mB=function(){return GS(br(this.jz),lM)},Ej.prototype.set_m_f=Ej.prototype.XD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),jr(e,t)},Object.defineProperty(Ej.prototype,"m_f",{get:Ej.prototype.mB,set:Ej.prototype.XD}),Ej.prototype.get_m_n=Ej.prototype.SB=function(){return GS(wr(this.jz),lM)},Ej.prototype.set_m_n=Ej.prototype.CE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),zr(e,t)},Object.defineProperty(Ej.prototype,"m_n",{get:Ej.prototype.SB,set:Ej.prototype.CE}),Ej.prototype.get_m_im=Ej.prototype.AB=function(){return xr(this.jz)},Ej.prototype.set_m_im=Ej.prototype.kE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Cr(e,t)},Object.defineProperty(Ej.prototype,"m_im",{get:Ej.prototype.AB,set:Ej.prototype.kE}),Ej.prototype.get_m_area=Ej.prototype.OA=function(){return vr(this.jz)},Ej.prototype.set_m_area=Ej.prototype.yD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Mr(e,t)},Object.defineProperty(Ej.prototype,"m_area",{get:Ej.prototype.OA,set:Ej.prototype.yD}),Ej.prototype.__destroy__=function(){gr(this.jz)},Tj.prototype=Object.create(US.prototype),Tj.prototype.constructor=Tj,Tj.prototype.kz=Tj,Tj.lz={},n.btGhostPairCallback=Tj,Tj.prototype.__destroy__=function(){Ud(this.jz)},Sj.prototype=Object.create(US.prototype),Sj.prototype.constructor=Sj,Sj.prototype.kz=Sj,Sj.lz={},n.btOverlappingPairCallback=Sj,Sj.prototype.__destroy__=function(){Of(this.jz)},Mj.prototype=Object.create(sM.prototype),Mj.prototype.constructor=Mj,Mj.prototype.kz=Mj,Mj.lz={},n.btKinematicCharacterController=Mj,Mj.prototype.setUpAxis=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Qh(e,t)},Mj.prototype.setWalkDirection=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),$h(e,t)},Mj.prototype.setVelocityForTimeInterval=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Kh(n,t,e)},Mj.prototype.warp=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ef(e,t)},Mj.prototype.preStep=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Vh(e,t)},Mj.prototype.playerStep=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Uh(n,t,e)},Mj.prototype.setFallSpeed=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Gh(e,t)},Mj.prototype.setJumpSpeed=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),qh(e,t)},Mj.prototype.setMaxJumpHeight=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Xh(e,t)},Mj.prototype.canJump=function(){return!!kh(this.jz)},Mj.prototype.jump=function(){Fh(this.jz)},Mj.prototype.setGravity=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Wh(e,t)},Mj.prototype.getGravity=function(){return Dh(this.jz)},Mj.prototype.setMaxSlope=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Yh(e,t)},Mj.prototype.getMaxSlope=function(){return Hh(this.jz)},Mj.prototype.getGhostObject=function(){return GS(Bh(this.jz),Nj)},Mj.prototype.setUseGhostSweepTest=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Jh(e,t)},Mj.prototype.onGround=function(){return!!Nh(this.jz)},Mj.prototype.setUpInterpolate=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Zh(e,t)},Mj.prototype.updateAction=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),tf(n,t,e)},Mj.prototype.__destroy__=function(){Ih(this.jz)},jj.prototype=Object.create(US.prototype),jj.prototype.constructor=jj,jj.prototype.kz=jj,jj.lz={},n.btSoftBodyArray=jj,jj.prototype.size=jj.prototype.size=function(){return av(this.jz)},jj.prototype.at=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(ov(e,t),vj)},jj.prototype.__destroy__=function(){iv(this.jz)},Cj.prototype=Object.create(US.prototype),Cj.prototype.constructor=Cj,Cj.prototype.kz=Cj,Cj.lz={},n.btFaceArray=Cj,Cj.prototype.size=Cj.prototype.size=function(){return _p(this.jz)},Cj.prototype.at=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(yp(e,t),Yj)},Cj.prototype.__destroy__=function(){mp(this.jz)},zj.prototype=Object.create($S.prototype),zj.prototype.constructor=zj,zj.prototype.kz=zj,zj.lz={},n.btStaticPlaneShape=zj,zj.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Wx(e,t)},zj.prototype.getLocalScaling=function(){return GS(Gx(this.jz),lM)},zj.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Vx(n,t,e)},zj.prototype.__destroy__=function(){Nx(this.jz)},Rj.prototype=Object.create(US.prototype),Rj.prototype.constructor=Rj,Rj.prototype.kz=Rj,Rj.lz={},n.btOverlappingPairCache=Rj,Rj.prototype.setInternalGhostPairCallback=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Pf(e,t)},Rj.prototype.getNumOverlappingPairs=function(){return If(this.jz)},Rj.prototype.__destroy__=function(){Lf(this.jz)},Aj.prototype=Object.create(US.prototype),Aj.prototype.constructor=Aj,Aj.prototype.kz=Aj,Aj.lz={},n.btIndexedMesh=Aj,Aj.prototype.get_m_numTriangles=Aj.prototype.XB=function(){return Ch(this.jz)},Aj.prototype.set_m_numTriangles=Aj.prototype.HE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),zh(e,t)},Object.defineProperty(Aj.prototype,"m_numTriangles",{get:Aj.prototype.XB,set:Aj.prototype.HE}),Aj.prototype.__destroy__=function(){jh(this.jz)},Lj.prototype=Object.create(dM.prototype),Lj.prototype.constructor=Lj,Lj.prototype.kz=Lj,Lj.lz={},n.btSoftRigidDynamicsWorld=Lj,Lj.prototype.addSoftBody=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),ex(r,t,e,n)},Lj.prototype.removeSoftBody=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ex(e,t)},Lj.prototype.removeCollisionObject=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),bx(e,t)},Lj.prototype.getWorldInfo=function(){return GS(_x(this.jz),XM)},Lj.prototype.getSoftBodyArray=function(){return GS(mx(this.jz),jj)},Lj.prototype.getDispatcher=function(){return GS(px(this.jz),fM)},Lj.prototype.rayTest=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),gx(r,t,e,n)},Lj.prototype.getPairCache=function(){return GS(fx(this.jz),Rj)},Lj.prototype.getDispatchInfo=function(){return GS(ux(this.jz),SM)},Lj.prototype.addCollisionObject=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),void 0===e?Yb(r,t):void 0===n?Qb(r,t,e):Zb(r,t,e,n)},Lj.prototype.getBroadphase=function(){return GS(lx(this.jz),CM)},Lj.prototype.convexSweepTest=function(t,e,n,r,i){var o=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),ox(o,t,e,n,r,i)},Lj.prototype.contactPairTest=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),rx(r,t,e,n)},Lj.prototype.contactTest=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),ix(n,t,e)},Lj.prototype.updateSingleAabb=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ix(e,t)},Lj.prototype.setDebugDrawer=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),jx(e,t)},Lj.prototype.getDebugDrawer=function(){return GS(cx(this.jz),eM)},Lj.prototype.debugDrawWorld=function(){sx(this.jz)},Lj.prototype.debugDrawObject=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),ax(r,t,e,n)},Lj.prototype.getForceUpdateAllAabbs=function(){return!!dx(this.jz)},Lj.prototype.setForceUpdateAllAabbs=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Cx(e,t)},Lj.prototype.setGravity=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),zx(e,t)},Lj.prototype.getGravity=function(){return GS(hx(this.jz),lM)},Lj.prototype.addRigidBody=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),void 0===e?$b(r,t):void 0===n?_emscripten_bind_btSoftRigidDynamicsWorld_addRigidBody_2(r,t,e):tx(r,t,e,n)},Lj.prototype.removeRigidBody=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),wx(e,t)},Lj.prototype.addConstraint=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),void 0===e?Jb(n,t):Kb(n,t,e)},Lj.prototype.removeConstraint=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),xx(e,t)},Lj.prototype.stepSimulation=function(t,e,n){var r=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),void 0===e?Rx(r,t):void 0===n?Ax(r,t,e):Lx(r,t,e,n)},Lj.prototype.setContactAddedCallback=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Tx(e,t)},Lj.prototype.setContactProcessedCallback=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Mx(e,t)},Lj.prototype.setContactDestroyedCallback=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Sx(e,t)},Lj.prototype.activateContactAddedCallbackAdjustInternalEdgeContacts=function(){qb(this.jz)},Lj.prototype.addAction=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Xb(e,t)},Lj.prototype.removeAction=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),vx(e,t)},Lj.prototype.getSolverInfo=function(){return GS(yx(this.jz),$j)},Lj.prototype.__destroy__=function(){Wb(this.jz)},Ij.prototype=Object.create(JS.prototype),Ij.prototype.constructor=Ij,Ij.prototype.kz=Ij,Ij.lz={},n.btFixedConstraint=Ij,Ij.prototype.enableFeedback=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Sp(e,t)},Ij.prototype.getBreakingImpulseThreshold=function(){return Mp(this.jz)},Ij.prototype.setBreakingImpulseThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Cp(e,t)},Ij.prototype.getParam=function(t,e){var n=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),jp(n,t,e)},Ij.prototype.setParam=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),zp(r,t,e,n)},Ij.prototype.__destroy__=function(){Ep(this.jz)},Pj.prototype=Object.create(US.prototype),Pj.prototype.constructor=Pj,Pj.prototype.kz=Pj,Pj.lz={},n.btTransform=Pj,Pj.prototype.setIdentity=function(){rw(this.jz)},Pj.prototype.setOrigin=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),iw(e,t)},Pj.prototype.setRotation=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ow(e,t)},Pj.prototype.getOrigin=function(){return GS(Kx(this.jz),lM)},Pj.prototype.getRotation=function(){return GS($x(this.jz),Jj)},Pj.prototype.getBasis=function(){return GS(Jx(this.jz),xM)},Pj.prototype.setFromOpenGLMatrix=function(t){var n=this.jz;e.rz(),"object"==typeof t&&(t=qS(t)),nw(n,t)},Pj.prototype.inverse=Pj.prototype.inverse=function(){return GS(tw(this.jz),Pj)},Pj.prototype.op_mul=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(ew(e,t),Pj)},Pj.prototype.__destroy__=function(){Yx(this.jz)},Oj.prototype=Object.create(bM.prototype),Oj.prototype.constructor=Oj,Oj.prototype.kz=Oj,Oj.lz={},n.ClosestRayResultCallback=Oj,Oj.prototype.hasHit=function(){return!!fe(this.jz)},Oj.prototype.get_m_rayFromWorld=Oj.prototype.Tz=function(){return GS(de(this.jz),lM)},Oj.prototype.set_m_rayFromWorld=Oj.prototype.cA=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),xe(e,t)},Object.defineProperty(Oj.prototype,"m_rayFromWorld",{get:Oj.prototype.Tz,set:Oj.prototype.cA}),Oj.prototype.get_m_rayToWorld=Oj.prototype.Uz=function(){return GS(he(this.jz),lM)},Oj.prototype.set_m_rayToWorld=Oj.prototype.dA=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),we(e,t)},Object.defineProperty(Oj.prototype,"m_rayToWorld",{get:Oj.prototype.Uz,set:Oj.prototype.dA}),Oj.prototype.get_m_hitNormalWorld=Oj.prototype.uz=function(){return GS(ue(this.jz),lM)},Oj.prototype.set_m_hitNormalWorld=Oj.prototype.wz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ve(e,t)},Object.defineProperty(Oj.prototype,"m_hitNormalWorld",{get:Oj.prototype.uz,set:Oj.prototype.wz}),Oj.prototype.get_m_hitPointWorld=Oj.prototype.vz=function(){return GS(pe(this.jz),lM)},Oj.prototype.set_m_hitPointWorld=Oj.prototype.xz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),be(e,t)},Object.defineProperty(Oj.prototype,"m_hitPointWorld",{get:Oj.prototype.vz,set:Oj.prototype.xz}),Oj.prototype.get_m_collisionFilterGroup=Oj.prototype.mz=function(){return se(this.jz)},Oj.prototype.set_m_collisionFilterGroup=Oj.prototype.oz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ye(e,t)},Object.defineProperty(Oj.prototype,"m_collisionFilterGroup",{get:Oj.prototype.mz,set:Oj.prototype.oz}),Oj.prototype.get_m_collisionFilterMask=Oj.prototype.nz=function(){return le(this.jz)},Oj.prototype.set_m_collisionFilterMask=Oj.prototype.pz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),_e(e,t)},Object.defineProperty(Oj.prototype,"m_collisionFilterMask",{get:Oj.prototype.nz,set:Oj.prototype.pz}),Oj.prototype.get_m_closestHitFraction=Oj.prototype.qz=function(){return ae(this.jz)},Oj.prototype.set_m_closestHitFraction=Oj.prototype.sz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),me(e,t)},Object.defineProperty(Oj.prototype,"m_closestHitFraction",{get:Oj.prototype.qz,set:Oj.prototype.sz}),Oj.prototype.get_m_collisionObject=Oj.prototype.yz=function(){return GS(ce(this.jz),QS)},Oj.prototype.set_m_collisionObject=Oj.prototype.Gz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ge(e,t)},Object.defineProperty(Oj.prototype,"m_collisionObject",{get:Oj.prototype.yz,set:Oj.prototype.Gz}),Oj.prototype.__destroy__=function(){oe(this.jz)},kj.prototype=Object.create(nM.prototype),kj.prototype.constructor=kj,kj.prototype.kz=kj,kj.lz={},n.btSoftBodyRigidBodyCollisionConfiguration=kj,kj.prototype.__destroy__=function(){mv(this.jz)},Bj.prototype=Object.create(gM.prototype),Bj.prototype.constructor=Bj,Bj.prototype.kz=Bj,Bj.lz={},n.ConcreteContactResultCallback=Bj,Bj.prototype.addSingleResult=function(t,e,n,r,i,o,a){var s=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),o&&"object"==typeof o&&(o=o.jz),a&&"object"==typeof a&&(a=a.jz),Se(s,t,e,n,r,i,o,a)},Bj.prototype.__destroy__=function(){Te(this.jz)},Dj.prototype=Object.create(iM.prototype),Dj.prototype.constructor=Dj,Dj.prototype.kz=Dj,Dj.lz={},n.btBvhTriangleMeshShape=Dj,Dj.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ii(e,t)},Dj.prototype.getLocalScaling=function(){return GS(Li(this.jz),lM)},Dj.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Ai(n,t,e)},Dj.prototype.__destroy__=function(){Ci(this.jz)},Hj.prototype=Object.create(US.prototype),Hj.prototype.constructor=Hj,Hj.prototype.kz=Hj,Hj.lz={},n.btConstCollisionObjectArray=Hj,Hj.prototype.size=Hj.prototype.size=function(){return qs(this.jz)},Hj.prototype.at=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(Ws(e,t),QS)},Hj.prototype.__destroy__=function(){Gs(this.jz)},Fj.prototype=Object.create(JS.prototype),Fj.prototype.constructor=Fj,Fj.prototype.kz=Fj,Fj.lz={},n.btSliderConstraint=Fj,Fj.prototype.setLowerLinLimit=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),tv(e,t)},Fj.prototype.setUpperLinLimit=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),rv(e,t)},Fj.prototype.setLowerAngLimit=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),$g(e,t)},Fj.prototype.setUpperAngLimit=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),nv(e,t)},Fj.prototype.enableFeedback=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Qg(e,t)},Fj.prototype.getBreakingImpulseThreshold=function(){return Zg(this.jz)},Fj.prototype.setBreakingImpulseThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Kg(e,t)},Fj.prototype.getParam=function(t,e){var n=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Jg(n,t,e)},Fj.prototype.setParam=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),ev(r,t,e,n)},Fj.prototype.__destroy__=function(){qg(this.jz)},Nj.prototype=Object.create(oM.prototype),Nj.prototype.constructor=Nj,Nj.prototype.kz=Nj,Nj.lz={},n.btPairCachingGhostObject=Nj,Nj.prototype.setAnisotropicFriction=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),rm(n,t,e)},Nj.prototype.getCollisionShape=function(){return GS(Vf(this.jz),YS)},Nj.prototype.setContactProcessingThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),lm(e,t)},Nj.prototype.setActivationState=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),nm(e,t)},Nj.prototype.forceActivationState=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ff(e,t)},Nj.prototype.activate=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),void 0===t?Bf(e):Df(e,t)},Nj.prototype.isActive=function(){return!!Kf(this.jz)},Nj.prototype.isKinematicObject=function(){return!!$f(this.jz)},Nj.prototype.isStaticObject=function(){return!!tm(this.jz)},Nj.prototype.isStaticOrKinematicObject=function(){return!!em(this.jz)},Nj.prototype.getRestitution=function(){return Xf(this.jz)},Nj.prototype.getFriction=function(){return Gf(this.jz)},Nj.prototype.getRollingFriction=function(){return Yf(this.jz)},Nj.prototype.setRestitution=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),pm(e,t)},Nj.prototype.setFriction=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),cm(e,t)},Nj.prototype.setRollingFriction=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),dm(e,t)},Nj.prototype.getWorldTransform=function(){return GS(Jf(this.jz),Pj)},Nj.prototype.getCollisionFlags=function(){return Uf(this.jz)},Nj.prototype.setCollisionFlags=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),am(e,t)},Nj.prototype.setWorldTransform=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),mm(e,t)},Nj.prototype.setCollisionShape=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),sm(e,t)},Nj.prototype.setCcdMotionThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),im(e,t)},Nj.prototype.setCcdSweptSphereRadius=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),om(e,t)},Nj.prototype.getUserIndex=function(){return Qf(this.jz)},Nj.prototype.setUserIndex=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),hm(e,t)},Nj.prototype.getUserPointer=function(){return GS(Zf(this.jz),qM)},Nj.prototype.setUserPointer=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),fm(e,t)},Nj.prototype.getBroadphaseHandle=function(){return GS(Nf(this.jz),Wj)},Nj.prototype.setIgnoreCollisionCheck=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),um(n,t,e)},Nj.prototype.getNumOverlappingObjects=function(){return Wf(this.jz)},Nj.prototype.getOverlappingObject=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(qf(e,t),QS)},Nj.prototype.__destroy__=function(){kf(this.jz)},Uj.prototype=Object.create(US.prototype),Uj.prototype.constructor=Uj,Uj.prototype.kz=Uj,Uj.lz={},n.btManifoldPoint=Uj,Uj.prototype.getPositionWorldOnA=function(){return GS(af(this.jz),lM)},Uj.prototype.getPositionWorldOnB=function(){return GS(sf(this.jz),lM)},Uj.prototype.getAppliedImpulse=function(){return rf(this.jz)},Uj.prototype.getDistance=function(){return of(this.jz)},Uj.prototype.get_m_localPointA=Uj.prototype.LB=function(){return GS(lf(this.jz),lM)},Uj.prototype.set_m_localPointA=Uj.prototype.vE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ff(e,t)},Object.defineProperty(Uj.prototype,"m_localPointA",{get:Uj.prototype.LB,set:Uj.prototype.vE}),Uj.prototype.get_m_localPointB=Uj.prototype.MB=function(){return GS(cf(this.jz),lM)},Uj.prototype.set_m_localPointB=Uj.prototype.wE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),mf(e,t)},Object.defineProperty(Uj.prototype,"m_localPointB",{get:Uj.prototype.MB,set:Uj.prototype.wE}),Uj.prototype.get_m_positionWorldOnB=Uj.prototype.bC=function(){return GS(df(this.jz),lM)},Uj.prototype.set_m_positionWorldOnB=Uj.prototype.ME=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),gf(e,t)},Object.defineProperty(Uj.prototype,"m_positionWorldOnB",{get:Uj.prototype.bC,set:Uj.prototype.ME}),Uj.prototype.get_m_positionWorldOnA=Uj.prototype.aC=function(){return GS(pf(this.jz),lM)},Uj.prototype.set_m_positionWorldOnA=Uj.prototype.LE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),_f(e,t)},Object.defineProperty(Uj.prototype,"m_positionWorldOnA",{get:Uj.prototype.aC,set:Uj.prototype.LE}),Uj.prototype.get_m_normalWorldOnB=Uj.prototype.VB=function(){return GS(uf(this.jz),lM)},Uj.prototype.set_m_normalWorldOnB=Uj.prototype.FE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),yf(e,t)},Object.defineProperty(Uj.prototype,"m_normalWorldOnB",{get:Uj.prototype.VB,set:Uj.prototype.FE}),Uj.prototype.get_m_userPersistentData=Uj.prototype.CC=function(){return hf(this.jz)},Uj.prototype.set_m_userPersistentData=Uj.prototype.mF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),vf(e,t)},Object.defineProperty(Uj.prototype,"m_userPersistentData",{get:Uj.prototype.CC,set:Uj.prototype.mF}),Uj.prototype.__destroy__=function(){nf(this.jz)},Vj.prototype=Object.create(JS.prototype),Vj.prototype.constructor=Vj,Vj.prototype.kz=Vj,Vj.lz={},n.btPoint2PointConstraint=Vj,Vj.prototype.setPivotA=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Im(e,t)},Vj.prototype.setPivotB=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Pm(e,t)},Vj.prototype.getPivotInA=function(){return GS(Cm(this.jz),lM)},Vj.prototype.getPivotInB=function(){return GS(zm(this.jz),lM)},Vj.prototype.enableFeedback=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Sm(e,t)},Vj.prototype.getBreakingImpulseThreshold=function(){return Mm(this.jz)},Vj.prototype.setBreakingImpulseThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Am(e,t)},Vj.prototype.getParam=function(t,e){var n=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),jm(n,t,e)},Vj.prototype.setParam=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),Lm(r,t,e,n)},Vj.prototype.get_m_setting=Vj.prototype.iC=function(){return GS(Rm(this.jz),BM)},Vj.prototype.set_m_setting=Vj.prototype.TE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Om(e,t)},Object.defineProperty(Vj.prototype,"m_setting",{get:Vj.prototype.iC,set:Vj.prototype.TE}),Vj.prototype.__destroy__=function(){wm(this.jz)},Gj.prototype=Object.create(US.prototype),Gj.prototype.constructor=Gj,Gj.prototype.kz=Gj,Gj.lz={},n.btSoftBodyHelpers=Gj,Gj.prototype.CreateRope=function(t,e,n,r,i){var o=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),GS(dv(o,t,e,n,r,i),vj)},Gj.prototype.CreatePatch=function(t,e,n,r,i,o,a,s,l){var c=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),o&&"object"==typeof o&&(o=o.jz),a&&"object"==typeof a&&(a=a.jz),s&&"object"==typeof s&&(s=s.jz),l&&"object"==typeof l&&(l=l.jz),GS(pv(c,t,e,n,r,i,o,a,s,l),vj)},Gj.prototype.CreatePatchUV=function(t,n,r,i,o,a,s,l,c,u){var p=this.jz;return e.rz(),t&&"object"==typeof t&&(t=t.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),o&&"object"==typeof o&&(o=o.jz),a&&"object"==typeof a&&(a=a.jz),s&&"object"==typeof s&&(s=s.jz),l&&"object"==typeof l&&(l=l.jz),c&&"object"==typeof c&&(c=c.jz),"object"==typeof u&&(u=qS(u)),GS(uv(p,t,n,r,i,o,a,s,l,c,u),vj)},Gj.prototype.CreateEllipsoid=function(t,e,n,r){var i=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),GS(sv(i,t,e,n,r),vj)},Gj.prototype.CreateFromTriMesh=function(t,n,r,i,o){var a=this.jz;if(e.rz(),t&&"object"==typeof t&&(t=t.jz),"object"==typeof n&&(n=qS(n)),"object"==typeof r&&"object"==typeof r){var s=e.Nz(r,C);e.copy(r,C,s),r=s}return i&&"object"==typeof i&&(i=i.jz),o&&"object"==typeof o&&(o=o.jz),GS(cv(a,t,n,r,i,o),vj)},Gj.prototype.CreateFromConvexHull=function(t,e,n,r){var i=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),GS(lv(i,t,e,n,r),vj)},Gj.prototype.__destroy__=function(){hv(this.jz)},Wj.prototype=Object.create(US.prototype),Wj.prototype.constructor=Wj,Wj.prototype.kz=Wj,Wj.lz={},n.btBroadphaseProxy=Wj,Wj.prototype.get_m_collisionFilterGroup=Wj.prototype.mz=function(){return Ti(this.jz)},Wj.prototype.set_m_collisionFilterGroup=Wj.prototype.oz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Mi(e,t)},Object.defineProperty(Wj.prototype,"m_collisionFilterGroup",{get:Wj.prototype.mz,set:Wj.prototype.oz}),Wj.prototype.get_m_collisionFilterMask=Wj.prototype.nz=function(){return Si(this.jz)},Wj.prototype.set_m_collisionFilterMask=Wj.prototype.pz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ji(e,t)},Object.defineProperty(Wj.prototype,"m_collisionFilterMask",{get:Wj.prototype.nz,set:Wj.prototype.pz}),Wj.prototype.__destroy__=function(){Ei(this.jz)},qj.prototype=Object.create(yM.prototype),qj.prototype.constructor=qj,qj.prototype.kz=qj,qj.lz={},n.btTriangleIndexVertexArray=qj,qj.prototype.setScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),lw(e,t)},qj.prototype.__destroy__=function(){aw(this.jz)},Xj.prototype=Object.create(YS.prototype),Xj.prototype.constructor=Xj,Xj.prototype.kz=Xj,Xj.lz={},n.btBoxShape=Xj,Xj.prototype.setMargin=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),bi(e,t)},Xj.prototype.getMargin=function(){return gi(this.jz)},Xj.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),vi(e,t)},Xj.prototype.getLocalScaling=function(){return GS(_i(this.jz),lM)},Xj.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),yi(n,t,e)},Xj.prototype.__destroy__=function(){fi(this.jz)},Yj.prototype=Object.create(US.prototype),Yj.prototype.constructor=Yj,Yj.prototype.kz=Yj,Yj.lz={},n.btFace=Yj,Yj.prototype.get_m_indices=Yj.prototype.CB=function(){return GS(vp(this.jz),bj)},Yj.prototype.set_m_indices=Yj.prototype.mE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),xp(e,t)},Object.defineProperty(Yj.prototype,"m_indices",{get:Yj.prototype.CB,set:Yj.prototype.mE}),Yj.prototype.get_m_plane=Yj.prototype.$B=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),bp(e,t)},Yj.prototype.set_m_plane=Yj.prototype.KE=function(t,n){var r=this.jz;e.rz(),t&&"object"==typeof t&&(t=t.jz),n&&"object"==typeof n&&(n=n.jz),wp(r,t,n)},Object.defineProperty(Yj.prototype,"m_plane",{get:Yj.prototype.$B,set:Yj.prototype.KE}),Yj.prototype.__destroy__=function(){gp(this.jz)},Qj.prototype=Object.create(eM.prototype),Qj.prototype.constructor=Qj,Qj.prototype.kz=Qj,Qj.lz={},n.DebugDrawer=Qj,Qj.prototype.drawLine=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),Un(r,t,e,n)},Qj.prototype.drawContactPoint=function(t,e,n,r,i){var o=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),i&&"object"==typeof i&&(i=i.jz),Nn(o,t,e,n,r,i)},Qj.prototype.reportErrorWarning=function(t){var n=this.jz;e.rz(),t=t&&"object"==typeof t?t.jz:WS(t),Gn(n,t)},Qj.prototype.draw3dText=function(t,n){var r=this.jz;e.rz(),t&&"object"==typeof t&&(t=t.jz),n=n&&"object"==typeof n?n.jz:WS(n),Fn(r,t,n)},Qj.prototype.setDebugMode=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Wn(e,t)},Qj.prototype.getDebugMode=function(){return Vn(this.jz)},Qj.prototype.__destroy__=function(){Hn(this.jz)},Zj.prototype=Object.create(tM.prototype),Zj.prototype.constructor=Zj,Zj.prototype.kz=Zj,Zj.lz={},n.btCapsuleShapeX=Zj,Zj.prototype.setMargin=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Vi(e,t)},Zj.prototype.getMargin=function(){return Hi(this.jz)},Zj.prototype.getUpAxis=function(){return Ni(this.jz)},Zj.prototype.getRadius=function(){return Fi(this.jz)},Zj.prototype.getHalfHeight=function(){return Bi(this.jz)},Zj.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ui(e,t)},Zj.prototype.getLocalScaling=function(){return GS(Di(this.jz),lM)},Zj.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),ki(n,t,e)},Zj.prototype.__destroy__=function(){Pi(this.jz)},Jj.prototype=Object.create(uM.prototype),Jj.prototype.constructor=Jj,Jj.prototype.kz=Jj,Jj.lz={},n.btQuaternion=Jj,Jj.prototype.setValue=function(t,e,n,r){var i=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),r&&"object"==typeof r&&(r=r.jz),py(i,t,e,n,r)},Jj.prototype.setEulerZYX=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),cy(r,t,e,n)},Jj.prototype.setRotation=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),uy(n,t,e)},Jj.prototype.normalize=Jj.prototype.normalize=function(){ny(this.jz)},Jj.prototype.length2=function(){return ty(this.jz)},Jj.prototype.length=Jj.prototype.length=function(){return ey(this.jz)},Jj.prototype.dot=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),Qm(e,t)},Jj.prototype.normalized=function(){return GS(ry(this.jz),Jj)},Jj.prototype.getAxis=function(){return GS(Km(this.jz),lM)},Jj.prototype.inverse=Jj.prototype.inverse=function(){return GS($m(this.jz),Jj)},Jj.prototype.getAngle=function(){return Jm(this.jz)},Jj.prototype.getAngleShortestPath=function(){return Zm(this.jz)},Jj.prototype.angle=Jj.prototype.angle=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),Xm(e,t)},Jj.prototype.angleShortestPath=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),qm(e,t)},Jj.prototype.op_add=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(iy(e,t),Jj)},Jj.prototype.op_sub=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(ly(e,t),Jj)},Jj.prototype.op_mul=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(ay(e,t),Jj)},Jj.prototype.op_mulq=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(sy(e,t),Jj)},Jj.prototype.op_div=function(t){var e=this.jz;return t&&"object"==typeof t&&(t=t.jz),GS(oy(e,t),Jj)},Jj.prototype.x=Jj.prototype.x=function(){return _y(this.jz)},Jj.prototype.y=Jj.prototype.y=function(){return gy(this.jz)},Jj.prototype.z=Jj.prototype.z=function(){return vy(this.jz)},Jj.prototype.w=function(){return yy(this.jz)},Jj.prototype.setX=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),hy(e,t)},Jj.prototype.setY=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),fy(e,t)},Jj.prototype.setZ=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),my(e,t)},Jj.prototype.setW=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),dy(e,t)},Jj.prototype.__destroy__=function(){Wm(this.jz)},Kj.prototype=Object.create(tM.prototype),Kj.prototype.constructor=Kj,Kj.prototype.kz=Kj,Kj.lz={},n.btCapsuleShapeZ=Kj,Kj.prototype.setMargin=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),$i(e,t)},Kj.prototype.getMargin=function(){return Qi(this.jz)},Kj.prototype.getUpAxis=function(){return Ji(this.jz)},Kj.prototype.getRadius=function(){return Zi(this.jz)},Kj.prototype.getHalfHeight=function(){return Xi(this.jz)},Kj.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ki(e,t)},Kj.prototype.getLocalScaling=function(){return GS(Yi(this.jz),lM)},Kj.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),qi(n,t,e)},Kj.prototype.__destroy__=function(){Gi(this.jz)},$j.prototype=Object.create(US.prototype),$j.prototype.constructor=$j,$j.prototype.kz=$j,$j.lz={},n.btContactSolverInfo=$j,$j.prototype.get_m_splitImpulse=$j.prototype.lC=function(){return!!ol(this.jz)},$j.prototype.set_m_splitImpulse=$j.prototype.WE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ll(e,t)},Object.defineProperty($j.prototype,"m_splitImpulse",{get:$j.prototype.lC,set:$j.prototype.WE}),$j.prototype.get_m_splitImpulsePenetrationThreshold=$j.prototype.mC=function(){return il(this.jz)},$j.prototype.set_m_splitImpulsePenetrationThreshold=$j.prototype.XE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),sl(e,t)},Object.defineProperty($j.prototype,"m_splitImpulsePenetrationThreshold",{get:$j.prototype.mC,set:$j.prototype.XE}),$j.prototype.get_m_numIterations=$j.prototype.WB=function(){return rl(this.jz)},$j.prototype.set_m_numIterations=$j.prototype.GE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),al(e,t)},Object.defineProperty($j.prototype,"m_numIterations",{get:$j.prototype.WB,set:$j.prototype.GE}),$j.prototype.__destroy__=function(){nl(this.jz)},tC.prototype=Object.create(US.prototype),tC.prototype.constructor=tC,tC.prototype.kz=tC,tC.lz={},n.btTriangleInfoMap=tC,tC.prototype.generateInternalEdgeInfo=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),pw(e,t)},tC.prototype.get_m_convexEpsilon=tC.prototype.cB=function(){return dw(this.jz)},tC.prototype.set_m_convexEpsilon=tC.prototype.ND=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),gw(e,t)},Object.defineProperty(tC.prototype,"m_convexEpsilon",{get:tC.prototype.cB,set:tC.prototype.ND}),tC.prototype.get_m_planarEpsilon=tC.prototype.ZB=function(){return yw(this.jz)},tC.prototype.set_m_planarEpsilon=tC.prototype.JE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),ww(e,t)},Object.defineProperty(tC.prototype,"m_planarEpsilon",{get:tC.prototype.ZB,set:tC.prototype.JE}),tC.prototype.get_m_equalVertexThreshold=tC.prototype.lB=function(){return fw(this.jz)},tC.prototype.set_m_equalVertexThreshold=tC.prototype.WD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),bw(e,t)},Object.defineProperty(tC.prototype,"m_equalVertexThreshold",{get:tC.prototype.lB,set:tC.prototype.WD}),tC.prototype.get_m_edgeDistanceThreshold=tC.prototype.hB=function(){return hw(this.jz)},tC.prototype.set_m_edgeDistanceThreshold=tC.prototype.SD=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),vw(e,t)},Object.defineProperty(tC.prototype,"m_edgeDistanceThreshold",{get:tC.prototype.hB,set:tC.prototype.SD}),tC.prototype.get_m_maxEdgeAngleThreshold=tC.prototype.QB=function(){return mw(this.jz)},tC.prototype.set_m_maxEdgeAngleThreshold=tC.prototype.AE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),xw(e,t)},Object.defineProperty(tC.prototype,"m_maxEdgeAngleThreshold",{get:tC.prototype.QB,set:tC.prototype.AE}),tC.prototype.get_m_zeroAreaThreshold=tC.prototype.MC=function(){return _w(this.jz)},tC.prototype.set_m_zeroAreaThreshold=tC.prototype.wF=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Ew(e,t)},Object.defineProperty(tC.prototype,"m_zeroAreaThreshold",{get:tC.prototype.MC,set:tC.prototype.wF}),tC.prototype.__destroy__=function(){cw(this.jz)},eC.prototype=Object.create(mM.prototype),eC.prototype.constructor=eC,eC.prototype.kz=eC,eC.lz={},n.btGeneric6DofSpringConstraint=eC,eC.prototype.enableSpring=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Xp(n,t,e)},eC.prototype.setStiffness=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),sd(n,t,e)},eC.prototype.setDamping=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),td(n,t,e)},eC.prototype.setEquilibriumPoint=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),void 0===t?ed(n):void 0===e?nd(n,t):rd(n,t,e)},eC.prototype.setLinearLowerLimit=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),id(e,t)},eC.prototype.setLinearUpperLimit=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),od(e,t)},eC.prototype.setAngularLowerLimit=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Jp(e,t)},eC.prototype.setAngularUpperLimit=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Kp(e,t)},eC.prototype.getFrameOffsetA=function(){return GS(Qp(this.jz),Pj)},eC.prototype.enableFeedback=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),qp(e,t)},eC.prototype.getBreakingImpulseThreshold=function(){return Yp(this.jz)},eC.prototype.setBreakingImpulseThreshold=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),$p(e,t)},eC.prototype.getParam=function(t,e){var n=this.jz;return t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),Zp(n,t,e)},eC.prototype.setParam=function(t,e,n){var r=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),n&&"object"==typeof n&&(n=n.jz),ad(r,t,e,n)},eC.prototype.__destroy__=function(){Vp(this.jz)},nC.prototype=Object.create(YS.prototype),nC.prototype.constructor=nC,nC.prototype.kz=nC,nC.lz={},n.btSphereShape=nC,nC.prototype.setMargin=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Fx(e,t)},nC.prototype.getMargin=function(){return Dx(this.jz)},nC.prototype.setLocalScaling=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),Hx(e,t)},nC.prototype.getLocalScaling=function(){return GS(Bx(this.jz),lM)},nC.prototype.calculateLocalInertia=function(t,e){var n=this.jz;t&&"object"==typeof t&&(t=t.jz),e&&"object"==typeof e&&(e=e.jz),kx(n,t,e)},nC.prototype.__destroy__=function(){Px(this.jz)},rC.prototype=Object.create(US.prototype),rC.prototype.constructor=rC,rC.prototype.kz=rC,rC.lz={},n.LocalConvexResult=rC,rC.prototype.get_m_hitCollisionObject=rC.prototype.Az=function(){return GS(Yn(this.jz),QS)},rC.prototype.set_m_hitCollisionObject=rC.prototype.Iz=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),$n(e,t)},Object.defineProperty(rC.prototype,"m_hitCollisionObject",{get:rC.prototype.Az,set:rC.prototype.Iz}),rC.prototype.get_m_localShapeInfo=rC.prototype.NB=function(){return GS(Kn(this.jz),DM)},rC.prototype.set_m_localShapeInfo=rC.prototype.xE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),rr(e,t)},Object.defineProperty(rC.prototype,"m_localShapeInfo",{get:rC.prototype.NB,set:rC.prototype.xE}),rC.prototype.get_m_hitNormalLocal=rC.prototype.xB=function(){return GS(Zn(this.jz),lM)},rC.prototype.set_m_hitNormalLocal=rC.prototype.hE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),er(e,t)},Object.defineProperty(rC.prototype,"m_hitNormalLocal",{get:rC.prototype.xB,set:rC.prototype.hE}),rC.prototype.get_m_hitPointLocal=rC.prototype.zB=function(){return GS(Jn(this.jz),lM)},rC.prototype.set_m_hitPointLocal=rC.prototype.jE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),nr(e,t)},Object.defineProperty(rC.prototype,"m_hitPointLocal",{get:rC.prototype.zB,set:rC.prototype.jE}),rC.prototype.get_m_hitFraction=rC.prototype.uB=function(){return Qn(this.jz)},rC.prototype.set_m_hitFraction=rC.prototype.eE=function(t){var e=this.jz;t&&"object"==typeof t&&(t=t.jz),tr(e,t)},Object.defineProperty(rC.prototype,"m_hitFraction",{get:rC.prototype.uB,set:rC.prototype.eE}),rC.prototype.__destroy__=function(){Xn(this.jz)},function(){function t(){n.BT_CONSTRAINT_ERP=DS(),n.BT_CONSTRAINT_STOP_ERP=FS(),n.BT_CONSTRAINT_CFM=BS(),n.BT_CONSTRAINT_STOP_CFM=HS(),n.PHY_FLOAT=IS(),n.PHY_DOUBLE=AS(),n.PHY_INTEGER=PS(),n.PHY_SHORT=OS(),n.PHY_FIXEDPOINT88=LS(),n.PHY_UCHAR=kS()}B?t():O.unshift(t)}(),this.Ammo=n,t});"object"==typeof exports&&"object"==typeof module?module.exports=v:"function"==typeof define&&define.amd?define([],function(){return v}):"object"==typeof exports&&(exports.Ammo=v);var b,x="176.31.106.24:4555",w="s.lolbeans.io",E=60,T=.5,S=1.75,M=16,j=2,C=1,z=0,R=30,A=10,L=.05,I=3.5,P=10,O=0,k=30,B=130,D=18,H=6,F=6,N=.5,U=.35,V=80,G=45,W=2,q=16,X=64,Y=128,Q=512,Z=0,J=1,K=2,$=3,tt=4,et=5,nt=!0,rt=Math.PI/2,it=500,ot=!1,at=.35,st=!1,lt=.05,ct=!0,ut=40,pt=!1,dt=!1,ht=!1,ft=!1,mt=!1,yt=!1,_t=!1,gt=!1,vt=!1,bt=.05,xt=5,wt=100,Et=!0,Tt=!1,St=18,Mt=9,jt=5,Ct=10,zt=100,Rt=!1,At=!0,Lt=!1,It=window.cordova||(b=navigator.userAgent||navigator.vendor||window.opera,!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(b)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4))))||"MacIntel"===navigator.platform&&void 0!==navigator.maxTouchPoints&&navigator.maxTouchPoints>1,Pt=window.cordova?-1!==navigator.userAgent.indexOf("iPhone")||-1!==navigator.userAgent.indexOf("iPad"):-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&-1===navigator.userAgent.indexOf("Chromium"),Ot=It&&Pt;function kt(t){var e=document.createElement("div");e.style.position="absolute",e.style.left="0%",e.style.width="100%",e.style.textAlign="center",e.style.zIndex=1e3,e.style.fontSize="3vh",e.style.color="white",e.style.fontWeight="700",e.style["-webkit-text-stroke"]="1px black",e.style.pointerEvents="none",e.style.userSelect="none",e.innerHTML=t,document.body.appendChild(e),anime({targets:e,bottom:["0%","5%"],opacity:[0,1],duration:1e3,easing:"easeOutQuart",complete:function(){anime({targets:e,opacity:0,duration:1e3,complete:function(){document.body.removeChild(e)}})}})}function Bt(t,e){for(var n=0;n<t.animations.length;n++)if(t.animations[n].name==e)return t.animations[n];return null}function Dt(t){for(;t<-Math.PI;)t+=2*Math.PI;for(;t>Math.PI;)t-=2*Math.PI;return t}function Ht(t){var e=new THREE.Color(t).getHSL({});return new THREE.Vector3(e.h,e.s,e.l)}var Ft={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},easeInBack:function(t){return 2.70158*t*t*t-1.70158*t*t}};function Nt(t){return"rgb("+[(16711680&(t>>>=0))>>>16,(65280&t)>>>8,255&t].join(",")+")"}function Ut(t){return t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}function Vt(t){this.maxEntries=t,this.count=0,this.sum=0,this.index=0,this.values=[]}Vt.prototype.addEntry=function(t){this.sum+=t,this.count==this.maxEntries?(this.sum-=this.values[this.index],this.values[this.index]=t,this.index=(this.index+1)%this.maxEntries):(this.count++,this.values.push(t))},Vt.prototype.getValue=function(){return this.sum/this.count};var Gt,Wt,qt=new THREE.Matrix4,Xt=new THREE.Vector3;function Yt(t){if(t instanceof THREE.Mesh)return t;for(var e=0;e<t.children.length;e++){var n=Yt(t.children[e]);if(n)return n}return null}function Qt(t,e){var n=2*Math.tan(e.fov*Math.PI/180/2)*Math.abs(t);return{width:n*e.aspect,height:n}}function Zt(){var t=document.getElementById("players-qualified"),e=document.getElementById("players-joined");lc==J?(t.classList.remove("active"),e.classList.add("active")):lc==K||lc==$?(t.classList.add("active"),e.classList.remove("active")):(t.classList.remove("active"),e.classList.remove("active")),Jt(),Kt()}function Jt(){zc&&(document.getElementById("players-joined").textContent=oc.length+"/"+zc)}function Kt(){zc&&(document.getElementById("players-qualified").textContent=Dc+"/"+zc)}THREE.Quaternion.prototype.setFromScaledRotationMatrix=function(t){var e=t.elements,n=Xt.set(e[0],e[1],e[2]).length(),r=Xt.set(e[4],e[5],e[6]).length(),i=Xt.set(e[8],e[9],e[10]).length();t.determinant()<0&&(n=-n),qt.copy(t);var o=1/n,a=1/r,s=1/i;return qt.elements[0]*=o,qt.elements[1]*=o,qt.elements[2]*=o,qt.elements[4]*=a,qt.elements[5]*=a,qt.elements[6]*=a,qt.elements[8]*=s,qt.elements[9]*=s,qt.elements[10]*=s,this.setFromRotationMatrix(qt)};var $t={GradientNoise:"\n\nvec2 gradientNoise_dir(vec2 p)\n{\n    p = mod(p, 289.0);\n    float x = mod((34.0 * p.x + 1.0) * p.x, 289.0) + p.y;\n    x = mod((34.0 * x + 1.0) * x, 289.0);\n    x = fract(x / 41.0) * 2.0 - 1.0;\n    return normalize(vec2(x - floor(x + 0.5), abs(x) - 0.5));\n}\n\nfloat gradientNoise(vec2 p)\n{\n    vec2 ip = floor(p);\n    vec2 fp = fract(p);\n    float d00 = dot(gradientNoise_dir(ip), fp);\n    float d01 = dot(gradientNoise_dir(ip + vec2(0.0, 1.0)), fp - vec2(0.0, 1.0));\n    float d10 = dot(gradientNoise_dir(ip + vec2(1.0, 0.0)), fp - vec2(1.0, 0.0));\n    float d11 = dot(gradientNoise_dir(ip + vec2(1.0, 1.0)), fp - vec2(1.0, 1.0));\n    fp = fp * fp * fp * (fp * (fp * 6.0 - 15.0) + 10.0);\n    return mix(mix(d00, d01, fp.y), mix(d10, d11, fp.y), fp.x);\n}\n\nvoid gradientNoise_float(vec2 UV, float Scale, out float Out)\n{\n    Out = gradientNoise(UV * Scale) + 0.5;\n}",Voronoi:"\nvec2 voronoi_noise_randomVector (vec2 UV, float offset)\n{\n    mat2 m = mat2(15.27, 47.63, 99.41, 89.98);\n    UV = fract(sin(UV * m) * 46839.32);\n    return vec2(sin(UV.y*+offset)*0.5+0.5, cos(UV.x*offset)*0.5+0.5);\n}\n\nvoid Voronoi_float(vec2 UV, float AngleOffset, float CellDensity, out float Out, out float Cells)\n{\n    vec2 g = floor(UV * CellDensity);\n    vec2 f = fract(UV * CellDensity);\n    float t = 8.0;\n    vec3 res = vec3(8.0, 0.0, 0.0);\n\n    for(int y=-1; y<=1; y++)\n    {\n        for(int x=-1; x<=1; x++)\n        {\n            vec2 lattice = vec2(x,y);\n            vec2 offset = voronoi_noise_randomVector(lattice + g, AngleOffset);\n            float d = distance(lattice + offset, f);\n            if(d < res.x)\n            {\n                res = vec3(d, offset.x, offset.y);\n                Out = res.x;\n                Cells = res.y;\n            }\n        }\n    }\n}",QuadraticBezier:"\nvoid QuadraticBezier(float t, vec3 p0, vec3 p1, vec3 p2, out vec3 point) {\n    float k = 1.0 - t;\n    point = k * k * p0 + 2.0 * k * t * p1 + t * t * p2;\n}"};function te(t,e,n){var r=new THREE.BoxBufferGeometry(1,1,1),i=new THREE.MeshBasicMaterial({color:e,transparent:!0,opacity:n});THREE.Mesh.call(this,r,i),this.beamWidth=t,this.startPosition=new THREE.Vector3,this.endPosition=new THREE.Vector3,this.forwardVector=new THREE.Vector3(0,0,1),r=new THREE.CircleBufferGeometry(30*t,16),i=new THREE.MeshBasicMaterial({color:e,transparent:!0,opacity:n,side:THREE.DoubleSide,depthTest:!1});var o=new THREE.Mesh(r,i);this.endCircle=o,vl.add(o),this.updateBeam()}function ee(t,e,n,r,i){var o=new THREE.MeshBasicMaterial({color:n,transparent:!0,opacity:r,blending:THREE.AdditiveBlending});this.beamWidth=t,this.beamSegments=e,this.shootingPlayer=i,this.startPosition=new THREE.Vector3,this.endPosition=new THREE.Vector3,this.midPosition=new THREE.Vector3,this.forwardVector=new THREE.Vector3(0,0,1),this.lookAtVector=new THREE.Quaternion,this.phaseCounter=0,this.curve=new THREE.QuadraticBezierCurve3(this.startPosition,this.midPosition,this.endPosition),this.geometry=new THREE.TubeBufferGeometry(this.curve,this.beamSegments,this.beamWidth,5,!1),THREE.Mesh.call(this,this.geometry,o),this.updateBeam()}function ne(t,e,n){var r=46839.32*Math.sin(15.27*t.x+47.63*t.y)%1,i=46839.32*Math.sin(99.41*t.x+89.98*t.y)%1;n.x=.5*Math.sin(i*e)+.5,n.y=.5*Math.cos(r*e)+.5}function re(t,e,n){for(var r=new THREE.Vector2(Math.floor(t.x*n),Math.floor(t.y*n)),i=new THREE.Vector2(t.x*n%1,t.y*n%1),o=8,a=new THREE.Vector2,s=-1;s<=1;s++)for(var l=-1;l<=1;l++){ne({x:l+r.x,y:s+r.y},e,a),a.x+=l,a.y+=s;var c=i.distanceTo(a);c<o&&(o=c)}return o}function oe(t){t.x=t.x%289,t.y=t.y%289;var e=(34*t.x+1)*t.x%289+t.y;return e=(e=(34*e+1)*e%289)/41%1*2-1,t.set(e-Math.floor(e+.5),Math.abs(e)-.5).normalize()}function ae(t,e){return function(t){var e=t.clone().floor(),n=new THREE.Vector2(t.x%1,t.y%1),r=oe(e.clone()).dot(n),i=oe(new THREE.Vector2(0,1).add(e)).dot(new THREE.Vector2(-0,-1).add(n)),o=oe(new THREE.Vector2(1,0).add(e)).dot(new THREE.Vector2(-1,-0).add(n)),a=oe(new THREE.Vector2(1,1).add(e)).dot(new THREE.Vector2(-1,-1).add(n));n.x=n.x*n.x*n.x*(n.x*(6*n.x-15)+10),n.y=n.y*n.y*n.y*(n.y*(6*n.y-15)+10);var s=r*(1-n.y)+i*n.y,l=o*(1-n.y)+a*n.y;return s*(1-n.x)+l*n.x}(t.multiplyScalar(e))+.5}function se(t,e){this.flameCount=t||10,e||(e={});var n=new THREE.BufferGeometry;n.setAttribute("position",new THREE.BufferAttribute(new Float32Array(4*t*3),3,!1)),n.setAttribute("uv",new THREE.BufferAttribute(new Float32Array(4*t*2),2,!1)),n.setAttribute("opacity",new THREE.BufferAttribute(new Float32Array(4*t*1),1,!1)),n.setAttribute("timeOffset",new THREE.BufferAttribute(new Float32Array(4*t*1),1,!1)),n.setAttribute("vertexIndex",new THREE.BufferAttribute(new Float32Array(4*t*1),1,!1));for(var r=n.getAttribute("uv"),i=(n.getAttribute("position"),n.getAttribute("vertexIndex")),o=[],a=0;a<t;a++)r.setXY(4*a+0,0,0),r.setXY(4*a+1,1,0),r.setXY(4*a+2,1,1),r.setXY(4*a+3,0,1),i.setX(4*a+0,0),i.setX(4*a+1,1),i.setX(4*a+2,2),i.setX(4*a+3,3),o.push(4*a+0,4*a+1,4*a+2,4*a+0,4*a+2,4*a+3);n.setIndex(o);var s="\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n\nuniform vec3 color;\nuniform float colorIntensity;\n\nuniform float time;\nuniform vec2 distortionSpeed;\nuniform float distortionAmount;\nuniform float distortionScale;\nuniform vec2 dissolveSpeed;\nuniform float dissolveScale;\nuniform float dissolveAmount;\nuniform float verticalErosion;\n"+(0==FLAMESET_OPTIMIZATION?"":"\nuniform sampler2D voronoiMap;\nuniform vec2 voronoiScale;\nuniform sampler2D gradientNoiseMap;\nuniform vec2 gradientNoiseScale;\n")+"\nvarying float vOpacity;\nvarying float vTimeOffset;\n\n"+$t.GradientNoise+$t.Voronoi+"\n\nvoid main() {\n\n    if (vOpacity == 0.0) {\n\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n\n    } else {\n\n    float noise;"+(0==FLAMESET_OPTIMIZATION?"\n    gradientNoise_float(vUv + distortionSpeed*(time+vTimeOffset), distortionScale, noise);\n    ":"\n    vec2 startUV = vec2(distortionSpeed.x >= 0.0 ? 0.0 : 1.0 - 1.0/gradientNoiseScale.x, distortionSpeed.y >= 0.0 ? 0.0 : 1.0 - 1.0/gradientNoiseScale.y);\n    noise = texture2D(gradientNoiseMap, startUV + vUv / gradientNoiseScale + distortionSpeed*(time+vTimeOffset)/ gradientNoiseScale).x;\n    ")+"\n    //noise = pow(noise, 0.454545);\n    //noise = pow(noise, 0.7);\n\n    float voronoi, cells;"+(0==FLAMESET_OPTIMIZATION?"\n    Voronoi_float(vUv + dissolveSpeed*(time+vTimeOffset), 2.0, dissolveScale, voronoi, cells);\n    ":"\n    vec2 startUV2 = vec2(dissolveSpeed.x >= 0.0 ? 0.0 : 1.0 - 1.0/voronoiScale.x, dissolveSpeed.y >= 0.0 ? 0.0 : 1.0 - 1.0/voronoiScale.y);\n    voronoi = texture2D(voronoiMap, startUV2 + vUv / voronoiScale + dissolveSpeed*(time+vTimeOffset)/ voronoiScale).x;\n    ")+"\n    //voronoi = pow(voronoi, 0.454545);\n    voronoi = pow(voronoi, dissolveAmount);\n\n    vec2 uv = mix(vUv, vec2(noise,noise), distortionAmount);\n\n\t//#include <map_fragment>\n    vec4 texelColor = texture2D( map, uv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\n    gl_FragColor = pow(2.0, colorIntensity) * texelColor * voronoi * noise * vec4( color, vOpacity );\n    //gl_FragColor = vec4(voronoi, voronoi, voronoi, 1.0);\n    //gl_FragColor = vec4(noise, noise, noise, 1.0);\n\n    if (verticalErosion > 0.0)\n        gl_FragColor.a *= pow(1.0 - vUv.y, verticalErosion);\n\n    float borderDistanceThreshold = 0.2;\n    float borderErosionPower = 3.0;\n    float dstToBorder = min(vUv.y, min(vUv.x, min(1.0 - vUv.y, 1.0 - vUv.x)));\n    if (dstToBorder < borderDistanceThreshold)\n        gl_FragColor.a *= pow(dstToBorder / borderDistanceThreshold, borderErosionPower);\n\n//    if (gl_FragColor.a <= 0.0) {//try to set border\n//        vec2 uvShift = vec2(0.0,0.01);\n//        vec2 vUv2 = vUv + uvShift;\n//        gradientNoise_float(vUv2 + distortionSpeed*(time+vTimeOffset), distortionScale, noise);\n//        Voronoi_float(vUv2 + dissolveSpeed*(time+vTimeOffset), 2.0, dissolveScale, voronoi, cells);\n//        uv = mix(vUv2, vec2(noise,noise), distortionAmount);\n//        texelColor = texture2D( map, uv );\n//\t    texelColor = mapTexelToLinear( texelColor );\n//\n//        float neighborA = pow(2.0, colorIntensity) * texelColor.a * voronoi * noise * vOpacity;\n//        if (neighborA > 0.0) {\n//            gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0); //border color\n//        }\n//    }\n\n    //gl_FragColor = vec4(1.0,1.0,1.0,texelColor);\n    //gl_FragColor = vec4(1.0,1.0,1.0,noise);\n    //gl_FragColor = vec4(1.0,1.0,1.0,voronoi);\n    //gl_FragColor = vec4(1.0,1.0,1.0,voronoi * noise);\n\n    //#include <encodings_fragment>\n\n    }\n}\n",l=e.randomTimeRange||0,c=e.dissolveSpeedX||1,u=e.dissolveSpeedY||1,p=e.distortionSpeedX||1,d=e.distortionSpeedY||1,h=new THREE.Vector2(1+(l+weaponSpecs.stickyFire.lifetime/E)*Math.abs(c),1+(l+weaponSpecs.stickyFire.lifetime/E)*Math.abs(u)),f=new THREE.Vector2(1+(l+weaponSpecs.stickyFire.lifetime/E)*Math.abs(p),1+(l+weaponSpecs.stickyFire.lifetime/E)*Math.abs(d)),m=new THREE.ShaderMaterial({blending:e.blending||THREE.NormalBlending,uniforms:{color:{value:new THREE.Color(e.color||"#FF4123")},map:{value:mc.flame},voronoiMap:{value:0==FLAMESET_OPTIMIZATION?null:1==FLAMESET_OPTIMIZATION?new THREE.CanvasTexture(function(t,e,n,r){var i=document.createElement("canvas"),o=i.getContext("2d");i.width=128*e,i.height=128*n;for(var a=o.getImageData(0,0,i.width,i.height),s=new THREE.Vector2,l=0;l<i.height;l++)for(var c=0;c<i.width;c++){var u=l*i.width*4+4*c,p=255*re(s.set(c/i.width*e,l/i.height*n),2,r);a.data[u+0]=p,a.data[u+1]=p,a.data[u+2]=p,a.data[u+3]=255}return o.putImageData(a,0,0),i}(0,h.x,h.y,e.dissolveScale||1)):mc[e.voronoiMap]},voronoiScale:{value:h},gradientNoiseMap:{value:0==FLAMESET_OPTIMIZATION?null:1==FLAMESET_OPTIMIZATION?new THREE.CanvasTexture(function(t,e,n,r){var i=document.createElement("canvas"),o=i.getContext("2d");i.width=128*e,i.height=128*n;for(var a=o.getImageData(0,0,i.width,i.height),s=new THREE.Vector2,l=0;l<i.height;l++)for(var c=0;c<i.width;c++){var u=l*i.width*4+4*c,p=255*ae(s.set(c/i.width*e,l/i.height*n),r);a.data[u+0]=p,a.data[u+1]=p,a.data[u+2]=p,a.data[u+3]=255}return o.putImageData(a,0,0),i}(0,f.x,f.y,e.distortionScale||1)):mc[e.gradientNoiseMap]},gradientNoiseScale:{value:f},uvTransform:{value:new THREE.Matrix3},time:{value:0},distortionSpeed:{value:new THREE.Vector2(p,d)},distortionAmount:{value:e.distortionAmount||1},distortionScale:{value:e.distortionScale||1},dissolveSpeed:{value:new THREE.Vector2(c,u)},dissolveScale:{value:e.dissolveScale||1},dissolveAmount:{value:e.dissolveAmount||1},colorIntensity:{value:e.colorIntensity||1},verticalErosion:{value:e.verticalErosion||0},opacity:e.opacity||1},vertexShader:"\n#include <common>\n#include <uv_pars_vertex>\n\nattribute float vertexIndex;\nattribute float opacity;\nvarying float vOpacity;\nattribute float timeOffset;\nvarying float vTimeOffset;\n\nvoid main() {\n\t//#include <uv_vertex>\n\t//vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tvUv = uv;\n\n    vOpacity = opacity;\n    vTimeOffset = timeOffset;\n\n    if (opacity > 0.0) {\n\n        vec2 scale;\n        scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n        scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n        mat4 modelViewMatrixUnScaled = modelViewMatrix;\n        modelViewMatrixUnScaled[0].x /= scale.x;\n        modelViewMatrixUnScaled[0].y /= scale.x;\n        modelViewMatrixUnScaled[0].z /= scale.x;\n        modelViewMatrixUnScaled[1].x /= scale.y;\n        modelViewMatrixUnScaled[1].y /= scale.y;\n        modelViewMatrixUnScaled[1].z /= scale.y;\n\n        vec3 offset;\n        if (vertexIndex == 0.0) {\n            offset = vec3(-0.5,-0.5,0.0);\n        } else if (vertexIndex == 1.0) {\n            offset = vec3(0.5,-0.5,0.0);\n        } else if (vertexIndex == 2.0) {\n            offset = vec3(0.5,0.5,0.0);\n        } else {\n            offset = vec3(-0.5,0.5,0.0);\n        }\n\n        vec4 mvPosition = modelViewMatrixUnScaled  * vec4( position, 1.0 );\n        mvPosition.xyz += offset * vec3(scale, 1.0);\n        gl_Position = projectionMatrix * mvPosition;\n\n    }\n}\n",fragmentShader:s,depthTest:!0,depthWrite:!1,transparent:!0});for(m.map=m.uniforms.map,m.uniforms.voronoiMap.value&&(m.uniforms.voronoiMap.value.wrapS=THREE.MirroredRepeatWrapping,m.uniforms.voronoiMap.value.wrapT=THREE.MirroredRepeatWrapping),m.uniforms.gradientNoiseMap.value&&(m.uniforms.gradientNoiseMap.value.wrapS=THREE.MirroredRepeatWrapping,m.uniforms.gradientNoiseMap.value.wrapT=THREE.MirroredRepeatWrapping),THREE.Mesh.call(this,n,m),this.frustumCulled=!1,this.flamePool=[],a=0;a<this.flameCount;a++)this.flamePool.push(a)}function le(t,e,n,r){this.beamWidth=t,this.beamSegments=e,this.shootingPlayer=r,this.startPosition=new THREE.Vector3,this.endPosition=new THREE.Vector3,this.midPosition=new THREE.Vector3,this.forwardVector=new THREE.Vector3(0,0,1),this.lookAtVector=new THREE.Quaternion;var i=e,o=new THREE.BufferGeometry;o.setAttribute("position",new THREE.BufferAttribute(new Float32Array(2*i*3),3,!1)),o.setAttribute("uv",new THREE.BufferAttribute(new Float32Array(2*i*2),2,!1));for(var a=o.getAttribute("position"),s=o.getAttribute("uv"),l=[],c=0;c<i;c++)a.setXYZ(2*c+0,t/2,0,c),a.setXYZ(2*c+1,-t/2,0,c),s.setXY(2*c+0,c/(i-1),0),s.setXY(2*c+1,c/(i-1),1),c>0&&l.push(2*c-1,2*c-2,2*c,2*c-1,2*c,2*c+1);o.setIndex(l);var u="\nuniform float time;\nuniform float speed;\nuniform float shiftSpeed;\nuniform float ringCount;\nuniform float timeOffsetPerRing;\nuniform float beamLength;\nuniform vec2 distortionSpeedVertical;\nuniform vec2 distortionSpeedHorizontal;\nuniform vec2 distortionScale;\nuniform vec2 distortionAmplitude;\nuniform vec2 resolution;\nuniform vec3 startPosition;\nuniform vec3 midPosition;\nuniform vec3 endPosition;\n\nvarying float vVertexRing;\n\n#include <uv_pars_vertex>\n\n"+$t.GradientNoise+"\n"+$t.QuadraticBezier+"\n\nvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t// conservative estimate of the near plane\n\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\tfloat nearEstimate = - 0.5 * b / a;\n\n\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\tend.xyz = mix( start.xyz, end.xyz, alpha );\n}\n\n#define M_PI 3.1415926535897932384626433832795\n\nvoid main() {\n    float vertexRing = position.z;\n    float lineWidth = abs(position.x) * 2.0;\n\n//    //float bulgePosition = mod(shiftSpeed * time + vertexRing, ringCount);\n//    float bulgePosition = 10.0;\n//    if (abs(bulgePosition-vertexRing) < 0.1) {\n//        float dst = abs(bulgePosition-vertexRing) / 0.1;\n//        lineWidth *= abs(1.0 + cos(dst * M_PI * 0.5) * 2.0);\n//    }\n\n    vVertexRing = vertexRing;\n\n\t//#include <uv_vertex>\n\t//vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tvUv = vec2(uv.x * 2.0 + shiftSpeed * time, uv.y);\n\n    float x = speed * time + vertexRing * timeOffsetPerRing;\n    \n    float disX, disY;\n\n    gradientNoise_float(distortionSpeedHorizontal*x, distortionScale.x, disX);\n    gradientNoise_float(distortionSpeedVertical*x, distortionScale.y, disY);\n    disX -= 0.5;\n    disY -= 0.5;\n    disX *= distortionAmplitude.x;\n    disY *= distortionAmplitude.y;\n\n    float attenuation = 1.0 - abs(vertexRing - ringCount * 0.5) / (ringCount * 0.5); //100% attenuation at endpoints\n    disX *= attenuation;\n    disY *= attenuation;\n    //disX = 0.0; disY=0.0;\n\n\n    //compute quadratic bezier point\n    vec3 startP, endP;\n    QuadraticBezier(vertexRing / (ringCount-1.0), startPosition, midPosition, endPosition, startP);\n    QuadraticBezier((vertexRing + 1.0) / (ringCount-1.0), startPosition, midPosition, endPosition, endP);\n\n\t// camera space\n    vec4 start = modelViewMatrix * vec4( startP.x + disX, startP.y + disY, startP.z, 1.0 );\n    vec4 end = modelViewMatrix * vec4( endP.x + disX, endP.y + disY, endP.z, 1.0 );\n\n\n    bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\tif ( perspective ) {\n        if ( start.z < 0.0 && end.z >= 0.0 ) {\n            trimSegment( start, end );\n        } else if ( end.z < 0.0 && start.z >= 0.0 ) {\n            trimSegment( end, start );\n        }\n    }\n\n    // clip space\n\tvec4 clipStart = projectionMatrix * start;\n\tvec4 clipEnd = projectionMatrix * end;\n\n    // ndc space\n\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n    // direction\n\tvec2 dir = ndcEnd - ndcStart;\n\n    // account for clip-space aspect ratio\n    float aspect = resolution.x / resolution.y;\n    dir.x *= aspect;\n\tdir = normalize( dir );\n\n    // perpendicular to dir\n\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t// undo aspect ratio adjustment\n\tdir.x /= aspect;\n\toffset.x /= aspect;\n\n\t// sign flip\n\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n// Florent: not sure when this is required\n//    // endcaps\n//\tif ( position.y < 0.0 ) {\n//\t\t\t\toffset += - dir;\n//\t} else if ( position.y > 1.0 ) {\n//        offset += dir;\n//\t}\n\n    // adjust for linewidth\n    float pixelWidthRatio = 1.0 / (resolution.x * projectionMatrix[0][0]);\n\toffset *= lineWidth / pixelWidthRatio;\n\n    // adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\toffset /= resolution.y;\n\n    // select end\n\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t// back to clip space\n\t//offset *= clip.w;\n\n\tclip.xy += offset;\n\n\tgl_Position = clip;\n\n}\n",p=new THREE.ShaderMaterial({uniforms:{startPosition:{value:this.startPosition},endPosition:{value:this.endPosition},midPosition:{value:this.midPosition},time:{value:0},speed:{value:3},shiftSpeed:{value:2.5},ringCount:{value:i},resolution:{value:new THREE.Vector2(window.innerWidth,window.innerHeight)},beamLength:{value:10},timeOffsetPerRing:{value:.2},opacity:{value:n||1},color:{value:new THREE.Color("white")},distortionSpeedHorizontal:{value:new THREE.Vector2(0,.3)},distortionSpeedVertical:{value:new THREE.Vector2(.3,0)},distortionScale:{value:new THREE.Vector2(2,2)},distortionAmplitude:{value:new THREE.Vector2(.5,.5)},map:{value:mc["laser-bulge"]}},vertexShader:u,fragmentShader:"\nuniform vec3 color;\nuniform float opacity;\nuniform float ringCount;\n\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n\nvarying float vVertexRing;\n\nvoid main() {\n\n    vec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( color, opacity );\n\n\t#include <map_fragment>\n\n//    if (vVertexRing <= 0.3 || vVertexRing >= ringCount - 0.3) {\n//        //round beam start/end\n//        float a = abs(fract(vUv.y) - 0.5) * 2.0; //distance to center\n//        float b = 1.0 - (vVertexRing <= 0.3 ? vVertexRing : ringCount - vVertexRing) / 0.3; //distance to ring\n//        a = pow(a, 0.5); //more fadein for horizontal\n//        float d = sqrt(a*a+b*b);\n//        if (d > 1.0) {\n//            diffuseColor.a *= pow((1.4142135623730950488 - d)/ 0.4142135623730950488, 20.0);\n//        }\n//    }\n\n\tgl_FragColor = diffuseColor;\n\t\n}\n",transparent:!0,blending:THREE.AdditiveBlending,side:THREE.DoubleSide,depthWrite:!1,wireframe:!1});p.map=p.uniforms.map,p.uniforms.map.value&&(p.uniforms.map.value.wrapS=THREE.RepeatWrapping),THREE.Mesh.call(this,o,p),this.frustumCulled=!1}te.prototype=Object.create(THREE.Mesh.prototype),te.prototype.constructor=te,te.prototype.setStart=function(t){this.startPosition.copy(t),this.updateBeam()},te.prototype.setEnd=function(t){this.endPosition.copy(t),this.updateBeam()},te.prototype.setPositions=function(t,e){this.startPosition.copy(t),this.endPosition.copy(e),this.updateBeam()},te.prototype.setBeamWidth=function(t){this.beamWidth=t,this.updateBeam()},te.prototype.updateBeam=function(){this.position.set((this.startPosition.x+this.endPosition.x)/2,(this.startPosition.y+this.endPosition.y)/2,(this.startPosition.z+this.endPosition.z)/2);var t=this.startPosition.distanceTo(this.endPosition);this.scale.set(this.beamWidth,this.beamWidth,t),this.quaternion.setFromUnitVectors(this.forwardVector,this.endPosition.clone().sub(this.startPosition).normalize()),this.endCircle.position.copy(this.endPosition),this.endCircle.quaternion.copy(this.quaternion)},ee.prototype=Object.create(THREE.Mesh.prototype),ee.prototype.constructor=ee,ee.prototype.setStart=function(t){this.startPosition.copy(t),this.updateBeam()},ee.prototype.setEnd=function(t){this.endPosition.copy(t),this.updateBeam()},ee.prototype.setPositions=function(t,e){this.startPosition.copy(t),this.endPosition.copy(e),this.lookAtVector.setFromEuler(this.shootingPlayer.input.direction);var n=this.forwardVector.clone().applyQuaternion(this.lookAtVector).multiplyScalar(this.startPosition.distanceTo(this.endPosition)/2);this.midPosition=this.startPosition.clone().add(n),this.updateBeam()},ee.prototype.setBeamWidth=function(t){this.beamWidth=t,this.updateBeam()},ee.prototype.updateBeam=function(){this.curve.v0=this.startPosition,this.curve.v1=this.midPosition,this.curve.v2=this.endPosition,this.curve.needsUpdate=!0,this.geometry.refreshPath(this.curve,this.phaseCounter+=2*Math.PI/30)},se.prototype=Object.create(THREE.Mesh.prototype),se.prototype.constructor=se,se.prototype.addFlame=function(t,e){if(0!=this.flamePool.length){void 0===e&&(e=0);var n=this.flamePool.pop(),r=this.geometry.getAttribute("position");r.setXYZ(4*n+0,t.x,t.y,t.z),r.setXYZ(4*n+1,t.x,t.y,t.z),r.setXYZ(4*n+2,t.x,t.y,t.z),r.setXYZ(4*n+3,t.x,t.y,t.z);for(var i=this.geometry.getAttribute("opacity"),o=this.geometry.getAttribute("timeOffset"),a=0;a<4;a++)i.setX(4*n+a,1),o.setX(4*n+a,-this.material.uniforms.time.value+e);return r.needsUpdate=!0,i.needsUpdate=!0,o.needsUpdate=!0,n}console.error("No free element in pool")},se.prototype.removeFlame=function(t){for(var e=this.geometry.getAttribute("opacity"),n=0;n<4;n++)e.setX(4*t+n,0);e.needsUpdate=!0,this.flamePool.push(t)},se.prototype.setFlameOpacity=function(t,e){for(var n=this.geometry.getAttribute("opacity"),r=0;r<4;r++)n.setX(4*t+r,e);n.needsUpdate=!0},se.prototype.advanceTime=function(t){this.material.uniforms.time.value+=t},se.prototype.getAvailFlames=function(){return this.flamePool.length},se.prototype.isUsed=function(){return this.flamePool.length<this.flameCount},le.prototype=Object.create(THREE.Mesh.prototype),le.prototype.constructor=le,le.prototype.setStart=function(t){this.startPosition.copy(t)},le.prototype.setEnd=function(t){this.endPosition.copy(t)},le.prototype.setPositions=function(t,e){this.startPosition.copy(t),this.endPosition.copy(e),this.lookAtVector.setFromEuler(this.shootingPlayer.input.direction);var n=this.forwardVector.clone().applyQuaternion(this.lookAtVector).multiplyScalar(this.startPosition.distanceTo(this.endPosition)/2);this.midPosition.copy(this.startPosition).add(n)},le.prototype.advanceTime=function(t){this.material.uniforms.time.value+=t};var ce=new THREE.CylinderGeometry(1,1,S,16,1,!0),ue=new THREE.MeshBasicMaterial({color:16777215,side:THREE.DoubleSide,transparent:!0,opacity:0});function pe(t){var e=new THREE.Mesh(ce,ue);e.position.copy(t),vl.add(e),anime({targets:e.material,easing:"easeOutQuad",duration:250,opacity:[1,0]}),anime({targets:e.scale,easing:"easeOutQuad",duration:250,x:[0,.75],z:[0,.75],complete:function(){vl.remove(e)}})}function de(t){var e=new THREE.SpriteMaterial({color:"white",transparent:!0}),n=new THREE.Sprite(e);n.position.set(0,0,-_l.near),_l.add(n);var r=Qt(_l.near,_l);n.scale.set(r.width,r.height,1),anime({targets:e,easing:"easeOutQuad",opacity:[1,0],duration:t,complete:function(){_l.remove(n)}})}DataView.prototype.currentOffset=0,DataView.prototype.readFloat32=function(){var t=this.getFloat32(this.currentOffset);return this.currentOffset+=4,t},DataView.prototype.readFloat64=function(){var t=this.getFloat64(this.currentOffset);return this.currentOffset+=8,t},DataView.prototype.readInt16=function(){var t=this.getInt16(this.currentOffset);return this.currentOffset+=2,t},DataView.prototype.readInt32=function(){var t=this.getInt32(this.currentOffset);return this.currentOffset+=4,t},DataView.prototype.readInt8=function(){var t=this.getInt8(this.currentOffset);return this.currentOffset+=1,t},DataView.prototype.readUint16=function(){var t=this.getUint16(this.currentOffset);return this.currentOffset+=2,t},DataView.prototype.readUint32=function(){var t=this.getUint32(this.currentOffset);return this.currentOffset+=4,t},DataView.prototype.readUint8=function(){var t=this.getUint8(this.currentOffset);return this.currentOffset+=1,t},DataView.prototype.readBtVector3=function(t){return t.setValue(this.readFloat32(),this.readFloat32(),this.readFloat32())},DataView.prototype.readBtQuaternion=function(t){return t.setValue(this.readFloat32(),this.readFloat32(),this.readFloat32(),this.readFloat32())},DataView.prototype.readVector3=function(t){return t.set(this.readFloat32(),this.readFloat32(),this.readFloat32())},DataView.prototype.readQuaternion=function(t){return t.set(this.readFloat32(),this.readFloat32(),this.readFloat32(),this.readFloat32())},DataView.prototype.writeFloat32=function(t){this.setFloat32(this.currentOffset,t),this.currentOffset+=4},DataView.prototype.writeFloat64=function(t){this.setFloat64(this.currentOffset,t),this.currentOffset+=8},DataView.prototype.writeInt16=function(t){this.setInt16(this.currentOffset,t),this.currentOffset+=2},DataView.prototype.writeInt32=function(t){this.setInt32(this.currentOffset,t),this.currentOffset+=4},DataView.prototype.writeBigInt64=function(t){this.setBigInt64(this.currentOffset,t),this.currentOffset+=8},DataView.prototype.writeInt8=function(t){this.setInt8(this.currentOffset,t),this.currentOffset+=1},DataView.prototype.writeUint16=function(t){this.setUint16(this.currentOffset,t),this.currentOffset+=2},DataView.prototype.writeUint32=function(t){this.setUint32(this.currentOffset,t),this.currentOffset+=4},DataView.prototype.writeUint8=function(t){this.setUint8(this.currentOffset,t),this.currentOffset+=1},DataView.prototype.readShortString=function(){for(var t=this.readUint8(),e="",n=0;n<t;n++){var r=this.readUint8()<<8|this.readUint8();e+=String.fromCharCode(r)}return e},DataView.prototype.writeShortString=function(t){this.writeUint8(Math.min(255,t.length));for(var e=0;e<Math.min(255,t.length);e++){var n=t.charCodeAt(e);this.writeUint8(n>>>8),this.writeUint8(255&n)}},DataView.prototype.readLongString=function(){for(var t=this.readInt32(),e="",n=0;n<t;n++){var r=this.readUint8()<<8|this.readUint8();e+=String.fromCharCode(r)}return e},DataView.prototype.writeLongString=function(t){this.writeInt32(t.length);for(var e=0;e<t.length;e++){var n=t.charCodeAt(e);this.writeUint8(n>>>8),this.writeUint8(255&n)}},DataView.prototype.writeBtVector3=function(t){this.writeFloat32(t.x()),this.writeFloat32(t.y()),this.writeFloat32(t.z())},DataView.prototype.writeBtQuaternion=function(t){this.writeFloat32(t.x()),this.writeFloat32(t.y()),this.writeFloat32(t.z()),this.writeFloat32(t.w())},DataView.prototype.writeVector3=function(t){this.writeFloat32(t.x),this.writeFloat32(t.y),this.writeFloat32(t.z)},DataView.prototype.writeQuaternion=function(t){this.writeFloat32(t.x),this.writeFloat32(t.y),this.writeFloat32(t.z),this.writeFloat32(t.w)},DataView.prototype.hasRemaining=function(t){return t||(t=0),this.currentOffset+t<=this.byteLength};var he={refDistance:2,rolloffFactor:1.3,distanceModel:"exponential",panningModel:"equalpower"},fe="audio/",me=(Pt=window.cordova?-1!==navigator.userAgent.indexOf("iPhone")||-1!==navigator.userAgent.indexOf("iPad"):-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&-1===navigator.userAgent.indexOf("Chromium"))?".mp3":".webm",ye=.35,_e={},ge={},ve={ui_play:{filenames:["Sfx_UI_Play-001_v2","Sfx_UI_Play-002_v2"],volume:1,loop:!1},ui_done:{filename:"Sfx_UI_Done_v3-003",volume:1,loop:!1},ui_options:{filenames:["Sfx_UI_OptionsClick-001_v2","Sfx_UI_OptionsClick-002_v2"],volume:1,loop:!1},ui_settings:{filenames:["Sfx_UI_Settings-001_v2"],volume:1,loop:!1},ui_custom:{filenames:["Sfx_UI_Custom-001_v2","Sfx_UI_Custom-002_v2","Sfx_UI_Custom-003_v2"],volume:1,loop:!1},ui_custom_select:{filenames:["Sfx_UI_Custom_Select-001_v2","Sfx_UI_Custom_Select-002_v2","Sfx_UI_Custom_Select-003_v2"],volume:1,loop:!1},ui_buy:{filenames:["Sfx_UI_Buy-002_v2"],volume:1,loop:!1},ui_change_skin:{filenames:["Sfx_UI_Change_Skin_v2-001","Sfx_UI_Change_Skin_v2-002","Sfx_UI_Change_Skin_v2-003"],volume:1,loop:!1},ui_lose_round:{filenames:["Sfx_UI_Player_Lose_Round-001_v2","Sfx_UI_Player_Lose_Round-002_v2","Sfx_UI_Player_Lose_Round-003_v2","Sfx_UI_Player_Lose_Round-004_v2","Sfx_UI_Player_Lose_Round-005_v2"],volume:1,loop:!1},ui_win_round:{filenames:["Sfx_UI_Player_Win_Round_v4-001","Sfx_UI_Player_Win_Round_v4-002","Sfx_UI_Player_Win_Round_v4-003","Sfx_UI_Player_Win_Round_v4-004","Sfx_UI_Player_Win_Round_v4-005","Sfx_UI_Player_Win_Round_v4-006"],volume:1,loop:!1},ui_local_win_round:{filename:"Sfx_UI_Player_Local_Win_Round-003",volume:1,loop:!1},ui_local_lose_round:{filename:"Sfx_UI_Player_Local_Lose_Round-002",volume:1,loop:!1},ui_card_grey:{filenames:["Sfx_UI_Card_grey-001","Sfx_UI_Card_grey-002","Sfx_UI_Card_grey-003"],volume:1},ui_round_results:{filenames:["Sfx_UI_DrumRoll"],volume:1,loop:!1},ui_teleport_round:{filenames:["Sfx_UI_Teleport_Round-001_v2","Sfx_UI_Teleport_Round-002_v2"],volume:1,loop:!1},ui_first_place:{filenames:["Sfx_UI_1rst_Place_v5-001","Sfx_UI_1rst_Place_v5-002","Sfx_UI_1rst_Place_v5-003"],volume:1,loop:!1},ui_second_place:{filenames:["Sfx_UI_2nd_Place_v4-001","Sfx_UI_2nd_Place_v4-002","Sfx_UI_2nd_Place_v4-003"],volume:1,loop:!1},ui_third_place:{filenames:["Sfx_UI_3rd_Place_v4-001","Sfx_UI_3rd_Place_v4-002","Sfx_UI_3rd_Place_v4-003"],volume:1,loop:!1},ui_other_place:{filenames:["Sfx_UI_Other_Place_v2-001","Sfx_UI_Other_Place_v2-002","Sfx_UI_Other_Place_v2-003","Sfx_UI_Other_Place_v2-004","Sfx_UI_Other_Place_v2-005"],volume:1,loop:!1},ui_countdown:{filename:"Sfx_UI_Countdown",volume:1,loop:!1},ui_countdown_one:{filename:"Sfx_UI_Countdown_Voice_One",volume:1.5,loop:!1},ui_countdown_two:{filename:"Sfx_UI_Countdown_Voice_Two",volume:1.5,loop:!1},ui_countdown_three:{filename:"Sfx_UI_Countdown_Voice_Three",volume:1.5,loop:!1},ui_countdown_go:{filename:"Sfx_UI_Countdown_Voice_Go",volume:2,loop:!1},ui_qualified:{filenames:["Sfx_UI_Qualified_v5-001","Sfx_UI_Qualified_v5-002","Sfx_UI_Qualified_v5-003"],volume:1,loop:!1},ui_eliminated:{filenames:["Sfx_UI_Eliminated_v3-001","Sfx_UI_Eliminated_v3-002","Sfx_UI_Eliminated_v3-003","Sfx_UI_Eliminated_v3-004"],volume:1,loop:!1},ui_gain_xp:{filename:"Sfx_UI_Gain_Exp",volume:1,loop:!1},ui_gain_xp_jauge:{filename:"Sfx_UI_Gain_Exp_Jauge",volume:1,loop:!0},ui_gain_xp_level_up:{filename:"Sfx_UI_Gain_Exp_LevelUp",volume:1,loop:!1},ui_coins:{filenames:["Sfx_Coins_Gain_v2-001","Sfx_Coins_Gain_v2-002","Sfx_Coins_Gain_v2-003"],volume:2,loop:!1},ui_unlock_new:{filenames:["Sfx_UI_Unlock_New-001","Sfx_UI_Unlock_New-002"],volume:1,loop:!1,sequential:!0},ui_message:{filename:"Sfx_UI_Message",volume:1,loop:!1},ui_wait_next_round:{filename:"Sfx_UI_Wait_next_round_v3",volume:1,loop:!0},ui_round_end:{filename:"Sfx_UI_Wait_round_end_v2",volume:1,loop:!0}},be={player_death:{filenames:["Sfx_Character_Death_v3-001","Sfx_Character_Death_v3-002","Sfx_Character_Death_v3-003","Sfx_Character_Death_v3-004","Sfx_Character_Death_v3-005","Sfx_Character_Death_v3-006"],volume:1,loop:!1},footstep:{filenames:["Sfx_Character_Footsteps_v2-001","Sfx_Character_Footsteps_v2-002","Sfx_Character_Footsteps_v2-003","Sfx_Character_Footsteps_v2-004","Sfx_Character_Footsteps_v2-005","Sfx_Character_Footsteps_v2-006","Sfx_Character_Footsteps_v2-007","Sfx_Character_Footsteps_v2-008","Sfx_Character_Footsteps_v2-009","Sfx_Character_Footsteps_v2-010"],volume:1,loop:!1,nearestPlayers:3},player_jump:{filenames:["Sfx_Character_Jump+Silent_voice_v4-001","Sfx_Character_Jump+Silent_voice_v4-002","Sfx_Character_Jump+Silent_voice_v4-003","Sfx_Character_Jump+Silent_voice_v4-004","Sfx_Character_Jump+Silent_voice_v4-005","Sfx_Character_Jump+voice_v4-001","Sfx_Character_Jump+voice_v4-002","Sfx_Character_Jump+voice_v4-003","Sfx_Character_Jump+voice_v4-004","Sfx_Character_Jump+voice_v4-005"],volume:1.5,loop:!1,nearestPlayers:8},player_spawn:{filenames:["Sfx_Character_Spawn-001_v2","Sfx_Character_Spawn-002_v2","Sfx_Character_Spawn-003_v2","Sfx_Character_Spawn-004_v2"],volume:1,loop:!1},player_spawn_other:{filenames:["Sfx_Character_Spawn_OtherPlayer-001_v2","Sfx_Character_Spawn_OtherPlayer-002_v2","Sfx_Character_Spawn_OtherPlayer-003_v2","Sfx_Character_Spawn_OtherPlayer-004_v2"],volume:1,loop:!1,nearestPlayers:8,updateDistance:!0},player_slide_toboggan:{filenames:["Sfx_Character_Slide_Normal_v4-002"],volume:1,loop:!0,randomOffset:!0,maxSimultaneous:3},player_slide_water:{filenames:["Sfx_Character_Slide_Normal_v5-003"],volume:1,loop:!0,randomOffset:!0,maxSimultaneous:3},player_slide_ice:{filenames:["Sfx_Character_Slide_Toboggan_v3-003"],volume:1,loop:!0,randomOffset:!0,maxSimultaneous:3},player_landing:{filenames:["Sfx_Character_Reception+voice-001","Sfx_Character_Reception+voice-002","Sfx_Character_Reception+voice-003","Sfx_Character_Reception+voice-004","Sfx_Character_Reception+voice-005"],volume:1,loop:!1,nearestPlayers:8},player_shocked:{filenames:["Sfx_Character_Shockstate+voice_v4-001","Sfx_Character_Shockstate+voice_v4-002","Sfx_Character_Shockstate+voice_v4-003","Sfx_Character_Shockstate+voice_v4-004","Sfx_Character_Shockstate+voice_v4-005","Sfx_Character_Shockstate+voice_v4-006","Sfx_Character_Shockstate+voice_v4-007"],volume:3,loop:!1,nearestPlayers:8},player_hit:{filenames:["Sfx_Character_Hit+voice-001","Sfx_Character_Hit+voice-002","Sfx_Character_Hit+voice-003","Sfx_Character_Hit+voice-004","Sfx_Character_Hit+voice-005"],volume:1,loop:!1,nearestPlayers:8},player_hit_big:{filenames:["Sfx_Character_Expulser+voice-001","Sfx_Character_Expulser+voice-002","Sfx_Character_Expulser+voice-003","Sfx_Character_Expulser+voice-004","Sfx_Character_Expulser+voice-005"],volume:1,loop:!1,nearestPlayers:8},jumpad:{filenames:["Sfx_Plateform_Jumpad+voice-001","Sfx_Plateform_Jumpad+voice-002","Sfx_Plateform_Jumpad+voice-003","Sfx_Plateform_Jumpad+voice-004","Sfx_Plateform_Jumpad+voice-005"],volume:2,loop:!1,nearestPlayers:8},spawn_object:{filenames:["Sfx_Obstacle_CanonShot-001","Sfx_Obstacle_CanonShot-002","Sfx_Obstacle_CanonShot-003"],volume:2,loop:!1},fall:{filenames:["Sfx_Character_Fall+voice-001","Sfx_Character_Fall+voice-002","Sfx_Character_Fall+voice-003","Sfx_Character_Fall+voice-004","Sfx_Character_Fall+voice-005"],volume:1,loop:!1,nearestPlayers:3},fly:{filenames:["Sfx_Character_Fly+voice_v2-001","Sfx_Character_Fly+voice_v2-002","Sfx_Character_Fly+voice_v2-003","Sfx_Character_Fly+voice_v2-004","Sfx_Character_Fly+voice_v2-005"],volume:1,loop:!1,nearestPlayers:8}},xe=!1;function we(){if(ct&&!xe){for(let t in ve)if(ve[t].filename)Uc(Lc,"audio-"+t,fe+ve[t].filename+me,function(e,n){Ll&&(_e[t]=new THREE.Audio(Ll).setBuffer(n).setVolume(ve[t].volume),ve[t].loop&&_e[t].setLoop(!0),_e[t].name=t,_e[t].getLoop()||(_e[t].matrixAutoUpdate=!1))});else for(let e=0;e<ve[t].filenames.length;e++)Uc(Lc,"audio-"+t+"-"+e,fe+ve[t].filenames[e]+me,function(e,n){if(Ll){_e[t]||(_e[t]=[]);for(let e=0;e<ve[t].filenames.length;e++){let r=new THREE.Audio(Ll).setBuffer(n).setVolume(ve[t].volume);ve[t].loop&&r.setLoop(!0),r.name=t+"-"+e,ve[t].lastPick=-1,_e[t][e]=r,r.getLoop()||(r.matrixAutoUpdate=!1)}}});for(let t in be)if(be[t].filename)Uc(Lc,"paudio-"+t,fe+be[t].filename+me);else for(let e=0;e<be[t].filenames.length;e++)Uc(Lc,"paudio-"+t+"-"+e,fe+be[t].filenames[e]+me);xe=!0}}function Ee(){if(ct&&!Ll){Ll=new THREE.AudioListener,_l.add(Ll);for(let t in ve)if(ve[t].filename)mc["audio-"+t]&&!_e[t]&&(_e[t]=new THREE.Audio(Ll).setBuffer(mc["audio-"+t]).setVolume(ve[t].volume),ve[t].loop&&_e[t].setLoop(!0),_e[t].name=t,_e[t].getLoop()||(_e[t].matrixAutoUpdate=!1));else{_e[t]||(_e[t]=[]);for(let e=0;e<ve[t].filenames.length;e++)if(mc["audio-"+t+"-"+e]&&!_e[t][e]){let n=new THREE.Audio(Ll).setBuffer(mc["audio-"+t+"-"+e]).setVolume(ve[t].volume);ve[t].loop&&n.setLoop(!0),n.name=t+"-"+e,ve[t].lastPick=-1,_e[t][e]=n,n.getLoop()||(n.matrixAutoUpdate=!1)}}}}var Te=new Set,Se=0,Me=600;function je(t,e){t.animatedObj||(t.animatedObj={volume:t.getVolume()}),t.audioAnimation&&t.audioAnimation.pause(),t.isFadingOut=!0,t.audioAnimation=anime({targets:t.animatedObj,volume:0,duration:Me,easing:"linear",update:function(e){t.setVolume(t.animatedObj.volume)},complete:function(){0==t.animatedObj.volume&&(t.stop(),t.isFadingOut=!1,e&&t.parent&&t.parent.remove(t),Te.delete(t),delete t.audioAnimation)}})}function Ce(t){if(ct&&Oc.audioEnabled&&_e[t]&&(!Array.isArray(_e[t])||0!=_e[t].length)){if(Array.isArray(_e[t])){for(let e=0;e<_e[t].length;e++)_e[t][e].isPlaying&&_e[t][e].stop();let e=ve[t].sequential?(ve[t].lastPick+1)%_e[t].length:Math.floor(Math.random()*_e[t].length);return ve[t].lastPick=e,_e[t][e].play(),_e[t][e].setVolume(ve[t].volume),_e[t][e].soundStartTime=(new Date).getTime(),Te.add(_e[t][e]),_e[t][e]}return _e[t].isPlaying&&_e[t].stop(),_e[t].play(),_e[t].setVolume(ve[t].volume),_e[t].soundStartTime=(new Date).getTime(),Te.add(_e[t]),_e[t]}}var ze=0;function Re(t,e,n){if(!ct||!Oc.audioEnabled||e.notAudible)return;if(vr)return;if(!t||!e)return;var r=be[t];if(!r)return;if(r.nearestPlayers&&(function(t){if(!r.updateDistance&&pc==ze)return;var e=(new THREE.Vector3).setFromMatrixPosition(Ll.matrixWorld),n=new THREE.Vector3;let i=oc.slice();for(let t=0;t<i.length;t++)i[t].killed?i[t].distanceToListener=Number.MAX_VALUE:(n.setFromMatrixPosition(i[t].matrixWorld),i[t].distanceToListener=n.distanceToSquared(e));i.sort(function(t,e){return t.distanceToListener-e.distanceToListener});for(let t=0;t<i.length;t++)i[t].audioPlayerDistance=t;ze=pc}(),e.audioPlayerDistance>r.nearestPlayers))return;let i=new THREE.Vector3,o=new THREE.Vector3;if(Ll.getWorldPosition(i),e.getWorldPosition(o),!(i.distanceToSquared(o)>ut*ut)){if(r.maxSimultaneous&&r.loop)return ge[t]||(ge[t]=new Le(t,r.maxSimultaneous)),a=ge[t].add(e);var a=Ae(t,r);if(n){e.add(a),a.onEnded=function(){a.isPlaying=!1,e.remove(a)};let t=a.stop;a.stop=function(){e.remove(a),t.call(a)}}else a.position.copy(e.position);return a.play(),a.soundStartTime=(new Date).getTime(),Te.add(a),n||(a.matrixAutoUpdate=!1,a.updateMatrix(),a.updateMatrixWorld(!0)),a}}function Ae(t,e){let n="paudio-"+t;e.filenames&&(n+="-"+Math.floor(Math.random()*e.filenames.length));var r=new THREE.PositionalAudio(Ll).setBuffer(mc[n]).setVolume(e.volume).setRefDistance(he.refDistance).setRolloffFactor(he.rolloffFactor).setDistanceModel(he.distanceModel).setLoop(e.loop);return r.name=t,r.panner.panningModel=he.panningModel,e.detune&&(r.playbackRate=Math.pow(2,(7*Math.random()-3.5)/12)),e.randomOffset&&(r.offset=Math.random()*r.buffer.duration),r}function Le(t,e){this.audioItemName=t,this.audioSpec=be[t],this.maxAudibleSounds=e,this.audioPool=[],this.audioSet=new Set}Le.prototype.add=function(t,e){var n=new THREE.Object3D;t?(t.add(n),n.updateMatrixWorld()):(n.position.copy(t.position),n.matrixAutoUpdate=!1,n.updateMatrix(),n.updateMatrixWorld(!0)),n.volume=this.audioSpec.volume,e&&(n.lifetime=e,n.getVolume=function(){return this.volume},n.setVolume=function(t){this.volume=t,this.audioObject&&this.audioObject.setVolume(t)},n.timeout=setTimeout(function(){je(n)},e));var r=this;return n.stop=function(){r.remove(n),n.timeout&&clearTimeout(n.timeout)},this.audioSet.add(n),this.update(),n},Le.prototype.remove=function(t){this.audioSet.delete(t),t.parent&&t.parent.remove(t);var e=t.audioObject;e&&(e.parent&&e.parent.remove(e),this.audioPool.push(e),delete t.audioObject,e.isPlaying&&e.stop(),this.update())},Le.prototype.getAudio=function(){if(this.audioPool.length>0)var t=this.audioPool.pop();else t=Ae(this.audioItemName,this.audioSpec);return t},Le.prototype.update=function(){if(0!=this.audioSet.size){var t=Array.from(this.audioSet);if(Ll){var e=(new THREE.Vector3).setFromMatrixPosition(Ll.matrixWorld),n=new THREE.Vector3;for(let r=0;r<t.length;r++)n.setFromMatrixPosition(t[r].matrixWorld),t[r].distanceToListener=n.distanceToSquared(e)}t.sort(function(t,e){return t.distanceToListener-e.distanceToListener});for(let e=this.maxAudibleSounds;e<t.length;e++){let n=t[e].audioObject;n&&(n.parent&&n.parent.remove(n),n.isPlaying&&n.stop(),this.audioPool.push(n),delete t[e].audioObject)}for(let e=0;e<Math.min(t.length,this.maxAudibleSounds);e++){let n=t[e];if(!n.audioObject){var r=this.getAudio();n.add(r),n.audioObject=r,r.setVolume(n.volume),r.play(),r.soundStartTime=(new Date).getTime(),Te.add(r),n.parent||(r.matrixAutoUpdate=!1,r.updateMatrix(),r.updateMatrixWorld(!0))}}this.audioPool.length>0&&(this.audioPool=[])}};var Ie,Pe,Oe,ke,Be,De,He,Fe,Ne,Ue,Ve,Ge,We,qe,Xe={},Ye={},Qe=0,Ze=0,Je="none",Ke=!1,$e={},tn=0;nn();var en=8;function nn(){$e={0:!0,300:!0,301:!0,302:!0,303:!0,304:!0,305:!0,306:!0,307:!0,308:!0,309:!0}}regionFullNames={LOCAL:"Local",EUW:"Europe West",USE:"US East",USW:"US West",AU:"Australia",RU:"Russia",TOK:"Asia East",IN:"India",SA:"South America"};try{localStorage.getItem("sessionId")&&(He=localStorage.getItem("sessionId"))}catch(e){}var rn=[3];try{localStorage.getItem("abCohortSet")&&(Je=localStorage.getItem("abCohortSet")),localStorage.getItem("abCohort")&&(0!=(Ze=parseInt(localStorage.getItem("abCohort")))&&1!=Ze&&2!=Ze&&4!=Ze||(Ze=rn[Math.floor(Math.random()*rn.length)],localStorage.setItem("abCohort",Ze),Je="",localStorage.setItem("abCohortSet",Je)),Ke=!0)}catch(e){}function on(t){return"https:"===window.location.protocol.toLowerCase()?"wss://"+t.replace(":","/"):"ws://"+t}!function(){if(!Ke){Ze=rn[Math.floor(Math.random()*rn.length)],Je="";try{localStorage.setItem("abCohortSet",Je)}catch(t){}try{localStorage.setItem("abCohort",Ze)}catch(t){}Ke=!0}}();var an,sn,ln,cn=[];function un(){for(var t=document.getElementById("homepage-toasts"),e="",n=(new Date).getTime(),r=cn.length-1;r>=0;r--)n-cn[r].t>=9900?cn.splice(r,1):e="<div"+(cn[r].c?" class="+cn[r].c:"")+">"+cn[r].s+"</div>"+e;t.innerHTML=e}function pn(t,e){cn.push({t:(new Date).getTime(),s:t,c:e}),un(),setTimeout(un,1e4)}function dn(){if(Fe){var t=[],e=0;for(var n in Ne={},Pe)t.push({value:n,label:regionFullNames[n]}),Ne[n]=e,e++;t.sort(function(t,e){var n=Ye[t.value],r=Ye[e.value];return n||r?n?r?r-n:1:-1:t.value>e.value?-1:1}),Fe.setChoices(t,"value","label",!0),Ue?Fe.setChoiceByValue(Ue):Ie&&Fe.setChoiceByValue(Ie)}}function hn(t){Xe[t]=new WebSocket(on(Pe[t])),Xe[t].binaryType="arraybuffer",Xe[t].pings=[],Xe[t].sendPing=function(){this.lastPingTime=(new Date).getTime();var t=new Uint8Array(1);t.set([1],0),this.send(t)},Xe[t].addEventListener("open",function(t){t.target.sendPing()}),Xe[t].addEventListener("error",function(e){this.cancelled||pn((new Date).toLocaleTimeString()+" - Error reaching server in "+t+" "+e.type+" "+e.code,"")}),Xe[t].addEventListener("close",function(t){}),Xe[t].addEventListener("message",function(e){var n=new DataView(e.data).getUint8(0);1==n?(e.target.pings.push((new Date).getTime()-e.target.lastPingTime),e.target.pings.length>=3?(e.target.close(),delete Xe[t],Ye[t]=Math.min.apply(Math,e.target.pings),console.log("Best ping for region",t,Ye[t]),function(){var t=999999;for(var e in Ye)Ye[e]<t&&(t=Ye[e],Ie!=e&&(console.log("Best region",e),Fe&&(Fe.containerOuter.isDisabled&&Fe._handleLoadingState(!1),Fe.setChoiceByValue(e))),Ie=e);dn(),Tc&&so()}()):e.target.sendPing()):console.log("unexpected code from server",n)})}function fn(){Pe&&(function(){for(var t in Pe)Xe[t]&&(Xe[t].cancelled=!0,Xe[t].close()),delete Xe[t];Ye=[],Pe={},Ie=null}(),clearTimeout(ke));var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4==t.readyState&&200==t.status)try{var e=t.responseText.split("\n"),n=!1;Pe={};for(var r=0;r<e.length;r++){var i=e[r].split(" ");if(i.length>=2){var o=i[0],a=i[1];Pe[o]=a,hn(o),n=!0}}n?dn():(++Qe<100&&(ke=setTimeout(fn,3e3)),pn((new Date).toLocaleTimeString()+" - Downloaded region list was empty","error"))}catch(e){console.error(e),++Qe<100&&(ke=setTimeout(fn,3e3)),pn((new Date).toLocaleTimeString()+" - Downloaded region list was invalid: "+t.responseText,"error")}else 4==t.readyState&&200!=t.status&&t.onerror(t.status)},t.onerror=function(t){pn((new Date).toLocaleTimeString()+" - Error downloading region list","error"),++Qe<100&&(ke=setTimeout(fn,3e3))},t.open("GET","//"+w+"/servers",!0),t.send(null)}function mn(){if(Be&&(clearTimeout(Be),Be=null),Ie){var t=Ie;try{t=Fe.getValue().value}catch(t){}var e=document.getElementById("username").value.substring(0,12);try{encodeURIComponent(e)}catch(t){return console.error(t),void alert("Username is invalid: "+t)}var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState&&200==n.status)if(-1!=n.responseText.indexOf("LOGIN_ERROR"))alert("The session has expired, please reload the page and try again"),window.location.reload();else if(-1!=n.responseText.indexOf("ERROR"))Oe?alert("Can't connect to the specified server, it's probably not open right now"):(Be=setTimeout(mn,3e3),pn((new Date).toLocaleTimeString()+" - Error selecting server: "+n.responseText,"error"));else{var t=n.responseText.split(" ");x=t[0],De=t[1],He=t[2];try{localStorage.setItem("sessionId",He)}catch(t){}console.log("Got server",x,De),er(x)}else 4==n.readyState&&200!=n.status&&n.onerror(n.status)},n.onerror=function(t){pn((new Date).toLocaleTimeString()+" - Error selecting server","error"),Be=setTimeout(mn,3e3)},n.open("POST","//"+w+"?r="+(t||"")+"&u="+encodeURIComponent(e)+"&s="+(He||"")+(Ve?"&a="+("google"==Ve?1:2):"")+(Ze>0?"&v="+Ze:"")+(Jn?"&ce="+encodeURIComponent(De):""),!0),Ge?n.send(Ge):n.send(null)}else Be=setTimeout(mn,3e3)}function yn(t){if(!Ve){var e=t.getBasicProfile();Ve="google",Ge=t.getAuthResponse().id_token,We=e.getImageUrl(),vn();try{localStorage.removeItem("loggedWithFacebook")}catch(t){}}}function _n(){He=null;try{localStorage.removeItem("sessionId")}catch(t){}}function gn(t){console.log("Facebook login status",t),Ve||("connected"===t.status?(Ve="facebook",Ge=t.authResponse.accessToken,FB.api("/me?fields=picture,email&redirect=false",function(t){t&&t.picture&&t.picture.data&&(We=t.picture.data.url),vn();try{localStorage.setItem("loggedWithFacebook",1)}catch(t){}})):"facebook"==Ve&&(_n(),Ve=null,Ge=null))}function vn(){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4==t.readyState&&200==t.status)if(-1!=t.responseText.indexOf("ERROR"))console.error("login returned ERROR"),wn();else{var e=t.responseText.split("\n");if(He=e[0],parseInt(e[1]),e.length>=3){var n=e[2].split(",");nn();for(var r=0;r<n.length;r++)$e[n[r]]=!0}e.length>=4&&(tn=parseFloat(e[3]));try{localStorage.setItem("sessionId",He)}catch(t){}e.length>=5&&(en=parseInt(e[4])),e.length>=6&&(jc=parseInt(e[5]))&&Date.now()/1e3<jc&&(document.getElementById("homepage-banner-right").style.visibility="hidden",document.getElementById("end-match-banner-left").style.visibility="hidden",document.getElementById("end-match-banner-right").style.visibility="hidden"),document.getElementById("login-popup").style.display="none",document.getElementById("home-unconnected-block").style.display="none",document.getElementById("shop-unconnected-block")&&(document.getElementById("shop-unconnected-block").style.display="none"),document.getElementById("profile-unconnected-block").style.display="none",document.getElementById("home-connected-block").style.display="flex",document.getElementById("shop-connected-block")&&(document.getElementById("shop-connected-block").style.display="flex"),document.getElementById("profile-connected-block").style.display="flex",document.getElementById("home-profile-picture").src=We,document.getElementById("shop-profile-picture").src=We,document.getElementById("profile-profile-picture").src=We,document.getElementById("match-earnings-account-incentive")&&(document.getElementById("match-earnings-account-incentive").style.display="none"),document.getElementById("shop-account-warning")&&document.getElementById("shop-account-warning").classList.remove("visible")}else 4==t.readyState&&200!=t.status&&t.onerror(t.status)},t.onerror=function(t){pn((new Date).toLocaleTimeString()+" - Error at login","error"),console.error("login error"),wn()},t.open("POST","//"+w+"/login?s="+(He||"")+(Ve?"&a="+("google"==Ve?1:2):"")+"&app="+(document.getElementById("privacy-policy-checkbox").checked?1:0)+"&ecs="+(document.getElementById("emailing-consent-checkbox").checked?1:0)+"&ect="+encodeURIComponent(document.getElementById("emailing-consent-text").innerHTML),!0),Ge?t.send(Ge):t.send(null)}function bn(t){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var n=e.responseText.split("\n"),r=n[0].split(",");nn();for(var i=0;i<r.length;i++)$e[r[i]]=!0;n.length>=2&&(tn=parseFloat(n[1])),n.length>=3&&(en=parseInt(n[2])),"function"==typeof t&&t()}else 4==e.readyState&&200!=e.status&&e.onerror(e.status)},e.onerror=function(e){pn((new Date).toLocaleTimeString()+" - Error fetching items","error"),console.error("fetching items error",e),"function"==typeof t&&t()},e.open("GET","//"+w+"/my-items?s="+(He||""),!0),e.send(null)}function xn(t){if(qe)t();else{var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var n=e.responseText.split("\n");if(n.length<0)console.error("Invalid price list",e.responseText);else{qe={};for(var r=1;r<n.length;r++){var i=n[r].split(",");2==i.length&&(i[1].startsWith("$")?qe[parseInt(i[0])]=i[1]:qe[parseInt(i[0])]=parseInt(i[1]))}t()}}else 4==e.readyState&&200!=e.status&&e.onerror(e.status)},e.onerror=function(e){pn((new Date).toLocaleTimeString()+" - Error fetching price list","error"),console.error("fetching price list error",e),t()},e.open("GET","//"+w+"/data/shop-prices-"+en+".csv",!0),e.send(null)}}function wn(){return"google"==Ve?gapi.auth2.getAuthInstance().signOut().then(function(){console.log("User signed out from google."),Ve=null,Ge=null,_n()}):"facebook"==Ve&&FB.logout(gn),document.getElementById("home-connected-block").style.display="none",document.getElementById("shop-connected-block").style.display="none",document.getElementById("profile-connected-block").style.display="none",document.getElementById("home-unconnected-block").style.display="flex",document.getElementById("shop-unconnected-block").style.display="flex",document.getElementById("profile-unconnected-block").style.display="flex",document.getElementById("shop-account-warning")&&document.getElementById("shop-screen")&&document.getElementById("shop-screen").classList.contains("visible")&&setTimeout(Oo,3e3),!1}function En(){document.getElementById("privacy-policy-checkbox").checked?gapi.load("auth2",function(){gapi.auth2.init({client_id:document.head.querySelector("meta[name=google-signin-client_id]").content}).then(function(){gapi.auth2.getAuthInstance().signIn({scope:"profile email"}).then(function(t){yn(t)}).catch(function(t){console.error(t),alert("Google sign-in failed: "+t.error+" - Reload the page and try again")})}).catch(function(t){console.error(t),alert("Can't use google sign-in: "+t.details+" - See help page")})}):alert("You must accept the privacy policy")}function Tn(){document.getElementById("privacy-policy-checkbox").checked?FB.login(gn,{scope:"email"}):alert("You must accept the privacy policy")}function Sn(){document.getElementById("login-popup").style.display="block",void 0!==window.gapi&&void 0!==window.gapi.auth2||(document.getElementById("google-login-button").innerHTML='<div class="blocked">Your browser is blocking Google API. Unblock to sign-in with Google.</div>')}function Mn(){if(document.getElementById("profile-back-btn")||alert("Coming soon"),Ve){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){var e=JSON.parse(t.responseText);document.getElementById("my-account-button")&&(document.getElementById("my-account-button").enabled=!0,document.getElementById("my-account-button").innerHTML="Profile"),function(t){document.getElementById("profile-wins-value").textContent=t.wins;var e=wa(t.xp);document.getElementById("profile-previous-level").textContent=e,document.getElementById("profile-next-level").textContent=e+1,document.getElementById("profile-level-bar-value").style.width=(t.xp-Ea(e-1))/(Ea(e)-Ea(e-1))*100+"%",t.nextUnlock&&t.nextUnlock.item>1e4?(document.getElementById("profile-unlock-level").innerHTML=t.nextUnlock.level,document.getElementById("profile-unlock-thumbnail").innerHTML="<span>"+(t.nextUnlock.item-1e4)+"</span>",document.getElementById("profile-unlock-thumbnail").classList.add("coins")):t.nextUnlock&&-1==t.nextUnlock.item?(document.getElementById("profile-unlock-level").innerHTML=t.nextUnlock.level,document.getElementById("profile-unlock-thumbnail").innerHTML="Random Color",document.getElementById("profile-unlock-thumbnail").classList.add("random-color")):t.nextUnlock&&t.nextUnlock.item>0?(document.getElementById("profile-unlock-level").innerHTML=t.nextUnlock.level,document.getElementById("profile-unlock-thumbnail").innerHTML='<img src="ui/item-thumbnails/'+t.nextUnlock.item+'.png">'):document.getElementById("profile-unlock-preview").style.visibility="hidden";for(var n=[],r={},i=0;i<t.records.length;i++){var o=t.records[i].map.split("-")[0];(!r[o]||t.records[i].time<r[o])&&(r[o]||n.push(o),r[o]=t.records[i].time)}var a="";for(i=0;i<n.length;i++)a+='<div class="map-thumbnail" style="background-image: url(ui/map-thumbnails/'+encodeURIComponent(n[i])+'.png);"><div class="record-wrapper"><div class="map-name">'+Sa(n[i])+'</div><div class="record" title="'+r[n[i]].toFixed(3)+'">⏱️ '+r[n[i]].toFixed(1)+"</div></div></div>";document.getElementById("best-times-wrapper").innerHTML=a}(e),yo(),document.getElementById("profile-player-name").innerText=document.getElementById("username").value?document.getElementById("username").value:document.getElementById("username").placeholder,document.getElementById("profile-screen").classList.add("visible"),Fo("profile"),Za(),Ce("ui_done")}else 4==t.readyState&&200!=t.status&&t.onerror(t.status)},t.onerror=function(t){pn((new Date).toLocaleTimeString()+" - Error getting account info","error"),console.log(t)},t.open("GET","//"+w+"/my-stats?s="+He,!0),t.send(null),document.getElementById("my-account-button")&&(document.getElementById("my-account-button").enabled=!1,document.getElementById("my-account-button").innerHTML="Loading...")}else Sn()}window.lolbeansOnGoogleSignIn=yn,window.lolbeansCheckFacebookLoginStatus=function(){var t=!0;try{t=1===parseInt(localStorage.getItem("loggedWithFacebook"))}catch(t){}t&&FB.getLoginStatus(gn)};var jn,Cn,zn=[],Rn=[],An=!1;function Ln(t,e,n){var r;(an=new WebSocket(on(w)+"/party")).binaryType="arraybuffer",an.addEventListener("open",function(i){var o=document.getElementById("username").value.substring(0,12);t?an.send("j "+encodeURIComponent(o)+" "+(He||"")+" "+e+(n?" "+n:"")):an.send("c "+encodeURIComponent(o)+" "+(He||"")),zn=[],Rn=[],document.getElementById("party-chat-history").innerHTML="",document.getElementById("home-left").classList.remove("visible"),document.getElementById("home-party-block").classList.add("visible"),document.getElementById("play-btn-wrapper").style.display="none",document.getElementById("server-block").style.display="none",document.getElementById("party-create-button").style.display="none",r=setInterval(function(){an&&an.send("p")},3e4)}),an.addEventListener("error",function(t){console.error(t),pn((new Date).toLocaleTimeString()+" - Websocket "+t.type+" "+(t.code?t.code:""),"error")}),an.addEventListener("close",function(t){this===an&&(an=null),clearInterval(r),"INACTIVITY"===t.reason&&alert("The party was closed for inactivity"),0!=Kn||An||(sn=null,history.replaceState("",document.title,window.location.pathname+window.location.search),document.getElementById("home-left").classList.add("visible"),document.getElementById("home-party-block").classList.remove("visible"),document.getElementById("play-btn-wrapper").style.display="flex",document.getElementById("server-block").style.display="block",document.getElementById("party-create-button").style.display="flex")}),an.addEventListener("message",In)}function In(t){switch(t.data.charAt(0)){case"e":var e=t.data.substring(2);alert(e),Dn();break;case"k":var n=t.data.split(" ");He=n[1];try{localStorage.setItem("sessionId",He)}catch(t){}if(sn=n[2],n.length>=4){ln=n[3];try{localStorage.setItem("partyKey",sn),localStorage.setItem("partyHostKey",ln)}catch(t){}document.getElementById("play-btn-wrapper").style.display="flex",document.getElementById("server-block").style.display="block"}else ln=null;window.location.hash=sn,document.getElementById("party-share-link").value=$l?$l.inviteLink({roomId:sn}):window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")+window.location.pathname.replace("/indexCrazy.html","")+"#"+sn;break;case"l":zn=[];for(var r=t.data.split("\n"),i=1;i<r.length;i++)(s=r[i]).length>0&&(n=s.split(" "),zn.push({type:n[0],username:decodeURIComponent(n[1])}));!function(){for(var t="",e=!1,n=!1,r=0;r<zn.length;r++){var i="H"==zn[r].type;i&&(n=!0),i&&ln&&(e=!0);var o=zn[r].username&&zn[r].username.length>0?zn[r].username:"Player";t+="<div"+(i?' class="host"':"")+">"+o+"</div>"}document.getElementById("party-users-list").innerHTML=t,document.getElementById("party-no-host").classList[n?"remove":"add"]("visible"),document.getElementById("party-host-present").classList[!e&&n?"add":"remove"]("visible"),document.getElementById("party-is-host").classList[e?"add":"remove"]("visible")}();break;case"t":n=t.data.split(" ");var o=parseInt(n[1]),a=Ut(decodeURIComponent(n[2])),s="<div>"+(zn[o].username.length>0?zn[o].username:"Player")+": "+a+"</div>";Rn.push({t:s,d:(new Date).getTime()}),Rn.length>50&&Rn.splice(0,1),On(!0),Ce("ui_message");break;case"s":if("ERROR"===(n=t.data.split(" "))[1])alert("The game failed to start, please try again"),document.getElementById("btn-play").innerHTML="PLAY",document.getElementById("btn-play").style.pointerEvents="";else{if(An){console.error("Error, received party start while already starting");break}if(jn){console.error("Ignoring party start request, we already have a reservation key");break}jn=parseInt(n[1]),x=n[2],console.log("Got party server",x,jn),An=!0,document.getElementById("btn-play").innerHTML='<div class="spinner black"><div></div></div>',document.getElementById("btn-play").style.pointerEvents="none",document.getElementById("play-btn-wrapper").style.display="flex",Rn.push({t:"Host started the game...",d:(new Date).getTime()}),On(!0),Pn(),function(t){if(!document.hasFocus())var e=document.title,n=setInterval(function(){document.hasFocus()?(clearInterval(n),document.title=e,n=null):document.title="Game started"==document.title?e:"Game started"},500)}()}}}function Pn(){if(vc)return alert("There were errors loading game files, the page will reload and try again."),void window.location.reload();gc?0==Kn&&er(x):setTimeout(Pn,100)}function On(t){for(var e="",n=0;n<Rn.length;n++)e+=Rn[n].t;document.getElementById("party-chat-history").innerHTML=e,t&&(document.getElementById("party-chat-history").scrollTop=document.getElementById("party-chat-history").scrollHeight)}function kn(){if(an){var t=document.getElementById("username").value.substring(0,12);an.send("u "+encodeURIComponent(t))}}var Bn=0;function Dn(){sn=null,an&&an.send("q"),$l?($l.inviteLink(),history.replaceState("",document.title,(window.location.pathname+window.location.search).replace(/[&]?roomId=([^&#]*)/,"").replace("?&","?"))):history.replaceState("",document.title,window.location.pathname+window.location.search)}function Hn(t){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var t=e.responseText.split("\n"),n=t[0],r=t[1];console.log("Got xsolla token",r);var i={access_token:r,sandbox:-1!==n.indexOf("sandbox")},o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src="https://static.xsolla.com/embed/paystation/1.0.7/widget.min.js",o.addEventListener("load",function(t){XPayStationWidget.init(i),XPayStationWidget.on("close",function(t){document.getElementById("bundle-1-buy-button")&&document.getElementById("bundle-1-buy-button").classList.remove("loading"),document.getElementById("bundle-2-buy-button")&&document.getElementById("bundle-2-buy-button").classList.remove("loading"),document.getElementById("bundle-3-buy-button")&&document.getElementById("bundle-3-buy-button").classList.remove("loading"),document.getElementById("bundle-4-buy-button")&&document.getElementById("bundle-4-buy-button").classList.remove("loading"),document.getElementById("shop-buy-btn").classList.remove("loading"),Ra(!1)}),XPayStationWidget.on("status-done",function(t,e){bn(Po),Ra(!1)}),XPayStationWidget.open()},!1),document.getElementsByTagName("head")[0].appendChild(o)}else 4==e.readyState&&200!=e.status&&e.onerror(e.status)},e.onerror=function(t){console.log(t),alert("An error occured during the transation, please try again or contact us")},e.open("GET","//"+w+"/xsolla-token?s="+He+"&b="+t,!0),e.send(null)}var Fn,Nn,Un,Vn,Gn,Wn,qn,Xn,Yn,Qn,Zn,Jn,Kn=0,$n=!1,tr=0;function er(t){Kn=0,Jn=null,console.log("Connecting to server",t),Yn||(Yn=new v.btVector3),Qn||(Qn=new v.btQuaternion),Zn||(Zn=new v.btVector3),(Fn=new WebSocket(on(t))).binaryType="arraybuffer",Fn.addEventListener("open",function(t){console.log("Connected to server"),Kn=1,Gn=[],function(){Un=(new Date).getTime();var t=new Uint8Array(1);t.set([1],0),Fn.send(t)}(),function(){var t=Oc.username;0==t.length&&(t="Player");var e=He||"",n=new DataView(new ArrayBuffer(2+2*t.length+1+1+1+2*e.length+1+1+4+4+4+1+1));n.writeUint8(2),n.writeShortString(t),n.writeUint8(Oc.playerColor),n.writeUint8(0),n.writeShortString(e),n.writeUint8(Oc.playerColor2),n.writeUint8(Oc.playerColor3),n.writeUint32(Oc.playerTexture),n.writeInt32(jn||0),n.writeInt32(Oc.playerHat),n.writeUint8(Mc?1:0),n.writeUint8(ct&&Oc.audioEnabled?1:0),Fn.send(n.buffer)}()}),Fn.addEventListener("error",function(t){console.error(t),pn((new Date).toLocaleTimeString()+" - Websocket "+t.type+" "+(t.code?t.code:""),"error")}),Fn.addEventListener("close",function(e){console.log("socket closed",e,e.code,e.reason,e.wasClean),0==Kn?(Jn=t,pn("Connection to server failed","error"),console.error("Connection to server failed"),w?(clearTimeout(Be),Be=setTimeout(mn,500*Math.random()+500)):setTimeout(function(){er(t)},3e3)):"inactivity"===e.reason?(console.log("Closed for inactivity"),alert("You have been kicked out for inactivity"),Kn=0,$l&&$l.gameplayStop(),window.location&&window.location.reload()):"already-connected"===e.reason?(console.log("Account already connected"),alert("This account is already connected"),Kn=0,window.location&&window.location.reload()):"unavailable"==e.reason?ir():Ec||$n||(alert("Connection to server has been lost"),Kn=0,$l&&$l.gameplayStop(),window.location&&window.location.reload()),this===Fn&&(Fn=null),Kn=0,"game_over"==e.reason&&(document.getElementById("chat-tip").style.display="none",document.getElementById("timer").style.display="none",Il&&Il.isPlaying&&je(Il)),jn=null}),Fn.addEventListener("message",nr)}function nr(t){var e=new DataView(t.data),r=e.readUint8(0);switch(r){case 1:var a=(new Date).getTime()-Un;rr(a),console.log("ping is",a);break;case 2:!function(t){ir(),$n=!0;try{Fn&&Fn.close(),Fn=null}catch(t){console.error(t)}}();break;case 3:!function(t){tr=t.readUint8();var e=t.readUint8()>0,n=t.readShortString();Xn=t.readUint32(),function(t,e){console.log("Loading map",t,"...",e);var n=t.split(".").pop().toLowerCase();-1===t.indexOf("/")&&(t="obj/Map/"+t),bc=!0,Uc("fbx"===n?Rc:Cc,e?"next-map":"map",t,function(){var t;bc=!1,Fn?((t=new DataView(new ArrayBuffer(1))).writeUint8(3),Fn.send(t.buffer),e?lc!=tt&&lc!=et||(wc?xc=!0:qc()):Xc()):console.log("Socket disconnected, aborting map loading")}),e?Jl=t:Zl=t}(n,e),an&&an.send("q"),e&&document.getElementById("end-match-screen-nextmapname")&&(document.getElementById("end-match-screen-nextmapname").textContent=Sa(Jl.substring(Jl.lastIndexOf("/")+1))),t.hasRemaining()&&1==t.readUint8()&&((Kl=document.createElement("div")).className="middle-screen-toast",Kl.innerHTML="Please wait, next map is still loading...",document.body.appendChild(Kl),1!=Ul.killReason&&(Ul.preventSpectate=!0))}(e);break;case 4:!function(t){Kn=2;var e=t.readUint32();pc=e;var n=t.readUint8(),r=[];for(let e=0;e<n;e++)r.push(or(t));if(t.hasRemaining(4*n))for(let e=0;e<n;e++)r[e][11]=t.readInt32();for(let t=0;t<n;t++)ar(r[t]);(function(){if(console.log("onGameStart"),MainLoop.setBegin(Er).setUpdate(Or).setDraw(Fr).setEnd(Tr),MainLoop.setSimulationTimestep(1e3/E),MainLoop.start(),document.addEventListener("mousemove",pi,!0),window.addEventListener("mouseup",Jr,!0),window.addEventListener("wheel",di,{passive:!1,capture:!0}),window.addEventListener("keydown",mi,!0),window.addEventListener("keyup",yi,!0),document.addEventListener("pointerlockchange",ti,!1),document.addEventListener("pointerlockerror",ei,!1),document.getElementById("chat-container").classList.add("visible"),document.getElementById("hud").style.display="block",Wl=new function(){var t,e,n=0,r=0,i=!1;this.updateRoundTimer=function(e){lc==J?document.getElementById("timer").classList.add("warmup"):document.getElementById("timer").classList.remove("warmup"),lc==tt?document.getElementById("timer").classList.add("results"):document.getElementById("timer").classList.remove("results"),lc==et?(document.getElementById("timer").classList.add("final-results"),document.getElementById("end-match-header").classList.add("final-results")):(document.getElementById("timer").classList.remove("final-results"),document.getElementById("end-match-header").classList.remove("final-results"));var r=(new Date).getTime();n=r+1e3*e,this.lastSeconds=-1,t||(t=setInterval(function(){o((new Date).getTime())},100))},this.getRemainingTime=function(){return n-(new Date).getTime()},this.updateRespawnTimer=function(t){i=!0,document.getElementById("timer").classList.add("respawn");var e=(new Date).getTime();r=e+1e3*t},this.cancelRespawnTimer=function(){i=!1,document.getElementById("timer").classList.remove("respawn")},this.setFinalResults=function(){};var o=function(t){var o=Math.max(0,n-t),a=Math.floor(o%36e5/6e4),s=Math.ceil(o%6e4/1e3);if(o<1e4&&0==document.querySelectorAll("#screens > .visible").length?(document.getElementById("timer").classList.add("bigTimer"),e=s):(document.getElementById("timer").classList.remove("bigTimer"),e=a+":"+("0"+s).slice(-2)),e!=document.getElementById("matchtime").innerHTML&&(document.getElementById("matchtime").textContent=e),lc==tt&&(document.getElementById("end-match-screen-countdown").textContent=a+":"+("0"+s).slice(-2)),i){var l=r-t;if(l<0)i=0,document.getElementById("timer").classList.remove("respawn");else{var c=Math.ceil(l%6e4/1e3);document.getElementById("respawntime").textContent=c}}this.lastSeconds!=s&&((lc===K||lc==$&&o<5e3&&s>0)&&Ce(0==a&&1==s?"ui_countdown_one":0==a&&2==s?"ui_countdown_two":0==a&&3==s?"ui_countdown_three":"ui_countdown"),lc==tt&&o<1e3&&Il&&Il.isPlaying&&je(Il),this.lastSeconds=s)}},ql=new function(){var t=[],e=[],n=document.getElementById("feed"),r=document.getElementById("feed-history");function i(n){var i={};i.text=n,i.lifetime=jt,e.push(i),e.length>Ct&&e.splice(0,1),o(),t.push(n),t.length>zt&&t.splice(0,1),function(){for(var e="",n=0;n<t.length;n++)e+=t[n];r.innerHTML=e}()}function o(){for(var t="",r=0;r<e.length;r++)t+=e[r].text;n.innerHTML=t}this.update=function(t){for(var n=!1,r=e.length-1;r>=0;r--)e[r].lifetime-=t,e[r].lifetime<=0&&(e.splice(r,1),n=!0);n&&o()},this.displayKill=function(t,e,n){if(n==t)i("<span class='killmsg'>"+n.name+" killed himself</span>"),Xl.displayKill(t,n,!1,!0);else if(e){var r=e.name;"sticky"==r&&(r="Flamethrower"),i("<span class='killmsg'>"+n.name+" killed "+t.name+" with <span class='"+r.toLowerCase()+"color'>"+r+"</span></span>"),Xl.displayKill(t,n)}else i("<span class='killmsg'>"+n.name+" pushed "+t.name+" into the <span class='voidcolor'>void</span></span>"),Xl.displayKill(t,n,!0)},this.displaySuicide=function(t){},this.displayTelefrag=function(t,e){(new Date).getTime(),i("<span class='killmsg'>"+e.name+" telefraged "+t.name+"</span>"),Xl.displayTelefrag(t,e)},this.displayPlayerJoins=function(t){},this.displayPlayerLeaves=function(t){};var a="<span class='magiccolor'>MAGIC</span> <span class='milkcolor'>MILK</span>",s=["HOLY MACARONI!","LOOK OUT!","BITTER BANANAS!","ANGRY HIPPOS!","STEROIDS ALERT!","HOLY HAMSTERS!","PRICKLY PINES!"],l=["is juicing up on","is pumping","is sucking on","is running on","is high on"];this.displayQuadActivation=function(t,e){randomTxt1=s[Math.floor(Math.random()*s.length)],randomTxt2=l[Math.floor(Math.random()*l.length)],i("<span class='event-message'><span class='milkcolor'> "+randomTxt1+"</span><br />"+t.name+" "+randomTxt2+" "+a+"!</span>")},this.displayQuadDeactivation=function(t){i("<span class='event-message'>"+t.name+" is not on "+a+" anymore :-)</span>")},this.addChatMessage=function(t,e){i("<span class='chatmsg'><span class='namelabel"+(t.isPartyMember?" party-member":"")+"' style='padding-left:0.5vh; border-left:0.5vh solid "+Nt(Ja[t.colorIndex])+"'>"+Ut(t.name)+"</span> : "+Ut(e)+"</span>")}},Xl=new Pi,document.body.appendChild(bl.domElement),mo(),br=!yc&&1==Oc.cspEnabled,xr=Oc.cspAccuracy<0?2:Oc.cspAccuracy,Pa&&Pa.material.isTimeAnimated){let t=sl.indexOf(Pa.material);t>=0&&sl.splice(t,1)}$l&&$l.gameplayStart()})(),yc&&oc.length>0&&vi(oc[0]),Jt()}(e);break;case 5:rr((new Date).getTime()-Gn.shift());break;case 6:!function(t){hc=!0;var e=t.readUint32();fc=e,dc=t.readUint32();var n=t.readUint8(),r=(new THREE.Quaternion,[]);for(let c=0;c<n;c++){let n=t.readUint8(),c=oc[n],u=t.readVector3(new THREE.Vector3),p=t.readVector3(new THREE.Vector3),d=t.readUint8(),h={id:c.playerId,position:u,velocity:p,up:0!=(1&d),down:0!=(2&d),left:0!=(4&d),right:0!=(8&d),jump:0!=(16&d),sliding:0!=(32&d),shocked:0!=(64&d),flying:0!=(128&d)};if(h.shocked||h.sliding?(h.quaternion=t.readQuaternion(new THREE.Quaternion),h.angularVelocity=t.readVector3(new THREE.Vector3)):(h.directionX=t.readFloat32(),h.directionY=t.readFloat32()),br)r.push(h);else{if(h.flying&&!c.flying?(c.flyStartTick=e,c.fallSoundPlayed=!1,c.flySoundPlayed=!1,c.lastYNeutralVelocity=e):c.killed||!c.flying||h.flying||h.sliding||h.shocked||(!c.lastReceptionTick||e-c.lastReceptionTick>20)&&(Re("player_landing",c),c.lastReceptionTick=e),h.sliding&&!c.sliding){if(cr.setValue(1,1,1),c.ammoBody.setAngularFactor(cr),cr.setValue(8,0,0),c.ammoBody.setAngularVelocity(cr),!c.slidingSound){let t=-1!=Zl.indexOf("BoulderHill")||-1!=Zl.indexOf("HammerVille")||-1!=Zl.indexOf("KittieKegs")||-1!=Zl.indexOf("RicketyRun")||-1!=Zl.indexOf("WarmupTrainB"),e=-1!=Zl.indexOf("SharkPark");c.slidingSound=Re(t?"player_slide_ice":e?"player_slide_water":"player_slide_toboggan",c,!0)}}else if(h.shocked&&!c.shocked)c.shockTick=e,cr.setValue(1,1,1),c.ammoBody.setAngularFactor(cr),cr.setValue(0,0,-50),c.ammoBody.applyCentralImpulse(cr),Re("player_shocked",c,!0);else if(!h.shocked&&c.shocked||!h.sliding&&c.sliding){if(c.recoverFall||(c.recoverFall=[]),c.recoverFall.push({start:(new Date).getTime(),quaternion:c.ammoBody.getWorldTransform().getRotation().toThree()}),c.alteredGravity){Oa.set(0,h.directionY,0);var i=(new THREE.Quaternion).setFromEuler(Oa).premultiply(c.gravityQuaternion);fa.setFromThree(i)}else fa.setEulerZYX(0,h.directionY,0);c.ammoBody.getWorldTransform().setRotation(fa),cr.setValue(0,0,0),c.ammoBody.setAngularFactor(cr),c.ammoBody.setAngularVelocity(cr)}c.slidingSound&&!h.sliding&&(c.slidingSound.stop(),delete c.slidingSound);var o=c.ammoBody.getWorldTransform().getOrigin().toThree();if(o.distanceToSquared(h.position)>.05*.05&&(c.smoothing||(c.smoothing=[]),c.smoothing.push({vector:o.sub(h.position),start:(new Date).getTime()})),Da(pc,c,h,c==Ul||c.killed),c==Ul&&(c.flying=h.flying,c.shocked=h.shocked,c.sliding=h.sliding,c.shocked||c.sliding)){var a=c.ammoBody.getWorldTransform(),s=a.getRotation();s.setFromThree(h.quaternion),a.setRotation(s),c.ammoBody.setWorldTransform(a),ha.setFromThree(h.angularVelocity),c.ammoBody.setAngularVelocity(ha)}var l=(h.up||h.down||h.left||h.right)&&!c.shocked;if(c.ammoBody.setFriction(h.flying?z:l?C:j),c.flying){let t=c.ammoBody.getLinearVelocity().y();Math.abs(t)<.5?c.lastYNeutralVelocity=e:(e-c.lastYNeutralVelocity)/E>1&&(!c.shocked||(e-c.shockTick)/E>2)&&(t>0&&!c.flySoundPlayed?(c.flySoundPlayed=!0,c.lastFlySound=Re("fly",c,!0),c.lastFallSound&&c.lastFallSound.isPlaying&&c.lastFallSound.stop()):t<0&&!c.fallSoundPlayed&&(c.fallSoundPlayed=!0,c.lastFallSound=Re("fall",c,!0),c.lastFlySound&&c.lastFlySound.isPlaying&&c.lastFlySound.stop()))}}}br&&(Fl={tick:e,playerStates:r})}(e);break;case 7:!function(t){t.readUint32();var e=or(t);t.hasRemaining(4)&&(e[11]=t.readInt32());var n=ar(e);ql.displayPlayerJoins(n),Jt(),Jt()}(e);break;case 8:!function(t){t.readUint32();var e,n=t.readUint32(),r=ac[n];r?(delete ac[n],-1!=(e=oc.indexOf(r))&&oc.splice(e,1),Hl.removeRigidBody(r.ammoBody),-1!=(e=ic.indexOf(r.ammoBody))&&ic.splice(e,1),r.removeFromScene(),v.destroy(r.ammoBody.getCollisionShape()),v.destroy(r.ammoBody),yc&&Vl.playerId==n&&observeNextPlayer(),r.dispose(),ql.displayPlayerLeaves(r),Jt(),r.slidingSound&&(r.slidingSound.stop(),delete r.slidingSound)):console.error("Player leaving has not been found",n)}(e);break;case 9:!function(t){t.readUint32(),Ul.input.direction.x=t.readFloat32(),Ul.input.direction.y=t.readFloat32(),delete _l.lastPosition}(e);break;case 13:!function(t){t.readUint32();var e=t.readUint32(),r=t.readUint8(),a=ac[e];Hl.removeRigidBody(a.ammoBody);var s=ic.indexOf(a.ammoBody);-1!=s&&ic.splice(s,1),a.visible=!1,a.killed=!0,a.killReason=r,a.isWalking=!1,a.timeSinceLastStep=0,a.timeSinceStartedFlying=0,a===Ul&&(1==r?(da(r),It&&(document.getElementById("mobile-jump-button").style.display="none"),$l&&$l.gameplayStop()):2==r?da(r):3==r&&(da(r),It&&(document.getElementById("mobile-jump-button").style.display="none"),$l&&($l.happytime(),$l.gameplayStop())),Ul.input.jump=!1,Ul.input.fire=!1),function(t){for(var e=t.skeleton.bones,r=[],a=0;a<e.length;a++)-1===e[a].name.indexOf("Pinky")&&-1===e[a].name.indexOf("Middle")&&-1===e[a].name.indexOf("Ring")&&-1===e[a].name.indexOf("Index")&&r.push(e[a]);var s=new THREE.Color(Ja[t.colorIndex]).getHSL({}),l=new THREE.Vector3(s.h,s.s,s.l),c=new THREE.Vector3(s.h,s.s,0),u=new o({particleTexture:mc["impact-particle"],positionStyle:i.POINT,velocityStyle:i.CUBE,velocityBase:function(){return new THREE.Vector3(1*(Math.random()-.5),1,1*(Math.random()-.5))},sizeBase:.3,sizeTween:function(){return new n([0,1],[.3,0])},opacityTween:new n([0,1],[1,0]),colorBase:l,colorTween:new n([0,1],[l,c]),particlesPerSecond:r.length,particleDeathAge:1,emitterDeathAge:1,emitterStopEmitAge:1}).setPosition(t.position);Wt.addEmitter(u);var p=new THREE.Vector3;for(a=0;a<r.length;a++)u.setPosition(p.setFromMatrixPosition(r[a].matrixWorld)),u.manuallyEmitOneParticle();u.stopEmit()}(a),a.slidingSound&&(a.slidingSound.stop(),delete a.slidingSound),0==r&&Re("player_death",a),2==r&&(Dc++,Kt())}(e);break;case 21:!function(t){var e=t.readUint32(),n=t.readUint32(),r=ac[n];t.readVector3(r.position),r.updateMatrixWorld(),r.ammoBody.getWorldTransform().getOrigin().setFromThree(r.position),r.killed&&-1==ic.indexOf(r.ammoBody)&&(Hl.addRigidBody(r.ammoBody,X,-1),ic.push(r.ammoBody)),r.visible=!0,r.killed=!1,r.shocked=!1,r.sliding=!1,cr.setValue(0,0,0),r.ammoBody.setAngularFactor(cr),r.ammoBody.setAngularVelocity(cr),r.alteredGravity=!1,r.gravityQuaternion=null,r.ammoBody.setGravity(Hl.getGravity()),r===Ul&&(Vl=null),delete r.cameraOnPlayer,delete r.delayedRespawn,r.input.direction.x=t.readFloat32(),r.input.direction.y=t.readFloat32(),r===Ul&&(mo(),delete _l.lastPosition,delete Ul.preventSpectate),r!==Ul&&r!==Vl||(delete _l.currentGravityQuaternion,delete _l.targetGravityQuaternion,delete _l.interpLastPosition,_l.quaternion.set(0,0,0,1),_l.up=THREE.Object3D.DefaultUp,r.skipGravityChangeAnimation=!0,Ll&&(Ll.parent.remove(Ll),r.add(Ll),Ll.rotation.y=Math.PI)),pe(r.position);var i=new THREE.Quaternion;i.setFromEuler(r.input.direction),i.x=0,i.z=0,ni||(ni=new v.btQuaternion),ni.setFromThree(i),r.ammoBody.getWorldTransform().setRotation(ni),(r==Ul||lc!=K)&&Re(r===Ul?"player_spawn":"player_spawn_other",r),r.lastReceptionTick=e,r!=Ul&&(r.lastFlySound&&r.lastFlySound.isPlaying&&r.lastFlySound.stop(),r.lastFallSound&&r.lastFallSound.isPlaying&&r.lastFallSound.stop())}(e);break;case 22:!function(t){var e=t.readUint32(),n=t.readUint32(),r=ac[n],i=t.readVector3(new THREE.Vector3),o=t.readQuaternion(new THREE.Quaternion),a=t.readUint32();if(r.gravityQuaternion)var s=(new THREE.Quaternion).setFromEuler(r.input.direction).premultiply(r.gravityQuaternion);else s=(new THREE.Quaternion).setFromEuler(r.input.direction);r.delayedRespawn={fromPosition:r.position.clone(),fromQuaternion:s,toPosition:i,toQuaternion:o,startTime:Date.now(),duration:(a-e)/E*1e3}}(e);break;case 23:!function(t){for(var e=t.readUint16(),n=[],r=0;r<e;r++){var i=t.readUint32(),o=t.readInt32(),a=t.readFloat32(),s=ac[i];n[r]=s,s&&(s.endRank=o,s.raceTime=a)}if(tr>=6){for(r=0;r<e;r++)n[r]&&(n[r].distanceToFinish=t.readFloat32());var l=oc.slice();for(l.sort(function(t,e){return 0==t.endRank&&0==e.endRank?t.distanceToFinish-e.distanceToFinish:0==t.endRank&&e.endRank>0?1:t.endRank>0&&0==e.endRank?-1:t.endRank<0?e.endRank<0?0:1:e.endRank<0?t.endRank<0?0:-1:t.endRank-e.endRank}),r=0;r<l.length;r++)l[r].globalEndRank=r+1}var c;$l||yl(),wc=!0,!wo||Eo?(0==Ul.endRank?(c=1,$l&&$l.gameplayStop()):-1==Ul.endRank?c=-1:1==Ul.endRank?c=3:Ul.endRank>1&&(c=2),da(c,Ul.globalEndRank),setTimeout(function(){vo(),$l&&yl()},5e3)):(vo(),$l&&yl()),tc.onRoundEnd()}(e);break;case 24:!function(t){var e=t.readUint32();fc=e;var n=t.readUint8(),r=t.readFloat32(),i=lc!=n&&n==K;if(to<10&&n!=lc&&n==J&&r>5.5){if(It)var o=document.getElementById("mobile-hints"),a=5e3;else o=document.getElementById("desktop-hints"),a=Math.min(1e3*r,1e4);o.classList.add("visible"),setTimeout(function(){anime({targets:o,opacity:0,easing:"linear",duration:500,complete:function(){o.classList.remove("visible")}})},a)}if(lc!=n&&n==$){Nl=e;for(let t=0;t<oc.length;t++)oc[t].timeSinceLastStep=-ye*Math.random()}lc==Z&&n==J&&Ce("ui_teleport_round"),lc==K&&n==$&&Ce("ui_countdown_go"),lc=n,Wl.updateRoundTimer(r),zc=t.readUint8(),i?(Dc=0,Zt()):Zt(),i&&(wo=!1,xo=!1,Eo=!1,Il&&Il.isPlaying&&je(Il)),Ec&&setTimeout(function(){MainLoop.stop()},1e3),bc&&lc==K&&((Kl=document.createElement("div")).className="middle-screen-toast",Kl.innerHTML="Please wait, next map is still loading...",document.body.appendChild(Kl),1!=Ul.killReason&&(Ul.preventSpectate=!0))}(e);break;case 27:!function(t){for(var e=t.readUint8()>0,n=0;n<oc.length;n++){var r=oc[n];r.killed&&!r.delayedRespawn||(r.delayedRespawn||(Hl.removeRigidBody(r.ammoBody),ic.splice(ic.indexOf(r.ammoBody),1)),r.delayedRespawn=!1,r.visible=!1,r.killed=!0,r.killReason=e?1:2,r.slidingSound&&(r.slidingSound.stop(),delete r.slidingSound))}Wl.cancelRespawnTimer()}(e);break;case 31:!function(t){if(!It&&Oc.chatEnabled){var e=t.readUint8();if(0==e){var n=t.readUint32(),r=t.readShortString(),i=ac[n];i&&(ql.addChatMessage(i,r),Ce("ui_message"))}else 1==e?(r=t.readShortString(),ql.addChatMessage({name:"info"},r)):2==e&&(r=t.readShortString(),ql.addChatMessage({name:"error"},r))}}(e);break;case 34:!function(t){if(!br){var e=t.readUint32(),n=ac[e];n&&(t.readVector3(n.position),n==Ul&&console.log("portal",n.position),n==Ul||yc&&n==Vl?de(250):pe(n.position))}}(e);break;case 35:!function(t){if(!br){var e=t.readUint32(),n=ac[e];n&&Re("jumpad",n,!0)}}(e);break;case 36:!function(t){for(var e=t.readUint32(),n=ac[e],r=t.readUint8(),i=[],o=0;o<r;o++){var a=t.readUint16(),s=t.readInt32(),l=t.readUint16();lc==$&&(n.points+=s),i.push({type:a,points:s,param1:l})}n.points<0&&(n.points=0),n===Ul&&function(t){for(var e=0,n=0;n<t.length;n++){var r=t[n].type;e+=t[n].points,t[n].param1,1!=r&&Hi.push(t[n])}0!=e&&Fi.push({type:0,points:e}),!Fi.activeAnimation&&Fi.length>0&&(Ji(Fi),Ki(Fi)),!Hi.activeAnimation&&Hi.length>0&&(Ji(Hi),Ki(Hi))}(i)}(e);break;case 37:case 49:!function(t,e){t.readUint32();var n=t.readUint32(),r=t.readUint8(),i=t.readFloat32(),o=t.readFloat32(),a=e?t.readFloat32():void 0;bs(r,n,t.readVector3(new THREE.Vector3),i,o,t.readVector3(new THREE.Vector3),a)}(e,49==r);break;case 38:!function(t){t.readUint32();for(var e=t.readUint32(),n=new THREE.Vector3,r=new THREE.Quaternion,i=new THREE.Vector3,o=new THREE.Vector3,a=0;a<e;a++){let e=t.readUint32();t.readVector3(n),t.readQuaternion(r),t.readVector3(i),t.readVector3(o);var s=cs[e];if(s){if(s.type>=2){var l=s.ammoBody.getWorldTransform().getOrigin().toThree();l.distanceToSquared(n)>.05*.05&&(s.smoothing||(s.smoothing=[]),s.smoothing.push({vector:l.sub(n),start:(new Date).getTime()}));var c=s.ammoBody.getWorldTransform().getRotation().toThree();c.angleTo(r)>.02&&(s.rotSmoothing||(s.rotSmoothing=[]),s.rotSmoothing.push({fromQuaternion:c.clone(),toQuaternion:r.clone(),start:(new Date).getTime()}))}ha.setFromThree(n),s.ammoBody.getWorldTransform().setOrigin(ha),fa.setFromThree(r),s.ammoBody.getWorldTransform().setRotation(fa),ha.setFromThree(i),s.ammoBody.setLinearVelocity(ha),ha.setFromThree(o),s.ammoBody.setAngularVelocity(ha)}}}(e);break;case 39:!function(t){t.readUint32();var e=t.readUint32(),n=t.readUint8(),r=cs[e];r&&Bs(r,n)}(e);break;case 40:!function(t){t.readUint32();for(var e=t.readUint32(),n=new THREE.Vector3,r=new THREE.Vector3,i=new THREE.Vector3,o=0;o<e;o++){let e=t.readUint32();var a=t.readUint8(),s=t.readFloat32(),l=t.readFloat32();t.readVector3(n),t.readVector3(r),2!=a&&bs(a,e,n,s,l,r),t.readVector3(i);var c=cs[e];c&&(ha.setFromThree(n),c.ammoBody.getWorldTransform().setOrigin(ha),ha.setFromThree(r),c.ammoBody.setLinearVelocity(ha),ha.setFromThree(i),c.ammoBody.setAngularVelocity(ha))}}(e);break;case 41:!function(t){t.readUint32();for(var e=t.readUint32(),n=0;n<e;n++){var r=t.readUint8(),i=t.readLongString(),o=Ws(i);if(1==r||5==r){var a=t.readUint32(),s=t.readVector3(new THREE.Vector3),l=t.readFloat32(),c=t.readFloat32(),u=(1&(tr>=5?t.readUint8():0))>0,p=5==r?t.readVector3(new THREE.Vector3):null;o?gs(o,a,s,l,c,u,p):console.error("Can't make mesh rotating, object not found",i)}else if(2==r){c=t.readFloat32();var d=t.readVector3(new THREE.Vector3),h=t.readVector3(new THREE.Vector3),f=(a=t.readUint32(),t.readUint32()),m=t.readUint8(),y=t.readUint16(),_=t.readUint32(),g=t.readUint32(),v=tr>0?t.readUint8():0;u=(1&(tr>=5?t.readUint8():0))>0,o?xs(o,c,d,h,a,f,m,y,_,g,v,u):console.error("Can't make mesh moving, object not found",i)}else if(4==r){c=t.readFloat32();for(var b=t.readLongString(),x=Ws(b),w=(a=t.readUint32(),m=t.readUint8(),y=t.readUint16(),_=t.readUint32(),u=(1&(tr>=5?t.readUint8():0))>0,t.readUint8()),E=[],T=[],S=[],M=0;M<w;M++)E.push(t.readUint32()),T.push(t.readUint32()),S.push(t.readUint8());o&&x?ws(o,c,x,a,m,y,_,E,T,S,u):console.error("Can't make mesh follow path, object or path not found",i,b)}else if(3==r){a=t.readUint32();var j=t.readUint32(),C=(_=tr>=3?t.readUint32():0,g=tr>=3?t.readUint32():0,s=t.readVector3(new THREE.Vector3),c=t.readFloat32(),t.readFloat32()),z=(v=tr>0?t.readUint8():0,tr>=2?t.readVector3(new THREE.Vector3):null);z&&0==z.x&&0==z.y&&0==z.z&&(z=null),u=(1&(tr>=5?t.readUint8():0))>0,o?vs(o,a,c,j,s,C,v,z,_,g,u):console.error("Can't make mesh swinging, object not found",i)}}}(e);break;case 42:!function(t){t.readUint32();for(var e=t.readUint32(),n=0;n<e;n++){let e=t.readUint32();var r=t.readLongString(),i=Ws(r),o=t.readFloat32(),a=t.readFloat32(),s=t.readFloat32(),l=t.readFloat32();i?zs(e,i,o,a,s,l):console.error("Can't make mesh dynamic, object not found",r);for(var c=t.readUint8(),u=0;u<c;u++)if(1==t.readUint8()){var p=t.readVector3(new THREE.Vector3),d=t.readVector3(new THREE.Vector3),h=t.readFloat32(),f=t.readFloat32();i&&Rs(i,p,d,isFinite(h)?h:void 0,isFinite(f)?f:void 0)}}}(e);break;case 43:!function(t){t.readUint32();for(var e=t.readUint32(),n=0;n<e;n++){var r=t.readLongString(),i=Ws(r),o=t.readFloat32(),a=t.readFloat32(),s=t.readFloat32(),l=t.readUint8();i?(1==l&&"cylinder"!==i.colliderType?Ts(i):4==l&&"cylinderZ"!==i.colliderType?Ss(i):2==l&&"box"!==i.colliderType?Ms(i):3==l&&"hull"!==i.colliderType?Cs(i):5==l&&"sphere"!==i.colliderType&&js(i),As(i,o,a,s)):console.error("Can't set specific physics, object not found",r)}}(e);break;case 44:!bc&&mc["next-map"]&&qc();break;case 45:!function(t){var e=t.readUint32(),n=ac[e];n&&vi(n)}(e);break;case 46:Ec=!0;break;case 47:!function(t){var e=t.readShortString();tc.onReachCheckpoint(e)}(e);break;case 48:!function(t){let e=t.readInt32(),n=t.readInt32(),r=t.hasRemaining(4)?t.readLongString():"",i=t.hasRemaining(4)?t.readInt32():0,o=t.hasRemaining(4)?t.readInt32():0;Yl={previousXP:e,XPGain:n,earnedItemsIds:r,nextUnlockItemId:i,nextUnlockLevel:o},t.hasRemaining(8)&&(Yl.previousCoins=t.readFloat32(),Yl.coinsGain=t.readFloat32())}(e);break;case 50:!function(t){var e=t.readUint32(),n=ac[e];n&&(n.isPartyMember=!0,n.addTextSprite())}(e);break;case 51:!function(t){var e=t.readUint32(),n=ac[e];n&&(n.colorIndex=t.readUint8(),n.colorIndex2=t.readUint8(),n.colorIndex3=t.readUint8(),n.playerTexture=t.readUint32(),n.playerHat=t.readInt32(),n.refreshPlayerTexture())}(e);break;case 52:!function(t){var e=t.readUint32(),n=ac[e];n&&Re("player_jump",n)}(e);break;case 53:!function(t){var e=t.readUint32(),n=ac[e];if(n){var r=new THREE.Object3D;Re(0==(t.readVector3(r.position),t.readUint8())?"player_hit":"player_hit_big",n),n.lastFlySound&&n.lastFlySound.isPlaying&&n.lastFlySound.stop(),n.lastFallSound&&n.lastFallSound.isPlaying&&n.lastFallSound.stop()}}(e);break;case 54:!function(t){let e=t.readVector3(new THREE.Vector3),n=t.readVector3(new THREE.Vector3),r=t.readFloat32();var i=new THREE.BoxBufferGeometry(1,1,1),o=new THREE.MeshBasicMaterial({color:"#FFFF00",transparent:!0,opacity:1,blending:THREE.AdditiveBlending}),a=new THREE.Mesh(i,o);a.name="beam";var s=new THREE.Vector3(0,0,1);a.position.set((e.x+n.x)/2,(e.y+n.y)/2,(e.z+n.z)/2);var l=e.distanceTo(n);a.scale.set(.2,.2,l),a.quaternion.setFromUnitVectors(s,n.sub(e).normalize()),vl.add(a),anime({targets:o,opacity:0,duration:1e3*r,easing:"linear",complete:function(){vl.remove(a)}})}(e);break;case 55:!function(t){t.readUint8();var e=t.readUint8(),n=t.readUint32();if(il.redGreenLightHead){var r=(n-pc)/E*1e3;mr.forEach(t=>t.pause()),mr=[];let t=81.7*THREE.Math.DEG2RAD;if(1==e){il.redGreenRedEyes.visible=!1,mr.push(anime({targets:il.redGreenLightHead.rotation,z:[Math.PI/2,Math.PI,3*Math.PI/2,2*Math.PI],duration:r,easing:"linear"}));let e=anime.timeline({duration:r/2,easing:"linear"});mr.push(e),e.add({targets:il.redGreenLightLeftArm.rotation,y:0,duration:.1*r}),e.add({targets:il.redGreenLightLeftArm.rotation,y:-t,delay:.4*r,duration:.5*r});let n=anime.timeline({duration:r/2,easing:"linear"});mr.push(n),n.add({targets:il.redGreenLightRightArm.rotation,y:0,duration:.1*r}),n.add({targets:il.redGreenLightRightArm.rotation,y:t,delay:.4*r,duration:.5*r})}else 2==e&&(il.redGreenLightHead.rotation.z=0,il.redGreenLightLeftArm.rotation.y=-t,il.redGreenLightRightArm.rotation.y=t,il.redGreenRedEyes.visible=!0)}}(e);break;case 56:!function(t){t.readUint32();for(var e=t.readUint32(),n=0;n<e;n++){var r,i,o,a=t.readUint8(),s=t.readLongString(),l=Ws(s);1&a&&(r=0!=t.readUint8()),2&a&&(i=t.readVector3(new THREE.Vector3)),4&a&&(o=t.readQuaternion(new THREE.Quaternion)),8&a&&t.readVector3(new THREE.Vector3),l?Is(l,r,i,o):console.error("Can't set specific object properties, object not found",s)}}(e);break;case 57:!function(t){var e=t.readLongString();-1!==Zl.indexOf("NastySeals")&&(il.Trigger_R_Feedback&&e.endsWith("R")&&(il.Trigger_R_Feedback.visible=!0,setTimeout(function(){il.Trigger_R_Feedback.visible=!1},500)),il.Trigger_L_Feedback&&e.endsWith("L")&&(il.Trigger_L_Feedback.visible=!0,setTimeout(function(){il.Trigger_L_Feedback.visible=!1},500)))}(e);break;default:console.log("unhandled message code",r)}}function rr(t){(new Date).getTime(),Nn?(Nn=.9*Nn+.1*t,t>Wn&&(Wn=t),t<qn&&(qn=t)):(Wn=Nn=t,qn=Nn),br=!1}function ir(){console.error("Received server unavailable"),pn("Received server unavailable"),!sn&&w?(clearTimeout(Be),Be=setTimeout(mn,500*Math.random()+500)):(alert("Server is full"),window.location.reload())}function or(t){var e=t.readUint32(),n=t.readShortString(),r=t.readUint8();if(tr>=4)var i=t.readUint8(),o=t.readUint8(),a=t.readUint32();else i=r,o=r,a=0;t.readBtVector3(Yn),t.readBtQuaternion(Qn);var s=t.readUint8()>0;return e==Xn&&0==(n=document.getElementById("username").value.substring(0,12)).length&&(n="Player"),[e,n,r,Yn,Qn,0,!yc&&e==Xn,s,i,o,a,-1]}function ar(t){var e=t[0],n=function(t,e,n,r,i,o,a,s,l,c,u){var p=new Li(t,e);p.isWalking=!1,p.timeSinceLastStep=0,p.timeSinceStartedFlying=0,p.flyStartTick=0;var d=THREE.SkeletonUtils.clone(mc.character);d.scale.set(.85,.85,.85);var h,f,m=Yt(d);if(m){p.skinnedMesh=m,void 0===Ja[e]&&(console.error("Player",t,"has invalid color",e,", random one picked"),e=Math.floor(10*Math.random()));var y=Ja[e];p.baseColor=new THREE.Color(y).convertSRGBToLinear(),p.colorIndex=e,p.colorIndex2=s,p.colorIndex3=l,p.playerTexture=c,p.playerHat=u,p.refreshPlayerTexture()}d.position.y=-.85,f=(h=d).mixer=new THREE.AnimationMixer(h),h.idle=f.clipAction(Gl.idle),h.run=f.clipAction(Gl.run),h.jumpLoop=f.clipAction(Gl.jumpLoop),h.fall=f.clipAction(Gl.fall),h.shocked=f.clipAction(Gl.fall),p.add(d);var _=p.skinnedMesh.skeleton;if(p.skeletonRoot=d,p.skeleton=_,ht){var g=new THREE.SkeletonHelper(d);g.material.linewidth=3,vl.add(g)}if(mt){var b=new THREE.CapsuleBufferGeometry(T,T,S-2*T,16,1,8,8),x=new THREE.MeshBasicMaterial({color:"red",flatShading:!0,transparent:!0,opacity:.2}),w=new THREE.Mesh(b,x);p.add(w)}p.castShadow=!0,vl.add(p);var E=new v.btTransform;E.setIdentity(),E.setOrigin(n),E.setRotation(r);var j=new v.btCapsuleShape(T,S-2*T),C=new v.btVector3(0,0,0);j.calculateLocalInertia(M,C);var z=new v.btDefaultMotionState(E),R=new v.btRigidBodyConstructionInfo(M,z,j,C);return p.ammoBody=new v.btRigidBody(R),p.ammoBody.setActivationState(4),C.setValue(0,0,0),p.ammoBody.setAngularFactor(C),p.ammoBody.setDamping(0,0),p.ammoBody.setContactProcessingThreshold(1e-4),p.ammoBody.setFriction(1),v.destroy(C),v.destroy(E),v.destroy(R),p.ammoBody.threeObject=p,p.input={left:!1,right:!1,up:!1,down:!1,fire:!1,jump:!1,requestJumpTick:-1,lastJumpTick:-1,requestFireTick:-1,lastFireTick:-1,weaponChangeLockedUntilTick:-1,direction:new THREE.Euler(0,0,0,"YXZ"),maxHealth:250,health:250},p.input.direction.setFromQuaternion(p.ammoBody.getWorldTransform().getRotation().toThree()),a||(Hl.addRigidBody(p.ammoBody,X,-1),ic.push(p.ammoBody)),p.killed=a,p.visible=!a,p.isPlayer=!0,p.animState="idle",p.animations=[d.idle,d.run,d.jumpLoop,d.fall,d.shocked],d.idle.setEffectiveWeight(1),d.run.setEffectiveWeight(0),d.jumpLoop.setEffectiveWeight(0),d.fall.setEffectiveWeight(0),d.shocked.setEffectiveWeight(0),ft&&(d.idle.paused=!0,d.run.paused=!0,d.jumpLoop.paused=!0),d.idle.play(),d.run.play(),d.jumpLoop.play(),d.fall.play(),d.shocked.play(),o||p.addTextSprite(),p.trackingBeams=[],oc.push(p),p}(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11]);return ac[e]=n,n.playerId=e,e==Xn&&(Ul=n,document.getElementById("chat-player-label").innerHTML=n.name+":"),n}function sr(t){var e=new DataView(new ArrayBuffer(2));e.writeUint8(7),e.writeUint8(t?0:1),Fn.send(e.buffer)}var lr,cr,ur,pr,dr,hr,fr,mr=[];window.lolbeansSAC=function(t,e){var n=new DataView(new ArrayBuffer(6+2*e.length));n.writeUint8(99),n.writeUint8(t),n.writeLongString(e),Fn.send(n.buffer)};var yr,_r,gr=0,vr=!1,br=!1,xr=0,wr=0;function Er(){}function Tr(t,e){Gt.system.emitters.length,Wt.emitters.length;for(var n=0;n<Gt.system.emitters.length;n++)Gt.system.emitters[n].particles.length;for(n=0;n<Wt.emitters.length;n++)Wt.emitters[n].particleCount;var r="fps: "+Math.round(t)+" ping: "+Math.round(Nn);if(document.getElementById("fps").textContent=r,e){var i=Math.floor(MainLoop.resetFrameDelta()/1e3*E);console.log("panic: simulation is too late, dropping updates",i),pc+=i,br&&Na(pc)}t>=70&&!ot&&(console.log("High FPS detected, activating draw interpolation"),ot=!0)}var Sr=new THREE.Vector3(0,1,0);function Mr(t,e,n){e.input.lastJumpadTick&&t-e.input.lastJumpadTick<=F||(cr.setValue(0,0,0),e.ammoBody.setLinearVelocity(cr),cr.setFromThree(n.jumppadImpulse),e.ammoBody.applyCentralImpulse(cr),e.input.lastJumpadTick=t,e.input.jumpadMovementLockDelay=n.movementLockDelay)}function jr(t,e,n){var r=uc.get(n.destinationPortalId);if(r){lr.setIdentity(),lr.setOrigin(r.portalSpawnPosition),lr.setRotation(r.portalSpawnQuaternion),e.ammoBody.setWorldTransform(lr);var i=new THREE.Vector3(0,0,A/2);i.applyQuaternion(r.portalSpawnQuaternion.toThree()),ur.setFromThree(i),e.ammoBody.setLinearVelocity(ur),e.input.direction.setFromQuaternion(e.ammoBody.getWorldTransform().getRotation().toThree()),vr||(e==Ul||yc&&e==Vl?de(250):pe(r.portalSpawnPosition.toThree()))}else console.error("Portal ",n.name,"has invalid destination")}if(new THREE.Vector3(0,-1,0),new LRUMap(500),yt)function Cr(t,e){var n=new THREE.SphereGeometry(.01,6,6),r=new THREE.MeshBasicMaterial({color:65280}),i=new THREE.Mesh(n,r);i.position.copy(t),vl.add(i);var o=[t.clone(),t.clone().add(e)],a=(n=(new THREE.BufferGeometry).setFromPoints(o),new THREE.Line(n,r));vl.add(a),setTimeout(function(){vl.remove(i),vl.remove(a)},1e3)}function zr(t,e,n){for(let t=0;t<oc.length;t++)oc[t].killed||(oc[t].floorContact=!1,oc[t].currentQuaternion=oc[t].ammoBody.getWorldTransform().getRotation().toThree(),oc[t].gravityObjects=[]);if(Vs)for(let t in cs)cs[t].gravityObjects=[];let r=kl.getNumManifolds();for(let e=0;e<r;e++){let r=kl.getManifoldByIndexInternal(e),i=r.getNumContacts();if(i>0){let e=v.btRigidBody.prototype.upcast(r.getBody0()),o=v.btRigidBody.prototype.upcast(r.getBody1());if(yt&&(e.threeObject===Ul||o.threeObject===Ul))for(let t=0;t<i;t++)Cr(r.getContactPoint(t).getPositionWorldOnA().toThree(),r.getContactPoint(t).m_normalWorldOnB.toThree().normalize().multiplyScalar(r.getContactPoint(t).getAppliedImpulse()));n&&(e.threeObject.isPlayer&&o.threeObject.isJumpad?Mr(t,e.threeObject,o.threeObject):o.threeObject.isPlayer&&e.threeObject.isJumpad?Mr(t,o.threeObject,e.threeObject):e.threeObject.isPlayer&&o.threeObject.isPortalIn?jr(0,e.threeObject,o.threeObject):o.threeObject.isPlayer&&e.threeObject.isPortalIn&&jr(0,o.threeObject,e.threeObject)),o.threeObject.isGravityCollider&&(e.threeObject.isPlayer||e.threeObject.isObject)?e.threeObject.gravityObjects.push(o.threeObject):e.threeObject.isGravityCollider&&(o.threeObject.isPlayer||o.threeObject.isObject)?o.threeObject.gravityObjects.push(e.threeObject):(e.threeObject.isPlayer&&Rr(0,e.threeObject,i,r,o.threeObject,!0),o.threeObject.isPlayer&&Rr(0,o.threeObject,i,r,e.threeObject,!1))}}if(Vs){for(let t=0;t<oc.length;t++)if(!oc[t].killed){let e=oc[t];var i=null;if(0==e.gravityObjects.length)e.alteredGravity&&(i=e.gravityQuaternion,e.alteredGravity=!1,e.gravityQuaternion=null,e.ammoBody.setGravity(Hl.getGravity()));else if(1==e.gravityObjects.length)e.gravityQuaternion!=e.gravityObjects[0].gravityQuaternion&&(i=e.gravityQuaternion||new THREE.Quaternion,e.alteredGravity=!0,cr.setFromThree(e.gravityObjects[0].gravityVector),e.ammoBody.setGravity(cr),e.gravityQuaternion=e.gravityObjects[0].gravityQuaternion);else{e.alteredGravity=!0;let t=new THREE.Vector3;for(let n=0;n<e.gravityObjects.length;n++)t.add(e.gravityObjects[n].gravityVector);if(t.divideScalar(e.gravityObjects.length),cr.setFromThree(t),e.ammoBody.setGravity(cr),Math.abs(t.x)<.01&&Math.abs(t.z)<.01)var o=t.y<0?new THREE.Quaternion:Math.abs(e.gravityObjects[0].gravityQuaternion.z)>.01?new THREE.Quaternion(0,0,1,0):new THREE.Quaternion(1,0,0,0);else o=(new THREE.Quaternion).setFromUnitVectors(hr,t.normalize());e.gravityQuaternion&&e.gravityQuaternion.equals(o)||(i=e.gravityQuaternion||new THREE.Quaternion,e.gravityQuaternion=o)}if(i){var a=e.alteredGravity?e.gravityQuaternion:new THREE.Quaternion;if(Math.abs(Math.PI-i.angleTo(a))<=.01){var s=i.clone().invert().multiply(a);s.multiply((new THREE.Quaternion).setFromEuler(new THREE.Euler(0,e.input.direction.y,0,"YXZ")));var l=(new THREE.Euler).setFromQuaternion(s,"YXZ");e.input.direction.y=l.y}e==Ul&&ui()}}for(let t in cs){let e=cs[t];if(0==e.gravityObjects.length)e.alteredGravity&&(e.alteredGravity=!1,e.gravityQuaternion=null,e.ammoBody.setGravity(Hl.getGravity()));else if(1==e.gravityObjects.length)e.gravityQuaternion!=e.gravityObjects[0].gravityQuaternion&&(e.alteredGravity=!0,cr.setFromThree(e.gravityObjects[0].gravityVector),e.ammoBody.setGravity(cr),e.gravityQuaternion=e.gravityObjects[0].gravityQuaternion);else{e.alteredGravity=!0;let t=new THREE.Vector3;for(let n=0;n<e.gravityObjects.length;n++)t.add(e.gravityObjects[n].gravityVector);t.divideScalar(e.gravityObjects.length),cr.setFromThree(t),e.ammoBody.setGravity(cr),e.gravityQuaternion=(new THREE.Quaternion).setFromUnitVectors(hr,t.normalize())}}}}function Rr(t,e,n,r,i,o){var a=!i.isPlayer;for(let t=0;t<n;t++){let n=r.getContactPoint(t);if(a){var s=(o?n.get_m_localPointA():n.get_m_localPointB()).toThree();e.shocked||e.sliding?(s.applyQuaternion(e.currentQuaternion),s.y<0&&(e.floorContact=!0,a=!1)):s.y<-(S/2-.5*T)&&(e.floorContact=!0,a=!1)}}}function Ar(t,e){var n=(e.input.up||e.input.down||e.input.left||e.input.right)&&!e.shocked;cr.setValue(0,0,0),e.input.up&&cr.setZ(cr.z()+1),e.input.down&&cr.setZ(cr.z()-1),e.input.left&&cr.setX(cr.x()+1),e.input.right&&cr.setX(cr.x()-1);var r=!e.sliding&&(t-e.input.lastJumpadTick<=6||t-e.input.lastJumpTick<=6)||!e.floorContact;!e.flying&&r&&(e.flyStartTick=t),e.flying&&!r&&e.timeSinceStartedFlying,e.flying=r;var i=0;if(!e.shocked){if(0!=cr.x()||0!=cr.y()||0!=cr.z()){cr.normalize();var o=cr.toThree(),a=e.ammoBody.getWorldTransform().getRotation().toThree(),s=new THREE.Euler;s.setFromQuaternion(a,"YZX");var l=s.y;if(o.applyAxisAngle(Sr,l),e.legsDirection=Math.atan2(o.x,o.z),e.input.down&&(e.legsDirection+=Math.PI),r)if(e.input.jumpadMovementLockDelay){var c=(t-e.input.lastJumpadTick)/e.input.jumpadMovementLockDelay;c>=1&&(delete e.input.jumpadMovementLockDelay,c=1);var u=I*c}else u=I;else u=e.sliding?k:R;o.multiplyScalar(u),cr.setValue(o.x,o.y,o.z);var p=e.ammoBody.getLinearVelocity();if(!e.sliding&&e.groundMovingObjects&&1==e.groundMovingObjects.length){let t=p.toThree();if(e.groundMovingObjects[0].addAngularVelocityToPlayer){let n=e.groundMovingObjects[0].ammoBody.getCenterOfMassTransform().getOrigin(),r=e.ammoBody.getWorldTransform().getOrigin(),i=e.groundMovingObjects[0].ammoBody.getAngularVelocity().y(),o=new THREE.Vector3(r.z()-n.z(),0,-(r.x()-n.x()));o.multiplyScalar(i),t.x-=o.x,t.z-=o.z,t.y=0}else{let n=e.groundMovingObjects[0].ammoBody.getLinearVelocity();t.x-=n.x(),t.z-=n.z(),t.y=0}o.multiplyScalar(1/M),o.add(t),o.length()>A&&(o.normalize().multiplyScalar(A),o.sub(t).multiplyScalar(M),cr.setFromThree(o))}else var d=Math.sqrt(Math.pow(p.x(),2)+Math.pow(p.z(),2));if(e.ammoBody.applyCentralImpulse(cr),!e.sliding){i=Math.sqrt(Math.pow(p.x(),2)+Math.pow(p.z(),2));var h=r?Math.max(d,P):A;e.groundMovingObjects&&1==e.groundMovingObjects.length||i>h&&(p.setX(p.x()/i*h),p.setZ(p.z()/i*h))}}else{var f=r?O:e.sliding?0:L;if(!e.sliding&&e.groundMovingObjects&&1==e.groundMovingObjects.length){let t,n,r=(p=e.ammoBody.getLinearVelocity()).toThree();if(e.groundMovingObjects[0].addAngularVelocityToPlayer){let r=e.groundMovingObjects[0].ammoBody.getCenterOfMassTransform().getOrigin(),i=e.ammoBody.getWorldTransform().getOrigin(),o=e.groundMovingObjects[0].ammoBody.getAngularVelocity().y(),a=new THREE.Vector3(i.z()-r.z(),0,-(i.x()-r.x()));a.multiplyScalar(o),t=a.x,n=a.z}else{let r=e.groundMovingObjects[0].ammoBody.getLinearVelocity();t=r.x(),n=r.z()}r.x-=t,r.z-=n,r.y=0,f>0&&(e.playerImpulseFactor&&(f*=e.playerImpulseFactor),r.x*=1/(1+f),r.z*=1/(1+f)),p.setX(r.x+groundVelocity.x()),p.setZ(r.z+groundVelocity.z())}else f>0&&(e.playerImpulseFactor&&(f*=e.playerImpulseFactor),(p=e.ammoBody.getLinearVelocity()).setX(p.x()*(1/(1+f))),p.setZ(p.z()*(1/(1+f))))}!r&&!e.sliding&&t-e.input.requestJumpTick<=D&&t-e.input.lastJumpTick>H&&e.floorContact&&(cr.setValue(0,B,0),e.ammoBody.applyCentralImpulse(cr),e.input.requestJumpTick=0,e.input.lastJumpTick=t)}e.ammoBody.setFriction(r?z:n?C:j)}function Lr(t){for(var e=0;e<oc.length;e++){var n=oc[e];n.killed||Ar(t,n)}}function Ir(t){}var Pr=0;function Or(t){var e,n=performance.now();if(lc==J||lc==K||lc==$){var r=1;if(pc>=Pr&&hc&&dc>0&&(gr=br?dc-fc:pc-fc,Math.abs(gr)>120?pc=fc:gr<0?r=2:gr>2&&(r=0),Pr=pc+r+Math.ceil(Nn/E),hc=!1),r>0){if(function(t){if(zi){var e=(navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[])[0];if(e){if(e.buttons.length>0)for(let t=0;t<e.buttons.length;t++)!e.buttons[t].pressed||Ul.input.jump||lc!=J&&lc!=$?Ri.jump!=t||e.buttons[t].pressed||(Ul.input.jump=!1,Ri.jump=-1):(Ul.input.requestJumpTick=pc,Ul.input.jump=!0,Ri.jump=t,Nr="gamepad");e.axes.length>=1&&(e.axes[0]>.2?(Ul.input.right=!0,Ul.input.left=!1,Ri.axe0=!0,Nr="gamepad"):e.axes[0]<-.2?(Ul.input.right=!1,Ul.input.left=!0,Ri.axe0=!0,Nr="gamepad"):Ri.axe0&&(Ul.input.right=!1,Ul.input.left=!1,Ri.axe0=!1)),e.axes.length>=2&&(e.axes[1]>.2?(Ul.input.down=!0,Ul.input.up=!1,Ri.axe1=!0,Nr="gamepad"):e.axes[1]<-.2?(Ul.input.down=!1,Ul.input.up=!0,Ri.axe1=!0,Nr="gamepad"):Ri.axe1&&(Ul.input.down=!1,Ul.input.up=!1,Ri.axe1=!1)),e.axes.length>=3&&Math.abs(e.axes[2])>.1&&(Ul.input.direction.y+=.05*-e.axes[2],ui()),e.axes.length>=4&&Math.abs(e.axes[3])>.1&&(Ul.input.direction.x+=.025*e.axes[3],Ul.input.direction.x>1.45&&(Ul.input.direction.x=1.45),Ul.input.direction.x<-1.45&&(Ul.input.direction.x=-1.45))}}if(0!=Mi){var n=5*Oc.mouseSensitivity/100;Ul.input.direction.y+=Mi/25*n,ui()}}(),function(){if(!(Kn<2||Ec)){var t=pc%E==0,e=new DataView(new ArrayBuffer(15+(t?2:0)));e.writeUint8(t?5:4),e.writeUint32(pc);var n=(Ul.input.up?1:0)+(Ul.input.down?2:0)+(Ul.input.left?4:0)+(Ul.input.right?8:0)+(Ul.input.jump?16:0)+(Ul.input.fire?32:0);e.writeUint8(n),e.writeFloat32(Ul.input.direction.x),e.writeFloat32(Ul.input.direction.y),t&&e.writeUint16(Nn),Fn.send(e.buffer),Vn=(new Date).getTime(),Gn.push(Vn)}}(),br){(e={}).left=Ul.input.left,e.right=Ul.input.right,e.up=Ul.input.up,e.down=Ul.input.down,e.fire=Ul.input.fire,e.jump=Ul.input.jump,e.requestFireTick=Ul.input.requestFireTick,e.requestJumpTick=Ul.input.requestJumpTick,e.lastJumpTick=Ul.input.lastJumpTick,e.lastJumpadTick=Ul.input.lastJumpadTick,e.jumpadMovementLockDelay=Ul.input.jumpadMovementLockDelay,ya.push({tick:pc,state:e}),Ul.input.left;var i=!1;if(Fl&&Fl.tick<=pc){var o=!0;pc-Fl.tick>St?o=!1:pc-Fl.tick>Mt?o=Fl.tick%8==0:0!=xr&&(o=Fl.tick%Math.pow(2,xr)==0),o&&((i=function(t,e){var n=t.playerStates,r=t.tick,i=null;if(Et){var o=function(t){for(var e=0;e<_a.length&&_a[e].tick<t;)e++;var n=_a[e];return n&&n.tick!=t?null:n}(t.tick);if(o)if(Tt){if((i=function(t,e){var n=new Set;if(t.length!=e.length)return n;for(var r=new Map,i=0;i<t.length;i++){var o=t[i],a=e[i];if(o.id==a.id){if(ac[o.id]&&ac[o.id].killed)continue;var s=Math.floor(o.position.x/(4*T)),l=Math.floor(o.position.z/(4*T)),c=!1;t:for(let t=-1;t<=1;t++)for(let e=-1;e<=1;e++){let i=s+t+"/"+(l+e);if(r.has(i)){n.delete(r.get(i)),c=!0;break t}}r.set(s+"/"+l,o.id),!c&&Ba(o,a)&&n.add(o.id)}}return n}(o.playerStates,t.playerStates)).size==oc.length)return Ua(t.playerStates),!1}else if(function(t,e){if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++){var r=t[n],i=e[n];if(r.id!=i.id)return!1;if(!Ba(r,i))return!1}return!0}(o.playerStates,t.playerStates))return Ua(t.playerStates),Ha(),!1}var a=[];for(let t=0;t<ic.length;t++){var s=ic[t];if(!s.threeObject.isPlayer||i&&i.has(s.threeObject.playerId)){var l=s.getBroadphaseProxy();a.push({body:s,group:l.get_m_collisionFilterGroup(),mask:l.get_m_collisionFilterMask(),gravity:s.hasCustomGravity?s.getGravity().toThree():null}),Hl.removeRigidBody(s)}}var c=[];for(let t=0;t<oc.length;t++)c.push(oc[t].ammoBody.getWorldTransform().getOrigin().toThree());for(let t=0;t<n.length;t++){let e=ac[n[t].id];if(e&&(!i||!i.has(e.playerId))){var u=e===Ul;Da(r,e,n[t],u)}}var p=Fa(r);for(vr=!0;r<pc;)Lr(r),Ga(r),Hl.stepSimulation(1/E,1),zr(r,0,!0),Va(r),p=Fa(++r,p);vr=!1;for(let t=0;t<oc.length;t++){var d=oc[t];if(!i||!i.has(d.playerId)){var h=d.ammoBody.getWorldTransform().getOrigin().toThree(),f=c[t],m=h.distanceTo(f);m>=bt&&m<=xt&&(d.smoothing||(d.smoothing=[]),d.smoothing.push({vector:f.sub(h),start:(new Date).getTime()}))}}for(let t=0;t<a.length;t++){var y=a[t];if(Hl.addRigidBody(y.body,y.group,y.mask),y.gravity){let t=y.body.getGravity();t.setFromThree(y.gravity),y.body.setGravity(t)}}return function(t){for(;_a.length>0&&_a[0].tick<t;)_a.splice(0,1)}(t.tick),Na(t.tick),function(t){for(;ga.length>0&&ga[0].tick<t;)ga.splice(0,1)}(t.tick),function(t){for(;ba.length>0&&ba[0].tick<t;)ba.splice(0,1);for(;va.length>0&&va[0].tick<t;)va.splice(0,1)}(t.tick),Ha(),!0}(Fl))&&fr&&fr.addEntry(100),Fl=null)}i||(Ha(),fr&&fr.addEntry(0))}for(var a=0;a<r;a++)lc!=$&&lc!=J||br&&Lr(pc),Os(),Hl.stepSimulation(t/1e3,1),zr(pc,0,br),pc++}}var s=performance.now();wr=s-n}var kr=new THREE.Clock,Br=new THREE.Vector3,Dr=new THREE.Vector3,Hr=1;function Fr(t){var e,n,r,i,o=performance.now(),a=kr.getDelta(),s=lc!=tt&&lc!=et,l=new THREE.Matrix4,c=(new THREE.Vector3(1,1,1),new THREE.Vector3),u=new THREE.Quaternion;ic.forEach(function(e){if(e.getMotionState()){let h=e.getWorldTransform();if(e.threeObject){var n=e.threeObject;if(n instanceof Gs)c.setFromAmmo(h.getOrigin()),u.setFromAmmo(h.getRotation()),n.visualOffset&&c.sub(n.visualOffset.clone().applyQuaternion(u).multiply(n.scale)),s&&ot&&(n.interpLastPosition?(n.interpCurrentTick!=pc&&(n.interpLastPosition=n.interpCurrentPosition,n.interpLastQuaternion=n.interpCurrentQuaternion,n.interpCurrentPosition=c.clone(),n.interpCurrentQuaternion=u.clone(),n.interpCurrentTick=pc),c.lerp(n.interpLastPosition,1-t),u.slerp(n.interpLastQuaternion,1-t)):(n.interpLastPosition=c.clone(),n.interpLastQuaternion=u.clone(),n.interpCurrentPosition=c.clone(),n.interpCurrentQuaternion=u.clone(),n.interpCurrentTick=pc)),l.compose(c,u,n.scale),n.mesh.setMatrixAt(n.index,l),n.mesh.instanceMatrix.needsUpdate=!0;else{var r=h.getOrigin();n.position.setFromAmmo(r);var i=h.getRotation();if(n.quaternion.setFromAmmo(i),n.visualOffset&&n.position.sub(n.visualOffset.clone().applyQuaternion(n.quaternion).multiply(n.scale)),n.smoothing){var o=(new Date).getTime();for(let t=n.smoothing.length-1;t>=0;t--)if((d=o-(p=n.smoothing[t]).start)>=wt)n.smoothing.splice(t,1);else{var a=1-d/wt;n.position.x+=p.vector.x*a,n.position.y+=p.vector.y*a,n.position.z+=p.vector.z*a}}if(n.rotSmoothing){o=(new Date).getTime();for(let t=n.rotSmoothing.length-1;t>=0;t--)(d=o-(p=n.rotSmoothing[t]).start)>=wt?n.rotSmoothing.splice(t,1):(a=1-d/wt,n.quaternion.premultiply(p.fromQuaternion.clone().slerp(p.toQuaternion,a).invert().premultiply(p.fromQuaternion)))}if(n.recoverFall){o=(new Date).getTime();for(let t=n.recoverFall.length-1;t>=0;t--){var p,d;(d=o-(p=n.recoverFall[t]).start)>=it?n.recoverFall.splice(t,1):(a=1-d/it,n.quaternion.slerp(p.quaternion,a))}}s&&ot&&(n.interpLastPosition?(n.interpCurrentTick!=pc&&(n.interpLastPosition=n.interpCurrentPosition,n.interpLastQuaternion=n.interpCurrentQuaternion,n.interpCurrentPosition=n.position.clone(),n.interpCurrentQuaternion=n.quaternion.clone(),n.interpCurrentTick=pc),n.position.lerp(n.interpLastPosition,1-t),n.quaternion.slerp(n.interpLastQuaternion,1-t)):(n.interpLastPosition=n.position.clone(),n.interpLastQuaternion=n.quaternion.clone(),n.interpCurrentPosition=n.position.clone(),n.interpCurrentQuaternion=n.quaternion.clone(),n.interpCurrentTick=pc))}}}}),s&&function(t){for(var e=ps,n=ds,r=hs,i=ls.length-1;i>=0;i--){var o=ls[i];o.object.ammoBody.getMotionState().getWorldTransform(os);var a=os.getOrigin();if(o.object instanceof Gs)n.setFromAmmo(a),r.setFromAmmo(os.getRotation()),o.object.visualOffset&&n.sub(o.object.visualOffset.clone().applyQuaternion(r).multiply(o.object.scale)),ot&&(o.interpLastPosition?(o.interpCurrentTick!=pc&&(o.interpLastPosition=o.interpCurrentPosition,o.interpLastQuaternion=o.interpCurrentQuaternion,o.interpCurrentPosition=n.clone(),o.interpCurrentQuaternion=r.clone(),o.interpCurrentTick=pc),n.lerp(o.interpLastPosition,1-t),r.slerp(o.interpLastQuaternion,1-t)):(o.interpLastPosition=n.clone(),o.interpLastQuaternion=r.clone(),o.interpCurrentPosition=n.clone(),o.interpCurrentQuaternion=r.clone(),o.interpCurrentTick=pc)),e.compose(n,r,o.object.scale),o.object.mesh.setMatrixAt(o.object.index,e),o.object.mesh.instanceMatrix.needsUpdate=!0;else{o.object.parent.worldToLocal(o.object.position.set(a.x(),a.y(),a.z()));var s=os.getRotation();o.object.quaternion.set(s.x(),s.y(),s.z(),s.w()),o.object.visualOffset&&o.object.position.sub(o.object.visualOffset.clone().applyQuaternion(o.object.quaternion).multiply(o.object.scale)),o.object.quaternion.set(s.x(),s.y(),s.z(),s.w()),ot&&(o.interpLastPosition?(o.interpCurrentTick!=pc&&(o.interpLastPosition=o.interpCurrentPosition,o.interpLastQuaternion=o.interpCurrentQuaternion,o.interpCurrentPosition=o.object.position.clone(),o.interpCurrentQuaternion=o.object.quaternion.clone(),o.interpCurrentTick=pc),o.object.position.lerp(o.interpLastPosition,1-t),o.object.quaternion.slerp(o.interpLastQuaternion,1-t)):(o.interpLastPosition=o.object.position.clone(),o.interpLastQuaternion=o.object.quaternion.clone(),o.interpCurrentPosition=o.object.position.clone(),o.interpCurrentQuaternion=o.object.quaternion.clone(),o.interpCurrentTick=pc)),o.object.updateMatrix()}o.canDelete&&ls.splice(i,1)}}(t);for(var p=0;p<oc.length;p++)oc[p].onDraw(a);if(Wt&&Wt.update(a),vl.controls){if(vl.controls.followPlayer){var d=yc?Vl:Ul;vl.controls.followPlayer.tpv?(gl.position.set(0,1,-3).applyEuler(d.input.direction).add(d.position),gl.y+=U*S,gl.setRotationFromEuler(Ul.input.direction),(y=new THREE.Vector3(0,0,20).applyEuler(d.input.direction).add(d.position)).y+=U*S,vl.controls.target.copy(y)):(gl.position.copy(d.position).add(vl.controls.followPlayer.offset),vl.controls.target.copy(d.position)),vl.controls.update(),ht&&(_l.position.copy(Ul.position),_l.position.y+=U*S,_l.setRotationFromEuler(Ul.input.direction),_l.rotateY(Math.PI))}}else if(s)if((d=Ul.killed&&!Ul.delayedRespawn&&Vl?Vl:Ul).cameraOnPlayer){_l.position.copy(d.cameraOnPlayer.position),(m=(new Date).getTime()-d.cameraStartTime)>3e3&&(m=3e3);var h=90*(m/3e3-.5)*Math.PI/180,f=new THREE.Vector3(0,0,8).applyAxisAngle(Sr,d.cameraStartAngle+h);f.y+=2,_l.position.add(f),_l.lookAt(d.cameraOnPlayer.position)}else if(yc&&Vl)_l.position.copy(Vl.position),_l.position.y+=U*S,_l.setRotationFromEuler(Vl.input.direction),Vl.alteredGravity&&_l.applyQuaternion(Vl.gravityQuaternion),_l.rotateY(Math.PI);else if(d.delayedRespawn){var m=Date.now()-d.delayedRespawn.startTime,y=Math.max(0,Math.min(1,m/d.delayedRespawn.duration));y=Ft.easeInOutCubic(y),c=d.delayedRespawn.fromPosition.clone().lerp(d.delayedRespawn.toPosition,y),u=d.delayedRespawn.fromQuaternion.clone().slerp(d.delayedRespawn.toQuaternion,y),_l.up=THREE.Object3D.DefaultUp.clone().applyQuaternion(u),_l.position.set(0,3,-7),_l.position.applyQuaternion(u),_l.position.add(c),_l.quaternion.copy(u),_l.rotateY(Math.PI)}else{if(Vs){var _=Date.now();d.alteredGravity?d.gravityQuaternion!=_l.targetGravityQuaternion?d.skipGravityChangeAnimation||(e=d.gravityQuaternion,n=_l.targetGravityQuaternion||new THREE.Quaternion,r=new THREE.Vector3(0,-1,0),i=new THREE.Vector3(0,-1,0),r.applyQuaternion(e),i.applyQuaternion(n),r.distanceToSquared(i)<1e-4)?(_l.previousGravityQuaternion=_l.currentGravityQuaternion?_l.currentGravityQuaternion.clone():new THREE.Quaternion,_l.targetGravityQuaternion=d.gravityQuaternion,_l.currentGravityQuaternion=_l.targetGravityQuaternion.clone(),_l.alteredGravityStartTime=0):(_l.previousGravityQuaternion=_l.currentGravityQuaternion?_l.currentGravityQuaternion.clone():new THREE.Quaternion,_l.targetGravityQuaternion=d.gravityQuaternion,_l.alteredGravityStartTime=Date.now(),_l.currentGravityQuaternion||(_l.currentGravityQuaternion=new THREE.Quaternion)):_l.targetGravityQuaternion&&_-_l.alteredGravityStartTime>500?_l.currentGravityQuaternion.copy(_l.targetGravityQuaternion):_l.targetGravityQuaternion&&_l.currentGravityQuaternion.copy(_l.previousGravityQuaternion).slerp(_l.targetGravityQuaternion,(_-_l.alteredGravityStartTime)/500):_l.targetGravityQuaternion?(_l.previousGravityQuaternion=_l.currentGravityQuaternion.clone(),_l.targetGravityQuaternion=null,_l.alteredGravityStartTime=Date.now()):_l.currentGravityQuaternion&&(_-_l.alteredGravityStartTime>500?_l.currentGravityQuaternion=null:_l.currentGravityQuaternion.copy(_l.previousGravityQuaternion).slerp(new THREE.Quaternion,(_-_l.alteredGravityStartTime)/500))}d.skipGravityChangeAnimation&&delete d.skipGravityChangeAnimation;var g=d.input.direction;if(ot&&(_l.interpLastPosition?(_l.interpCurrentTick!=pc&&(_l.interpLastDirection=_l.interpCurrentDirection,_l.interpCurrentDirection=g.clone(),_l.interpCurrentTick=pc),g.setFromQuaternion((new THREE.Quaternion).setFromEuler(g).slerp((new THREE.Quaternion).setFromEuler(_l.interpLastDirection),1-t),g.order)):(_l.interpLastDirection=g.clone(),_l.interpCurrentDirection=g.clone(),_l.interpCurrentTick=pc)),_l.currentGravityQuaternion?(_l.up=THREE.Object3D.DefaultUp.clone().applyQuaternion(_l.currentGravityQuaternion),_l.position.set(0,3,-7).applyEuler(g),_l.position.applyQuaternion(_l.currentGravityQuaternion),_l.position.add(d.position),(y=new THREE.Vector3(0,0,20).applyEuler(g)).y+=U*S,y.applyQuaternion(_l.currentGravityQuaternion),y.add(d.position)):(_l.up=THREE.Object3D.DefaultUp,_l.position.set(0,3,-7).applyEuler(g).add(d.position),(y=new THREE.Vector3(0,0,20).applyEuler(g).add(d.position)).y+=U*S),st){Dr.copy(_l.position).sub(y).multiplyScalar(.26911638216881834),Br.copy(_l.position).sub(Dr);let t=function(t,e){ur.setFromThree(t),pr.setValue(t.x+e.x,t.y+e.y,t.z+e.z);var n=new v.AllHitsRayResultCallback(ur,pr);n.set_m_collisionFilterGroup(X),n.set_m_collisionFilterMask(W);try{Hl.rayTest(ur,pr,n);var r=n.get_m_hitFractions(),i=n.get_m_collisionObjects(),o=r.size();if(o>0){for(var a=[],s=0;s<o;s++)if(0==(2&i.at(s).getCollisionFlags())){var l=r.at(s);a.push(l)}return a.sort(),a[0]}return 1}finally{v.destroy(n)}}(Br,Dr);if(t<1){let e=t-Hr;e>lt&&(e=lt),e<-lt&&(e=-lt),Hr+=e}else if(Hr<1){let t=1-Hr;t>lt&&(t=lt),Hr+=t}Hr<1&&_l.position.sub(Dr.multiplyScalar(1-Hr))}_l.lookAt(y)}if(ht){if(!window.cameraTarget){var b=new THREE.MeshPhongMaterial({color:"red",flatShading:!0}),x=new THREE.SphereBufferGeometry(.1,4,4);window.cameraTarget=new THREE.Mesh(x,b),window.cameraTarget.name="camera-target",vl.add(window.cameraTarget)}window.cameraTarget.position.copy(_l.position);var w=new THREE.Vector3(0,0,-1);if(w.applyQuaternion(_l.quaternion).multiplyScalar(10),window.cameraTarget.position.add(w),!window.boneHelpers)for(window.boneHelpers=[],p=0;p<Ul.bonesAim.length;p++)window.boneHelpers[p]=new THREE.ArrowHelper(new THREE.Vector3(0,0,1),new THREE.Vector3,3,16711680),window.boneHelpers[p].name="bone-helper",vl.add(window.boneHelpers[p]);for(p=0;p<Ul.bonesAim.length;p++)Ul.bonesAim[p].getWorldPosition(window.boneHelpers[p].position),Ul.bonesAim[p].getWorldQuaternion(window.boneHelpers[p].quaternion),window.boneHelpers[p].quaternion.multiply(dr.setFromEuler(new THREE.Euler(Math.PI/2,0,0)));for(p=0;p<vl.children.length;p++)(vl.children[p]instanceof THREE.SkeletonHelper||vl.children[p]instanceof THREE.CameraHelper)&&vl.children[p].updateMatrixWorld(!0)}Ir(),Sl.visible&&function(t){if(Rl&&Rl.visible)for(var e=new THREE.Matrix4,n=new THREE.Vector3,r=new THREE.Vector3,i=0;i<Rl.children.length;i++)for(var o=Rl.children[i],a=0;a<o.count;a++)o.getMatrixAt(a,e),n.setFromMatrixPosition(e),r.setFromMatrixScale(e),n.x<=Cl?n.x+=15*t*(2-r.x):n.x=jl,e.elements[12]=n.x,o.setMatrixAt(a,e),o.instanceMatrix.needsUpdate=!0;else for(let e=0;e<Ml.children.length;e++){const n=Ml.children[e];n.position.x<=Cl?n.position.setX(n.position.x+15*t*(2-n.scale.x)):n.position.setX(jl)}}(a),function(){if(-1!==Zl.indexOf("FloorIsLava")&&al){var t=new THREE.Matrix4;for(let e=0;e<al.count;e++){al.getMatrixAt(e,t);let n=(new THREE.Vector3).setFromMatrixPosition(t);al.previousPositions[e]&&al.velocities[e].copy(n).sub(al.previousPositions[e]),al.positionArray[e*ol+0].copy(n).add(new THREE.Vector3(-8.525,7.5,0)),al.positionArray[e*ol+1].copy(n).add(new THREE.Vector3(2.8-8.525,7.5,0)),al.positionArray[e*ol+2].copy(n).add(new THREE.Vector3(8.525,7.5,0)),al.positionArray[e*ol+3].copy(n).add(new THREE.Vector3(8.525-2.8,7.5,0)),al.previousPositions[e]=n}}}(),Ir(),bl.render(vl,vl.controls?gl:_l),ql.update(a),rc?(Pl||((Pl=new THREE.WebGLRenderer({antialias:Oc.graphicsQuality>=2,powerPreference:"high-performance"})).setPixelRatio(window.devicePixelRatio),Pl.setSize(.3*window.innerWidth,.3*window.innerHeight),Pl.shadowMap.type=THREE.PCFSoftShadowMap,Pl.shadowMap.enabled=bl.shadowMap.enabled,Pl.gammaFactor=bl.gammaFactor,Pl.outputEncoding=bl.outputEncoding,Pl.domElement.style.border="1px solid grey",Pl.domElement.style.position="absolute",document.body.appendChild(Pl.domElement)),Pl.render(vl,gl)):Pl&&(document.body.removeChild(Pl.domElement),Pl.dispose(),Pl=null);var E=performance.now();if(br&&-1==Oc.cspAccuracy){var T=E-o+wr;xr>0&&T<8&&MainLoop.getFPS()>50?(_=(new Date).getTime(),_r?_-_r>3e3&&(xr--,console.log((new Date).toGMTString(),"Changing CSP Accuracy to",xr),_r=null):(_r=_,yr=null)):xr<3&&T>12?(_=(new Date).getTime(),yr?_-yr>3e3&&(xr++,console.log((new Date).toGMTString(),"Changing CSP Accuracy to",xr),yr=null):(yr=_,_r=null)):(yr=null,_r=null)}!function(t){for(let t of Te)t.isPlaying||Te.delete(t);if(ct&&Oc.audioEnabled)for(let e in ge)ge[e].update(t);if((Se+=t)>=1){var e=(new Date).getTime();for(let t of Te)!t.loop&&t.buffer&&e-t.soundStartTime>1e3*t.buffer.duration*5&&(console.error("Sound has exceeded its play duration, forcing stop",t,e-t.soundStartTime,t.soundStartTime,t.buffer.duration),t.stop(),t.parent&&t.parent.remove(t));Se=0}}(a)}var Nr="none",Ur={MFORWARD:"Move Forward",MBACKWARD:"Move Backward",MLEFT:"Strafe Left",MRIGHT:"Strafe Right",JUMP:"Jump",CHAT:"Chat",MAINMENU:"Show Menu"},Vr={MFORWARD:[{code:"KeyW",keyCode:87},{code:"ArrowUp",keyCode:38}],MBACKWARD:[{code:"KeyS",keyCode:83},{code:"ArrowDown",keyCode:40}],MLEFT:[{code:"KeyA",keyCode:65},{code:"ArrowLeft",keyCode:37}],MRIGHT:[{code:"KeyD",keyCode:68},{code:"ArrowRight",keyCode:39}],SHOOT:[{button:0}],JUMP:[{button:2},{code:"Space",keyCode:32}],NEXTWEAPON:[{wheel:1},{code:"PageDown",keyCode:34}],PREVIOUSWEAPON:[{wheel:-1},{code:"PageUp",keyCode:33}],WEAPON0:[{code:"Digit1",keyCode:49}],WEAPON1:[{code:"Digit2",keyCode:50}],WEAPON2:[{code:"Digit3",keyCode:51}],WEAPON3:[{code:"Digit4",keyCode:52}],WEAPON4:[{code:"Digit5",keyCode:53}],WEAPON5:[{code:"Digit6",keyCode:54}],WEAPON6:[{code:"Digit7",keyCode:55}],WEAPON7:[{code:"Digit8",keyCode:56}],PEEKSCORES:[{code:"Tab",keyCode:9}],CHAT:[{code:"Enter",keyCode:13}],MAINMENU:[{code:"Escape",keyCode:27,canNotChange:!0}]},Gr={},Wr={},qr={},Xr={},Yr=!1;function Qr(){for(var t in Gr={},Wr={},qr={},Xr={},Vr)for(var e=0;e<Vr[t].length;e++){var n=Vr[t][e];void 0!==n.code&&(Gr[n.code]=t),void 0!==n.keyCode&&(Wr[n.keyCode]=t),void 0!==n.button&&(qr[n.button]=t),void 0!==n.wheel&&(Xr[n.wheel]=t)}}function Zr(t){Yr||(!Ul.killed||Ul.preventSpectate||Ul.delayedRespawn?(Kr||vl.controls&&!vl.controls.followPlayer?void 0!==qr[t.button]&&(_i(qr[t.button]),t.preventDefault()):(bl.domElement.focus(),ii()),window.focus()):sr(0!=t.button))}function Jr(t){Yr||void 0!==qr[t.button]&&gi(qr[t.button])}var Kr=!1,$r=!1;function ti(t){var e=Kr;Kr=document.pointerLockElement===bl.domElement,$r||!e||Kr?!e&&Kr&&document.getElementById("chat-container").classList.contains("typing")&&hi(!1):go(-1),$r=!1}function ei(t){}var ni,ri=0;function ii(){try{bl.domElement.requestPointerLock()}catch(t){console.error(t)}}function oi(t){try{$r=t,ri=(new Date).getTime(),document.exitPointerLock()}catch(t){console.error(t)}}var ai=2,si=2,li=4,ci=4;function ui(){if(!Ul.shocked&&!Ul.sliding){var t=new THREE.Quaternion;t.setFromEuler(new THREE.Euler(0,Ul.input.direction.y,0,"YXZ")),Ul.alteredGravity&&t.premultiply(Ul.gravityQuaternion),ni||(ni=new v.btQuaternion),ni.setFromThree(t),Ul.ammoBody.getWorldTransform().setRotation(ni)}}function pi(t){if(Kr&&!Ul.killed&&!Ul.delayedRespawn&&lc!=tt&&lc!=et){var e=t.movementX||t.mozMovementX||t.webkitMovementX||0,n=t.movementY||t.mozMovementY||t.webkitMovementY||0;if((0!=e||0!=n)&&(new Date).getTime()-ri>100){var r=5*Oc.mouseSensitivity/100;Ul.input.direction.y-=e/window.screen.width*ai*r,Ul.input.direction.x-=-n/window.screen.width*si*r,Ul.input.direction.x>1.45&&(Ul.input.direction.x=1.45),Ul.input.direction.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,Ul.input.direction.x)),ui()}}}function di(t){Yr||Kr&&0!=t.deltaY&&void 0!==Xr[Math.sign(t.deltaY)]&&(_i(Xr[Math.sign(t.deltaY)]),t.preventDefault())}function hi(t,e){var n=document.getElementById("chat-input");t&&n.value.length>0&&(function(t){if(Fn){t=t.substring(0,255);var e=new DataView(new ArrayBuffer(2+2*t.length));e.writeUint8(6),e.writeShortString(t),Fn.send(e.buffer)}}(n.value),n.value=""),n.blur(),document.getElementById("chat-container").classList.remove("typing"),0!=document.querySelectorAll("#screens > .visible").length||yc||(bl.domElement.focus(),ii())}function fi(t){var e="string"==typeof t.code&&t.code.length>0;return e&&Gr[t.code]?Gr[t.code]:!e&&void 0!==t.keyCode&&Wr[t.keyCode]?Wr[t.keyCode]:null}function mi(t){if(!Yr){var e=document.getElementById("chat-input"),n=e&&document.activeElement==e;if("string"==typeof t.code&&t.code.length,n);else if(Kr)(r=fi(t))&&(_i(r),"MFORWARD"==r&&(Nr=t.code)),t.preventDefault();else if(yc){var r;"PEEKSCORES"==(r=fi(t))&&(_i(r),t.preventDefault())}else document.getElementById("settings-screen").classList.contains("visible")&&"MAINMENU"==fi(t)&&(document.getElementById("settings-screen-done-btn").click(),t.preventDefault())}}function yi(t){if(!Yr){var e=document.getElementById("chat-input"),n=e&&document.activeElement==e,r="string"==typeof t.code&&t.code.length>0;if(n)r&&("Enter"==t.code||"NumpadEnter"==t.code)||!r&&13==t.keyCode?hi(!0):(r&&"Escape"==t.code||!r&&27==t.keyCode)&&hi(!1);else{var i=fi(t);i&&("CHAT"==i&&document.getElementById("settings-screen").classList.contains("visible")||gi(i)),t.preventDefault()}}}function _i(t){switch(t){case"MFORWARD":Ul.input.up=!0;break;case"MBACKWARD":Ul.input.down=!0;break;case"MLEFT":Ul.input.left=!0;break;case"MRIGHT":Ul.input.right=!0;break;case"JUMP":Ul.input.jump||lc!=J&&lc!=$||(Ul.input.requestJumpTick=pc,Ul.input.jump=!0);break;case"PEEKSCORES":break;case"MAINMENU":oi()}}function gi(t){switch(t){case"MFORWARD":Ul.input.up=!1;break;case"MBACKWARD":Ul.input.down=!1;break;case"MLEFT":Ul.input.left=!1;break;case"MRIGHT":Ul.input.right=!1;break;case"SHOOT":Ul.input.fire=!1,(e=document.getElementById("weapon-charge"))&&document.body.removeChild(e);break;case"JUMP":Ul.input.jump=!1;break;case"CHAT":Fn&&!It&&Oc.chatEnabled&&(oi(!0),document.getElementById("chat-container").classList.add("typing"),document.getElementById("chat-input").focus(),Ul.input.up=!1,Ul.input.down=!1,Ul.input.left=!1,Ul.input.right=!1,Ul.input.jump=!1,Ul.input.fire=!1,document.getElementById("feed-history").scrollTop=document.getElementById("feed-history").scrollHeight);break;case"PEEKSCORES":break;case"MAINMENU":Kr||go(-1)}var e}function vi(t){t!=Vl&&(Vl=t,kt("Observing "+t.name),delete _l.interpLastPosition,Ll&&(Ll.parent.remove(Ll),t.add(Ll),Ll.rotation.y=Math.PI))}-1!=navigator.userAgent.indexOf("Firefox")&&(ai*=1.5,si*=1.5);var bi,xi,wi,Ei=96*("undefined"==typeof window?0:+window.devicePixelRatio||ie()||0)/2.54,Ti={},Si={},Mi=0;function ji(t){var e=document.getElementById("mobile-jump-button").getBoundingClientRect();return t.clientX>=e.left&&t.clientY>=e.top&&t.clientX<=e.left+e.width&&t.clientY<=e.top+e.height}function Ci(t){if(0!=Kn){if((new Date).getTime(),"touchstart"===t.type)if(!Ul.killed||Ul.preventSpectate||Ul.delayedRespawn)for(var e=0;e<t.changedTouches.length;e++)if(ji(s=t.changedTouches[e]))_i("JUMP"),wi=s.identifier;else if(s.clientX<=window.innerWidth/2){var n=Qt(-1,_l),r=n.width/window.innerWidth,i=Math.min(Ei*r,Math.min(n.width,n.height)/5),o=((bi={clientX:s.clientX,clientY:s.clientY,identifier:s.identifier,worldUnitsPerPixel:r,joystickSize:i}).clientX-window.innerWidth/2)*r,a=(window.innerHeight/2-bi.clientY)*r;Ti.scale.set(i,i,1),Ti.position.set(o,a,-1),Si.scale.set(i/2,i/2,1),Si.position.set(o,a,-1),Ti.visible=!0,Si.visible=!0,Nr="touch"}else xi={clientX:s.clientX,clientY:s.clientY,identifier:s.identifier};else sr();else if("touchend"===t.type||"touchcancel"===t.type)for(e=0;e<t.changedTouches.length;e++){var s=t.changedTouches[e];bi&&bi.identifier==s.identifier?(Ul.input.up=Ul.input.down=Ul.input.left=Ul.input.right=!1,Mi=0,Ti.visible=!1,Si.visible=!1,bi=null):xi&&xi.identifier==s.identifier?xi=null:s.identifier===wi&&(gi("JUMP"),wi=void 0)}else if("touchmove"===t.type)for(e=0;e<t.changedTouches.length;e++)if(s=t.changedTouches[e],bi&&s.identifier==bi.identifier&&!Ul.killed){var l={clientX:s.clientX,clientY:s.clientY,identifier:s.identifier};o=(l.clientX-window.innerWidth/2)*bi.worldUnitsPerPixel,a=(window.innerHeight/2-l.clientY)*bi.worldUnitsPerPixel,Si.position.set(o,a,-1);var c=Math.sqrt(Math.pow(l.clientX-bi.clientX,2)+Math.pow(l.clientY-bi.clientY,2)),u=Math.min(1*Ei,Math.min(window.innerHeight,window.innerWidth)/5);if(c>=.2*u){var p=Math.atan2(l.clientY-bi.clientY,l.clientX-bi.clientX),d=1-Math.abs((Math.PI/2-Math.abs(p))/(Math.PI/2)),h=Math.abs(Math.abs(p)-Math.PI/2)/(Math.PI/2),f=Math.abs(p)>Math.PI/2;Rt?(d>.2?(Ul.input.up=p<0,Ul.input.down=p>0):Ul.input.up=Ul.input.down=!1,Mi=h>.2?(f?1:-1)*h:0):(Ul.input.up=-5*Math.PI/6<=p&&p<=-1*Math.PI/6,Ul.input.down=1*Math.PI/6<=p&&p<=5*Math.PI/6,Ul.input.left=p<=-4*Math.PI/6||p>=4*Math.PI/6,Ul.input.right=-2*Math.PI/6<=p&&p<=2*Math.PI/6),c>=.4*u&&(Si.position.x=Ti.position.x+Math.cos(p)*bi.joystickSize*.4,Si.position.y=Ti.position.y-Math.sin(p)*bi.joystickSize*.4,bi.clientX=s.clientX+Math.cos(p+Math.PI)*Math.min(c,u),bi.clientY=s.clientY+Math.sin(p+Math.PI)*Math.min(c,u),o=(bi.clientX-window.innerWidth/2)*bi.worldUnitsPerPixel,a=(window.innerHeight/2-bi.clientY)*bi.worldUnitsPerPixel,Ti.position.set(o,a,-1))}else Ul.input.up=Ul.input.down=Ul.input.left=Ul.input.right=!1,Mi=0}else if(xi&&s.identifier==xi.identifier&&!Ul.killed){var m={clientX:s.clientX,clientY:s.clientY,identifier:s.identifier},y=(c=Math.sqrt(Math.pow(m.clientX-xi.clientX,2)+Math.pow(m.clientY-xi.clientY,2)),p=Math.atan2(m.clientY-xi.clientY,m.clientX-xi.clientX),m.clientY-xi.clientY),_=5*Oc.mouseSensitivity/100;if(!Rt){var g=m.clientX-xi.clientX;Ul.input.direction.y-=g/window.screen.width*li*_,ui()}Ul.input.direction.x-=-y/window.screen.width*ci*_,xi=m,Ul.input.direction.x>1.45&&(Ul.input.direction.x=1.45),Ul.input.direction.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,Ul.input.direction.x))}t.preventDefault()}}var zi=!1,Ri={jump:-1,axe0:!1,axe1:!1,axe2:!1,axe3:!1};function Ai(){var t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[];zi=t.length>0}function Li(t,e){THREE.Group.call(this),this.name=t,this.colorIndex=e}function Ii(t,e,n,r,i){if(0==i)return r.setEffectiveWeight(0),void n.setEffectiveWeight(0);var o=Math.abs(t)>Math.abs(e);if(t+=.5,e+=.5,o){n.time=r.time=r.timeOffset+(r.getClip().duration-r.timeOffset)*t;var a=Math.abs((e-t)/(1-2*t));r.setEffectiveWeight((1-a)*i),n.setEffectiveWeight(a*i)}else r.time=r.timeOffset+(r.getClip().duration-r.timeOffset)*e,n.time=n.timeOffset+(n.getClip().duration-n.timeOffset)*(1-e),a=Math.abs((e-t)/(1-2*e)),r.setEffectiveWeight((1-a)*i),n.setEffectiveWeight(a*i)}new THREE.Euler,Li.prototype=Object.create(THREE.Group.prototype),Li.prototype.constructor=Li,Li.prototype.refreshPlayerTexture=function(){var t=this;t.refreshingPlayerTexture?t.refreshingPlayerIsPending=!0:(t.refreshingPlayerTexture=!0,rs(this,this.playerTexture,this.colorIndex,this.colorIndex2,this.colorIndex3,this.playerHat,function(){t.refreshingPlayerTexture=!1,t.refreshingPlayerIsPending&&(t.refreshingPlayerIsPending=!1,t.refreshPlayerTexture())}))},Li.prototype.addTextSprite=function(){this.textSprite&&(this.textSprite.material.map.dispose(),this.remove(this.textSprite));var t=this.name,e=document.createElement("canvas"),n=e.getContext("2d");n.font="20px Helvetica";var r=n.measureText(t);e.width=r.width+10,e.height=34,n.fillStyle=this.isPartyMember?"rgba(255,255,0,0.9)":"rgba(0,0,0,.2)",n.fillRect(0,0,e.width,e.height),n.font="20px Helvetica",n.textAlign="center",n.textBaseline="middle",n.fillStyle=this.isPartyMember?"black":"white",n.fillText(t,e.width/2,e.height/2);var i=new THREE.CanvasTexture(e);i.minFilter=THREE.LinearFilter,i.needsUpdate=!0;var o=new THREE.SpriteMaterial({map:i});o.sizeAttenuation=!1;var a=new THREE.Sprite(o);e.width,e.height,a.scale.set(.001*e.width,.001*e.height,1),a.center.set(.5,0),a.position.y+=S/2+.15,this.textSprite=a,this.add(a)},Li.prototype.playFlashHitAnimation=function(){var t=this.skinnedMesh.material.color,e=this.baseColor.r,n=this.baseColor.g,r=this.baseColor.b;anime({targets:t,r:[e,2,e],g:[n,2,n],b:[r,2,r],easing:"easeOutQuart",duration:150})},Li.prototype.removeFromScene=function(){vl.remove(this)},Li.prototype.onDraw=function(t){this.updateAnimation(),this.skeletonRoot.mixer.update(t),this.killed||function(t,e){if(ct&&Oc.audioEnabled){var n=t.ammoBody.getLinearVelocity(),r=Math.sqrt(Math.pow(n.x(),2)+Math.pow(n.z(),2));t.timeSinceLastStep+=e,t.flying&&(t.timeSinceStartedFlying+=e),!t.flying&&r>.3&&(t.input.up||t.input.down||t.input.left|t.input.right)?(t.timeSinceStartedFlying=0,t.isWalking?ye<=t.timeSinceLastStep&&(Re("footstep",t,!0),t.timeSinceLastStep=0):t.isWalking=!0):t.isWalking&&(t.isWalking=!1)}}(this,t)},Li.prototype.updatePlayerLegsRotation=function(){if(cr.setValue(0,0,0),this.input.up&&cr.setZ(cr.z()+1),this.input.down&&cr.setZ(cr.z()-1),this.input.left&&cr.setX(cr.x()+1),this.input.right&&cr.setX(cr.x()-1),0!=cr.x()||0!=cr.y()||0!=cr.z()){cr.normalize();var t=cr.toThree(),e=this.input.direction.y;t.applyAxisAngle(Sr,e),this.legsDirection=Math.atan2(t.x,t.z),this.input.down&&(this.legsDirection+=Math.PI)}},Li.prototype.updatePlayerSpineLegs=function(){this.updatePlayerLegsRotation();var t=Dt(this.input.direction.y),e=Dt(this.input.direction.x),n=Math.abs(e)/(Math.PI/2),r=function(t,e){for(var n=t-e;n<-Math.PI;)n+=2*Math.PI;for(;n>Math.PI;)n-=2*Math.PI;return n}(t,this.legsDirection);if(r<-rt&&(r=-rt,this.legsDirection=t+rt),r>rt&&(r=rt,this.legsDirection=t-rt),this.legs.rotation.set(0,0,0),this.skeletonRoot.horizontalRotation&&this.skeletonRoot.horizontalRotation.enabled&&(this.skeletonRoot.horizontalRotation.time=this.skeletonRoot.horizontalRotation.timeOffset+(this.skeletonRoot.horizontalRotation.getClip().duration-this.skeletonRoot.horizontalRotation.timeOffset)*(r/rt/2+.5)),this.skeletonRoot.runHorizontalRotation&&this.skeletonRoot.runHorizontalRotation.enabled&&(this.skeletonRoot.runHorizontalRotation.time=this.skeletonRoot.runHorizontalRotation.timeOffset+(this.skeletonRoot.runHorizontalRotation.getClip().duration-this.skeletonRoot.runHorizontalRotation.timeOffset)*(r/rt/2+.5)),this.skeletonRoot.verticalRotationLeft&&this.skeletonRoot.verticalRotationLeft.enabled){var i=r/rt/2+.5,o=e/Math.PI+.5;this.skeletonRoot.verticalRotationLeft.setEffectiveWeight(i),this.skeletonRoot.verticalRotationRight.setEffectiveWeight(1-i),this.skeletonRoot.verticalRotationRight.time=this.skeletonRoot.verticalRotationLeft.time=this.skeletonRoot.verticalRotationRight.timeOffset+(this.skeletonRoot.verticalRotationRight.getClip().duration-this.skeletonRoot.verticalRotationRight.timeOffset)*o}if(this.skeletonRoot.vRotTopLeftBotRight){var a=-r/rt/2,s=-e/Math.PI,l=this.skeletonRoot.idle.getEffectiveWeight()+this.skeletonRoot.jumpLoop.getEffectiveWeight(),c=this.skeletonRoot.run.getEffectiveWeight(),u=this.skeletonRoot.meleeIdle.getEffectiveWeight()+this.skeletonRoot.meleeRun.getEffectiveWeight()+this.skeletonRoot.meleeJumpLoop.getEffectiveWeight()+this.skeletonRoot.meleeBash.getEffectiveWeight();Ii(a,s,this.skeletonRoot.vRotTopLeftBotRight,this.skeletonRoot.vRotBotLeftTopRight,l),this.skeletonRoot.runVRotTopLeftBotRight&&this.skeletonRoot.runVRotBotLeftTopRight&&Ii(a,s,this.skeletonRoot.runVRotTopLeftBotRight,this.skeletonRoot.runVRotBotLeftTopRight,c),this.skeletonRoot.meleeVRotTopLeftBotRight&&this.skeletonRoot.meleeVRotBotLeftTopRight&&Ii(a,s,this.skeletonRoot.meleeVRotTopLeftBotRight,this.skeletonRoot.meleeVRotBotLeftTopRight,u)}if(!this.skeletonRoot.horizontalRotation&&!this.skeletonRoot.verticalRotationLeft&&!this.skeletonRoot.vRotTopLeftBotRight){var d=new THREE.Vector3(0,1,0),h=dr.setFromScaledRotationMatrix(this.legs.parent.matrixWorld);d.applyQuaternion(h.invert()),this.legs.rotateOnWorldAxis(d,-r)}if(!this.skeletonRoot.verticalRotationLeft&&!this.skeletonRoot.vRotTopLeftBotRight){if(ft)for(var f=0;f<p.bonesBaseQuaternion.length;f++)this.bonesAim[f].quaternion.copy(p.bonesBaseQuaternion[f]);else"jumpLoop"==this.animState&&this.bonesAim[1].quaternion.copy(this.bonesBaseQuaternion[1]);for(f=0;f<this.bonesAim.length;f++)this.input.direction.x<0?this.bonesAim[f].quaternion.premultiply(dr.set(0,0,0,1).slerp(this.bonesAimUpQuaternion[f],n)):this.bonesAim[f].quaternion.premultiply(dr.set(0,0,0,1).slerp(this.bonesAimDownQuaternion[f],n))}},Li.prototype.updateAnimation=function(){var t,e=this.animState,n=t=this.shocked?"shocked":this.flying?pc-this.flyStartTick>E?"fall":"jumpLoop":this.input.up?"run":this.input.down?"run":this.input.left||this.input.right?"run":"idle";if(this.meleeBody&&(n="attack"==this.meleeAttackState?"meleeBash":function(t){switch(t){case"idle":return"meleeIdle";case"run":return"meleeRun";case"jumpLoop":return"meleeJumpLoop"}return t}(n)),e==n)return this.skeletonRoot.horizontalRotation&&this.skeletonRoot.horizontalRotation.setEffectiveWeight(this.skeletonRoot.idle.isRunning()?this.skeletonRoot.idle.getEffectiveWeight():0),void(this.skeletonRoot.runHorizontalRotation&&this.skeletonRoot.runHorizontalRotation.setEffectiveWeight(this.skeletonRoot.run.isRunning()?this.skeletonRoot.run.getEffectiveWeight():0));if("meleeBash"==n&&(this.skeletonRoot.meleeBash.reset(),this.weaponFPV)){var r=this.meleeBody.weapon.hitToReadyDelay,i=this;anime({targets:this.weaponMeshesFPV.Melee.rotation,x:[.3,1],z:[.5,0],easing:"cubicBezier(0.32, -0.86, 1, -0.06)",duration:this.meleeBody.weapon.fireToHitDelay/E*1e3,complete:function(){anime({targets:i.weaponMeshesFPV.Melee.rotation,x:[1,.3],z:[0,.5],easing:"cubicBezier(0,-1,1,.7)",duration:r/E*1e3})}})}for(var o=this.animations.length-1;o>=0;o--)this.animations[o].enabled=!1;this.skeletonRoot[n].enabled=!0,this.skeletonRoot[e].enabled=!0,this.skeletonRoot[n].setEffectiveWeight(1),this.skeletonRoot[e].setEffectiveWeight(1),this.meleeBody&&"meleeBash"==e?this.skeletonRoot[n].crossFadeFrom(this.skeletonRoot[e],weapons[this.input.currentWeaponIndex].hitToReadyDelay?weapons[this.input.currentWeaponIndex].hitToReadyDelay/E:.5):this.skeletonRoot[n].crossFadeFrom(this.skeletonRoot[e],function(t,e){return"idle"==t&&"run"==e?.1:"idle"==t&&"jumpLoop"==e?.1:"run"==t&&"idle"==e?.8:"jumpLoop"==t&&"run"==e?.2:"run"==t&&"jumpLoop"==e?.3:"jumpLoop"==t&&"idle"==e?.1:"jumpLoop"==t&&"fall"==e?.5:"shocked"==t?.5:"shocked"==e?.25:.1}(e,t)),this.animState=n},Li.prototype.dispose=function(){if(this.skeleton&&this.skeleton.dispose(),this.skinnedMesh&&this.skinnedMesh.hasMergedGeo&&this.skinnedMesh.geometry.dispose(),this.textSprite&&this.textSprite.material&&this.textSprite.material.map&&this.textSprite.material.map.dispose(),this.skinnedMesh&&this.skinnedMesh.material.isTimeAnimated){let t=sl.indexOf(this.skinnedMesh.material);t>=0&&sl.splice(t,1)}};var Pi=function(){document.getElementById("eventmessages"),this.displayKill=function(t,e,n,r){},this.displayTelefrag=function(t,e){}},Oi={0:"Total Points",1:"Kill",2:"Streak",3:"Suicide",4:"Immolation",5:"Yeet!",6:"Telefrag",7:"Comeback",8:"Grinder",9:"Assist",10:"Avenge",11:"Air Kill",12:"Close Call",13:"Milk Spiller",14:"Killjoy",15:"Bone Breaker",16:"Grenade Kill",17:"First Blood",18:"Payback",19:"Sharp!",20:"On Fire!",21:"Duck Hunter",22:"Spawn Kill",23:"Vampire",24:"Point Blank",25:"Fire Kill",26:"Long Shot",27:"Skeet Shooter",28:"Psychic Rocket",29:"Last Resort",30:"Bouncer!",31:"Base Jumpers",32:"Double Dip",33:"Master of Arms",34:"Milk Addict",35:"Rager",36:"Eye for an Eye"},ki=300,Bi=200,Di=1200,Hi=[],Fi=[],Ni=1.2,Ui=6,Vi=3,Gi=800,Wi=400,qi="Helvetica Neue, Helvetica, Roboto, Arial, sans-serif",Xi="Arial",Yi=6,Qi=50,Zi=160;function Ji(t){var e,n,r,i,o,a=bl.domElement.height,s=(e=Qt(-_l.near,_l)).height/2,l=e.height/100,c=t.shift();if(0==c.type){n=0,i=5*l,o=8*l,r=$i(c.points);var u=Ui,p=Gi,d="yellow"}else i=(n=s-18*l)+5*l,o=n+8*l,r=function(t,e,n){var r="";switch(e){case 2:return(r=n<100?n+"-":"Impossible-")+t;case 14:return t+" (x"+n+")";case 19:switch(n-2){case 0:r="";break;case 1:r="Very ";break;case 2:r="Very Very ";break;case 3:r="Cracking ";break;case 4:r="Impressively ";break;case 5:r="Splendidly ";break;case 6:r="Amazingly ";break;case 7:r="Stunningly ";break;case 8:r="Spectacularly ";break;case 9:r="Phenomenally ";break;case 10:r="Unbeliavably ";break;case 11:r="Miracoulously ";break;default:r="Impossibly "}return r+t;default:return t}}(r=Oi[c.type]+" "+$i(c.points),c.type,c.param1),u=Vi,p=Wi,d="white";var h=function(t,e,n,r,i,o){var a,s,l=(n*=t/100)/100*Qi,c=document.createElement("canvas"),u=c.getContext("2d");u.font=r+" "+n+"px "+qi;var p=u.measureText(e);return o?(s=n/100*Zi,u.font=s+"px "+Xi,a=u.measureText(o),c.width=Math.max(p.width,a.width)+l,c.height=n*Ni+l+(s*Ni+l)):(c.width=p.width+l,c.height=n*Ni+l),u.shadowColor="rgba(0,0,0,0.7)",u.shadowBlur=n/100*Yi,u.shadowOffsetX=u.shadowBlur/2,u.shadowOffsetY=u.shadowBlur/2,o?(u.font=s+"px "+Xi,u.textAlign="center",u.textBaseline="bottom",u.fillStyle=i,u.fillText(o,c.width/2,c.height/2+l/2),u.font=r+" "+n+"px "+qi,u.textAlign="center",u.textBaseline="top",u.fillStyle=i,u.fillText(e,c.width/2,c.height/2+l/2)):(u.font=r+" "+n+"px "+qi,u.textAlign="center",u.textBaseline="middle",u.fillStyle=i,u.fillText(e,c.width/2,c.height/2)),c}(a,r,u,p,d,Bc?function(t,e){var n="";switch(t){case 2:if(e<=10)for(let t=0;t<e;t++)n+="⭐";else if(e>10&&e<20)for(let t=0;t<e%10;t++)n+="🌟";else n="🤖🌟";return n;case 3:return"💀";case 4:return"🔥💀";case 5:return"🤣";case 6:return"👽";case 7:return"🤠";case 8:return"⚙️";case 9:return"🏀";case 10:return"🐺";case 11:return"🦅";case 12:return"♠️";case 13:return"🥛💦";case 14:return"🏴‍☠️";case 15:return"🔨";case 16:return"💣";case 17:return"💉";case 18:return"💵";case 19:switch(e-2){case 0:n="🎯";break;case 1:n="😎🎯";break;case 2:n="😎😎🎯";break;case 3:n="😲🎯";break;case 4:n="😲😲🎯";break;case 5:n="😲😲😲🎯";break;case 6:n="😵🎯";break;case 7:n="😵😵🎯";break;case 8:n="😵😵😵🎯";break;case 9:n="🙀🎯";break;case 10:n="🙀🙀🎯";break;case 11:n="🙀🙀🙀🎯";break;default:n="🤖🎯"}return n;case 20:for(let t=0;t<e;t++)t<=10?n+="🌶️":n="🤖🌶️";return n;case 21:return"🦆";case 22:return"🍳";case 23:return"🦇";case 24:return"💋";case 25:return"🔥";case 26:return"🏹";case 27:return"✨";case 28:return"🔮🚀";case 29:return"🏝️";case 30:return"👊";case 31:return"👬";case 32:return"🦇‼️";case 33:return"🎓🔫";case 34:return"🍼";case 35:return"♠️💢";case 36:return"👁️➰👁️";default:return null}}(c.type,c.param1):null),f=new THREE.Texture(h);f.minFilter=THREE.NearestFilter,f.needsUpdate=!0;var m=new THREE.SpriteMaterial({map:f,depthTest:!1,opacity:0}),y=new THREE.Sprite(m),_=h.width/h.height,g=h.height*e.height/a;y.scale.set(g*_,g,1),y.center.set(.5,.5),y.position.z=-_l.near,y.position.y=n,_l.add(y);var v=anime.timeline({easing:"easeOutExpo",autoplay:!1,complete:function(){var e;(e=t).length>0?(Ji(e),Ki(e)):e.activeAnimation=null}});v.add({targets:y.position,y:i,duration:ki}).add({targets:y.material,opacity:1,duration:ki},"-="+ki).add({targets:y.position,y:o,easing:"easeInExpo",duration:Bi},"+="+Di).add({targets:y.material,opacity:0,easing:"easeInExpo",duration:Bi,complete:function(){_l.remove(y)}},"-="+Bi),t.activeAnimation=c.animation=v}function Ki(t){t.activeAnimation.play()}function $i(t){return 0==t?"":t>0?"+"+t:""+t}var to=0,eo=0,no=600,ro=!1;try{localStorage.getItem("gamesStarted")&&(to=parseInt(localStorage.getItem("gamesStarted")))}catch(e){}function io(){window.confirm("Are you sure you want to quit the match?")&&(Kn=0,$l&&$l.gameplayStop(),history.replaceState("",document.title,window.location.pathname+window.location.search+window.location.hash),po?window.location.search=window.location.search.length>1?window.location.search+"&npb=1":"?npb=1":window.location.reload())}function oo(){mo(),Ce("ui_options")}function ao(){Kn=0,history.replaceState("",document.title,window.location.pathname+window.location.search+window.location.hash),po?window.location.search=window.location.search.length>1?window.location.search+"&npb=1":"?npb=1":window.location.reload(),Ce("ui_done")}function so(){!gc||w&&!Ie?Tc=!0:(Tc=!1,function(){if(window.cordova)return to>0;if("undefined"!=typeof PokiSDK)return!0;if(jc&&Date.now()/1e3<jc)return!1;if(3==Ze||4==Ze){var t=(new Date).getTime();return t<pl||t-pl>=6e4*(3==Ze?3:4)}return to%2==1}()&&function(){try{if(ul=!0,$l)$l.requestAd(),tc.onInterstitialRequested("crazy");else if("undefined"!=typeof admob)admobAdLoaded?admob.showInterstitialAd():admobRequestInterstitialAd(!0),tc.onInterstitialRequested("admob");else if("undefined"!=typeof PokiSDK)PokiSDK.commercialBreak().then(hl),tc.onInterstitialRequested("poki");else if(window.famobi)window.famobi.showAd(hl),tc.onInterstitialRequested("famobi");else if("undefined"!=typeof aiptag&&aiptag.cmd.player.push&&0==aiptag.cmd.player.length&&"undefined"!=typeof adplayer)aiptag.cmd.player.push(function(){adplayer.startPreRoll()}),tc.onInterstitialRequested("adinplay");else{if(!vt)return ul=!1,tc.onInterstitialBlocked(),!1;var t=document.createElement("div");t.style.zIndex=9999999,t.style.position="fixed",t.style.width="100%",t.style.top="50%",t.style.transform="translateY(-50%)",t.style.backgroundColor="rgba(0,0,0,0.8)",t.style.color="white",t.style.fontSize="10vh",t.style.textAlign="center",t.style.paddingTop="45vh",t.style.paddingBottom="45vh",t.innerHTML="Video interstitial",document.body.appendChild(t),setTimeout(function(){document.body.removeChild(t),hl()},2e3)}return!0}catch(t){return console.error(t),ul=!1,!1}}()||lo())}function lo(){to++;try{localStorage.setItem("gamesStarted",to)}catch(t){}sn?function(){var t=Ie;try{t=Fe.getValue().value}catch(t){}ln&&an&&an.send("s "+t)}():w?mn():er(x),Mc=function(){var t=!1,e=document.createElement("div");if(e.setAttribute("class","pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links ad-text adSense adBlock adContent adBanner"),e.setAttribute("style","width: 1px ! important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;"),window.document.body.appendChild(e),null!==window.document.body.getAttribute("abp")||null===e.offsetParent||0==e.offsetHeight||0==e.offsetLeft||0==e.offsetTop||0==e.offsetWidth||0==e.clientHeight||0==e.clientWidth)t=!0;else if(void 0!==window.getComputedStyle){var n=window.getComputedStyle(e,null);!n||"none"!=n.getPropertyValue("display")&&"hidden"!=n.getPropertyValue("visibility")||(t=!0)}return window.document.body.removeChild(e),t}(),tc.onGameStart()}var co=void 0!==window.CrazyGames||-1!==document.referrer.indexOf("crazygames.com")||-1!==document.referrer.indexOf("speelspelletjes.nl")||-1!==document.referrer.indexOf("gioca.re")||-1!==document.referrer.indexOf(" onlinegame.co.id")||-1!==document.referrer.indexOf("1001juegos.com")||-1!==document.referrer.indexOf("crazygames.fr")||-1!==document.referrer.indexOf("crazygames.ru")||-1!==document.referrer.indexOf("crazygames.com.br")||-1!==window.location.search.indexOf("isCrazyGames=1"),uo=-1!==document.referrer.indexOf("pacogames.com")||-1!==document.referrer.indexOf("gamearter.com");co&&-1===window.location.search.indexOf("isCrazyGames=1")&&history.replaceState("",document.title,window.location.pathname+window.location.search+(window.location.search.length>1?"&":"?")+"isCrazyGames=1"+window.location.hash);var po=!1;function ho(){window.innerWidth>window.innerHeight?(document.body.classList.add("landscape"),document.body.classList.remove("portrait")):(document.body.classList.remove("landscape"),document.body.classList.add("portrait")),Za()}function fo(){document.getElementById("loading").style.display="none",yo(),document.getElementById("screens").classList.add("visible"),document.getElementById("home-screen").classList.add("visible"),$l?setTimeout(ml):ml(),Wa&&(Wa.pause(),Wa=null),Xa=0,Qa()}function mo(){document.getElementById("loading").style.display="none",document.getElementById("screens").classList.remove("visible"),document.getElementById("home-screen").classList.remove("visible"),document.getElementById("shop-screen").classList.remove("visible"),document.getElementById("profile-screen").classList.remove("visible"),document.getElementById("death-screen").classList.remove("visible"),document.getElementById("end-match-screen").classList.remove("visible"),document.getElementById("settings-screen").classList.remove("visible"),yc||(bl.domElement.focus(),It||1==Ul.killReason||ii()),_o()}function yo(){let t=document.querySelectorAll("#screens > .visible");for(let e=0;e<t.length;e++)t[e].classList.remove("visible")}function _o(){if(It&&document.body.requestFullscreen)try{document.body.requestFullscreen().catch(function(t){})}catch(t){}}function go(t,e,n){It||oi(!0),document.getElementById("end-match-screen").classList.contains("visible")||(document.getElementById("screens").classList.add("visible"),-1==t?document.getElementById("death-screen-title").innerHTML="":0==t?document.getElementById("death-screen-title").innerHTML="Killed by "+Ut(e):1==t?document.getElementById("death-screen-title").innerHTML="Eliminated":2==t&&(document.getElementById("death-screen-title").innerHTML="Telefragged by "+Ut(e)),document.getElementById("death-screen-table").innerHTML='<div style="width: 50vw"></div>',document.getElementById("death-screen").classList.add("visible"),t>=0?(document.getElementById("death-screen-ready-btn").style.display="block",document.getElementById("death-screen-resume-btn").style.display="none",document.getElementById("death-screen-ready-btn").innerHTML="SPECTATE"):(document.getElementById("death-screen-ready-btn").style.display="none",document.getElementById("death-screen-resume-btn").style.display="block",1==Ul.killReason?(document.getElementById("death-screen-new-game-btn").classList.add("visible"),document.getElementById("death-screen-resume-btn").innerHTML="Spectate"):document.getElementById("death-screen-new-game-btn").classList.remove("visible")))}function vo(){It||oi(!0),document.getElementById("screens").classList.add("visible"),document.getElementById("end-match-screen-table").innerHTML=function(){var t=oc.slice();t.sort(function(t,e){return 0==t.endRank&&0==e.endRank?t.distanceToFinish-e.distanceToFinish:0==t.endRank&&e.endRank>0?1:t.endRank>0&&0==e.endRank?-1:t.endRank<0?e.endRank<0?0:1:e.endRank<0?t.endRank<0?0:-1:t.endRank-e.endRank}),html='<div class="score-rows-wrapper">';for(var e=0;e<t.length;e++)t[e].endRank>=0&&(html+=bo(t[e]).outerHTML);return html+="</div>",html}(),document.getElementById("end-match-screen").classList.add("visible"),document.getElementById("death-screen").classList.remove("visible"),1==Ul.killReason&&-1==Ul.endRank?(document.getElementById("end-match-new-game-btn").classList.add("visible"),document.getElementById("end-match-spectate-btn").classList[lc==et?"remove":"add"]("visible"),document.getElementById("end-match-continue-btn").classList.remove("visible"),document.getElementById("match-results-section").getElementsByClassName("footer")[0].appendChild(document.getElementById("end-match-spectate-btn")),document.getElementById("match-results-section").getElementsByClassName("footer")[0].appendChild(document.getElementById("end-match-new-game-btn"))):lc==et?(document.getElementById("end-match-new-game-btn").classList.add("visible"),document.getElementById("end-match-spectate-btn").classList.remove("visible"),document.getElementById("end-match-continue-btn").classList.add("visible")):1!=Ul.killReason||Ec?(document.getElementById("end-match-new-game-btn").classList.remove("visible"),document.getElementById("end-match-spectate-btn").classList.remove("visible")):(document.getElementById("end-match-new-game-btn").classList.add("visible"),document.getElementById("end-match-spectate-btn").classList.add("visible"),document.getElementById("end-match-continue-btn").classList.add("visible")),document.getElementById("match-results-section").classList.add("visible"),document.getElementById("match-earnings-section")&&document.getElementById("match-earnings-section").classList.remove("visible"),setTimeout(function(){!function(t){var e=anime.timeline(),n=document.querySelectorAll(".qualified"),r=document.querySelectorAll(".eliminated"),i=[];for(let t=0;t<r.length;t++)i.push(t);var o=document.getElementById("end-match-screen-table").getElementsByClassName("score-rows-wrapper")[0];if("grid"==window.getComputedStyle(o).getPropertyValue("display"))var a=!0;if(a){!function(t){for(var e,n,r=t.length;0!==r;)n=Math.floor(Math.random()*r),e=t[r-=1],t[r]=t[n],t[n]=e}(i);for(let t=0;t<i.length;t++)Mo(r[i[t]],e,500,350);if(!Ec)for(let t=0;t<i.length;t++)jo(r[i[t]],e,900,720);for(let r=n.length-1;r>=0;r--)Co(n[r],e,150,0==r?t:null)}else{i.reverse();var s=0;xo=!1,o.scrollTop=o.scrollHeight;for(let t=0;t<i.length;t++)To(r[i[t]],s++,200);for(let t=n.length-1;t>=0;t--)So(n[t],s++,200)}}(function(){wc=!1,xc&&setTimeout(qc,1e3),setTimeout(function(){lc!=tt&&lc!=et||(Il=Ce(Ec?"ui_round_end":"ui_wait_next_round"))},1e3)})},1e3),Ce("ui_round_results")}function bo(t){1==t.killReason?qualificationStatusClass="eliminated":2==t.killReason?qualificationStatusClass="qualified":3==t.killReason?qualificationStatusClass="qualified winner":qualificationStatusClass="eliminated";var e=document.createElement("div");e.className="row"+(t===Ul?" local-player ":" ")+qualificationStatusClass;var n=document.createElement("div");n.className="icons-wrapper";var r=document.createElement("div");r.className="player-rank",r.innerText=Ec?t.globalEndRank:0==t.endRank?"✖":t.endRank;var i,o=document.createElement("div");t.skinPreviewThumbnail?(o.className="player-icon-real",o.style.backgroundImage="url("+t.skinPreviewThumbnail+")"):(o.className="player-icon",o.style.backgroundColor="#"+Ja[t.colorIndex].toString(16).padStart(6,"0")),t.raceTime?((i=document.createElement("div")).className="player-race-time",i.innerText=t.raceTime.toFixed(1)+"s"):((i=document.createElement("div")).className="player-race-distance",i.innerText=Math.round(t.distanceToFinish)+"m");var a=document.createElement("div");return a.className="player-name"+(t!=Ul&&t.isPartyMember?" party-member":""),a.innerText=Ut(t.name),n.appendChild(r),n.appendChild(o),n.appendChild(i),e.appendChild(n),e.appendChild(a),e}var xo=!1,wo=!1,Eo=!1;function To(t,e,n,r){let i=t.classList.contains("local-player");setTimeout(function(){i?t.classList.add("red-out"):t.classList.add("greyed-out"),t.getElementsByClassName("player-race-time").length>0&&(t.getElementsByClassName("player-race-time")[0].innerText="ELIMINATED"),t.getElementsByClassName("player-race-distance").length>0&&(t.getElementsByClassName("player-race-distance")[0].innerText="ELIMINATED"),i||xo?i&&(t.scrollIntoView({behavior:"smooth",block:"center"}),xo=!0):t.scrollIntoView({behavior:"smooth",block:"center"})},e*n)}function So(t,e,n,r,i){let o=t.classList.contains("local-player");setTimeout(function(){o?t.classList.add("local-player-qualified"):t.classList.add("player-qualified"),o||xo?o&&(t.scrollIntoView({behavior:"smooth",block:"center"}),xo=!0):t.scrollIntoView({behavior:"smooth",block:"center"}),"function"==typeof i&&i()},e*n)}function Mo(t,e,n,r){var i;t.classList.contains("local-player")&&(i=!0),e.add({targets:t,translateZ:{value:i?0:-10,duration:n},begin:function(){i?t.classList.add("red-out"):t.classList.add("desaturate"),Ec&&Ce("ui_card_grey")}},"-="+r)}function jo(t,e,n,r){t.classList.contains("local-player")||t.classList.contains("party-member")||e.add({targets:t,translateZ:{value:10+30*Math.random(),duration:n,easing:"easeOutCubic",delay:0},translateY:{value:700,easing:"easeInBack",duration:.8*n,delay:0},rotateZ:{value:60*Math.random()-30,easing:"easeInCubic",duration:n,delay:0},rotateX:{value:-180-360*Math.random(),easing:"easeOutCubic",duration:n,delay:0},opacity:{value:0,delay:r+0,duration:n/2},begin:function(){Ce(t.classList.contains("local-player")?"ui_local_lose_round":"ui_lose_round")}},"-="+(r+n/3))}function Co(t,e,n,r){let i=t.classList.contains("local-player");e.add({targets:t,autoplay:!1,translateZ:{value:10,duration:250},complete:function(){i?t.classList.add("local-player-qualified"):t.classList.add("player-qualified"),"function"==typeof r&&r(),Ce(i?"ui_local_win_round":"ui_win_round")}},"-="+n)}var zo=!1,Ro=!1;function Ao(){Ro||(Ro=!0,w?Ve||zo?xn(function(){Ro=!1,Po()}):bn(function(){zo=!0,xn(function(){Ro=!1,Po()})}):(Ro=!1,Po()),ro=!0,za(void 0!=Oc.playerTexture?Oc.playerTexture:0),ro=!1,Ce("ui_done"))}var Lo,Io=[];function Po(){yo(),document.getElementById("shop-player-name").innerText=document.getElementById("username").value?document.getElementById("username").value:document.getElementById("username").placeholder,document.getElementById("skin-items-list").innerHTML="";let t=[0,1,2,3,4,5,6,53,54,55,56,57,58,59,60,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,40,41,42,38,39,44,45,46,43,47,48,49,50,51,52];for(let e=0;e<t.length;e++){let n=t[e],r=document.createElement("div");r.className="accessory-thumbnail"+($e[n]?" unlocked":"")+(Oc.playerTexture==n?" selected":""),r.id="accessory-"+n,r.style.backgroundImage="url(ui/item-thumbnails/"+n+".png)";let i=qe?qe[n]:void 0;r.innerHTML='<img src="ui/owned-checkmark.svg" class="owned-checkmark"><div class="item-name">'+ts[n]+'</div><div class="price-tag'+(void 0!==i?"":" unavailable")+'"><div class="price">'+(void 0!==i?i:"N/A")+'</div><div class="coin-icon"></div></div>',document.getElementById("skin-items-list").appendChild(r),r.addEventListener("click",function(){ro=!0,Bo(n),$e[n]?Do(0):(Ho(n),Do(qe&&tn>=qe[n]?2:1),eo=n),Ca(),ro=!1,Ce("ui_change_skin")})}if(document.getElementById("hats-items-list")){document.getElementById("hats-items-list").innerHTML="";let t=document.createElement("div");t.innerHTML='<img src="ui/owned-checkmark.svg" class="owned-checkmark"><div class="item-name">None</div><div class="price-tag unavailable"><div class="price">N/A</div><div class="coin-icon"></div></div>',t.className="accessory-thumbnail unlocked"+(-1==Oc.playerHat||void 0==Oc.playerHat?" selected":""),t.id="no-hat-thumbnail",t.style.backgroundImage="url(ui/purchase-cancel.svg)",t.addEventListener("click",function(){ro=!0,Bo(-1),Do(0),Ca(),ro=!1,Ce("ui_change_skin")}),document.getElementById("hats-items-list").appendChild(t);let e=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47];for(let t=0;t<e.length;t++){let n=e[t],r=document.createElement("div");r.className="accessory-thumbnail"+($e[no+n]?" unlocked":"")+(Oc.playerHat==n?" selected":""),r.id="accessory-"+(no+n),r.style.backgroundImage="url(ui/item-thumbnails/"+(no+n)+".png)";let i=qe?qe[no+n]:void 0;r.innerHTML='<img src="ui/owned-checkmark.svg" class="owned-checkmark"><div class="item-name">'+es[n]+'</div><div class="price-tag'+(void 0!==i?"":" unavailable")+'"><div class="price">'+(void 0!==i?qe&&qe[no+n]:"N/A")+'</div><div class="coin-icon"></div></div>',document.getElementById("hats-items-list").appendChild(r),r.addEventListener("click",function(){ro=!0,Bo(no+n),$e[no+n]?Do(0):(Ho(no+n),Do(qe&&tn>=qe[no+n]?2:1),eo=no+n),Ca(),ro=!1,Ce("ui_change_skin")})}}if(document.getElementById("premium-items-list")){document.getElementById("premium-items-list").innerHTML="";let t=[1001,1002,1003,1004];for(let e=0;e<t.length;e++){let n=t[e],r=document.createElement("div");r.className="accessory-thumbnail"+($e[n]?" unlocked":"")+(Oc.playerTexture==n?" selected":""),r.id="accessory-"+n,r.style.backgroundImage="url(ui/item-thumbnails/"+n+".png)";let i=qe?qe[n]:void 0;r.innerHTML='<img src="ui/owned-checkmark.svg" class="owned-checkmark"><div class="item-name">'+ts[n]+'</div><div class="price-tag'+(void 0!==i?"":" unavailable")+'"><div class="price">'+(void 0!==i?i:"N/A")+"</div></div></div>",document.getElementById("premium-items-list").appendChild(r),r.addEventListener("click",function(){ro=!0,Bo(n),$e[n]?Do(0):(Ho(n),Do(i.startsWith("$")||qe&&tn>=qe[n]?2:1),eo=n),Ca(),ro=!1,Ce("ui_change_skin")})}}!function(){let t="?skin-tester"===window.location.search;for(let e=1;e<=3;e++){let n=document.getElementById("color-set-"+e);n.innerHTML="";let r=Oc["playerColor"+(1==e?"":e)];for(let i=0;i<Ja.length;i++){let o=document.createElement("div");if(o.classList.add("color-swatch"),o.style.backgroundColor=Nt(Ja[i]),o.title=Ka[i],n.appendChild(o),t||$e[300+i])o.classList.add("unlocked"),o.addEventListener("click",function(){Wo(e,i),Ce("ui_custom_select")}),r==i&&o.classList.add("selected");else{let t=document.createElement("div");t.classList.add("lock"),o.addEventListener("click",function(){Ra(!0)}),o.appendChild(t)}}}}();for(let t=1;t<=3;t++)Go(t);Lo.classList.add("visible"),Lo.classList.add("preview-unlocked-item"),Fo("shop"),Za(),setTimeout(ko,0),Ve||setTimeout(Oo,3e3),"?skin-tester"===window.location.search&&function(){mc["chara-tex-0-decal-backup"]=mc["chara-tex-0-decal"];var t=document.getElementById("skin-items-list");t.innerHTML="";var e=document.createElement("div");e.className="skin-tester",t.appendChild(e);var n=document.createElement("select");n.innerHTML='<option value="1">1 colors</option><option value="2">2 colors</option><option value="3">3 colors</option>',e.appendChild(n),n.value=parseInt($a[Oc.playerTexture]);var r=document.createElement("div");e.appendChild(r);var i=document.createElement("label");i.setAttribute("for","skin-tester-input-1"),i.innerHTML="Upload Base Color Layer";var o=document.createElement("input");o.setAttribute("id","skin-tester-input-1"),o.setAttribute("type","file"),o.setAttribute("accept","image/*"),r.appendChild(i),r.appendChild(o);var a=document.createElement("div");e.appendChild(a);var s=document.createElement("label");s.setAttribute("for","skin-tester-input-2"),s.innerHTML="Upload Decal Layer";var l=document.createElement("input");l.setAttribute("id","skin-tester-input-2"),l.setAttribute("type","file"),l.setAttribute("accept","image/*");var c=document.createElement("button");c.className="button",c.innerHTML="Clear Layer",a.appendChild(s),a.appendChild(l),a.appendChild(c);var u=document.createElement("div");e.appendChild(u);var p=document.createElement("label");p.setAttribute("for","skin-tester-input-3"),p.innerHTML="Upload Normal Layer";var d=document.createElement("input");d.setAttribute("id","skin-tester-input-3"),d.setAttribute("type","file"),d.setAttribute("accept","image/*");var h=document.createElement("button");h.className="button",h.innerHTML="Clear Layer",u.appendChild(p),u.appendChild(d),u.appendChild(h);var f=document.createElement("div");e.appendChild(f);var m=document.createElement("label");m.setAttribute("for","skin-tester-input-4"),m.innerHTML="Upload 3D GLB Model";var y=document.createElement("input");y.setAttribute("id","skin-tester-input-4"),y.setAttribute("type","file"),y.setAttribute("accept",".glb"),f.appendChild(m),f.appendChild(y);var _=!1,g=!1,v=!1;function b(){$a[Oc.playerTexture]=n.value+(_?"D":"")+(v?"N":"")+(g?"E":"")}n.addEventListener("change",function(){b(),Bo(Oc.playerTexture),rs({skinnedMesh:Pa},Oc.playerTexture,Oc.playerColor,Oc.playerColor2,Oc.playerColor3)});var x,w,E=function(t,e){var n=t.files[0],r=new FileReader;r.onload=function(){for(var n="",i=new Uint8Array(r.result),o=i.byteLength,a=0;a<o;a++)n+=String.fromCharCode(i[a]);var s="data:image/png;base64,"+btoa(n);mc["chara-tex-"+Oc.playerTexture+"-"+e]=(new THREE.TextureLoader).load(s,function(){mc["chara-tex-"+Oc.playerTexture+"-"+e].flipY=!1,rs({skinnedMesh:Pa},Oc.playerTexture,Oc.playerColor,Oc.playerColor2,Oc.playerColor3)}),t.value=""},r.readAsArrayBuffer(n)};o.addEventListener("change",function(){E(o,"bc")}),l.addEventListener("change",function(){_=!0,g=!1,b(),E(l,"decal")}),c.addEventListener("click",function(){_=!1,g=!1,b(),0==Oc.playerTexture?mc["chara-tex-0-decal"]=mc["chara-tex-0-decal-backup"]:delete mc["chara-tex-"+Oc.playerTexture+"-decal"],rs({skinnedMesh:Pa},Oc.playerTexture,Oc.playerColor,Oc.playerColor2,Oc.playerColor3)}),d.addEventListener("change",function(){At=!0,v=!0,b(),E(d,"normal")}),h.addEventListener("click",function(){v=!1,b(),delete mc["chara-tex-"+Oc.playerTexture+"-normal"],rs({skinnedMesh:Pa},Oc.playerTexture,Oc.playerColor,Oc.playerColor2,Oc.playerColor3)}),y.addEventListener("change",function(){var t=y.files[0],e=new FileReader;e.onload=function(){Cc.parse(e.result,"",function(t){mc.character=t.scene;let e=Yt(mc.character);e.geometry.hasAttribute("uv2")&&e.geometry.deleteAttribute("uv2"),e.material.map&&(mc["chara-tex-"+Oc.playerTexture+"-bc"]=e.material.map),e.material.normalMap?(mc["chara-tex-"+Oc.playerTexture+"-normal"]=e.material.normalMap,v=!0):(v=!1,delete mc["chara-tex-"+Oc.playerTexture+"-normal"]),e.material.aoMap?(mc["chara-tex-"+Oc.playerTexture+"-decal"]=e.material.aoMap,e.material.aoMap=null,_=!0,g=!1):(_=!1,delete mc["chara-tex-"+Oc.playerTexture+"-decal"],g=!0),b(),rs({skinnedMesh:Pa},Oc.playerTexture,Oc.playerColor,Oc.playerColor2,Oc.playerColor3)},function(t){console.error(t)}),y.value=""},e.readAsArrayBuffer(t)});var T=!1;Aa.domElement.addEventListener("mousedown",function(t){x=t.clientX,w=t.clientY,T=!0}),Aa.domElement.addEventListener("mouseup",function(t){T=!1}),Aa.domElement.addEventListener("mousemove",function(t){if(T){var e=t.clientX-x,n=t.clientY-w;if(0!=e||0!=n){var r=new THREE.Vector3(0,1.02,0),i=La.position.clone().sub(r);i.applyEuler(new THREE.Euler(-n/180*Math.PI,-e/180*Math.PI,0)),La.position.copy(i.add(r)),La.lookAt(r)}x=t.clientX,w=t.clientY}})}(),ja(),$l&&(document.getElementById("bundles-tab").style.display="none",document.getElementById("coins-plus-button").style.display="none")}function Oo(){if(!Ve&&$e[2]){var t=document.getElementById("shop-account-warning");t.removeAttribute("style"),t.classList.add("visible"),anime({targets:t,marginTop:"1.2vh",duration:450,opacity:1})}}function ko(t){let e=document.getElementsByClassName("selected");for(var n=t?1:0;n<e.length;n++){const t=e[n];t.offsetWidth,t.scrollIntoView({behavior:"instant",block:"center"})}}function Bo(t){if(t>=0){var e=$e[t]?Oc:kc,n=ns(t);if("texture"==n){if(e.playerTexture=t,$e[t])try{localStorage.setItem("playerTexture",e.playerTexture)}catch(t){}za(t)}else if("hat"==n&&(e.playerHat=t-no,$e[t]))try{localStorage.setItem("playerHat",e.playerHat)}catch(t){}}else{Oc.playerHat=-1;try{localStorage.setItem("playerHat",-1)}catch(t){}}}function Do(t){let e=document.getElementById("shop-screen");switch(t){case 1:e.classList.remove("preview-unlocked-item"),e.classList.add("preview-unaffordable-item"),e.classList.remove("preview-affordable-item"),e.classList.remove("confirm-purchase");break;case 2:e.classList.remove("preview-unlocked-item"),e.classList.remove("preview-unaffordable-item"),e.classList.add("preview-affordable-item"),e.classList.remove("confirm-purchase");break;case 3:e.classList.remove("preview-unlocked-item"),e.classList.remove("preview-unaffordable-item"),e.classList.remove("preview-affordable-item"),e.classList.add("confirm-purchase");break;default:e.classList.add("preview-unlocked-item"),e.classList.remove("preview-unaffordable-item"),e.classList.remove("preview-affordable-item"),e.classList.remove("confirm-purchase"),kc={}}}function Ho(t){if(document.getElementById("shop-buy-btn")){var e=document.getElementById("shop-buy-btn"),n=document.getElementById("buy-cta-price"),r=document.getElementById("shop-unaffordable-tip");document.getElementById("shop-buy-btn").getElementsByTagName("img")[0].style.display="block",qe&&qe[t]?(e.classList.remove("unavailable"),qe[t].toString().startsWith("$")?n.innerHTML=qe[t]+'<span class="below-text">Includes skin + all colors</span>':n.innerHTML=qe[t],r.innerHTML="not enough coins",qe[t].toString().startsWith("$")&&(document.getElementById("shop-buy-btn").getElementsByTagName("img")[0].style.display="none")):(e.classList.add("unavailable"),n.innerHTML="N/A",r.innerHTML="not available"),document.getElementById("shop-purchase-tip-amount")&&(document.getElementById("shop-purchase-tip-amount").innerHTML=qe&&qe[t]?qe[t]:"N/A")}}function Fo(t){var e=document.getElementById(t+"-preview-container");document.getElementById("animated-skin-preview")?e.insertBefore(document.getElementById("animated-skin-preview"),e.firstChild):console.error("missing animated-skin-preview",typeof mc.character,typeof Gl,document.readyState)}function No(){var t=document.querySelectorAll("#screens > .visible");Io=[];for(var e=0;e<t.length;e++)Io.push(t[e]);for(e=0;e<Io.length;e++)Io[e].classList.remove("visible");document.getElementById("settings-screen").classList.add("visible"),Ce("ui_done")}function Uo(){document.getElementById("settings-screen").classList.remove("visible");for(var t=0;t<Io.length;t++)Io[t].classList.add("visible");Io=[],Yr=!1,Ce("ui_settings")}function Vo(){Oc.username=document.getElementById("username").value;try{localStorage.setItem("username",Oc.username)}catch(t){}Ce("ui_options")}function Go(t){if(1==t)var e="";else e=t;let n=Oc["playerColor"+e];document.getElementById("custom-color-"+t+"-tab").style.backgroundColor=Nt(Ja[n])}function Wo(t,e){var n=1==t?Oc.playerColor:2==t?Oc.playerColor2:Oc.playerColor3;document.getElementById("color-set-"+t).getElementsByClassName("color-swatch").length>0&&function(t,e,n){let r=document.getElementById("color-set-"+t);r.getElementsByClassName("color-swatch")[n].classList.remove("selected"),r.getElementsByClassName("color-swatch")[e].classList.add("selected")}(t,e,n),1==t?Oc.playerColor=e:2==t?Oc.playerColor2=e:Oc.playerColor3=e,Go(t);try{localStorage.setItem(1==t?"playerColor":"playerColor"+t,e)}catch(t){}}function qo(){Oc.mouseSensitivity=parseInt(document.getElementById("mouse-sens-slider").value),document.getElementById("mouse-sens-value").innerHTML=Oc.mouseSensitivity;try{localStorage.setItem("mouseSensitivity",Oc.mouseSensitivity)}catch(t){}}function Xo(){Oc.screenResolution=parseFloat(document.getElementById("screen-resolution-slider").value),document.getElementById("screen-resolution-value").innerHTML=Oc.screenResolution.toFixed(2);try{localStorage.setItem("screenResolution",Oc.screenResolution)}catch(t){}bl&&Hc(!!bl&&bl.shadowMap.enabled)}function Yo(){Oc.FOV=document.getElementById("fov-slider").value,Oc.FOV<G?Oc.FOV=G:Oc.FOV>V&&(Oc.FOV=V),document.getElementById("fov-value").innerHTML=Oc.FOV;try{localStorage.setItem("FOV",Oc.FOV)}catch(t){}_l&&(_l.fov=Oc.FOV,_l.updateProjectionMatrix())}function Qo(t){Oc.audioEnabled=t;try{localStorage.setItem("audioEnabled",Oc.audioEnabled)}catch(t){}var e;_l&&!Ll&&t?(Ee(),we()):_l&&Ll&&!t&&(Ll.parent.remove(Ll),Ll.context.close(),THREE.AudioContext.setContext(void 0),Ll=null,_e={}),Fn&&((e=new DataView(new ArrayBuffer(2))).writeUint8(8),e.writeUint8(Oc.audioEnabled),Fn.send(e.buffer)),document.querySelectorAll("#sound-settings .sound-option").forEach(function(t){t.checked=Oc.audioEnabled==("true"==t.value)}),document.getElementById("home-screen-mute-btn")&&(document.getElementById("home-screen-mute-btn").className=Oc.audioEnabled?"mute-btn":"unmute-btn"),document.getElementById("profile-screen-mute-btn")&&(document.getElementById("profile-screen-mute-btn").className=Oc.audioEnabled?"mute-btn":"unmute-btn")}function Zo(t){Oc.cspEnabled=t;try{localStorage.setItem("cspEnabled",Oc.cspEnabled)}catch(t){}1==t?br=!0:0==t&&(br=!1)}function Jo(t){Oc.cspAccuracy=t;try{localStorage.setItem("cspAccuracy",Oc.cspAccuracy)}catch(t){}xr=t<0?2:t}function Ko(t){Oc.chatEnabled=t;try{localStorage.setItem("chatEnabled",Oc.chatEnabled)}catch(t){}}var $o={3:"Break",8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"Caps Lock",21:"Hangul",22:"Hanja",27:"Escape",28:"Conversion",29:"Non-conversion",32:"Space",33:"PgUp",34:"PgDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",41:"Select",42:"Print",43:"Execute",44:"PrtnScreen",45:"Insert",46:"Delete",47:"Help",48:"Digit0",49:"Digit1",50:"Digit2",51:"Digit3",52:"Digit4",53:"Digit5",54:"Digit6",55:"Digit7",56:"Digit8",57:"Digit9",58:":",59:"=",60:"<",61:"=",63:"ß",64:"@",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"MetaLeft",92:"MetaRight",93:"ContextMenu",95:"Sleep",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9",106:"NumpadMultiply",107:"NumpadAdd",108:"Underscore",109:"NumpadSubtract",111:"NumpadDivide",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",160:"^",161:"!",162:"؛",163:"#",164:"$",165:"ù",166:"Page Backward",167:"Page Forward",168:"Refresh",173:"Mute",174:"Volume-",175:"Volume+",176:"Next",177:"Previous",178:"Stop",179:"Play/pause",180:"E-mail",181:"Mute",182:"Volume-",183:"Volume+",186:"BracketRight",187:"Equal",188:"Comma",189:"Minus",190:"Period",191:"Slash",192:"BackQuote",193:"?",194:"Numpad.",219:"BracketLeft",220:"Backslash",221:"BracketRight",222:"Quote",223:"`",224:"Cmd",225:"AltGr",226:"IntlBackslash"};function ta(t){return t?t.code?t.code:t.keyCode?$o[t.keyCode]?$o[t.keyCode]:"Key"+t.keyCode:void 0!==t.button?0==t.button?"Left Click":1==t.button?"Middle Click":2==t.button?"Right Click":"Mouse button "+t.button:void 0!==t.wheel?t.wheel<0?"Wheel Up":"Wheel Down":null:null}var ea,na,ra,ia=0;function oa(t,e,n){(new Date).getTime()-ia<500||(t.innerHTML="?",t.className="waiting",window.addEventListener("keydown",aa,{passive:!1,capture:!0}),window.addEventListener("mousedown",sa,{passive:!1,capture:!0}),window.addEventListener("wheel",la,{passive:!1,capture:!0}),ea=t,na=e,ra=n,Vr[e][n]={},Yr=!0)}function aa(t){ca({code:t.code,keyCode:t.keyCode}),t.preventDefault(),t.stopPropagation(),t.returnValue=!1}function sa(t){ca({button:t.button}),t.preventDefault(),t.stopPropagation(),t.returnValue=!1}function la(t){ca({wheel:Math.sign(t.deltaY)}),t.preventDefault(),t.stopPropagation(),t.returnValue=!1}function ca(t){Yr=!1,window.removeEventListener("keydown",aa,!0),window.removeEventListener("mousedown",sa,!0),window.removeEventListener("wheel",la,{passive:!1,capture:!0}),ea.className="",ia=(new Date).getTime(),void 0!==t.keyCode&&27==t.keyCode?ea.innerHTML="&nbsp;":(Vr[na][ra]=t,ea.innerHTML=ta(t)||"&nbsp;");try{localStorage.setItem("keyBindings",JSON.stringify(Vr))}catch(t){}"CHAT"==na&&ua(),"WEAPON"==na.slice(0,6)&&function(t){var e=Vr[t],n=weapons[t.substring(6,t.length)].name.toLowerCase(),r=ta(e[0])||ta(e[1]);if(r){var i=pa(r);document.getElementById("tooltip-"+n).innerHTML=i}}(na),Qr()}function ua(){var t=Vr.CHAT,e=ta(t[0])||ta(t[1]);e&&!It&&Oc.chatEnabled?(chatTipText=pa(e),document.getElementById("chat-tip").getElementsByTagName("KBD")[0].innerHTML=chatTipText,document.getElementById("chat-tip").style.display="block"):document.getElementById("chat-tip").style.display="none"}function pa(t){return t.startsWith("Key")?t.substring(3):t.startsWith("Digit")?t.substring(5):t}function da(t,e){var n,r=document.getElementById("end-of-round-overlay"),i=document.getElementById("end-of-round-result");r.classList.add("visible"),r.offsetHeight,1==t?Ec&&e?(2==e?(n='<span style="font-weight:400">🥈</span>',Ce("ui_second_place")):3==e?(n='<span style="font-weight:400">🥉</span>',Ce("ui_third_place")):(n='<span style="font-weight:400">😜</span>',Ce("ui_other_place")),i.innerHTML=(Bc?n+" ":"")+e+function(t){switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}()+" place!"):(i.innerHTML=(Bc?'<span style="font-weight:400">😭</span> ':"")+"Eliminated!",Ce("ui_eliminated")):t>1&&!Ec?(i.innerHTML=(Bc?'<span style="font-weight:400">😎</span> ':"")+"Qualified!",Ce("ui_qualified")):t>1&&Ec?(i.innerHTML=(Bc?'<span style="font-weight:400">🏆</span> ':"")+"Winner!!!",Ce("ui_first_place")):(i.innerHTML=(Bc?'<span style="font-weight:400">🏁</span> ':"")+"Finish!",Ce("ui_other_place")),setTimeout(function(){!function(t,e){if(!Ul.skinPreviewThumbnail&&!It){var n=Math.min(window.innerWidth,window.innerHeight),r=Math.round(3*n/100),i=Math.round(7*n/100);window.innerWidth/window.innerHeight<=.75&&(i=4*window.innerHeight/100);var o=.8*window.innerHeight/100;!function(t,e,n,r){var i=Aa.getSize(new THREE.Vector2);Aa.setSize(e,n);var o=new THREE.PerspectiveCamera(60,e/n,.1,10);o.rotation.order="YXZ";var a=document.createElement("canvas");a.width=e*window.devicePixelRatio,a.height=n*window.devicePixelRatio;var s=a.getContext("2d");bl.setClearColor(new THREE.Color(6018551));var l=t.slice(),c=function(){if(l.length>0){var t=l.shift();rs({skinnedMesh:Pa},t.playerTexture,t.colorIndex,t.colorIndex2,t.colorIndex3,t.playerHat,function(){var r=(new THREE.Box3).setFromObject(Pa),i=r.getCenter(new THREE.Vector3),l=r.getSize(new THREE.Vector3);i.y+=.45,l.y-=.9;var u=r.max.z+l.y/2/Math.tan(o.fov*Math.PI/360);o.position.set(0,i.y,u),o.lookAt(0,i.y,0);var p=bl.getViewport(new THREE.Vector4);bl.setViewport(0,window.innerHeight-n,e,n),bl.render(Ia,o),s.drawImage(bl.domElement,0,0),bl.setViewport(p),t.skinPreviewThumbnail=a.toDataURL(),setTimeout(c)})}else Aa.setSize(i.x,i.y),rs({skinnedMesh:Pa},Oc.playerTexture,Oc.playerColor,Oc.playerColor2,Oc.playerColor3,Oc.playerHat,r)};c()}(t,i+=2*o,r+=2*o,function(){})}}(oc)},500),r.classList.add("fade-in"),Eo=!0,setTimeout(function(){r.classList.remove("fade-in"),r.classList.add("fade-out")},4e3),setTimeout(function(){r.className="",wo=!0,Eo=!1},4500)}var ha,fa,ma,ya,_a,ga,va,ba,xa=[0,48,96,144,192,240,288,337,387,437,488,538,591,644,699,755,813,872,934,999,1068,1141];function wa(t){for(var e=0;e<xa.length;e++)if(t<xa[e])return e;return Math.ceil(.1242711253*(t-1200)/10+21.75868819)}function Ea(t){return t<xa.length?xa[t]:Math.ceil(10*(t-21.75868819)/.1242711253+1200)}function Ta(){if(Yl&&document.getElementById("match-earnings-account-incentive")){var t=document.getElementById("match-results-section"),e=document.getElementById("match-earnings-section"),n=t.getElementsByClassName("score-rows-wrapper")[0].offsetHeight;t.classList.remove("visible"),document.getElementById("progression").style.height=n+"px",e.classList.add("visible"),document.getElementById("match-earnings-account-incentive").style.display=Ve?"none":"block",anime({targets:["#previous-level","#next-level","#end-match-xp-progress","#end-match-unlocks"],opacity:[0,1],duration:500,easing:"linear"}),Yl.nextUnlockItemId>1e4?(document.getElementById("end-match-next-unlock-level").innerHTML=Yl.nextUnlockLevel,document.getElementById("end-match-next-unlock-card").innerHTML="<span>"+(Yl.nextUnlockItemId-1e4)+"</span>",document.getElementById("end-match-next-unlock-card").classList.add("coins")):-1==Yl.nextUnlockItemId?(document.getElementById("end-match-next-unlock-level").innerHTML=Yl.nextUnlockLevel,document.getElementById("end-match-next-unlock-card").innerHTML="Random color",document.getElementById("end-match-next-unlock-card").classList.add("random-color")):0==Yl.nextUnlockItemId?document.getElementById("end-match-unlocks").getElementsByClassName("unlock-text")[0].innerHTML="No unlock for your level":Yl.nextUnlockItemId>0&&(document.getElementById("end-match-next-unlock-level").innerHTML=Yl.nextUnlockLevel,document.getElementById("end-match-next-unlock-card").innerHTML='<img src="ui/item-thumbnails/'+Yl.nextUnlockItemId+'.png">');var r=function(t){(function(t,e,n,r){var i=wa(t),o=wa(e),a=(t-Ea(i-1))/(Ea(i)-Ea(i-1))*100;document.getElementById("level-bar-text").innerHTML="+"+(e-t)+" XP",anime({targets:"#level-bar-text",delay:500+n,duration:500,opacity:[0,1],easing:"linear"});var s=function(n){if(o>i)var l=100;else l=(e-Ea(i-1))/(Ea(i)-Ea(i-1))*100;let c;Math.max(t,Ea(i-1)),Math.min(e,Ea(i)),document.getElementById("previous-level").innerHTML=i,document.getElementById("next-level").innerHTML=i+1,document.getElementById("level-bar-value").style.width=a+"%",spec={targets:"#level-bar-value",width:[a+"%",l+"%"],duration:500,easing:"linear",begin:function(){c=Ce("ui_gain_xp_jauge")},complete:function(){var n,l;i<o?(i++,n=document.getElementById("previous-level"),l=i,n.textContent=l,anime({targets:n,duration:100,easing:"easeOutExpo",scaleX:[1,1.3],scaleY:[1,1.3],complete:function(){anime({targets:n,duration:400,easing:"linear",scaleX:1,scaleY:1})}}),Ce("ui_gain_xp_level_up"),document.getElementById("next-level").innerHTML=i+1,a=0,Math.max(t,Ea(i-1)),Math.min(e,Ea(i)),setTimeout(function(){s(0)},500)):r(),c&&c.stop()}},n?setTimeout(function(){anime(spec)},n):anime(spec)};s(1e3+n)})(Yl.previousXP,Yl.previousXP+Yl.XPGain,t,function(){if(Yl.earnedItemsIds&&Yl.earnedItemsIds.length>0){for(var t=[],e=Yl.earnedItemsIds.split("/"),n=0;n<e.length;n++)t.push({itemId:parseInt(e[n])});r=t,o=0,(a=function(){var t;i&&(t=i,anime({targets:t,duration:250,opacity:[1,0],top:[0,3*window.innerHeight/2+"px"],easing:"easeInQuad",complete:function(){t.parentNode===document.body&&document.body.removeChild(t)}}),i.removeEventListener("click",a)),o<r.length&&setTimeout(function(){i=function(t){var e=document.createElement("div");e.className="unlock-popup";var n=ns(t.itemId);if("coin"==n){var r=t.itemId-1e4;e.innerHTML='<div class="box"><div class="title">You received <span class="type">'+r+' coins</span>!</div><div class="coins"><img src="ui/coin.png"><span class="amount">'+r+'</div><div class="tap animated flash">'+(It?"Tap":"Click")+" to continue</div></div>"}else{var i="texture"==n?"skin":"color";e.innerHTML='<div class="box"><div class="title">You unlocked a new <span class="type">'+i+"</span>!</div>"+("texture"==n?'<div class="item"><img src="ui/item-thumbnails/'+t.itemId+'.png"></div>':'<div class="color" style="background-color:'+Nt(Ja[t.itemId-300])+'"></div><div class="color-name">'+Ka[t.itemId-300]+"</div>")+'<div class="tap animated flash">'+(It?"Tap":"Click")+" to continue</div></div>"}return document.body.appendChild(e),anime({targets:e,duration:250,opacity:[0,1],top:[-window.innerHeight/2+"px",0],easing:"easeOutQuad",complete:function(){Ce("ui_unlock_new")}}),e}(r[o]),o++,i.addEventListener("click",a)},0==o?0:250)})()}var r,i,o,a}),Il&&Il.isPlaying&&je(Il)},i=document.getElementById("player-progress-card");Fo("progression"),i.getElementsByClassName("player-name")[0].innerHTML=Ut(Ul.name),Za(),document.getElementById("progress-coins-earned")&&void 0!==Yl.coinsGain?(Mc&&(!jc||Date.now()/1e3>jc)?document.getElementById("progress-coins-earned").innerHTML='<span class="incentive">Disable adblock<br>to earn coins</span>':document.getElementById("progress-coins-earned").textContent="+"+Yl.coinsGain,document.getElementById("progress-coins-owned").textContent=Yl.previousCoins,document.getElementById("level-bar-text").innerHTML="&nbsp;",Yl.coinsGain>0?(function(t,e){var n={v:t};anime({targets:"#progress-coins-earned",delay:500,duration:500,opacity:[0,1],easing:"linear"});var r=document.getElementById("progress-coins-owned");let i,o=!1;function a(){Ce("ui_coins"),o||(i=setTimeout(a,50+Math.ceil(200*Math.random())))}setTimeout(function(){a()},1e3),anime({targets:n,v:[t,e],delay:1e3,duration:500,easing:"linear",update:function(t){for(var e=Math.round(n.v).toString(),i="",o=0;o<e.length;o++)i+="<span>"+e[o]+"</span>";r.innerHTML=i},complete:function(){for(var t=Math.round(e).toString(),n="",a=0;a<t.length;a++)n+="<span>"+t[a]+"</span>";r.innerHTML=n,clearTimeout(i),o=!0}})}(Yl.previousCoins,Yl.previousCoins+Yl.coinsGain),r(1500)):r(500)):r(0),Ce("ui_gain_xp")}else ao()}function Sa(t){return t.startsWith("DevilsTrick")?"Devil's Trick":t.startsWith("RedLightGreenLight")?"1-2-3 Red Light":t.startsWith("FloorIsLava")?"Lava Lake":t.startsWith("FastRace")?"Dash Cup":t.split("-")[0].replace(/([a-z])([A-Z])/,"$1 $2")}function Ma(){kc={}}function ja(){document.getElementById("coins-balance-button-amount")&&(document.getElementById("coins-balance-button-amount").innerHTML=tn)}function Ca(){var t={};t.playerTexture=kc.playerTexture>=0?kc.playerTexture:Oc.playerTexture,t.playerHat=kc.playerHat>=0?kc.playerHat:Oc.playerHat;let e=document.getElementById("skin-items-list").getElementsByClassName("selected");for(let t=0;t<e.length;t++)e[t].classList.remove("selected");let n=document.getElementById("hats-items-list").getElementsByClassName("selected");for(let t=0;t<n.length;t++)n[t].classList.remove("selected");let r=document.getElementById("premium-items-list").getElementsByClassName("selected");for(let t=0;t<r.length;t++)r[t].classList.remove("selected");let i="accessory-"+(void 0!=t.playerTexture?t.playerTexture:0),o=document.getElementById(i),a=void 0!=t.playerHat&&-1!=t.playerHat?"accessory-"+(t.playerHat+no):"no-hat-thumbnail",s=document.getElementById(a);o&&o.classList.add("selected"),s.classList.add("selected"),ro=!0,za(t.playerTexture),ro=!1,ko(!1)}function za(t){var e=parseInt($a[t]);document.getElementById("custom-color-2-tab").classList[e>=2?"remove":"add"]("hidden"),document.getElementById("custom-color-3-tab").classList[e>=3?"remove":"add"]("hidden"),document.getElementById("custom-color-1-tab").click()}function Ra(t){$l||(document.getElementById("bundles-pop-in")?t?document.getElementById("bundles-pop-in").classList.add("visible"):document.getElementById("bundles-pop-in").classList.remove("visible"):alert("Coming soon ;-)"),Ce(t?"ui_done":"ui_settings"))}var Aa,La,Ia,Pa,Oa=new THREE.Euler;function ka(t){let e=t.ammoBody.getWorldTransform();return{id:t.playerId,position:e.getOrigin().toThree(),velocity:t.ammoBody.getLinearVelocity().toThree(),left:t.input.left,right:t.input.right,up:t.input.up,down:t.input.down,fire:t.input.fire,jump:t.input.jump,flying:t.flying,shocked:t.shocked,requestJumpTick:t.input.requestJumpTick,lastJumpTick:t.input.lastJumpTick,lastJumpadTick:t.input.lastJumpadTick,jumpadMovementLockDelay:t.input.jumpadMovementLockDelay,directionX:t.input.direction.x,directionY:t.input.direction.y}}function Ba(t,e){return!(t.position.distanceToSquared(e.position)>Math.pow(bt,2)||t.velocity.distanceToSquared(e.velocity)>Math.pow(.3,2))}function Da(t,e,n,r){if(ha.setFromThree(n.position),e.ammoBody.getWorldTransform().setOrigin(ha),ma.setFromThree(n.velocity),e.ammoBody.setLinearVelocity(ma),!r){if(e.input.left=n.left,e.input.right=n.right,e.input.up=n.up,e.input.down=n.down,n.shocked||n.sliding){var i=e.ammoBody.getWorldTransform(),o=i.getRotation();o.setFromThree(n.quaternion),i.setRotation(o),e.ammoBody.setWorldTransform(i),ha.setFromThree(n.angularVelocity),e.ammoBody.setAngularVelocity(ha)}else{if(e.input.direction.x=n.directionX,e.input.direction.y=n.directionY,e.alteredGravity){Oa.set(0,n.directionY,0);var a=(new THREE.Quaternion).setFromEuler(Oa).premultiply(e.gravityQuaternion);fa.setFromThree(a)}else fa.setEulerZYX(0,n.directionY,0);e.ammoBody.getWorldTransform().setRotation(fa)}void 0!==n.flying&&(e.flying=n.flying),void 0!==n.shocked&&(e.shocked=n.shocked),void 0!==n.sliding&&(e.sliding=n.sliding),void 0!==n.requestJumpTick?(e.input.requestJumpTick=n.requestJumpTick,e.input.lastJumpTick=n.lastJumpTick):n.jump&&!e.input.jump&&(e.input.requestJumpTick=t),e.input.jump=n.jump,e.input.fire=n.fire,e.input.lastJumpadTick=n.lastJumpadTick,e.input.jumpadMovementLockDelay=n.jumpadMovementLockDelay}}function Ha(){for(var t=[],e=0;e<oc.length;e++)t.push(ka(oc[e]));_a.push({tick:pc,playerStates:t})}function Fa(t,e){for(var n=e||0;n<ya.length&&ya[n].tick<t;)n++;return localPlayerState=ya[n].state,Ul.input.left=localPlayerState.left,Ul.input.right=localPlayerState.right,Ul.input.up=localPlayerState.up,Ul.input.down=localPlayerState.down,Ul.input.fire=localPlayerState.fire,Ul.input.jump=localPlayerState.jump,Ul.input.requestFireTick=localPlayerState.requestFireTick,Ul.input.requestJumpTick=localPlayerState.requestJumpTick,Ul.input.lastJumpTick=localPlayerState.lastJumpTick,Ul.input.lastJumpadTick=localPlayerState.lastJumpadTick,Ul.input.jumpadMovementLockDelay=localPlayerState.jumpadMovementLockDelay,n}function Na(t){for(;ya.length>0&&ya[0].tick<t;)ya.splice(0,1)}function Ua(t){for(var e=0;e<t.length;e++){var n=ac[t[e].id];n&&n!=Ul&&(n.input.direction.x=t[e].directionX,n.input.direction.y=t[e].directionY,fa.setEulerZYX(0,t[e].directionY,0),n.ammoBody.getWorldTransform().setRotation(fa),n.input.fire=t[e].fire)}}function Va(t){for(var e=0;e<va.length&&va[e].tick<=t;)va[e].tick==t&&(ha.setFromThree(va[e].impulse),va[e].player.ammoBody.applyCentralImpulse(ha)),e++}function Ga(t){for(var e=0;e<ba.length&&ba[e].tick<=t;)ba[e].tick==t&&(ha.setFromThree(ba[e].impulse),ba[e].player.ammoBody.applyCentralImpulse(ha)),e++}var Wa,qa=0,Xa=0;function Ya(){Wa&&Wa.pause();var t={v:Xa};Wa=anime({targets:t,v:0==Xa?1:0,easing:"linear",duration:400,update:function(){Xa=t.v,Qa()},complete:function(){Xa=t.v,Qa(),Wa=null}}),Ce("ui_options")}function Qa(){if(Pa){var t=Pa.boundingBox;t||(t=Pa.boundingBox=(new THREE.Box3).setFromObject(Pa));var e=t.getCenter(new THREE.Vector3),n=t.getSize(new THREE.Vector3),r=t.max.z+n.y/2/Math.tan(La.fov*Math.PI/360),i=Math.sin(Xa*Math.PI),o=Math.cos(Xa*Math.PI);La.position.set(i*r,e.y+1*Xa,o*r),La.lookAt(0,e.y,0)}}function Za(){if(Aa&&Aa.domElement.parentNode){var t=Aa.domElement.parentNode;if(t.removeChild(Aa.domElement),"progression-preview-container"==t.getAttribute("id"))var e=t.offsetHeight,n=Math.round(200*e/300);else n=t.offsetWidth,e=Math.round(n/200*300);Aa.setSize(n,e),Aa.domElement.style.width=n+"px",Aa.domElement.style.height=e+"px",t.insertBefore(Aa.domElement,t.firstChild)}}var Ja=[682687,2280690,16775592,15882100,12124299,16730442,16747566,16768542,8191856,960318,13458524,15761536,16416882,15308410,16752762,14423100,16711680,11674146,9109504,16761035,16758465,16738740,16716947,13047173,14381203,16752762,16744272,16737095,16729344,16747520,16753920,16766720,16776960,16777184,16775885,16448210,16773077,16770229,16767673,15657130,15787660,12433259,15132410,14204888,14524637,15631086,14315734,16711935,16711935,12211667,9662683,6697881,9055202,9699539,10040012,9109643,8388736,4915330,6970061,4734347,8087790,11403055,8388352,8190976,65280,3329330,10025880,9498256,64154,65407,3978097,3050327,2263842,32768,25600,10145074,7048739,8421376,5597999,6737322,9419915,2142890,35723,32896,65535,65535,14745599,11529966,8388564,4251856,4772300,52945,6266528,4620980,11584734,11591910,11393254,8900331,8900346,49151,2003199,6591981,8087790,4286945,255,205,139,128,1644912,16775388,16772045,16770244,16768685,16113331,14596231,13808780,12357519,16032864,14329120,12092939,13468991,13789470,9127187,10506797,10824234,8388608,16777215,16775930,15794160,16121850,15794175,15792383,16316671,16119285,16774638,16119260,16643558,16775920,16777200,16444375,16445670,16773365,16770273,14474460,13882323,12632256,11119017,8421504,6908265,7833753,7372944,3100495,0],Ka=["Jelly Blue","Jelly Turquoise","Jelly Yellow","Jelly Pink","Jelly Purple","Jelly Red","Jelly Orange","Jelly Lemon","Jelly Acid","Jelly Green","Indian Red","Light Coral","Salmon","Dark Salmon","Light Salmon","Crimson","Red","Fire Brick","Dark Red","Pink","Light Pink","Hot Pink","Deep Pink","Medium Violet Red","Pale Violet Red","Light Salmon","Coral","Tomato","Orange Red","Dark Orange","Orange","Gold","Yellow","Light Yellow","Lemon Chiffon","Light Goldenrod Yellow","Papaya Whip","Moccasin","Peach Puff","Pale Goldenrod","Khaki","Dark Khaki","Lavender","Thistle","Plum","Violet","Orchid","Fuchsia","Magenta","Medium Orchid","Medium Purple","Rebecca Purple","Blue Violet","Dark Violet","Dark Orchid","Dark Magenta","Purple","Indigo","Slate Blue","Dark Slate Blue","Medium Slate Blue","Green Yellow","Chartreuse","Lawn Green","Lime","Lime Green","Pale Green","Light Green","Medium Spring Green","Spring Green","Medium Sea Green","Sea Green","Forest Green","Green","Dark Green","Yellow Green","Olive Drab","Olive","Dark Olive Green","Medium Aquamarine","Dark Sea Green","Light Sea Green","Dark Cyan","Teal","Aqua","Cyan","Light Cyan","Pale Turquoise","Aquamarine","Turquoise","Medium Turquoise","Dark Turquoise","Cadet Blue","Steel Blue","Light Steel Blue","Powder Blue","Light Blue","Sky Blue","Light Sky Blue","Deep Sky Blue","Dodger Blue","Cornflower Blue","Medium Slate Blue","Royal Blue","Blue","Medium Blue","Dark Blue","Navy","Midnight Blue","Cornsilk","Blanched Almond","Bisque","Navajo White","Wheat","Burly Wood","Tan","Rosy Brown","Sandy Brown","Goldenrod","Dark Goldenrod","Peru","Chocolate","Saddle Brown","Sienna","Brown","Maroon","White","Snow","Honey Dew","Mint Cream","Azure","Alice Blue","Ghost White","White Smoke","Sea Shell","Beige","Old Lace","Floral White","Ivory","Antique White","Linen","Lavender Blush","Misty Rose","Gainsboro","Light Gray","Silver","Dark Gray","Gray","Dim Gray","Light Slate Gray","Slate Gray","Dark Slate Gray","Black"],$a={0:"1",1:"3NR",2:"3DN",3:"3DN",4:"3",5:"3N",6:"3N",7:"3N",8:"3DN",9:"3DN",10:"3",11:"3NR",12:"3N",13:"3N",14:"3N",15:"2NR",16:"3NR",17:"3N",18:"3N",19:"2NR",20:"3D",21:"1D",22:"2D",23:"2",24:"2D",25:"2",26:"1D",27:"2",28:"3",29:"3DNR",30:"3DNR",31:"2DNR",32:"3DR",33:"3D",34:"3D",35:"2",36:"3D",37:"3D",38:"3D",39:"3D",40:"3D",41:"3D",42:"3D",43:"3DN",44:"1D",45:"3DN",46:"3DN",47:"2DN",48:"2D",49:"2D",50:"2DN",51:"3DN",52:"3DN",53:"2DN",54:"3D",55:"3D",56:"3DN",57:"3DN",58:"3DN",59:"3DN",60:"3DN",1001:"3P",1002:"3DP",1003:"3NVP",1004:"3P"},ts={0:"Basic",1:"Undies",2:"LOL",3:"LOL Beans",4:"Brindle",5:"Ice Cream",6:"Croc",7:"Gift",8:"LMAO",9:"Beanbusters",10:"Camo",11:"Fiery",12:"Hoodie",13:"Stripy",14:"Worker",15:"Floral",16:"Birdie",17:"Dragonscale",18:"Bikini",19:"Giraffe",20:"90s",21:"Bee",22:"Blob",23:"Aztec",24:"Rainbow",25:"Stripes",26:"Tiger",27:"Wiggles",28:"Zigzag",29:"Zombie",30:"Vampire",31:"Mummy",32:"Los Muertos",33:"Splat",34:"Hotdog",35:"Split",36:"Pirate",37:"Cards",38:"Gladiator",39:"Wizard",40:"Egg",41:"Bear",42:"Panda",43:"Ninja",44:"Sus",45:"Mafia",46:"Droid",47:"Astronaut",48:"Thunder",49:"Rabbit",50:"Triskelion",51:"18th Century",52:"Biker",53:"Crash Test",54:"Random Cubes",55:"Swirl",56:"Ghost",57:"Ladybug",58:"Hawaii",59:"Sheriff",60:"Football",1001:"Cosmic",1002:"Cyclops",1003:"Disco",1004:"Fire"},es={0:"Antler",1:"Bunny",2:"Flowers",3:"Antennas",4:"Toy Winder",5:"Bachelor",6:"Cowboy",7:"Executioner",8:"Fan",9:"Jester",10:"Miner",11:"Paper Bag",12:"Witch",13:"Astronaut",14:"Diving",15:"Feather",16:"Firefighter",17:"Leprechaun",18:"Traffic Cone",19:"Crown",20:"Spiky",21:"Uncle Sam",22:"Viking",23:"Melon",24:"Russian",25:"Santa",26:"Tinfoil",27:"Cactus",28:"Chef",29:"Christmas Elf",30:"Gladiator",31:"Hard",32:"Mafia",33:"Magic",34:"Pope",35:"Sailor",36:"Army",37:"Baseball",38:"Captain",39:"Football",40:"Knight",41:"Police",42:"Samurai",43:"FBI",44:"Mushroom",45:"Pirate",46:"Frankenstein",47:"Pumpkin"};function ns(t){return t<300?"texture":t<600?"color":t<900?"hat":t>=1e3&&t<2e3?"texture":t>1e4?"coin":"unknown"}function rs(t,e,n,r,i,o,a){var s=$a[e];if(s){o>=0&&void 0===es[o]&&(console.error("Invalid hat"),o=-1);var l=parseInt(s),c=-1!==s.indexOf("D"),u=-1!==s.indexOf("E"),p=1003==e||At&&-1!==s.indexOf("N"),d=(s.indexOf("R"),-1!==s.indexOf("V")),h=-1!==s.indexOf("P"),f={};if(e>0&&!mc["chara-tex-"+e+"-bc"]&&(f["chara-tex-"+e+"-bc"]="obj/Characters/Textures/"+e+"_BC.png"),c&&!mc["chara-tex-"+e+"-decal"]&&(f["chara-tex-"+e+"-decal"]="obj/Characters/Textures/"+e+"_Decal.png"),d&&!mc["chara-tex-"+e+"-envmap"]&&(f["chara-tex-"+e+"-envmap"]="obj/Characters/Textures/"+e+"_Envmap.png"),p&&!mc["chara-tex-"+e+"-normal"]&&(f["chara-tex-"+e+"-normal"]="obj/Characters/Textures/"+e+"_N.png"),o>=0&&!mc["hat-"+o]&&(f["hat-"+o]="obj/Characters/Hats/"+es[o].replace(/ /g,"")+".glb"),1004!=e||mc["character-fireuv"]||(f["character-fireuv"]="obj/Characters/SK_Character_FireUV_Mini.glb"),t.skinnedMesh.material.isTimeAnimated){let e=sl.indexOf(t.skinnedMesh.material);e>=0&&sl.splice(e,1)}var m=Object.keys(f).length;if(0==m)_();else{is(t.skinnedMesh,mc["chara-tex-0-bc"],mc["chara-tex-0-decal"],new THREE.Color(Ja[n]).convertSRGBToLinear().getHex());var y=0;for(let t in f)Uc(f[t].endsWith(".glb")?Cc:Ac,t,f[t],function(t,n){n instanceof THREE.Texture&&(n.flipY=!1,n.wrapS=n.wrapT=THREE.RepeatWrapping,h&&(0==e||e>28)&&(n.encoding=THREE.sRGBEncoding),Lt&&(n.minFilter=THREE.LinearFilter),-1!=f[t].indexOf("_Envmap")&&(n.mapping=THREE.EquirectangularReflectionMapping,n.flipY=!0)),++y>=m&&_()})}}else console.error("Invalid skin texture",e);function _(){var s=mc["chara-tex-"+e+"-bc"],f=c?mc["chara-tex-"+e+"-decal"]:u?null:mc["chara-tex-0-decal"],m=p?mc["chara-tex-"+e+"-normal"]:null,y=d?mc["chara-tex-"+e+"-envmap"]:null;let _=new THREE.Color(Ja[n]).convertSRGBToLinear().getHex(),g=l<2?void 0:new THREE.Color(Ja[r]).convertSRGBToLinear().getHex(),v=l<3?void 0:new THREE.Color(Ja[i]).convertSRGBToLinear().getHex(),b=o>=0?Yt(mc["hat-"+o]):null;is(t.skinnedMesh,s,f,_,g,v,b,h?e-1e3:0),t.skinnedMesh.material.normalMap=m,_c&&t.skinnedMesh.material.normalScale.set(1,-1),t.skinnedMesh.material.envMap=y,"function"==typeof a&&a()}}function is(t,e,n,r,i,o,a,s){1!==s&&3!=s&&4!=s||(n=null),3==s&&(e.encoding=THREE.LinearEncoding),t.geometry=4==s?Yt(mc["character-fireuv"]).geometry:Yt(mc.character).geometry;var l=void 0!==r?1:0;if(void 0!==i&&l++,void 0!==o&&l++,a){var c=t.skeleton.getBoneByName("QuickRigCharacter_Head"),u=t.skeleton.bones.indexOf(c);if(!a.prepared){a.geometry.computeTangents();for(var p=a.geometry.getAttribute("position").count,d=new THREE.BufferAttribute(new Uint16Array(4*p),4),h=0;h<p;h++)d.setXYZW(h,u,0,0,0);var f=new THREE.BufferAttribute(new Float32Array(4*p),4);for(h=0;h<p;h++)f.setXYZW(h,1,0,0,0);var m=new THREE.BufferAttribute(new Float32Array(p),1);for(h=0;h<p;h++)m.setX(h,1);a.geometry.setAttribute("skinIndex",d),a.geometry.setAttribute("skinWeight",f),a.geometry.setAttribute("textureIndex",m);var y=(new THREE.Matrix4).compose(a.position,new THREE.Quaternion(.7071067811865475,0,0,.7071067811865476),a.scale);a.geometry.applyMatrix4(y),a.prepared=!0}if(!t.geometry.getAttribute("textureIndex")){var _=t.geometry.getAttribute("position").count,g=new THREE.BufferAttribute(new Float32Array(_),1);for(h=0;h<_;h++)g.setX(h,0);t.geometry.setAttribute("textureIndex",g)}!t.geometry.hasAttribute("tangent")&&a.geometry.hasAttribute("tangent")&&a.geometry.deleteAttribute("tangent"),t.geometry.getAttribute("skinIndex").array instanceof Uint8Array&&a.geometry.getAttribute("skinIndex").array instanceof Uint16Array&&(t.geometry.getAttribute("skinIndex").array=Uint16Array.from(t.geometry.getAttribute("skinIndex").array));var v=THREE.BufferGeometryUtils.mergeBufferGeometries([t.geometry,a.geometry]);t.hasMergedGeo=!0,t.geometry=v}if(l>=1){var b=1==s||2==s||3==s||4==s,x=Al.material.clone();switch(x.premiumType=s,x.isTimeAnimated=b,b&&sl.push(x),x.map=e,e.flipY=!1,n&&(x.alphaMap=n,n.flipY=!1),x.color.setRGB(1,1,1),t.material=x,l){case 1:case 2:case 3:x.customProgramCacheKey=function(){return(n?"S ":"")+l+(a?"A":"")+(s?"P"+s:"")}}x.onBeforeCompile=function(t,e){a&&(t.uniforms.map2={value:a.material.map},t.vertexShader=t.vertexShader.replace("#include <common>","#include <common>\nattribute float textureIndex;\nvarying float vTextureIndex;").replace("#include <uv_vertex>","#include <uv_vertex>\nvTextureIndex = textureIndex;"),t.fragmentShader=t.fragmentShader.replace("uniform vec3 diffuse;","uniform vec3 diffuse;\nvarying float vTextureIndex;\nuniform sampler2D map2;"),t.fragmentShader=t.fragmentShader.replace("#include <normal_fragment_maps>","\nif (vTextureIndex < 0.5) {\n#include <normal_fragment_maps>\n}")),b&&(t.fragmentShader=t.fragmentShader.replace("uniform vec3 diffuse;","uniform vec3 diffuse;\nuniform float time;"),t.uniforms.time={value:kr?kr.elapsedTime:0},x.uniforms=t.uniforms);var c="";n&&(t.fragmentShader=t.fragmentShader.replace("#include <alphamap_fragment>",""),c="\nvec4 decalColor = sRGBToLinear(texture2D( alphaMap, vUv ) );\ntexelColor = vec4(decalColor.rgb * decalColor.a + texelColor.rgb * (1.0 - decalColor.a), max(texelColor.a, decalColor.a));\n");var u="\nuniform vec3 color1;";t.uniforms.color1={value:new THREE.Color(r)},l>=2&&(u+="\nuniform vec3 color2;",t.uniforms.color2={value:new THREE.Color(i)}),l>=3&&(u+="\nuniform vec3 color3;",t.uniforms.color3={value:new THREE.Color(o)}),t.fragmentShader=t.fragmentShader.replace("uniform vec3 diffuse;","uniform vec3 diffuse;"+u);var p="",d="",h="";1==s?(t.fragmentShader=t.fragmentShader.replace("varying vec3 vViewPosition;","varying vec3 vViewPosition;\nvarying vec3 vWorldPosition;\nvarying vec3 vWorldNormal;"),t.vertexShader=t.vertexShader.replace("varying vec3 vViewPosition;","varying vec3 vViewPosition;\nvarying vec3 vWorldPosition;\nvarying vec3 vWorldNormal;").replace("vViewPosition = - mvPosition.xyz;","vViewPosition = - mvPosition.xyz;\nvWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\nvWorldNormal = normalize(( modelMatrix * vec4(normal, 0.0)).xyz);"),p="\nvec4 eyesFresnelColor = vec4(color2/*0.0,0.772,1.0*/,1.0) * 2.0; //2.0 = fresnelEmissiveIntensity;\nvec3 viewDirection = normalize(cameraPosition - vWorldPosition);\nfloat fresnelOutput = pow(saturate(1.0 - dot(viewDirection, vWorldNormal)), 2.0);\n",d="\nvec4 backgroundColor = vec4(color1/*0.0,0.0171,0.104*/,0.0);\nvec4 starsColor = vec4(color3/*1.0,1.0,1.0*/,1.0) * 1.0; //1.0 = stars EmissiveIntensity\nvec4 cosmicTexelColor = mapTexelToLinear( texture2D( map, vUv ) );\n\nvec4 cosmicColor1 = mix(\nmix(backgroundColor, eyesFresnelColor * cosmicTexelColor.g, cosmicTexelColor.r),\neyesFresnelColor,\nfresnelOutput);\n\nvec2 tilingOffset = (vViewPosition.xy*0.5+0.5) /** vUv.xy*/;\nfloat starsIntensity = \nsaturate(\nmapTexelToLinear( texture2D( map, tilingOffset * 1.66 + time * 3.0 * vec2(-0.03, 0.02) ) ).b //tiling, translation speed\n+\nmapTexelToLinear( texture2D( map, tilingOffset * 1.0 + time * 3.0 * vec2(0.04, -0.02) ) ).b //tiling, translation speed\n-\ncosmicTexelColor.r\n);\ntexelColor = saturate(mix(cosmicColor1, starsColor, starsIntensity));\n//texelColor = cosmicColor1, starsColor;\n//totalEmissiveRadiance = starsColor.rgb * starsIntensity;\ntexelColor.a = 1.0;",h="diffuseColor = mix(diffuseColor, eyesFresnelColor, fresnelOutput);",t.fragmentShader=t.fragmentShader.replace("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;",a?"vec3 outgoingLight = vTextureIndex > 0.5 ? reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance : diffuseColor.rgb;":"vec3 outgoingLight = diffuseColor.rgb;")):2==s?(t.fragmentShader=t.fragmentShader.replace("varying vec3 vViewPosition;","varying vec3 vViewPosition;\nvarying vec3 vWorldPosition;\nvarying vec3 vWorldNormal;"),t.vertexShader=t.vertexShader.replace("varying vec3 vViewPosition;","varying vec3 vViewPosition;\nvarying vec3 vWorldPosition;\nvarying vec3 vWorldNormal;").replace("vViewPosition = - mvPosition.xyz;","vViewPosition = - mvPosition.xyz;\nvWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\nvWorldNormal = normalize(( modelMatrix * vec4(normal, 0.0)).xyz);"),p="\nvec4 fresnelColor = vec4(color2/*0.0,0.772,1.0*/,1.0) * 2.0; //2.0 = fresnelEmissiveIntensity;\nvec3 viewDirection = normalize(cameraPosition - vWorldPosition);\nfloat fresnelOutput = pow(saturate(1.0 - dot(viewDirection, vWorldNormal)), 3.0);\n",d="\nvec4 backgroundColor = vec4(color1/*0.0,0.205,0.411*/,1.0);\nvec4 wavesColor = saturate(backgroundColor * 2.0);\nvec4 bubblesColor = vec4(color3/*0.911,0.529,0.0*/,1.0);\nvec4 eyeOutsideColor = vec4(1.0,0.0,0.0,1.0) * 2.0;\nvec4 eyeInsideColor = vec4(0.324,1.0,0.0,1.0) * 2.0;\n\nfloat bubblesIntensity = \nmapTexelToLinear( texture2D( map, vUv * 3.0 + time * vec2(0.0, 0.2) ) ).r //tiling, translation speed\n+\nmapTexelToLinear( texture2D( map, vUv * 3.0 + time * vec2(0.0, 0.3) ) ).g //tiling, translation speed\n;\n\nfloat wavesIntensity = \nmapTexelToLinear( texture2D( map, vUv * 2.0 + time * vec2(0.03, 0.05) ) ).b //tiling, translation speed\n+\nmapTexelToLinear( texture2D( map, vUv * 1.5 + time * vec2(0.02, -0.01) ) ).b //tiling, translation speed\n;\nwavesIntensity = wavesIntensity > 0.15 /*thickness*/ ? 0.5 /*waves intensity*/ : 0.0;\ntexelColor = mix( \n    mix(backgroundColor, bubblesColor, bubblesIntensity),\n    wavesColor, wavesIntensity\n);\nvec4 decalTexelColor = mapTexelToLinear( texture2D( alphaMap, vUv ) );\ntexelColor = mix(\n    texelColor,\n    mix(\n        backgroundColor * 0.5,\n        mix(\n            eyeOutsideColor * decalTexelColor.r,\n            eyeInsideColor,\n            decalTexelColor.g\n        ),\n        decalTexelColor.b\n    ),\n    decalTexelColor.a\n);\ntexelColor = mix(\n    texelColor,\n    fresnelColor, saturate(fresnelOutput * 2.5)\n);\ntexelColor.a = 1.0;",h="diffuseColor = mix(diffuseColor, fresnelColor, fresnelOutput);",c=""):3==s?(x.metalness=.8,x.roughness=0,x.envMapIntensity=2,t.fragmentShader=t.fragmentShader.replace("varying vec3 vViewPosition;","varying vec3 vViewPosition;\nvarying vec3 vWorldPosition;\nvarying vec3 vWorldNormal;"),t.vertexShader=t.vertexShader.replace("varying vec3 vViewPosition;","varying vec3 vViewPosition;\nvarying vec3 vWorldPosition;\nvarying vec3 vWorldNormal;").replace("vViewPosition = - mvPosition.xyz;","vViewPosition = - mvPosition.xyz;\nvWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\nvWorldNormal = normalize(( modelMatrix * vec4(normal, 0.0)).xyz);"),p="\nvec2 tilevUv = vUv * 4.0 + ceil(time * 5.0) * vec2(0.25, 0.5);\nfloat discoIntensity = \nsaturate(\nmapTexelToLinear( texture2D( map, vUv * 4.0 * 2.0 ) ).g //tiling, translation speed\n*\nmapTexelToLinear( texture2D( map, tilevUv ) ).r //tiling, translation speed\n);\n",d="\nvec4 tileColor1 = vec4(color1/*0.804,0.0,1.1*/,1.0);\nvec4 tileColor2 = vec4(color2/*0.0,0.803,1.1*/,1.0);\nvec4 eyeColor = vec4(0.0,0.0,0.0,1.0);\nvec4 fresnelColor = vec4(color3/*1.0,0.568,0.0*/,1.0);\n\nvec3 viewDirection = normalize(cameraPosition - vWorldPosition);\nfloat fresnelOutput = pow(saturate(1.0 - dot(viewDirection, vWorldNormal)), 0.75);\nfresnelOutput = fresnelOutput < 1.0 - 0.5 /*thickness*/ / 2.0 ? 0.0 : 1.0;\n\n\nfloat eyeIntensity = mapTexelToLinear( texture2D( map, vUv ) ).b;\ntexelColor = mix(\n    saturate(mix(tileColor1, tileColor2, discoIntensity)),\n    eyeColor,\n    eyeIntensity\n);\ntexelColor = mix(\n    texelColor,\n    fresnelColor,\n    fresnelOutput\n);\ntexelColor.a = 1.0;\ntotalEmissiveRadiance = fresnelColor.rgb * fresnelOutput;\n",t.fragmentShader=t.fragmentShader.replace("#include <common>","\n#include <common>\nvec3 blendAngleCorrectedNormals(vec3 a, vec3 b) {\n    vec3 c = vec3(a.xy, a.z + 1.0);\n    vec3 d = vec3(-b.xy, b.z);\n    return c * dot(c, d) - (a.z + 1.0) * d;\n}\nuniform mat4 modelMatrix;\n"),t.fragmentShader=t.fragmentShader.replace("#include <normal_fragment_maps>",(a?"if (vTextureIndex <= 0.5) {\n":"")+"\n#ifdef OBJECTSPACE_NORMALMAP\n    //normal = texture2D( normalMap, tilevUv ).xyz * 2.0 - 1.0; // overrides both flatShading and attribute normals\n    //normal randomization\n    normal = blendAngleCorrectedNormals(texture2D( normalMap, tilevUv ).xyz, vec3(discoIntensity, discoIntensity, 1.0)) * 2.0 - 1.0; // overrides both flatShading and attribute normals \n    #ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, tilevUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n    //normal randomization\n    mapN = blendAngleCorrectedNormals(mapN, vec3(-discoIntensity * 0.0, -discoIntensity * 2.0, 1.0));\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif"+(a?"\n}":""))):4==s?(t.fragmentShader=t.fragmentShader.replace("varying vec3 vViewPosition;","varying vec3 vViewPosition;\nvarying vec3 vWorldPosition;\nvarying vec3 vWorldNormal;"),t.vertexShader=t.vertexShader.replace("varying vec3 vViewPosition;","varying vec3 vViewPosition;\nvarying vec3 vWorldPosition;\nvarying vec3 vWorldNormal;").replace("vViewPosition = - mvPosition.xyz;","vViewPosition = - mvPosition.xyz;\nvWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\nvWorldNormal = normalize(( modelMatrix * vec4(normal, 0.0)).xyz);"),t.fragmentShader=t.fragmentShader.replace("#include <common>","#include <common>                \n                        vec3 rgb2hsv(vec3 c)\n                        {\n                            vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n                            vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n                            vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n                            float d = q.x - min(q.w, q.y);\n                            float e = 1.0e-10;\n                            return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n                        }\n\n                        vec3 hsv2rgb(vec3 c)\n                        {\n                            vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n                            vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n                            return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n                        }\n\n                        vec3 lerphsv(vec3 a, vec3 b, float t)\n                        {\n                            float d = b.x - a.x;\n                            if (a.x > b.x) {\n                                //swap a.hue and b.hue\n                                float h3 = b.x;\n                                b.x = a.x;\n                                a.x = h3;\n                                d = -d;\n                                t = 1.0 - t;\n                            }\n                            float h;\n                            if (d > 0.5) { // > 180deg\n                                a.x = a.x + 1.0;\n                                h = fract(a.x + t * (b.x - a.x) ); // 360deg\n                            } else { // <= 180deg\n                                h = a.x + t * d;\n                            }\n                            return vec3(h, mix(a.y, b.y, 1.0 - t), mix(a.z, b.z, 1.0 - t));\n                        }\n\nfloat blendOverlay(float base, float blend) {\n\treturn base<0.5?(2.0*base*blend):(1.0-2.0*(1.0-base)*(1.0-blend));\n}\nfloat easeOutQuad(float t) {\n    return t * (2.0 - t);\n}"),p="\nvec4 fireColor1 = vec4(color1/*0.45,0.0,0.0*/,1.0);\nvec4 fireColor2 = vec4(color2/*1.0,0.77,0.0*/,1.0);\nvec4 fireColor3 = vec4(color3/*1.0,1.0,1.0*/,1.0);\nvec3 viewDirection = normalize(cameraPosition - vWorldPosition);\nfloat fresnelOutput = pow(saturate(1.0 - dot(viewDirection, vWorldNormal) - 0.075), 3.0); //this is probably not the same formula as in unreal engine\n",d="\nvec4 texelForFace = mapTexelToLinear( texture2D( map, vUv) );\n\nfloat fireGrey1 = mapTexelToLinear( texture2D( map, vUv + 1.0 * time * vec2(0.1, -0.2) ) ).b; //translation speed\nfloat fireGrey2 = mapTexelToLinear( texture2D( map, vUv + 1.0 * time * vec2(-0.15, -0.15) ) ).b; //translation speed\n//float fireGreyscale = mix(\n//    fireGrey1 * fireGrey2,\n//    0.0,\n//    saturate(fireGrey2 / fireGrey1 - 5.0)\n//);\nfloat fireGreyscale = easeOutQuad(blendOverlay(fireGrey1, fireGrey2));\n\n//apply color gradient - https://www.shadertoy.com/view/ttB3Rh\n//hsv interpolation\n//texelColor.rgb = fireGreyscale < 0.5 ?\n//    hsv2rgb(lerphsv(rgb2hsv(fireColor1.rgb), rgb2hsv(fireColor2.rgb), fireGreyscale / 0.5)) :\n//    hsv2rgb(lerphsv(rgb2hsv(fireColor2.rgb), rgb2hsv(fireColor3.rgb), (fireGreyscale - 0.5)/(1.0 - 0.5)));\n//rgb interpolation\ntexelColor.rgb = fireGreyscale < 0.5 ?\n    mix(fireColor1.rgb, fireColor2.rgb, fireGreyscale / 0.5) :\n    mix(fireColor2.rgb, fireColor3.rgb, (fireGreyscale - 0.5)/(1.0 - 0.5));\n\n//apply fresnel\ntexelColor = mix(\n    texelColor,\n    texelColor * 10.0, //fresnel intensity\n    fresnelOutput\n);\n\n//eyes/face\ntexelColor = mix(\n    mix(\n        texelColor,\n        fireColor1, //texelColor * 0.1, //head fire intensity\n        texelForFace.g\n    ),\n    fireColor2,\n    texelForFace.r\n);\ntexelColor.a = 1.0;\ntotalEmissiveRadiance = texelColor.rgb;\ntexelColor.rgb = vec3(0.0); //fireColor1.rgb;\n",h="diffuseColor = mix(diffuseColor, fireColor2, fresnelOutput);",t.fragmentShader=t.fragmentShader.replace("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;",a?"vec3 outgoingLight = vTextureIndex > 0.5 ? reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance : totalEmissiveRadiance;":"vec3 outgoingLight = totalEmissiveRadiance;")):d=3==l?"\n//    vec3 color1hsv = rgb2hsv(color1 /** mapColor.r*/);\n//    vec3 color2hsv = rgb2hsv(color2 /** mapColor.g*/);\n//    vec3 color3hsv = rgb2hsv(color3 /** mapColor.b*/);\n//    if (mapColor.g > 0.0 && mapColor.b > 0.0)\n//        texelColor = vec4(hsv2rgb(lerphsv(color2hsv, color3hsv, mapColor.b / (mapColor.g + mapColor.b))), mapColor.a);\n//    else if (mapColor.r > 0.0 && mapColor.g > 0.0)\n//        texelColor = vec4(hsv2rgb(lerphsv(color1hsv, color2hsv, mapColor.g / (mapColor.r + mapColor.g))), mapColor.a);\n//    else if (mapColor.r > 0.0 && mapColor.b > 0.0)\n//        texelColor = vec4(hsv2rgb(lerphsv(color1hsv, color3hsv, mapColor.b / (mapColor.r + mapColor.b))), mapColor.a);\n//    else\n        texelColor = vec4(color1 * mapColor.r  + color2 * mapColor.g  + color3 * mapColor.b, mapColor.a);\n":2==l?"\n//    vec3 color1hsv = rgb2hsv(color1 * mapColor.r);\n//    vec3 color2hsv = rgb2hsv(color2 * mapColor.g);\n//    if (mapColor.r > 0.0 && mapColor.g > 0.0)\n//        texelColor = vec4(hsv2rgb(lerphsv(color1hsv, color2hsv, 0.5)), mapColor.a);\n//    else\n        texelColor = vec4(color1 * mapColor.r + color2 * mapColor.g, mapColor.a);\n":"texelColor = vec4(color1 * mapColor.r, mapColor.a);",t.fragmentShader=t.fragmentShader.replace("#include <map_fragment>","#ifdef USE_MAP\n    vec4 mapColor = mapTexelToLinear( texture2D( map, vUv ) );\n\tvec4 texelColor;\n"+p+(a?"\nif (vTextureIndex > 0.5) {\n"+(a.material.map.encoding==THREE.sRGBEncoding?"diffuseColor = sRGBToLinear( texture2D( map2, vUv ) );":"diffuseColor = texture2D( map2, vUv );")+h+"\n} else {":"")+d+c+"\n                diffuseColor *= texelColor;\n                #endif\n                "+(a?"}":""))}}}var os,as,ss,ls=[],cs={},us={},ps=new THREE.Matrix4,ds=new THREE.Vector3,hs=new THREE.Quaternion,fs=new THREE.Quaternion;const ms=1,ys=128,_s={0:Ft.linear,1:Ft.easeInQuad,2:Ft.easeOutQuad,3:Ft.easeInOutQuad,4:Ft.easeInCubic,5:Ft.easeOutCubic,6:Ft.easeInOutCubic,7:Ft.easeInQuart,8:Ft.easeOutQuart,9:Ft.easeInOutQuart,10:Ft.easeInQuint,11:Ft.easeOutQuint,12:Ft.easeInOutQuint,13:Ft.linear,14:Ft.easeInBack};function gs(t,e,n,r,i,o,a){var s=t.ammoBody;if(!s)return void console.error("Can't make mesh rotating, has no body",t.name,t);s.setCollisionFlags(8&s.getCollisionFlags()|2),s.setActivationState(4),s.setFriction(i),o&&(t.addVelocityToPlayer=!0,t.addAngularVelocityToPlayer=!0);let l=t.ammoBody.getWorldTransform().getOrigin().toThree();ls.push({object:t,type:"rotation",startTick:e,startQuaternion:t.ammoBody.getWorldTransform().getRotation().toThree(),axis:n,basePosition:l,pivot:!a||0==a.x&&0==a.y&&0==a.z?null:a,anglePerTick:r,addVelocityToPlayer:t.addVelocityToPlayer}),t instanceof Gs?(t.mesh.instanceMatrix.setUsage(THREE.DynamicDrawUsage),t.mesh.getMatrixAt(t.index,ps),t.scale=(new THREE.Vector3).setFromMatrixScale(ps)):(t.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.path=qs(t),t.parent.remove(t),Tl.add(t),t.updateMatrixWorld(!0))}function vs(t,e,n,r,i,o,a,s,l,c,u){var p=t.ammoBody;if(p){if(p.setCollisionFlags(8&p.getCollisionFlags()|2),p.setActivationState(4),p.setFriction(n),u&&(t.addVelocityToPlayer=!0),t instanceof Gs){t.mesh.instanceMatrix.setUsage(THREE.DynamicDrawUsage),t.mesh.getMatrixAt(t.index,ps),t.scale=(new THREE.Vector3).setFromMatrixScale(ps);var d=(new THREE.Quaternion).setFromScaledRotationMatrix(ps)}else t.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.parent.remove(t),Tl.add(t),t.updateMatrixWorld(!0),d=t.quaternion.clone();var h=t.ammoBody.getWorldTransform().getOrigin().toThree(),f=(a&ys)>0;ls.push({object:t,type:"swinging",baseQuaternion:d,basePosition:h,pivot:s,startTick:e,loopDurationInTicks:r,alternateDelayInTicks:l,loopDelayInTicks:c,cycleDurationInTicks:r+l+c,axis:i,currentAngle:0,angle:o,easingId:a,easingFunction:_s[f?a-ys:a],startAtPeak:f})}else console.error("Can't make mesh swinging, has no body",t.name,t)}function bs(t,e,n,r,i,o,a){if(t==ms){var s=Math.random()<.5?"face-ball":"simple-ball";us[s]||(mesh=Yt(mc[s]),mc[s].updateMatrixWorld(!0),mesh.geometry.prepared||(mesh.geometry.applyMatrix4(mesh.matrixWorld),mesh.geometry.prepared=!0),us[s]=new Ds(mesh.geometry,mesh.material,20));var l=new THREE.Quaternion,c=new THREE.Vector3(2*r,2*r,2*r),u=us[s].add(n,l,c),p=new v.btSphereShape(r)}else{if(!us[s="type-"+t]){if(mesh=Sc[t],!mesh){for(var d in console.error("Mesh for type",t,"was not found",Sc,Object.keys(Sc).length),Sc)console.error(d,"->",Sc[d]);return}mesh.position.set(0,0,0),mesh.updateMatrixWorld(!0),mesh.geometry.applyMatrix4(mesh.matrixWorld),us[s]=new Ds(mesh.geometry,mesh.material,20),us[s].baseScale=mesh.geometry.boundingBox.max.clone().sub(mesh.geometry.boundingBox.min),us[s].baseScale.set(1/us[s].baseScale.x,1/us[s].baseScale.y,1/us[s].baseScale.z),-1!==mesh.name.toLowerCase().indexOf("_collider_box")&&(us[s].isBoxCollider=!0)}l=new THREE.Quaternion,c=us[s].baseScale.clone().multiplyScalar(2*r),u=us[s].add(n,l,c),ss.setValue(r,r,r),p=us[s].isBoxCollider?new v.btBoxShape(ss):new v.btSphereShape(r)}u.objectId=e,u.isObject=!0,os.setIdentity(),as.setFromThree(n),os.setOrigin(as),ss.setValue(0,0,0),p.calculateLocalInertia(i,ss);var h=new v.btDefaultMotionState(os),f=new v.btRigidBodyConstructionInfo(i,h,p,ss);f.set_m_friction(void 0===a?10:a),f.set_m_rollingFriction(0),f.set_m_angularDamping(0),f.set_m_restitution(0),u.ammoBody=new v.btRigidBody(f),Hl.addRigidBody(u.ammoBody,Q,W|X|Q|(Vs?q:0)),u.ammoBody.setActivationState(4),u.ammoBody.threeObject=u,v.destroy(f),ic.push(u.ammoBody),o&&(as.setFromThree(o),u.ammoBody.setLinearVelocity(as)),cs[e]=u;let m=new THREE.Object3D;m.position.copy(n),Re("spawn_object",m)}function xs(t,e,n,r,i,o,a,s,l,c,u,p){var d=t.ammoBody;if(d)if(d.setCollisionFlags(-2&d.getCollisionFlags()|2),d.setActivationState(4),d.setFriction(e),p&&(t.addVelocityToPlayer=!0),ls.push({object:t,type:"moving",startPosition:n,endPosition:r,startTick:i,durationInTicks:o,direction:a,loop:s,alternateDelayInTicks:l,loopDelayInTicks:c,cycleDurationInTicks:o+(2==a?o+l:0)+c,easingId:u,easingFunction:_s[u]}),t instanceof Gs){t.mesh.getMatrixAt(t.index,ps);var h=new THREE.Vector3,f=new THREE.Vector3,m=new THREE.Quaternion;ps.decompose(h,m,f),t.scale=f,t.mesh.instanceMatrix.setUsage(THREE.DynamicDrawUsage)}else t.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.parent.remove(t),Tl.add(t),t.updateMatrixWorld(!0);else console.error("Can't make mesh rotating, has no body",t.name,t)}function ws(t,e,n,r,i,o,a,s,l,c,u){var p=t.ammoBody;if(!p)return void console.error("Can't make mesh rotating, has no body",t.name,t);p.setCollisionFlags(8&p.getCollisionFlags()|2),p.setActivationState(4),p.setFriction(e),u&&(t.addVelocityToPlayer=!0);let d=0,h=[],f=0==n.children?[n]:n.children.sort((t,e)=>t.name>e.name?1:e.name>t.name?-1:0);for(let t=0;t<f.length;t++){let e=f[t],n=l[t],r=s[t],i=d;d+=r+n;let o=[],a=e.geometry.getAttribute("position").array;for(let t=0;t<a.length;t+=3)o.push(new THREE.Vector3(a[t+0],a[t+1],a[t+2]).applyMatrix4(e.matrixWorld));let u=0,p=e.geometry.index.array;for(let t=2;t<p.length;t+=2)p[t]!=p[t-2]&&p[t]!=p[t-1]&&p[t+1]!=p[t-2]&&p[t+1]!=p[t-1]&&(u=t/2+1);u>0&&(o=o.concat(o.splice(0,u)));let m=[0],y=0;for(let t=1;t<o.length;t++)y+=o[t-1].distanceTo(o[t]),m.push(y);let _=c[t];h.push({path:e,easingId:_,easingFunction:_s[_],pathStartTick:i,pathEndTick:d,durationInTicks:n,delayBeforeInTicks:r,pathPoints:o,pathLengths:m})}if(ls.push({object:t,type:"path",pathObject:n,paths:h,startTick:r,direction:i,loop:o,alternateDelayInTicks:a,loopDurationInTicks:d,cycleDurationInTicks:d+(2==i?d+a:0)}),t instanceof Gs){t.mesh.getMatrixAt(t.index,ps);var m=new THREE.Vector3,y=new THREE.Vector3,_=new THREE.Quaternion;ps.decompose(m,_,y),t.scale=y,t.mesh.instanceMatrix.setUsage(THREE.DynamicDrawUsage)}else t.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.parent.remove(t),Tl.add(t),t.updateMatrixWorld(!0)}function Es(t,e){if(t instanceof Gs){t.getBoundingBox(),t.mesh.getMatrixAt(t.index,ps);var n=(new THREE.Vector3).setFromMatrixScale(ps),r=(new THREE.Quaternion).setFromScaledRotationMatrix(ps);t.scale=n,ps.setPosition(0,0,0);var i=t.mesh.geometry.boundingBox}else(new THREE.Box3).setFromObject(t),r=t.getWorldQuaternion(new THREE.Quaternion),n=t.getWorldScale(new THREE.Vector3),i=t.geometry.boundingBox;t.ammoBody.getMotionState().getWorldTransform(os);var o=os.getOrigin(),a=i.max.clone().add(i.min).multiply(n).applyQuaternion(r).multiplyScalar(.5);if(o.setValue(o.x()+a.x,o.y()+a.y,o.z()+a.z),os.setOrigin(o),t.pivotOffset=a,t.ammoBody.getMotionState().setWorldTransform(os),t.ammoBody.getWorldTransform().setOrigin(o),t.visualOffset=i.max.clone().add(i.min).multiplyScalar(.5),e)return i.max.clone().sub(i.min).multiply(n).multiplyScalar(.5)}function Ts(t){var e=t.ammoBody;Qs(e);var n=Es(t,!0),r=as;r.setValue(Math.abs(n.x),Math.abs(n.y),Math.abs(n.z));var i=new v.btCylinderShapeZ(r);e.setCollisionShape(i),t.colliderType="cylinder"}function Ss(t){var e=t.ammoBody;Qs(e);var n=Es(t,!0),r=as;r.setValue(Math.abs(n.x),Math.abs(n.y),Math.abs(n.z));var i=new v.btCylinderShape(r);e.setCollisionShape(i),t.colliderType="cylinder"}function Ms(t){var e=t.ammoBody;Qs(e);var n=Es(t,!0),r=as;r.setValue(Math.abs(n.x),Math.abs(n.y),Math.abs(n.z));let i=new v.btBoxShape(r);e.setCollisionShape(i),t.colliderType="box"}function js(t){var e=t.ammoBody;Qs(e);var n=Es(t,!0);let r=new v.btSphereShape(Math.max(n.x,Math.max(n.y,n.z)));e.setCollisionShape(r),t.colliderType="sphere"}function Cs(t){var e=t.ammoBody;Qs(e),t instanceof Gs&&(t.mesh.getMatrixAt(t.index,ps),t.scale=(new THREE.Vector3).setFromMatrixScale(ps));var n=t.scale,r=t instanceof Gs?t.mesh.geometry:t.geometry;let i=r.index?r.toNonIndexed().getAttribute("position"):r.getAttribute("position"),o=new v.btConvexHullShape,a=as;for(var s=0;s<3*i.count;s+=3)a.setX(i.array[s+0]*n.x),a.setY(i.array[s+1]*n.y),a.setZ(i.array[s+2]*n.z),o.addPoint(a,!1);o.recalcLocalAabb(),e.setCollisionShape(o),t.colliderType="hull"}function zs(t,e,n,r,i,o){var a=e.ammoBody;if(!a)return void console.error("Can't make mesh dynamic, has no body",e.name,e);a.setActivationState(1),Hl.removeRigidBody(a);let s=a.getCollisionShape();if(as.setValue(0,0,0),s.calculateLocalInertia(n,as),a.setMassProps(n,as),Hl.addRigidBody(a,Q,W|X|Q|(Vs?q:0)),r&&a.setFriction(r),a.setDamping(i,o),ic.push(a),e.objectId=t,e.isObject=!0,e.param1=0,e.param2=n,e.type=2,cs[e.objectId]=e,e.matrixAutoUpdate=!0,e instanceof Gs){e.mesh.instanceMatrix.setUsage(THREE.DynamicDrawUsage),e.mesh.getMatrixAt(e.index,ps);var l=new THREE.Vector3;ps.decompose(ds,hs,l),e.scale=l}else e.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.parent.remove(e),Tl.add(e),e.updateMatrixWorld(!0)}function Rs(t,e,n,r,i){as.setFromThree(e),ss.setFromThree(n);var o=new v.btHingeConstraint(t.ammoBody,as,ss,!0);void 0!==r&&void 0!==i&&o.setLimit(r,i),Hl.addConstraint(o,!0),t.constraints||(t.constraints=[]),t.constraints.push({ammoConstraint:o,type:"hinge",pivot:e,axis:n,lowLimit:r,highLimit:i})}function As(t,e,n,r){e>=0&&t.ammoBody.setFriction(e),t.playerImpulseFactor=n||1,t.slidingPlayerImpulseFactor=r||1}function Ls(t,e){let n=t.pathPoints.length,r=t.pathLengths[n-1]*e;if(e>=1)return t.pathPoints[n-1];for(let e=1;e<t.pathLengths.length;e++)if(r<t.pathLengths[e]){let n=(r-t.pathLengths[e-1])/(t.pathLengths[e]-t.pathLengths[e-1]);return t.pathPoints[e-1].clone().lerp(t.pathPoints[e],n)}}function Is(t,e,n,r){if(t instanceof Gs){if(void 0!==n||void 0!==r||"undefined"!=typeof scale){var i=new THREE.Matrix4;t.mesh.getMatrixAt(t.index,i);var o=new THREE.Vector3;i.decompose(ds,hs,o),i.compose(void 0!==n?n:ds,void 0!==r?r:hs,o),t.mesh.setMatrixAt(t.index,i),t.mesh.instanceMatrix.needsUpdate=!0}}else void 0!==e&&(t.visible=e),(void 0!==n||void 0!==r)&&(t.getWorldScale(new THREE.Vector3),null===t.parent?(t.position.copy(n),t.quaternion.copy(r)):(void 0!==n&&t.position.copy(n).sub(t.parent.getWorldPosition(new THREE.Vector3)),void 0!==r&&t.quaternion.copy(r).premultiply(t.parent.getWorldQuaternion(new THREE.Quaternion).invert())),t.updateMatrix(),t.updateMatrixWorld(!0));if(t.ammoBody&&(void 0!==n&&t.ammoBody.getWorldTransform().getOrigin().setFromThree(n),void 0!==r)){var a=t.ammoBody.getWorldTransform().getRotation();a.setFromThree(r),t.ammoBody.getWorldTransform().setRotation(a)}}function Ps(t,e){for(var n=0;n<t.length;n++)if(e<=t[n].pathEndTick)return t[n];return t[t.length-1]}function Os(t){for(var e=ls.length-1;e>=0;e--){var n=ls[e],r=n.object.ammoBody.getMotionState();if(r.getWorldTransform(os),"rotation"==n.type){var i=(o=pc-n.startTick)*n.anglePerTick%(2*Math.PI);hs.setFromAxisAngle(n.axis,i).multiply(n.startQuaternion),(p=os.getRotation()).setFromThree(hs),os.setRotation(p),n.pivot&&(ds.copy(n.pivot),fs.setFromAxisAngle(n.axis,i),ds.applyQuaternion(fs),ds.sub(n.pivot),ds.add(n.basePosition),os.getOrigin().setFromThree(ds))}else if("moving"==n.type){for(var o=pc-n.startTick;o<0;)o+=n.cycleDurationInTicks;if(n.loop<=0||o/n.cycleDurationInTicks<n.loop){var a=o%n.cycleDurationInTicks;if(0==n.direction)var s=a>=n.durationInTicks?1:a/(n.durationInTicks-1);else 1==n.direction?s=a>=n.durationInTicks?0:1-a/(n.durationInTicks-1):2==n.direction&&(s=a<n.durationInTicks?a/(n.durationInTicks-1):a<n.durationInTicks+n.alternateDelayInTicks?1:a<2*n.durationInTicks+n.alternateDelayInTicks?1-(a-n.durationInTicks-n.alternateDelayInTicks)/(n.durationInTicks-1):0);n.easingId>0&&(s=n.easingFunction(s));var l=n.startPosition.clone().lerp(n.endPosition,s);as.setFromThree(l),os.setOrigin(as)}else l=0==n.direction?n.endPosition:n.startPosition,as.setFromThree(l),os.setOrigin(as),n.canDelete=!0}else if("path"==n.type){for(o=pc-n.startTick;o<0;)o+=n.cycleDurationInTicks;if(n.loop<=0||o/n.cycleDurationInTicks<n.loop){a=o%n.cycleDurationInTicks;var c=n.direction;2==n.direction?a>=n.loopDurationInTicks+n.alternateDelayInTicks&&(a=n.cycleDurationInTicks-a):1==c&&(a=n.loopDurationInTicks-a);var u=Ps(n.paths,a);(a=a-u.pathStartTick-u.delayBeforeInTicks)<=0?l=u.pathPoints[0]:(s=a>=u.durationInTicks?1:a/(u.durationInTicks-1),u.easingId>0&&(s=u.easingFunction(s)),l=Ls(u,s)),as.setFromThree(l),os.setOrigin(as)}else l=0==n.direction?u.pathPoints[u.pathPoints.length-1]:u.pathPoints[0],as.setFromThree(l),os.setOrigin(as),n.canDelete=!0}else if("swinging"==n.type){for(o=pc-n.startTick;o<0;)o+=n.cycleDurationInTicks;var p=os.getRotation();n.easingId>0?n.startAtPeak?(s=(a=o%n.cycleDurationInTicks)<n.loopDurationInTicks/2?2*a/(n.loopDurationInTicks-1):a<n.loopDurationInTicks/2+n.alternateDelayInTicks?1:a<n.loopDurationInTicks+n.alternateDelayInTicks?1-2*(a-.5*n.loopDurationInTicks-n.alternateDelayInTicks)/(n.loopDurationInTicks-1):0,n.currentAngle=n.angle*n.easingFunction(s)):(s=(a=o%n.cycleDurationInTicks)<.25*n.loopDurationInTicks?n.easingFunction(4*a/(n.loopDurationInTicks-1)):a<.25*n.loopDurationInTicks+n.alternateDelayInTicks?1:a<.5*n.loopDurationInTicks+n.alternateDelayInTicks?n.easingFunction(1-4*(a-.25*n.loopDurationInTicks-n.alternateDelayInTicks)/(n.loopDurationInTicks-1)):a<.75*n.loopDurationInTicks+n.alternateDelayInTicks?-n.easingFunction(4*(a-n.alternateDelayInTicks-.5*n.loopDurationInTicks)/(n.loopDurationInTicks-1)):a<.75*n.loopDurationInTicks+n.alternateDelayInTicks+n.loopDelayInTicks?-1:-n.easingFunction(1-4*(a-n.alternateDelayInTicks-n.loopDelayInTicks-.75*n.loopDurationInTicks)/(n.loopDurationInTicks-1)),n.currentAngle=n.angle*s):(s=0==n.alternateDelayInTicks&&0==n.loopDelayInTicks?o%n.loopDurationInTicks/(n.loopDurationInTicks-1):(a=o%n.cycleDurationInTicks)<.25*n.loopDurationInTicks?a/(n.loopDurationInTicks-1):a<.25*n.loopDurationInTicks+n.alternateDelayInTicks?.25:a<.75*n.loopDurationInTicks+n.alternateDelayInTicks?(a-n.alternateDelayInTicks)/(n.loopDurationInTicks-1):a<.75*n.loopDurationInTicks+n.alternateDelayInTicks+n.loopDelayInTicks?.75:(a-n.alternateDelayInTicks-n.loopDelayInTicks)/(n.loopDurationInTicks-1),n.startAtPeak&&(s+=.5),n.currentAngle=n.angle*Math.sin(2*s*Math.PI)),hs.copy(n.baseQuaternion),tr>=2?hs.premultiply(fs.setFromAxisAngle(n.axis,n.currentAngle)):hs.multiply(fs.setFromAxisAngle(n.axis,n.currentAngle)),p.setFromThree(hs),os.setRotation(p),n.pivot&&(ds.copy(n.pivot),ds.applyQuaternion(fs),ds.sub(n.pivot),ds.add(n.basePosition),os.getOrigin().setFromThree(ds))}r.setWorldTransform(os)}}function ks(t){if(t instanceof Gs)if(t.mesh.set)t.mesh.set.remove(t);else{var e=(new THREE.Matrix4).setPosition(0,0,-1e7);t.mesh.setMatrixAt(t.index,e),t.mesh.instanceMatrix.needsUpdate=!0}else t.parent.remove(t)}function Bs(t,e){if(t.constraints)for(let e=0;e<t.constraints.length;e++)Hl.removeConstraint(t.constraints[e].ammoConstraint);Hl.removeRigidBody(t.ammoBody),ic.splice(ic.indexOf(t.ammoBody),1);var n=t.ammoBody.getMotionState();if(n&&v.destroy(n),Qs(t.ammoBody),v.destroy(t.ammoBody),delete t.ammoBody,1==e||2==e)if(t instanceof Gs){var r=new THREE.Matrix4;t.mesh.getMatrixAt(t.index,r);var i=new THREE.Vector3,o=new THREE.Quaternion,a=new THREE.Vector3;r.decompose(i,o,a),anime({targets:a,x:0,y:0,z:0,duration:500,easing:"linear",complete:function(){ks(t)},update:function(){r.compose(i,o,a),t.mesh.setMatrixAt(t.index,r),t.mesh.instanceMatrix.needsUpdate=!0}})}else anime({targets:t.scale,x:0,y:0,z:0,duration:500,easing:"linear",complete:function(){ks(t)}});else ks(t);delete cs[t.objectId]}function Ds(t,e,n){this.meshList=[],this.geometry=t,this.material=e,this.instancesPerMesh=n}Ds.prototype.add=function(t,e,n){for(var r=null,i=0;i<this.meshList.length;i++)if(this.meshList[i].count<this.instancesPerMesh){r=this.meshList[i];break}r||((r=new THREE.InstancedMesh(this.geometry.clone(),this.material.clone(),this.instancesPerMesh)).name="SpawnedObject",r.count=0,r.objects=[],r.set=this,this.meshList.push(r),r.frustumCulled=!1,r.instanceMatrix.setUsage(THREE.DynamicDrawUsage),Tl.add(r));var o=r.count;r.count++;var a=new Gs(r,o,n);return r.objects[o]=a,ps.compose(t,e,n),r.setMatrixAt(o,ps),r.instanceMatrix.needsUpdate=!0,a},Ds.prototype.remove=function(t){for(var e=t.index,n=t.mesh,r=e+1;r<n.count;r++)n.objects[r].index--;n.objects.splice(e,1),n.count--,0==n.count&&(this.meshList.splice(this.meshList.indexOf(n),1),Tl.remove(n))},Ds.prototype.removeAll=function(){for(var t=0;t<this.meshList.length;t++)this.meshList[t].geometry.dispose(),this.meshList[t].material&&this.meshList[t].material.map&&this.meshList[t].material.map.dispose(),this.meshList[t].dispose(),Tl.remove(this.meshList[t]);this.meshList=[]};var Hs,Fs,Ns={},Us=[],Vs=!1;function Gs(t,e,n){this.mesh=t,this.index=e,n&&(this.scale=n)}function Ws(t,e){if(Ns[t])return Ns[t];e=e||El;var n=t.indexOf("@");if(-1==n){for(var r=t,i=0;i<e.children.length;i++)if((o=e.children[i]).name==r)return o}else for(r=t.substring(0,n),i=0;i<e.children.length;i++){var o;if((o=e.children[i]).name==r)return Ws(t.substring(n+1),o)}return null}function qs(t){return t.parent&&t.parent.parent&&t.parent.parent.parent?qs(t.parent)+"@"+t.name:t.name}function Xs(t,e){var n=new THREE.InstancedMesh(t[0].geometry,t[0].material.clone(),t.length);n.matrixAutoUpdate=!1,n.name=t[0].name;for(var r=0;r<t.length;r++)n.setMatrixAt(r,t[r].matrixWorld);for(r=0;r<t.length;r++){var i=qs(t[r]),o=new Gs(n,r);o.path=i,o.name=t[r].name,o.ammoBody=t[r].ammoBody,Ns[i]=o,t[r].visualOffset&&(o.visualOffset=t[r].visualOffset),t[r].colliderType&&(o.colliderType=t[r].colliderType),t[r].parent&&t[r].parent.remove(t[r]),o.ammoBody&&(o.ammoBody.originalThreeObject=o.ammoBody.threeObject,o.ammoBody.threeObject=o)}return e?e.add(n):(Tl.add(n),Us.push(n)),n}function Ys(t,e){var n=function t(e,n){n||(n={});for(var r=e.children.length-1;r>=0;r--)t(e.children[r],n);if(e instanceof THREE.Mesh){var i=e.geometry.uuid+" "+e.material.uuid;n[i]||(n[i]=[]),n[i].push(e)}return n}(t);for(var r in n){var i=n[r];i.length>1&&Xs(i,e)}}function Qs(t){if(t.shape){var e=t.shape;if(e.shapeUsers&&(e.shapeUsers--,e.shapeUsers>0))return void delete t.shape;e.triangleInfoMap&&v.destroy(e.triangleInfoMap),e.triangleMesh&&v.destroy(e.triangleMesh),v.destroy(t.getCollisionShape()),delete t.shape}else v.destroy(t.getCollisionShape())}function Zs(t,e){if(t instanceof Gs){t.getBoundingBox(),t.mesh.getMatrixAt(t.index,ps);var n=(new THREE.Vector3).setFromMatrixScale(ps),r=(new THREE.Quaternion).setFromScaledRotationMatrix(ps);t.scale=n,ps.setPosition(0,0,0);var i=t.mesh.geometry.boundingBox}else r=t.getWorldQuaternion(new THREE.Quaternion),n=t.getWorldScale(new THREE.Vector3),i=t.geometry.boundingBox;var o=i.max.clone().add(i.min).multiply(n).applyQuaternion(r).multiplyScalar(.5);if(t.pivotOffset=o,t.visualOffset=i.max.clone().add(i.min).multiplyScalar(.5),e)return i.max.clone().sub(i.min).multiply(n).multiplyScalar(.5)}Gs.prototype.getBoundingBox=function(){var t=new THREE.Box3,e=this.mesh.geometry;if(void 0!==e){null===e.boundingBox&&e.computeBoundingBox(),t.copy(e.boundingBox);var n=new THREE.Matrix4;this.mesh.getMatrixAt(this.index,n),t.applyMatrix4(n)}return t},THREE.Mesh.prototype.addToBtTriangleMesh=function(t){var e=this.geometry.getAttribute("position"),n=new THREE.Vector3,r=new THREE.Vector3,i=new THREE.Vector3,o=new v.btVector3,a=new v.btVector3,s=new v.btVector3;this.geometry.index&&(e=this.geometry.toNonIndexed().getAttribute("position")),3!=e.itemSize&&console.error("mesh positions.itemSize is not 3",e.itemSize,this),e.count%3!=0&&console.error("mesh positions.count is not multiple of 3:",e.count,this);for(var l=0;l<3*e.count;l+=9)n.set(e.array[l+0],e.array[l+1],e.array[l+2]).applyMatrix4(this.matrixWorld),r.set(e.array[l+3],e.array[l+4],e.array[l+5]).applyMatrix4(this.matrixWorld),i.set(e.array[l+6],e.array[l+7],e.array[l+8]).applyMatrix4(this.matrixWorld),o.setFromThree(n),a.setFromThree(r),s.setFromThree(i),t.addTriangle(o,a,s,!1);v.destroy(o),v.destroy(a),v.destroy(s)};var Js=new Map,Ks=new THREE.Matrix4;function $s(t,e){if(t.name.startsWith("BallSpawn")||t.name.startsWith("BoxSpawn")||t.name.startsWith("FinishBallSpawn"))t.parent.remove(t);else{if(-1!==t.name.toLowerCase().indexOf("_mergemeshes")&&(t=function(t,e){Date.now();var n,r=[],i=[],o=!0,a=-1!=t.name.toLowerCase().indexOf("_collider_compound"),s=[];if(t.traverse(function(l){if(o&&l instanceof THREE.Mesh&&(!a||-1==l.name.toLowerCase().indexOf("_collider")||l==t)){if(e&&l.material.map)return console.error("Merging meshes with vertex colors not possible, one of the node has a material with a map",t),o=!1,t;if(n){if(!e&&l.material!=n)return console.error("Merging meshes not possible, one of the node has a different material",t),o=!1,t}else n=l.material;if(e){let t=l.geometry.attributes.position.count;var c=new THREE.BufferAttribute(new Float32Array(3*t),3);l.geometry.setAttribute("color",c);let e=l.material.color;for(let n=0;n<t;n++)c.setXYZ(n,e.r,e.g,e.b)}if(l==t||function t(e,n){return!!Ks.equals(e.matrix)&&(e.parent==n||t(e.parent,n))}(l,t))r.push(l.geometry),i.push(l.geometry.uuid+(e?"_"+l.material.uuid:""));else{var u=t.matrixWorld.clone().invert().multiply(l.matrixWorld),p=l.geometry.clone().applyMatrix4(u);r.push(p),i.push(p.uuid+(e?"_"+l.material.uuid:""))}a&&l!=t&&s.push(l)}}),1==r.length)return t;for(var l=0;l<s.length;l++)s[l].parent.remove(s[l]);if(!(t instanceof THREE.Mesh)){var c=new THREE.Mesh;for(c.copy(t),c.material=n,c.children=t.children,t.children=[],l=0;l<c.children.length;l++)c.children[l].parent=c;t.parent.children[t.parent.children.indexOf(t)]=c,c.parent=t.parent,t=c}i.sort();var u=i.join("/");return Js.has(u)?(t.geometry=Js.get(u),t.geometry.material&&(t.material=t.geometry.material),a||(t.children=[])):o&&(t.geometry=THREE.BufferGeometryUtils.mergeBufferGeometries(r),t.geometry.computeBoundingBox(),a||(t.children=[]),e&&(t.material=n.clone(),t.material.vertexColors=!0,t.material.color.setRGB(1,1,1),t.geometry.material=t.material),Js.set(u,t.geometry),Date.now()),t}(t,-1!==t.name.toLowerCase().indexOf("_mergemeshesvertexcolors"))),t.material&&-1!==t.name.toLowerCase().indexOf("_roughness")){var n=(j=t.name.toLowerCase().split("_")).indexOf("roughness");t.material.roughness=parseInt(j[n+1])/100}if(t.name.startsWith("SpawnModel")){var r=parseInt(t.name.split("_")[1]);return Sc[r]=t,void t.parent.remove(t)}if(t.name.startsWith("WorldBox")||t.name.startsWith("CheckPointArea")||t.name.startsWith("FinishLine")||t.name.toLowerCase().startsWith("bot_hint_"))t.parent.remove(t);else{if(t instanceof THREE.Mesh&&t.geometry||-1!=t.name.toLowerCase().indexOf("_collider_compound")){var i=new THREE.Vector3,o=new THREE.Quaternion,a=new THREE.Vector3;t.matrixWorld.decompose(i,o,a);var s=!1,l=!1;if(t.name.toLowerCase().startsWith("portal_"))if(t.parent.remove(t),(j=t.name.toLowerCase().split("_")).length>=3&&"in"==j[1].toLowerCase())s=!0,t.destinationPortalId=parseInt(j[2]);else if(j.length>=3&&"out"==j[1].toLowerCase()){l=!0,r=parseInt(j[2]),uc.set(r,t),t.portalSpawnPosition=i.toAmmo();var c=new THREE.Euler(0,0,0,"YXZ").setFromQuaternion(o);c.x=c.z=0,t.portalSpawnQuaternion=(new THREE.Quaternion).setFromEuler(c).toAmmo()}if(t.name.toLowerCase().startsWith("item_"))t.parent.remove(t);else if(t.name.toLowerCase().startsWith("spawn_")||t.parent.name.toLowerCase().startsWith("spawn_"))cc.push(i),t.parent.remove(t);else{if(t.name.toLowerCase().startsWith("bot_"))return void t.parent.remove(t);if(!l){var u=t.name.toLowerCase().startsWith("jumpad_"),p=t.name.startsWith("Gravity"),d=-1!==t.name.toLowerCase().indexOf("_actionsensor");if(p){t.isGravityCollider=!0,Vs=!0;var h=Hl.getGravity().toThree();if(t.gravityVector=h.clone().applyQuaternion(new THREE.Quaternion(.7071067811865475,0,0,.7071067811865476)).applyQuaternion(o),(j=t.name.toLowerCase().split("_")).length>1)if(j[1]=j[1].replace("-","."),j[1].toLowerCase().endsWith("pct")){var f=parseFloat(j[1])/100;t.gravityVector.multiplyScalar(f)}else{var m=parseFloat(j[1]);t.gravityVector.normalize().multiplyScalar(m)}Math.abs(h.angleTo(t.gravityVector)-Math.PI)<.01?(t.name.toLowerCase().startsWith("gravityz")?t.gravityQuaternion=new THREE.Quaternion(0,0,1,0):t.gravityQuaternion=new THREE.Quaternion(1,0,0,0),t.gravityQuaternion.is180=!0):t.gravityQuaternion=(new THREE.Quaternion).setFromUnitVectors(h.normalize(),t.gravityVector.clone().normalize())}var y=s||u||p||d;if(y||t.name.toLowerCase().startsWith("tshaded")||!e){var _=function t(e,n){if(-1!=e.name.toLowerCase().indexOf("_collider_none"))return;if(-1!=e.name.toLowerCase().indexOf("_collider_compound")){let n=new v.btCompoundShape,o=e.getWorldQuaternion(new THREE.Quaternion).invert();var r=[];e.traverse(function(t){t!=e&&t.parent!=e&&t instanceof THREE.Mesh&&r.push(t)});for(var i=0;i<r.length;i++)e.attach(r[i]);return function(e,n,r,i){for(let o=0;o<e.children.length;o++){let a=e.children[o];if(a instanceof THREE.Mesh){let e=t(a,a.getWorldScale(new THREE.Vector3));a.position.multiply(i),a.pivotOffset&&a.position.add(a.pivotOffset.applyQuaternion(r)),Hs.getOrigin().setFromThree(a.position);let o=Hs.getRotation();o.setFromThree(a.quaternion),Hs.setRotation(o),n.addChildShape(Hs,e)}}}(e,n,o,e.getWorldScale(new THREE.Vector3)),e.children=[],e.isCompoundCollider=!0,n}if(-1!=e.name.toLowerCase().indexOf("_collider_sphere")){var o=Zs(e,!0);let t=new v.btSphereShape(Math.max(o.x,Math.max(o.y,o.z)));return e.colliderType="sphere",t}if(-1!=e.name.toLowerCase().indexOf("_collider_box")){o=Zs(e,!0),(a=Fs).setValue(Math.abs(o.x),Math.abs(o.y),Math.abs(o.z));let t=new v.btBoxShape(a);return e.colliderType="box",t}if(-1!=e.name.toLowerCase().indexOf("_collider_cylinder_y")){o=Zs(e,!0),(a=Fs).setValue(Math.abs(o.x),Math.abs(o.y),Math.abs(o.z));let t=new v.btCylinderShapeZ(a);return e.colliderType="cylinder",t}if(-1!=e.name.toLowerCase().indexOf("_collider_cylinder_z")){var a;o=Zs(e,!0),(a=Fs).setValue(Math.abs(o.x),Math.abs(o.y),Math.abs(o.z));let t=new v.btCylinderShape(a);return e.colliderType="cylinderZ",t}if(-1!=e.name.toLowerCase().indexOf("_collider_convexhull")){let t=e.geometry.index?e.geometry.toNonIndexed().getAttribute("position"):e.geometry.getAttribute("position"),r=new v.btConvexHullShape,o=Fs;for(i=0;i<3*t.count;i+=3)o.setX(t.array[i+0]*n.x),o.setY(t.array[i+1]*n.y),o.setZ(t.array[i+2]*n.z),r.addPoint(o,!1);return r.recalcLocalAabb(),e.colliderType="hull",r}let s=function(t,e){if(t.geometry.ammoShapes)for(var n=0;n<t.geometry.ammoShapes.length;n++)if(0!==(r=t.geometry.ammoShapes[n]).shapeUsers&&e.distanceToSquared(r.shapeScale)<.001)return r.shapeUsers++,r;var r,i=t.geometry.getAttribute("position"),o=new v.btTriangleMesh,a=new v.btVector3,s=new v.btVector3,l=new v.btVector3;for(t.geometry.index&&(i=t.geometry.toNonIndexed().getAttribute("position")),3!=i.itemSize&&console.error("mesh positions.itemSize is not 3",i.itemSize,t),i.count%3!=0&&console.error("mesh positions.count is not multiple of 3:",i.count,t),n=0;n<3*i.count;n+=9)a.setX(i.array[n+0]*e.x),a.setY(i.array[n+1]*e.y),a.setZ(i.array[n+2]*e.z),s.setX(i.array[n+3]*e.x),s.setY(i.array[n+4]*e.y),s.setZ(i.array[n+5]*e.z),l.setX(i.array[n+6]*e.x),l.setY(i.array[n+7]*e.y),l.setZ(i.array[n+8]*e.z),o.addTriangle(a,s,l,!0);return(r=new v.btBvhTriangleMeshShape(o,!0,!0)).triangleMesh=o,v.destroy(a),v.destroy(s),v.destroy(l),t.geometry.ammoShapes||(t.geometry.ammoShapes=[]),t.geometry.ammoShapes.push(r),r.shapeUsers=1,r.shapeScale=e.clone(),r}(e,n);return s.type="triangleMesh",s}(t,a);if(_){var g=t.pivotOffset?i.clone().add(t.pivotOffset).toAmmo():i.toAmmo(),b=o.toAmmo(),x=new v.btTransform(b,g),w=new v.btDefaultMotionState(x);g.setValue(0,0,0);var T=new v.btRigidBodyConstructionInfo(0,w,_,g);T.set_m_friction(N);var S=new v.btRigidBody(T);if(v.destroy(T),v.destroy(x),v.destroy(b),v.destroy(g),t.ammoBody=S,S.shape=_,S.threeObject=t,y?Hl.addRigidBody(S,q,X|(p?Q:0)):Hl.addRigidBody(S,W,X|Y|Q),sc.push(S),y&&S.setCollisionFlags(4|S.getCollisionFlags()),s)S.setCollisionFlags(4|S.getCollisionFlags()),t.isPortalIn=!0;else if(u){S.setCollisionFlags(4|S.getCollisionFlags()),-1===t.name.toLowerCase().indexOf("_kinematic")&&t.parent.remove(t);var M=new THREE.Vector3(0,1,0);M.applyQuaternion(o);for(var j=t.name.toLowerCase().split("_"),C=100,z=100,R=1;R<j.length;R++){var A=j[R];1==R&&isFinite(parseFloat(A))?C=parseFloat(A):A.startsWith("s")&&isFinite(parseFloat(A.substring(1)))?C=parseFloat(A.substring(1)):A.startsWith("l")&&isFinite(parseFloat(A.substring(1)))&&(z=parseFloat(A.substring(1))*E/1e3)}M.multiplyScalar(C),t.jumppadImpulse=M,t.movementLockDelay=z,t.isJumpad=!0}else if("triangleMesh"===_.type){let t=new v.btTriangleInfoMap;t.m_equalVertexThreshold=Math.pow(1,2),t.generateInternalEdgeInfo(_),S.setCollisionFlags(8|S.getCollisionFlags()),_.triangleInfoMap=t}}}else t.addToBtTriangleMesh(e)}}}for(t.parent&&-1!==t.name.toLowerCase().indexOf("_hidden")&&(Ns[qs(t)]=t,t.parent.remove(t)),t.name.toLowerCase().startsWith("tshaded")&&nc.push(t),t.material&&t.material.map&&(t.material.map.minFilter=THREE.LinearMipmapLinearFilter),R=t.children.length-1;R>=0;R--)$s(t.children[R],e)}}}var tl,el,nl,rl=[],il={};const ol=4;var al,sl=[];function Ir(t){for(let t=0;t<sl.length;t++)sl[t].uniforms&&(sl[t].uniforms.time.value=kr.elapsedTime)}function ll(){if(tl){let t=nl.getAttribute("color");t.copy(tl),t.needsUpdate=!0}}function cl(t){t.material=new THREE.MeshBasicMaterial({map:t.material.map})}var ul=!1,pl=0,dl=0;try{localStorage.getItem("lastVideoAdEndedTime")&&(pl=parseInt(localStorage.getItem("lastVideoAdEndedTime")))}catch(e){}function hl(){if(ul){ul=!1,lo(),pl=(new Date).getTime();try{localStorage.setItem("lastVideoAdEndedTime",pl)}catch(t){}}}function fl(t,e,n,r){if(t.textContent="",0!=e&&0!=n)if($l)$l.requestResponsiveBanner([t.getAttribute("id")]);else if("undefined"!=typeof aiptag&&aiptag.cmd&&aiptag.cmd.display){var i="lolbeans-io_"+e+"x"+n+r,o=document.createElement("div");o.setAttribute("id",i),t.appendChild(o),aiptag.cmd.display.push(function(){aipDisplayTag.display(i)})}else gt&&(t.style.backgroundColor="red",t.appendChild(function(t,e){var n=document.createElement("div");return n.style.width=t+"px",n.style.height=e+"px",n.style.textAlign="center",n.style.display="flex",n.style.flexDirection="column",n.style.justifyContent="center",n.style.backgroundColor="white",n.innerHTML=t+"x"+e,n}(e,n)))}function ml(){if(!(Date.now()-dl<6e4||jc&&Date.now()/1e3<jc)){dl=Date.now();var t=document.getElementById("homepage-banner-right"),e=document.getElementById("screens"),n=document.getElementById("home-screen"),r=e.className,i=n.className;e.classList.add("visible"),n.classList.add("visible");var o=t.offsetWidth,a=t.offsetHeight;e.className=r,n.className=i,fl(t,o,a,"")}}function yl(){if(!(jc&&Date.now()/1e3<jc)){var t=document.getElementById("end-match-banner-left"),e=document.getElementById("end-match-banner-right"),n=document.getElementById("end-match-cross-promo"),r=document.getElementById("screens"),i=document.getElementById("end-match-screen"),o=r.className,a=i.className;r.classList.add("visible"),i.classList.add("visible");var s=t.offsetWidth,l=t.offsetHeight,c=e.offsetWidth,u=e.offsetHeight,p=n.offsetHeight;r.className=o,i.className=a,fl(t,s,l,"_2"),fl(e,c,u,250==u?"_2":"_3"),p>0&&(n.innerHTML='<iframe id="cp-iframe" width="267" height="120" src="https://exodragon.com/cp/?from=lolbeans"></iframe>')}}window.lolbeansInterstitialEnded=hl;var _l,gl,vl,bl,xl,wl,El,Tl,Sl,Ml,jl,Cl,zl,Rl,Al,Ll,Il,Pl,Ol,kl,Bl,Dl,Hl,Fl,Nl,Ul,Vl,Gl,Wl,ql,Xl,Yl,Ql,Zl,Jl,Kl,$l,tc=new function(){this.mapIndex=0,this.onGameStart=function(){"undefined"!=typeof gtag&&gtag("event","StartGame",{event_category:"Click",gamesStarted:to,webglGPU:document.getElementById("detected-GPU").innerHTML,adBlockDetected:Mc,abCohort:Ze,abCohortSet:Je,audioEnabled:Oc.audioEnabled,event_label:zn?zn.length:0})},this.onRoundEnd=function(){"undefined"!=typeof gtag&&(this.mapIndex++,Ul.endRank>=0&&gtag("event","Round"+this.mapIndex,{event_category:"Game",event_label:0==Ul.endRank?"Eliminated":"Qualified",value:Ul.raceTime}))},this.onReachCheckpoint=function(t){"undefined"!=typeof gtag&&gtag("event","Map-"+this.mapIndex+"-Ckpt",{event_category:"Game",event_label:t,value:(pc-Nl)/E,moveControl:Nr})},this.onInterstitialRequested=function(t){"undefined"!=typeof gtag&&gtag("event","ShowInterstitial",{event_category:"Ads",event_label:t||""})},this.onInterstitialBlocked=function(){"undefined"!=typeof gtag&&gtag("event","BlockedInterstitial",{event_category:"Ads"})}},ec=new Set,nc=[],rc=!1,ic=[],oc=[],ac={},sc=[],lc=Z,cc=[],uc=new Map,pc=0,dc=0,hc=!1,fc=0,mc={},yc=!1,_c=!1,gc=!1,vc=!1,bc=!1,xc=!1,wc=!1,Ec=!1,Tc=!1,Sc={},Mc=!1,jc=0;Ot&&-1!=navigator.userAgent.indexOf("Version/15")&&(window.createImageBitmap=void 0);var Cc=new THREE.GLTFLoader;Cc.register(function(t){return t.createUniqueName=function(t){return t},{name:"OriginalNames"}});var zc,Rc=new THREE.FBXLoader,Ac=(new THREE.ColladaLoader,new THREE.TextureLoader),Lc=(new THREE.ImageLoader,new THREE.AudioLoader),Ic=0,Pc=0,Oc={username:"",playerColor:void 0,playerColor2:void 0,playerColor3:void 0,playerHat:-1,playerTexture:0,mouseSensitivity:20,graphicsQuality:1,screenResolution:1,audioEnabled:!1,cspEnabled:-1,cspAccuracy:-1,FOV:75,chatEnabled:!0},kc={},Bc=!function(t,e,n,r,i,o){var a=document.createElement("canvas"),s=document.createElement("canvas"),l=a.getContext("2d"),c=s.getContext("2d");l.font=c.font="16px "+r;var u=l.measureText("�"),p=c.measureText("🤣");return a.width=u.width,a.height=1.2*u.width,s.width=p.width,s.height=1.2*p.width,l.font=c.font="16px "+r,l.textAlign=c.textAlign="center",l.textBaseline=c.textBaseline="middle",l.fillStyle=c.fillStyle="rgb(255,0,0)",l.fillText("�",a.width/2,a.height/2),c.fillText("🤣",s.width/2,s.height/2),function(t,e){if(t.data.length!=e.data.length)return!1;for(var n=0;n<t.data.length;++n)if(t.data[n]!=e.data[n])return!1;return!0}(l.getImageData(0,0,a.width,a.height),c.getImageData(0,0,s.width,s.height))}(0,0,0,Xi),Dc=0;try{localStorage.getItem("username")&&(Oc.username=localStorage.getItem("username")),localStorage.getItem("playerColor")&&(Oc.playerColor=parseInt(localStorage.getItem("playerColor"))),localStorage.getItem("playerColor2")&&(Oc.playerColor2=parseInt(localStorage.getItem("playerColor2"))),localStorage.getItem("playerColor3")&&(Oc.playerColor3=parseInt(localStorage.getItem("playerColor3"))),localStorage.getItem("playerTexture")&&(Oc.playerTexture=parseInt(localStorage.getItem("playerTexture"))),localStorage.getItem("playerHat")&&(Oc.playerHat=parseInt(localStorage.getItem("playerHat"))),localStorage.getItem("mouseSensitivity")&&(Oc.mouseSensitivity=parseInt(localStorage.getItem("mouseSensitivity"))),localStorage.getItem("FOV")&&(Oc.FOV=parseInt(localStorage.getItem("FOV"))),localStorage.getItem("graphicsQuality")&&(Oc.graphicsQuality=parseInt(localStorage.getItem("graphicsQuality"))),localStorage.getItem("screenResolution")&&(Oc.screenResolution=parseFloat(localStorage.getItem("screenResolution"))),localStorage.getItem("audioEnabled")&&(Oc.audioEnabled="true"===localStorage.getItem("audioEnabled")),localStorage.getItem("cspEnabled")&&(Oc.cspEnabled=parseInt(localStorage.getItem("cspEnabled"))),localStorage.getItem("cspAccuracy")&&(Oc.cspAccuracy=parseInt(localStorage.getItem("cspAccuracy"))),localStorage.getItem("chatEnabled")&&(Oc.chatEnabled="true"===localStorage.getItem("chatEnabled"))}catch(e){console.error(e)}function Hc(t){var e=void 0!==bl,n=bl&&bl.domElement.parentNode;try{n&&n.removeChild(bl.domElement)}catch(t){}if(e&&(bl.domElement.removeEventListener("webglcontextlost",bl.onContextLost,!1),bl.dispose(),bl.forceContextLoss()),(bl=new THREE.WebGLRenderer({antialias:Oc.graphicsQuality>=2,powerPreference:"high-performance",preserveDrawingBuffer:pt})).setPixelRatio(window.devicePixelRatio*Oc.screenResolution),bl.setSize(window.innerWidth,window.innerHeight),bl.shadowMap.type=THREE.PCFSoftShadowMap,bl.shadowMap.enabled=!!t,bl.shadowMap.autoUpdate=!1,bl.shadowMap.needsUpdate=bl.shadowMap.enabled,bl.gammaFactor=2.2,bl.outputEncoding=THREE.sRGBEncoding,bl.domElement.tabindex=1,bl.domElement.style.position="absolute",bl.domElement.style.top=0,bl.domElement.style.left=0,Oc.graphicsQuality>=3&&(bl.domElement.style.width="100%",bl.domElement.style.height="100%"),n&&n.appendChild(bl.domElement),bl.domElement.addEventListener("mousedown",Zr,!0),bl.domElement.addEventListener("touchstart",Ci,!0),bl.domElement.addEventListener("touchmove",Ci,!0),bl.domElement.addEventListener("touchend",Ci,!0),bl.domElement.addEventListener("touchcancel",Ci,!0),e&&(xl.shadow.mapSize.width=Math.min(bl.capabilities.maxTextureSize,2048),xl.shadow.mapSize.height=Math.min(bl.capabilities.maxTextureSize,2048)),At!=Oc.graphicsQuality>=2){At=Oc.graphicsQuality>=2;for(var r=0;r<oc.length;r++)oc[r].refreshPlayerTexture()}bl.onContextLost=function(e){console.error("WebGL context lost",e),e.preventDefault(),MainLoop.stop(),setTimeout(function(){bl.domElement.getContext("webgl")&&!bl.domElement.getContext("webgl").isContextLost()||(console.error("Context was not restored after 1 second, recreating"),Hc(t),MainLoop.start())},1e3)},bl.domElement.addEventListener("webglcontextlost",bl.onContextLost,!1),bl.domElement.addEventListener("webglcontextrestored",function(){console.error("WebGL context restored, recreating"),Hc(t),MainLoop.start()},!1),document.getElementById("detected-GPU").innerHTML=function(){try{var t=bl.domElement.getContext(bl.capabilities.isWebGL2?"webgl2":"webgl"),e=t.getExtension("WEBGL_debug_renderer_info");return t.getParameter(e.UNMASKED_VENDOR_WEBGL)+" | "+t.getParameter(e.UNMASKED_RENDERER_WEBGL)}catch(t){return console.error(t),"Unknown"}}(),bl.debug.checkShaderErrors=!1}function Fc(){console.log("onDocumentLoaded");var t,e=0;try{e=parseInt(document.querySelector("meta[property='lolbeans:version']").getAttribute("content")),console.log("html version is",e)}catch(t){console.error(t)}if(e<5&&alert("Old content has been loaded, we recommend you to manually reload the page (Ctrl+F5 or Command+R). Clear your browser cache if it doesn't work"),"undefined"!=typeof Raven&&Raven.config("https://95f5ec0e61404566928cf07ded0bb5cc@sentry.nitroclash.io/14",{whitelistUrls:["lolbeans.io"],ignoreUrls:["s-static.innovid.com"]}).install(),window.addEventListener("beforeunload",function(t){if(0!=Kn&&!Ec)return t.returnValue="Exit the game?","Exit the game?"}),void 0!==window.CrazyGames)try{($l=window.CrazyGames.CrazySDK.getInstance()).init(),$l.addEventListener("adStarted",function(){console.log("CrazySDK ad started")}),$l.addEventListener("adFinished",hl),$l.addEventListener("adError",function(){console.log("CrazySDK ad error"),hl()}),$l.addEventListener("bannerRendered",function(t){console.log("CrazySDK banner for container",t.containerId,"has been rendered!")}),$l.addEventListener("bannerError",function(t){console.log("CrazySDK Banner render error:",t.error)})}catch(t){console.error(t)}t=function(){if(Ol=new v.btDefaultCollisionConfiguration,kl=new v.btCollisionDispatcher(Ol),Bl=new v.btDbvtBroadphase,Dl=new v.btSequentialImpulseConstraintSolver,(Hl=new v.btDiscreteDynamicsWorld(kl,Bl,Dl,Ol)).setGravity(new v.btVector3(0,-20,0)),Hl.setForceUpdateAllAabbs(!1),Hl.activateContactAddedCallbackAdjustInternalEdgeContacts(),lr=new v.btTransform,new v.btTransform,cr=new v.btVector3(0,0,0),ur=new v.btVector3,pr=new v.btVector3,dr=new THREE.Quaternion,hr=Hl.getGravity().toThree().normalize(),os||(os=new v.btTransform),as||(as=new v.btVector3),ss||(ss=new v.btVector3),Hc(!!bl&&bl.shadowMap.enabled),(_l=new THREE.PerspectiveCamera(Oc.FOV,window.innerWidth/window.innerHeight,.1,1e3)).rotation.order="YXZ",_l.position.y=20,_l.lookAt(0,0,0),_l.far=4e3,_l.updateProjectionMatrix(),(gl=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3)).position.y=20,gl.lookAt(0,0,0),gl.far=4e3,gl.updateProjectionMatrix(),(vl=new THREE.Scene).add(_l),ht){var t=new THREE.CameraHelper(_l);t.material.color.r=0,vl.add(t)}(wl=new THREE.AmbientLight(16775660,at)).name="ambient",vl.add(wl),(xl=new THREE.DirectionalLight(16777215,1)).name="sun",xl.position.set(10,30,10),xl.castShadow=!0,xl.shadow.mapSize.width=Math.min(bl.capabilities.maxTextureSize,2048),xl.shadow.mapSize.height=Math.min(bl.capabilities.maxTextureSize,2048),xl.shadow.camera.left=-50,xl.shadow.camera.right=50,xl.shadow.camera.top=50,xl.shadow.camera.bottom=-50,xl.shadow.camera.near=10,xl.shadow.camera.far=100,xl.shadow.bias=-.001,xl.target.name="sun.target",vl.add(xl),vl.add(xl.target),xl.visible=!0,(Tl=new THREE.Group).name="mapNoTransform",Tl.matrixAutoUpdate=!1,vl.add(Tl),window.addEventListener("resize",Yc,!0),window.oncontextmenu=function(){return!1},window.addEventListener("blur",function(){},!0),THREE.DefaultLoadingManager.onStart=function(t,e,n){},THREE.DefaultLoadingManager.onLoad=function(t){setTimeout(Wc,0)},THREE.DefaultLoadingManager.onProgress=function(t,e,n){},THREE.DefaultLoadingManager.onError=function(t){vc||alert("Error loading game assets, please reload the page. Clear your browser cache if this happens repeatedly."),vc=!0},Uc(Ac,"chara-tex-0-decal","obj/Characters/Textures/0_Decal.png",Gc),Uc(Cc,"character","obj/Characters/Character_Anim_White_Nodecal v2.glb",Gc),Uc(Cc,"face-ball","obj/Map/Props/PRO_Ball.glb"),Uc(Cc,"simple-ball","obj/Map/Props/PRO_Ball_B.glb"),Uc(Ac,"impact-particle","vfx/circle.png"),Uc(Ac,"joystick","vfx/joystick.png"),ct&&Oc.audioEnabled&&we(),Uc(Cc,"skydome","obj/Map/Props/Environment-v06-NoUvs.glb"),Uc(Cc,"clouds","obj/Map/Props/Clouds.glb"),Vc(),document.getElementById("google-login-button").addEventListener("click",En),document.getElementById("fb-login-button").addEventListener("click",Tn),document.getElementById("home-login-button").addEventListener("click",Sn),document.getElementById("shop-login-button")&&document.getElementById("shop-login-button").addEventListener("click",Sn),(document.getElementById("profile-login-button")||document.getElementById("login-button")).addEventListener("click",Sn),document.getElementById("shop-create-account-link")&&document.getElementById("shop-create-account-link").addEventListener("click",Sn),document.getElementById("home-logout-button").addEventListener("click",wn),document.getElementById("shop-logout-button").addEventListener("click",wn),document.getElementById("profile-logout-button").addEventListener("click",wn),document.getElementById("home-my-account-button").addEventListener("click",Mn),document.getElementById("shop-my-account-button").addEventListener("click",Mn),document.getElementById("profile-my-account-button").addEventListener("click",Mn)},v().then(function(e){v=e,THREE.Vector3.prototype.toAmmo=function(){return new v.btVector3(this.x,this.y,this.z)},THREE.Vector3.prototype.setFromAmmo=function(t){return this.set(t.x(),t.y(),t.z())},v.btVector3.prototype.toThree=function(){return new THREE.Vector3(this.x(),this.y(),this.z())},v.btVector3.prototype.setFromThree=function(t){this.setValue(t.x,t.y,t.z)},v.btQuaternion.prototype.setFromThree=function(t){this.setValue(t.x,t.y,t.z,t.w)},v.btVector3.prototype.clone=function(){return new v.btVector3(this.x(),this.y(),this.z())},v.btQuaternion.prototype.toThree=function(){return new THREE.Quaternion(this.x(),this.y(),this.z(),this.w())},THREE.Quaternion.prototype.toAmmo=function(){return new v.btQuaternion(this.x,this.y,this.z,this.w)},THREE.Quaternion.prototype.setFromAmmo=function(t){return this.set(t.x(),t.y(),t.z(),t.w())},v.btVector3.prototype.toString=function(){return this.x().toFixed(3)+", "+this.y().toFixed(3)+", "+this.z().toFixed(3)},v.btQuaternion.prototype.toString=function(){return this.x()+", "+this.y()+", "+this.z()+", "+this.w()},v.btQuaternion.prototype.clone=function(){return new v.btQuaternion(this.x(),this.y(),this.z(),this.w())},t()})}function Nc(){console.log("onDocumentComplete"),function(){if(document.getElementById("username").value=Oc.username,document.getElementById("username").addEventListener("input",Vo),Lo=document.getElementById("shop-screen"),document.getElementById("btn-play").addEventListener("click",function(){if(!Tc){if(vc)return alert("There were errors loading game files, the page will reload and try again."),void window.location.reload();document.getElementById("btn-play").innerHTML='<div class="spinner black"><div></div></div>',document.getElementById("btn-play").style.pointerEvents="none",so(),_o(),Ce("ui_play")}}),document.getElementById("home-customize-btn-wrapper").addEventListener("click",Ao),document.getElementById("profile-customize-btn-wrapper").addEventListener("click",Ao),document.getElementById("shop-done-btn").addEventListener("click",function(){Ma(),fo(),Fo("home"),Za(),Ce("ui_settings")}),document.getElementById("shop-buy-btn")&&document.getElementById("shop-buy-btn").addEventListener("click",function(){-1!=eo&&qe&&qe[eo].toString().startsWith("$")?Ve?(document.getElementById("shop-buy-btn").classList.add("loading"),1001==eo&&Hn(4),1002==eo&&Hn(5),1003==eo&&Hn(6),1004==eo&&Hn(7)):Sn():-1!=eo&&qe&&qe[eo]>tn?Ra(!0):Do(3),Ce("ui_buy")}),document.getElementById("shop-close-preview-btn")&&document.getElementById("shop-close-preview-btn").addEventListener("click",function(){Ma(),Ca(),Do(0),Ce("ui_settings")}),document.getElementById("shop-purchase-cancel-btn")&&document.getElementById("shop-purchase-cancel-btn").addEventListener("click",function(){Do(2),Ce("ui_settings")}),document.getElementById("shop-purchase-confirm-btn")){var t=!1;document.getElementById("shop-purchase-confirm-btn").addEventListener("click",function(){t||(t=!0,function(t,e){if(He&&0!=He.length){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){var r=n.responseText.split("\n");"ERROR"==r[0]?alert(r[1]):(tn=parseFloat(r[1]),$e[t]=!0),e("ERROR"!=r[0])}else 4==n.readyState&&200!=n.status&&n.onerror(n.status)},n.onerror=function(t){pn((new Date).toLocaleTimeString()+" - Error buying item","error"),console.error("buying item error",t),e(!1)},n.open("GET","//"+w+"/buy-item?i="+t+"&s="+(He||""),!0),n.send(null)}else console.error("Can't buy without a session id")}(eo,function(e){if(t=!1,e){Do(0);let t="accessory-"+eo;document.getElementById(t).classList.add("unlocked"),Bo(eo),ja()}else Do(0),Ma();Ca()}),Ce("ui_buy"))})}document.getElementById("shop-preview-container")&&document.getElementById("shop-preview-container").addEventListener("click",Ya),document.getElementById("profile-back-btn").addEventListener("click",function(){fo(),Fo("home"),Za(),Ce("ui_settings")}),document.getElementById("home-screen-settings-btn").addEventListener("click",No),document.getElementById("profile-screen-settings-btn").addEventListener("click",No);try{(navigator.language.startsWith("ru")||navigator.language.startsWith("uk"))&&(document.getElementById("io-games-link").getElementsByTagName("a")[0].href="http://vseigru.net",document.getElementById("io-games-link").getElementsByTagName("a")[0].innerHTML="More Games")}catch(t){console.error(t)}(uo||co||-1!=window.location.search.indexOf("npb=1"))&&document.getElementById("io-games-link")&&(document.getElementById("io-games-link").style.display="none",po=!0),document.getElementById("death-screen-quit-btn").addEventListener("click",io),document.getElementById("death-screen-ready-btn").addEventListener("click",oo),document.getElementById("death-screen-resume-btn").addEventListener("click",mo),document.getElementById("death-screen-new-game-btn").addEventListener("click",ao),document.getElementById("death-screen-settings-btn").addEventListener("click",No),document.getElementById("end-match-quit-btn").addEventListener("click",io),document.getElementById("end-match-ready-btn")&&(document.getElementById("end-match-ready-btn").style.display="none"),document.getElementById("end-match-spectate-btn").addEventListener("click",oo),document.getElementById("end-match-new-game-btn").addEventListener("click",ao),document.getElementById("end-match-continue-btn")&&document.getElementById("end-match-continue-btn").addEventListener("click",Ta),document.getElementById("end-match-settings-btn").addEventListener("click",No),document.getElementById("match-earnings-account-incentive")&&document.getElementById("match-earnings-account-incentive").addEventListener("click",Sn),document.getElementById("mouse-sens-slider").value=Oc.mouseSensitivity,document.getElementById("screen-resolution-slider")&&(document.getElementById("screen-resolution-slider").value=Oc.screenResolution),document.getElementById("fov-slider").value=Oc.FOV,qo(),Yo(),document.getElementById("screen-resolution-slider")&&Xo(),document.querySelectorAll("#graphics-settings .graphics-option").forEach(function(t){t.onclick=function(){!function(t){Oc.graphicsQuality=t;try{localStorage.setItem("graphicsQuality",Oc.graphicsQuality)}catch(t){}Hc(!!bl&&bl.shadowMap.enabled)}(t.value)},t.checked=Oc.graphicsQuality==t.value}),document.querySelectorAll("#sound-settings .sound-option").forEach(function(t){t.onclick=function(){Qo("true"==t.value)}}),Qo(Oc.audioEnabled),document.getElementById("home-screen-mute-btn")&&document.getElementById("home-screen-mute-btn").addEventListener("click",function(){Qo(!Oc.audioEnabled)}),document.getElementById("profile-screen-mute-btn")&&document.getElementById("profile-screen-mute-btn").addEventListener("click",function(){Qo(!Oc.audioEnabled)}),document.querySelectorAll("#csp-settings .csp-option").forEach(function(t){t.onclick=function(){Zo(parseInt(t.value))},t.checked=parseInt(t.value)==Oc.cspEnabled}),Zo(Oc.cspEnabled),document.querySelectorAll("#csp-accuracy-settings .csp-accuracy-option").forEach(function(t){t.onclick=function(){Jo(parseInt(t.value))},t.checked=parseInt(t.value)==Oc.cspAccuracy}),Jo(Oc.cspAccuracy),document.getElementById("chat-enabled-settings")&&(It?(document.getElementById("chat-enabled-settings").style.display="none",document.querySelector("#settings-screen .tab3").style.display="none"):(document.querySelectorAll("#chat-enabled-settings input").forEach(function(t){t.onclick=function(){Ko("true"===t.value)},t.checked="true"===t.value==Oc.chatEnabled}),Ko(Oc.chatEnabled))),document.getElementById("settings-screen-done-btn").addEventListener("click",Uo),document.getElementById("mouse-sens-slider").addEventListener("input",qo),document.getElementById("fov-slider").addEventListener("input",Yo),document.getElementById("screen-resolution-slider")&&document.getElementById("screen-resolution-slider").addEventListener("input",Xo),document.getElementById("chat-input").onpaste=function(t){t.preventDefault()},function(){try{localStorage.getItem("keyBindings")&&(Vr=JSON.parse(localStorage.getItem("keyBindings")))}catch(t){}Qr();var t={movement:["moveforward","movebackwards","strafeleft","straferight","jump"],weapons:["shoot","nextweapon","previousweapon","rifle","rocketlauncher","shotgun","grenadelauncher","railgun","lifegun","flamethrower","meleeweapon"],other:["peekscores","chat","showmenu"]};for(var e in Ur){var n=document.createElement("div");n.className="binding";var r=Ur[e].replace(/ /g,"").toLowerCase();n.id="binding-"+r;var i=document.createElement("div");i.className="name",i.innerHTML=Ur[e],n.appendChild(i);var o=document.createElement("div");o.className="value",n.appendChild(o);var a=document.createElement("kbd");o.appendChild(a);var s=document.createElement("div");s.className="value",n.appendChild(s);var l=document.createElement("kbd");for(var c in s.appendChild(l),t)if(-1!==t[c].indexOf(r))var u=document.getElementById(c+"-bindings-wrapper");u.appendChild(n);var p=Vr[e];a.innerHTML=ta(p[0])||"&nbsp;",l.innerHTML=ta(p[1])||"&nbsp;",p.length>=0&&p[0].canNotChange?a.className="disabled":a.addEventListener("click",function(t,e,n){return function(){oa(t,e,0)}}(a,e),!1),l.addEventListener("click",function(t,e,n){return function(){oa(t,e,1)}}(l,e),!1),"CHAT"==e&&ua()}}(),It&&(document.body.classList.add("mobile"),document.getElementById("mobile-menu-button").addEventListener("click",function(){go(-1)})),ho(),w&&function(){if(Fe)return Fe.clearChoices(),void Fe._handleLoadingState(!0);Fe=new Choices(document.getElementById("region"),{placeholderValue:"Please wait...",loadingText:"Please wait...",searchEnabled:!1,itemSelectText:"",shouldSort:!1,callbackOnCreateTemplates:function(t){return this.config.classNames,this.config.itemSelectText,{item:function(e,n){return t('<div class="'+String(e.item)+" "+String(n.highlighted?e.highlightedState:e.itemSelectable)+'" data-item data-id="'+String(n.id)+'" data-value="'+String(n.value)+'" '+String(n.active?'aria-selected="true"':"")+" "+String(n.disabled?'aria-disabled="true"':"")+'><span class="region-label">Region: </span>'+String(n.label)+"</div>")},choice:function(e,n){return t('<div class="'+String(e.item)+" "+String(e.itemChoice)+" "+String(n.disabled?e.itemDisabled:e.itemSelectable)+'" data-choice '+String(n.disabled?'data-choice-disabled aria-disabled="true"':"data-choice-selectable")+' data-id="'+String(n.id)+'" data-value="'+String(n.value)+'"'+String(n.groupId>0?'role="treeitem"':'role="option"')+">"+String(n.label)+(void 0!==Ye[n.value]?'<span class="ping">'+String(Ye[n.value])+" ms</span>":"")+"</div>")}}}}),document.getElementById("region").addEventListener("choice",function(t){Ue=t.detail.choice.value}),Ie||Fe._handleLoadingState(!0),document.getElementById("server-block").classList.add("visible"),Pe&&Object.keys(Pe).length>0&&dn()}(),function(){let t=document.getElementById("color-tabs");for(let e=0;e<t.children.length;e++)t.children[e].addEventListener("click",function(){setTimeout(function(){ko(!0)},0),ro||Ce("ui_custom")});document.getElementById("close-account-warning")&&document.getElementById("close-account-warning").addEventListener("click",function(){this.parentElement.classList.remove("visible")}),document.getElementById("bundles-close-button")&&document.getElementById("bundles-close-button").addEventListener("click",function(){Ra(!1)}),document.getElementById("bundles-tab")&&document.getElementById("bundles-tab").addEventListener("click",function(){Ra(!0)}),document.getElementById("coins-plus-button")&&document.getElementById("coins-plus-button").addEventListener("click",function(){Ra(!0)}),document.getElementById("bundle-1-buy-button")&&document.getElementById("bundle-1-buy-button").addEventListener("click",function(){Ve?(Hn(0),document.getElementById("bundle-1-buy-button").classList.add("loading")):Sn()}),document.getElementById("bundle-2-buy-button")&&document.getElementById("bundle-2-buy-button").addEventListener("click",function(){Ve?(Hn(1),document.getElementById("bundle-2-buy-button").classList.add("loading")):Sn()}),document.getElementById("bundle-3-buy-button")&&document.getElementById("bundle-3-buy-button").addEventListener("click",function(){Ve?(Hn(2),document.getElementById("bundle-3-buy-button").classList.add("loading")):Sn()}),document.getElementById("bundle-4-buy-button")&&document.getElementById("bundle-4-buy-button").addEventListener("click",function(){Ve?(Hn(3),document.getElementById("bundle-4-buy-button").classList.add("loading")):Sn()}),document.getElementById("category-1-tab-input").addEventListener("change",function(){Ma(),Do(0),Ca(),Ce("ui_custom")}),document.getElementById("category-2-tab-input").addEventListener("change",function(){Ma(),Do(0),Ca(),Ce("ui_custom")}),document.getElementById("category-3-tab-input")&&document.getElementById("category-3-tab-input").addEventListener("change",function(){Ma(),Do(0),Ca(),Ce("ui_custom")})}(),window.addEventListener("gamepadconnected",function(){Ai(),kt("Gamepad connected")}),window.addEventListener("gamepaddisconnected",function(){Ai(),kt("Gamepad disconnected")})}(),fo(),Gc(),function(){if(w&&document.getElementById("party-copy-btn")){if(window.location&&window.location.hash)if(6==window.location.hash.length||7==window.location.hash.length&&0===window.location.hash.indexOf("#")){sn=0===window.location.hash.indexOf("#")?window.location.hash.substr(1):window.location.hash;try{localStorage.getItem("partyKey")===sn&&localStorage.getItem("partyHostKey")&&(ln=localStorage.getItem("partyHostKey"))}catch(t){}Ln(!0,sn,ln)}else Dn();else if($l){var t=new RegExp("[?&]roomId=([^&#]*)","i").exec(window.location.href);if(t){sn=t[1];try{localStorage.getItem("partyKey")===sn&&localStorage.getItem("partyHostKey")&&(ln=localStorage.getItem("partyHostKey"))}catch(t){}Ln(!0,sn,ln)}}var e;document.getElementById("party-leave-button").addEventListener("click",Dn),document.getElementById("party-copy-btn").addEventListener("click",function(){document.getElementById("party-share-link").select(),document.execCommand("copy");var t=document.getElementById("party-copy-confirm");t.style.display="block",t.style.opacity=1,e&&e.pause(),e=anime({targets:t,delay:3e3,duration:500,opacity:0,easing:"linear",complete:function(){t.style.display="none"}})}),document.getElementById("username").addEventListener("input",kn),document.getElementById("party-chat-input").addEventListener("keyup",function(t){var e;13==t.keyCode&&((e=document.getElementById("party-chat-input").value)&&0!=e.length&&(e==Cn&&Date.now()-Bn<1e3?(alert("Why the spam :("),Bn=Date.now()):(Cn=e,Bn=Date.now(),an&&an.send("t "+encodeURIComponent(e)))),document.getElementById("party-chat-input").value="")}),document.getElementById("party-create-button").addEventListener("click",function(){sn||an||(Ln(!1),Ce("ui_done"))})}}()}function Uc(t,e,n,r,i){Ic++,t.load(n,function(t){t.scene&&t.scene.children.length>0?mc[e]=t.scene:mc[e]=t,t.animations&&(mc[e].animations=t.animations);var n=mc[e];n.geometry&&n.geometry.computeBoundingBox(),"function"==typeof r&&r(e,t),Pc++,Vc()},i,function(t){console.error("Error loading asset",e,n,t)})}function Vc(){document.getElementById("loading-progress-bar-value").style.width=Pc/Ic*100+"%"}function Gc(){if(mc["character-anims"]=mc.character,mc.character&&mc["character-anims"]&&mc["chara-tex-0-decal"]&&!Gl&&(Al=mc.character.getObjectByName("SM_Character"),mc["chara-tex-0-bc"]=Al.material.map,Gl={idle:Bt(mc["character-anims"],"Breathing_Idle"),run:Bt(mc["character-anims"],"Running_A"),jumpLoop:Bt(mc["character-anims"],"Fall_Loop"),fall:Bt(mc["character-anims"],"Falling")},nt))for(var t in Gl)if(Gl[t])for(var e=Gl[t].tracks.length-1;e>=0;e--){var n=Gl[t].tracks[e],r=n.getValueSize(),i=[];for(let t=0;t<r;t++)i[t]=n.values[t];var o=!1;t:for(let t=r;t<n.values.length;t+=r)for(let e=0;e<r;e++)if(n.values[t+e]!=i[e]){o=!0;break t}o&&!n.name.endsWith(".scale")||Gl[t].tracks.splice(e,1)}mc.character&&mc["character-anims"]&&function t(e){if(mc.character&&"complete"==document.readyState&&Gl){var n=document.getElementById("home-preview-container"),r=n.offsetWidth;if(!r)return console.error("Unable to get previewContainer width, aborting initSkinPreview",n.offsetWidth,window.innerWidth,window.innerHeight),0==qa&&(qa=Date.now()),void(Date.now()-qa<1e4&&setTimeout(function(){t(e)},200));var i=Math.round(r/200*300),o=Aa=new THREE.WebGLRenderer({antialias:Oc.graphicsQuality>=2,alpha:!0,preserveDrawingBuffer:pt});o.setPixelRatio(window.devicePixelRatio*(Oc.graphicsQuality>=3?2:1)),o.setSize(r,i),o.domElement.style.width=r+"px",o.domElement.style.height=i+"px",o.gammaFactor=2.2,o.outputEncoding=THREE.sRGBEncoding,o.domElement.style.maxWidth="initial",o.domElement.style.maxHeight="initial",o.domElement.id="animated-skin-preview",n.insertBefore(o.domElement,n.firstChild);var a=new THREE.PerspectiveCamera(60,r/i,.1,10);a.rotation.order="YXZ",a.position.set(0,1.02,1.75),a.lookAt(0,1.02,0),La=a;var s=new THREE.Scene;Ia=s;var l=(new THREE.AmbientLight).copy(wl);l.intensity=.85,s.add(l);var c,u,p,d=new THREE.DirectionalLight(16777215,.5);d.name="sun",d.position.set(10,30,10),d.shadow.camera.left=-50,d.shadow.camera.right=50,d.shadow.camera.top=50,d.shadow.camera.bottom=-50,d.shadow.camera.near=10,d.shadow.camera.far=100,d.target.name="sun.target",s.add(d),s.add(d.target),s.add(a),c&&s.remove(c),kc.playerTexture>=0?kc.playerTexture:Oc.playerTexture,(c=THREE.SkeletonUtils.clone(mc.character)).position.set(0,0,-.2),s.add(c),(u=c.getObjectByName("SM_Character")).material=u.material.clone(),u.skeleton,Pa=u,(p=new THREE.AnimationMixer(c)).clipAction(Gl.idle).play();var h=-1,f=-1,m=-1,y=0,_=-1;MainLoop.setDraw(function(){var t={};t.playerTexture=kc.playerTexture>=0?kc.playerTexture:Oc.playerTexture,t.playerHat=kc.playerHat>=0?kc.playerHat:Oc.playerHat,!u||Oc.playerColor==h&&Oc.playerColor2==f&&Oc.playerColor3==m&&t.playerTexture==y&&t.playerHat==_||(1004!=t.playerTexture&&1004==y&&(u.geometry=Yt(mc.character).geometry),h=Oc.playerColor,f=Oc.playerColor2,m=Oc.playerColor3,y=t.playerTexture,_=t.playerHat,rs({skinnedMesh:u},t.playerTexture,Oc.playerColor,Oc.playerColor2,Oc.playerColor3,t.playerHat,function(){Pa.boundingBox=(new THREE.Box3).setFromObject(Pa),Qa()}));var e=kr.getDelta();p.update(e),Ir(),o.render(s,a)}),MainLoop.start(),Za(),"function"==typeof e&&e()}}(function(){document.getElementById("home-customize-btn-wrapper").style.display="flex";let t=document.getElementsByClassName("my-account-button");for(let e=0;e<t.length;e++)t[e].style.pointerEvents="auto";"?skin-tester"===window.location.search&&Ao(),window.location.search.match(/\?user_id=\d+&status=/)&&(history.replaceState("",document.title,window.location.pathname),Ao())})}function Wc(){gc||(gc=!0,Si=new THREE.Sprite(new THREE.SpriteMaterial({map:mc.joystick,color:"black",opacity:.3,depthTest:!1})),Ti=new THREE.Sprite(new THREE.SpriteMaterial({map:mc.joystick,color:"black",opacity:.1,depthTest:!1})),Si.visible=!1,Ti.visible=!1,It&&(_l.add(Si),_l.add(Ti)),Gt=new function(){var t=new Nebula.default;this.system=t,dt&&(console.log("debrisSystem",t),t.eventDispatcher.addEventListener("PARTICLE_CREATED",function(t){console.log(t)})),t.addRenderer(new Nebula.SpriteRenderer(vl,THREE)),this.addEmitter=function(e){dt&&console.log("adding emitter",e),t.addEmitter(e)},this.removeEmitter=function(e){dt&&console.log("removing emitter",e),t.removeEmitter(e)},this.update=function(e){t.emitters.length>0&&-1==t.emitters[0].totalEmitTimes&&0==t.emitters[0].particles.length&&(dt&&console.log("removing dead emitter",t.emitters[0]),t.removeEmitter(t.emitters[0])),t.update(e)}},Wt=new function(){this.emitters=[],this.addEmitter=function(t){if(dt&&console.log("adding emitter",t),Array.isArray(t))for(var e=t.length-1;e>=0;e--)t[e].initialize(vl),this.emitters.push(t[e]);else t.initialize(vl),this.emitters.push(t)},this.removeEmitter=function(t){dt&&console.log("removing emitter",t);var e=this.emitters.indexOf(t);-1!=e&&this.emitters.splice(e,1),t.destroy()},this.update=function(t){for(let t=this.emitters.length-1;t>=0;t--)this.emitters[t].emitterAlive||(dt&&console.log("removing dead emitter",this.emitters[t]),this.emitters[t].destroy(),this.emitters.splice(t,1));for(let e=0;e<this.emitters.length;e++)this.emitters[e].update(t)}},ha=new v.btVector3,fa=new v.btQuaternion,ma=new v.btVector3,_a=[],ya=[],ga=[],va=[],ba=[],ct&&Oc.audioEnabled&&Ee(),"?autoplay"===window.location.search&&document.getElementById("btn-play").click(),"?observer"===window.location.search&&(yc=!0),w?fn():Tc&&so(),document.getElementById("loading-progress-bar").style.display="none")}function qc(){mc["next-map"]?(console.log("Switching to next map",Jl),Kl&&(document.body.removeChild(Kl),Kl=null),xc=!1,El.traverse(function(t){t.geometry&&t.geometry.dispose(),t.material&&t.material.map&&t.material.map.dispose(),"function"==typeof t.dispose&&t.dispose()}),Tl.traverse(function(t){t.geometry&&t.geometry.dispose(),t.material&&t.material.map&&t.material.map.dispose(),"function"==typeof t.dispose&&t.dispose()}),vl.remove(El),function(){for(var t=0;t<Us.length;t++)Tl.remove(Us[t]);Us=[],Ns={}}(),Tl.children=[],function(){for(var t=ls.length-1;t>=0;t--){var e=ls[t].object;Hl.removeRigidBody(e.ammoBody);var n=e.ammoBody.getMotionState();n&&v.destroy(n),Qs(e.ammoBody),v.destroy(e.ammoBody),delete e.ammoBody,e instanceof Gs||Tl.remove(e)}for(t=ic.length-1;t>=0;t--){var r=ic[t];r.threeObject.isObject&&(e=r.threeObject,Bs(r.threeObject))}for(var i in us)us[i].removeAll();us={},ls=[],cs={}}(),function(){for(let e=0;e<sc.length;e++){let n=sc[e].threeObject;if(n.ammoBody){Hl.removeRigidBody(n.ammoBody);var t=n.ammoBody.getMotionState();t&&v.destroy(t),Qs(n.ammoBody),v.destroy(n.ammoBody),delete n.ammoBody}}sc=[]}(),mc.map=mc["next-map"],delete mc["next-map"],Zl=Jl,Xc()):console.error("Invalid request to switch to next map, no map loaded")}function Xc(){if(El&&-1!==vl.children.indexOf(El))console.error("onMapLoaded executed with a previous map (call ignored)");else{bc=!1,(Sl=mc.skydome).parent||(Sl.name="skydome",(zl=Sl.getObjectByName("Ground")).material=new THREE.MeshBasicMaterial({vertexColors:zl.material.vertexColors,map:zl.material.map,alphaMap:zl.material.alphaMap}),vl.add(Sl),jl=zl.geometry.boundingBox.min.x,Cl=zl.geometry.boundingBox.max.x,(Ml=mc.clouds).updateMatrixWorld(!0),(Rl=new THREE.Group).name="clouds",vl.add(Rl),Ys(Ml,Rl)),(El=mc.map).name="map",function t(e,n,r){e.castShadow=n,e.receiveShadow=r;for(var i=0;i<e.children.length;i++)t(e.children[i],n,r)}(El,!0,!0),vl.add(El),ec=new Set;var t=new Set;El.traverse(function(e){e.material&&(ec.add(e.material),e.material.map||t.add(e.material))}),-1===Zl.indexOf("BoulderHill")&&-1===Zl.indexOf("SillySlide")&&-1===Zl.indexOf("RiskyCliffs")&&-1===Zl.indexOf("MillValley")&&-1===Zl.indexOf("KittieKegs")&&-1===Zl.indexOf("HammerVille")&&-1===Zl.indexOf("TumbleTown")&&-1===Zl.indexOf("TrickyTraps")&&-1===Zl.indexOf("SpikySlopes")&&-1===Zl.indexOf("RicketyRun")&&t.forEach(function(t){t.color.convertSRGBToLinear()});var e=(new THREE.Box3).setFromObject(El);if(El.position.x=-(e.max.x+e.min.x)/2,El.position.z=-(e.max.z+e.min.z)/2,El.updateMatrixWorld(!0),El.matrixAutoUpdate=!1,El.traverseAncestors(function(t){t.matrixAutoUpdate=!1}),bl.shadowMap.needsUpdate=!0,_t){Ql=new v.btTriangleMesh,$s(El,Ql);var r=new v.btBvhTriangleMeshShape(Ql,!0,!0),a=new v.btTransform;a.setIdentity();var s=new v.btDefaultMotionState(a),l=new v.btVector3(0,0,0),c=new v.btRigidBodyConstructionInfo(0,s,r,l);c.set_m_friction(N);var u=new v.btRigidBody(c);v.destroy(c),Hl.addRigidBody(u,W,X|Y|Q);let t=new v.btTriangleInfoMap;t.m_equalVertexThreshold=Math.pow(1,2),t.generateInternalEdgeInfo(r),u.setCollisionFlags(8|u.getCollisionFlags()),u.threeObject={}}else!function(t){Hs||(Hs=new v.btTransform),Fs||(Fs=new v.btVector3),Sc={},Vs=!1,$s(t),Js.clear()}(El);Ys(El),function t(e){for(var n=e.children.length-1;n>=0;n--)t(e.children[n]);0==e.children.length&&(e instanceof THREE.Group||"Object3D"==e.constructor.name)&&e.parent.remove(e)}(El),El.traverse(function(t){t.matrixAutoUpdate=!1}),(new THREE.Group).name="lights";for(var p=ec.length-1;p>=0;p--)ec[p].side=THREE.FrontSide;(function(){for(var t=rl.length-1;t>=0;t--)rl[t].pause();if(rl=[],il={},al&&al.emitter&&(al.emitter.stopEmit(),al=null),nl=Sl.children[0].geometry,-1!==Zl.indexOf("MillValley")){var e=El.getObjectByName("Water_Collider_None");e&&rl.push(anime({targets:e.material.map.offset,x:[0,1],duration:500,loop:!0,easing:"linear"}))}if(-1!==Zl.indexOf("GravityGates")){Sl.visible=!1,Rl.visible=!1,vl.fog&&(vl.fog=null);let t=vl.getObjectByName("StarrySkydome");t.material=new THREE.MeshBasicMaterial({map:t.material.map})}else if(-1!==Zl.indexOf("FastRace")){Sl.visible=!1,Rl.visible=!1,vl.fog&&(vl.fog=null);let t=vl.getObjectByName("GROUND_MergeMeshes_Collider_None");t.material.emissiveMap=t.material.map,t.material.emissive.set(13421772);let e=vl.getObjectByName("BoosterRing_MergeMeshes");e.material.emissiveMap=e.material.map,e.material.emissive.set(8947848);let n=vl.getObjectByName("SM_Deco_Arche_2x15x30_Collider_None");n.material.emissiveMap=n.material.map,n.material.emissive.set(4473924);let r=vl.getObjectByName("SM_Deco_Trophy_MergeMeshes_Collider_None");r.material.emissiveMap=r.material.map,r.material.emissive.set(4473924);let i=vl.getObjectByName("BoosterPad_MergeMeshes_Collider_Compound");if(i){let t=i.material;t.emissiveMap=t.map,t.emissive.set(8947848),rl.push(anime({targets:t.map.offset,y:[0,5],duration:5e3,loop:!0,easing:"linear"}))}}else if(-1!==Zl.indexOf("MonsterManor")){Sl.visible=!0,Rl.visible=!0,vl.fog&&(vl.fog=null),tl?ll():tl=nl.getAttribute("color").clone(),el||(el=Sl.children[1].material.map);let t=vl.getObjectByName("SkydomeTexture_Collider_None");Sl.children[1].material.map=t.material.map,t.visible=!1;let e=.525,n=210/360,r=[[{h:.08,s:0,l:-.01},{h:-.5,s:0,l:0},{h:-.2,s:-.2,l:-.3}],[{h:-.4,s:-.1,l:-.05},{h:-.3,s:-.15,l:0},{h:-.65,s:-.2,l:-.3}],[{h:-.1,s:-.7,l:0},{h:-.56,s:0,l:0},{h:.45,s:.3,l:-.3}]],i=r[Math.floor(Math.random()*r.length)],o=Sl.children[0].geometry.getAttribute("color"),a=new THREE.Color,s={};for(let t=0;t<o.count;t++)a.setRGB(o.getX(t),o.getY(t),o.getZ(t)),a.getHSL(s),s.h<=e?a.offsetHSL(i[0].h,i[0].s,i[0].l):s.h>e&&s.h<n?a.offsetHSL(i[1].h,i[1].s,i[1].l):a.offsetHSL(i[2].h,i[2].s,i[2].l),o.setXYZ(t,a.r,a.g,a.b);o.needsUpdate=!0;let l=vl.getObjectByName("BoosterPad_MergeMeshes_Collider_Compound");if(l){let t=l.material;t.emissiveMap=t.map,t.emissive.set(8947848),rl.push(anime({targets:t.map.offset,y:[0,5],duration:5e3,loop:!0,easing:"linear"}))}if(cl(vl.getObjectByName("Grass2_MergeMeshes_Collider_None")),cl(vl.getObjectByName("Grass1_MergeMeshes_Collider_None")),Math.random()<.5){let t=new THREE.Fog(12320699,.1,1500);vl.fog=t}}else ll(),Sl&&el&&(Sl.children[1].material.map=el),vl.fog&&(vl.fog=null),Sl.visible=!0,Rl.visible=!0;if(-1!==Zl.indexOf("SharkPark")){var r=vl.getObjectByName("WaterSlideSuperior_Collider_None"),a=vl.getObjectByName("WaterSlide_Collider_None"),s=vl.getObjectByName("WaterSuperior_Collider_None"),l=vl.getObjectByName("Water_Collider_None"),c=vl.getObjectByName("WaterStillSuperior_Collider_None"),u=vl.getObjectByName("WaterStill_Collider_None"),p=vl.getObjectByName("TearsSuperior_Collider_None"),d=vl.getObjectByName("Tears_Collider_None");d.material=new THREE.MeshBasicMaterial({map:d.material.map,opacity:1,transparent:!0}),p.material=new THREE.MeshBasicMaterial({map:p.material.map,transparent:!0}),a.material=new THREE.MeshBasicMaterial({map:a.material.map,opacity:.8,transparent:!0}),r.material=new THREE.MeshBasicMaterial({map:r.material.map,transparent:!0}),l.material=new THREE.MeshBasicMaterial({map:l.material.map,opacity:.8,transparent:!0}),s.material=new THREE.MeshBasicMaterial({map:s.material.map,transparent:!0}),u.material=new THREE.MeshBasicMaterial({map:u.material.map,opacity:u.material.opacity,transparent:!0}),c.material=new THREE.MeshBasicMaterial({map:c.material.map,opacity:c.material.opacity,transparent:!0}),r.renderOrder=1,s.renderOrder=1,c.renderOrder=1,p.renderOrder=1,rl.push(anime({targets:vl.getObjectByName("Water_Collider_None").material.map.offset,y:[0,-1],duration:800,loop:!0,easing:"linear"})),rl.push(anime({targets:vl.getObjectByName("WaterSuperior_Collider_None").material.map.offset,y:[0,-1],duration:1e3,loop:!0,easing:"linear"})),rl.push(anime({targets:vl.getObjectByName("WaterStill_Collider_None").material.map.offset,x:[0,.03],duration:750,direction:"alternate",loop:!0,easing:"easeInOutSine"})),setTimeout(function(){rl.push(anime({targets:vl.getObjectByName("WaterStillSuperior_Collider_None").material.map.offset,x:[0,.03],duration:750,direction:"alternate",loop:!0,easing:"easeInOutSine"}))},50)}if(-1!==Zl.indexOf("SpikySlopes")){let t=vl.getObjectByName("RailbarLow2_Collider_Compound_mergemeshes");if(t&&t.material){let e=t.material;rl.push(anime({targets:e.map.offset,x:[1,0],duration:700,loop:!0,easing:"linear"}))}}if(-1!==Zl.indexOf("KittieKegs")){let t=vl.getObjectByName("Torii_Beams_Collider_None_mergemeshes"),e=vl.getObjectByName("ToriiAO");if(t&&t.material&&e&&e.children[1]&&e.children[1].material){let n=e.children[1].material.map;t.geometry.attributes.uv2=t.geometry.attributes.uv,t.material.aoMap=n,t.material.aoMapIntensity=1.5,t.material.needsUpdate=!0}e.parent.remove(e)}if(-1!==Zl.indexOf("DevilsTrick")){var h=vl.getObjectByName("Spiral").getObjectByName("Floor_MergeMeshes").material;h.transparent=!0,h.opacity=.6}if(-1===Zl.indexOf("RedLightGreenLight")&&-1===Zl.indexOf("NastySeals")||(El.traverse(t=>{t.name.startsWith("DollHead")?(il.redGreenLightHead=t,t.matrixAutoUpdate=!0):t.name.startsWith("DollArm_Left")?(il.redGreenLightLeftArm=t,t.matrixAutoUpdate=!0):t.name.startsWith("DollArm_Right")?(il.redGreenLightRightArm=t,t.matrixAutoUpdate=!0):t.name.startsWith("DollRedEyes")&&(il.redGreenRedEyes=t)}),il.redGreenLightHead.rotation.z=0,il.redGreenLightLeftArm.rotation.y=0,il.redGreenLightRightArm.rotation.y=0,il.redGreenRedEyes.visible=!1),-1!==Zl.indexOf("NastySeals")){let t=Tl.getObjectByName("TriggerBeam_ActionSensor_Collider_Box");t&&(t.material.transparent=!0,t.material.opacity=.5),il.Trigger_R_Feedback=El.getObjectByName("Trigger_R_Feedback_Collider_None"),il.Trigger_R_Feedback.visible=!1,il.Trigger_L_Feedback=El.getObjectByName("Trigger_L_Feedback_Collider_None"),il.Trigger_L_Feedback.visible=!1;let e=El.getObjectByName("FlippingMarkerA_MergeMeshes_Collider_Compound");e.material.transparent=!0,e.material.opacity=.5,e.material.blending=THREE.AdditiveBlending}if(-1!==Zl.indexOf("FloorIsLava")){Sl.children[1].visible=!1,(al=Ws("Z_UP@SketchUp@Geysers@Geyser03@LavaGeyserV2_MergeMeshes_Collider_Compound"))&&al.mesh&&(al=al.mesh);var f=(new THREE.TextureLoader).load("vfx/lava-drops.png"),m=[];for(let t=0;t<al.count*ol;t++)m.push(new THREE.Vector3);al.positionArray=m;var y=Ht("#f8f800"),_=Ht("#fd5052"),g=new o({particleTexture:f,blendStyle:THREE.AdditiveBlending,positionStyle:i.SPHERE,positionRadius:.3,positionBaseArray:al.positionArray,velocityStyle:i.CUBE,velocityBase:function(){let t=al.velocities[Math.floor(this.positionBaseArrayIndex/ol)];return new THREE.Vector3(4*(Math.random()-.5),12+(t?25*t.y:0),4*(Math.random()-.5))},accelerationBase:new THREE.Vector3(0,-30,0),sizeTween:function(){return new n([0,1],[1.5,1])},opacityTween:new n([0,.15,.85,1],[0,1,1,0]),sizeBase:1.5,particleDeathAge:1,opacityBase:0,colorBase:y,colorTween:new n([0,1],[y,_]),angleSpread:360,angleBase:0,angleVelocityBase:0,angleVelocitySpread:120,particlesPerSecond:180,emitterDeathAge:0,emitterStopEmitAge:0});Wt.addEmitter(g),al.emitter=g,rl.push(anime({targets:al.material.map.offset,y:[0,-3],duration:1e4,loop:!0,easing:"linear"})),al.material.emissiveMap=al.material.map,al.material.emissive=new THREE.Color(16777215),al.material.needsUpdate=!0;var v=vl.getObjectByName("GeyserHead_MergeMeshes_Collider_Compound");v.material.blending=THREE.AdditiveBlending,v.material.transparent=!0;let t=vl.getObjectByName("IncandescentGridTransparent_Collider_None").material;t&&(t.transparent=!0),vl.getObjectByName("GridTransparent_Collider_None").material.transparent=!0;let e=El.getObjectByName("LavaStatic_MergeMeshes");rl.push(anime({targets:e.material.map.offset,y:[0,-1],duration:1e4,loop:!0,easing:"linear"})),al.velocities=[],al.previousPositions=[];for(let t=0;t<al.count;t++)al.velocities[t]=new THREE.Vector3}else Sl.children[1].visible=!0})(),delete _l.currentGravityQuaternion,delete _l.targetGravityQuaternion,delete _l.interpLastPosition,_l.quaternion.set(0,0,0,1),_l.up=THREE.Object3D.DefaultUp,-1!==Zl.indexOf("SillySlide")?(_l.position.set(0,75,310),_l.lookAt(0,0,0)):-1!==Zl.indexOf("BoulderHill")?(_l.position.set(5,20,220),_l.lookAt(5,0,0)):-1!==Zl.indexOf("RiskyCliffs")?(_l.position.set(-2,90,190),_l.lookAt(-2,0,0)):-1!==Zl.indexOf("HammerVille")?(_l.position.set(0,120,190),_l.lookAt(0,-50,0)):-1!==Zl.indexOf("RicketyRun")?(_l.position.set(7,90,230),_l.lookAt(7,-150,0)):-1!==Zl.indexOf("TumbleTown")?(_l.position.set(7,28,230),_l.lookAt(7,0,0)):-1!==Zl.indexOf("SpikySlopes")?(_l.position.set(-5,85,160),_l.lookAt(-5,0,0)):-1!==Zl.indexOf("TrickyTraps")?(_l.position.set(0,100,120),_l.lookAt(0,30,0)):-1!==Zl.indexOf("MillValley")?(_l.position.set(0,100,120),_l.lookAt(0,10,0)):-1!==Zl.indexOf("DevilsTrick")?(_l.position.set(50,100,50),_l.lookAt(0,70,0)):-1!==Zl.indexOf("GravityGates")?(_l.position.set(32,73,101),_l.lookAt(-60,-.32,-.57)):-1!==Zl.indexOf("SharkPark")?(_l.position.set(0,65,-20),_l.lookAt(0,-40,-450)):-1!==Zl.indexOf("RedLightGreenLight")?(_l.position.set(0,360,275),_l.lookAt(0,300,0)):-1!==Zl.indexOf("NastySeals")?(_l.position.set(0,360,240),_l.lookAt(0,300,0)):-1!==Zl.indexOf("FloorIsLava")?(_l.position.set(-3,58,390),_l.lookAt(-3,45,300)):-1!==Zl.indexOf("FastRace")&&(_l.position.set(215,100,-200),_l.lookAt(0,80,-200))}}function Yc(t,e){bl.setSize(window.innerWidth,window.innerHeight),_l.aspect=window.innerWidth/window.innerHeight,_l.updateProjectionMatrix(),gl.aspect=window.innerWidth/window.innerHeight,gl.updateProjectionMatrix(),ho(),0==Kn&&Za();var n=window.innerWidth,r=window.innerHeight;e||setTimeout(function(){window.innerWidth==n&&window.innerHeight==r||Yc(t,!0)},50)}void 0===Oc.playerColor&&(Oc.playerColor=Math.floor(10*Math.random())),void 0===Oc.playerColor2&&(Oc.playerColor2=Math.floor(10*Math.random())),void 0===Oc.playerColor3&&(Oc.playerColor3=Math.floor(10*Math.random())),At=Oc.graphicsQuality>=2,"loading"!==document.readyState?Fc():document.addEventListener("DOMContentLoaded",Fc,!1),"complete"===document.readyState?Nc():document.addEventListener("readystatechange",function(){"complete"==document.readyState&&Nc()},!1);})();