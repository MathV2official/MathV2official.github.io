!function(t) {
    var e;
    "object" == typeof exports ? module.exports = t() : ("undefined" != typeof window ? e = window : "undefined" != typeof global ? e = global : "undefined" != typeof self && (e = self),
    e.p2 = t())
}(function() {
    return function n(r, o, a) {
        function h(e, t) {
            if (!o[e]) {
                if (!r[e]) {
                    var i = "function" == typeof require && require;
                    if (!t && i)
                        return i(e, !0);
                    if (l)
                        return l(e, !0);
                    throw new Error("Cannot find module '" + e + "'")
                }
                var s = o[e] = {
                    exports: {}
                };
                r[e][0].call(s.exports, function(t) {
                    return h(r[e][1][t] || t)
                }, s, s.exports, n, r, o, a)
            }
            return o[e].exports
        }
        for (var l = "function" == typeof require && require, t = 0; t < a.length; t++)
            h(a[t]);
        return h
    }({
        1: [function(t, e, i) {
            function s() {}
            var d = t("./Scalar");
            (e.exports = s).lineInt = function(t, e, i) {
                i = i || 0;
                var s, n, r, o, a, h, l, c = [0, 0];
                return s = t[1][1] - t[0][1],
                n = t[0][0] - t[1][0],
                r = s * t[0][0] + n * t[0][1],
                o = e[1][1] - e[0][1],
                a = e[0][0] - e[1][0],
                h = o * e[0][0] + a * e[0][1],
                l = s * a - o * n,
                d.eq(l, 0, i) || (c[0] = (a * r - n * h) / l,
                c[1] = (s * h - o * r) / l),
                c
            }
            ,
            s.segmentsIntersect = function(t, e, i, s) {
                var n = e[0] - t[0]
                  , r = e[1] - t[1]
                  , o = s[0] - i[0]
                  , a = s[1] - i[1];
                if (o * r - a * n == 0)
                    return !1;
                var h = (n * (i[1] - t[1]) + r * (t[0] - i[0])) / (o * r - a * n)
                  , l = (o * (t[1] - i[1]) + a * (i[0] - t[0])) / (a * n - o * r);
                return 0 <= h && h <= 1 && 0 <= l && l <= 1
            }
        }
        , {
            "./Scalar": 4
        }],
        2: [function(t, e, i) {
            function l() {}
            (e.exports = l).area = function(t, e, i) {
                return (e[0] - t[0]) * (i[1] - t[1]) - (i[0] - t[0]) * (e[1] - t[1])
            }
            ,
            l.left = function(t, e, i) {
                return 0 < l.area(t, e, i)
            }
            ,
            l.leftOn = function(t, e, i) {
                return 0 <= l.area(t, e, i)
            }
            ,
            l.right = function(t, e, i) {
                return l.area(t, e, i) < 0
            }
            ,
            l.rightOn = function(t, e, i) {
                return l.area(t, e, i) <= 0
            }
            ;
            var c = []
              , d = [];
            l.collinear = function(t, e, i, s) {
                if (s) {
                    var n = c
                      , r = d;
                    n[0] = e[0] - t[0],
                    n[1] = e[1] - t[1],
                    r[0] = i[0] - e[0],
                    r[1] = i[1] - e[1];
                    var o = n[0] * r[0] + n[1] * r[1]
                      , a = Math.sqrt(n[0] * n[0] + n[1] * n[1])
                      , h = Math.sqrt(r[0] * r[0] + r[1] * r[1]);
                    return Math.acos(o / (a * h)) < s
                }
                return 0 == l.area(t, e, i)
            }
            ,
            l.sqdist = function(t, e) {
                var i = e[0] - t[0]
                  , s = e[1] - t[1];
                return i * i + s * s
            }
        }
        , {}],
        3: [function(t, e, i) {
            function x() {
                this.vertices = []
            }
            function S(t, e, i, s, n) {
                n = n || 0;
                var r = e[1] - t[1]
                  , o = t[0] - e[0]
                  , a = r * t[0] + o * t[1]
                  , h = s[1] - i[1]
                  , l = i[0] - s[0]
                  , c = h * i[0] + l * i[1]
                  , d = r * l - h * o;
                return u.eq(d, 0, n) ? [0, 0] : [(l * a - o * c) / d, (r * c - h * a) / d]
            }
            var a = t("./Line")
              , T = t("./Point")
              , u = t("./Scalar");
            (e.exports = x).prototype.at = function(t) {
                var e = this.vertices
                  , i = e.length;
                return e[t < 0 ? t % i + i : t % i]
            }
            ,
            x.prototype.first = function() {
                return this.vertices[0]
            }
            ,
            x.prototype.last = function() {
                return this.vertices[this.vertices.length - 1]
            }
            ,
            x.prototype.clear = function() {
                this.vertices.length = 0
            }
            ,
            x.prototype.append = function(t, e, i) {
                if (void 0 === e)
                    throw new Error("From is not given!");
                if (void 0 === i)
                    throw new Error("To is not given!");
                if (i - 1 < e)
                    throw new Error("lol1");
                if (i > t.vertices.length)
                    throw new Error("lol2");
                if (e < 0)
                    throw new Error("lol3");
                for (var s = e; s < i; s++)
                    this.vertices.push(t.vertices[s])
            }
            ,
            x.prototype.makeCCW = function() {
                for (var t = 0, e = this.vertices, i = 1; i < this.vertices.length; ++i)
                    (e[i][1] < e[t][1] || e[i][1] == e[t][1] && e[i][0] > e[t][0]) && (t = i);
                T.left(this.at(t - 1), this.at(t), this.at(t + 1)) || this.reverse()
            }
            ,
            x.prototype.reverse = function() {
                for (var t = [], e = 0, i = this.vertices.length; e !== i; e++)
                    t.push(this.vertices.pop());
                this.vertices = t
            }
            ,
            x.prototype.isReflex = function(t) {
                return T.right(this.at(t - 1), this.at(t), this.at(t + 1))
            }
            ;
            var h = []
              , l = [];
            x.prototype.canSee = function(t, e) {
                var i, s, n = h, r = l;
                if (T.leftOn(this.at(t + 1), this.at(t), this.at(e)) && T.rightOn(this.at(t - 1), this.at(t), this.at(e)))
                    return !1;
                s = T.sqdist(this.at(t), this.at(e));
                for (var o = 0; o !== this.vertices.length; ++o)
                    if ((o + 1) % this.vertices.length !== t && o !== t && T.leftOn(this.at(t), this.at(e), this.at(o + 1)) && T.rightOn(this.at(t), this.at(e), this.at(o)) && (n[0] = this.at(t),
                    n[1] = this.at(e),
                    r[0] = this.at(o),
                    r[1] = this.at(o + 1),
                    i = a.lineInt(n, r),
                    T.sqdist(this.at(t), i) < s))
                        return !1;
                return !0
            }
            ,
            x.prototype.copy = function(t, e, i) {
                var s = i || new x;
                if (s.clear(),
                t < e)
                    for (var n = t; n <= e; n++)
                        s.vertices.push(this.vertices[n]);
                else {
                    for (n = 0; n <= e; n++)
                        s.vertices.push(this.vertices[n]);
                    for (n = t; n < this.vertices.length; n++)
                        s.vertices.push(this.vertices[n])
                }
                return s
            }
            ,
            x.prototype.getCutEdges = function() {
                for (var t = [], e = [], i = [], s = new x, n = Number.MAX_VALUE, r = 0; r < this.vertices.length; ++r)
                    if (this.isReflex(r))
                        for (var o = 0; o < this.vertices.length; ++o)
                            if (this.canSee(r, o)) {
                                e = this.copy(r, o, s).getCutEdges(),
                                i = this.copy(o, r, s).getCutEdges();
                                for (var a = 0; a < i.length; a++)
                                    e.push(i[a]);
                                e.length < n && (n = (t = e).length,
                                t.push([this.at(r), this.at(o)]))
                            }
                return t
            }
            ,
            x.prototype.decomp = function() {
                var t = this.getCutEdges();
                return 0 < t.length ? this.slice(t) : [this]
            }
            ,
            x.prototype.slice = function(t) {
                if (0 == t.length)
                    return [this];
                if (t instanceof Array && t.length && t[0]instanceof Array && 2 == t[0].length && t[0][0]instanceof Array) {
                    for (var e = [this], i = 0; i < t.length; i++)
                        for (var s = t[i], n = 0; n < e.length; n++) {
                            var r = e[n].slice(s);
                            if (r) {
                                e.splice(n, 1),
                                e.push(r[0], r[1]);
                                break
                            }
                        }
                    return e
                }
                s = t,
                i = this.vertices.indexOf(s[0]),
                n = this.vertices.indexOf(s[1]);
                return -1 != i && -1 != n && [this.copy(i, n), this.copy(n, i)]
            }
            ,
            x.prototype.isSimple = function() {
                for (var t = this.vertices, e = 0; e < t.length - 1; e++)
                    for (var i = 0; i < e - 1; i++)
                        if (a.segmentsIntersect(t[e], t[e + 1], t[i], t[i + 1]))
                            return !1;
                for (e = 1; e < t.length - 2; e++)
                    if (a.segmentsIntersect(t[0], t[t.length - 1], t[e], t[e + 1]))
                        return !1;
                return !0
            }
            ,
            x.prototype.quickDecomp = function(t, e, i, s, n, r) {
                n = n || 100,
                r = r || 0,
                s = s || 25,
                t = void 0 !== t ? t : [],
                e = e || [],
                i = i || [];
                var o = [0, 0]
                  , a = [0, 0]
                  , h = [0, 0]
                  , l = 0
                  , c = 0
                  , d = 0
                  , u = 0
                  , p = 0
                  , g = 0
                  , f = 0
                  , m = new x
                  , y = new x
                  , v = this
                  , _ = this.vertices;
                if (_.length < 3)
                    return t;
                if (++r > n)
                    return t;
                for (var b = 0; b < this.vertices.length; ++b)
                    if (v.isReflex(b)) {
                        e.push(v.vertices[b]),
                        l = c = Number.MAX_VALUE;
                        for (var w = 0; w < this.vertices.length; ++w)
                            T.left(v.at(b - 1), v.at(b), v.at(w)) && T.rightOn(v.at(b - 1), v.at(b), v.at(w - 1)) && (h = S(v.at(b - 1), v.at(b), v.at(w), v.at(w - 1)),
                            T.right(v.at(b + 1), v.at(b), h) && (d = T.sqdist(v.vertices[b], h)) < c && (c = d,
                            a = h,
                            g = w)),
                            T.left(v.at(b + 1), v.at(b), v.at(w + 1)) && T.rightOn(v.at(b + 1), v.at(b), v.at(w)) && (h = S(v.at(b + 1), v.at(b), v.at(w), v.at(w + 1)),
                            T.left(v.at(b - 1), v.at(b), h) && (d = T.sqdist(v.vertices[b], h)) < l && (l = d,
                            o = h,
                            p = w));
                        if (g == (p + 1) % this.vertices.length)
                            h[0] = (a[0] + o[0]) / 2,
                            h[1] = (a[1] + o[1]) / 2,
                            i.push(h),
                            b < p ? (m.append(v, b, p + 1),
                            m.vertices.push(h),
                            y.vertices.push(h),
                            0 != g && y.append(v, g, v.vertices.length),
                            y.append(v, 0, b + 1)) : (0 != b && m.append(v, b, v.vertices.length),
                            m.append(v, 0, p + 1),
                            m.vertices.push(h),
                            y.vertices.push(h),
                            y.append(v, g, b + 1));
                        else {
                            if (p < g && (p += this.vertices.length),
                            u = Number.MAX_VALUE,
                            p < g)
                                return t;
                            for (w = g; w <= p; ++w)
                                T.leftOn(v.at(b - 1), v.at(b), v.at(w)) && T.rightOn(v.at(b + 1), v.at(b), v.at(w)) && (d = T.sqdist(v.at(b), v.at(w))) < u && (u = d,
                                f = w % this.vertices.length);
                            b < f ? (m.append(v, b, f + 1),
                            0 != f && y.append(v, f, _.length),
                            y.append(v, 0, b + 1)) : (0 != b && m.append(v, b, _.length),
                            m.append(v, 0, f + 1),
                            y.append(v, f, b + 1))
                        }
                        return m.vertices.length < y.vertices.length ? (m.quickDecomp(t, e, i, s, n, r),
                        y.quickDecomp(t, e, i, s, n, r)) : (y.quickDecomp(t, e, i, s, n, r),
                        m.quickDecomp(t, e, i, s, n, r)),
                        t
                    }
                return t.push(this),
                t
            }
            ,
            x.prototype.removeCollinearPoints = function(t) {
                for (var e = 0, i = this.vertices.length - 1; 3 < this.vertices.length && 0 <= i; --i)
                    T.collinear(this.at(i - 1), this.at(i), this.at(i + 1), t) && (this.vertices.splice(i % this.vertices.length, 1),
                    i--,
                    e++);
                return e
            }
        }
        , {
            "./Line": 1,
            "./Point": 2,
            "./Scalar": 4
        }],
        4: [function(t, e, i) {
            function s() {}
            (e.exports = s).eq = function(t, e, i) {
                return i = i || 0,
                Math.abs(t - e) < i
            }
        }
        , {}],
        5: [function(t, e, i) {
            e.exports = {
                Polygon: t("./Polygon"),
                Point: t("./Point")
            }
        }
        , {
            "./Point": 2,
            "./Polygon": 3
        }],
        6: [function(t, e, i) {
            e.exports = {
                name: "p2",
                version: "0.7.0",
                description: "A JavaScript 2D physics engine.",
                author: "Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",
                keywords: ["p2.js", "p2", "physics", "engine", "2d"],
                main: "./src/p2.js",
                engines: {
                    node: "*"
                },
                repository: {
                    type: "git",
                    url: "https://github.com/schteppe/p2.js.git"
                },
                bugs: {
                    url: "https://github.com/schteppe/p2.js/issues"
                },
                licenses: [{
                    type: "MIT"
                }],
                devDependencies: {
                    grunt: "^0.4.5",
                    "grunt-contrib-jshint": "^0.11.2",
                    "grunt-contrib-nodeunit": "^0.4.1",
                    "grunt-contrib-uglify": "~0.4.0",
                    "grunt-contrib-watch": "~0.5.0",
                    "grunt-browserify": "~2.0.1",
                    "grunt-contrib-concat": "^0.4.0"
                },
                dependencies: {
                    "poly-decomp": "0.1.0"
                }
            }
        }
        , {}],
        7: [function(t, e, i) {
            function s(t) {
                this.lowerBound = p.create(),
                t && t.lowerBound && p.copy(this.lowerBound, t.lowerBound),
                this.upperBound = p.create(),
                t && t.upperBound && p.copy(this.upperBound, t.upperBound)
            }
            var p = t("../math/vec2");
            t("../utils/Utils"),
            e.exports = s;
            var g = p.create();
            s.prototype.setFromPoints = function(t, e, i, s) {
                var n = this.lowerBound
                  , r = this.upperBound;
                "number" != typeof i && (i = 0),
                0 !== i ? p.rotate(n, t[0], i) : p.copy(n, t[0]),
                p.copy(r, n);
                for (var o = Math.cos(i), a = Math.sin(i), h = 1; h < t.length; h++) {
                    var l = t[h];
                    if (0 !== i) {
                        var c = l[0]
                          , d = l[1];
                        g[0] = o * c - a * d,
                        g[1] = a * c + o * d,
                        l = g
                    }
                    for (var u = 0; u < 2; u++)
                        l[u] > r[u] && (r[u] = l[u]),
                        l[u] < n[u] && (n[u] = l[u])
                }
                e && (p.add(this.lowerBound, this.lowerBound, e),
                p.add(this.upperBound, this.upperBound, e)),
                s && (this.lowerBound[0] -= s,
                this.lowerBound[1] -= s,
                this.upperBound[0] += s,
                this.upperBound[1] += s)
            }
            ,
            s.prototype.copy = function(t) {
                p.copy(this.lowerBound, t.lowerBound),
                p.copy(this.upperBound, t.upperBound)
            }
            ,
            s.prototype.extend = function(t) {
                for (var e = 2; e--; ) {
                    var i = t.lowerBound[e];
                    this.lowerBound[e] > i && (this.lowerBound[e] = i);
                    var s = t.upperBound[e];
                    this.upperBound[e] < s && (this.upperBound[e] = s)
                }
            }
            ,
            s.prototype.overlaps = function(t) {
                var e = this.lowerBound
                  , i = this.upperBound
                  , s = t.lowerBound
                  , n = t.upperBound;
                return (s[0] <= i[0] && i[0] <= n[0] || e[0] <= n[0] && n[0] <= i[0]) && (s[1] <= i[1] && i[1] <= n[1] || e[1] <= n[1] && n[1] <= i[1])
            }
            ,
            s.prototype.containsPoint = function(t) {
                var e = this.lowerBound
                  , i = this.upperBound;
                return e[0] <= t[0] && t[0] <= i[0] && e[1] <= t[1] && t[1] <= i[1]
            }
            ,
            s.prototype.overlapsRay = function(t) {
                var e = 1 / t.direction[0]
                  , i = 1 / t.direction[1]
                  , s = (this.lowerBound[0] - t.from[0]) * e
                  , n = (this.upperBound[0] - t.from[0]) * e
                  , r = (this.lowerBound[1] - t.from[1]) * i
                  , o = (this.upperBound[1] - t.from[1]) * i
                  , a = Math.max(Math.max(Math.min(s, n), Math.min(r, o)))
                  , h = Math.min(Math.min(Math.max(s, n), Math.max(r, o)));
                return h < 0 ? -1 : h < a ? -1 : a
            }
        }
        , {
            "../math/vec2": 30,
            "../utils/Utils": 57
        }],
        8: [function(t, e, i) {
            function s(t) {
                this.type = t,
                this.result = [],
                this.world = null,
                this.boundingVolumeType = s.AABB
            }
            var n = t("../math/vec2")
              , r = t("../objects/Body");
            (e.exports = s).AABB = 1,
            s.BOUNDING_CIRCLE = 2,
            s.prototype.setWorld = function(t) {
                this.world = t
            }
            ,
            s.prototype.getCollisionPairs = function(t) {}
            ;
            var o = n.create();
            s.boundingRadiusCheck = function(t, e) {
                n.sub(o, t.position, e.position);
                var i = n.squaredLength(o)
                  , s = t.boundingRadius + e.boundingRadius;
                return i <= s * s
            }
            ,
            s.aabbCheck = function(t, e) {
                return t.getAABB().overlaps(e.getAABB())
            }
            ,
            s.prototype.boundingVolumeCheck = function(t, e) {
                var i;
                switch (this.boundingVolumeType) {
                case s.BOUNDING_CIRCLE:
                    i = s.boundingRadiusCheck(t, e);
                    break;
                case s.AABB:
                    i = s.aabbCheck(t, e);
                    break;
                default:
                    throw new Error("Bounding volume type not recognized: " + this.boundingVolumeType)
                }
                return i
            }
            ,
            s.canCollide = function(t, e) {
                var i = r.KINEMATIC
                  , s = r.STATIC;
                return !(t.type === s && e.type === s || t.type === i && e.type === s || t.type === s && e.type === i || t.type === i && e.type === i || t.sleepState === r.SLEEPING && e.sleepState === r.SLEEPING || t.sleepState === r.SLEEPING && e.type === s || e.sleepState === r.SLEEPING && t.type === s)
            }
            ,
            s.NAIVE = 1,
            s.SAP = 2
        }
        , {
            "../math/vec2": 30,
            "../objects/Body": 31
        }],
        9: [function(t, e, i) {
            function s() {
                h.call(this, h.NAIVE)
            }
            var h = (t("../shapes/Circle"),
            t("../shapes/Plane"),
            t("../shapes/Shape"),
            t("../shapes/Particle"),
            t("../collision/Broadphase"));
            t("../math/vec2"),
            (((e.exports = s).prototype = new h).constructor = s).prototype.getCollisionPairs = function(t) {
                for (var e = t.bodies, i = this.result, s = i.length = 0, n = e.length; s !== n; s++)
                    for (var r = e[s], o = 0; o < s; o++) {
                        var a = e[o];
                        h.canCollide(r, a) && this.boundingVolumeCheck(r, a) && i.push(r, a)
                    }
                return i
            }
            ,
            s.prototype.aabbQuery = function(t, e, i) {
                i = i || [];
                for (var s = t.bodies, n = 0; n < s.length; n++) {
                    var r = s[n];
                    r.aabbNeedsUpdate && r.updateAABB(),
                    r.aabb.overlaps(e) && i.push(r)
                }
                return i
            }
        }
        , {
            "../collision/Broadphase": 8,
            "../math/vec2": 30,
            "../shapes/Circle": 39,
            "../shapes/Particle": 43,
            "../shapes/Plane": 44,
            "../shapes/Shape": 45
        }],
        10: [function(t, e, i) {
            function W() {
                this.contactEquations = [],
                this.frictionEquations = [],
                this.enableFriction = !0,
                this.enabledEquations = !0,
                this.slipForce = 10,
                this.frictionCoefficient = .3,
                this.surfaceVelocity = 0,
                this.contactEquationPool = new s({
                    size: 32
                }),
                this.frictionEquationPool = new n({
                    size: 64
                }),
                this.restitution = 0,
                this.stiffness = o.DEFAULT_STIFFNESS,
                this.relaxation = o.DEFAULT_RELAXATION,
                this.frictionStiffness = o.DEFAULT_STIFFNESS,
                this.frictionRelaxation = o.DEFAULT_RELAXATION,
                this.enableFrictionReduction = !0,
                this.collidingBodiesLastStep = new r,
                this.contactSkinSize = .01
            }
            function _(t, e) {
                H.set(t.vertices[0], .5 * -e.length, -e.radius),
                H.set(t.vertices[1], .5 * e.length, -e.radius),
                H.set(t.vertices[2], .5 * e.length, e.radius),
                H.set(t.vertices[3], .5 * -e.length, e.radius)
            }
            function k(t, e, i, s) {
                for (var n = f, r = m, o = y, a = v, h = t, l = e.vertices, c = null, d = 0; d !== l.length + 1; d++) {
                    var u = l[d % l.length]
                      , p = l[(d + 1) % l.length];
                    H.rotate(n, u, s),
                    H.rotate(r, p, s),
                    j(n, n, i),
                    j(r, r, i),
                    X(o, n, h),
                    X(a, r, h);
                    var g = H.crossLength(o, a);
                    if (null === c && (c = g),
                    g * c <= 0)
                        return !1;
                    c = g
                }
                return !0
            }
            var H = t("../math/vec2")
              , X = H.sub
              , j = H.add
              , q = H.dot
              , s = (t("../utils/Utils"),
            t("../utils/ContactEquationPool"))
              , n = t("../utils/FrictionEquationPool")
              , r = t("../utils/TupleDictionary")
              , o = t("../equations/Equation")
              , a = (t("../equations/ContactEquation"),
            t("../equations/FrictionEquation"),
            t("../shapes/Circle"))
              , h = t("../shapes/Convex")
              , l = t("../shapes/Shape")
              , S = (t("../objects/Body"),
            t("../shapes/Box"));
            e.exports = W;
            var T = H.fromValues(0, 1)
              , V = H.fromValues(0, 0)
              , z = H.fromValues(0, 0)
              , Y = H.fromValues(0, 0)
              , K = H.fromValues(0, 0)
              , J = H.fromValues(0, 0)
              , O = H.fromValues(0, 0)
              , Q = H.fromValues(0, 0)
              , Z = H.fromValues(0, 0)
              , $ = H.fromValues(0, 0)
              , L = H.fromValues(0, 0)
              , G = H.fromValues(0, 0)
              , D = H.fromValues(0, 0)
              , F = H.fromValues(0, 0)
              , U = H.fromValues(0, 0)
              , M = H.fromValues(0, 0)
              , R = H.fromValues(0, 0)
              , E = H.fromValues(0, 0)
              , I = H.fromValues(0, 0)
              , N = []
              , c = H.create()
              , d = H.create();
            W.prototype.bodiesOverlap = function(t, e) {
                for (var i = c, s = d, n = 0, r = t.shapes.length; n !== r; n++) {
                    var o = t.shapes[n];
                    t.toWorldFrame(i, o.position);
                    for (var a = 0, h = e.shapes.length; a !== h; a++) {
                        var l = e.shapes[a];
                        if (e.toWorldFrame(s, l.position),
                        this[o.type | l.type](t, o, i, o.angle + t.angle, e, l, s, l.angle + e.angle, !0))
                            return !0
                    }
                }
                return !1
            }
            ,
            W.prototype.collidedLastStep = function(t, e) {
                var i = 0 | t.id
                  , s = 0 | e.id;
                return !!this.collidingBodiesLastStep.get(i, s)
            }
            ,
            W.prototype.reset = function() {
                this.collidingBodiesLastStep.reset();
                for (var t = this.contactEquations, e = t.length; e--; ) {
                    var i = t[e]
                      , s = i.bodyA.id
                      , n = i.bodyB.id;
                    this.collidingBodiesLastStep.set(s, n, !0)
                }
                for (var r = this.contactEquations, o = this.frictionEquations, a = 0; a < r.length; a++)
                    this.contactEquationPool.release(r[a]);
                for (a = 0; a < o.length; a++)
                    this.frictionEquationPool.release(o[a]);
                this.contactEquations.length = this.frictionEquations.length = 0
            }
            ,
            W.prototype.createContactEquation = function(t, e, i, s) {
                var n = this.contactEquationPool.get();
                return n.bodyA = t,
                n.bodyB = e,
                n.shapeA = i,
                n.shapeB = s,
                n.restitution = this.restitution,
                n.firstImpact = !this.collidedLastStep(t, e),
                n.stiffness = this.stiffness,
                n.relaxation = this.relaxation,
                n.needsUpdate = !0,
                n.enabled = this.enabledEquations,
                n.offset = this.contactSkinSize,
                n
            }
            ,
            W.prototype.createFrictionEquation = function(t, e, i, s) {
                var n = this.frictionEquationPool.get();
                return n.bodyA = t,
                n.bodyB = e,
                n.shapeA = i,
                n.shapeB = s,
                n.setSlipForce(this.slipForce),
                n.frictionCoefficient = this.frictionCoefficient,
                n.relativeVelocity = this.surfaceVelocity,
                n.enabled = this.enabledEquations,
                n.needsUpdate = !0,
                n.stiffness = this.frictionStiffness,
                n.relaxation = this.frictionRelaxation,
                n.contactEquations.length = 0,
                n
            }
            ,
            W.prototype.createFrictionFromContact = function(t) {
                var e = this.createFrictionEquation(t.bodyA, t.bodyB, t.shapeA, t.shapeB);
                return H.copy(e.contactPointA, t.contactPointA),
                H.copy(e.contactPointB, t.contactPointB),
                H.rotate90cw(e.t, t.normalA),
                e.contactEquations.push(t),
                e
            }
            ,
            W.prototype.createFrictionFromAverage = function(t) {
                var e = this.contactEquations[this.contactEquations.length - 1]
                  , i = this.createFrictionEquation(e.bodyA, e.bodyB, e.shapeA, e.shapeB)
                  , s = e.bodyA;
                e.bodyB,
                H.set(i.contactPointA, 0, 0),
                H.set(i.contactPointB, 0, 0),
                H.set(i.t, 0, 0);
                for (var n = 0; n !== t; n++)
                    (e = this.contactEquations[this.contactEquations.length - 1 - n]).bodyA === s ? (H.add(i.t, i.t, e.normalA),
                    H.add(i.contactPointA, i.contactPointA, e.contactPointA),
                    H.add(i.contactPointB, i.contactPointB, e.contactPointB)) : (H.sub(i.t, i.t, e.normalA),
                    H.add(i.contactPointA, i.contactPointA, e.contactPointB),
                    H.add(i.contactPointB, i.contactPointB, e.contactPointA)),
                    i.contactEquations.push(e);
                var r = 1 / t;
                return H.scale(i.contactPointA, i.contactPointA, r),
                H.scale(i.contactPointB, i.contactPointB, r),
                H.normalize(i.t, i.t),
                H.rotate90cw(i.t, i.t),
                i
            }
            ,
            W.prototype[l.LINE | l.CONVEX] = W.prototype.convexLine = function(t, e, i, s, n, r, o, a, h) {
                return !h && 0
            }
            ,
            W.prototype[l.LINE | l.BOX] = W.prototype.lineBox = function(t, e, i, s, n, r, o, a, h) {
                return !h && 0
            }
            ;
            var p = new S({
                width: 1,
                height: 1
            })
              , g = H.create();
            W.prototype[l.CAPSULE | l.CONVEX] = W.prototype[l.CAPSULE | l.BOX] = W.prototype.convexCapsule = function(t, e, i, s, n, r, o, a, h) {
                var l = g;
                H.set(l, r.length / 2, 0),
                H.rotate(l, l, a),
                H.add(l, l, o);
                var c = this.circleConvex(n, r, l, a, t, e, i, s, h, r.radius);
                H.set(l, -r.length / 2, 0),
                H.rotate(l, l, a),
                H.add(l, l, o);
                var d = this.circleConvex(n, r, l, a, t, e, i, s, h, r.radius);
                if (h && (c || d))
                    return !0;
                var u = p;
                return _(u, r),
                this.convexConvex(t, e, i, s, n, u, o, a, h) + c + d
            }
            ,
            W.prototype[l.CAPSULE | l.LINE] = W.prototype.lineCapsule = function(t, e, i, s, n, r, o, a, h) {
                return !h && 0
            }
            ;
            var b = H.create()
              , w = H.create()
              , x = new S({
                width: 1,
                height: 1
            });
            W.prototype[l.CAPSULE | l.CAPSULE] = W.prototype.capsuleCapsule = function(t, e, i, s, n, r, o, a, h) {
                for (var l = b, c = w, d = 0, u = 0; u < 2; u++) {
                    H.set(l, (0 === u ? -1 : 1) * e.length / 2, 0),
                    H.rotate(l, l, s),
                    H.add(l, l, i);
                    for (var p = 0; p < 2; p++) {
                        H.set(c, (0 === p ? -1 : 1) * r.length / 2, 0),
                        H.rotate(c, c, a),
                        H.add(c, c, o),
                        this.enableFrictionReduction && (y = this.enableFriction,
                        this.enableFriction = !1);
                        var g = this.circleCircle(t, e, l, s, n, r, c, a, h, e.radius, r.radius);
                        if (this.enableFrictionReduction && (this.enableFriction = y),
                        h && g)
                            return !0;
                        d += g
                    }
                }
                this.enableFrictionReduction && (y = this.enableFriction,
                this.enableFriction = !1);
                var f = x;
                _(f, e);
                var m = this.convexCapsule(t, f, i, s, n, r, o, a, h);
                if (this.enableFrictionReduction && (this.enableFriction = y),
                h && m)
                    return !0;
                if (d += m,
                this.enableFrictionReduction) {
                    var y = this.enableFriction;
                    this.enableFriction = !1
                }
                _(f, r);
                var v = this.convexCapsule(n, f, o, a, t, e, i, s, h);
                return this.enableFrictionReduction && (this.enableFriction = y),
                !(!h || !v) || (d += v,
                this.enableFrictionReduction && d && this.enableFriction && this.frictionEquations.push(this.createFrictionFromAverage(d)),
                d)
            }
            ,
            W.prototype[l.LINE | l.LINE] = W.prototype.lineLine = function(t, e, i, s, n, r, o, a, h) {
                return !h && 0
            }
            ,
            W.prototype[l.PLANE | l.LINE] = W.prototype.planeLine = function(t, e, i, s, n, r, o, a, h) {
                var l = V
                  , c = z
                  , d = Y
                  , u = K
                  , p = J
                  , g = O
                  , f = Q
                  , m = Z
                  , y = $
                  , v = N
                  , _ = 0;
                H.set(l, -r.length / 2, 0),
                H.set(c, r.length / 2, 0),
                H.rotate(d, l, a),
                H.rotate(u, c, a),
                j(d, d, o),
                j(u, u, o),
                H.copy(l, d),
                H.copy(c, u),
                X(p, c, l),
                H.normalize(g, p),
                H.rotate90cw(y, g),
                H.rotate(m, T, s),
                v[0] = l,
                v[1] = c;
                for (var b = 0; b < v.length; b++) {
                    var w = v[b];
                    X(f, w, i);
                    var x = q(f, m);
                    if (x < 0) {
                        if (h)
                            return !0;
                        var S = this.createContactEquation(t, n, e, r);
                        _++,
                        H.copy(S.normalA, m),
                        H.normalize(S.normalA, S.normalA),
                        H.scale(f, m, x),
                        X(S.contactPointA, w, f),
                        X(S.contactPointA, S.contactPointA, t.position),
                        X(S.contactPointB, w, o),
                        j(S.contactPointB, S.contactPointB, o),
                        X(S.contactPointB, S.contactPointB, n.position),
                        this.contactEquations.push(S),
                        this.enableFrictionReduction || this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(S))
                    }
                }
                return !h && (this.enableFrictionReduction || _ && this.enableFriction && this.frictionEquations.push(this.createFrictionFromAverage(_)),
                _)
            }
            ,
            W.prototype[l.PARTICLE | l.CAPSULE] = W.prototype.particleCapsule = function(t, e, i, s, n, r, o, a, h) {
                return this.circleLine(t, e, i, s, n, r, o, a, h, r.radius, 0)
            }
            ,
            W.prototype[l.CIRCLE | l.LINE] = W.prototype.circleLine = function(t, e, i, s, n, r, o, a, h, l, c) {
                l = l || 0,
                c = void 0 !== c ? c : e.radius;
                var d = V
                  , u = z
                  , p = Y
                  , g = K
                  , f = J
                  , m = O
                  , y = Q
                  , v = Z
                  , _ = $
                  , b = L
                  , w = G
                  , x = D
                  , S = F
                  , T = U
                  , A = N;
                H.set(v, -r.length / 2, 0),
                H.set(_, r.length / 2, 0),
                H.rotate(b, v, a),
                H.rotate(w, _, a),
                j(b, b, o),
                j(w, w, o),
                H.copy(v, b),
                H.copy(_, w),
                X(m, _, v),
                H.normalize(y, m),
                H.rotate90cw(f, y),
                X(x, i, v);
                var C = q(x, f);
                X(g, v, o),
                X(S, i, o);
                var P = c + l;
                if (Math.abs(C) < P) {
                    H.scale(d, f, C),
                    X(p, i, d),
                    H.scale(u, f, q(f, S)),
                    H.normalize(u, u),
                    H.scale(u, u, l),
                    j(p, p, u);
                    var E = q(y, p)
                      , I = q(y, v)
                      , k = q(y, _);
                    if (I < E && E < k) {
                        if (h)
                            return !0;
                        var M = this.createContactEquation(t, n, e, r);
                        return H.scale(M.normalA, d, -1),
                        H.normalize(M.normalA, M.normalA),
                        H.scale(M.contactPointA, M.normalA, c),
                        j(M.contactPointA, M.contactPointA, i),
                        X(M.contactPointA, M.contactPointA, t.position),
                        X(M.contactPointB, p, o),
                        j(M.contactPointB, M.contactPointB, o),
                        X(M.contactPointB, M.contactPointB, n.position),
                        this.contactEquations.push(M),
                        this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(M)),
                        1
                    }
                }
                A[0] = v,
                A[1] = _;
                for (var R = 0; R < A.length; R++) {
                    var B = A[R];
                    if (X(x, B, i),
                    H.squaredLength(x) < Math.pow(P, 2)) {
                        if (h)
                            return !0;
                        M = this.createContactEquation(t, n, e, r);
                        return H.copy(M.normalA, x),
                        H.normalize(M.normalA, M.normalA),
                        H.scale(M.contactPointA, M.normalA, c),
                        j(M.contactPointA, M.contactPointA, i),
                        X(M.contactPointA, M.contactPointA, t.position),
                        X(M.contactPointB, B, o),
                        H.scale(T, M.normalA, -l),
                        j(M.contactPointB, M.contactPointB, T),
                        j(M.contactPointB, M.contactPointB, o),
                        X(M.contactPointB, M.contactPointB, n.position),
                        this.contactEquations.push(M),
                        this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(M)),
                        1
                    }
                }
                return 0
            }
            ,
            W.prototype[l.CIRCLE | l.CAPSULE] = W.prototype.circleCapsule = function(t, e, i, s, n, r, o, a, h) {
                return this.circleLine(t, e, i, s, n, r, o, a, h, r.radius)
            }
            ,
            W.prototype[l.CIRCLE | l.CONVEX] = W.prototype[l.CIRCLE | l.BOX] = W.prototype.circleConvex = function(t, e, i, s, n, r, o, a, h, l) {
                l = "number" == typeof l ? l : e.radius;
                for (var c = V, d = z, u = Y, p = K, g = J, f = L, m = G, y = F, v = U, _ = M, b = R, w = !1, x = Number.MAX_VALUE, S = r.vertices, T = 0; T !== S.length + 1; T++) {
                    var A = S[T % S.length]
                      , C = S[(T + 1) % S.length];
                    if (H.rotate(c, A, a),
                    H.rotate(d, C, a),
                    j(c, c, o),
                    j(d, d, o),
                    X(u, d, c),
                    H.normalize(p, u),
                    H.rotate90cw(g, p),
                    H.scale(v, g, -e.radius),
                    j(v, v, i),
                    k(v, r, o, a)) {
                        H.sub(_, c, v);
                        var P = Math.abs(H.dot(_, g));
                        P < x && (H.copy(b, v),
                        x = P,
                        H.scale(y, g, P),
                        H.add(y, y, v),
                        w = !0)
                    }
                }
                if (w) {
                    if (h)
                        return !0;
                    var E = this.createContactEquation(t, n, e, r);
                    return H.sub(E.normalA, b, i),
                    H.normalize(E.normalA, E.normalA),
                    H.scale(E.contactPointA, E.normalA, l),
                    j(E.contactPointA, E.contactPointA, i),
                    X(E.contactPointA, E.contactPointA, t.position),
                    X(E.contactPointB, y, o),
                    j(E.contactPointB, E.contactPointB, o),
                    X(E.contactPointB, E.contactPointB, n.position),
                    this.contactEquations.push(E),
                    this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(E)),
                    1
                }
                if (0 < l)
                    for (T = 0; T < S.length; T++) {
                        var I = S[T];
                        if (H.rotate(m, I, a),
                        j(m, m, o),
                        X(f, m, i),
                        H.squaredLength(f) < Math.pow(l, 2)) {
                            if (h)
                                return !0;
                            E = this.createContactEquation(t, n, e, r);
                            return H.copy(E.normalA, f),
                            H.normalize(E.normalA, E.normalA),
                            H.scale(E.contactPointA, E.normalA, l),
                            j(E.contactPointA, E.contactPointA, i),
                            X(E.contactPointA, E.contactPointA, t.position),
                            X(E.contactPointB, m, o),
                            j(E.contactPointB, E.contactPointB, o),
                            X(E.contactPointB, E.contactPointB, n.position),
                            this.contactEquations.push(E),
                            this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(E)),
                            1
                        }
                    }
                return 0
            }
            ;
            var f = H.create()
              , m = H.create()
              , y = H.create()
              , v = H.create();
            W.prototype[l.PARTICLE | l.CONVEX] = W.prototype[l.PARTICLE | l.BOX] = W.prototype.particleConvex = function(t, e, i, s, n, r, o, a, h) {
                var l = V
                  , c = z
                  , d = Y
                  , u = K
                  , p = J
                  , g = O
                  , f = Q
                  , m = L
                  , y = F
                  , v = E
                  , _ = I
                  , b = Number.MAX_VALUE
                  , w = !1
                  , x = r.vertices;
                if (!k(i, r, o, a))
                    return 0;
                if (h)
                    return !0;
                for (var S = 0; S !== x.length + 1; S++) {
                    var T = x[S % x.length]
                      , A = x[(S + 1) % x.length];
                    H.rotate(l, T, a),
                    H.rotate(c, A, a),
                    j(l, l, o),
                    j(c, c, o),
                    X(d, c, l),
                    H.normalize(u, d),
                    H.rotate90cw(p, u),
                    X(m, i, l),
                    q(m, p),
                    X(g, l, o),
                    X(f, i, o),
                    H.sub(v, l, i);
                    var C = Math.abs(H.dot(v, p));
                    C < b && (b = C,
                    H.scale(y, p, C),
                    H.add(y, y, i),
                    H.copy(_, p),
                    w = !0)
                }
                if (w) {
                    var P = this.createContactEquation(t, n, e, r);
                    return H.scale(P.normalA, _, -1),
                    H.normalize(P.normalA, P.normalA),
                    H.set(P.contactPointA, 0, 0),
                    j(P.contactPointA, P.contactPointA, i),
                    X(P.contactPointA, P.contactPointA, t.position),
                    X(P.contactPointB, y, o),
                    j(P.contactPointB, P.contactPointB, o),
                    X(P.contactPointB, P.contactPointB, n.position),
                    this.contactEquations.push(P),
                    this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(P)),
                    1
                }
                return 0
            }
            ,
            W.prototype[l.CIRCLE] = W.prototype.circleCircle = function(t, e, i, s, n, r, o, a, h, l, c) {
                var d = V;
                l = l || e.radius,
                c = c || r.radius;
                X(d, i, o);
                var u = l + c;
                if (H.squaredLength(d) > Math.pow(u, 2))
                    return 0;
                if (h)
                    return !0;
                var p = this.createContactEquation(t, n, e, r);
                return X(p.normalA, o, i),
                H.normalize(p.normalA, p.normalA),
                H.scale(p.contactPointA, p.normalA, l),
                H.scale(p.contactPointB, p.normalA, -c),
                j(p.contactPointA, p.contactPointA, i),
                X(p.contactPointA, p.contactPointA, t.position),
                j(p.contactPointB, p.contactPointB, o),
                X(p.contactPointB, p.contactPointB, n.position),
                this.contactEquations.push(p),
                this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(p)),
                1
            }
            ,
            W.prototype[l.PLANE | l.CONVEX] = W.prototype[l.PLANE | l.BOX] = W.prototype.planeConvex = function(t, e, i, s, n, r, o, a, h) {
                var l = V
                  , c = z
                  , d = Y
                  , u = 0;
                H.rotate(c, T, s);
                for (var p = 0; p !== r.vertices.length; p++) {
                    var g = r.vertices[p];
                    if (H.rotate(l, g, a),
                    j(l, l, o),
                    X(d, l, i),
                    q(d, c) <= 0) {
                        if (h)
                            return !0;
                        u++;
                        var f = this.createContactEquation(t, n, e, r);
                        X(d, l, i),
                        H.copy(f.normalA, c);
                        var m = q(d, f.normalA);
                        H.scale(d, f.normalA, m),
                        X(f.contactPointB, l, n.position),
                        X(f.contactPointA, l, d),
                        X(f.contactPointA, f.contactPointA, t.position),
                        this.contactEquations.push(f),
                        this.enableFrictionReduction || this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(f))
                    }
                }
                return this.enableFrictionReduction && this.enableFriction && u && this.frictionEquations.push(this.createFrictionFromAverage(u)),
                u
            }
            ,
            W.prototype[l.PARTICLE | l.PLANE] = W.prototype.particlePlane = function(t, e, i, s, n, r, o, a, h) {
                var l = V
                  , c = z;
                a = a || 0,
                X(l, i, o),
                H.rotate(c, T, a);
                var d = q(l, c);
                if (0 < d)
                    return 0;
                if (h)
                    return !0;
                var u = this.createContactEquation(n, t, r, e);
                return H.copy(u.normalA, c),
                H.scale(l, u.normalA, d),
                X(u.contactPointA, i, l),
                X(u.contactPointA, u.contactPointA, n.position),
                X(u.contactPointB, i, t.position),
                this.contactEquations.push(u),
                this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(u)),
                1
            }
            ,
            W.prototype[l.CIRCLE | l.PARTICLE] = W.prototype.circleParticle = function(t, e, i, s, n, r, o, a, h) {
                var l = V;
                if (X(l, o, i),
                H.squaredLength(l) > Math.pow(e.radius, 2))
                    return 0;
                if (h)
                    return !0;
                var c = this.createContactEquation(t, n, e, r);
                return H.copy(c.normalA, l),
                H.normalize(c.normalA, c.normalA),
                H.scale(c.contactPointA, c.normalA, e.radius),
                j(c.contactPointA, c.contactPointA, i),
                X(c.contactPointA, c.contactPointA, t.position),
                X(c.contactPointB, o, n.position),
                this.contactEquations.push(c),
                this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(c)),
                1
            }
            ;
            var A = new a({
                radius: 1
            })
              , C = H.create()
              , P = H.create();
            H.create(),
            W.prototype[l.PLANE | l.CAPSULE] = W.prototype.planeCapsule = function(t, e, i, s, n, r, o, a, h) {
                var l, c = C, d = P, u = A;
                H.set(c, -r.length / 2, 0),
                H.rotate(c, c, a),
                j(c, c, o),
                H.set(d, r.length / 2, 0),
                H.rotate(d, d, a),
                j(d, d, o),
                u.radius = r.radius,
                this.enableFrictionReduction && (l = this.enableFriction,
                this.enableFriction = !1);
                var p = this.circlePlane(n, u, c, 0, t, e, i, s, h)
                  , g = this.circlePlane(n, u, d, 0, t, e, i, s, h);
                if (this.enableFrictionReduction && (this.enableFriction = l),
                h)
                    return p || g;
                var f = p + g;
                return this.enableFrictionReduction && f && this.frictionEquations.push(this.createFrictionFromAverage(f)),
                f
            }
            ,
            W.prototype[l.CIRCLE | l.PLANE] = W.prototype.circlePlane = function(t, e, i, s, n, r, o, a, h) {
                var l = t
                  , c = e
                  , d = i
                  , u = n
                  , p = o
                  , g = a;
                g = g || 0;
                var f = V
                  , m = z
                  , y = Y;
                X(f, d, p),
                H.rotate(m, T, g);
                var v = q(m, f);
                if (v > c.radius)
                    return 0;
                if (h)
                    return !0;
                var _ = this.createContactEquation(u, l, r, e);
                return H.copy(_.normalA, m),
                H.scale(_.contactPointB, _.normalA, -c.radius),
                j(_.contactPointB, _.contactPointB, d),
                X(_.contactPointB, _.contactPointB, l.position),
                H.scale(y, _.normalA, v),
                X(_.contactPointA, f, y),
                j(_.contactPointA, _.contactPointA, p),
                X(_.contactPointA, _.contactPointA, u.position),
                this.contactEquations.push(_),
                this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(_)),
                1
            }
            ,
            W.prototype[l.CONVEX] = W.prototype[l.CONVEX | l.BOX] = W.prototype[l.BOX] = W.prototype.convexConvex = function(t, e, i, s, n, r, o, a, h, l) {
                var c = V
                  , d = z
                  , u = Y
                  , p = K
                  , g = J
                  , f = Q
                  , m = Z
                  , y = $
                  , v = 0;
                l = "number" == typeof l ? l : 0;
                if (!W.findSeparatingAxis(e, i, s, r, o, a, c))
                    return 0;
                X(m, o, i),
                0 < q(c, m) && H.scale(c, c, -1);
                var _ = W.getClosestEdge(e, s, c, !0)
                  , b = W.getClosestEdge(r, a, c);
                if (-1 === _ || -1 === b)
                    return 0;
                for (var w = 0; w < 2; w++) {
                    var x, S = _, T = b, A = e, C = r, P = i, E = o, I = s, k = a, M = t, R = n;
                    if (0 === w)
                        x = S,
                        S = T,
                        T = x,
                        x = A,
                        A = C,
                        C = x,
                        x = P,
                        P = E,
                        E = x,
                        x = I,
                        I = k,
                        k = x,
                        x = M,
                        M = R,
                        R = x;
                    for (var B = T; B < T + 2; B++) {
                        var O = C.vertices[(B + C.vertices.length) % C.vertices.length];
                        H.rotate(d, O, k),
                        j(d, d, E);
                        for (var L = 0, G = S - 1; G < S + 2; G++) {
                            var D = A.vertices[(G + A.vertices.length) % A.vertices.length]
                              , F = A.vertices[(G + 1 + A.vertices.length) % A.vertices.length];
                            H.rotate(u, D, I),
                            H.rotate(p, F, I),
                            j(u, u, P),
                            j(p, p, P),
                            X(g, p, u),
                            H.rotate90cw(y, g),
                            H.normalize(y, y),
                            X(m, d, u);
                            var U = q(y, m);
                            (G === S && U <= l || G !== S && U <= 0) && L++
                        }
                        if (3 <= L) {
                            if (h)
                                return !0;
                            var N = this.createContactEquation(M, R, A, C);
                            v++;
                            D = A.vertices[S % A.vertices.length],
                            F = A.vertices[(S + 1) % A.vertices.length];
                            H.rotate(u, D, I),
                            H.rotate(p, F, I),
                            j(u, u, P),
                            j(p, p, P),
                            X(g, p, u),
                            H.rotate90cw(N.normalA, g),
                            H.normalize(N.normalA, N.normalA),
                            X(m, d, u);
                            U = q(N.normalA, m);
                            H.scale(f, N.normalA, U),
                            X(N.contactPointA, d, P),
                            X(N.contactPointA, N.contactPointA, f),
                            j(N.contactPointA, N.contactPointA, P),
                            X(N.contactPointA, N.contactPointA, M.position),
                            X(N.contactPointB, d, E),
                            j(N.contactPointB, N.contactPointB, E),
                            X(N.contactPointB, N.contactPointB, R.position),
                            this.contactEquations.push(N),
                            this.enableFrictionReduction || this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(N))
                        }
                    }
                }
                return this.enableFrictionReduction && this.enableFriction && v && this.frictionEquations.push(this.createFrictionFromAverage(v)),
                v
            }
            ;
            var B = H.fromValues(0, 0);
            W.projectConvexOntoAxis = function(t, e, i, s, n) {
                var r, o, a = null, h = null, l = B;
                H.rotate(l, s, -i);
                for (var c = 0; c < t.vertices.length; c++)
                    r = t.vertices[c],
                    o = q(r, l),
                    (null === a || a < o) && (a = o),
                    (null === h || o < h) && (h = o);
                if (a < h) {
                    var d = h;
                    h = a,
                    a = d
                }
                var u = q(e, s);
                H.set(n, h + u, a + u)
            }
            ;
            var tt = H.fromValues(0, 0)
              , et = H.fromValues(0, 0)
              , it = H.fromValues(0, 0)
              , st = H.fromValues(0, 0)
              , nt = H.fromValues(0, 0)
              , rt = H.fromValues(0, 0);
            W.findSeparatingAxis = function(t, e, i, s, n, r, o) {
                var a = null
                  , h = !1
                  , l = !1
                  , c = tt
                  , d = et
                  , u = it
                  , p = st
                  , g = nt
                  , f = rt;
                if (t instanceof S && s instanceof S)
                    for (var m = 0; 2 !== m; m++) {
                        var y = t
                          , v = i;
                        1 === m && (y = s,
                        v = r);
                        for (var _ = 0; 2 !== _; _++) {
                            0 === _ ? H.set(p, 0, 1) : 1 === _ && H.set(p, 1, 0),
                            0 !== v && H.rotate(p, p, v),
                            W.projectConvexOntoAxis(t, e, i, p, g),
                            W.projectConvexOntoAxis(s, n, r, p, f);
                            var b = g
                              , w = f;
                            g[0] > f[0] && (w = g,
                            b = f),
                            h = (x = w[0] - b[1]) <= 0,
                            (null === a || a < x) && (H.copy(o, p),
                            a = x,
                            l = h)
                        }
                    }
                else
                    for (m = 0; 2 !== m; m++) {
                        y = t,
                        v = i;
                        1 === m && (y = s,
                        v = r);
                        for (_ = 0; _ !== y.vertices.length; _++) {
                            H.rotate(d, y.vertices[_], v),
                            H.rotate(u, y.vertices[(_ + 1) % y.vertices.length], v),
                            X(c, u, d),
                            H.rotate90cw(p, c),
                            H.normalize(p, p),
                            W.projectConvexOntoAxis(t, e, i, p, g),
                            W.projectConvexOntoAxis(s, n, r, p, f);
                            var x;
                            b = g,
                            w = f;
                            g[0] > f[0] && (w = g,
                            b = f),
                            h = (x = w[0] - b[1]) <= 0,
                            (null === a || a < x) && (H.copy(o, p),
                            a = x,
                            l = h)
                        }
                    }
                return l
            }
            ;
            var u = H.fromValues(0, 0)
              , ot = H.fromValues(0, 0)
              , at = H.fromValues(0, 0);
            W.getClosestEdge = function(t, e, i, s) {
                var n = u
                  , r = ot
                  , o = at;
                H.rotate(n, i, -e),
                s && H.scale(n, n, -1);
                for (var a = -1, h = t.vertices.length, l = -1, c = 0; c !== h; c++) {
                    X(r, t.vertices[(c + 1) % h], t.vertices[c % h]),
                    H.rotate90cw(o, r),
                    H.normalize(o, o);
                    var d = q(o, n);
                    (-1 === a || l < d) && (a = c % h,
                    l = d)
                }
                return a
            }
            ;
            var ht = H.create()
              , lt = H.create()
              , ct = H.create()
              , dt = H.create()
              , ut = H.create()
              , pt = H.create()
              , gt = H.create();
            W.prototype[l.CIRCLE | l.HEIGHTFIELD] = W.prototype.circleHeightfield = function(t, e, i, s, n, r, o, a, h, l) {
                var c = r.heights
                  , d = (l = l || e.radius,
                r.elementWidth)
                  , u = lt
                  , p = ht
                  , g = ut
                  , f = gt
                  , m = pt
                  , y = ct
                  , v = dt
                  , _ = Math.floor((i[0] - l - o[0]) / d)
                  , b = Math.ceil((i[0] + l - o[0]) / d);
                _ < 0 && (_ = 0),
                b >= c.length && (b = c.length - 1);
                for (var w = c[_], x = c[b], S = _; S < b; S++)
                    c[S] < x && (x = c[S]),
                    c[S] > w && (w = c[S]);
                if (i[1] - l > w)
                    return !h && 0;
                var T = !1;
                for (S = _; S < b; S++) {
                    H.set(y, S * d, c[S]),
                    H.set(v, (S + 1) * d, c[S + 1]),
                    H.add(y, y, o),
                    H.add(v, v, o),
                    H.sub(m, v, y),
                    H.rotate(m, m, Math.PI / 2),
                    H.normalize(m, m),
                    H.scale(p, m, -l),
                    H.add(p, p, i),
                    H.sub(u, p, y);
                    var A = H.dot(u, m);
                    if (p[0] >= y[0] && p[0] < v[0] && A <= 0) {
                        if (h)
                            return !0;
                        T = !0,
                        H.scale(u, m, -A),
                        H.add(g, p, u),
                        H.copy(f, m);
                        var C = this.createContactEquation(n, t, r, e);
                        H.copy(C.normalA, f),
                        H.scale(C.contactPointB, C.normalA, -l),
                        j(C.contactPointB, C.contactPointB, i),
                        X(C.contactPointB, C.contactPointB, t.position),
                        H.copy(C.contactPointA, g),
                        H.sub(C.contactPointA, C.contactPointA, n.position),
                        this.contactEquations.push(C),
                        this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(C))
                    }
                }
                if (T = !1,
                0 < l)
                    for (S = _; S <= b; S++)
                        if (H.set(y, S * d, c[S]),
                        H.add(y, y, o),
                        H.sub(u, i, y),
                        H.squaredLength(u) < Math.pow(l, 2)) {
                            if (h)
                                return !0;
                            T = !0;
                            C = this.createContactEquation(n, t, r, e);
                            H.copy(C.normalA, u),
                            H.normalize(C.normalA, C.normalA),
                            H.scale(C.contactPointB, C.normalA, -l),
                            j(C.contactPointB, C.contactPointB, i),
                            X(C.contactPointB, C.contactPointB, t.position),
                            X(C.contactPointA, y, o),
                            j(C.contactPointA, C.contactPointA, o),
                            X(C.contactPointA, C.contactPointA, n.position),
                            this.contactEquations.push(C),
                            this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(C))
                        }
                return T ? 1 : 0
            }
            ;
            var ft = H.create()
              , mt = H.create()
              , yt = H.create()
              , vt = new h({
                vertices: [H.create(), H.create(), H.create(), H.create()]
            });
            W.prototype[l.BOX | l.HEIGHTFIELD] = W.prototype[l.CONVEX | l.HEIGHTFIELD] = W.prototype.convexHeightfield = function(t, e, i, s, n, r, o, a, h) {
                var l = r.heights
                  , c = r.elementWidth
                  , d = ft
                  , u = mt
                  , p = yt
                  , g = vt
                  , f = Math.floor((t.aabb.lowerBound[0] - o[0]) / c)
                  , m = Math.ceil((t.aabb.upperBound[0] - o[0]) / c);
                f < 0 && (f = 0),
                m >= l.length && (m = l.length - 1);
                for (var y = l[f], v = l[m], _ = f; _ < m; _++)
                    l[_] < v && (v = l[_]),
                    l[_] > y && (y = l[_]);
                if (t.aabb.lowerBound[1] > y)
                    return !h && 0;
                var b = 0;
                for (_ = f; _ < m; _++) {
                    H.set(d, _ * c, l[_]),
                    H.set(u, (_ + 1) * c, l[_ + 1]),
                    H.add(d, d, o),
                    H.add(u, u, o);
                    H.set(p, .5 * (u[0] + d[0]), .5 * (u[1] + d[1] - 100)),
                    H.sub(g.vertices[0], u, p),
                    H.sub(g.vertices[1], d, p),
                    H.copy(g.vertices[2], g.vertices[1]),
                    H.copy(g.vertices[3], g.vertices[0]),
                    g.vertices[2][1] -= 100,
                    g.vertices[3][1] -= 100,
                    b += this.convexConvex(t, e, i, s, n, g, p, 0, h)
                }
                return b
            }
        }
        , {
            "../equations/ContactEquation": 21,
            "../equations/Equation": 22,
            "../equations/FrictionEquation": 23,
            "../math/vec2": 30,
            "../objects/Body": 31,
            "../shapes/Box": 37,
            "../shapes/Circle": 39,
            "../shapes/Convex": 40,
            "../shapes/Shape": 45,
            "../utils/ContactEquationPool": 48,
            "../utils/FrictionEquationPool": 49,
            "../utils/TupleDictionary": 56,
            "../utils/Utils": 57
        }],
        11: [function(t, e, i) {
            function o(t) {
                t = t || {},
                this.from = t.from ? h.fromValues(t.from[0], t.from[1]) : h.create(),
                this.to = t.to ? h.fromValues(t.to[0], t.to[1]) : h.create(),
                this.checkCollisionResponse = void 0 === t.checkCollisionResponse || t.checkCollisionResponse,
                this.skipBackfaces = !!t.skipBackfaces,
                this.collisionMask = void 0 !== t.collisionMask ? t.collisionMask : -1,
                this.collisionGroup = void 0 !== t.collisionGroup ? t.collisionGroup : -1,
                this.mode = void 0 !== t.mode ? t.mode : o.ANY,
                this.callback = t.callback || function(t) {}
                ,
                this.direction = h.create(),
                this.length = 1,
                this.update()
            }
            e.exports = o;
            var h = t("../math/vec2");
            t("../collision/RaycastResult"),
            t("../shapes/Shape"),
            t("../collision/AABB"),
            (o.prototype.constructor = o).CLOSEST = 1,
            o.ANY = 2,
            o.ALL = 4,
            o.prototype.update = function() {
                var t = this.direction;
                h.sub(t, this.to, this.from),
                this.length = h.length(t),
                h.normalize(t, t)
            }
            ,
            o.prototype.intersectBodies = function(t, e) {
                for (var i = 0, s = e.length; !t.shouldStop(this) && i < s; i++) {
                    var n = e[i]
                      , r = n.getAABB();
                    (0 <= r.overlapsRay(this) || r.containsPoint(this.from)) && this.intersectBody(t, n)
                }
            }
            ;
            var l = h.create();
            o.prototype.intersectBody = function(t, e) {
                var i = this.checkCollisionResponse;
                if (!i || e.collisionResponse)
                    for (var s = l, n = 0, r = e.shapes.length; n < r; n++) {
                        var o = e.shapes[n];
                        if ((!i || o.collisionResponse) && 0 != (this.collisionGroup & o.collisionMask) && 0 != (o.collisionGroup & this.collisionMask)) {
                            h.rotate(s, o.position, e.angle),
                            h.add(s, s, e.position);
                            var a = o.angle + e.angle;
                            if (this.intersectShape(t, o, a, s, e),
                            t.shouldStop(this))
                                break
                        }
                    }
            }
            ,
            o.prototype.intersectShape = function(t, e, i, s, n) {
                (function(t, e, i) {
                    h.sub(r, i, t);
                    var s = h.dot(r, e);
                    return h.scale(a, e, s),
                    h.add(a, a, t),
                    h.squaredDistance(i, a)
                }
                )(this.from, this.direction, s) > e.boundingRadius * e.boundingRadius || (this._currentBody = n,
                (this._currentShape = e).raycast(t, this, s, i),
                this._currentBody = this._currentShape = null)
            }
            ,
            o.prototype.getAABB = function(t) {
                var e = this.to
                  , i = this.from;
                h.set(t.lowerBound, Math.min(e[0], i[0]), Math.min(e[1], i[1])),
                h.set(t.upperBound, Math.max(e[0], i[0]), Math.max(e[1], i[1]))
            }
            ,
            h.create(),
            o.prototype.reportIntersection = function(t, e, i, s) {
                var n = (this.from,
                this.to,
                this._currentShape)
                  , r = this._currentBody;
                if (!(this.skipBackfaces && 0 < h.dot(i, this.direction)))
                    switch (this.mode) {
                    case o.ALL:
                        t.set(i, n, r, e, s),
                        this.callback(t);
                        break;
                    case o.CLOSEST:
                        (e < t.fraction || !t.hasHit()) && t.set(i, n, r, e, s);
                        break;
                    case o.ANY:
                        t.set(i, n, r, e, s)
                    }
            }
            ;
            var r = h.create()
              , a = h.create()
        }
        , {
            "../collision/AABB": 7,
            "../collision/RaycastResult": 12,
            "../math/vec2": 30,
            "../shapes/Shape": 45
        }],
        12: [function(t, e, i) {
            function s() {
                this.normal = r.create(),
                this.shape = null,
                this.body = null,
                this.faceIndex = -1,
                this.fraction = -1,
                this.isStopped = !1
            }
            var r = t("../math/vec2")
              , n = t("../collision/Ray");
            (e.exports = s).prototype.reset = function() {
                r.set(this.normal, 0, 0),
                this.shape = null,
                this.body = null,
                this.faceIndex = -1,
                this.fraction = -1,
                this.isStopped = !1
            }
            ,
            s.prototype.getHitDistance = function(t) {
                return r.distance(t.from, t.to) * this.fraction
            }
            ,
            s.prototype.hasHit = function() {
                return -1 !== this.fraction
            }
            ,
            s.prototype.getHitPoint = function(t, e) {
                r.lerp(t, e.from, e.to, this.fraction)
            }
            ,
            s.prototype.stop = function() {
                this.isStopped = !0
            }
            ,
            s.prototype.shouldStop = function(t) {
                return this.isStopped || -1 !== this.fraction && t.mode === n.ANY
            }
            ,
            s.prototype.set = function(t, e, i, s, n) {
                r.copy(this.normal, t),
                this.shape = e,
                this.body = i,
                this.fraction = s,
                this.faceIndex = n
            }
        }
        , {
            "../collision/Ray": 11,
            "../math/vec2": 30
        }],
        13: [function(t, e, i) {
            function s() {
                d.call(this, d.SAP),
                this.axisList = [],
                this.axisIndex = 0;
                var i = this;
                this._addBodyHandler = function(t) {
                    i.axisList.push(t.body)
                }
                ,
                this._removeBodyHandler = function(t) {
                    var e = i.axisList.indexOf(t.body);
                    -1 !== e && i.axisList.splice(e, 1)
                }
            }
            var n = t("../utils/Utils")
              , d = t("../collision/Broadphase");
            (((e.exports = s).prototype = new d).constructor = s).prototype.setWorld = function(t) {
                this.axisList.length = 0,
                n.appendArray(this.axisList, t.bodies),
                t.off("addBody", this._addBodyHandler).off("removeBody", this._removeBodyHandler),
                t.on("addBody", this._addBodyHandler).on("removeBody", this._removeBodyHandler),
                this.world = t
            }
            ,
            s.sortAxisList = function(t, e) {
                e |= 0;
                for (var i = 1, s = t.length; i < s; i++) {
                    for (var n = t[i], r = i - 1; 0 <= r && !(t[r].aabb.lowerBound[e] <= n.aabb.lowerBound[e]); r--)
                        t[r + 1] = t[r];
                    t[r + 1] = n
                }
                return t
            }
            ,
            s.prototype.sortList = function() {
                var t = this.axisList
                  , e = this.axisIndex;
                s.sortAxisList(t, e)
            }
            ,
            s.prototype.getCollisionPairs = function(t) {
                var e = this.axisList
                  , i = this.result
                  , s = this.axisIndex;
                i.length = 0;
                for (var n = e.length; n--; ) {
                    var r = e[n];
                    r.aabbNeedsUpdate && r.updateAABB()
                }
                this.sortList();
                for (var o = 0, a = 0 | e.length; o !== a; o++)
                    for (var h = e[o], l = o + 1; l < a; l++) {
                        var c = e[l];
                        if (!(c.aabb.lowerBound[s] <= h.aabb.upperBound[s]))
                            break;
                        d.canCollide(h, c) && this.boundingVolumeCheck(h, c) && i.push(h, c)
                    }
                return i
            }
            ,
            s.prototype.aabbQuery = function(t, e, i) {
                i = i || [],
                this.sortList();
                var s = this.axisIndex
                  , n = "x";
                1 === s && (n = "y"),
                2 === s && (n = "z");
                for (var r = this.axisList, o = (e.lowerBound[n],
                e.upperBound[n],
                0); o < r.length; o++) {
                    var a = r[o];
                    a.aabbNeedsUpdate && a.updateAABB(),
                    a.aabb.overlaps(e) && i.push(a)
                }
                return i
            }
        }
        , {
            "../collision/Broadphase": 8,
            "../utils/Utils": 57
        }],
        14: [function(t, e, i) {
            function s(t, e, i, s) {
                this.type = i,
                s = n.defaults(s, {
                    collideConnected: !0,
                    wakeUpBodies: !0
                }),
                this.equations = [],
                this.bodyA = t,
                this.bodyB = e,
                this.collideConnected = s.collideConnected,
                s.wakeUpBodies && (t && t.wakeUp(),
                e && e.wakeUp())
            }
            e.exports = s;
            var n = t("../utils/Utils");
            s.prototype.update = function() {
                throw new Error("method update() not implmemented in this Constraint subclass!")
            }
            ,
            s.DISTANCE = 1,
            s.GEAR = 2,
            s.LOCK = 3,
            s.PRISMATIC = 4,
            s.REVOLUTE = 5,
            s.prototype.setStiffness = function(t) {
                for (var e = this.equations, i = 0; i !== e.length; i++) {
                    var s = e[i];
                    s.stiffness = t,
                    s.needsUpdate = !0
                }
            }
            ,
            s.prototype.setRelaxation = function(t) {
                for (var e = this.equations, i = 0; i !== e.length; i++) {
                    var s = e[i];
                    s.relaxation = t,
                    s.needsUpdate = !0
                }
            }
        }
        , {
            "../utils/Utils": 57
        }],
        15: [function(t, e, i) {
            function s(t, e, i) {
                i = m.defaults(i, {
                    localAnchorA: [0, 0],
                    localAnchorB: [0, 0]
                }),
                p.call(this, t, e, p.DISTANCE, i),
                this.localAnchorA = f.fromValues(i.localAnchorA[0], i.localAnchorA[1]),
                this.localAnchorB = f.fromValues(i.localAnchorB[0], i.localAnchorB[1]);
                var s, n = this.localAnchorA, r = this.localAnchorB;
                if (this.distance = 0,
                "number" == typeof i.distance)
                    this.distance = i.distance;
                else {
                    var o = f.create()
                      , a = f.create()
                      , h = f.create();
                    f.rotate(o, n, t.angle),
                    f.rotate(a, r, e.angle),
                    f.add(h, e.position, a),
                    f.sub(h, h, o),
                    f.sub(h, h, t.position),
                    this.distance = f.length(h)
                }
                s = void 0 === i.maxForce ? Number.MAX_VALUE : i.maxForce;
                var l = new g(t,e,-s,s);
                this.equations = [l],
                this.maxForce = s;
                h = f.create();
                var c = f.create()
                  , d = f.create()
                  , u = this;
                l.computeGq = function() {
                    var t = this.bodyA
                      , e = this.bodyB
                      , i = t.position
                      , s = e.position;
                    return f.rotate(c, n, t.angle),
                    f.rotate(d, r, e.angle),
                    f.add(h, s, d),
                    f.sub(h, h, c),
                    f.sub(h, h, i),
                    f.length(h) - u.distance
                }
                ,
                this.setMaxForce(s),
                this.upperLimitEnabled = !1,
                this.upperLimit = 1,
                this.lowerLimitEnabled = !1,
                this.lowerLimit = 0,
                this.position = 0
            }
            var p = t("./Constraint")
              , g = t("../equations/Equation")
              , f = t("../math/vec2")
              , m = t("../utils/Utils");
            ((e.exports = s).prototype = new p).constructor = s;
            var c = f.create()
              , d = f.create()
              , u = f.create();
            s.prototype.update = function() {
                var t = this.equations[0]
                  , e = this.bodyA
                  , i = this.bodyB
                  , s = (this.distance,
                e.position)
                  , n = i.position
                  , r = this.equations[0]
                  , o = t.G;
                f.rotate(d, this.localAnchorA, e.angle),
                f.rotate(u, this.localAnchorB, i.angle),
                f.add(c, n, u),
                f.sub(c, c, d),
                f.sub(c, c, s),
                this.position = f.length(c);
                var a = !1;
                if (this.upperLimitEnabled && this.position > this.upperLimit && (r.maxForce = 0,
                r.minForce = -this.maxForce,
                this.distance = this.upperLimit,
                a = !0),
                this.lowerLimitEnabled && this.position < this.lowerLimit && (r.maxForce = this.maxForce,
                r.minForce = 0,
                this.distance = this.lowerLimit,
                a = !0),
                !this.lowerLimitEnabled && !this.upperLimitEnabled || a) {
                    r.enabled = !0,
                    f.normalize(c, c);
                    var h = f.crossLength(d, c)
                      , l = f.crossLength(u, c);
                    o[0] = -c[0],
                    o[1] = -c[1],
                    o[2] = -h,
                    o[3] = c[0],
                    o[4] = c[1],
                    o[5] = l
                } else
                    r.enabled = !1
            }
            ,
            s.prototype.setMaxForce = function(t) {
                var e = this.equations[0];
                e.minForce = -t,
                e.maxForce = t
            }
            ,
            s.prototype.getMaxForce = function() {
                return this.equations[0].maxForce
            }
        }
        , {
            "../equations/Equation": 22,
            "../math/vec2": 30,
            "../utils/Utils": 57,
            "./Constraint": 14
        }],
        16: [function(t, e, i) {
            function s(t, e, i) {
                i = i || {},
                n.call(this, t, e, n.GEAR, i),
                this.ratio = void 0 !== i.ratio ? i.ratio : 1,
                this.angle = void 0 !== i.angle ? i.angle : e.angle - this.ratio * t.angle,
                i.angle = this.angle,
                i.ratio = this.ratio,
                this.equations = [new r(t,e,i)],
                void 0 !== i.maxTorque && this.setMaxTorque(i.maxTorque)
            }
            var n = t("./Constraint")
              , r = (t("../equations/Equation"),
            t("../equations/AngleLockEquation"));
            t("../math/vec2"),
            (((e.exports = s).prototype = new n).constructor = s).prototype.update = function() {
                var t = this.equations[0];
                t.ratio !== this.ratio && t.setRatio(this.ratio),
                t.angle = this.angle
            }
            ,
            s.prototype.setMaxTorque = function(t) {
                this.equations[0].setMaxTorque(t)
            }
            ,
            s.prototype.getMaxTorque = function(t) {
                return this.equations[0].maxForce
            }
        }
        , {
            "../equations/AngleLockEquation": 20,
            "../equations/Equation": 22,
            "../math/vec2": 30,
            "./Constraint": 14
        }],
        17: [function(t, e, i) {
            function s(t, e, i) {
                i = i || {},
                u.call(this, t, e, u.LOCK, i);
                var s = void 0 === i.maxForce ? Number.MAX_VALUE : i.maxForce
                  , n = (i.localAngleB,
                new g(t,e,-s,s))
                  , r = new g(t,e,-s,s)
                  , o = new g(t,e,-s,s)
                  , a = p.create()
                  , h = p.create()
                  , l = this;
                n.computeGq = function() {
                    return p.rotate(a, l.localOffsetB, t.angle),
                    p.sub(h, e.position, t.position),
                    p.sub(h, h, a),
                    h[0]
                }
                ,
                r.computeGq = function() {
                    return p.rotate(a, l.localOffsetB, t.angle),
                    p.sub(h, e.position, t.position),
                    p.sub(h, h, a),
                    h[1]
                }
                ;
                var c = p.create()
                  , d = p.create();
                o.computeGq = function() {
                    return p.rotate(c, l.localOffsetB, e.angle - l.localAngleB),
                    p.scale(c, c, -1),
                    p.sub(h, t.position, e.position),
                    p.add(h, h, c),
                    p.rotate(d, c, -Math.PI / 2),
                    p.normalize(d, d),
                    p.dot(h, d)
                }
                ,
                this.localOffsetB = p.create(),
                i.localOffsetB ? p.copy(this.localOffsetB, i.localOffsetB) : (p.sub(this.localOffsetB, e.position, t.position),
                p.rotate(this.localOffsetB, this.localOffsetB, -t.angle)),
                this.localAngleB = 0,
                "number" == typeof i.localAngleB ? this.localAngleB = i.localAngleB : this.localAngleB = e.angle - t.angle,
                this.equations.push(n, r, o),
                this.setMaxForce(s)
            }
            var u = t("./Constraint")
              , p = t("../math/vec2")
              , g = t("../equations/Equation");
            (((e.exports = s).prototype = new u).constructor = s).prototype.setMaxForce = function(t) {
                for (var e = this.equations, i = 0; i < this.equations.length; i++)
                    e[i].maxForce = t,
                    e[i].minForce = -t
            }
            ,
            s.prototype.getMaxForce = function() {
                return this.equations[0].maxForce
            }
            ;
            var r = p.create()
              , o = p.create()
              , a = p.create()
              , h = p.fromValues(1, 0)
              , l = p.fromValues(0, 1);
            s.prototype.update = function() {
                var t = this.equations[0]
                  , e = this.equations[1]
                  , i = this.equations[2]
                  , s = this.bodyA
                  , n = this.bodyB;
                p.rotate(r, this.localOffsetB, s.angle),
                p.rotate(o, this.localOffsetB, n.angle - this.localAngleB),
                p.scale(o, o, -1),
                p.rotate(a, o, Math.PI / 2),
                p.normalize(a, a),
                t.G[0] = -1,
                t.G[1] = 0,
                t.G[2] = -p.crossLength(r, h),
                t.G[3] = 1,
                e.G[0] = 0,
                e.G[1] = -1,
                e.G[2] = -p.crossLength(r, l),
                e.G[4] = 1,
                i.G[0] = -a[0],
                i.G[1] = -a[1],
                i.G[3] = a[0],
                i.G[4] = a[1],
                i.G[5] = p.crossLength(o, a)
            }
        }
        , {
            "../equations/Equation": 22,
            "../math/vec2": 30,
            "./Constraint": 14
        }],
        18: [function(t, e, i) {
            function s(s, n, t) {
                t = t || {},
                f.call(this, s, n, f.PRISMATIC, t);
                var r = v.fromValues(0, 0)
                  , o = v.fromValues(1, 0)
                  , a = v.fromValues(0, 0);
                t.localAnchorA && v.copy(r, t.localAnchorA),
                t.localAxisA && v.copy(o, t.localAxisA),
                t.localAnchorB && v.copy(a, t.localAnchorB),
                this.localAnchorA = r,
                this.localAnchorB = a,
                this.localAxisA = o;
                var e = this.maxForce = void 0 !== t.maxForce ? t.maxForce : Number.MAX_VALUE
                  , i = new y(s,n,-e,e)
                  , h = new v.create
                  , l = new v.create
                  , c = new v.create
                  , d = new v.create;
                if (i.computeGq = function() {
                    return v.dot(c, d)
                }
                ,
                i.updateJacobian = function() {
                    var t = this.G
                      , e = s.position
                      , i = n.position;
                    v.rotate(h, r, s.angle),
                    v.rotate(l, a, n.angle),
                    v.add(c, i, l),
                    v.sub(c, c, e),
                    v.sub(c, c, h),
                    v.rotate(d, o, s.angle + Math.PI / 2),
                    t[0] = -d[0],
                    t[1] = -d[1],
                    t[2] = -v.crossLength(h, d) + v.crossLength(d, c),
                    t[3] = d[0],
                    t[4] = d[1],
                    t[5] = v.crossLength(l, d)
                }
                ,
                this.equations.push(i),
                !t.disableRotationalLock) {
                    var u = new _(s,n,-e,e);
                    this.equations.push(u)
                }
                this.position = 0,
                this.velocity = 0,
                this.lowerLimitEnabled = void 0 !== t.lowerLimit,
                this.upperLimitEnabled = void 0 !== t.upperLimit,
                this.lowerLimit = void 0 !== t.lowerLimit ? t.lowerLimit : 0,
                this.upperLimit = void 0 !== t.upperLimit ? t.upperLimit : 1,
                this.upperLimitEquation = new m(s,n),
                this.lowerLimitEquation = new m(s,n),
                this.upperLimitEquation.minForce = this.lowerLimitEquation.minForce = 0,
                this.upperLimitEquation.maxForce = this.lowerLimitEquation.maxForce = e,
                this.motorEquation = new y(s,n),
                this.motorEnabled = !1,
                this.motorSpeed = 0;
                var p = this
                  , g = this.motorEquation;
                g.computeGW,
                g.computeGq = function() {
                    return 0
                }
                ,
                g.computeGW = function() {
                    var t = this.G
                      , e = this.bodyA
                      , i = this.bodyB
                      , s = e.velocity
                      , n = i.velocity
                      , r = e.angularVelocity
                      , o = i.angularVelocity;
                    return this.gmult(t, s, r, n, o) + p.motorSpeed
                }
            }
            var f = t("./Constraint")
              , m = t("../equations/ContactEquation")
              , y = t("../equations/Equation")
              , v = t("../math/vec2")
              , _ = t("../equations/RotationalLockEquation");
            ((e.exports = s).prototype = new f).constructor = s;
            var g = v.create()
              , b = v.create()
              , w = v.create()
              , x = v.create()
              , S = v.create()
              , T = v.create();
            s.prototype.update = function() {
                var t = this.equations
                  , e = t[0]
                  , i = this.upperLimit
                  , s = this.lowerLimit
                  , n = this.upperLimitEquation
                  , r = this.lowerLimitEquation
                  , o = this.bodyA
                  , a = this.bodyB
                  , h = this.localAxisA
                  , l = this.localAnchorA
                  , c = this.localAnchorB;
                e.updateJacobian(),
                v.rotate(g, h, o.angle),
                v.rotate(x, l, o.angle),
                v.add(b, x, o.position),
                v.rotate(S, c, a.angle),
                v.add(w, S, a.position);
                var d, u = this.position = v.dot(w, g) - v.dot(b, g);
                if (this.motorEnabled) {
                    var p = this.motorEquation.G;
                    p[0] = g[0],
                    p[1] = g[1],
                    p[2] = v.crossLength(g, S),
                    p[3] = -g[0],
                    p[4] = -g[1],
                    p[5] = -v.crossLength(g, x)
                }
                this.upperLimitEnabled && i < u ? (v.scale(n.normalA, g, -1),
                v.sub(n.contactPointA, b, o.position),
                v.sub(n.contactPointB, w, a.position),
                v.scale(T, g, i),
                v.add(n.contactPointA, n.contactPointA, T),
                -1 === t.indexOf(n) && t.push(n)) : -1 !== (d = t.indexOf(n)) && t.splice(d, 1);
                this.lowerLimitEnabled && u < s ? (v.scale(r.normalA, g, 1),
                v.sub(r.contactPointA, b, o.position),
                v.sub(r.contactPointB, w, a.position),
                v.scale(T, g, s),
                v.sub(r.contactPointB, r.contactPointB, T),
                -1 === t.indexOf(r) && t.push(r)) : -1 !== (d = t.indexOf(r)) && t.splice(d, 1)
            }
            ,
            s.prototype.enableMotor = function() {
                this.motorEnabled || (this.equations.push(this.motorEquation),
                this.motorEnabled = !0)
            }
            ,
            s.prototype.disableMotor = function() {
                if (this.motorEnabled) {
                    var t = this.equations.indexOf(this.motorEquation);
                    this.equations.splice(t, 1),
                    this.motorEnabled = !1
                }
            }
            ,
            s.prototype.setLimits = function(t, e) {
                "number" == typeof t ? (this.lowerLimit = t,
                this.lowerLimitEnabled = !0) : (this.lowerLimit = t,
                this.lowerLimitEnabled = !1),
                "number" == typeof e ? (this.upperLimit = e,
                this.upperLimitEnabled = !0) : (this.upperLimit = e,
                this.upperLimitEnabled = !1)
            }
        }
        , {
            "../equations/ContactEquation": 21,
            "../equations/Equation": 22,
            "../equations/RotationalLockEquation": 24,
            "../math/vec2": 30,
            "./Constraint": 14
        }],
        19: [function(t, e, i) {
            function s(t, e, i) {
                i = i || {},
                h.call(this, t, e, h.REVOLUTE, i);
                var s = this.maxForce = void 0 !== i.maxForce ? i.maxForce : Number.MAX_VALUE;
                this.pivotA = p.create(),
                this.pivotB = p.create(),
                i.worldPivot ? (p.sub(this.pivotA, i.worldPivot, t.position),
                p.sub(this.pivotB, i.worldPivot, e.position),
                p.rotate(this.pivotA, this.pivotA, -t.angle),
                p.rotate(this.pivotB, this.pivotB, -e.angle)) : (p.copy(this.pivotA, i.localPivotA),
                p.copy(this.pivotB, i.localPivotB));
                var n = this.equations = [new l(t,e,-s,s), new l(t,e,-s,s)]
                  , r = n[0]
                  , o = n[1]
                  , a = this;
                r.computeGq = function() {
                    return p.rotate(g, a.pivotA, t.angle),
                    p.rotate(f, a.pivotB, e.angle),
                    p.add(u, e.position, f),
                    p.sub(u, u, t.position),
                    p.sub(u, u, g),
                    p.dot(u, m)
                }
                ,
                o.computeGq = function() {
                    return p.rotate(g, a.pivotA, t.angle),
                    p.rotate(f, a.pivotB, e.angle),
                    p.add(u, e.position, f),
                    p.sub(u, u, t.position),
                    p.sub(u, u, g),
                    p.dot(u, y)
                }
                ,
                o.minForce = r.minForce = -s,
                o.maxForce = r.maxForce = s,
                this.motorEquation = new c(t,e),
                this.motorEnabled = !1,
                this.angle = 0,
                this.lowerLimitEnabled = !1,
                this.upperLimitEnabled = !1,
                this.lowerLimit = 0,
                this.upperLimit = 0,
                this.upperLimitEquation = new d(t,e),
                this.lowerLimitEquation = new d(t,e),
                this.upperLimitEquation.minForce = 0,
                this.lowerLimitEquation.maxForce = 0
            }
            var h = t("./Constraint")
              , l = t("../equations/Equation")
              , c = t("../equations/RotationalVelocityEquation")
              , d = t("../equations/RotationalLockEquation")
              , p = t("../math/vec2");
            e.exports = s;
            var g = p.create()
              , f = p.create()
              , m = p.fromValues(1, 0)
              , y = p.fromValues(0, 1)
              , u = p.create();
            ((s.prototype = new h).constructor = s).prototype.setLimits = function(t, e) {
                "number" == typeof t ? (this.lowerLimit = t,
                this.lowerLimitEnabled = !0) : (this.lowerLimit = t,
                this.lowerLimitEnabled = !1),
                "number" == typeof e ? (this.upperLimit = e,
                this.upperLimitEnabled = !0) : (this.upperLimit = e,
                this.upperLimitEnabled = !1)
            }
            ,
            s.prototype.update = function() {
                var t, e = this.bodyA, i = this.bodyB, s = this.pivotA, n = this.pivotB, r = this.equations, o = (r[0],
                r[1],
                r[0]), a = r[1], h = this.upperLimit, l = this.lowerLimit, c = this.upperLimitEquation, d = this.lowerLimitEquation, u = this.angle = i.angle - e.angle;
                this.upperLimitEnabled && h < u ? (c.angle = h,
                -1 === r.indexOf(c) && r.push(c)) : -1 !== (t = r.indexOf(c)) && r.splice(t, 1);
                this.lowerLimitEnabled && u < l ? (d.angle = l,
                -1 === r.indexOf(d) && r.push(d)) : -1 !== (t = r.indexOf(d)) && r.splice(t, 1);
                p.rotate(g, s, e.angle),
                p.rotate(f, n, i.angle),
                o.G[0] = -1,
                o.G[1] = 0,
                o.G[2] = -p.crossLength(g, m),
                o.G[3] = 1,
                o.G[4] = 0,
                o.G[5] = p.crossLength(f, m),
                a.G[0] = 0,
                a.G[1] = -1,
                a.G[2] = -p.crossLength(g, y),
                a.G[3] = 0,
                a.G[4] = 1,
                a.G[5] = p.crossLength(f, y)
            }
            ,
            s.prototype.enableMotor = function() {
                this.motorEnabled || (this.equations.push(this.motorEquation),
                this.motorEnabled = !0)
            }
            ,
            s.prototype.disableMotor = function() {
                if (this.motorEnabled) {
                    var t = this.equations.indexOf(this.motorEquation);
                    this.equations.splice(t, 1),
                    this.motorEnabled = !1
                }
            }
            ,
            s.prototype.motorIsEnabled = function() {
                return !!this.motorEnabled
            }
            ,
            s.prototype.setMotorSpeed = function(t) {
                if (this.motorEnabled) {
                    var e = this.equations.indexOf(this.motorEquation);
                    this.equations[e].relativeVelocity = t
                }
            }
            ,
            s.prototype.getMotorSpeed = function() {
                return !!this.motorEnabled && this.motorEquation.relativeVelocity
            }
        }
        , {
            "../equations/Equation": 22,
            "../equations/RotationalLockEquation": 24,
            "../equations/RotationalVelocityEquation": 25,
            "../math/vec2": 30,
            "./Constraint": 14
        }],
        20: [function(t, e, i) {
            function s(t, e, i) {
                i = i || {},
                n.call(this, t, e, -Number.MAX_VALUE, Number.MAX_VALUE),
                this.angle = i.angle || 0,
                this.ratio = "number" == typeof i.ratio ? i.ratio : 1,
                this.setRatio(this.ratio)
            }
            var n = t("./Equation");
            t("../math/vec2"),
            (((e.exports = s).prototype = new n).constructor = s).prototype.computeGq = function() {
                return this.ratio * this.bodyA.angle - this.bodyB.angle + this.angle
            }
            ,
            s.prototype.setRatio = function(t) {
                var e = this.G;
                e[2] = t,
                e[5] = -1,
                this.ratio = t
            }
            ,
            s.prototype.setMaxTorque = function(t) {
                this.maxForce = t,
                this.minForce = -t
            }
        }
        , {
            "../math/vec2": 30,
            "./Equation": 22
        }],
        21: [function(t, e, i) {
            function s(t, e) {
                n.call(this, t, e, 0, Number.MAX_VALUE),
                this.contactPointA = m.create(),
                this.penetrationVec = m.create(),
                this.contactPointB = m.create(),
                this.normalA = m.create(),
                this.restitution = 0,
                this.firstImpact = !1,
                this.shapeA = null,
                this.shapeB = null
            }
            var n = t("./Equation")
              , m = t("../math/vec2");
            (((e.exports = s).prototype = new n).constructor = s).prototype.computeB = function(t, e, i) {
                var s, n, r = this.bodyA, o = this.bodyB, a = this.contactPointA, h = this.contactPointB, l = r.position, c = o.position, d = this.penetrationVec, u = this.normalA, p = this.G, g = m.crossLength(a, u), f = m.crossLength(h, u);
                return p[0] = -u[0],
                p[1] = -u[1],
                p[2] = -g,
                p[3] = u[0],
                p[4] = u[1],
                p[5] = f,
                m.add(d, c, h),
                m.sub(d, d, l),
                m.sub(d, d, a),
                s = this.firstImpact && 0 !== this.restitution ? (n = 0,
                1 / e * (1 + this.restitution) * this.computeGW()) : (n = m.dot(u, d) + this.offset,
                this.computeGW()),
                -n * t - s * e - i * this.computeGiMf()
            }
        }
        , {
            "../math/vec2": 30,
            "./Equation": 22
        }],
        22: [function(t, e, i) {
            function r(t, e, i, s) {
                this.minForce = void 0 === i ? -Number.MAX_VALUE : i,
                this.maxForce = void 0 === s ? Number.MAX_VALUE : s,
                this.bodyA = t,
                this.bodyB = e,
                this.stiffness = r.DEFAULT_STIFFNESS,
                this.relaxation = r.DEFAULT_RELAXATION,
                this.G = new o.ARRAY_TYPE(6);
                for (var n = 0; n < 6; n++)
                    this.G[n] = 0;
                this.offset = 0,
                this.a = 0,
                this.b = 0,
                this.epsilon = 0,
                this.timeStep = 1 / 60,
                this.needsUpdate = !0,
                this.multiplier = 0,
                this.relativeVelocity = 0,
                this.enabled = !0
            }
            e.exports = r;
            var d = t("../math/vec2")
              , o = t("../utils/Utils");
            t("../objects/Body"),
            (r.prototype.constructor = r).DEFAULT_STIFFNESS = 1e6,
            r.DEFAULT_RELAXATION = 4,
            r.prototype.update = function() {
                var t = this.stiffness
                  , e = this.relaxation
                  , i = this.timeStep;
                this.a = 4 / (i * (1 + 4 * e)),
                this.b = 4 * e / (1 + 4 * e),
                this.epsilon = 4 / (i * i * t * (1 + 4 * e)),
                this.needsUpdate = !1
            }
            ,
            r.prototype.gmult = function(t, e, i, s, n) {
                return t[0] * e[0] + t[1] * e[1] + t[2] * i + t[3] * s[0] + t[4] * s[1] + t[5] * n
            }
            ,
            r.prototype.computeB = function(t, e, i) {
                var s = this.computeGW();
                return -this.computeGq() * t - s * e - this.computeGiMf() * i
            }
            ;
            var a = d.create()
              , h = d.create();
            r.prototype.computeGq = function() {
                var t = this.G
                  , e = this.bodyA
                  , i = this.bodyB
                  , s = (e.position,
                i.position,
                e.angle)
                  , n = i.angle;
                return this.gmult(t, a, s, h, n) + this.offset
            }
            ,
            r.prototype.computeGW = function() {
                var t = this.G
                  , e = this.bodyA
                  , i = this.bodyB
                  , s = e.velocity
                  , n = i.velocity
                  , r = e.angularVelocity
                  , o = i.angularVelocity;
                return this.gmult(t, s, r, n, o) + this.relativeVelocity
            }
            ,
            r.prototype.computeGWlambda = function() {
                var t = this.G
                  , e = this.bodyA
                  , i = this.bodyB
                  , s = e.vlambda
                  , n = i.vlambda
                  , r = e.wlambda
                  , o = i.wlambda;
                return this.gmult(t, s, r, n, o)
            }
            ;
            var u = d.create()
              , p = d.create();
            r.prototype.computeGiMf = function() {
                var t = this.bodyA
                  , e = this.bodyB
                  , i = t.force
                  , s = t.angularForce
                  , n = e.force
                  , r = e.angularForce
                  , o = t.invMassSolve
                  , a = e.invMassSolve
                  , h = t.invInertiaSolve
                  , l = e.invInertiaSolve
                  , c = this.G;
                return d.scale(u, i, o),
                d.multiply(u, t.massMultiplier, u),
                d.scale(p, n, a),
                d.multiply(p, e.massMultiplier, p),
                this.gmult(c, u, s * h, p, r * l)
            }
            ,
            r.prototype.computeGiMGt = function() {
                var t = this.bodyA
                  , e = this.bodyB
                  , i = t.invMassSolve
                  , s = e.invMassSolve
                  , n = t.invInertiaSolve
                  , r = e.invInertiaSolve
                  , o = this.G;
                return o[0] * o[0] * i * t.massMultiplier[0] + o[1] * o[1] * i * t.massMultiplier[1] + o[2] * o[2] * n + o[3] * o[3] * s * e.massMultiplier[0] + o[4] * o[4] * s * e.massMultiplier[1] + o[5] * o[5] * r
            }
            ;
            var g = d.create()
              , f = d.create()
              , m = d.create();
            d.create(),
            d.create(),
            d.create(),
            r.prototype.addToWlambda = function(t) {
                var e = this.bodyA
                  , i = this.bodyB
                  , s = g
                  , n = f
                  , r = m
                  , o = e.invMassSolve
                  , a = i.invMassSolve
                  , h = e.invInertiaSolve
                  , l = i.invInertiaSolve
                  , c = this.G;
                n[0] = c[0],
                n[1] = c[1],
                r[0] = c[3],
                r[1] = c[4],
                d.scale(s, n, o * t),
                d.multiply(s, s, e.massMultiplier),
                d.add(e.vlambda, e.vlambda, s),
                e.wlambda += h * c[2] * t,
                d.scale(s, r, a * t),
                d.multiply(s, s, i.massMultiplier),
                d.add(i.vlambda, i.vlambda, s),
                i.wlambda += l * c[5] * t
            }
            ,
            r.prototype.computeInvC = function(t) {
                return 1 / (this.computeGiMGt() + t)
            }
        }
        , {
            "../math/vec2": 30,
            "../objects/Body": 31,
            "../utils/Utils": 57
        }],
        23: [function(t, e, i) {
            function s(t, e, i) {
                n.call(this, t, e, -i, i),
                this.contactPointA = a.create(),
                this.contactPointB = a.create(),
                this.t = a.create(),
                this.contactEquations = [],
                this.shapeA = null,
                this.shapeB = null,
                this.frictionCoefficient = .3
            }
            var a = t("../math/vec2")
              , n = t("./Equation");
            t("../utils/Utils"),
            (((e.exports = s).prototype = new n).constructor = s).prototype.setSlipForce = function(t) {
                this.maxForce = t,
                this.minForce = -t
            }
            ,
            s.prototype.getSlipForce = function() {
                return this.maxForce
            }
            ,
            s.prototype.computeB = function(t, e, i) {
                var s = (this.bodyA,
                this.bodyB,
                this.contactPointA)
                  , n = this.contactPointB
                  , r = this.t
                  , o = this.G;
                return o[0] = -r[0],
                o[1] = -r[1],
                o[2] = -a.crossLength(s, r),
                o[3] = r[0],
                o[4] = r[1],
                o[5] = a.crossLength(n, r),
                -this.computeGW() * e - i * this.computeGiMf()
            }
        }
        , {
            "../math/vec2": 30,
            "../utils/Utils": 57,
            "./Equation": 22
        }],
        24: [function(t, e, i) {
            function s(t, e, i) {
                i = i || {},
                n.call(this, t, e, -Number.MAX_VALUE, Number.MAX_VALUE),
                this.angle = i.angle || 0;
                var s = this.G;
                s[2] = 1,
                s[5] = -1
            }
            var n = t("./Equation")
              , r = t("../math/vec2");
            ((e.exports = s).prototype = new n).constructor = s;
            var o = r.create()
              , a = r.create()
              , h = r.fromValues(1, 0)
              , l = r.fromValues(0, 1);
            s.prototype.computeGq = function() {
                return r.rotate(o, h, this.bodyA.angle + this.angle),
                r.rotate(a, l, this.bodyB.angle),
                r.dot(o, a)
            }
        }
        , {
            "../math/vec2": 30,
            "./Equation": 22
        }],
        25: [function(t, e, i) {
            function s(t, e) {
                n.call(this, t, e, -Number.MAX_VALUE, Number.MAX_VALUE),
                this.relativeVelocity = 1,
                this.ratio = 1
            }
            var n = t("./Equation");
            t("../math/vec2"),
            (((e.exports = s).prototype = new n).constructor = s).prototype.computeB = function(t, e, i) {
                var s = this.G;
                s[2] = -1,
                s[5] = this.ratio;
                var n = this.computeGiMf();
                return -this.computeGW() * e - i * n
            }
        }
        , {
            "../math/vec2": 30,
            "./Equation": 22
        }],
        26: [function(t, e, i) {
            var s = function() {};
            (e.exports = s).prototype = {
                constructor: s,
                on: function(t, e, i) {
                    e.context = i || this,
                    void 0 === this._listeners && (this._listeners = {});
                    var s = this._listeners;
                    return void 0 === s[t] && (s[t] = []),
                    -1 === s[t].indexOf(e) && s[t].push(e),
                    this
                },
                has: function(t, e) {
                    if (void 0 === this._listeners)
                        return !1;
                    var i = this._listeners;
                    if (e) {
                        if (void 0 !== i[t] && -1 !== i[t].indexOf(e))
                            return !0
                    } else if (void 0 !== i[t])
                        return !0;
                    return !1
                },
                off: function(t, e) {
                    if (void 0 === this._listeners)
                        return this;
                    var i = this._listeners
                      , s = i[t].indexOf(e);
                    return -1 !== s && i[t].splice(s, 1),
                    this
                },
                emit: function(t) {
                    if (void 0 === this._listeners)
                        return this;
                    var e = this._listeners[t.type];
                    if (void 0 !== e) {
                        t.target = this;
                        for (var i = 0, s = e.length; i < s; i++) {
                            var n = e[i];
                            n.call(n.context, t)
                        }
                    }
                    return this
                }
            }
        }
        , {}],
        27: [function(t, e, i) {
            function s(t, e, i) {
                if (i = i || {},
                !(t instanceof n && e instanceof n))
                    throw new Error("First two arguments must be Material instances.");
                this.id = s.idCounter++,
                this.materialA = t,
                this.materialB = e,
                this.friction = void 0 !== i.friction ? Number(i.friction) : .3,
                this.restitution = void 0 !== i.restitution ? Number(i.restitution) : 0,
                this.stiffness = void 0 !== i.stiffness ? Number(i.stiffness) : r.DEFAULT_STIFFNESS,
                this.relaxation = void 0 !== i.relaxation ? Number(i.relaxation) : r.DEFAULT_RELAXATION,
                this.frictionStiffness = void 0 !== i.frictionStiffness ? Number(i.frictionStiffness) : r.DEFAULT_STIFFNESS,
                this.frictionRelaxation = void 0 !== i.frictionRelaxation ? Number(i.frictionRelaxation) : r.DEFAULT_RELAXATION,
                this.surfaceVelocity = void 0 !== i.surfaceVelocity ? Number(i.surfaceVelocity) : 0,
                this.contactSkinSize = .005
            }
            var n = t("./Material")
              , r = t("../equations/Equation");
            (e.exports = s).idCounter = 0
        }
        , {
            "../equations/Equation": 22,
            "./Material": 28
        }],
        28: [function(t, e, i) {
            function s(t) {
                this.id = t || s.idCounter++
            }
            (e.exports = s).idCounter = 0
        }
        , {}],
        29: [function(t, e, i) {
            var v = {
                GetArea: function(t) {
                    if (t.length < 6)
                        return 0;
                    for (var e = t.length - 2, i = 0, s = 0; s < e; s += 2)
                        i += (t[s + 2] - t[s]) * (t[s + 1] + t[s + 3]);
                    return .5 * -(i += (t[0] - t[e]) * (t[e + 1] + t[1]))
                },
                Triangulate: function(t) {
                    var e = t.length >> 1;
                    if (e < 3)
                        return [];
                    for (var i = [], s = [], n = 0; n < e; n++)
                        s.push(n);
                    n = 0;
                    for (var r = e; 3 < r; ) {
                        var o = s[(n + 0) % r]
                          , a = s[(n + 1) % r]
                          , h = s[(n + 2) % r]
                          , l = t[2 * o]
                          , c = t[2 * o + 1]
                          , d = t[2 * a]
                          , u = t[2 * a + 1]
                          , p = t[2 * h]
                          , g = t[2 * h + 1]
                          , f = !1;
                        if (v._convex(l, c, d, u, p, g)) {
                            f = !0;
                            for (var m = 0; m < r; m++) {
                                var y = s[m];
                                if (y != o && y != a && y != h && v._PointInTriangle(t[2 * y], t[2 * y + 1], l, c, d, u, p, g)) {
                                    f = !1;
                                    break
                                }
                            }
                        }
                        if (f)
                            i.push(o, a, h),
                            s.splice((n + 1) % r, 1),
                            r--,
                            n = 0;
                        else if (n++ > 3 * r)
                            break
                    }
                    return i.push(s[0], s[1], s[2]),
                    i
                },
                _PointInTriangle: function(t, e, i, s, n, r, o, a) {
                    var h = o - i
                      , l = a - s
                      , c = n - i
                      , d = r - s
                      , u = t - i
                      , p = e - s
                      , g = h * h + l * l
                      , f = h * c + l * d
                      , m = h * u + l * p
                      , y = c * c + d * d
                      , v = c * u + d * p
                      , _ = 1 / (g * y - f * f)
                      , b = (y * m - f * v) * _
                      , w = (g * v - f * m) * _;
                    return 0 <= b && 0 <= w && b + w < 1
                },
                _convex: function(t, e, i, s, n, r) {
                    return 0 <= (e - s) * (n - i) + (i - t) * (r - s)
                }
            };
            e.exports = v
        }
        , {}],
        30: [function(t, e, i) {
            var o = e.exports = {}
              , s = t("../utils/Utils");
            o.crossLength = function(t, e) {
                return t[0] * e[1] - t[1] * e[0]
            }
            ,
            o.crossVZ = function(t, e, i) {
                return o.rotate(t, e, -Math.PI / 2),
                o.scale(t, t, i),
                t
            }
            ,
            o.crossZV = function(t, e, i) {
                return o.rotate(t, i, Math.PI / 2),
                o.scale(t, t, e),
                t
            }
            ,
            o.rotate = function(t, e, i) {
                if (0 !== i) {
                    var s = Math.cos(i)
                      , n = Math.sin(i)
                      , r = e[0]
                      , o = e[1];
                    t[0] = s * r - n * o,
                    t[1] = n * r + s * o
                } else
                    t[0] = e[0],
                    t[1] = e[1]
            }
            ,
            o.rotate90cw = function(t, e) {
                var i = e[0]
                  , s = e[1];
                t[0] = s,
                t[1] = -i
            }
            ,
            o.toLocalFrame = function(t, e, i, s) {
                o.copy(t, e),
                o.sub(t, t, i),
                o.rotate(t, t, -s)
            }
            ,
            o.toGlobalFrame = function(t, e, i, s) {
                o.copy(t, e),
                o.rotate(t, t, s),
                o.add(t, t, i)
            }
            ,
            o.vectorToLocalFrame = function(t, e, i) {
                o.rotate(t, e, -i)
            }
            ,
            o.vectorToGlobalFrame = function(t, e, i) {
                o.rotate(t, e, i)
            }
            ,
            o.centroid = function(t, e, i, s) {
                return o.add(t, e, i),
                o.add(t, t, s),
                o.scale(t, t, 1 / 3),
                t
            }
            ,
            o.create = function() {
                var t = new s.ARRAY_TYPE(2);
                return t[0] = 0,
                t[1] = 0,
                t
            }
            ,
            o.clone = function(t) {
                var e = new s.ARRAY_TYPE(2);
                return e[0] = t[0],
                e[1] = t[1],
                e
            }
            ,
            o.fromValues = function(t, e) {
                var i = new s.ARRAY_TYPE(2);
                return i[0] = t,
                i[1] = e,
                i
            }
            ,
            o.copy = function(t, e) {
                return t[0] = e[0],
                t[1] = e[1],
                t
            }
            ,
            o.set = function(t, e, i) {
                return t[0] = e,
                t[1] = i,
                t
            }
            ,
            o.add = function(t, e, i) {
                return t[0] = e[0] + i[0],
                t[1] = e[1] + i[1],
                t
            }
            ,
            o.subtract = function(t, e, i) {
                return t[0] = e[0] - i[0],
                t[1] = e[1] - i[1],
                t
            }
            ,
            o.sub = o.subtract,
            o.multiply = function(t, e, i) {
                return t[0] = e[0] * i[0],
                t[1] = e[1] * i[1],
                t
            }
            ,
            o.mul = o.multiply,
            o.divide = function(t, e, i) {
                return t[0] = e[0] / i[0],
                t[1] = e[1] / i[1],
                t
            }
            ,
            o.div = o.divide,
            o.scale = function(t, e, i) {
                return t[0] = e[0] * i,
                t[1] = e[1] * i,
                t
            }
            ,
            o.distance = function(t, e) {
                var i = e[0] - t[0]
                  , s = e[1] - t[1];
                return Math.sqrt(i * i + s * s)
            }
            ,
            o.dist = o.distance,
            o.squaredDistance = function(t, e) {
                var i = e[0] - t[0]
                  , s = e[1] - t[1];
                return i * i + s * s
            }
            ,
            o.sqrDist = o.squaredDistance,
            o.length = function(t) {
                var e = t[0]
                  , i = t[1];
                return Math.sqrt(e * e + i * i)
            }
            ,
            o.len = o.length,
            o.squaredLength = function(t) {
                var e = t[0]
                  , i = t[1];
                return e * e + i * i
            }
            ,
            o.sqrLen = o.squaredLength,
            o.negate = function(t, e) {
                return t[0] = -e[0],
                t[1] = -e[1],
                t
            }
            ,
            o.normalize = function(t, e) {
                var i = e[0]
                  , s = e[1]
                  , n = i * i + s * s;
                return 0 < n && (n = 1 / Math.sqrt(n),
                t[0] = e[0] * n,
                t[1] = e[1] * n),
                t
            }
            ,
            o.dot = function(t, e) {
                return t[0] * e[0] + t[1] * e[1]
            }
            ,
            o.str = function(t) {
                return "vec2(" + t[0] + ", " + t[1] + ")"
            }
            ,
            o.lerp = function(t, e, i, s) {
                var n = e[0]
                  , r = e[1];
                return t[0] = n + s * (i[0] - n),
                t[1] = r + s * (i[1] - r),
                t
            }
            ,
            o.reflect = function(t, e, i) {
                var s = e[0] * i[0] + e[1] * i[1];
                t[0] = e[0] - 2 * i[0] * s,
                t[1] = e[1] - 2 * i[1] * s
            }
            ,
            o.getLineSegmentsIntersection = function(t, e, i, s, n) {
                var r = o.getLineSegmentsIntersectionFraction(e, i, s, n);
                return !(r < 0 || (t[0] = e[0] + r * (i[0] - e[0]),
                t[1] = e[1] + r * (i[1] - e[1]),
                0))
            }
            ,
            o.getLineSegmentsIntersectionFraction = function(t, e, i, s) {
                var n, r, o = e[0] - t[0], a = e[1] - t[1], h = s[0] - i[0], l = s[1] - i[1];
                return n = (-a * (t[0] - i[0]) + o * (t[1] - i[1])) / (-h * a + o * l),
                r = (h * (t[1] - i[1]) - l * (t[0] - i[0])) / (-h * a + o * l),
                0 <= n && n <= 1 && 0 <= r && r <= 1 ? r : -1
            }
        }
        , {
            "../utils/Utils": 57
        }],
        31: [function(t, e, i) {
            function a(t) {
                t = t || {},
                o.call(this),
                this.id = t.id || ++a._idCounter,
                this.world = null,
                this.shapes = [],
                this.mass = t.mass || 0,
                this.invMass = 0,
                this.inertia = 0,
                this.invInertia = 0,
                this.invMassSolve = 0,
                this.invInertiaSolve = 0,
                this.fixedRotation = !!t.fixedRotation,
                this.fixedX = !!t.fixedX,
                this.fixedY = !!t.fixedY,
                this.massMultiplier = d.create(),
                this.position = d.fromValues(0, 0),
                t.position && d.copy(this.position, t.position),
                this.interpolatedPosition = d.fromValues(0, 0),
                this.interpolatedAngle = 0,
                this.previousPosition = d.fromValues(0, 0),
                this.previousAngle = 0,
                this.velocity = d.fromValues(0, 0),
                t.velocity && d.copy(this.velocity, t.velocity),
                this.vlambda = d.fromValues(0, 0),
                this.wlambda = 0,
                this.angle = t.angle || 0,
                this.angularVelocity = t.angularVelocity || 0,
                this.force = d.create(),
                t.force && d.copy(this.force, t.force),
                this.angularForce = t.angularForce || 0,
                this.damping = "number" == typeof t.damping ? t.damping : .1,
                this.angularDamping = "number" == typeof t.angularDamping ? t.angularDamping : .1,
                this.type = a.STATIC,
                void 0 !== t.type ? this.type = t.type : t.mass ? this.type = a.DYNAMIC : this.type = a.STATIC,
                this.boundingRadius = 0,
                this.aabb = new r,
                this.aabbNeedsUpdate = !0,
                this.allowSleep = void 0 === t.allowSleep || t.allowSleep,
                this.wantsToSleep = !1,
                this.sleepState = a.AWAKE,
                this.sleepSpeedLimit = void 0 !== t.sleepSpeedLimit ? t.sleepSpeedLimit : .2,
                this.sleepTimeLimit = void 0 !== t.sleepTimeLimit ? t.sleepTimeLimit : 1,
                this.gravityScale = void 0 !== t.gravityScale ? t.gravityScale : 1,
                this.collisionResponse = void 0 === t.collisionResponse || t.collisionResponse,
                this.idleTime = 0,
                this.timeLastSleepy = 0,
                this.ccdSpeedThreshold = void 0 !== t.ccdSpeedThreshold ? t.ccdSpeedThreshold : -1,
                this.ccdIterations = void 0 !== t.ccdIterations ? t.ccdIterations : 10,
                this.concavePath = null,
                this._wakeUpAfterNarrowphase = !1,
                this.updateMassProperties()
            }
            var d = t("../math/vec2")
              , l = t("poly-decomp")
              , c = t("../shapes/Convex")
              , s = t("../collision/RaycastResult")
              , n = t("../collision/Ray")
              , r = t("../collision/AABB")
              , o = t("../events/EventEmitter");
            (((e.exports = a).prototype = new o).constructor = a)._idCounter = 0,
            a.prototype.updateSolveMassProperties = function() {
                this.sleepState === a.SLEEPING || this.type === a.KINEMATIC ? (this.invMassSolve = 0,
                this.invInertiaSolve = 0) : (this.invMassSolve = this.invMass,
                this.invInertiaSolve = this.invInertia)
            }
            ,
            a.prototype.setDensity = function(t) {
                var e = this.getArea();
                this.mass = e * t,
                this.updateMassProperties()
            }
            ,
            a.prototype.getArea = function() {
                for (var t = 0, e = 0; e < this.shapes.length; e++)
                    t += this.shapes[e].area;
                return t
            }
            ,
            a.prototype.getAABB = function() {
                return this.aabbNeedsUpdate && this.updateAABB(),
                this.aabb
            }
            ;
            var h = new r
              , u = d.create();
            a.prototype.updateAABB = function() {
                for (var t = this.shapes, e = t.length, i = u, s = this.angle, n = 0; n !== e; n++) {
                    var r = t[n]
                      , o = r.angle + s;
                    d.rotate(i, r.position, s),
                    d.add(i, i, this.position),
                    r.computeAABB(h, i, o),
                    0 === n ? this.aabb.copy(h) : this.aabb.extend(h)
                }
                this.aabbNeedsUpdate = !1
            }
            ,
            a.prototype.updateBoundingRadius = function() {
                for (var t = this.shapes, e = t.length, i = 0, s = 0; s !== e; s++) {
                    var n = t[s]
                      , r = d.length(n.position)
                      , o = n.boundingRadius;
                    i < r + o && (i = r + o)
                }
                this.boundingRadius = i
            }
            ,
            a.prototype.addShape = function(t, e, i) {
                if (t.body)
                    throw new Error("A shape can only be added to one body.");
                t.body = this,
                e ? d.copy(t.position, e) : d.set(t.position, 0, 0),
                t.angle = i || 0,
                this.shapes.push(t),
                this.updateMassProperties(),
                this.updateBoundingRadius(),
                this.aabbNeedsUpdate = !0
            }
            ,
            a.prototype.removeShape = function(t) {
                var e = this.shapes.indexOf(t);
                return -1 !== e && (this.shapes.splice(e, 1),
                this.aabbNeedsUpdate = !0,
                !(t.body = null))
            }
            ,
            a.prototype.updateMassProperties = function() {
                if (this.type === a.STATIC || this.type === a.KINEMATIC)
                    this.mass = Number.MAX_VALUE,
                    this.invMass = 0,
                    this.inertia = Number.MAX_VALUE,
                    this.invInertia = 0;
                else {
                    var t = this.shapes
                      , e = t.length
                      , i = this.mass / e
                      , s = 0;
                    if (this.fixedRotation)
                        this.inertia = Number.MAX_VALUE,
                        this.invInertia = 0;
                    else {
                        for (var n = 0; n < e; n++) {
                            var r = t[n]
                              , o = d.squaredLength(r.position);
                            s += r.computeMomentOfInertia(i) + i * o
                        }
                        this.inertia = s,
                        this.invInertia = 0 < s ? 1 / s : 0
                    }
                    this.invMass = 1 / this.mass,
                    d.set(this.massMultiplier, this.fixedX ? 0 : 1, this.fixedY ? 0 : 1)
                }
            }
            ,
            d.create(),
            a.prototype.applyForce = function(t, e) {
                if (d.add(this.force, this.force, t),
                e) {
                    var i = d.crossLength(e, t);
                    this.angularForce += i
                }
            }
            ;
            var p = d.create()
              , g = d.create()
              , f = d.create();
            a.prototype.applyForceLocal = function(t, e) {
                e = e || f;
                var i = p
                  , s = g;
                this.vectorToWorldFrame(i, t),
                this.vectorToWorldFrame(s, e),
                this.applyForce(i, s)
            }
            ;
            var m = d.create();
            a.prototype.applyImpulse = function(t, e) {
                if (this.type === a.DYNAMIC) {
                    var i = m;
                    if (d.scale(i, t, this.invMass),
                    d.multiply(i, this.massMultiplier, i),
                    d.add(this.velocity, i, this.velocity),
                    e) {
                        var s = d.crossLength(e, t);
                        s *= this.invInertia,
                        this.angularVelocity += s
                    }
                }
            }
            ;
            var y = d.create()
              , v = d.create()
              , _ = d.create();
            a.prototype.applyImpulseLocal = function(t, e) {
                e = e || _;
                var i = y
                  , s = v;
                this.vectorToWorldFrame(i, t),
                this.vectorToWorldFrame(s, e),
                this.applyImpulse(i, s)
            }
            ,
            a.prototype.toLocalFrame = function(t, e) {
                d.toLocalFrame(t, e, this.position, this.angle)
            }
            ,
            a.prototype.toWorldFrame = function(t, e) {
                d.toGlobalFrame(t, e, this.position, this.angle)
            }
            ,
            a.prototype.vectorToLocalFrame = function(t, e) {
                d.vectorToLocalFrame(t, e, this.angle)
            }
            ,
            a.prototype.vectorToWorldFrame = function(t, e) {
                d.vectorToGlobalFrame(t, e, this.angle)
            }
            ,
            a.prototype.fromPolygon = function(t, e) {
                e = e || {};
                for (var i = this.shapes.length; 0 <= i; --i)
                    this.removeShape(this.shapes[i]);
                var s, n = new l.Polygon;
                if (n.vertices = t,
                n.makeCCW(),
                "number" == typeof e.removeCollinearPoints && n.removeCollinearPoints(e.removeCollinearPoints),
                void 0 === e.skipSimpleCheck && !n.isSimple())
                    return !1;
                this.concavePath = n.vertices.slice(0);
                for (i = 0; i < this.concavePath.length; i++) {
                    var r = [0, 0];
                    d.copy(r, this.concavePath[i]),
                    this.concavePath[i] = r
                }
                s = e.optimalDecomp ? n.decomp() : n.quickDecomp();
                var o = d.create();
                for (i = 0; i !== s.length; i++) {
                    for (var a = new c({
                        vertices: s[i].vertices
                    }), h = 0; h !== a.vertices.length; h++) {
                        r = a.vertices[h];
                        d.sub(r, r, a.centerOfMass)
                    }
                    d.scale(o, a.centerOfMass, 1),
                    a.updateTriangles(),
                    a.updateCenterOfMass(),
                    a.updateBoundingRadius(),
                    this.addShape(a, o)
                }
                return this.adjustCenterOfMass(),
                this.aabbNeedsUpdate = !0
            }
            ;
            var b = (d.fromValues(0, 0),
            d.fromValues(0, 0))
              , w = d.fromValues(0, 0)
              , x = d.fromValues(0, 0);
            a.prototype.adjustCenterOfMass = function() {
                var t = b
                  , e = w
                  , i = x
                  , s = 0;
                d.set(e, 0, 0);
                for (var n = 0; n !== this.shapes.length; n++) {
                    var r = this.shapes[n];
                    d.scale(t, r.position, r.area),
                    d.add(e, e, t),
                    s += r.area
                }
                d.scale(i, e, 1 / s);
                for (n = 0; n !== this.shapes.length; n++) {
                    r = this.shapes[n];
                    d.sub(r.position, r.position, i)
                }
                d.add(this.position, this.position, i);
                for (n = 0; this.concavePath && n < this.concavePath.length; n++)
                    d.sub(this.concavePath[n], this.concavePath[n], i);
                this.updateMassProperties(),
                this.updateBoundingRadius()
            }
            ,
            a.prototype.setZeroForce = function() {
                d.set(this.force, 0, 0),
                this.angularForce = 0
            }
            ,
            a.prototype.resetConstraintVelocity = function() {
                var t = this.vlambda;
                d.set(t, 0, 0),
                this.wlambda = 0
            }
            ,
            a.prototype.addConstraintVelocity = function() {
                var t = this.velocity;
                d.add(t, t, this.vlambda),
                this.angularVelocity += this.wlambda
            }
            ,
            a.prototype.applyDamping = function(t) {
                if (this.type === a.DYNAMIC) {
                    var e = this.velocity;
                    d.scale(e, e, Math.pow(1 - this.damping, t)),
                    this.angularVelocity *= Math.pow(1 - this.angularDamping, t)
                }
            }
            ,
            a.prototype.wakeUp = function() {
                var t = this.sleepState;
                this.sleepState = a.AWAKE,
                this.idleTime = 0,
                t !== a.AWAKE && this.emit(a.wakeUpEvent)
            }
            ,
            a.prototype.sleep = function() {
                this.sleepState = a.SLEEPING,
                this.angularVelocity = 0,
                this.angularForce = 0,
                d.set(this.velocity, 0, 0),
                d.set(this.force, 0, 0),
                this.emit(a.sleepEvent)
            }
            ,
            a.prototype.sleepTick = function(t, e, i) {
                this.allowSleep && this.type !== a.SLEEPING && (this.wantsToSleep = !1,
                this.sleepState,
                d.squaredLength(this.velocity) + Math.pow(this.angularVelocity, 2) >= Math.pow(this.sleepSpeedLimit, 2) ? (this.idleTime = 0,
                this.sleepState = a.AWAKE) : (this.idleTime += i,
                this.sleepState = a.SLEEPY),
                this.idleTime > this.sleepTimeLimit && (e ? this.wantsToSleep = !0 : this.sleep()))
            }
            ,
            a.prototype.overlaps = function(t) {
                return this.world.overlapKeeper.bodiesAreOverlapping(this, t)
            }
            ;
            var S = d.create()
              , T = d.create();
            a.prototype.integrate = function(t) {
                var e = this.invMass
                  , i = this.force
                  , s = this.position
                  , n = this.velocity;
                d.copy(this.previousPosition, this.position),
                this.previousAngle = this.angle,
                this.fixedRotation || (this.angularVelocity += this.angularForce * this.invInertia * t),
                d.scale(S, i, t * e),
                d.multiply(S, this.massMultiplier, S),
                d.add(n, S, n),
                this.integrateToTimeOfImpact(t) || (d.scale(T, n, t),
                d.add(s, s, T),
                this.fixedRotation || (this.angle += this.angularVelocity * t)),
                this.aabbNeedsUpdate = !0
            }
            ;
            var A = new s
              , C = new n({
                mode: n.ALL
            })
              , P = d.create()
              , E = d.create()
              , I = d.create()
              , k = d.create();
            a.prototype.integrateToTimeOfImpact = function(t) {
                if (this.ccdSpeedThreshold < 0 || d.squaredLength(this.velocity) < Math.pow(this.ccdSpeedThreshold, 2))
                    return !1;
                d.normalize(P, this.velocity),
                d.scale(E, this.velocity, t),
                d.add(E, E, this.position),
                d.sub(I, E, this.position);
                var e, i = this.angularVelocity * t, s = d.length(I), n = 1, r = this;
                if (A.reset(),
                C.callback = function(t) {
                    t.body !== r && (e = t.body,
                    t.getHitPoint(E, C),
                    d.sub(I, E, r.position),
                    n = d.length(I) / s,
                    t.stop())
                }
                ,
                d.copy(C.from, this.position),
                d.copy(C.to, E),
                C.update(),
                this.world.raycast(A, C),
                !e)
                    return !1;
                var o = this.angle;
                d.copy(k, this.position);
                for (var a = 0, h = 0, l = 0, c = n; h <= c && a < this.ccdIterations; )
                    a++,
                    l = (c - h) / 2,
                    d.scale(T, I, n),
                    d.add(this.position, k, T),
                    this.angle = o + i * n,
                    this.updateAABB(),
                    this.aabb.overlaps(e.aabb) && this.world.narrowphase.bodiesOverlap(this, e) ? h = l : c = l;
                return n = l,
                d.copy(this.position, k),
                this.angle = o,
                d.scale(T, I, n),
                d.add(this.position, this.position, T),
                this.fixedRotation || (this.angle += i * n),
                !0
            }
            ,
            a.prototype.getVelocityAtPoint = function(t, e) {
                return d.crossVZ(t, e, this.angularVelocity),
                d.subtract(t, this.velocity, t),
                t
            }
            ,
            a.sleepyEvent = {
                type: "sleepy"
            },
            a.sleepEvent = {
                type: "sleep"
            },
            a.wakeUpEvent = {
                type: "wakeup"
            },
            a.DYNAMIC = 1,
            a.STATIC = 2,
            a.KINEMATIC = 4,
            a.AWAKE = 0,
            a.SLEEPY = 1,
            a.SLEEPING = 2
        }
        , {
            "../collision/AABB": 7,
            "../collision/Ray": 11,
            "../collision/RaycastResult": 12,
            "../events/EventEmitter": 26,
            "../math/vec2": 30,
            "../shapes/Convex": 40,
            "poly-decomp": 5
        }],
        32: [function(t, e, i) {
            function s(t, e, i) {
                i = i || {},
                o.call(this, t, e, i),
                this.localAnchorA = y.fromValues(0, 0),
                this.localAnchorB = y.fromValues(0, 0),
                i.localAnchorA && y.copy(this.localAnchorA, i.localAnchorA),
                i.localAnchorB && y.copy(this.localAnchorB, i.localAnchorB),
                i.worldAnchorA && this.setWorldAnchorA(i.worldAnchorA),
                i.worldAnchorB && this.setWorldAnchorB(i.worldAnchorB);
                var s = y.create()
                  , n = y.create();
                this.getWorldAnchorA(s),
                this.getWorldAnchorB(n);
                var r = y.distance(s, n);
                this.restLength = "number" == typeof i.restLength ? i.restLength : r
            }
            var y = t("../math/vec2")
              , o = t("./Spring");
            t("../utils/Utils"),
            (((e.exports = s).prototype = new o).constructor = s).prototype.setWorldAnchorA = function(t) {
                this.bodyA.toLocalFrame(this.localAnchorA, t)
            }
            ,
            s.prototype.setWorldAnchorB = function(t) {
                this.bodyB.toLocalFrame(this.localAnchorB, t)
            }
            ,
            s.prototype.getWorldAnchorA = function(t) {
                this.bodyA.toWorldFrame(t, this.localAnchorA)
            }
            ,
            s.prototype.getWorldAnchorB = function(t) {
                this.bodyB.toWorldFrame(t, this.localAnchorB)
            }
            ;
            var v = y.create()
              , _ = y.create()
              , b = y.create()
              , w = y.create()
              , x = y.create()
              , S = y.create()
              , T = y.create()
              , A = y.create()
              , C = y.create();
            s.prototype.applyForce = function() {
                var t = this.stiffness
                  , e = this.damping
                  , i = this.restLength
                  , s = this.bodyA
                  , n = this.bodyB
                  , r = v
                  , o = _
                  , a = b
                  , h = w
                  , l = C
                  , c = x
                  , d = S
                  , u = T
                  , p = A;
                this.getWorldAnchorA(c),
                this.getWorldAnchorB(d),
                y.sub(u, c, s.position),
                y.sub(p, d, n.position),
                y.sub(r, d, c);
                var g = y.len(r);
                y.normalize(o, r),
                y.sub(a, n.velocity, s.velocity),
                y.crossZV(l, n.angularVelocity, p),
                y.add(a, a, l),
                y.crossZV(l, s.angularVelocity, u),
                y.sub(a, a, l),
                y.scale(h, o, -t * (g - i) - e * y.dot(a, o)),
                y.sub(s.force, s.force, h),
                y.add(n.force, n.force, h);
                var f = y.crossLength(u, h)
                  , m = y.crossLength(p, h);
                s.angularForce -= f,
                n.angularForce += m
            }
        }
        , {
            "../math/vec2": 30,
            "../utils/Utils": 57,
            "./Spring": 34
        }],
        33: [function(t, e, i) {
            function s(t, e, i) {
                i = i || {},
                n.call(this, t, e, i),
                this.restAngle = "number" == typeof i.restAngle ? i.restAngle : e.angle - t.angle
            }
            var n = (t("../math/vec2"),
            t("./Spring"));
            (((e.exports = s).prototype = new n).constructor = s).prototype.applyForce = function() {
                var t = this.stiffness
                  , e = this.damping
                  , i = this.restAngle
                  , s = this.bodyA
                  , n = this.bodyB
                  , r = -t * (n.angle - s.angle - i) - e * (n.angularVelocity - s.angularVelocity) * 0;
                s.angularForce -= r,
                n.angularForce += r
            }
        }
        , {
            "../math/vec2": 30,
            "./Spring": 34
        }],
        34: [function(t, e, i) {
            function s(t, e, i) {
                i = n.defaults(i, {
                    stiffness: 100,
                    damping: 1
                }),
                this.stiffness = i.stiffness,
                this.damping = i.damping,
                this.bodyA = t,
                this.bodyB = e
            }
            var n = (t("../math/vec2"),
            t("../utils/Utils"));
            (e.exports = s).prototype.applyForce = function() {}
        }
        , {
            "../math/vec2": 30,
            "../utils/Utils": 57
        }],
        35: [function(t, e, i) {
            function s(t, e) {
                e = e || {},
                this.chassisBody = t,
                this.wheels = [],
                this.groundBody = new h({
                    mass: 0
                }),
                this.world = null;
                var i = this;
                this.preStepCallback = function() {
                    i.update()
                }
            }
            function n(t, e) {
                e = e || {},
                this.vehicle = t,
                this.forwardEquation = new a(t.chassisBody,t.groundBody),
                this.sideEquation = new a(t.chassisBody,t.groundBody),
                this.steerValue = 0,
                this.engineForce = 0,
                this.setSideFriction(void 0 !== e.sideFriction ? e.sideFriction : 5),
                this.localForwardVector = r.fromValues(0, 1),
                e.localForwardVector && r.copy(this.localForwardVector, e.localForwardVector),
                this.localPosition = r.fromValues(0, 0),
                e.localPosition && r.copy(this.localPosition, e.localPosition),
                o.apply(this, t.chassisBody, t.groundBody),
                this.equations.push(this.forwardEquation, this.sideEquation),
                this.setBrakeForce(0)
            }
            var r = t("../math/vec2")
              , o = (t("../utils/Utils"),
            t("../constraints/Constraint"))
              , a = t("../equations/FrictionEquation")
              , h = t("../objects/Body");
            (e.exports = s).prototype.addToWorld = function(t) {
                (this.world = t).addBody(this.groundBody),
                t.on("preStep", this.preStepCallback);
                for (var e = 0; e < this.wheels.length; e++) {
                    var i = this.wheels[e];
                    t.addConstraint(i)
                }
            }
            ,
            s.prototype.removeFromWorld = function() {
                var t = this.world;
                t.removeBody(this.groundBody),
                t.off("preStep", this.preStepCallback);
                for (var e = 0; e < this.wheels.length; e++) {
                    var i = this.wheels[e];
                    t.removeConstraint(i)
                }
                this.world = null
            }
            ,
            s.prototype.addWheel = function(t) {
                var e = new n(this,t);
                return this.wheels.push(e),
                e
            }
            ,
            s.prototype.update = function() {
                for (var t = 0; t < this.wheels.length; t++)
                    this.wheels[t].update()
            }
            ,
            (n.prototype = new o).setBrakeForce = function(t) {
                this.forwardEquation.setSlipForce(t)
            }
            ,
            n.prototype.setSideFriction = function(t) {
                this.sideEquation.setSlipForce(t)
            }
            ;
            var l = r.create()
              , c = r.create();
            n.prototype.getSpeed = function() {
                return this.vehicle.chassisBody.vectorToWorldFrame(c, this.localForwardVector),
                this.vehicle.chassisBody.getVelocityAtPoint(l, c),
                r.dot(l, c)
            }
            ;
            var d = r.create();
            n.prototype.update = function() {
                this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.t, this.localForwardVector),
                r.rotate(this.sideEquation.t, this.localForwardVector, Math.PI / 2),
                this.vehicle.chassisBody.vectorToWorldFrame(this.sideEquation.t, this.sideEquation.t),
                r.rotate(this.forwardEquation.t, this.forwardEquation.t, this.steerValue),
                r.rotate(this.sideEquation.t, this.sideEquation.t, this.steerValue),
                this.vehicle.chassisBody.toWorldFrame(this.forwardEquation.contactPointB, this.localPosition),
                r.copy(this.sideEquation.contactPointB, this.forwardEquation.contactPointB),
                this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.contactPointA, this.localPosition),
                r.copy(this.sideEquation.contactPointA, this.forwardEquation.contactPointA),
                r.normalize(d, this.forwardEquation.t),
                r.scale(d, d, this.engineForce),
                this.vehicle.chassisBody.applyForce(d, this.forwardEquation.contactPointA)
            }
        }
        , {
            "../constraints/Constraint": 14,
            "../equations/FrictionEquation": 23,
            "../math/vec2": 30,
            "../objects/Body": 31,
            "../utils/Utils": 57
        }],
        36: [function(t, e, i) {
            var s = e.exports = {
                AABB: t("./collision/AABB"),
                AngleLockEquation: t("./equations/AngleLockEquation"),
                Body: t("./objects/Body"),
                Broadphase: t("./collision/Broadphase"),
                Capsule: t("./shapes/Capsule"),
                Circle: t("./shapes/Circle"),
                Constraint: t("./constraints/Constraint"),
                ContactEquation: t("./equations/ContactEquation"),
                ContactEquationPool: t("./utils/ContactEquationPool"),
                ContactMaterial: t("./material/ContactMaterial"),
                Convex: t("./shapes/Convex"),
                DistanceConstraint: t("./constraints/DistanceConstraint"),
                Equation: t("./equations/Equation"),
                EventEmitter: t("./events/EventEmitter"),
                FrictionEquation: t("./equations/FrictionEquation"),
                FrictionEquationPool: t("./utils/FrictionEquationPool"),
                GearConstraint: t("./constraints/GearConstraint"),
                GSSolver: t("./solver/GSSolver"),
                Heightfield: t("./shapes/Heightfield"),
                Line: t("./shapes/Line"),
                LockConstraint: t("./constraints/LockConstraint"),
                Material: t("./material/Material"),
                Narrowphase: t("./collision/Narrowphase"),
                NaiveBroadphase: t("./collision/NaiveBroadphase"),
                Particle: t("./shapes/Particle"),
                Plane: t("./shapes/Plane"),
                Pool: t("./utils/Pool"),
                RevoluteConstraint: t("./constraints/RevoluteConstraint"),
                PrismaticConstraint: t("./constraints/PrismaticConstraint"),
                Ray: t("./collision/Ray"),
                RaycastResult: t("./collision/RaycastResult"),
                Box: t("./shapes/Box"),
                RotationalVelocityEquation: t("./equations/RotationalVelocityEquation"),
                SAPBroadphase: t("./collision/SAPBroadphase"),
                Shape: t("./shapes/Shape"),
                Solver: t("./solver/Solver"),
                Spring: t("./objects/Spring"),
                TopDownVehicle: t("./objects/TopDownVehicle"),
                LinearSpring: t("./objects/LinearSpring"),
                RotationalSpring: t("./objects/RotationalSpring"),
                Utils: t("./utils/Utils"),
                World: t("./world/World"),
                vec2: t("./math/vec2"),
                version: t("../package.json").version
            };
            Object.defineProperty(s, "Rectangle", {
                get: function() {
                    return this.Box
                }
            })
        }
        , {
            "../package.json": 6,
            "./collision/AABB": 7,
            "./collision/Broadphase": 8,
            "./collision/NaiveBroadphase": 9,
            "./collision/Narrowphase": 10,
            "./collision/Ray": 11,
            "./collision/RaycastResult": 12,
            "./collision/SAPBroadphase": 13,
            "./constraints/Constraint": 14,
            "./constraints/DistanceConstraint": 15,
            "./constraints/GearConstraint": 16,
            "./constraints/LockConstraint": 17,
            "./constraints/PrismaticConstraint": 18,
            "./constraints/RevoluteConstraint": 19,
            "./equations/AngleLockEquation": 20,
            "./equations/ContactEquation": 21,
            "./equations/Equation": 22,
            "./equations/FrictionEquation": 23,
            "./equations/RotationalVelocityEquation": 25,
            "./events/EventEmitter": 26,
            "./material/ContactMaterial": 27,
            "./material/Material": 28,
            "./math/vec2": 30,
            "./objects/Body": 31,
            "./objects/LinearSpring": 32,
            "./objects/RotationalSpring": 33,
            "./objects/Spring": 34,
            "./objects/TopDownVehicle": 35,
            "./shapes/Box": 37,
            "./shapes/Capsule": 38,
            "./shapes/Circle": 39,
            "./shapes/Convex": 40,
            "./shapes/Heightfield": 41,
            "./shapes/Line": 42,
            "./shapes/Particle": 43,
            "./shapes/Plane": 44,
            "./shapes/Shape": 45,
            "./solver/GSSolver": 46,
            "./solver/Solver": 47,
            "./utils/ContactEquationPool": 48,
            "./utils/FrictionEquationPool": 49,
            "./utils/Pool": 55,
            "./utils/Utils": 57,
            "./world/World": 61
        }],
        37: [function(t, e, i) {
            function s(t) {
                "number" == typeof t && "number" == typeof arguments[1] && (t = {
                    width: t,
                    height: arguments[1]
                }),
                t = t || {};
                var e = this.width = t.width || 1
                  , i = this.height = t.height || 1
                  , s = [r.fromValues(-e / 2, -i / 2), r.fromValues(e / 2, -i / 2), r.fromValues(e / 2, i / 2), r.fromValues(-e / 2, i / 2)]
                  , n = [r.fromValues(1, 0), r.fromValues(0, 1)];
                t.vertices = s,
                t.axes = n,
                t.type = o.BOX,
                a.call(this, t)
            }
            var r = t("../math/vec2")
              , o = t("./Shape")
              , a = t("./Convex");
            (((e.exports = s).prototype = new a).constructor = s).prototype.computeMomentOfInertia = function(t) {
                var e = this.width
                  , i = this.height;
                return t * (i * i + e * e) / 12
            }
            ,
            s.prototype.updateBoundingRadius = function() {
                var t = this.width
                  , e = this.height;
                this.boundingRadius = Math.sqrt(t * t + e * e) / 2
            }
            ,
            r.create(),
            r.create(),
            r.create(),
            r.create(),
            s.prototype.computeAABB = function(t, e, i) {
                t.setFromPoints(this.vertices, e, i, 0)
            }
            ,
            s.prototype.updateArea = function() {
                this.area = this.width * this.height
            }
        }
        , {
            "../math/vec2": 30,
            "./Convex": 40,
            "./Shape": 45
        }],
        38: [function(t, e, i) {
            function s(t) {
                "number" == typeof t && "number" == typeof arguments[1] && (t = {
                    length: t,
                    radius: arguments[1]
                }),
                t = t || {},
                this.length = t.length || 1,
                this.radius = t.radius || 1,
                t.type = n.CAPSULE,
                n.call(this, t)
            }
            var n = t("./Shape")
              , x = t("../math/vec2");
            (((e.exports = s).prototype = new n).constructor = s).prototype.computeMomentOfInertia = function(t) {
                var e = this.radius
                  , i = this.length + e
                  , s = 2 * e;
                return t * (s * s + i * i) / 12
            }
            ,
            s.prototype.updateBoundingRadius = function() {
                this.boundingRadius = this.radius + this.length / 2
            }
            ,
            s.prototype.updateArea = function() {
                this.area = Math.PI * this.radius * this.radius + 2 * this.radius * this.length
            }
            ;
            var r = x.create();
            s.prototype.computeAABB = function(t, e, i) {
                var s = this.radius;
                x.set(r, this.length / 2, 0),
                0 !== i && x.rotate(r, r, i),
                x.set(t.upperBound, Math.max(r[0] + s, -r[0] + s), Math.max(r[1] + s, -r[1] + s)),
                x.set(t.lowerBound, Math.min(r[0] - s, -r[0] - s), Math.min(r[1] - s, -r[1] - s)),
                x.add(t.lowerBound, t.lowerBound, e),
                x.add(t.upperBound, t.upperBound, e)
            }
            ;
            var S = x.create()
              , T = x.create()
              , A = x.create()
              , C = x.create()
              , P = x.fromValues(0, 1);
            s.prototype.raycast = function(t, e, i, s) {
                for (var n = e.from, r = e.to, o = (e.direction,
                S), a = T, h = A, l = C, c = this.length / 2, d = 0; d < 2; d++) {
                    var u = this.radius * (2 * d - 1);
                    if (x.set(h, -c, u),
                    x.set(l, c, u),
                    x.toGlobalFrame(h, h, i, s),
                    x.toGlobalFrame(l, l, i, s),
                    0 <= (g = x.getLineSegmentsIntersectionFraction(n, r, h, l)) && (x.rotate(a, P, s),
                    x.scale(a, a, 2 * d - 1),
                    e.reportIntersection(t, g, a, -1),
                    t.shouldStop(e)))
                        return
                }
                var p = Math.pow(this.radius, 2) + Math.pow(c, 2);
                for (d = 0; d < 2; d++) {
                    x.set(h, c * (2 * d - 1), 0),
                    x.toGlobalFrame(h, h, i, s);
                    var g, f = Math.pow(r[0] - n[0], 2) + Math.pow(r[1] - n[1], 2), m = 2 * ((r[0] - n[0]) * (n[0] - h[0]) + (r[1] - n[1]) * (n[1] - h[1])), y = Math.pow(n[0] - h[0], 2) + Math.pow(n[1] - h[1], 2) - Math.pow(this.radius, 2);
                    if (!((g = Math.pow(m, 2) - 4 * f * y) < 0))
                        if (0 === g) {
                            if (x.lerp(o, n, r, g),
                            x.squaredDistance(o, i) > p && (x.sub(a, o, h),
                            x.normalize(a, a),
                            e.reportIntersection(t, g, a, -1),
                            t.shouldStop(e)))
                                return
                        } else {
                            var v = Math.sqrt(g)
                              , _ = 1 / (2 * f)
                              , b = (-m - v) * _
                              , w = (-m + v) * _;
                            if (0 <= b && b <= 1 && (x.lerp(o, n, r, b),
                            x.squaredDistance(o, i) > p && (x.sub(a, o, h),
                            x.normalize(a, a),
                            e.reportIntersection(t, b, a, -1),
                            t.shouldStop(e))))
                                return;
                            if (0 <= w && w <= 1 && (x.lerp(o, n, r, w),
                            x.squaredDistance(o, i) > p && (x.sub(a, o, h),
                            x.normalize(a, a),
                            e.reportIntersection(t, w, a, -1),
                            t.shouldStop(e))))
                                return
                        }
                }
            }
        }
        , {
            "../math/vec2": 30,
            "./Shape": 45
        }],
        39: [function(t, e, i) {
            function s(t) {
                "number" == typeof t && (t = {
                    radius: t
                }),
                t = t || {},
                this.radius = t.radius || 1,
                t.type = n.CIRCLE,
                n.call(this, t)
            }
            var n = t("./Shape")
              , y = t("../math/vec2");
            (((e.exports = s).prototype = new n).constructor = s).prototype.computeMomentOfInertia = function(t) {
                var e = this.radius;
                return t * e * e / 2
            }
            ,
            s.prototype.updateBoundingRadius = function() {
                this.boundingRadius = this.radius
            }
            ,
            s.prototype.updateArea = function() {
                this.area = Math.PI * this.radius * this.radius
            }
            ,
            s.prototype.computeAABB = function(t, e, i) {
                var s = this.radius;
                y.set(t.upperBound, s, s),
                y.set(t.lowerBound, -s, -s),
                e && (y.add(t.lowerBound, t.lowerBound, e),
                y.add(t.upperBound, t.upperBound, e))
            }
            ;
            var v = y.create()
              , _ = y.create();
            s.prototype.raycast = function(t, e, i, s) {
                var n = e.from
                  , r = e.to
                  , o = this.radius
                  , a = Math.pow(r[0] - n[0], 2) + Math.pow(r[1] - n[1], 2)
                  , h = 2 * ((r[0] - n[0]) * (n[0] - i[0]) + (r[1] - n[1]) * (n[1] - i[1]))
                  , l = Math.pow(n[0] - i[0], 2) + Math.pow(n[1] - i[1], 2) - Math.pow(o, 2)
                  , c = Math.pow(h, 2) - 4 * a * l
                  , d = v
                  , u = _;
                if (!(c < 0))
                    if (0 === c)
                        y.lerp(d, n, r, c),
                        y.sub(u, d, i),
                        y.normalize(u, u),
                        e.reportIntersection(t, c, u, -1);
                    else {
                        var p = Math.sqrt(c)
                          , g = 1 / (2 * a)
                          , f = (-h - p) * g
                          , m = (-h + p) * g;
                        if (0 <= f && f <= 1 && (y.lerp(d, n, r, f),
                        y.sub(u, d, i),
                        y.normalize(u, u),
                        e.reportIntersection(t, f, u, -1),
                        t.shouldStop(e)))
                            return;
                        0 <= m && m <= 1 && (y.lerp(d, n, r, m),
                        y.sub(u, d, i),
                        y.normalize(u, u),
                        e.reportIntersection(t, m, u, -1))
                    }
            }
        }
        , {
            "../math/vec2": 30,
            "./Shape": 45
        }],
        40: [function(t, e, i) {
            function u(t) {
                Array.isArray(t) && (t = {
                    vertices: t,
                    axes: arguments[1]
                }),
                t = t || {},
                this.vertices = [];
                for (var e = void 0 !== t.vertices ? t.vertices : [], i = 0; i < e.length; i++) {
                    var s = p.create();
                    p.copy(s, e[i]),
                    this.vertices.push(s)
                }
                if (this.axes = [],
                t.axes)
                    for (i = 0; i < t.axes.length; i++) {
                        var n = p.create();
                        p.copy(n, t.axes[i]),
                        this.axes.push(n)
                    }
                else
                    for (i = 0; i < this.vertices.length; i++) {
                        var r = this.vertices[i]
                          , o = this.vertices[(i + 1) % this.vertices.length]
                          , a = p.create();
                        p.sub(a, o, r),
                        p.rotate90cw(a, a),
                        p.normalize(a, a),
                        this.axes.push(a)
                    }
                if (this.centerOfMass = p.fromValues(0, 0),
                this.triangles = [],
                this.vertices.length && (this.updateTriangles(),
                this.updateCenterOfMass()),
                this.boundingRadius = 0,
                t.type = h.CONVEX,
                h.call(this, t),
                this.updateBoundingRadius(),
                this.updateArea(),
                this.area < 0)
                    throw new Error("Convex vertices must be given in conter-clockwise winding.")
            }
            var h = t("./Shape")
              , p = t("../math/vec2")
              , a = t("../math/polyk");
            t("poly-decomp"),
            ((e.exports = u).prototype = new h).constructor = u;
            var l = p.create()
              , o = p.create();
            u.prototype.projectOntoLocalAxis = function(t, e) {
                for (var i, s, n = null, r = null, o = (t = l,
                0); o < this.vertices.length; o++)
                    i = this.vertices[o],
                    s = p.dot(i, t),
                    (null === n || n < s) && (n = s),
                    (null === r || s < r) && (r = s);
                if (n < r) {
                    var a = r;
                    r = n,
                    n = a
                }
                p.set(e, r, n)
            }
            ,
            u.prototype.projectOntoWorldAxis = function(t, e, i, s) {
                var n = o;
                this.projectOntoLocalAxis(t, s),
                0 !== i ? p.rotate(n, t, i) : n = t;
                var r = p.dot(e, n);
                p.set(s, s[0] + r, s[1] + r)
            }
            ,
            u.prototype.updateTriangles = function() {
                for (var t = [], e = this.triangles.length = 0; e < this.vertices.length; e++) {
                    var i = this.vertices[e];
                    t.push(i[0], i[1])
                }
                var s = a.Triangulate(t);
                for (e = 0; e < s.length; e += 3) {
                    var n = s[e]
                      , r = s[e + 1]
                      , o = s[e + 2];
                    this.triangles.push([n, r, o])
                }
            }
            ;
            var g = p.create()
              , f = p.create()
              , m = p.create()
              , y = p.create()
              , v = p.create();
            p.create(),
            p.create(),
            p.create(),
            p.create(),
            u.prototype.updateCenterOfMass = function() {
                var t = this.triangles
                  , e = this.vertices
                  , i = this.centerOfMass
                  , s = g
                  , n = m
                  , r = y
                  , o = v
                  , a = f;
                p.set(i, 0, 0);
                for (var h = 0, l = 0; l !== t.length; l++) {
                    var c = t[l];
                    n = e[c[0]],
                    r = e[c[1]],
                    o = e[c[2]];
                    p.centroid(s, n, r, o);
                    var d = u.triangleArea(n, r, o);
                    h += d,
                    p.scale(a, s, d),
                    p.add(i, i, a)
                }
                p.scale(i, i, 1 / h)
            }
            ,
            u.prototype.computeMomentOfInertia = function(t) {
                for (var e = 0, i = 0, s = this.vertices.length, n = s - 1, r = 0; r < s; n = r,
                r++) {
                    var o = this.vertices[n]
                      , a = this.vertices[r]
                      , h = Math.abs(p.crossLength(o, a));
                    e += h * (p.dot(a, a) + p.dot(a, o) + p.dot(o, o)),
                    i += h
                }
                return t / 6 * (e / i)
            }
            ,
            u.prototype.updateBoundingRadius = function() {
                for (var t = this.vertices, e = 0, i = 0; i !== t.length; i++) {
                    var s = p.squaredLength(t[i]);
                    e < s && (e = s)
                }
                this.boundingRadius = Math.sqrt(e)
            }
            ,
            u.triangleArea = function(t, e, i) {
                return .5 * ((e[0] - t[0]) * (i[1] - t[1]) - (i[0] - t[0]) * (e[1] - t[1]))
            }
            ,
            u.prototype.updateArea = function() {
                this.updateTriangles(),
                this.area = 0;
                for (var t = this.triangles, e = this.vertices, i = 0; i !== t.length; i++) {
                    var s = t[i]
                      , n = e[s[0]]
                      , r = e[s[1]]
                      , o = e[s[2]]
                      , a = u.triangleArea(n, r, o);
                    this.area += a
                }
            }
            ,
            u.prototype.computeAABB = function(t, e, i) {
                t.setFromPoints(this.vertices, e, i, 0)
            }
            ;
            var _ = p.create()
              , b = p.create()
              , w = p.create();
            u.prototype.raycast = function(t, e, i, s) {
                var n = _
                  , r = b
                  , o = w
                  , a = this.vertices;
                p.toLocalFrame(n, e.from, i, s),
                p.toLocalFrame(r, e.to, i, s);
                for (var h = a.length, l = 0; l < h && !t.shouldStop(e); l++) {
                    var c = a[l]
                      , d = a[(l + 1) % h]
                      , u = p.getLineSegmentsIntersectionFraction(n, r, c, d);
                    0 <= u && (p.sub(o, d, c),
                    p.rotate(o, o, -Math.PI / 2 + s),
                    p.normalize(o, o),
                    e.reportIntersection(t, u, o, l))
                }
            }
        }
        , {
            "../math/polyk": 29,
            "../math/vec2": 30,
            "./Shape": 45,
            "poly-decomp": 5
        }],
        41: [function(t, e, i) {
            function s(t) {
                if (Array.isArray(t) && (t = {
                    heights: t
                },
                "object" == typeof arguments[1]))
                    for (var e in arguments[1])
                        t[e] = arguments[1][e];
                t = t || {},
                this.heights = t.heights ? t.heights.slice(0) : [],
                this.maxValue = t.maxValue || null,
                this.minValue = t.minValue || null,
                this.elementWidth = t.elementWidth || .1,
                void 0 !== t.maxValue && void 0 !== t.minValue || this.updateMaxMinValues(),
                t.type = n.HEIGHTFIELD,
                n.call(this, t)
            }
            var n = t("./Shape")
              , m = t("../math/vec2");
            t("../utils/Utils"),
            (((e.exports = s).prototype = new n).constructor = s).prototype.updateMaxMinValues = function() {
                for (var t = this.heights, e = t[0], i = t[0], s = 0; s !== t.length; s++) {
                    var n = t[s];
                    e < n && (e = n),
                    n < i && (i = n)
                }
                this.maxValue = e,
                this.minValue = i
            }
            ,
            s.prototype.computeMomentOfInertia = function(t) {
                return Number.MAX_VALUE
            }
            ,
            s.prototype.updateBoundingRadius = function() {
                this.boundingRadius = Number.MAX_VALUE
            }
            ,
            s.prototype.updateArea = function() {
                for (var t = this.heights, e = 0, i = 0; i < t.length - 1; i++)
                    e += (t[i] + t[i + 1]) / 2 * this.elementWidth;
                this.area = e
            }
            ;
            var r = [m.create(), m.create(), m.create(), m.create()];
            s.prototype.computeAABB = function(t, e, i) {
                m.set(r[0], 0, this.maxValue),
                m.set(r[1], this.elementWidth * this.heights.length, this.maxValue),
                m.set(r[2], this.elementWidth * this.heights.length, this.minValue),
                m.set(r[3], 0, this.minValue),
                t.setFromPoints(r, e, i)
            }
            ,
            s.prototype.getLineSegment = function(t, e, i) {
                var s = this.heights
                  , n = this.elementWidth;
                m.set(t, i * n, s[i]),
                m.set(e, (i + 1) * n, s[i + 1])
            }
            ,
            s.prototype.getSegmentIndex = function(t) {
                return Math.floor(t[0] / this.elementWidth)
            }
            ,
            s.prototype.getClampedSegmentIndex = function(t) {
                var e = this.getSegmentIndex(t);
                return Math.min(this.heights.length, Math.max(e, 0))
            }
            ;
            var y = (m.create(),
            m.create())
              , v = m.create()
              , _ = m.create()
              , b = m.create()
              , w = m.create();
            m.fromValues(0, 1),
            s.prototype.raycast = function(t, e, i, s) {
                var n = e.from
                  , r = e.to
                  , o = (e.direction,
                y)
                  , a = v
                  , h = _
                  , l = b
                  , c = w;
                m.toLocalFrame(l, n, i, s),
                m.toLocalFrame(c, r, i, s);
                var d = this.getClampedSegmentIndex(l)
                  , u = this.getClampedSegmentIndex(c);
                if (u < d) {
                    var p = d;
                    d = u,
                    u = p
                }
                for (var g = 0; g < this.heights.length - 1; g++) {
                    this.getLineSegment(a, h, g);
                    var f = m.getLineSegmentsIntersectionFraction(l, c, a, h);
                    if (0 <= f && (m.sub(o, h, a),
                    m.rotate(o, o, s + Math.PI / 2),
                    m.normalize(o, o),
                    e.reportIntersection(t, f, o, -1),
                    t.shouldStop(e)))
                        return
                }
            }
        }
        , {
            "../math/vec2": 30,
            "../utils/Utils": 57,
            "./Shape": 45
        }],
        42: [function(t, e, i) {
            function s(t) {
                "number" == typeof t && (t = {
                    length: t
                }),
                t = t || {},
                this.length = t.length || 1,
                t.type = n.LINE,
                n.call(this, t)
            }
            var n = t("./Shape")
              , d = t("../math/vec2");
            (((e.exports = s).prototype = new n).constructor = s).prototype.computeMomentOfInertia = function(t) {
                return t * Math.pow(this.length, 2) / 12
            }
            ,
            s.prototype.updateBoundingRadius = function() {
                this.boundingRadius = this.length / 2
            }
            ;
            var r = [d.create(), d.create()];
            s.prototype.computeAABB = function(t, e, i) {
                var s = this.length / 2;
                d.set(r[0], -s, 0),
                d.set(r[1], s, 0),
                t.setFromPoints(r, e, i, 0)
            }
            ;
            var u = (d.create(),
            d.create())
              , p = d.create()
              , g = d.create()
              , f = d.fromValues(0, 1);
            s.prototype.raycast = function(t, e, i, s) {
                var n = e.from
                  , r = e.to
                  , o = p
                  , a = g
                  , h = this.length / 2;
                d.set(o, -h, 0),
                d.set(a, h, 0),
                d.toGlobalFrame(o, o, i, s),
                d.toGlobalFrame(a, a, i, s);
                var l = d.getLineSegmentsIntersectionFraction(o, a, n, r);
                if (0 <= l) {
                    var c = u;
                    d.rotate(c, f, s),
                    e.reportIntersection(t, l, c, -1)
                }
            }
        }
        , {
            "../math/vec2": 30,
            "./Shape": 45
        }],
        43: [function(t, e, i) {
            function s(t) {
                (t = t || {}).type = n.PARTICLE,
                n.call(this, t)
            }
            var n = t("./Shape")
              , r = t("../math/vec2");
            (((e.exports = s).prototype = new n).constructor = s).prototype.computeMomentOfInertia = function(t) {
                return 0
            }
            ,
            s.prototype.updateBoundingRadius = function() {
                this.boundingRadius = 0
            }
            ,
            s.prototype.computeAABB = function(t, e, i) {
                r.copy(t.lowerBound, e),
                r.copy(t.upperBound, e)
            }
        }
        , {
            "../math/vec2": 30,
            "./Shape": 45
        }],
        44: [function(t, e, i) {
            function s(t) {
                (t = t || {}).type = n.PLANE,
                n.call(this, t)
            }
            var n = t("./Shape")
              , p = t("../math/vec2");
            t("../utils/Utils"),
            (((e.exports = s).prototype = new n).constructor = s).prototype.computeMomentOfInertia = function(t) {
                return 0
            }
            ,
            s.prototype.updateBoundingRadius = function() {
                this.boundingRadius = Number.MAX_VALUE
            }
            ,
            s.prototype.computeAABB = function(t, e, i) {
                var s = i % (2 * Math.PI)
                  , n = p.set
                  , r = Number.MAX_VALUE
                  , o = t.lowerBound
                  , a = t.upperBound;
                0 === s ? (n(o, -r, -r),
                n(a, r, 0)) : s === Math.PI / 2 ? (n(o, 0, -r),
                n(a, r, r)) : s === Math.PI ? (n(o, -r, 0),
                n(a, r, r)) : s === 3 * Math.PI / 2 ? (n(o, -r, -r),
                n(a, 0, r)) : (n(o, -r, -r),
                n(a, r, r)),
                p.add(o, o, e),
                p.add(a, a, e)
            }
            ,
            s.prototype.updateArea = function() {
                this.area = Number.MAX_VALUE
            }
            ;
            var g = p.create()
              , f = (p.create(),
            p.create(),
            p.create())
              , m = p.create();
            s.prototype.raycast = function(t, e, i, s) {
                var n = e.from
                  , r = e.to
                  , o = e.direction
                  , a = g
                  , h = f
                  , l = m;
                p.set(h, 0, 1),
                p.rotate(h, h, s),
                p.sub(l, n, i);
                var c = p.dot(l, h);
                if (p.sub(l, r, i),
                !(0 < c * p.dot(l, h) || p.squaredDistance(n, r) < c * c)) {
                    var d = p.dot(h, o);
                    p.sub(a, n, i);
                    var u = -p.dot(h, a) / d / e.length;
                    e.reportIntersection(t, u, h, -1)
                }
            }
        }
        , {
            "../math/vec2": 30,
            "../utils/Utils": 57,
            "./Shape": 45
        }],
        45: [function(t, e, i) {
            function s(t) {
                t = t || {},
                this.body = null,
                this.position = n.fromValues(0, 0),
                t.position && n.copy(this.position, t.position),
                this.angle = t.angle || 0,
                this.type = t.type || 0,
                this.id = s.idCounter++,
                this.boundingRadius = 0,
                this.collisionGroup = void 0 !== t.collisionGroup ? t.collisionGroup : 1,
                this.collisionResponse = void 0 === t.collisionResponse || t.collisionResponse,
                this.collisionMask = void 0 !== t.collisionMask ? t.collisionMask : 1,
                this.material = t.material || null,
                this.area = 0,
                this.sensor = void 0 !== t.sensor && t.sensor,
                this.type && this.updateBoundingRadius(),
                this.updateArea()
            }
            e.exports = s;
            var n = t("../math/vec2");
            s.idCounter = 0,
            s.CIRCLE = 1,
            s.PARTICLE = 2,
            s.PLANE = 4,
            s.CONVEX = 8,
            s.LINE = 16,
            s.BOX = 32,
            Object.defineProperty(s, "RECTANGLE", {
                get: function() {
                    return s.BOX
                }
            }),
            s.CAPSULE = 64,
            s.HEIGHTFIELD = 128,
            s.prototype.computeMomentOfInertia = function(t) {}
            ,
            s.prototype.updateBoundingRadius = function() {}
            ,
            s.prototype.updateArea = function() {}
            ,
            s.prototype.computeAABB = function(t, e, i) {}
            ,
            s.prototype.raycast = function(t, e, i, s) {}
        }
        , {
            "../math/vec2": 30
        }],
        46: [function(t, e, i) {
            function x(t) {
                s.call(this, t, s.GS),
                t = t || {},
                this.iterations = t.iterations || 10,
                this.tolerance = t.tolerance || 1e-7,
                this.arrayStep = 30,
                this.lambda = new T.ARRAY_TYPE(this.arrayStep),
                this.Bs = new T.ARRAY_TYPE(this.arrayStep),
                this.invCs = new T.ARRAY_TYPE(this.arrayStep),
                this.useZeroRHS = !1,
                this.frictionIterations = 0,
                this.usedIterations = 0
            }
            var S = t("../math/vec2")
              , s = t("./Solver")
              , T = t("../utils/Utils")
              , A = t("../equations/FrictionEquation");
            (((e.exports = x).prototype = new s).constructor = x).prototype.solve = function(t, e) {
                this.sortEquations();
                var i, s, n = 0, r = this.iterations, o = this.frictionIterations, a = this.equations, h = a.length, l = Math.pow(this.tolerance * h, 2), c = e.bodies, d = e.bodies.length, u = (S.add,
                S.set,
                this.useZeroRHS), p = this.lambda;
                if (this.usedIterations = 0,
                h)
                    for (var g = 0; g !== d; g++) {
                        c[g].updateSolveMassProperties()
                    }
                p.length < h && (p = this.lambda = new T.ARRAY_TYPE(h + this.arrayStep),
                this.Bs = new T.ARRAY_TYPE(h + this.arrayStep),
                this.invCs = new T.ARRAY_TYPE(h + this.arrayStep)),
                function(t) {
                    for (var e = t.length; e--; )
                        t[e] = 0
                }(p);
                for (var f = this.invCs, m = this.Bs, g = (p = this.lambda,
                0); g !== a.length; g++) {
                    var y;
                    ((y = a[g]).timeStep !== t || y.needsUpdate) && (y.timeStep = t,
                    y.update()),
                    m[g] = y.computeB(y.a, y.b, t),
                    f[g] = y.computeInvC(y.epsilon)
                }
                if (0 !== h) {
                    for (g = 0; g !== d; g++) {
                        c[g].resetConstraintVelocity()
                    }
                    if (o) {
                        for (n = 0; n !== o; n++) {
                            for (s = i = 0; s !== h; s++) {
                                y = a[s];
                                var v = x.iterateEquation(s, y, y.epsilon, m, f, p, u, t, n);
                                i += Math.abs(v)
                            }
                            if (this.usedIterations++,
                            i * i <= l)
                                break
                        }
                        for (x.updateMultipliers(a, p, 1 / t),
                        s = 0; s !== h; s++) {
                            var _ = a[s];
                            if (_ instanceof A) {
                                for (var b = 0, w = 0; w !== _.contactEquations.length; w++)
                                    b += _.contactEquations[w].multiplier;
                                b *= _.frictionCoefficient / _.contactEquations.length,
                                _.maxForce = b,
                                _.minForce = -b
                            }
                        }
                    }
                    for (n = 0; n !== r; n++) {
                        for (s = i = 0; s !== h; s++) {
                            y = a[s];
                            v = x.iterateEquation(s, y, y.epsilon, m, f, p, u, t, n);
                            i += Math.abs(v)
                        }
                        if (this.usedIterations++,
                        i * i <= l)
                            break
                    }
                    for (g = 0; g !== d; g++)
                        c[g].addConstraintVelocity();
                    x.updateMultipliers(a, p, 1 / t)
                }
            }
            ,
            x.updateMultipliers = function(t, e, i) {
                for (var s = t.length; s--; )
                    t[s].multiplier = e[s] * i
            }
            ,
            x.iterateEquation = function(t, e, i, s, n, r, o, a, h) {
                var l = s[t]
                  , c = n[t]
                  , d = r[t]
                  , u = e.computeGWlambda()
                  , p = e.maxForce
                  , g = e.minForce;
                o && (l = 0);
                var f = c * (l - u - i * d)
                  , m = d + f;
                return m < g * a ? f = g * a - d : p * a < m && (f = p * a - d),
                r[t] += f,
                e.addToWlambda(f),
                f
            }
        }
        , {
            "../equations/FrictionEquation": 23,
            "../math/vec2": 30,
            "../utils/Utils": 57,
            "./Solver": 47
        }],
        47: [function(t, e, i) {
            function s(t, e) {
                t = t || {},
                n.call(this),
                this.type = e,
                this.equations = [],
                this.equationSortFunction = t.equationSortFunction || !1
            }
            var n = (t("../utils/Utils"),
            t("../events/EventEmitter"));
            (((e.exports = s).prototype = new n).constructor = s).prototype.solve = function(t, e) {
                throw new Error("Solver.solve should be implemented by subclasses!")
            }
            ;
            var r = {
                bodies: []
            };
            s.prototype.solveIsland = function(t, e) {
                this.removeAllEquations(),
                e.equations.length && (this.addEquations(e.equations),
                r.bodies.length = 0,
                e.getBodies(r.bodies),
                r.bodies.length && this.solve(t, r))
            }
            ,
            s.prototype.sortEquations = function() {
                this.equationSortFunction && this.equations.sort(this.equationSortFunction)
            }
            ,
            s.prototype.addEquation = function(t) {
                t.enabled && this.equations.push(t)
            }
            ,
            s.prototype.addEquations = function(t) {
                for (var e = 0, i = t.length; e !== i; e++) {
                    var s = t[e];
                    s.enabled && this.equations.push(s)
                }
            }
            ,
            s.prototype.removeEquation = function(t) {
                var e = this.equations.indexOf(t);
                -1 !== e && this.equations.splice(e, 1)
            }
            ,
            s.prototype.removeAllEquations = function() {
                this.equations.length = 0
            }
            ,
            s.GS = 1,
            s.ISLAND = 2
        }
        , {
            "../events/EventEmitter": 26,
            "../utils/Utils": 57
        }],
        48: [function(t, e, i) {
            function s() {
                r.apply(this, arguments)
            }
            var n = t("../equations/ContactEquation")
              , r = t("./Pool");
            (((e.exports = s).prototype = new r).constructor = s).prototype.create = function() {
                return new n
            }
            ,
            s.prototype.destroy = function(t) {
                return t.bodyA = t.bodyB = null,
                this
            }
        }
        , {
            "../equations/ContactEquation": 21,
            "./Pool": 55
        }],
        49: [function(t, e, i) {
            function s() {
                r.apply(this, arguments)
            }
            var n = t("../equations/FrictionEquation")
              , r = t("./Pool");
            (((e.exports = s).prototype = new r).constructor = s).prototype.create = function() {
                return new n
            }
            ,
            s.prototype.destroy = function(t) {
                return t.bodyA = t.bodyB = null,
                this
            }
        }
        , {
            "../equations/FrictionEquation": 23,
            "./Pool": 55
        }],
        50: [function(t, e, i) {
            function s() {
                r.apply(this, arguments)
            }
            var n = t("../world/IslandNode")
              , r = t("./Pool");
            (((e.exports = s).prototype = new r).constructor = s).prototype.create = function() {
                return new n
            }
            ,
            s.prototype.destroy = function(t) {
                return t.reset(),
                this
            }
        }
        , {
            "../world/IslandNode": 60,
            "./Pool": 55
        }],
        51: [function(t, e, i) {
            function s() {
                r.apply(this, arguments)
            }
            var n = t("../world/Island")
              , r = t("./Pool");
            (((e.exports = s).prototype = new r).constructor = s).prototype.create = function() {
                return new n
            }
            ,
            s.prototype.destroy = function(t) {
                return t.reset(),
                this
            }
        }
        , {
            "../world/Island": 58,
            "./Pool": 55
        }],
        52: [function(t, e, i) {
            function s() {
                this.overlappingShapesLastState = new n,
                this.overlappingShapesCurrentState = new n,
                this.recordPool = new r({
                    size: 16
                }),
                this.tmpDict = new n,
                this.tmpArray1 = []
            }
            var n = t("./TupleDictionary")
              , r = (t("./OverlapKeeperRecord"),
            t("./OverlapKeeperRecordPool"));
            t("./Utils"),
            (e.exports = s).prototype.tick = function() {
                for (var t = this.overlappingShapesLastState, e = this.overlappingShapesCurrentState, i = t.keys.length; i--; ) {
                    var s = t.keys[i]
                      , n = t.getByKey(s);
                    e.getByKey(s),
                    n && this.recordPool.release(n)
                }
                t.reset(),
                t.copy(e),
                e.reset()
            }
            ,
            s.prototype.setOverlapping = function(t, e, i, s) {
                var n = (this.overlappingShapesLastState,
                this.overlappingShapesCurrentState);
                if (!n.get(e.id, s.id)) {
                    var r = this.recordPool.get();
                    r.set(t, e, i, s),
                    n.set(e.id, s.id, r)
                }
            }
            ,
            s.prototype.getNewOverlaps = function(t) {
                return this.getDiff(this.overlappingShapesLastState, this.overlappingShapesCurrentState, t)
            }
            ,
            s.prototype.getEndOverlaps = function(t) {
                return this.getDiff(this.overlappingShapesCurrentState, this.overlappingShapesLastState, t)
            }
            ,
            s.prototype.bodiesAreOverlapping = function(t, e) {
                for (var i = this.overlappingShapesCurrentState, s = i.keys.length; s--; ) {
                    var n = i.keys[s]
                      , r = i.data[n];
                    if (r.bodyA === t && r.bodyB === e || r.bodyA === e && r.bodyB === t)
                        return !0
                }
                return !1
            }
            ,
            s.prototype.getDiff = function(t, e, i) {
                var s = t
                  , n = e;
                (i = i || []).length = 0;
                for (var r = n.keys.length; r--; ) {
                    var o = n.keys[r]
                      , a = n.data[o];
                    if (!a)
                        throw new Error("Key " + o + " had no data!");
                    s.data[o] || i.push(a)
                }
                return i
            }
            ,
            s.prototype.isNewOverlap = function(t, e) {
                var i = 0 | t.id
                  , s = 0 | e.id
                  , n = this.overlappingShapesLastState
                  , r = this.overlappingShapesCurrentState;
                return !n.get(i, s) && !!r.get(i, s)
            }
            ,
            s.prototype.getNewBodyOverlaps = function(t) {
                this.tmpArray1.length = 0;
                var e = this.getNewOverlaps(this.tmpArray1);
                return this.getBodyDiff(e, t)
            }
            ,
            s.prototype.getEndBodyOverlaps = function(t) {
                this.tmpArray1.length = 0;
                var e = this.getEndOverlaps(this.tmpArray1);
                return this.getBodyDiff(e, t)
            }
            ,
            s.prototype.getBodyDiff = function(t, e) {
                e = e || [];
                for (var i = this.tmpDict, s = t.length; s--; ) {
                    var n = t[s];
                    i.set(0 | n.bodyA.id, 0 | n.bodyB.id, n)
                }
                for (s = i.keys.length; s--; ) {
                    (n = i.getByKey(i.keys[s])) && e.push(n.bodyA, n.bodyB)
                }
                return i.reset(),
                e
            }
        }
        , {
            "./OverlapKeeperRecord": 53,
            "./OverlapKeeperRecordPool": 54,
            "./TupleDictionary": 56,
            "./Utils": 57
        }],
        53: [function(t, e, i) {
            function n(t, e, i, s) {
                this.shapeA = e,
                this.shapeB = s,
                this.bodyA = t,
                this.bodyB = i
            }
            (e.exports = n).prototype.set = function(t, e, i, s) {
                n.call(this, t, e, i, s)
            }
        }
        , {}],
        54: [function(t, e, i) {
            function s() {
                r.apply(this, arguments)
            }
            var n = t("./OverlapKeeperRecord")
              , r = t("./Pool");
            (((e.exports = s).prototype = new r).constructor = s).prototype.create = function() {
                return new n
            }
            ,
            s.prototype.destroy = function(t) {
                return t.bodyA = t.bodyB = t.shapeA = t.shapeB = null,
                this
            }
        }
        , {
            "./OverlapKeeperRecord": 53,
            "./Pool": 55
        }],
        55: [function(t, e, i) {
            function s(t) {
                t = t || {},
                this.objects = [],
                void 0 !== t.size && this.resize(t.size)
            }
            (e.exports = s).prototype.resize = function(t) {
                for (var e = this.objects; e.length > t; )
                    e.pop();
                for (; e.length < t; )
                    e.push(this.create());
                return this
            }
            ,
            s.prototype.get = function() {
                var t = this.objects;
                return t.length ? t.pop() : this.create()
            }
            ,
            s.prototype.release = function(t) {
                return this.destroy(t),
                this.objects.push(t),
                this
            }
        }
        , {}],
        56: [function(t, e, i) {
            function s() {
                this.data = {},
                this.keys = []
            }
            var n = t("./Utils");
            (e.exports = s).prototype.getKey = function(t, e) {
                return (0 | (t |= 0)) == (0 | (e |= 0)) ? -1 : 0 | ((0 | e) < (0 | t) ? t << 16 | 65535 & e : e << 16 | 65535 & t)
            }
            ,
            s.prototype.getByKey = function(t) {
                return t |= 0,
                this.data[t]
            }
            ,
            s.prototype.get = function(t, e) {
                return this.data[this.getKey(t, e)]
            }
            ,
            s.prototype.set = function(t, e, i) {
                if (!i)
                    throw new Error("No data!");
                var s = this.getKey(t, e);
                return this.data[s] || this.keys.push(s),
                this.data[s] = i,
                s
            }
            ,
            s.prototype.reset = function() {
                for (var t = this.data, e = this.keys, i = e.length; i--; )
                    delete t[e[i]];
                e.length = 0
            }
            ,
            s.prototype.copy = function(t) {
                this.reset(),
                n.appendArray(this.keys, t.keys);
                for (var e = t.keys.length; e--; ) {
                    var i = t.keys[e];
                    this.data[i] = t.data[i]
                }
            }
        }
        , {
            "./Utils": 57
        }],
        57: [function(t, e, i) {
            function s() {}
            (e.exports = s).appendArray = function(t, e) {
                if (e.length < 15e4)
                    t.push.apply(t, e);
                else
                    for (var i = 0, s = e.length; i !== s; ++i)
                        t.push(e[i])
            }
            ,
            s.splice = function(t, e, i) {
                i = i || 1;
                for (var s = e, n = t.length - i; s < n; s++)
                    t[s] = t[s + i];
                t.length = n
            }
            ,
            s.ARRAY_TYPE = "undefined" != typeof P2_ARRAY_TYPE ? P2_ARRAY_TYPE : "undefined" != typeof Float32Array ? Float32Array : Array,
            s.extend = function(t, e) {
                for (var i in e)
                    t[i] = e[i]
            }
            ,
            s.defaults = function(t, e) {
                for (var i in t = t || {},
                e)
                    i in t || (t[i] = e[i]);
                return t
            }
        }
        , {}],
        58: [function(t, e, i) {
            function s() {
                this.equations = [],
                this.bodies = []
            }
            var n = t("../objects/Body");
            (e.exports = s).prototype.reset = function() {
                this.equations.length = this.bodies.length = 0
            }
            ;
            var r = [];
            s.prototype.getBodies = function(t) {
                for (var e = t || [], i = this.equations, s = r.length = 0; s !== i.length; s++) {
                    var n = i[s];
                    -1 === r.indexOf(n.bodyA.id) && (e.push(n.bodyA),
                    r.push(n.bodyA.id)),
                    -1 === r.indexOf(n.bodyB.id) && (e.push(n.bodyB),
                    r.push(n.bodyB.id))
                }
                return e
            }
            ,
            s.prototype.wantsToSleep = function() {
                for (var t = 0; t < this.bodies.length; t++) {
                    var e = this.bodies[t];
                    if (e.type === n.DYNAMIC && !e.wantsToSleep)
                        return !1
                }
                return !0
            }
            ,
            s.prototype.sleep = function() {
                for (var t = 0; t < this.bodies.length; t++)
                    this.bodies[t].sleep();
                return !0
            }
        }
        , {
            "../objects/Body": 31
        }],
        59: [function(t, e, i) {
            function g(t) {
                this.nodePool = new s({
                    size: 16
                }),
                this.islandPool = new n({
                    size: 8
                }),
                this.equations = [],
                this.islands = [],
                this.nodes = [],
                this.queue = []
            }
            var s = (t("../math/vec2"),
            t("./Island"),
            t("./IslandNode"),
            t("./../utils/IslandNodePool"))
              , n = t("./../utils/IslandPool")
              , o = t("../objects/Body");
            (e.exports = g).getUnvisitedNode = function(t) {
                for (var e = t.length, i = 0; i !== e; i++) {
                    var s = t[i];
                    if (!s.visited && s.body.type === o.DYNAMIC)
                        return s
                }
                return !1
            }
            ,
            g.prototype.visit = function(t, e, i) {
                e.push(t.body);
                for (var s = t.equations.length, n = 0; n !== s; n++) {
                    var r = t.equations[n];
                    -1 === i.indexOf(r) && i.push(r)
                }
            }
            ,
            g.prototype.bfs = function(t, e, i) {
                var s = this.queue;
                for (s.length = 0,
                s.push(t),
                t.visited = !0,
                this.visit(t, e, i); s.length; )
                    for (var n, r = s.pop(); n = g.getUnvisitedNode(r.neighbors); )
                        n.visited = !0,
                        this.visit(n, e, i),
                        n.body.type === o.DYNAMIC && s.push(n)
            }
            ,
            g.prototype.split = function(t) {
                for (var e = t.bodies, i = this.nodes, s = this.equations; i.length; )
                    this.nodePool.release(i.pop());
                for (var n = 0; n !== e.length; n++) {
                    var r = this.nodePool.get();
                    r.body = e[n],
                    i.push(r)
                }
                for (var o = 0; o !== s.length; o++) {
                    var a = s[o]
                      , h = (n = e.indexOf(a.bodyA),
                    e.indexOf(a.bodyB))
                      , l = i[n]
                      , c = i[h];
                    l.neighbors.push(c),
                    c.neighbors.push(l),
                    l.equations.push(a),
                    c.equations.push(a)
                }
                var d = this.islands;
                for (n = 0; n < d.length; n++)
                    this.islandPool.release(d[n]);
                d.length = 0;
                for (var u; u = g.getUnvisitedNode(i); ) {
                    var p = this.islandPool.get();
                    this.bfs(u, p.bodies, p.equations),
                    d.push(p)
                }
                return d
            }
        }
        , {
            "../math/vec2": 30,
            "../objects/Body": 31,
            "./../utils/IslandNodePool": 50,
            "./../utils/IslandPool": 51,
            "./Island": 58,
            "./IslandNode": 60
        }],
        60: [function(t, e, i) {
            function s(t) {
                this.body = t,
                this.neighbors = [],
                this.equations = [],
                this.visited = !1
            }
            (e.exports = s).prototype.reset = function() {
                this.equations.length = 0,
                this.neighbors.length = 0,
                this.visited = !1,
                this.body = null
            }
        }
        , {}],
        61: [function(t, e, i) {
            function q(t) {
                n.apply(this),
                t = t || {},
                this.springs = [],
                this.bodies = [],
                this.disabledBodyCollisionPairs = [],
                this.solver = t.solver || new s,
                this.narrowphase = new l(this),
                this.islandManager = new d,
                this.gravity = V.fromValues(0, -9.78),
                t.gravity && V.copy(this.gravity, t.gravity),
                this.frictionGravity = V.length(this.gravity) || 10,
                this.useWorldGravityAsFrictionGravity = !0,
                this.useFrictionGravityOnZeroGravity = !0,
                this.broadphase = t.broadphase || new h,
                this.broadphase.setWorld(this),
                this.constraints = [],
                this.defaultMaterial = new r,
                this.defaultContactMaterial = new o(this.defaultMaterial,this.defaultMaterial),
                this.lastTimeStep = 1 / 60,
                this.applySpringForces = !0,
                this.applyDamping = !0,
                this.applyGravity = !0,
                this.solveConstraints = !0,
                this.contactMaterials = [],
                this.time = 0,
                this.accumulator = 0,
                this.stepping = !1,
                this.bodiesToBeRemoved = [],
                this.islandSplit = void 0 === t.islandSplit || !!t.islandSplit,
                this.emitImpactEvent = !0,
                this._constraintIdCounter = 0,
                this._bodyIdCounter = 0,
                this.postStepEvent = {
                    type: "postStep"
                },
                this.addBodyEvent = {
                    type: "addBody",
                    body: null
                },
                this.removeBodyEvent = {
                    type: "removeBody",
                    body: null
                },
                this.addSpringEvent = {
                    type: "addSpring",
                    spring: null
                },
                this.impactEvent = {
                    type: "impact",
                    bodyA: null,
                    bodyB: null,
                    shapeA: null,
                    shapeB: null,
                    contactEquation: null
                },
                this.postBroadphaseEvent = {
                    type: "postBroadphase",
                    pairs: null
                },
                this.sleepMode = q.NO_SLEEPING,
                this.beginContactEvent = {
                    type: "beginContact",
                    shapeA: null,
                    shapeB: null,
                    bodyA: null,
                    bodyB: null,
                    contactEquations: []
                },
                this.endContactEvent = {
                    type: "endContact",
                    shapeA: null,
                    shapeB: null,
                    bodyA: null,
                    bodyB: null
                },
                this.preSolveEvent = {
                    type: "preSolve",
                    contactEquations: null,
                    frictionEquations: null
                },
                this.overlappingShapesLastState = {
                    keys: []
                },
                this.overlappingShapesCurrentState = {
                    keys: []
                },
                this.overlapKeeper = new c
            }
            var s = t("../solver/GSSolver")
              , V = (t("../solver/Solver"),
            t("../collision/Ray"),
            t("../math/vec2"))
              , y = t("../shapes/Circle")
              , v = t("../shapes/Convex")
              , _ = (t("../shapes/Line"),
            t("../shapes/Plane"))
              , b = t("../shapes/Capsule")
              , w = t("../shapes/Particle")
              , n = t("../events/EventEmitter")
              , z = t("../objects/Body")
              , r = (t("../shapes/Shape"),
            t("../objects/LinearSpring"),
            t("../material/Material"))
              , o = t("../material/ContactMaterial")
              , a = (t("../constraints/DistanceConstraint"),
            t("../constraints/Constraint"),
            t("../constraints/LockConstraint"),
            t("../constraints/RevoluteConstraint"),
            t("../constraints/PrismaticConstraint"),
            t("../constraints/GearConstraint"),
            t("../../package.json"),
            t("../collision/Broadphase"),
            t("../collision/AABB"))
              , h = t("../collision/SAPBroadphase")
              , l = t("../collision/Narrowphase")
              , Y = t("../utils/Utils")
              , c = t("../utils/OverlapKeeper")
              , d = t("./IslandManager");
            t("../objects/RotationalSpring"),
            (((e.exports = q).prototype = new Object(n.prototype)).constructor = q).NO_SLEEPING = 1,
            q.BODY_SLEEPING = 2,
            q.ISLAND_SLEEPING = 4,
            q.prototype.addConstraint = function(t) {
                this.constraints.push(t)
            }
            ,
            q.prototype.addContactMaterial = function(t) {
                this.contactMaterials.push(t)
            }
            ,
            q.prototype.removeContactMaterial = function(t) {
                var e = this.contactMaterials.indexOf(t);
                -1 !== e && Y.splice(this.contactMaterials, e, 1)
            }
            ,
            q.prototype.getContactMaterial = function(t, e) {
                for (var i = this.contactMaterials, s = 0, n = i.length; s !== n; s++) {
                    var r = i[s];
                    if (r.materialA.id === t.id && r.materialB.id === e.id || r.materialA.id === e.id && r.materialB.id === t.id)
                        return r
                }
                return !1
            }
            ,
            q.prototype.removeConstraint = function(t) {
                var e = this.constraints.indexOf(t);
                -1 !== e && Y.splice(this.constraints, e, 1)
            }
            ;
            var K = (V.create(),
            V.create(),
            V.create(),
            V.create(),
            V.create(),
            V.create(),
            V.create())
              , x = V.fromValues(0, 0)
              , S = V.fromValues(0, 0);
            V.fromValues(0, 0),
            V.fromValues(0, 0),
            q.prototype.step = function(t, e, i) {
                if (i = i || 10,
                0 === (e = e || 0))
                    this.internalStep(t),
                    this.time += t;
                else {
                    this.accumulator += e;
                    for (var s = 0; this.accumulator >= t && s < i; )
                        this.internalStep(t),
                        this.time += t,
                        this.accumulator -= t,
                        s++;
                    for (var n = this.accumulator % t / t, r = 0; r !== this.bodies.length; r++) {
                        var o = this.bodies[r];
                        V.lerp(o.interpolatedPosition, o.previousPosition, o.position, n),
                        o.interpolatedAngle = o.previousAngle + n * (o.angle - o.previousAngle)
                    }
                }
            }
            ;
            var J = [];
            q.prototype.internalStep = function(t) {
                this.stepping = !0;
                var e = this.springs.length
                  , i = this.springs
                  , s = this.bodies
                  , n = this.gravity
                  , r = this.solver
                  , o = this.bodies.length
                  , a = this.broadphase
                  , h = this.narrowphase
                  , l = this.constraints
                  , c = K
                  , d = (V.scale,
                V.add)
                  , u = (V.rotate,
                this.islandManager);
                if (this.overlapKeeper.tick(),
                this.lastTimeStep = t,
                this.useWorldGravityAsFrictionGravity) {
                    var p = V.length(this.gravity);
                    0 === p && this.useFrictionGravityOnZeroGravity || (this.frictionGravity = p)
                }
                if (this.applyGravity)
                    for (var g = 0; g !== o; g++) {
                        var f = (m = s[g]).force;
                        m.type === z.DYNAMIC && m.sleepState !== z.SLEEPING && (V.scale(c, n, m.mass * m.gravityScale),
                        d(f, f, c))
                    }
                if (this.applySpringForces)
                    for (g = 0; g !== e; g++) {
                        i[g].applyForce()
                    }
                if (this.applyDamping)
                    for (g = 0; g !== o; g++) {
                        var m;
                        (m = s[g]).type === z.DYNAMIC && m.applyDamping(t)
                    }
                var y = a.getCollisionPairs(this)
                  , v = this.disabledBodyCollisionPairs;
                for (g = v.length - 2; 0 <= g; g -= 2)
                    for (var _ = y.length - 2; 0 <= _; _ -= 2)
                        (v[g] === y[_] && v[g + 1] === y[_ + 1] || v[g + 1] === y[_] && v[g] === y[_ + 1]) && y.splice(_, 2);
                var b = l.length;
                for (g = 0; g !== b; g++) {
                    var w = l[g];
                    if (!w.collideConnected)
                        for (_ = y.length - 2; 0 <= _; _ -= 2)
                            (w.bodyA === y[_] && w.bodyB === y[_ + 1] || w.bodyB === y[_] && w.bodyA === y[_ + 1]) && y.splice(_, 2)
                }
                this.postBroadphaseEvent.pairs = y,
                this.emit(this.postBroadphaseEvent),
                this.postBroadphaseEvent.pairs = null,
                h.reset(this);
                g = 0;
                for (var x = y.length; g !== x; g += 2)
                    for (var S = y[g], T = y[g + 1], A = 0, C = S.shapes.length; A !== C; A++)
                        for (var P = S.shapes[A], E = P.position, I = P.angle, k = 0, M = T.shapes.length; k !== M; k++) {
                            var R = T.shapes[k]
                              , B = R.position
                              , O = R.angle
                              , L = this.defaultContactMaterial;
                            if (P.material && R.material) {
                                var G = this.getContactMaterial(P.material, R.material);
                                G && (L = G)
                            }
                            this.runNarrowphase(h, S, P, E, I, T, R, B, O, L, this.frictionGravity)
                        }
                for (g = 0; g !== o; g++) {
                    (N = s[g])._wakeUpAfterNarrowphase && (N.wakeUp(),
                    N._wakeUpAfterNarrowphase = !1)
                }
                if (this.has("endContact")) {
                    this.overlapKeeper.getEndOverlaps(J);
                    var D = this.endContactEvent;
                    for (k = J.length; k--; ) {
                        var F = J[k];
                        D.shapeA = F.shapeA,
                        D.shapeB = F.shapeB,
                        D.bodyA = F.bodyA,
                        D.bodyB = F.bodyB,
                        this.emit(D)
                    }
                    J.length = 0
                }
                var U = this.preSolveEvent;
                U.contactEquations = h.contactEquations,
                U.frictionEquations = h.frictionEquations,
                this.emit(U),
                U.contactEquations = U.frictionEquations = null;
                b = l.length;
                for (g = 0; g !== b; g++)
                    l[g].update();
                if (h.contactEquations.length || h.frictionEquations.length || b)
                    if (this.islandSplit) {
                        for (u.equations.length = 0,
                        Y.appendArray(u.equations, h.contactEquations),
                        Y.appendArray(u.equations, h.frictionEquations),
                        g = 0; g !== b; g++)
                            Y.appendArray(u.equations, l[g].equations);
                        u.split(this);
                        for (g = 0; g !== u.islands.length; g++) {
                            (X = u.islands[g]).equations.length && r.solveIsland(t, X)
                        }
                    } else {
                        for (r.addEquations(h.contactEquations),
                        r.addEquations(h.frictionEquations),
                        g = 0; g !== b; g++)
                            r.addEquations(l[g].equations);
                        this.solveConstraints && r.solve(t, this),
                        r.removeAllEquations()
                    }
                for (g = 0; g !== o; g++) {
                    var N;
                    (N = s[g]).integrate(t)
                }
                for (g = 0; g !== o; g++)
                    s[g].setZeroForce();
                if (this.emitImpactEvent && this.has("impact")) {
                    var W = this.impactEvent;
                    for (g = 0; g !== h.contactEquations.length; g++) {
                        var H = h.contactEquations[g];
                        H.firstImpact && (W.bodyA = H.bodyA,
                        W.bodyB = H.bodyB,
                        W.shapeA = H.shapeA,
                        W.shapeB = H.shapeB,
                        W.contactEquation = H,
                        this.emit(W))
                    }
                }
                if (this.sleepMode === q.BODY_SLEEPING)
                    for (g = 0; g !== o; g++)
                        s[g].sleepTick(this.time, !1, t);
                else if (this.sleepMode === q.ISLAND_SLEEPING && this.islandSplit) {
                    for (g = 0; g !== o; g++)
                        s[g].sleepTick(this.time, !0, t);
                    for (g = 0; g < this.islandManager.islands.length; g++) {
                        var X;
                        (X = this.islandManager.islands[g]).wantsToSleep() && X.sleep()
                    }
                }
                this.stepping = !1;
                var j = this.bodiesToBeRemoved;
                for (g = 0; g !== j.length; g++)
                    this.removeBody(j[g]);
                j.length = 0,
                this.emit(this.postStepEvent)
            }
            ,
            q.prototype.runNarrowphase = function(t, e, i, s, n, r, o, a, h, l, c) {
                if (0 != (i.collisionGroup & o.collisionMask) && 0 != (o.collisionGroup & i.collisionMask)) {
                    V.rotate(x, s, e.angle),
                    V.rotate(S, a, r.angle),
                    V.add(x, x, e.position),
                    V.add(S, S, r.position);
                    var d, u = n + e.angle, p = h + r.angle;
                    t.enableFriction = 0 < l.friction,
                    t.frictionCoefficient = l.friction,
                    d = e.type === z.STATIC || e.type === z.KINEMATIC ? r.mass : r.type === z.STATIC || r.type === z.KINEMATIC ? e.mass : e.mass * r.mass / (e.mass + r.mass),
                    t.slipForce = l.friction * c * d,
                    t.restitution = l.restitution,
                    t.surfaceVelocity = l.surfaceVelocity,
                    t.frictionStiffness = l.frictionStiffness,
                    t.frictionRelaxation = l.frictionRelaxation,
                    t.stiffness = l.stiffness,
                    t.relaxation = l.relaxation,
                    t.contactSkinSize = l.contactSkinSize,
                    t.enabledEquations = e.collisionResponse && r.collisionResponse && i.collisionResponse && o.collisionResponse;
                    var g = t[i.type | o.type]
                      , f = 0;
                    if (g) {
                        var m = i.sensor || o.sensor
                          , y = t.frictionEquations.length;
                        f = i.type < o.type ? g.call(t, e, i, x, u, r, o, S, p, m) : g.call(t, r, o, S, p, e, i, x, u, m);
                        var v = t.frictionEquations.length - y;
                        if (f) {
                            if (e.allowSleep && e.type === z.DYNAMIC && e.sleepState === z.SLEEPING && r.sleepState === z.AWAKE && r.type !== z.STATIC && V.squaredLength(r.velocity) + Math.pow(r.angularVelocity, 2) >= 2 * Math.pow(r.sleepSpeedLimit, 2) && (e._wakeUpAfterNarrowphase = !0),
                            r.allowSleep && r.type === z.DYNAMIC && r.sleepState === z.SLEEPING && e.sleepState === z.AWAKE && e.type !== z.STATIC && V.squaredLength(e.velocity) + Math.pow(e.angularVelocity, 2) >= 2 * Math.pow(e.sleepSpeedLimit, 2) && (r._wakeUpAfterNarrowphase = !0),
                            this.overlapKeeper.setOverlapping(e, i, r, o),
                            this.has("beginContact") && this.overlapKeeper.isNewOverlap(i, o)) {
                                var _ = this.beginContactEvent;
                                if (_.shapeA = i,
                                _.shapeB = o,
                                _.bodyA = e,
                                _.bodyB = r,
                                _.contactEquations.length = 0,
                                "number" == typeof f)
                                    for (var b = t.contactEquations.length - f; b < t.contactEquations.length; b++)
                                        _.contactEquations.push(t.contactEquations[b]);
                                this.emit(_)
                            }
                            if ("number" == typeof f && 1 < v)
                                for (b = t.frictionEquations.length - v; b < t.frictionEquations.length; b++) {
                                    var w = t.frictionEquations[b];
                                    w.setSlipForce(w.getSlipForce() / v)
                                }
                        }
                    }
                }
            }
            ,
            q.prototype.addSpring = function(t) {
                this.springs.push(t);
                var e = this.addSpringEvent;
                e.spring = t,
                this.emit(e),
                e.spring = null
            }
            ,
            q.prototype.removeSpring = function(t) {
                var e = this.springs.indexOf(t);
                -1 !== e && Y.splice(this.springs, e, 1)
            }
            ,
            q.prototype.addBody = function(t) {
                if (-1 === this.bodies.indexOf(t)) {
                    this.bodies.push(t);
                    var e = (t.world = this).addBodyEvent;
                    e.body = t,
                    this.emit(e),
                    e.body = null
                }
            }
            ,
            q.prototype.removeBody = function(t) {
                if (this.stepping)
                    this.bodiesToBeRemoved.push(t);
                else {
                    t.world = null;
                    var e = this.bodies.indexOf(t);
                    -1 !== e && (Y.splice(this.bodies, e, 1),
                    (this.removeBodyEvent.body = t).resetConstraintVelocity(),
                    this.emit(this.removeBodyEvent),
                    this.removeBodyEvent.body = null)
                }
            }
            ,
            q.prototype.getBodyById = function(t) {
                for (var e = this.bodies, i = 0; i < e.length; i++) {
                    var s = e[i];
                    if (s.id === t)
                        return s
                }
                return !1
            }
            ,
            q.prototype.disableBodyCollision = function(t, e) {
                this.disabledBodyCollisionPairs.push(t, e)
            }
            ,
            q.prototype.enableBodyCollision = function(t, e) {
                for (var i = this.disabledBodyCollisionPairs, s = 0; s < i.length; s += 2)
                    if (i[s] === t && i[s + 1] === e || i[s + 1] === t && i[s] === e)
                        return void i.splice(s, 2)
            }
            ,
            q.prototype.clear = function() {
                this.time = 0,
                this.solver && this.solver.equations.length && this.solver.removeAllEquations();
                for (var t = this.constraints, e = t.length - 1; 0 <= e; e--)
                    this.removeConstraint(t[e]);
                var i = this.bodies;
                for (e = i.length - 1; 0 <= e; e--)
                    this.removeBody(i[e]);
                var s = this.springs;
                for (e = s.length - 1; 0 <= e; e--)
                    this.removeSpring(s[e]);
                var n = this.contactMaterials;
                for (e = n.length - 1; 0 <= e; e--)
                    this.removeContactMaterial(n[e]);
                q.apply(this)
            }
            ;
            var T = V.create()
              , A = (V.fromValues(0, 0),
            V.fromValues(0, 0));
            q.prototype.hitTest = function(t, e, i) {
                i = i || 0;
                var s = new z({
                    position: t
                })
                  , n = new w
                  , r = t
                  , o = T
                  , a = A;
                s.addShape(n);
                for (var h = this.narrowphase, l = [], c = 0, d = e.length; c !== d; c++)
                    for (var u = e[c], p = 0, g = u.shapes.length; p !== g; p++) {
                        var f = u.shapes[p];
                        V.rotate(o, f.position, u.angle),
                        V.add(o, o, u.position);
                        var m = f.angle + u.angle;
                        (f instanceof y && h.circleParticle(u, f, o, m, s, n, r, 0, !0) || f instanceof v && h.particleConvex(s, n, r, 0, u, f, o, m, !0) || f instanceof _ && h.particlePlane(s, n, r, 0, u, f, o, m, !0) || f instanceof b && h.particleCapsule(s, n, r, 0, u, f, o, m, !0) || f instanceof w && V.squaredLength(V.sub(a, o, t)) < i * i) && l.push(u)
                    }
                return l
            }
            ,
            q.prototype.setGlobalStiffness = function(t) {
                for (var e = this.constraints, i = 0; i !== e.length; i++)
                    for (var s = e[i], n = 0; n !== s.equations.length; n++) {
                        var r = s.equations[n];
                        r.stiffness = t,
                        r.needsUpdate = !0
                    }
                var o = this.contactMaterials;
                for (i = 0; i !== o.length; i++) {
                    (s = o[i]).stiffness = s.frictionStiffness = t
                }
                (s = this.defaultContactMaterial).stiffness = s.frictionStiffness = t
            }
            ,
            q.prototype.setGlobalRelaxation = function(t) {
                for (var e = 0; e !== this.constraints.length; e++)
                    for (var i = this.constraints[e], s = 0; s !== i.equations.length; s++) {
                        var n = i.equations[s];
                        n.relaxation = t,
                        n.needsUpdate = !0
                    }
                for (e = 0; e !== this.contactMaterials.length; e++) {
                    (i = this.contactMaterials[e]).relaxation = i.frictionRelaxation = t
                }
                (i = this.defaultContactMaterial).relaxation = i.frictionRelaxation = t
            }
            ;
            var u = new a
              , p = [];
            q.prototype.raycast = function(t, e) {
                return e.getAABB(u),
                this.broadphase.aabbQuery(this, u, p),
                e.intersectBodies(t, p),
                p.length = 0,
                t.hasHit()
            }
        }
        , {
            "../../package.json": 6,
            "../collision/AABB": 7,
            "../collision/Broadphase": 8,
            "../collision/Narrowphase": 10,
            "../collision/Ray": 11,
            "../collision/SAPBroadphase": 13,
            "../constraints/Constraint": 14,
            "../constraints/DistanceConstraint": 15,
            "../constraints/GearConstraint": 16,
            "../constraints/LockConstraint": 17,
            "../constraints/PrismaticConstraint": 18,
            "../constraints/RevoluteConstraint": 19,
            "../events/EventEmitter": 26,
            "../material/ContactMaterial": 27,
            "../material/Material": 28,
            "../math/vec2": 30,
            "../objects/Body": 31,
            "../objects/LinearSpring": 32,
            "../objects/RotationalSpring": 33,
            "../shapes/Capsule": 38,
            "../shapes/Circle": 39,
            "../shapes/Convex": 40,
            "../shapes/Line": 42,
            "../shapes/Particle": 43,
            "../shapes/Plane": 44,
            "../shapes/Shape": 45,
            "../solver/GSSolver": 46,
            "../solver/Solver": 47,
            "../utils/OverlapKeeper": 52,
            "../utils/Utils": 57,
            "./IslandManager": 59
        }]
    }, {}, [36])(36)
}),
function() {
    var t = this
      , O = O || {};
    return O.game = null,
    O.WEBGL_RENDERER = 0,
    O.CANVAS_RENDERER = 1,
    O.VERSION = "v2.2.9",
    O._UID = 0,
    "undefined" != typeof Float32Array ? (O.Float32Array = Float32Array,
    O.Uint16Array = Uint16Array,
    O.Uint32Array = Uint32Array,
    O.ArrayBuffer = ArrayBuffer) : (O.Float32Array = Array,
    O.Uint16Array = Array),
    O.PI_2 = 2 * Math.PI,
    O.RAD_TO_DEG = 180 / Math.PI,
    O.DEG_TO_RAD = Math.PI / 180,
    O.RETINA_PREFIX = "@2x",
    O.DisplayObject = function() {
        this.position = new O.Point(0,0),
        this.scale = new O.Point(1,1),
        this.pivot = new O.Point(0,0),
        this.rotation = 0,
        this.alpha = 1,
        this.visible = !0,
        this.hitArea = null,
        this.renderable = !1,
        this.parent = null,
        this.worldAlpha = 1,
        this.worldTransform = new O.Matrix,
        this.worldPosition = new O.Point(0,0),
        this.worldScale = new O.Point(1,1),
        this.worldRotation = 0,
        this.filterArea = null,
        this._sr = 0,
        this._cr = 1,
        this._bounds = new O.Rectangle(0,0,0,0),
        this._currentBounds = null,
        this._mask = null,
        this._cacheAsBitmap = !1,
        this._cacheIsDirty = !1
    }
    ,
    O.DisplayObject.prototype.constructor = O.DisplayObject,
    O.DisplayObject.prototype = {
        destroy: function() {
            if (this.children) {
                for (var t = this.children.length; t--; )
                    this.children[t].destroy();
                this.children = []
            }
            this.hitArea = null,
            this.parent = null,
            this.worldTransform = null,
            this.filterArea = null,
            this.renderable = !1,
            this._bounds = null,
            this._currentBounds = null,
            this._mask = null,
            this._destroyCachedSprite()
        },
        updateTransform: function(t) {
            if (!t && !this.parent && !this.game)
                return this;
            var e = this.parent;
            t ? e = t : this.parent || (e = this.game.world);
            var i, s, n, r, o, a, h = e.worldTransform, l = this.worldTransform;
            return this.rotation % O.PI_2 ? (this.rotation !== this.rotationCache && (this.rotationCache = this.rotation,
            this._sr = Math.sin(this.rotation),
            this._cr = Math.cos(this.rotation)),
            i = this._cr * this.scale.x,
            s = this._sr * this.scale.x,
            n = -this._sr * this.scale.y,
            r = this._cr * this.scale.y,
            o = this.position.x,
            a = this.position.y,
            (this.pivot.x || this.pivot.y) && (o -= this.pivot.x * i + this.pivot.y * n,
            a -= this.pivot.x * s + this.pivot.y * r),
            l.a = i * h.a + s * h.c,
            l.b = i * h.b + s * h.d,
            l.c = n * h.a + r * h.c,
            l.d = n * h.b + r * h.d) : (i = this.scale.x,
            r = this.scale.y,
            o = this.position.x - this.pivot.x * i,
            a = this.position.y - this.pivot.y * r,
            l.a = i * h.a,
            l.b = i * h.b,
            l.c = r * h.c,
            l.d = r * h.d),
            l.tx = o * h.a + a * h.c + h.tx,
            l.ty = o * h.b + a * h.d + h.ty,
            this.worldAlpha = this.alpha * e.worldAlpha,
            this.worldPosition.set(l.tx, l.ty),
            this.worldScale.set(this.scale.x * Math.sqrt(l.a * l.a + l.c * l.c), this.scale.y * Math.sqrt(l.b * l.b + l.d * l.d)),
            this.worldRotation = Math.atan2(-l.c, l.d),
            this._currentBounds = null,
            this.transformCallback && this.transformCallback.call(this.transformCallbackContext, l, h),
            this
        },
        preUpdate: function() {},
        generateTexture: function(t, e, i) {
            var s = this.getLocalBounds()
              , n = new O.RenderTexture(0 | s.width,0 | s.height,i,e,t);
            return O.DisplayObject._tempMatrix.tx = -s.x,
            O.DisplayObject._tempMatrix.ty = -s.y,
            n.render(this, O.DisplayObject._tempMatrix),
            n
        },
        updateCache: function() {
            return this._generateCachedSprite(),
            this
        },
        toGlobal: function(t) {
            return this.updateTransform(),
            this.worldTransform.apply(t)
        },
        toLocal: function(t, e) {
            return e && (t = e.toGlobal(t)),
            this.updateTransform(),
            this.worldTransform.applyInverse(t)
        },
        _renderCachedSprite: function(t) {
            this._cachedSprite.worldAlpha = this.worldAlpha,
            t.gl ? O.Sprite.prototype._renderWebGL.call(this._cachedSprite, t) : O.Sprite.prototype._renderCanvas.call(this._cachedSprite, t)
        },
        _generateCachedSprite: function() {
            this._cacheAsBitmap = !1;
            var t = this.getLocalBounds();
            if (t.width = Math.max(1, Math.ceil(t.width)),
            t.height = Math.max(1, Math.ceil(t.height)),
            this.updateTransform(),
            this._cachedSprite)
                this._cachedSprite.texture.resize(t.width, t.height);
            else {
                var e = new O.RenderTexture(t.width,t.height);
                this._cachedSprite = new O.Sprite(e),
                this._cachedSprite.worldTransform = this.worldTransform
            }
            var i = this._filters;
            this._filters = null,
            this._cachedSprite.filters = i,
            O.DisplayObject._tempMatrix.tx = -t.x,
            O.DisplayObject._tempMatrix.ty = -t.y,
            this._cachedSprite.texture.render(this, O.DisplayObject._tempMatrix, !0),
            this._cachedSprite.anchor.x = -t.x / t.width,
            this._cachedSprite.anchor.y = -t.y / t.height,
            this._filters = i,
            this._cacheAsBitmap = !0
        },
        _destroyCachedSprite: function() {
            this._cachedSprite && (this._cachedSprite.texture.destroy(!0),
            this._cachedSprite = null)
        }
    },
    O.DisplayObject.prototype.displayObjectUpdateTransform = O.DisplayObject.prototype.updateTransform,
    Object.defineProperties(O.DisplayObject.prototype, {
        x: {
            get: function() {
                return this.position.x
            },
            set: function(t) {
                this.position.x = t
            }
        },
        y: {
            get: function() {
                return this.position.y
            },
            set: function(t) {
                this.position.y = t
            }
        },
        worldVisible: {
            get: function() {
                if (this.visible) {
                    var t = this.parent;
                    if (!t)
                        return this.visible;
                    do {
                        if (!t.visible)
                            return !1;
                        t = t.parent
                    } while (t);
                    return !0
                }
                return !1
            }
        },
        mask: {
            get: function() {
                return this._mask
            },
            set: function(t) {
                this._mask && (this._mask.isMask = !1),
                (this._mask = t) && (this._mask.isMask = !0)
            }
        },
        filters: {
            get: function() {
                return this._filters
            },
            set: function(t) {
                if (Array.isArray(t)) {
                    for (var e = [], i = 0; i < t.length; i++)
                        for (var s = t[i].passes, n = 0; n < s.length; n++)
                            e.push(s[n]);
                    this._filterBlock = {
                        target: this,
                        filterPasses: e
                    }
                }
                this._filters = t,
                this.blendMode && this.blendMode === O.blendModes.MULTIPLY && (this.blendMode = O.blendModes.NORMAL)
            }
        },
        cacheAsBitmap: {
            get: function() {
                return this._cacheAsBitmap
            },
            set: function(t) {
                this._cacheAsBitmap !== t && (t ? this._generateCachedSprite() : this._destroyCachedSprite(),
                this._cacheAsBitmap = t)
            }
        }
    }),
    O.DisplayObjectContainer = function() {
        O.DisplayObject.call(this),
        this.children = [],
        this.ignoreChildInput = !1
    }
    ,
    O.DisplayObjectContainer.prototype = Object.create(O.DisplayObject.prototype),
    O.DisplayObjectContainer.prototype.constructor = O.DisplayObjectContainer,
    O.DisplayObjectContainer.prototype.addChild = function(t) {
        return this.addChildAt(t, this.children.length)
    }
    ,
    O.DisplayObjectContainer.prototype.addChildAt = function(t, e) {
        if (0 <= e && e <= this.children.length)
            return t.parent && t.parent.removeChild(t),
            (t.parent = this).children.splice(e, 0, t),
            t;
        throw new Error(t + "addChildAt: The index " + e + " supplied is out of bounds " + this.children.length)
    }
    ,
    O.DisplayObjectContainer.prototype.swapChildren = function(t, e) {
        if (t !== e) {
            var i = this.getChildIndex(t)
              , s = this.getChildIndex(e);
            if (i < 0 || s < 0)
                throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");
            this.children[i] = e,
            this.children[s] = t
        }
    }
    ,
    O.DisplayObjectContainer.prototype.getChildIndex = function(t) {
        var e = this.children.indexOf(t);
        if (-1 === e)
            throw new Error("The supplied DisplayObject must be a child of the caller");
        return e
    }
    ,
    O.DisplayObjectContainer.prototype.setChildIndex = function(t, e) {
        if (e < 0 || e >= this.children.length)
            throw new Error("The supplied index is out of bounds");
        var i = this.getChildIndex(t);
        this.children.splice(i, 1),
        this.children.splice(e, 0, t)
    }
    ,
    O.DisplayObjectContainer.prototype.getChildAt = function(t) {
        if (t < 0 || t >= this.children.length)
            throw new Error("getChildAt: Supplied index " + t + " does not exist in the child list, or the supplied DisplayObject must be a child of the caller");
        return this.children[t]
    }
    ,
    O.DisplayObjectContainer.prototype.removeChild = function(t) {
        var e = this.children.indexOf(t);
        if (-1 !== e)
            return this.removeChildAt(e)
    }
    ,
    O.DisplayObjectContainer.prototype.removeChildAt = function(t) {
        var e = this.getChildAt(t);
        return e && (e.parent = void 0,
        this.children.splice(t, 1)),
        e
    }
    ,
    O.DisplayObjectContainer.prototype.removeChildren = function(t, e) {
        void 0 === t && (t = 0),
        void 0 === e && (e = this.children.length);
        var i = e - t;
        if (0 < i && i <= e) {
            for (var s = this.children.splice(t, i), n = 0; n < s.length; n++)
                s[n].parent = void 0;
            return s
        }
        if (0 === i && 0 === this.children.length)
            return [];
        throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range")
    }
    ,
    O.DisplayObjectContainer.prototype.updateTransform = function() {
        if (this.visible && (this.displayObjectUpdateTransform(),
        !this._cacheAsBitmap))
            for (var t = 0; t < this.children.length; t++)
                this.children[t].updateTransform()
    }
    ,
    O.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform = O.DisplayObjectContainer.prototype.updateTransform,
    O.DisplayObjectContainer.prototype.getBounds = function(t) {
        var e, i = t && t instanceof O.DisplayObject, s = !0;
        if (i ? s = t instanceof O.DisplayObjectContainer && t.contains(this) : t = this,
        i) {
            var n = t.worldTransform;
            for (t.worldTransform = O.identityMatrix,
            e = 0; e < t.children.length; e++)
                t.children[e].updateTransform()
        }
        var r, o, a, h = 1 / 0, l = 1 / 0, c = -1 / 0, d = -1 / 0, u = !1;
        for (e = 0; e < this.children.length; e++)
            this.children[e].visible && (u = !0,
            h = h < (r = this.children[e].getBounds()).x ? h : r.x,
            l = l < r.y ? l : r.y,
            c = (o = r.width + r.x) < c ? c : o,
            d = (a = r.height + r.y) < d ? d : a);
        var p = this._bounds;
        if (!u) {
            var g = (p = new O.Rectangle).x
              , f = p.width + p.x
              , m = p.y
              , y = p.height + p.y
              , v = this.worldTransform
              , _ = v.a
              , b = v.b
              , w = v.c
              , x = v.d
              , S = v.tx
              , T = v.ty
              , A = _ * f + w * y + S
              , C = x * y + b * f + T
              , P = _ * g + w * y + S
              , E = x * y + b * g + T
              , I = _ * g + w * m + S
              , k = x * m + b * g + T
              , M = _ * f + w * m + S
              , R = x * m + b * f + T;
            h = M < (h = I < (h = P < (h = c = A) ? P : h) ? I : h) ? M : h,
            l = R < (l = k < (l = E < (l = d = C) ? E : l) ? k : l) ? R : l,
            c = (c = (c = c < P ? P : c) < I ? I : c) < M ? M : c,
            d = (d = (d = d < E ? E : d) < k ? k : d) < R ? R : d
        }
        if (p.x = h,
        p.y = l,
        p.width = c - h,
        p.height = d - l,
        i)
            for (t.worldTransform = n,
            e = 0; e < t.children.length; e++)
                t.children[e].updateTransform();
        if (!s) {
            var B = t.getBounds();
            p.x -= B.x,
            p.y -= B.y
        }
        return p
    }
    ,
    O.DisplayObjectContainer.prototype.getLocalBounds = function() {
        return this.getBounds(this)
    }
    ,
    O.DisplayObjectContainer.prototype.contains = function(t) {
        return !!t && (t === this || this.contains(t.parent))
    }
    ,
    O.DisplayObjectContainer.prototype._renderWebGL = function(t) {
        if (this.visible && !(this.alpha <= 0)) {
            if (this._cacheAsBitmap)
                return void this._renderCachedSprite(t);
            var e;
            if (this._mask || this._filters) {
                for (this._filters && (t.spriteBatch.flush(),
                t.filterManager.pushFilter(this._filterBlock)),
                this._mask && (t.spriteBatch.stop(),
                t.maskManager.pushMask(this.mask, t),
                t.spriteBatch.start()),
                e = 0; e < this.children.length; e++)
                    this.children[e]._renderWebGL(t);
                t.spriteBatch.stop(),
                this._mask && t.maskManager.popMask(this._mask, t),
                this._filters && t.filterManager.popFilter(),
                t.spriteBatch.start()
            } else
                for (e = 0; e < this.children.length; e++)
                    this.children[e]._renderWebGL(t)
        }
    }
    ,
    O.DisplayObjectContainer.prototype._renderCanvas = function(t) {
        if (!1 !== this.visible && 0 !== this.alpha) {
            if (this._cacheAsBitmap)
                return void this._renderCachedSprite(t);
            this._mask && t.maskManager.pushMask(this._mask, t);
            for (var e = 0; e < this.children.length; e++)
                this.children[e]._renderCanvas(t);
            this._mask && t.maskManager.popMask(t)
        }
    }
    ,
    Object.defineProperty(O.DisplayObjectContainer.prototype, "width", {
        get: function() {
            return this.getLocalBounds().width * this.scale.x
        },
        set: function(t) {
            var e = this.getLocalBounds().width;
            this.scale.x = 0 !== e ? t / e : 1,
            this._width = t
        }
    }),
    Object.defineProperty(O.DisplayObjectContainer.prototype, "height", {
        get: function() {
            return this.getLocalBounds().height * this.scale.y
        },
        set: function(t) {
            var e = this.getLocalBounds().height;
            this.scale.y = 0 !== e ? t / e : 1,
            this._height = t
        }
    }),
    O.Sprite = function(t) {
        O.DisplayObjectContainer.call(this),
        this.anchor = new O.Point,
        this.texture = t || O.Texture.emptyTexture,
        this._width = 0,
        this._height = 0,
        this.tint = 16777215,
        this.cachedTint = -1,
        this.tintedTexture = null,
        this.blendMode = O.blendModes.NORMAL,
        this.shader = null,
        this.exists = !0,
        this.texture.baseTexture.hasLoaded && this.onTextureUpdate(),
        this.renderable = !0
    }
    ,
    O.Sprite.prototype = Object.create(O.DisplayObjectContainer.prototype),
    O.Sprite.prototype.constructor = O.Sprite,
    Object.defineProperty(O.Sprite.prototype, "width", {
        get: function() {
            return this.scale.x * this.texture.frame.width
        },
        set: function(t) {
            this.scale.x = t / this.texture.frame.width,
            this._width = t
        }
    }),
    Object.defineProperty(O.Sprite.prototype, "height", {
        get: function() {
            return this.scale.y * this.texture.frame.height
        },
        set: function(t) {
            this.scale.y = t / this.texture.frame.height,
            this._height = t
        }
    }),
    O.Sprite.prototype.setTexture = function(t, e) {
        void 0 !== e && this.texture.baseTexture.destroy(),
        this.texture.baseTexture.skipRender = !1,
        this.texture = t,
        this.texture.valid = !0,
        this.cachedTint = -1
    }
    ,
    O.Sprite.prototype.onTextureUpdate = function() {
        this._width && (this.scale.x = this._width / this.texture.frame.width),
        this._height && (this.scale.y = this._height / this.texture.frame.height)
    }
    ,
    O.Sprite.prototype.getBounds = function(t) {
        var e = this.texture.frame.width
          , i = this.texture.frame.height
          , s = e * (1 - this.anchor.x)
          , n = e * -this.anchor.x
          , r = i * (1 - this.anchor.y)
          , o = i * -this.anchor.y
          , a = t || this.worldTransform
          , h = a.a
          , l = a.b
          , c = a.c
          , d = a.d
          , u = a.tx
          , p = a.ty
          , g = -1 / 0
          , f = -1 / 0
          , m = 1 / 0
          , y = 1 / 0;
        if (0 === l && 0 === c) {
            if (h < 0) {
                h *= -1;
                var v = s;
                s = -n,
                n = -v
            }
            if (d < 0) {
                d *= -1;
                v = r;
                r = -o,
                o = -v
            }
            m = h * n + u,
            g = h * s + u,
            y = d * o + p,
            f = d * r + p
        } else {
            var _ = h * n + c * o + u
              , b = d * o + l * n + p
              , w = h * s + c * o + u
              , x = d * o + l * s + p
              , S = h * s + c * r + u
              , T = d * r + l * s + p
              , A = h * n + c * r + u
              , C = d * r + l * n + p;
            m = A < (m = S < (m = w < (m = _ < m ? _ : m) ? w : m) ? S : m) ? A : m,
            y = C < (y = T < (y = x < (y = b < y ? b : y) ? x : y) ? T : y) ? C : y,
            g = (g = (g = (g = g < _ ? _ : g) < w ? w : g) < S ? S : g) < A ? A : g,
            f = (f = (f = (f = f < b ? b : f) < x ? x : f) < T ? T : f) < C ? C : f
        }
        var P = this._bounds;
        return P.x = m,
        P.width = g - m,
        P.y = y,
        P.height = f - y,
        this._currentBounds = P
    }
    ,
    O.Sprite.prototype.getLocalBounds = function() {
        var t = this.worldTransform;
        this.worldTransform = O.identityMatrix;
        for (var e = 0; e < this.children.length; e++)
            this.children[e].updateTransform();
        var i = this.getBounds();
        for (this.worldTransform = t,
        e = 0; e < this.children.length; e++)
            this.children[e].updateTransform();
        return i
    }
    ,
    O.Sprite.prototype._renderWebGL = function(t, e) {
        if (this.visible && !(this.alpha <= 0) && this.renderable) {
            var i = this.worldTransform;
            if (e && (i = e),
            this._mask || this._filters) {
                var s = t.spriteBatch;
                this._filters && (s.flush(),
                t.filterManager.pushFilter(this._filterBlock)),
                this._mask && (s.stop(),
                t.maskManager.pushMask(this.mask, t),
                s.start()),
                s.render(this);
                for (var n = 0; n < this.children.length; n++)
                    this.children[n]._renderWebGL(t);
                s.stop(),
                this._mask && t.maskManager.popMask(this._mask, t),
                this._filters && t.filterManager.popFilter(),
                s.start()
            } else {
                t.spriteBatch.render(this);
                for (n = 0; n < this.children.length; n++)
                    this.children[n]._renderWebGL(t, i)
            }
        }
    }
    ,
    O.Sprite.prototype._renderCanvas = function(t, e) {
        if (!(!this.visible || 0 === this.alpha || !this.renderable || this.texture.crop.width <= 0 || this.texture.crop.height <= 0)) {
            var i = this.worldTransform;
            if (e && (i = e),
            this.blendMode !== t.currentBlendMode && (t.currentBlendMode = this.blendMode,
            t.context.globalCompositeOperation = O.blendModesCanvas[t.currentBlendMode]),
            this._mask && t.maskManager.pushMask(this._mask, t),
            this.texture.valid) {
                var s = this.texture.baseTexture.resolution / t.resolution;
                t.context.globalAlpha = this.worldAlpha,
                t.smoothProperty && t.scaleMode !== this.texture.baseTexture.scaleMode && (t.scaleMode = this.texture.baseTexture.scaleMode,
                t.context[t.smoothProperty] = t.scaleMode === O.scaleModes.LINEAR);
                var n = this.texture.trim ? this.texture.trim.x - this.anchor.x * this.texture.trim.width : this.anchor.x * -this.texture.frame.width
                  , r = this.texture.trim ? this.texture.trim.y - this.anchor.y * this.texture.trim.height : this.anchor.y * -this.texture.frame.height
                  , o = i.tx * t.resolution + t.shakeX
                  , a = i.ty * t.resolution + t.shakeY;
                t.roundPixels ? (t.context.setTransform(i.a, i.b, i.c, i.d, 0 | o, 0 | a),
                n |= 0,
                r |= 0) : t.context.setTransform(i.a, i.b, i.c, i.d, o, a);
                var h = this.texture.crop.width
                  , l = this.texture.crop.height;
                if (n /= s,
                r /= s,
                16777215 !== this.tint)
                    (this.texture.requiresReTint || this.cachedTint !== this.tint) && (this.tintedTexture = O.CanvasTinter.getTintedTexture(this, this.tint),
                    this.cachedTint = this.tint,
                    this.texture.requiresReTint = !1),
                    t.context.drawImage(this.tintedTexture, 0, 0, h, l, n, r, h / s, l / s);
                else {
                    var c = this.texture.crop.x
                      , d = this.texture.crop.y;
                    t.context.drawImage(this.texture.baseTexture.source, c, d, h, l, n, r, h / s, l / s)
                }
            }
            for (var u = 0; u < this.children.length; u++)
                this.children[u]._renderCanvas(t);
            this._mask && t.maskManager.popMask(t)
        }
    }
    ,
    O.SpriteBatch = function(t) {
        O.DisplayObjectContainer.call(this),
        this.textureThing = t,
        this.ready = !1
    }
    ,
    O.SpriteBatch.prototype = Object.create(O.DisplayObjectContainer.prototype),
    O.SpriteBatch.prototype.constructor = O.SpriteBatch,
    O.SpriteBatch.prototype.initWebGL = function(t) {
        this.fastSpriteBatch = new O.WebGLFastSpriteBatch(t),
        this.ready = !0
    }
    ,
    O.SpriteBatch.prototype.updateTransform = function() {
        this.displayObjectUpdateTransform()
    }
    ,
    O.SpriteBatch.prototype._renderWebGL = function(t) {
        !this.visible || this.alpha <= 0 || !this.children.length || (this.ready || this.initWebGL(t.gl),
        this.fastSpriteBatch.gl !== t.gl && this.fastSpriteBatch.setContext(t.gl),
        t.spriteBatch.stop(),
        t.shaderManager.setShader(t.shaderManager.fastShader),
        this.fastSpriteBatch.begin(this, t),
        this.fastSpriteBatch.render(this),
        t.spriteBatch.start())
    }
    ,
    O.SpriteBatch.prototype._renderCanvas = function(t) {
        if (this.visible && !(this.alpha <= 0) && this.children.length) {
            var e = t.context;
            e.globalAlpha = this.worldAlpha,
            this.displayObjectUpdateTransform();
            for (var i = this.worldTransform, s = !0, n = 0; n < this.children.length; n++) {
                var r = this.children[n];
                if (r.visible) {
                    var o = r.texture
                      , a = o.frame;
                    if (e.globalAlpha = this.worldAlpha * r.alpha,
                    r.rotation % (2 * Math.PI) == 0)
                        s && (e.setTransform(i.a, i.b, i.c, i.d, i.tx, i.ty),
                        s = !1),
                        e.drawImage(o.baseTexture.source, a.x, a.y, a.width, a.height, r.anchor.x * (-a.width * r.scale.x) + r.position.x + .5 + t.shakeX | 0, r.anchor.y * (-a.height * r.scale.y) + r.position.y + .5 + t.shakeY | 0, a.width * r.scale.x, a.height * r.scale.y);
                    else {
                        s || (s = !0),
                        r.displayObjectUpdateTransform();
                        var h = r.worldTransform
                          , l = h.tx * t.resolution + t.shakeX
                          , c = h.ty * t.resolution + t.shakeY;
                        t.roundPixels ? e.setTransform(h.a, h.b, h.c, h.d, 0 | l, 0 | c) : e.setTransform(h.a, h.b, h.c, h.d, l, c),
                        e.drawImage(o.baseTexture.source, a.x, a.y, a.width, a.height, r.anchor.x * -a.width + .5 | 0, r.anchor.y * -a.height + .5 | 0, a.width, a.height)
                    }
                }
            }
        }
    }
    ,
    O.hex2rgb = function(t) {
        return [(t >> 16 & 255) / 255, (t >> 8 & 255) / 255, (255 & t) / 255]
    }
    ,
    O.rgb2hex = function(t) {
        return (255 * t[0] << 16) + (255 * t[1] << 8) + 255 * t[2]
    }
    ,
    O.canUseNewCanvasBlendModes = function() {
        if (void 0 === document)
            return !1;
        var t = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/"
          , e = "AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg=="
          , i = new Image;
        i.src = t + "AP804Oa6" + e;
        var s = new Image;
        s.src = t + "/wCKxvRF" + e;
        var n = O.CanvasPool.create(this, 6, 1).getContext("2d");
        if (n.globalCompositeOperation = "multiply",
        n.drawImage(i, 0, 0),
        n.drawImage(s, 2, 0),
        !n.getImageData(2, 0, 1, 1))
            return !1;
        var r = n.getImageData(2, 0, 1, 1).data;
        return O.CanvasPool.remove(this),
        255 === r[0] && 0 === r[1] && 0 === r[2]
    }
    ,
    O.getNextPowerOfTwo = function(t) {
        if (0 < t && 0 == (t & t - 1))
            return t;
        for (var e = 1; e < t; )
            e <<= 1;
        return e
    }
    ,
    O.isPowerOfTwo = function(t, e) {
        return 0 < t && 0 == (t & t - 1) && 0 < e && 0 == (e & e - 1)
    }
    ,
    O.CanvasPool = {
        create: function(t, e, i) {
            var s, n = O.CanvasPool.getFirst();
            if (-1 === n) {
                var r = {
                    parent: t,
                    canvas: document.createElement("canvas")
                };
                O.CanvasPool.pool.push(r),
                s = r.canvas
            } else
                O.CanvasPool.pool[n].parent = t,
                s = O.CanvasPool.pool[n].canvas;
            return void 0 !== e && (s.width = e,
            s.height = i),
            s
        },
        getFirst: function() {
            for (var t = O.CanvasPool.pool, e = 0; e < t.length; e++)
                if (!t[e].parent)
                    return e;
            return -1
        },
        remove: function(t) {
            for (var e = O.CanvasPool.pool, i = 0; i < e.length; i++)
                e[i].parent === t && (e[i].parent = null,
                e[i].canvas.width = 1,
                e[i].canvas.height = 1)
        },
        removeByCanvas: function(t) {
            for (var e = O.CanvasPool.pool, i = 0; i < e.length; i++)
                e[i].canvas === t && (e[i].parent = null,
                e[i].canvas.width = 1,
                e[i].canvas.height = 1)
        },
        getTotal: function() {
            for (var t = O.CanvasPool.pool, e = 0, i = 0; i < t.length; i++)
                t[i].parent && e++;
            return e
        },
        getFree: function() {
            for (var t = O.CanvasPool.pool, e = 0, i = 0; i < t.length; i++)
                t[i].parent || e++;
            return e
        }
    },
    O.CanvasPool.pool = [],
    O.initDefaultShaders = function() {}
    ,
    O.CompileVertexShader = function(t, e) {
        return O._CompileShader(t, e, t.VERTEX_SHADER)
    }
    ,
    O.CompileFragmentShader = function(t, e) {
        return O._CompileShader(t, e, t.FRAGMENT_SHADER)
    }
    ,
    O._CompileShader = function(t, e, i) {
        var s = e;
        Array.isArray(e) && (s = e.join("\n"));
        var n = t.createShader(i);
        return t.shaderSource(n, s),
        t.compileShader(n),
        t.getShaderParameter(n, t.COMPILE_STATUS) ? n : (window.console.log(t.getShaderInfoLog(n)),
        null)
    }
    ,
    O.compileProgram = function(t, e, i) {
        var s = O.CompileFragmentShader(t, i)
          , n = O.CompileVertexShader(t, e)
          , r = t.createProgram();
        return t.attachShader(r, n),
        t.attachShader(r, s),
        t.linkProgram(r),
        t.getProgramParameter(r, t.LINK_STATUS) || (window.console.log(t.getProgramInfoLog(r)),
        window.console.log("Could not initialise shaders")),
        r
    }
    ,
    O.PixiShader = function(t) {
        this._UID = O._UID++,
        this.gl = t,
        this.program = null,
        this.fragmentSrc = ["precision lowp float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;", "}"],
        this.textureCount = 0,
        this.firstRun = !0,
        this.dirty = !0,
        this.attributes = [],
        this.init()
    }
    ,
    O.PixiShader.prototype.constructor = O.PixiShader,
    O.PixiShader.prototype.init = function() {
        var t = this.gl
          , e = O.compileProgram(t, this.vertexSrc || O.PixiShader.defaultVertexSrc, this.fragmentSrc);
        for (var i in t.useProgram(e),
        this.uSampler = t.getUniformLocation(e, "uSampler"),
        this.projectionVector = t.getUniformLocation(e, "projectionVector"),
        this.offsetVector = t.getUniformLocation(e, "offsetVector"),
        this.dimensions = t.getUniformLocation(e, "dimensions"),
        this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"),
        this.aTextureCoord = t.getAttribLocation(e, "aTextureCoord"),
        this.colorAttribute = t.getAttribLocation(e, "aColor"),
        -1 === this.colorAttribute && (this.colorAttribute = 2),
        this.attributes = [this.aVertexPosition, this.aTextureCoord, this.colorAttribute],
        this.uniforms)
            this.uniforms[i].uniformLocation = t.getUniformLocation(e, i);
        this.initUniforms(),
        this.program = e
    }
    ,
    O.PixiShader.prototype.initUniforms = function() {
        this.textureCount = 1;
        var t, e = this.gl;
        for (var i in this.uniforms) {
            var s = (t = this.uniforms[i]).type;
            "sampler2D" === s ? (t._init = !1,
            null !== t.value && this.initSampler2D(t)) : "mat2" === s || "mat3" === s || "mat4" === s ? (t.glMatrix = !0,
            t.glValueLength = 1,
            "mat2" === s ? t.glFunc = e.uniformMatrix2fv : "mat3" === s ? t.glFunc = e.uniformMatrix3fv : "mat4" === s && (t.glFunc = e.uniformMatrix4fv)) : (t.glFunc = e["uniform" + s],
            t.glValueLength = "2f" === s || "2i" === s ? 2 : "3f" === s || "3i" === s ? 3 : "4f" === s || "4i" === s ? 4 : 1)
        }
    }
    ,
    O.PixiShader.prototype.initSampler2D = function(t) {
        if (t.value && t.value.baseTexture && t.value.baseTexture.hasLoaded) {
            var e = this.gl;
            if (e.activeTexture(e["TEXTURE" + this.textureCount]),
            e.bindTexture(e.TEXTURE_2D, t.value.baseTexture._glTextures[e.id]),
            t.textureData) {
                var i = t.textureData
                  , s = i.magFilter ? i.magFilter : e.LINEAR
                  , n = i.minFilter ? i.minFilter : e.LINEAR
                  , r = i.wrapS ? i.wrapS : e.CLAMP_TO_EDGE
                  , o = i.wrapT ? i.wrapT : e.CLAMP_TO_EDGE
                  , a = i.luminance ? e.LUMINANCE : e.RGBA;
                if (i.repeat && (r = e.REPEAT,
                o = e.REPEAT),
                e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL, !!i.flipY),
                i.width) {
                    var h = i.width ? i.width : 512
                      , l = i.height ? i.height : 2
                      , c = i.border ? i.border : 0;
                    e.texImage2D(e.TEXTURE_2D, 0, a, h, l, c, a, e.UNSIGNED_BYTE, null)
                } else
                    e.texImage2D(e.TEXTURE_2D, 0, a, e.RGBA, e.UNSIGNED_BYTE, t.value.baseTexture.source);
                e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, s),
                e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, n),
                e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, r),
                e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, o)
            }
            e.uniform1i(t.uniformLocation, this.textureCount),
            t._init = !0,
            this.textureCount++
        }
    }
    ,
    O.PixiShader.prototype.syncUniforms = function() {
        this.textureCount = 1;
        var t, e = this.gl;
        for (var i in this.uniforms)
            1 === (t = this.uniforms[i]).glValueLength ? !0 === t.glMatrix ? t.glFunc.call(e, t.uniformLocation, t.transpose, t.value) : t.glFunc.call(e, t.uniformLocation, t.value) : 2 === t.glValueLength ? t.glFunc.call(e, t.uniformLocation, t.value.x, t.value.y) : 3 === t.glValueLength ? t.glFunc.call(e, t.uniformLocation, t.value.x, t.value.y, t.value.z) : 4 === t.glValueLength ? t.glFunc.call(e, t.uniformLocation, t.value.x, t.value.y, t.value.z, t.value.w) : "sampler2D" === t.type && (t._init ? (e.activeTexture(e["TEXTURE" + this.textureCount]),
            t.value.baseTexture._dirty[e.id] ? O.instances[e.id].updateTexture(t.value.baseTexture) : e.bindTexture(e.TEXTURE_2D, t.value.baseTexture._glTextures[e.id]),
            e.uniform1i(t.uniformLocation, this.textureCount),
            this.textureCount++) : this.initSampler2D(t))
    }
    ,
    O.PixiShader.prototype.destroy = function() {
        this.gl.deleteProgram(this.program),
        this.uniforms = null,
        this.gl = null,
        this.attributes = null
    }
    ,
    O.PixiShader.defaultVertexSrc = ["attribute vec2 aVertexPosition;", "attribute vec2 aTextureCoord;", "attribute vec4 aColor;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "const vec2 center = vec2(-1.0, 1.0);", "void main(void) {", "   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vColor = vec4(aColor.rgb * aColor.a, aColor.a);", "}"],
    O.PixiFastShader = function(t) {
        this._UID = O._UID++,
        this.gl = t,
        this.program = null,
        this.fragmentSrc = ["precision lowp float;", "varying vec2 vTextureCoord;", "varying float vColor;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;", "}"],
        this.vertexSrc = ["attribute vec2 aVertexPosition;", "attribute vec2 aPositionCoord;", "attribute vec2 aScale;", "attribute float aRotation;", "attribute vec2 aTextureCoord;", "attribute float aColor;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform mat3 uMatrix;", "varying vec2 vTextureCoord;", "varying float vColor;", "const vec2 center = vec2(-1.0, 1.0);", "void main(void) {", "   vec2 v;", "   vec2 sv = aVertexPosition * aScale;", "   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);", "   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);", "   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;", "   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vColor = aColor;", "}"],
        this.textureCount = 0,
        this.init()
    }
    ,
    O.PixiFastShader.prototype.constructor = O.PixiFastShader,
    O.PixiFastShader.prototype.init = function() {
        var t = this.gl
          , e = O.compileProgram(t, this.vertexSrc, this.fragmentSrc);
        t.useProgram(e),
        this.uSampler = t.getUniformLocation(e, "uSampler"),
        this.projectionVector = t.getUniformLocation(e, "projectionVector"),
        this.offsetVector = t.getUniformLocation(e, "offsetVector"),
        this.dimensions = t.getUniformLocation(e, "dimensions"),
        this.uMatrix = t.getUniformLocation(e, "uMatrix"),
        this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"),
        this.aPositionCoord = t.getAttribLocation(e, "aPositionCoord"),
        this.aScale = t.getAttribLocation(e, "aScale"),
        this.aRotation = t.getAttribLocation(e, "aRotation"),
        this.aTextureCoord = t.getAttribLocation(e, "aTextureCoord"),
        this.colorAttribute = t.getAttribLocation(e, "aColor"),
        -1 === this.colorAttribute && (this.colorAttribute = 2),
        this.attributes = [this.aVertexPosition, this.aPositionCoord, this.aScale, this.aRotation, this.aTextureCoord, this.colorAttribute],
        this.program = e
    }
    ,
    O.PixiFastShader.prototype.destroy = function() {
        this.gl.deleteProgram(this.program),
        this.uniforms = null,
        this.gl = null,
        this.attributes = null
    }
    ,
    O.StripShader = function(t) {
        this._UID = O._UID++,
        this.gl = t,
        this.program = null,
        this.fragmentSrc = ["precision mediump float;", "varying vec2 vTextureCoord;", "uniform float alpha;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * alpha;", "}"],
        this.vertexSrc = ["attribute vec2 aVertexPosition;", "attribute vec2 aTextureCoord;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "varying vec2 vTextureCoord;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "}"],
        this.init()
    }
    ,
    O.StripShader.prototype.constructor = O.StripShader,
    O.StripShader.prototype.init = function() {
        var t = this.gl
          , e = O.compileProgram(t, this.vertexSrc, this.fragmentSrc);
        t.useProgram(e),
        this.uSampler = t.getUniformLocation(e, "uSampler"),
        this.projectionVector = t.getUniformLocation(e, "projectionVector"),
        this.offsetVector = t.getUniformLocation(e, "offsetVector"),
        this.colorAttribute = t.getAttribLocation(e, "aColor"),
        this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"),
        this.aTextureCoord = t.getAttribLocation(e, "aTextureCoord"),
        this.attributes = [this.aVertexPosition, this.aTextureCoord],
        this.translationMatrix = t.getUniformLocation(e, "translationMatrix"),
        this.alpha = t.getUniformLocation(e, "alpha"),
        this.program = e
    }
    ,
    O.StripShader.prototype.destroy = function() {
        this.gl.deleteProgram(this.program),
        this.uniforms = null,
        this.gl = null,
        this.attribute = null
    }
    ,
    O.PrimitiveShader = function(t) {
        this._UID = O._UID++,
        this.gl = t,
        this.program = null,
        this.fragmentSrc = ["precision mediump float;", "varying vec4 vColor;", "void main(void) {", "   gl_FragColor = vColor;", "}"],
        this.vertexSrc = ["attribute vec2 aVertexPosition;", "attribute vec4 aColor;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform float alpha;", "uniform float flipY;", "uniform vec3 tint;", "varying vec4 vColor;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);", "   vColor = aColor * vec4(tint * alpha, alpha);", "}"],
        this.init()
    }
    ,
    O.PrimitiveShader.prototype.constructor = O.PrimitiveShader,
    O.PrimitiveShader.prototype.init = function() {
        var t = this.gl
          , e = O.compileProgram(t, this.vertexSrc, this.fragmentSrc);
        t.useProgram(e),
        this.projectionVector = t.getUniformLocation(e, "projectionVector"),
        this.offsetVector = t.getUniformLocation(e, "offsetVector"),
        this.tintColor = t.getUniformLocation(e, "tint"),
        this.flipY = t.getUniformLocation(e, "flipY"),
        this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"),
        this.colorAttribute = t.getAttribLocation(e, "aColor"),
        this.attributes = [this.aVertexPosition, this.colorAttribute],
        this.translationMatrix = t.getUniformLocation(e, "translationMatrix"),
        this.alpha = t.getUniformLocation(e, "alpha"),
        this.program = e
    }
    ,
    O.PrimitiveShader.prototype.destroy = function() {
        this.gl.deleteProgram(this.program),
        this.uniforms = null,
        this.gl = null,
        this.attributes = null
    }
    ,
    O.ComplexPrimitiveShader = function(t) {
        this._UID = O._UID++,
        this.gl = t,
        this.program = null,
        this.fragmentSrc = ["precision mediump float;", "varying vec4 vColor;", "void main(void) {", "   gl_FragColor = vColor;", "}"],
        this.vertexSrc = ["attribute vec2 aVertexPosition;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform vec3 tint;", "uniform float alpha;", "uniform vec3 color;", "uniform float flipY;", "varying vec4 vColor;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);", "   vColor = vec4(color * alpha * tint, alpha);", "}"],
        this.init()
    }
    ,
    O.ComplexPrimitiveShader.prototype.constructor = O.ComplexPrimitiveShader,
    O.ComplexPrimitiveShader.prototype.init = function() {
        var t = this.gl
          , e = O.compileProgram(t, this.vertexSrc, this.fragmentSrc);
        t.useProgram(e),
        this.projectionVector = t.getUniformLocation(e, "projectionVector"),
        this.offsetVector = t.getUniformLocation(e, "offsetVector"),
        this.tintColor = t.getUniformLocation(e, "tint"),
        this.color = t.getUniformLocation(e, "color"),
        this.flipY = t.getUniformLocation(e, "flipY"),
        this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"),
        this.attributes = [this.aVertexPosition, this.colorAttribute],
        this.translationMatrix = t.getUniformLocation(e, "translationMatrix"),
        this.alpha = t.getUniformLocation(e, "alpha"),
        this.program = e
    }
    ,
    O.ComplexPrimitiveShader.prototype.destroy = function() {
        this.gl.deleteProgram(this.program),
        this.uniforms = null,
        this.gl = null,
        this.attribute = null
    }
    ,
    O.glContexts = [],
    O.instances = [],
    O.WebGLRenderer = function(t) {
        this.game = t,
        O.defaultRenderer || (O.defaultRenderer = this),
        this.type = O.WEBGL_RENDERER,
        this.resolution = t.resolution,
        this.transparent = t.transparent,
        this.autoResize = !1,
        this.preserveDrawingBuffer = t.preserveDrawingBuffer,
        this.clearBeforeRender = t.clearBeforeRender,
        this.width = t.width,
        this.height = t.height,
        this.view = t.canvas,
        this._contextOptions = {
            alpha: this.transparent,
            antialias: t.antialias,
            premultipliedAlpha: this.transparent && "notMultiplied" !== this.transparent,
            stencil: !0,
            preserveDrawingBuffer: this.preserveDrawingBuffer
        },
        this.projection = new O.Point,
        this.offset = new O.Point,
        this.shaderManager = new O.WebGLShaderManager,
        this.spriteBatch = new O.WebGLSpriteBatch,
        this.maskManager = new O.WebGLMaskManager,
        this.filterManager = new O.WebGLFilterManager,
        this.stencilManager = new O.WebGLStencilManager,
        this.blendModeManager = new O.WebGLBlendModeManager,
        this.renderSession = {},
        this.renderSession.game = this.game,
        this.renderSession.gl = this.gl,
        this.renderSession.drawCount = 0,
        this.renderSession.shaderManager = this.shaderManager,
        this.renderSession.maskManager = this.maskManager,
        this.renderSession.filterManager = this.filterManager,
        this.renderSession.blendModeManager = this.blendModeManager,
        this.renderSession.spriteBatch = this.spriteBatch,
        this.renderSession.stencilManager = this.stencilManager,
        (this.renderSession.renderer = this).renderSession.resolution = this.resolution,
        this.initContext(),
        this.mapBlendModes()
    }
    ,
    O.WebGLRenderer.prototype.constructor = O.WebGLRenderer,
    O.WebGLRenderer.prototype.initContext = function() {
        var t = this.view.getContext("webgl", this._contextOptions) || this.view.getContext("experimental-webgl", this._contextOptions);
        if (!(this.gl = t))
            throw new Error("This browser does not support webGL. Try using the canvas renderer");
        this.glContextId = t.id = O.WebGLRenderer.glContextId++,
        O.glContexts[this.glContextId] = t,
        O.instances[this.glContextId] = this,
        t.disable(t.DEPTH_TEST),
        t.disable(t.CULL_FACE),
        t.enable(t.BLEND),
        this.shaderManager.setContext(t),
        this.spriteBatch.setContext(t),
        this.maskManager.setContext(t),
        this.filterManager.setContext(t),
        this.blendModeManager.setContext(t),
        this.stencilManager.setContext(t),
        this.renderSession.gl = this.gl,
        this.resize(this.width, this.height)
    }
    ,
    O.WebGLRenderer.prototype.render = function(t) {
        if (!this.contextLost) {
            var e = this.gl;
            e.viewport(0, 0, this.width, this.height),
            e.bindFramebuffer(e.FRAMEBUFFER, null),
            this.game.clearBeforeRender && (e.clearColor(t._bgColor.r, t._bgColor.g, t._bgColor.b, t._bgColor.a),
            e.clear(e.COLOR_BUFFER_BIT)),
            this.offset.x = this.game.camera._shake.x,
            this.offset.y = this.game.camera._shake.y,
            this.renderDisplayObject(t, this.projection)
        }
    }
    ,
    O.WebGLRenderer.prototype.renderDisplayObject = function(t, e, i, s) {
        this.renderSession.blendModeManager.setBlendMode(O.blendModes.NORMAL),
        this.renderSession.drawCount = 0,
        this.renderSession.flipY = i ? -1 : 1,
        this.renderSession.projection = e,
        this.renderSession.offset = this.offset,
        this.spriteBatch.begin(this.renderSession),
        this.filterManager.begin(this.renderSession, i),
        t._renderWebGL(this.renderSession, s),
        this.spriteBatch.end()
    }
    ,
    O.WebGLRenderer.prototype.resize = function(t, e) {
        this.width = t * this.resolution,
        this.height = e * this.resolution,
        this.view.width = this.width,
        this.view.height = this.height,
        this.autoResize && (this.view.style.width = this.width / this.resolution + "px",
        this.view.style.height = this.height / this.resolution + "px"),
        this.gl.viewport(0, 0, this.width, this.height),
        this.projection.x = this.width / 2 / this.resolution,
        this.projection.y = -this.height / 2 / this.resolution
    }
    ,
    O.WebGLRenderer.prototype.updateTexture = function(t) {
        if (!t.hasLoaded)
            return !1;
        var e = this.gl;
        return t._glTextures[e.id] || (t._glTextures[e.id] = e.createTexture()),
        e.bindTexture(e.TEXTURE_2D, t._glTextures[e.id]),
        e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL, t.premultipliedAlpha),
        e.texImage2D(e.TEXTURE_2D, 0, e.RGBA, e.RGBA, e.UNSIGNED_BYTE, t.source),
        e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, t.scaleMode === O.scaleModes.LINEAR ? e.LINEAR : e.NEAREST),
        t.mipmap && O.isPowerOfTwo(t.width, t.height) ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === O.scaleModes.LINEAR ? e.LINEAR_MIPMAP_LINEAR : e.NEAREST_MIPMAP_NEAREST),
        e.generateMipmap(e.TEXTURE_2D)) : e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === O.scaleModes.LINEAR ? e.LINEAR : e.NEAREST),
        t._powerOf2 ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.REPEAT),
        e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.REPEAT)) : (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.CLAMP_TO_EDGE),
        e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.CLAMP_TO_EDGE)),
        !(t._dirty[e.id] = !1)
    }
    ,
    O.WebGLRenderer.prototype.destroy = function() {
        O.glContexts[this.glContextId] = null,
        this.projection = null,
        this.offset = null,
        this.shaderManager.destroy(),
        this.spriteBatch.destroy(),
        this.maskManager.destroy(),
        this.filterManager.destroy(),
        this.shaderManager = null,
        this.spriteBatch = null,
        this.maskManager = null,
        this.filterManager = null,
        this.gl = null,
        this.renderSession = null,
        O.CanvasPool.remove(this),
        O.instances[this.glContextId] = null,
        O.WebGLRenderer.glContextId--
    }
    ,
    O.WebGLRenderer.prototype.mapBlendModes = function() {
        var t = this.gl;
        if (!O.blendModesWebGL) {
            var e = []
              , i = O.blendModes;
            e[i.NORMAL] = [t.ONE, t.ONE_MINUS_SRC_ALPHA],
            e[i.ADD] = [t.SRC_ALPHA, t.DST_ALPHA],
            e[i.MULTIPLY] = [t.DST_COLOR, t.ONE_MINUS_SRC_ALPHA],
            e[i.SCREEN] = [t.SRC_ALPHA, t.ONE],
            e[i.OVERLAY] = [t.ONE, t.ONE_MINUS_SRC_ALPHA],
            e[i.DARKEN] = [t.ONE, t.ONE_MINUS_SRC_ALPHA],
            e[i.LIGHTEN] = [t.ONE, t.ONE_MINUS_SRC_ALPHA],
            e[i.COLOR_DODGE] = [t.ONE, t.ONE_MINUS_SRC_ALPHA],
            e[i.COLOR_BURN] = [t.ONE, t.ONE_MINUS_SRC_ALPHA],
            e[i.HARD_LIGHT] = [t.ONE, t.ONE_MINUS_SRC_ALPHA],
            e[i.SOFT_LIGHT] = [t.ONE, t.ONE_MINUS_SRC_ALPHA],
            e[i.DIFFERENCE] = [t.ONE, t.ONE_MINUS_SRC_ALPHA],
            e[i.EXCLUSION] = [t.ONE, t.ONE_MINUS_SRC_ALPHA],
            e[i.HUE] = [t.ONE, t.ONE_MINUS_SRC_ALPHA],
            e[i.SATURATION] = [t.ONE, t.ONE_MINUS_SRC_ALPHA],
            e[i.COLOR] = [t.ONE, t.ONE_MINUS_SRC_ALPHA],
            e[i.LUMINOSITY] = [t.ONE, t.ONE_MINUS_SRC_ALPHA],
            O.blendModesWebGL = e
        }
    }
    ,
    O.WebGLRenderer.glContextId = 0,
    O.WebGLBlendModeManager = function() {
        this.currentBlendMode = 99999
    }
    ,
    O.WebGLBlendModeManager.prototype.constructor = O.WebGLBlendModeManager,
    O.WebGLBlendModeManager.prototype.setContext = function(t) {
        this.gl = t
    }
    ,
    O.WebGLBlendModeManager.prototype.setBlendMode = function(t) {
        if (this.currentBlendMode === t)
            return !1;
        this.currentBlendMode = t;
        var e = O.blendModesWebGL[this.currentBlendMode];
        return e && this.gl.blendFunc(e[0], e[1]),
        !0
    }
    ,
    O.WebGLBlendModeManager.prototype.destroy = function() {
        this.gl = null
    }
    ,
    O.WebGLMaskManager = function() {}
    ,
    O.WebGLMaskManager.prototype.constructor = O.WebGLMaskManager,
    O.WebGLMaskManager.prototype.setContext = function(t) {
        this.gl = t
    }
    ,
    O.WebGLMaskManager.prototype.pushMask = function(t, e) {
        var i = e.gl;
        t.dirty && O.WebGLGraphics.updateGraphics(t, i),
        void 0 !== t._webGL[i.id] && void 0 !== t._webGL[i.id].data && 0 !== t._webGL[i.id].data.length && e.stencilManager.pushStencil(t, t._webGL[i.id].data[0], e)
    }
    ,
    O.WebGLMaskManager.prototype.popMask = function(t, e) {
        var i = this.gl;
        void 0 !== t._webGL[i.id] && void 0 !== t._webGL[i.id].data && 0 !== t._webGL[i.id].data.length && e.stencilManager.popStencil(t, t._webGL[i.id].data[0], e)
    }
    ,
    O.WebGLMaskManager.prototype.destroy = function() {
        this.gl = null
    }
    ,
    O.WebGLStencilManager = function() {
        this.stencilStack = [],
        this.reverse = !0,
        this.count = 0
    }
    ,
    O.WebGLStencilManager.prototype.setContext = function(t) {
        this.gl = t
    }
    ,
    O.WebGLStencilManager.prototype.pushStencil = function(t, e, i) {
        var s = this.gl;
        this.bindGraphics(t, e, i),
        0 === this.stencilStack.length && (s.enable(s.STENCIL_TEST),
        s.clear(s.STENCIL_BUFFER_BIT),
        this.reverse = !0,
        this.count = 0),
        this.stencilStack.push(e);
        var n = this.count;
        s.colorMask(!1, !1, !1, !1),
        s.stencilFunc(s.ALWAYS, 0, 255),
        s.stencilOp(s.KEEP, s.KEEP, s.INVERT),
        1 === e.mode ? (s.drawElements(s.TRIANGLE_FAN, e.indices.length - 4, s.UNSIGNED_SHORT, 0),
        this.reverse ? (s.stencilFunc(s.EQUAL, 255 - n, 255),
        s.stencilOp(s.KEEP, s.KEEP, s.DECR)) : (s.stencilFunc(s.EQUAL, n, 255),
        s.stencilOp(s.KEEP, s.KEEP, s.INCR)),
        s.drawElements(s.TRIANGLE_FAN, 4, s.UNSIGNED_SHORT, 2 * (e.indices.length - 4)),
        this.reverse ? s.stencilFunc(s.EQUAL, 255 - (n + 1), 255) : s.stencilFunc(s.EQUAL, n + 1, 255),
        this.reverse = !this.reverse) : (this.reverse ? (s.stencilFunc(s.EQUAL, n, 255),
        s.stencilOp(s.KEEP, s.KEEP, s.INCR)) : (s.stencilFunc(s.EQUAL, 255 - n, 255),
        s.stencilOp(s.KEEP, s.KEEP, s.DECR)),
        s.drawElements(s.TRIANGLE_STRIP, e.indices.length, s.UNSIGNED_SHORT, 0),
        this.reverse ? s.stencilFunc(s.EQUAL, n + 1, 255) : s.stencilFunc(s.EQUAL, 255 - (n + 1), 255)),
        s.colorMask(!0, !0, !0, !0),
        s.stencilOp(s.KEEP, s.KEEP, s.KEEP),
        this.count++
    }
    ,
    O.WebGLStencilManager.prototype.bindGraphics = function(t, e, i) {
        this._currentGraphics = t;
        var s, n = this.gl, r = i.projection, o = i.offset;
        1 === e.mode ? (s = i.shaderManager.complexPrimitiveShader,
        i.shaderManager.setShader(s),
        n.uniform1f(s.flipY, i.flipY),
        n.uniformMatrix3fv(s.translationMatrix, !1, t.worldTransform.toArray(!0)),
        n.uniform2f(s.projectionVector, r.x, -r.y),
        n.uniform2f(s.offsetVector, -o.x, -o.y),
        n.uniform3fv(s.tintColor, O.hex2rgb(t.tint)),
        n.uniform3fv(s.color, e.color),
        n.uniform1f(s.alpha, t.worldAlpha * e.alpha),
        n.bindBuffer(n.ARRAY_BUFFER, e.buffer),
        n.vertexAttribPointer(s.aVertexPosition, 2, n.FLOAT, !1, 8, 0)) : (s = i.shaderManager.primitiveShader,
        i.shaderManager.setShader(s),
        n.uniformMatrix3fv(s.translationMatrix, !1, t.worldTransform.toArray(!0)),
        n.uniform1f(s.flipY, i.flipY),
        n.uniform2f(s.projectionVector, r.x, -r.y),
        n.uniform2f(s.offsetVector, -o.x, -o.y),
        n.uniform3fv(s.tintColor, O.hex2rgb(t.tint)),
        n.uniform1f(s.alpha, t.worldAlpha),
        n.bindBuffer(n.ARRAY_BUFFER, e.buffer),
        n.vertexAttribPointer(s.aVertexPosition, 2, n.FLOAT, !1, 24, 0),
        n.vertexAttribPointer(s.colorAttribute, 4, n.FLOAT, !1, 24, 8)),
        n.bindBuffer(n.ELEMENT_ARRAY_BUFFER, e.indexBuffer)
    }
    ,
    O.WebGLStencilManager.prototype.popStencil = function(t, e, i) {
        var s = this.gl;
        if (this.stencilStack.pop(),
        this.count--,
        0 === this.stencilStack.length)
            s.disable(s.STENCIL_TEST);
        else {
            var n = this.count;
            this.bindGraphics(t, e, i),
            s.colorMask(!1, !1, !1, !1),
            1 === e.mode ? (this.reverse = !this.reverse,
            this.reverse ? (s.stencilFunc(s.EQUAL, 255 - (n + 1), 255),
            s.stencilOp(s.KEEP, s.KEEP, s.INCR)) : (s.stencilFunc(s.EQUAL, n + 1, 255),
            s.stencilOp(s.KEEP, s.KEEP, s.DECR)),
            s.drawElements(s.TRIANGLE_FAN, 4, s.UNSIGNED_SHORT, 2 * (e.indices.length - 4)),
            s.stencilFunc(s.ALWAYS, 0, 255),
            s.stencilOp(s.KEEP, s.KEEP, s.INVERT),
            s.drawElements(s.TRIANGLE_FAN, e.indices.length - 4, s.UNSIGNED_SHORT, 0)) : (this.reverse ? (s.stencilFunc(s.EQUAL, n + 1, 255),
            s.stencilOp(s.KEEP, s.KEEP, s.DECR)) : (s.stencilFunc(s.EQUAL, 255 - (n + 1), 255),
            s.stencilOp(s.KEEP, s.KEEP, s.INCR)),
            s.drawElements(s.TRIANGLE_STRIP, e.indices.length, s.UNSIGNED_SHORT, 0)),
            this.reverse ? s.stencilFunc(s.EQUAL, n, 255) : s.stencilFunc(s.EQUAL, 255 - n, 255),
            s.colorMask(!0, !0, !0, !0),
            s.stencilOp(s.KEEP, s.KEEP, s.KEEP)
        }
    }
    ,
    O.WebGLStencilManager.prototype.destroy = function() {
        this.stencilStack = null,
        this.gl = null
    }
    ,
    O.WebGLShaderManager = function() {
        this.maxAttibs = 10,
        this.attribState = [],
        this.tempAttribState = [];
        for (var t = 0; t < this.maxAttibs; t++)
            this.attribState[t] = !1;
        this.stack = []
    }
    ,
    O.WebGLShaderManager.prototype.constructor = O.WebGLShaderManager,
    O.WebGLShaderManager.prototype.setContext = function(t) {
        this.gl = t,
        this.primitiveShader = new O.PrimitiveShader(t),
        this.complexPrimitiveShader = new O.ComplexPrimitiveShader(t),
        this.defaultShader = new O.PixiShader(t),
        this.fastShader = new O.PixiFastShader(t),
        this.stripShader = new O.StripShader(t),
        this.setShader(this.defaultShader)
    }
    ,
    O.WebGLShaderManager.prototype.setAttribs = function(t) {
        var e;
        for (e = 0; e < this.tempAttribState.length; e++)
            this.tempAttribState[e] = !1;
        for (e = 0; e < t.length; e++) {
            var i = t[e];
            this.tempAttribState[i] = !0
        }
        var s = this.gl;
        for (e = 0; e < this.attribState.length; e++)
            this.attribState[e] !== this.tempAttribState[e] && (this.attribState[e] = this.tempAttribState[e],
            this.tempAttribState[e] ? s.enableVertexAttribArray(e) : s.disableVertexAttribArray(e))
    }
    ,
    O.WebGLShaderManager.prototype.setShader = function(t) {
        return this._currentId !== t._UID && (this._currentId = t._UID,
        this.currentShader = t,
        this.gl.useProgram(t.program),
        this.setAttribs(t.attributes),
        !0)
    }
    ,
    O.WebGLShaderManager.prototype.destroy = function() {
        this.attribState = null,
        this.tempAttribState = null,
        this.primitiveShader.destroy(),
        this.complexPrimitiveShader.destroy(),
        this.defaultShader.destroy(),
        this.fastShader.destroy(),
        this.stripShader.destroy(),
        this.gl = null
    }
    ,
    O.WebGLSpriteBatch = function() {
        this.vertSize = 5,
        this.size = 2e3;
        var t = 4 * this.size * 4 * this.vertSize
          , e = 6 * this.size;
        this.vertices = new O.ArrayBuffer(t),
        this.positions = new O.Float32Array(this.vertices),
        this.colors = new O.Uint32Array(this.vertices),
        this.indices = new O.Uint16Array(e);
        for (var i = this.lastIndexCount = 0, s = 0; i < e; i += 6,
        s += 4)
            this.indices[i + 0] = s + 0,
            this.indices[i + 1] = s + 1,
            this.indices[i + 2] = s + 2,
            this.indices[i + 3] = s + 0,
            this.indices[i + 4] = s + 2,
            this.indices[i + 5] = s + 3;
        this.drawing = !1,
        this.currentBatchSize = 0,
        this.currentBaseTexture = null,
        this.dirty = !0,
        this.textures = [],
        this.blendModes = [],
        this.shaders = [],
        this.sprites = [],
        this.defaultShader = new O.AbstractFilter(["precision lowp float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;", "}"])
    }
    ,
    O.WebGLSpriteBatch.prototype.setContext = function(t) {
        this.gl = t,
        this.vertexBuffer = t.createBuffer(),
        this.indexBuffer = t.createBuffer(),
        t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer),
        t.bufferData(t.ELEMENT_ARRAY_BUFFER, this.indices, t.STATIC_DRAW),
        t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer),
        t.bufferData(t.ARRAY_BUFFER, this.vertices, t.DYNAMIC_DRAW),
        this.currentBlendMode = 99999;
        var e = new O.PixiShader(t);
        e.fragmentSrc = this.defaultShader.fragmentSrc,
        e.uniforms = {},
        e.init(),
        this.defaultShader.shaders[t.id] = e
    }
    ,
    O.WebGLSpriteBatch.prototype.begin = function(t) {
        this.renderSession = t,
        this.shader = this.renderSession.shaderManager.defaultShader,
        this.start()
    }
    ,
    O.WebGLSpriteBatch.prototype.end = function() {
        this.flush()
    }
    ,
    O.WebGLSpriteBatch.prototype.render = function(t, e) {
        var i = t.texture
          , s = t.worldTransform;
        e && (s = e),
        this.currentBatchSize >= this.size && (this.flush(),
        this.currentBaseTexture = i.baseTexture);
        var n = i._uvs;
        if (n) {
            var r, o, a, h, l = t.anchor.x, c = t.anchor.y;
            if (i.trim) {
                var d = i.trim;
                r = (o = d.x - l * d.width) + i.crop.width,
                a = (h = d.y - c * d.height) + i.crop.height
            } else
                r = i.frame.width * (1 - l),
                o = i.frame.width * -l,
                a = i.frame.height * (1 - c),
                h = i.frame.height * -c;
            var u = 4 * this.currentBatchSize * this.vertSize
              , p = i.baseTexture.resolution
              , g = s.a / p
              , f = s.b / p
              , m = s.c / p
              , y = s.d / p
              , v = s.tx
              , _ = s.ty
              , b = this.colors
              , w = this.positions;
            this.renderSession.roundPixels ? (w[u] = g * o + m * h + v | 0,
            w[u + 1] = y * h + f * o + _ | 0,
            w[u + 5] = g * r + m * h + v | 0,
            w[u + 6] = y * h + f * r + _ | 0,
            w[u + 10] = g * r + m * a + v | 0,
            w[u + 11] = y * a + f * r + _ | 0,
            w[u + 15] = g * o + m * a + v | 0,
            w[u + 16] = y * a + f * o + _ | 0) : (w[u] = g * o + m * h + v,
            w[u + 1] = y * h + f * o + _,
            w[u + 5] = g * r + m * h + v,
            w[u + 6] = y * h + f * r + _,
            w[u + 10] = g * r + m * a + v,
            w[u + 11] = y * a + f * r + _,
            w[u + 15] = g * o + m * a + v,
            w[u + 16] = y * a + f * o + _),
            w[u + 2] = n.x0,
            w[u + 3] = n.y0,
            w[u + 7] = n.x1,
            w[u + 8] = n.y1,
            w[u + 12] = n.x2,
            w[u + 13] = n.y2,
            w[u + 17] = n.x3,
            w[u + 18] = n.y3;
            var x = t.tint;
            b[u + 4] = b[u + 9] = b[u + 14] = b[u + 19] = (x >> 16) + (65280 & x) + ((255 & x) << 16) + (255 * t.worldAlpha << 24),
            this.sprites[this.currentBatchSize++] = t
        }
    }
    ,
    O.WebGLSpriteBatch.prototype.renderTilingSprite = function(t) {
        var e = t.tilingTexture;
        this.currentBatchSize >= this.size && (this.flush(),
        this.currentBaseTexture = e.baseTexture),
        t._uvs || (t._uvs = new O.TextureUvs);
        var i = t._uvs
          , s = e.baseTexture.width
          , n = e.baseTexture.height;
        t.tilePosition.x %= s * t.tileScaleOffset.x,
        t.tilePosition.y %= n * t.tileScaleOffset.y;
        var r = t.tilePosition.x / (s * t.tileScaleOffset.x)
          , o = t.tilePosition.y / (n * t.tileScaleOffset.y)
          , a = t.width / s / (t.tileScale.x * t.tileScaleOffset.x)
          , h = t.height / n / (t.tileScale.y * t.tileScaleOffset.y);
        i.x0 = 0 - r,
        i.y0 = 0 - o,
        i.x1 = 1 * a - r,
        i.y1 = 0 - o,
        i.x2 = 1 * a - r,
        i.y2 = 1 * h - o,
        i.x3 = 0 - r,
        i.y3 = 1 * h - o;
        var l = t.tint
          , c = (l >> 16) + (65280 & l) + ((255 & l) << 16) + (255 * t.worldAlpha << 24)
          , d = this.positions
          , u = this.colors
          , p = t.width
          , g = t.height
          , f = t.anchor.x
          , m = t.anchor.y
          , y = p * (1 - f)
          , v = p * -f
          , _ = g * (1 - m)
          , b = g * -m
          , w = 4 * this.currentBatchSize * this.vertSize
          , x = e.baseTexture.resolution
          , S = t.worldTransform
          , T = S.a / x
          , A = S.b / x
          , C = S.c / x
          , P = S.d / x
          , E = S.tx
          , I = S.ty;
        d[w++] = T * v + C * b + E,
        d[w++] = P * b + A * v + I,
        d[w++] = i.x0,
        d[w++] = i.y0,
        u[w++] = c,
        d[w++] = T * y + C * b + E,
        d[w++] = P * b + A * y + I,
        d[w++] = i.x1,
        d[w++] = i.y1,
        u[w++] = c,
        d[w++] = T * y + C * _ + E,
        d[w++] = P * _ + A * y + I,
        d[w++] = i.x2,
        d[w++] = i.y2,
        u[w++] = c,
        d[w++] = T * v + C * _ + E,
        d[w++] = P * _ + A * v + I,
        d[w++] = i.x3,
        d[w++] = i.y3,
        u[w++] = c,
        this.sprites[this.currentBatchSize++] = t
    }
    ,
    O.WebGLSpriteBatch.prototype.flush = function() {
        if (0 !== this.currentBatchSize) {
            var t, e = this.gl;
            if (this.dirty) {
                this.dirty = !1,
                e.activeTexture(e.TEXTURE0),
                e.bindBuffer(e.ARRAY_BUFFER, this.vertexBuffer),
                e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, this.indexBuffer),
                t = this.defaultShader.shaders[e.id];
                var i = 4 * this.vertSize;
                e.vertexAttribPointer(t.aVertexPosition, 2, e.FLOAT, !1, i, 0),
                e.vertexAttribPointer(t.aTextureCoord, 2, e.FLOAT, !1, i, 8),
                e.vertexAttribPointer(t.colorAttribute, 4, e.UNSIGNED_BYTE, !0, i, 16)
            }
            if (this.currentBatchSize > .5 * this.size)
                e.bufferSubData(e.ARRAY_BUFFER, 0, this.vertices);
            else {
                var s = this.positions.subarray(0, 4 * this.currentBatchSize * this.vertSize);
                e.bufferSubData(e.ARRAY_BUFFER, 0, s)
            }
            for (var n, r, o, a, h = 0, l = 0, c = null, d = this.renderSession.blendModeManager.currentBlendMode, u = null, p = !1, g = !1, f = 0, m = this.currentBatchSize; f < m; f++) {
                n = (a = this.sprites[f]).tilingTexture ? a.tilingTexture.baseTexture : a.texture.baseTexture,
                p = d !== (r = a.blendMode),
                g = u !== (o = a.shader || this.defaultShader);
                var y = n.skipRender;
                if (y && 0 < a.children.length && (y = !1),
                (c !== n && !y || p || g) && (this.renderBatch(c, h, l),
                l = f,
                h = 0,
                c = n,
                p && (d = r,
                this.renderSession.blendModeManager.setBlendMode(d)),
                g)) {
                    (t = (u = o).shaders[e.id]) || ((t = new O.PixiShader(e)).fragmentSrc = u.fragmentSrc,
                    t.uniforms = u.uniforms,
                    t.init(),
                    u.shaders[e.id] = t),
                    this.renderSession.shaderManager.setShader(t),
                    t.dirty && t.syncUniforms();
                    var v = this.renderSession.projection;
                    e.uniform2f(t.projectionVector, v.x, v.y);
                    var _ = this.renderSession.offset;
                    e.uniform2f(t.offsetVector, _.x, _.y)
                }
                h++
            }
            this.renderBatch(c, h, l),
            this.currentBatchSize = 0
        }
    }
    ,
    O.WebGLSpriteBatch.prototype.renderBatch = function(t, e, i) {
        if (0 !== e) {
            var s = this.gl;
            if (t._dirty[s.id]) {
                if (!this.renderSession.renderer.updateTexture(t))
                    return
            } else
                s.bindTexture(s.TEXTURE_2D, t._glTextures[s.id]);
            s.drawElements(s.TRIANGLES, 6 * e, s.UNSIGNED_SHORT, 6 * i * 2),
            this.renderSession.drawCount++
        }
    }
    ,
    O.WebGLSpriteBatch.prototype.stop = function() {
        this.flush(),
        this.dirty = !0
    }
    ,
    O.WebGLSpriteBatch.prototype.start = function() {
        this.dirty = !0
    }
    ,
    O.WebGLSpriteBatch.prototype.destroy = function() {
        this.vertices = null,
        this.indices = null,
        this.gl.deleteBuffer(this.vertexBuffer),
        this.gl.deleteBuffer(this.indexBuffer),
        this.currentBaseTexture = null,
        this.gl = null
    }
    ,
    O.WebGLFastSpriteBatch = function(t) {
        this.vertSize = 10,
        this.maxSize = 6e3,
        this.size = this.maxSize;
        var e = 4 * this.size * this.vertSize
          , i = 6 * this.maxSize;
        this.vertices = new O.Float32Array(e),
        this.indices = new O.Uint16Array(i),
        this.vertexBuffer = null,
        this.indexBuffer = null;
        for (var s = this.lastIndexCount = 0, n = 0; s < i; s += 6,
        n += 4)
            this.indices[s + 0] = n + 0,
            this.indices[s + 1] = n + 1,
            this.indices[s + 2] = n + 2,
            this.indices[s + 3] = n + 0,
            this.indices[s + 4] = n + 2,
            this.indices[s + 5] = n + 3;
        this.drawing = !1,
        this.currentBatchSize = 0,
        this.currentBaseTexture = null,
        this.currentBlendMode = 0,
        this.renderSession = null,
        this.shader = null,
        this.matrix = null,
        this.setContext(t)
    }
    ,
    O.WebGLFastSpriteBatch.prototype.constructor = O.WebGLFastSpriteBatch,
    O.WebGLFastSpriteBatch.prototype.setContext = function(t) {
        this.gl = t,
        this.vertexBuffer = t.createBuffer(),
        this.indexBuffer = t.createBuffer(),
        t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer),
        t.bufferData(t.ELEMENT_ARRAY_BUFFER, this.indices, t.STATIC_DRAW),
        t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer),
        t.bufferData(t.ARRAY_BUFFER, this.vertices, t.DYNAMIC_DRAW)
    }
    ,
    O.WebGLFastSpriteBatch.prototype.begin = function(t, e) {
        this.renderSession = e,
        this.shader = this.renderSession.shaderManager.fastShader,
        this.matrix = t.worldTransform.toArray(!0),
        this.start()
    }
    ,
    O.WebGLFastSpriteBatch.prototype.end = function() {
        this.flush()
    }
    ,
    O.WebGLFastSpriteBatch.prototype.render = function(t) {
        var e = t.children
          , i = e[0];
        if (i.texture._uvs) {
            this.currentBaseTexture = i.texture.baseTexture,
            i.blendMode !== this.renderSession.blendModeManager.currentBlendMode && (this.flush(),
            this.renderSession.blendModeManager.setBlendMode(i.blendMode));
            for (var s = 0, n = e.length; s < n; s++)
                this.renderSprite(e[s]);
            this.flush()
        }
    }
    ,
    O.WebGLFastSpriteBatch.prototype.renderSprite = function(t) {
        if (t.visible && (t.texture.baseTexture === this.currentBaseTexture || t.texture.baseTexture.skipRender || (this.flush(),
        this.currentBaseTexture = t.texture.baseTexture,
        t.texture._uvs))) {
            var e, i, s, n, r, o, a = this.vertices;
            if (e = t.texture._uvs,
            t.texture.frame.width,
            t.texture.frame.height,
            t.texture.trim) {
                var h = t.texture.trim;
                i = (s = h.x - t.anchor.x * h.width) + t.texture.crop.width,
                n = (r = h.y - t.anchor.y * h.height) + t.texture.crop.height
            } else
                i = t.texture.frame.width * (1 - t.anchor.x),
                s = t.texture.frame.width * -t.anchor.x,
                n = t.texture.frame.height * (1 - t.anchor.y),
                r = t.texture.frame.height * -t.anchor.y;
            o = 4 * this.currentBatchSize * this.vertSize,
            a[o++] = s,
            a[o++] = r,
            a[o++] = t.position.x,
            a[o++] = t.position.y,
            a[o++] = t.scale.x,
            a[o++] = t.scale.y,
            a[o++] = t.rotation,
            a[o++] = e.x0,
            a[o++] = e.y1,
            a[o++] = t.alpha,
            a[o++] = i,
            a[o++] = r,
            a[o++] = t.position.x,
            a[o++] = t.position.y,
            a[o++] = t.scale.x,
            a[o++] = t.scale.y,
            a[o++] = t.rotation,
            a[o++] = e.x1,
            a[o++] = e.y1,
            a[o++] = t.alpha,
            a[o++] = i,
            a[o++] = n,
            a[o++] = t.position.x,
            a[o++] = t.position.y,
            a[o++] = t.scale.x,
            a[o++] = t.scale.y,
            a[o++] = t.rotation,
            a[o++] = e.x2,
            a[o++] = e.y2,
            a[o++] = t.alpha,
            a[o++] = s,
            a[o++] = n,
            a[o++] = t.position.x,
            a[o++] = t.position.y,
            a[o++] = t.scale.x,
            a[o++] = t.scale.y,
            a[o++] = t.rotation,
            a[o++] = e.x3,
            a[o++] = e.y3,
            a[o++] = t.alpha,
            this.currentBatchSize++,
            this.currentBatchSize >= this.size && this.flush()
        }
    }
    ,
    O.WebGLFastSpriteBatch.prototype.flush = function() {
        if (0 !== this.currentBatchSize) {
            var t = this.gl;
            if (this.currentBaseTexture._glTextures[t.id] || this.renderSession.renderer.updateTexture(this.currentBaseTexture, t),
            t.bindTexture(t.TEXTURE_2D, this.currentBaseTexture._glTextures[t.id]),
            this.currentBatchSize > .5 * this.size)
                t.bufferSubData(t.ARRAY_BUFFER, 0, this.vertices);
            else {
                var e = this.vertices.subarray(0, 4 * this.currentBatchSize * this.vertSize);
                t.bufferSubData(t.ARRAY_BUFFER, 0, e)
            }
            t.drawElements(t.TRIANGLES, 6 * this.currentBatchSize, t.UNSIGNED_SHORT, 0),
            this.currentBatchSize = 0,
            this.renderSession.drawCount++
        }
    }
    ,
    O.WebGLFastSpriteBatch.prototype.stop = function() {
        this.flush()
    }
    ,
    O.WebGLFastSpriteBatch.prototype.start = function() {
        var t = this.gl;
        t.activeTexture(t.TEXTURE0),
        t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer),
        t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer);
        var e = this.renderSession.projection;
        t.uniform2f(this.shader.projectionVector, e.x, e.y),
        t.uniformMatrix3fv(this.shader.uMatrix, !1, this.matrix);
        var i = 4 * this.vertSize;
        t.vertexAttribPointer(this.shader.aVertexPosition, 2, t.FLOAT, !1, i, 0),
        t.vertexAttribPointer(this.shader.aPositionCoord, 2, t.FLOAT, !1, i, 8),
        t.vertexAttribPointer(this.shader.aScale, 2, t.FLOAT, !1, i, 16),
        t.vertexAttribPointer(this.shader.aRotation, 1, t.FLOAT, !1, i, 24),
        t.vertexAttribPointer(this.shader.aTextureCoord, 2, t.FLOAT, !1, i, 28),
        t.vertexAttribPointer(this.shader.colorAttribute, 1, t.FLOAT, !1, i, 36)
    }
    ,
    O.WebGLFilterManager = function() {
        this.filterStack = [],
        this.offsetX = 0,
        this.offsetY = 0
    }
    ,
    O.WebGLFilterManager.prototype.constructor = O.WebGLFilterManager,
    O.WebGLFilterManager.prototype.setContext = function(t) {
        this.gl = t,
        this.texturePool = [],
        this.initShaderBuffers()
    }
    ,
    O.WebGLFilterManager.prototype.begin = function(t, e) {
        this.renderSession = t,
        this.defaultShader = t.shaderManager.defaultShader;
        var i = this.renderSession.projection;
        this.width = 2 * i.x,
        this.height = 2 * -i.y,
        this.buffer = e
    }
    ,
    O.WebGLFilterManager.prototype.pushFilter = function(t) {
        var e = this.gl
          , i = this.renderSession.projection
          , s = this.renderSession.offset;
        t._filterArea = t.target.filterArea || t.target.getBounds(),
        t._previous_stencil_mgr = this.renderSession.stencilManager,
        this.renderSession.stencilManager = new O.WebGLStencilManager,
        this.renderSession.stencilManager.setContext(e),
        e.disable(e.STENCIL_TEST),
        this.filterStack.push(t);
        var n = t.filterPasses[0];
        this.offsetX += t._filterArea.x,
        this.offsetY += t._filterArea.y;
        var r = this.texturePool.pop();
        r ? r.resize(this.width * this.renderSession.resolution, this.height * this.renderSession.resolution) : r = new O.FilterTexture(this.gl,this.width * this.renderSession.resolution,this.height * this.renderSession.resolution),
        e.bindTexture(e.TEXTURE_2D, r.texture);
        var o = t._filterArea
          , a = n.padding;
        o.x -= a,
        o.y -= a,
        o.width += 2 * a,
        o.height += 2 * a,
        o.x < 0 && (o.x = 0),
        o.width > this.width && (o.width = this.width),
        o.y < 0 && (o.y = 0),
        o.height > this.height && (o.height = this.height),
        e.bindFramebuffer(e.FRAMEBUFFER, r.frameBuffer),
        e.viewport(0, 0, o.width * this.renderSession.resolution, o.height * this.renderSession.resolution),
        i.x = o.width / 2,
        i.y = -o.height / 2,
        s.x = -o.x,
        s.y = -o.y,
        e.colorMask(!0, !0, !0, !0),
        e.clearColor(0, 0, 0, 0),
        e.clear(e.COLOR_BUFFER_BIT),
        t._glFilterTexture = r
    }
    ,
    O.WebGLFilterManager.prototype.popFilter = function() {
        var t = this.gl
          , e = this.filterStack.pop()
          , i = e._filterArea
          , s = e._glFilterTexture
          , n = this.renderSession.projection
          , r = this.renderSession.offset;
        if (1 < e.filterPasses.length) {
            t.viewport(0, 0, i.width * this.renderSession.resolution, i.height * this.renderSession.resolution),
            t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer),
            this.vertexArray[0] = 0,
            this.vertexArray[1] = i.height,
            this.vertexArray[2] = i.width,
            this.vertexArray[3] = i.height,
            this.vertexArray[4] = 0,
            this.vertexArray[5] = 0,
            this.vertexArray[6] = i.width,
            this.vertexArray[7] = 0,
            t.bufferSubData(t.ARRAY_BUFFER, 0, this.vertexArray),
            t.bindBuffer(t.ARRAY_BUFFER, this.uvBuffer),
            this.uvArray[2] = i.width / this.width,
            this.uvArray[5] = i.height / this.height,
            this.uvArray[6] = i.width / this.width,
            this.uvArray[7] = i.height / this.height,
            t.bufferSubData(t.ARRAY_BUFFER, 0, this.uvArray);
            var o = s
              , a = this.texturePool.pop();
            a || (a = new O.FilterTexture(this.gl,this.width * this.renderSession.resolution,this.height * this.renderSession.resolution)),
            a.resize(this.width * this.renderSession.resolution, this.height * this.renderSession.resolution),
            t.bindFramebuffer(t.FRAMEBUFFER, a.frameBuffer),
            t.clear(t.COLOR_BUFFER_BIT),
            t.disable(t.BLEND);
            for (var h = 0; h < e.filterPasses.length - 1; h++) {
                var l = e.filterPasses[h];
                t.bindFramebuffer(t.FRAMEBUFFER, a.frameBuffer),
                t.activeTexture(t.TEXTURE0),
                t.bindTexture(t.TEXTURE_2D, o.texture),
                this.applyFilterPass(l, i, i.width, i.height);
                var c = o;
                o = a,
                a = c
            }
            t.enable(t.BLEND),
            s = o,
            this.texturePool.push(a)
        }
        var d = e.filterPasses[e.filterPasses.length - 1];
        this.offsetX -= i.x,
        this.offsetY -= i.y;
        var u = this.width
          , p = this.height
          , g = 0
          , f = 0
          , m = this.buffer;
        if (0 === this.filterStack.length)
            t.colorMask(!0, !0, !0, !0);
        else {
            var y = this.filterStack[this.filterStack.length - 1];
            u = (i = y._filterArea).width,
            p = i.height,
            g = i.x,
            f = i.y,
            m = y._glFilterTexture.frameBuffer
        }
        n.x = u / 2,
        n.y = -p / 2,
        r.x = g,
        r.y = f;
        var v = (i = e._filterArea).x - g
          , _ = i.y - f;
        t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer),
        this.vertexArray[0] = v,
        this.vertexArray[1] = _ + i.height,
        this.vertexArray[2] = v + i.width,
        this.vertexArray[3] = _ + i.height,
        this.vertexArray[4] = v,
        this.vertexArray[5] = _,
        this.vertexArray[6] = v + i.width,
        this.vertexArray[7] = _,
        t.bufferSubData(t.ARRAY_BUFFER, 0, this.vertexArray),
        t.bindBuffer(t.ARRAY_BUFFER, this.uvBuffer),
        this.uvArray[2] = i.width / this.width,
        this.uvArray[5] = i.height / this.height,
        this.uvArray[6] = i.width / this.width,
        this.uvArray[7] = i.height / this.height,
        t.bufferSubData(t.ARRAY_BUFFER, 0, this.uvArray),
        t.viewport(0, 0, u * this.renderSession.resolution, p * this.renderSession.resolution),
        t.bindFramebuffer(t.FRAMEBUFFER, m),
        t.activeTexture(t.TEXTURE0),
        t.bindTexture(t.TEXTURE_2D, s.texture),
        this.renderSession.stencilManager && this.renderSession.stencilManager.destroy(),
        this.renderSession.stencilManager = e._previous_stencil_mgr,
        e._previous_stencil_mgr = null,
        0 < this.renderSession.stencilManager.count ? t.enable(t.STENCIL_TEST) : t.disable(t.STENCIL_TEST),
        this.applyFilterPass(d, i, u, p),
        this.texturePool.push(s),
        e._glFilterTexture = null
    }
    ,
    O.WebGLFilterManager.prototype.applyFilterPass = function(t, e, i, s) {
        var n = this.gl
          , r = t.shaders[n.id];
        r || ((r = new O.PixiShader(n)).fragmentSrc = t.fragmentSrc,
        r.uniforms = t.uniforms,
        r.init(),
        t.shaders[n.id] = r),
        this.renderSession.shaderManager.setShader(r),
        n.uniform2f(r.projectionVector, i / 2, -s / 2),
        n.uniform2f(r.offsetVector, 0, 0),
        t.uniforms.dimensions && (t.uniforms.dimensions.value[0] = this.width,
        t.uniforms.dimensions.value[1] = this.height,
        t.uniforms.dimensions.value[2] = this.vertexArray[0],
        t.uniforms.dimensions.value[3] = this.vertexArray[5]),
        r.syncUniforms(),
        n.bindBuffer(n.ARRAY_BUFFER, this.vertexBuffer),
        n.vertexAttribPointer(r.aVertexPosition, 2, n.FLOAT, !1, 0, 0),
        n.bindBuffer(n.ARRAY_BUFFER, this.uvBuffer),
        n.vertexAttribPointer(r.aTextureCoord, 2, n.FLOAT, !1, 0, 0),
        n.bindBuffer(n.ARRAY_BUFFER, this.colorBuffer),
        n.vertexAttribPointer(r.colorAttribute, 2, n.FLOAT, !1, 0, 0),
        n.bindBuffer(n.ELEMENT_ARRAY_BUFFER, this.indexBuffer),
        n.drawElements(n.TRIANGLES, 6, n.UNSIGNED_SHORT, 0),
        this.renderSession.drawCount++
    }
    ,
    O.WebGLFilterManager.prototype.initShaderBuffers = function() {
        var t = this.gl;
        this.vertexBuffer = t.createBuffer(),
        this.uvBuffer = t.createBuffer(),
        this.colorBuffer = t.createBuffer(),
        this.indexBuffer = t.createBuffer(),
        this.vertexArray = new O.Float32Array([0, 0, 1, 0, 0, 1, 1, 1]),
        t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer),
        t.bufferData(t.ARRAY_BUFFER, this.vertexArray, t.STATIC_DRAW),
        this.uvArray = new O.Float32Array([0, 0, 1, 0, 0, 1, 1, 1]),
        t.bindBuffer(t.ARRAY_BUFFER, this.uvBuffer),
        t.bufferData(t.ARRAY_BUFFER, this.uvArray, t.STATIC_DRAW),
        this.colorArray = new O.Float32Array([1, 16777215, 1, 16777215, 1, 16777215, 1, 16777215]),
        t.bindBuffer(t.ARRAY_BUFFER, this.colorBuffer),
        t.bufferData(t.ARRAY_BUFFER, this.colorArray, t.STATIC_DRAW),
        t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer),
        t.bufferData(t.ELEMENT_ARRAY_BUFFER, new Uint16Array([0, 1, 2, 1, 3, 2]), t.STATIC_DRAW)
    }
    ,
    O.WebGLFilterManager.prototype.destroy = function() {
        var t = this.gl;
        this.filterStack = null,
        this.offsetX = 0;
        for (var e = this.offsetY = 0; e < this.texturePool.length; e++)
            this.texturePool[e].destroy();
        this.texturePool = null,
        t.deleteBuffer(this.vertexBuffer),
        t.deleteBuffer(this.uvBuffer),
        t.deleteBuffer(this.colorBuffer),
        t.deleteBuffer(this.indexBuffer)
    }
    ,
    O.FilterTexture = function(t, e, i, s) {
        this.gl = t,
        this.frameBuffer = t.createFramebuffer(),
        this.texture = t.createTexture(),
        s = s || O.scaleModes.DEFAULT,
        t.bindTexture(t.TEXTURE_2D, this.texture),
        t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MAG_FILTER, s === O.scaleModes.LINEAR ? t.LINEAR : t.NEAREST),
        t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MIN_FILTER, s === O.scaleModes.LINEAR ? t.LINEAR : t.NEAREST),
        t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_S, t.CLAMP_TO_EDGE),
        t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_T, t.CLAMP_TO_EDGE),
        t.bindFramebuffer(t.FRAMEBUFFER, this.frameBuffer),
        t.bindFramebuffer(t.FRAMEBUFFER, this.frameBuffer),
        t.framebufferTexture2D(t.FRAMEBUFFER, t.COLOR_ATTACHMENT0, t.TEXTURE_2D, this.texture, 0),
        this.renderBuffer = t.createRenderbuffer(),
        t.bindRenderbuffer(t.RENDERBUFFER, this.renderBuffer),
        t.framebufferRenderbuffer(t.FRAMEBUFFER, t.DEPTH_STENCIL_ATTACHMENT, t.RENDERBUFFER, this.renderBuffer),
        this.resize(e, i)
    }
    ,
    O.FilterTexture.prototype.constructor = O.FilterTexture,
    O.FilterTexture.prototype.clear = function() {
        var t = this.gl;
        t.clearColor(0, 0, 0, 0),
        t.clear(t.COLOR_BUFFER_BIT)
    }
    ,
    O.FilterTexture.prototype.resize = function(t, e) {
        if (this.width !== t || this.height !== e) {
            this.width = t,
            this.height = e;
            var i = this.gl;
            i.bindTexture(i.TEXTURE_2D, this.texture),
            i.texImage2D(i.TEXTURE_2D, 0, i.RGBA, t, e, 0, i.RGBA, i.UNSIGNED_BYTE, null),
            i.bindRenderbuffer(i.RENDERBUFFER, this.renderBuffer),
            i.renderbufferStorage(i.RENDERBUFFER, i.DEPTH_STENCIL, t, e)
        }
    }
    ,
    O.FilterTexture.prototype.destroy = function() {
        var t = this.gl;
        t.deleteFramebuffer(this.frameBuffer),
        t.deleteTexture(this.texture),
        this.frameBuffer = null,
        this.texture = null
    }
    ,
    O.CanvasBuffer = function(t, e) {
        this.width = t,
        this.height = e,
        this.canvas = O.CanvasPool.create(this, this.width, this.height),
        this.context = this.canvas.getContext("2d"),
        this.canvas.width = t,
        this.canvas.height = e
    }
    ,
    O.CanvasBuffer.prototype.constructor = O.CanvasBuffer,
    O.CanvasBuffer.prototype.clear = function() {
        this.context.setTransform(1, 0, 0, 1, 0, 0),
        this.context.clearRect(0, 0, this.width, this.height)
    }
    ,
    O.CanvasBuffer.prototype.resize = function(t, e) {
        this.width = this.canvas.width = t,
        this.height = this.canvas.height = e
    }
    ,
    O.CanvasBuffer.prototype.destroy = function() {
        O.CanvasPool.remove(this)
    }
    ,
    O.CanvasMaskManager = function() {}
    ,
    O.CanvasMaskManager.prototype.constructor = O.CanvasMaskManager,
    O.CanvasMaskManager.prototype.pushMask = function(t, e) {
        var i = e.context;
        i.save();
        var s = t.alpha
          , n = t.worldTransform
          , r = e.resolution;
        i.setTransform(n.a * r, n.b * r, n.c * r, n.d * r, n.tx * r, n.ty * r),
        O.CanvasGraphics.renderGraphicsMask(t, i),
        i.clip(),
        t.worldAlpha = s
    }
    ,
    O.CanvasMaskManager.prototype.popMask = function(t) {
        t.context.restore()
    }
    ,
    O.CanvasTinter = function() {}
    ,
    O.CanvasTinter.getTintedTexture = function(t, e) {
        var i = t.tintedTexture || O.CanvasPool.create(this);
        return O.CanvasTinter.tintMethod(t.texture, e, i),
        i
    }
    ,
    O.CanvasTinter.tintWithMultiply = function(t, e, i) {
        var s = i.getContext("2d")
          , n = t.crop;
        i.width === n.width && i.height === n.height || (i.width = n.width,
        i.height = n.height),
        s.clearRect(0, 0, n.width, n.height),
        s.fillStyle = "#" + ("00000" + (0 | e).toString(16)).substr(-6),
        s.fillRect(0, 0, n.width, n.height),
        s.globalCompositeOperation = "multiply",
        s.drawImage(t.baseTexture.source, n.x, n.y, n.width, n.height, 0, 0, n.width, n.height),
        s.globalCompositeOperation = "destination-atop",
        s.drawImage(t.baseTexture.source, n.x, n.y, n.width, n.height, 0, 0, n.width, n.height)
    }
    ,
    O.CanvasTinter.tintWithPerPixel = function(t, e, i) {
        var s = i.getContext("2d")
          , n = t.crop;
        i.width = n.width,
        i.height = n.height,
        s.globalCompositeOperation = "copy",
        s.drawImage(t.baseTexture.source, n.x, n.y, n.width, n.height, 0, 0, n.width, n.height);
        for (var r = O.hex2rgb(e), o = r[0], a = r[1], h = r[2], l = s.getImageData(0, 0, n.width, n.height), c = l.data, d = 0; d < c.length; d += 4)
            if (c[d + 0] *= o,
            c[d + 1] *= a,
            c[d + 2] *= h,
            !O.CanvasTinter.canHandleAlpha) {
                var u = c[d + 3];
                c[d + 0] /= 255 / u,
                c[d + 1] /= 255 / u,
                c[d + 2] /= 255 / u
            }
        s.putImageData(l, 0, 0)
    }
    ,
    O.CanvasTinter.checkInverseAlpha = function() {
        var t = new O.CanvasBuffer(2,1);
        t.context.fillStyle = "rgba(10, 20, 30, 0.5)",
        t.context.fillRect(0, 0, 1, 1);
        var e = t.context.getImageData(0, 0, 1, 1);
        if (null === e)
            return !1;
        t.context.putImageData(e, 1, 0);
        var i = t.context.getImageData(1, 0, 1, 1);
        return i.data[0] === e.data[0] && i.data[1] === e.data[1] && i.data[2] === e.data[2] && i.data[3] === e.data[3]
    }
    ,
    O.CanvasTinter.canHandleAlpha = O.CanvasTinter.checkInverseAlpha(),
    O.CanvasTinter.canUseMultiply = O.canUseNewCanvasBlendModes(),
    O.CanvasTinter.tintMethod = O.CanvasTinter.canUseMultiply ? O.CanvasTinter.tintWithMultiply : O.CanvasTinter.tintWithPerPixel,
    O.CanvasRenderer = function(t) {
        this.game = t,
        O.defaultRenderer || (O.defaultRenderer = this),
        this.type = O.CANVAS_RENDERER,
        this.resolution = t.resolution,
        this.clearBeforeRender = t.clearBeforeRender,
        this.transparent = t.transparent,
        this.autoResize = !1,
        this.width = t.width * this.resolution,
        this.height = t.height * this.resolution,
        this.view = t.canvas,
        this.context = this.view.getContext("2d", {
            alpha: this.transparent
        }),
        this.refresh = !0,
        this.count = 0,
        this.maskManager = new O.CanvasMaskManager,
        this.renderSession = {
            context: this.context,
            maskManager: this.maskManager,
            scaleMode: null,
            smoothProperty: Phaser.Canvas.getSmoothingPrefix(this.context),
            roundPixels: !1
        },
        this.mapBlendModes(),
        this.resize(this.width, this.height)
    }
    ,
    O.CanvasRenderer.prototype.constructor = O.CanvasRenderer,
    O.CanvasRenderer.prototype.render = function(t) {
        this.context.setTransform(1, 0, 0, 1, 0, 0),
        this.context.globalAlpha = 1,
        this.renderSession.currentBlendMode = 0,
        this.renderSession.shakeX = this.game.camera._shake.x,
        this.renderSession.shakeY = this.game.camera._shake.y,
        this.context.globalCompositeOperation = "source-over",
        navigator.isCocoonJS && this.view.screencanvas && (this.context.fillStyle = "black",
        this.context.clear()),
        this.clearBeforeRender && (this.transparent ? this.context.clearRect(0, 0, this.width, this.height) : t._bgColor && (this.context.fillStyle = t._bgColor.rgba,
        this.context.fillRect(0, 0, this.width, this.height))),
        this.renderDisplayObject(t)
    }
    ,
    O.CanvasRenderer.prototype.destroy = function(t) {
        void 0 === t && (t = !0),
        t && this.view.parent && this.view.parent.removeChild(this.view),
        this.view = null,
        this.context = null,
        this.maskManager = null,
        this.renderSession = null
    }
    ,
    O.CanvasRenderer.prototype.resize = function(t, e) {
        this.width = t * this.resolution,
        this.height = e * this.resolution,
        this.view.width = this.width,
        this.view.height = this.height,
        this.autoResize && (this.view.style.width = this.width / this.resolution + "px",
        this.view.style.height = this.height / this.resolution + "px"),
        this.renderSession.smoothProperty && (this.context[this.renderSession.smoothProperty] = this.renderSession.scaleMode === O.scaleModes.LINEAR)
    }
    ,
    O.CanvasRenderer.prototype.renderDisplayObject = function(t, e, i) {
        this.renderSession.context = e || this.context,
        this.renderSession.resolution = this.resolution,
        t._renderCanvas(this.renderSession, i)
    }
    ,
    O.CanvasRenderer.prototype.mapBlendModes = function() {
        if (!O.blendModesCanvas) {
            var t = []
              , e = O.blendModes
              , i = O.canUseNewCanvasBlendModes();
            t[e.NORMAL] = "source-over",
            t[e.ADD] = "lighter",
            t[e.MULTIPLY] = i ? "multiply" : "source-over",
            t[e.SCREEN] = i ? "screen" : "source-over",
            t[e.OVERLAY] = i ? "overlay" : "source-over",
            t[e.DARKEN] = i ? "darken" : "source-over",
            t[e.LIGHTEN] = i ? "lighten" : "source-over",
            t[e.COLOR_DODGE] = i ? "color-dodge" : "source-over",
            t[e.COLOR_BURN] = i ? "color-burn" : "source-over",
            t[e.HARD_LIGHT] = i ? "hard-light" : "source-over",
            t[e.SOFT_LIGHT] = i ? "soft-light" : "source-over",
            t[e.DIFFERENCE] = i ? "difference" : "source-over",
            t[e.EXCLUSION] = i ? "exclusion" : "source-over",
            t[e.HUE] = i ? "hue" : "source-over",
            t[e.SATURATION] = i ? "saturation" : "source-over",
            t[e.COLOR] = i ? "color" : "source-over",
            t[e.LUMINOSITY] = i ? "luminosity" : "source-over",
            O.blendModesCanvas = t
        }
    }
    ,
    O.BaseTexture = function(t, e) {
        this.resolution = 1,
        this.width = 100,
        this.height = 100,
        this.scaleMode = e || O.scaleModes.DEFAULT,
        this.hasLoaded = !1,
        this.source = t,
        this.premultipliedAlpha = !0,
        this._glTextures = [],
        this.mipmap = !1,
        this._dirty = [!0, !0, !0, !0],
        t && ((this.source.complete || this.source.getContext) && this.source.width && this.source.height && (this.hasLoaded = !0,
        this.width = this.source.naturalWidth || this.source.width,
        this.height = this.source.naturalHeight || this.source.height,
        this.dirty()),
        this.skipRender = !1,
        this._powerOf2 = !1)
    }
    ,
    O.BaseTexture.prototype.constructor = O.BaseTexture,
    O.BaseTexture.prototype.forceLoaded = function(t, e) {
        this.hasLoaded = !0,
        this.width = t,
        this.height = e,
        this.dirty()
    }
    ,
    O.BaseTexture.prototype.destroy = function() {
        this.source && O.CanvasPool.removeByCanvas(this.source),
        this.source = null,
        this.unloadFromGPU()
    }
    ,
    O.BaseTexture.prototype.updateSourceImage = function(t) {}
    ,
    O.BaseTexture.prototype.dirty = function() {
        for (var t = 0; t < this._glTextures.length; t++)
            this._dirty[t] = !0
    }
    ,
    O.BaseTexture.prototype.unloadFromGPU = function() {
        this.dirty();
        for (var t = this._glTextures.length - 1; 0 <= t; t--) {
            var e = this._glTextures[t]
              , i = O.glContexts[t];
            i && e && i.deleteTexture(e)
        }
        this._glTextures.length = 0,
        this.dirty()
    }
    ,
    O.BaseTexture.fromCanvas = function(t, e) {
        return 0 === t.width && (t.width = 1),
        0 === t.height && (t.height = 1),
        new O.BaseTexture(t,e)
    }
    ,
    O.TextureSilentFail = !1,
    O.Texture = function(t, e, i, s) {
        this.noFrame = !1,
        e || (this.noFrame = !0,
        e = new O.Rectangle(0,0,1,1)),
        t instanceof O.Texture && (t = t.baseTexture),
        this.baseTexture = t,
        this.frame = e,
        this.trim = s,
        this.valid = !1,
        this.isTiling = !1,
        this.requiresUpdate = !1,
        this.requiresReTint = !1,
        this._uvs = null,
        this.width = 0,
        this.height = 0,
        this.crop = i || new O.Rectangle(0,0,1,1),
        t.hasLoaded && (this.noFrame && (e = new O.Rectangle(0,0,t.width,t.height)),
        this.setFrame(e))
    }
    ,
    O.Texture.prototype.constructor = O.Texture,
    O.Texture.prototype.onBaseTextureLoaded = function() {
        var t = this.baseTexture;
        this.noFrame && (this.frame = new O.Rectangle(0,0,t.width,t.height)),
        this.setFrame(this.frame)
    }
    ,
    O.Texture.prototype.destroy = function(t) {
        t && this.baseTexture.destroy(),
        this.valid = !1
    }
    ,
    O.Texture.prototype.setFrame = function(t) {
        if (this.noFrame = !1,
        this.frame = t,
        this.width = t.width,
        this.height = t.height,
        this.crop.x = t.x,
        this.crop.y = t.y,
        this.crop.width = t.width,
        this.crop.height = t.height,
        this.trim || !(t.x + t.width > this.baseTexture.width || t.y + t.height > this.baseTexture.height))
            this.valid = t && t.width && t.height && this.baseTexture.source && this.baseTexture.hasLoaded,
            this.trim && (this.width = this.trim.width,
            this.height = this.trim.height,
            this.frame.width = this.trim.width,
            this.frame.height = this.trim.height),
            this.valid && this._updateUvs();
        else {
            if (!O.TextureSilentFail)
                throw new Error("Texture Error: frame does not fit inside the base Texture dimensions " + this);
            this.valid = !1
        }
    }
    ,
    O.Texture.prototype._updateUvs = function() {
        this._uvs || (this._uvs = new O.TextureUvs);
        var t = this.crop
          , e = this.baseTexture.width
          , i = this.baseTexture.height;
        this._uvs.x0 = t.x / e,
        this._uvs.y0 = t.y / i,
        this._uvs.x1 = (t.x + t.width) / e,
        this._uvs.y1 = t.y / i,
        this._uvs.x2 = (t.x + t.width) / e,
        this._uvs.y2 = (t.y + t.height) / i,
        this._uvs.x3 = t.x / e,
        this._uvs.y3 = (t.y + t.height) / i
    }
    ,
    O.Texture.fromCanvas = function(t, e) {
        var i = O.BaseTexture.fromCanvas(t, e);
        return new O.Texture(i)
    }
    ,
    O.TextureUvs = function() {
        this.x0 = 0,
        this.y0 = 0,
        this.x1 = 0,
        this.y1 = 0,
        this.x2 = 0,
        this.y2 = 0,
        this.x3 = 0,
        this.y3 = 0
    }
    ,
    O.RenderTexture = function(t, e, i, s, n) {
        if (this.width = t || 100,
        this.height = e || 100,
        this.resolution = n || 1,
        this.frame = new O.Rectangle(0,0,this.width * this.resolution,this.height * this.resolution),
        this.crop = new O.Rectangle(0,0,this.width * this.resolution,this.height * this.resolution),
        this.baseTexture = new O.BaseTexture,
        this.baseTexture.width = this.width * this.resolution,
        this.baseTexture.height = this.height * this.resolution,
        this.baseTexture._glTextures = [],
        this.baseTexture.resolution = this.resolution,
        this.baseTexture.scaleMode = s || O.scaleModes.DEFAULT,
        this.baseTexture.hasLoaded = !0,
        O.Texture.call(this, this.baseTexture, new O.Rectangle(0,0,this.width * this.resolution,this.height * this.resolution)),
        this.renderer = i || O.defaultRenderer,
        this.renderer.type === O.WEBGL_RENDERER) {
            var r = this.renderer.gl;
            this.baseTexture._dirty[r.id] = !1,
            this.textureBuffer = new O.FilterTexture(r,this.width,this.height,this.baseTexture.scaleMode),
            this.baseTexture._glTextures[r.id] = this.textureBuffer.texture,
            this.render = this.renderWebGL,
            this.projection = new O.Point(.5 * this.width,.5 * -this.height)
        } else
            this.render = this.renderCanvas,
            this.textureBuffer = new O.CanvasBuffer(this.width * this.resolution,this.height * this.resolution),
            this.baseTexture.source = this.textureBuffer.canvas;
        this.valid = !0,
        this.tempMatrix = new Phaser.Matrix,
        this._updateUvs()
    }
    ,
    O.RenderTexture.prototype = Object.create(O.Texture.prototype),
    O.RenderTexture.prototype.constructor = O.RenderTexture,
    O.RenderTexture.prototype.resize = function(t, e, i) {
        t === this.width && e === this.height || (this.valid = 0 < t && 0 < e,
        this.width = t,
        this.height = e,
        this.frame.width = this.crop.width = t * this.resolution,
        this.frame.height = this.crop.height = e * this.resolution,
        i && (this.baseTexture.width = this.width * this.resolution,
        this.baseTexture.height = this.height * this.resolution),
        this.renderer.type === O.WEBGL_RENDERER && (this.projection.x = this.width / 2,
        this.projection.y = -this.height / 2),
        this.valid && this.textureBuffer.resize(this.width, this.height))
    }
    ,
    O.RenderTexture.prototype.clear = function() {
        this.valid && (this.renderer.type === O.WEBGL_RENDERER && this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER, this.textureBuffer.frameBuffer),
        this.textureBuffer.clear())
    }
    ,
    O.RenderTexture.prototype.renderWebGL = function(t, e, i) {
        if (this.valid && 0 !== t.alpha) {
            var s = t.worldTransform;
            s.identity(),
            s.translate(0, 2 * this.projection.y),
            e && s.append(e),
            s.scale(1, -1);
            for (var n = 0; n < t.children.length; n++)
                t.children[n].updateTransform();
            var r = this.renderer.gl;
            r.viewport(0, 0, this.width * this.resolution, this.height * this.resolution),
            r.bindFramebuffer(r.FRAMEBUFFER, this.textureBuffer.frameBuffer),
            i && this.textureBuffer.clear(),
            this.renderer.spriteBatch.dirty = !0,
            this.renderer.renderDisplayObject(t, this.projection, this.textureBuffer.frameBuffer, e),
            this.renderer.spriteBatch.dirty = !0
        }
    }
    ,
    O.RenderTexture.prototype.renderCanvas = function(t, e, i) {
        if (this.valid && 0 !== t.alpha) {
            var s = t.worldTransform;
            s.identity(),
            e && s.append(e);
            for (var n = 0; n < t.children.length; n++)
                t.children[n].updateTransform();
            i && this.textureBuffer.clear();
            var r = this.renderer.resolution;
            this.renderer.resolution = this.resolution,
            this.renderer.renderDisplayObject(t, this.textureBuffer.context, e),
            this.renderer.resolution = r
        }
    }
    ,
    O.RenderTexture.prototype.getImage = function() {
        var t = new Image;
        return t.src = this.getBase64(),
        t
    }
    ,
    O.RenderTexture.prototype.getBase64 = function() {
        return this.getCanvas().toDataURL()
    }
    ,
    O.RenderTexture.prototype.getCanvas = function() {
        if (this.renderer.type !== O.WEBGL_RENDERER)
            return this.textureBuffer.canvas;
        var t = this.renderer.gl
          , e = this.textureBuffer.width
          , i = this.textureBuffer.height
          , s = new Uint8Array(4 * e * i);
        t.bindFramebuffer(t.FRAMEBUFFER, this.textureBuffer.frameBuffer),
        t.readPixels(0, 0, e, i, t.RGBA, t.UNSIGNED_BYTE, s),
        t.bindFramebuffer(t.FRAMEBUFFER, null);
        var n = new O.CanvasBuffer(e,i)
          , r = n.context.getImageData(0, 0, e, i);
        return r.data.set(s),
        n.context.putImageData(r, 0, 0),
        n.canvas
    }
    ,
    O.AbstractFilter = function(t, e) {
        this.passes = [this],
        this.shaders = [],
        this.dirty = !0,
        this.padding = 0,
        this.uniforms = e || {},
        this.fragmentSrc = t || []
    }
    ,
    O.AbstractFilter.prototype.constructor = O.AbstractFilter,
    O.AbstractFilter.prototype.syncUniforms = function() {
        for (var t = 0, e = this.shaders.length; t < e; t++)
            this.shaders[t].dirty = !0
    }
    ,
    O.Strip = function(t) {
        O.DisplayObjectContainer.call(this),
        this.texture = t,
        this.uvs = new O.Float32Array([0, 1, 1, 1, 1, 0, 0, 1]),
        this.vertices = new O.Float32Array([0, 0, 100, 0, 100, 100, 0, 100]),
        this.colors = new O.Float32Array([1, 1, 1, 1]),
        this.indices = new O.Uint16Array([0, 1, 2, 3]),
        this.dirty = !0,
        this.blendMode = O.blendModes.NORMAL,
        this.canvasPadding = 0,
        this.drawMode = O.Strip.DrawModes.TRIANGLE_STRIP
    }
    ,
    O.Strip.prototype = Object.create(O.DisplayObjectContainer.prototype),
    O.Strip.prototype.constructor = O.Strip,
    O.Strip.prototype._renderWebGL = function(t) {
        !this.visible || this.alpha <= 0 || (t.spriteBatch.stop(),
        this._vertexBuffer || this._initWebGL(t),
        t.shaderManager.setShader(t.shaderManager.stripShader),
        this._renderStrip(t),
        t.spriteBatch.start())
    }
    ,
    O.Strip.prototype._initWebGL = function(t) {
        var e = t.gl;
        this._vertexBuffer = e.createBuffer(),
        this._indexBuffer = e.createBuffer(),
        this._uvBuffer = e.createBuffer(),
        this._colorBuffer = e.createBuffer(),
        e.bindBuffer(e.ARRAY_BUFFER, this._vertexBuffer),
        e.bufferData(e.ARRAY_BUFFER, this.vertices, e.DYNAMIC_DRAW),
        e.bindBuffer(e.ARRAY_BUFFER, this._uvBuffer),
        e.bufferData(e.ARRAY_BUFFER, this.uvs, e.STATIC_DRAW),
        e.bindBuffer(e.ARRAY_BUFFER, this._colorBuffer),
        e.bufferData(e.ARRAY_BUFFER, this.colors, e.STATIC_DRAW),
        e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, this._indexBuffer),
        e.bufferData(e.ELEMENT_ARRAY_BUFFER, this.indices, e.STATIC_DRAW)
    }
    ,
    O.Strip.prototype._renderStrip = function(t) {
        var e = t.gl
          , i = t.projection
          , s = t.offset
          , n = t.shaderManager.stripShader
          , r = this.drawMode === O.Strip.DrawModes.TRIANGLE_STRIP ? e.TRIANGLE_STRIP : e.TRIANGLES;
        t.blendModeManager.setBlendMode(this.blendMode),
        e.uniformMatrix3fv(n.translationMatrix, !1, this.worldTransform.toArray(!0)),
        e.uniform2f(n.projectionVector, i.x, -i.y),
        e.uniform2f(n.offsetVector, -s.x, -s.y),
        e.uniform1f(n.alpha, this.worldAlpha),
        this.dirty ? (this.dirty = !1,
        e.bindBuffer(e.ARRAY_BUFFER, this._vertexBuffer),
        e.bufferData(e.ARRAY_BUFFER, this.vertices, e.STATIC_DRAW),
        e.vertexAttribPointer(n.aVertexPosition, 2, e.FLOAT, !1, 0, 0),
        e.bindBuffer(e.ARRAY_BUFFER, this._uvBuffer),
        e.bufferData(e.ARRAY_BUFFER, this.uvs, e.STATIC_DRAW),
        e.vertexAttribPointer(n.aTextureCoord, 2, e.FLOAT, !1, 0, 0),
        e.activeTexture(e.TEXTURE0),
        this.texture.baseTexture._dirty[e.id] ? t.renderer.updateTexture(this.texture.baseTexture) : e.bindTexture(e.TEXTURE_2D, this.texture.baseTexture._glTextures[e.id]),
        e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, this._indexBuffer),
        e.bufferData(e.ELEMENT_ARRAY_BUFFER, this.indices, e.STATIC_DRAW)) : (e.bindBuffer(e.ARRAY_BUFFER, this._vertexBuffer),
        e.bufferSubData(e.ARRAY_BUFFER, 0, this.vertices),
        e.vertexAttribPointer(n.aVertexPosition, 2, e.FLOAT, !1, 0, 0),
        e.bindBuffer(e.ARRAY_BUFFER, this._uvBuffer),
        e.vertexAttribPointer(n.aTextureCoord, 2, e.FLOAT, !1, 0, 0),
        e.activeTexture(e.TEXTURE0),
        this.texture.baseTexture._dirty[e.id] ? t.renderer.updateTexture(this.texture.baseTexture) : e.bindTexture(e.TEXTURE_2D, this.texture.baseTexture._glTextures[e.id]),
        e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, this._indexBuffer)),
        e.drawElements(r, this.indices.length, e.UNSIGNED_SHORT, 0)
    }
    ,
    O.Strip.prototype._renderCanvas = function(t) {
        var e = t.context
          , i = this.worldTransform
          , s = i.tx * t.resolution + t.shakeX
          , n = i.ty * t.resolution + t.shakeY;
        t.roundPixels ? e.setTransform(i.a, i.b, i.c, i.d, 0 | s, 0 | n) : e.setTransform(i.a, i.b, i.c, i.d, s, n),
        this.drawMode === O.Strip.DrawModes.TRIANGLE_STRIP ? this._renderCanvasTriangleStrip(e) : this._renderCanvasTriangles(e)
    }
    ,
    O.Strip.prototype._renderCanvasTriangleStrip = function(t) {
        var e = this.vertices
          , i = this.uvs
          , s = e.length / 2;
        this.count++;
        for (var n = 0; n < s - 2; n++) {
            var r = 2 * n;
            this._renderCanvasDrawTriangle(t, e, i, r, r + 2, r + 4)
        }
    }
    ,
    O.Strip.prototype._renderCanvasTriangles = function(t) {
        var e = this.vertices
          , i = this.uvs
          , s = this.indices
          , n = s.length;
        this.count++;
        for (var r = 0; r < n; r += 3) {
            var o = 2 * s[r]
              , a = 2 * s[r + 1]
              , h = 2 * s[r + 2];
            this._renderCanvasDrawTriangle(t, e, i, o, a, h)
        }
    }
    ,
    O.Strip.prototype._renderCanvasDrawTriangle = function(t, e, i, s, n, r) {
        var o = this.texture.baseTexture.source
          , a = this.texture.width
          , h = this.texture.height
          , l = e[s]
          , c = e[n]
          , d = e[r]
          , u = e[s + 1]
          , p = e[n + 1]
          , g = e[r + 1]
          , f = i[s] * a
          , m = i[n] * a
          , y = i[r] * a
          , v = i[s + 1] * h
          , _ = i[n + 1] * h
          , b = i[r + 1] * h;
        if (0 < this.canvasPadding) {
            var w = this.canvasPadding / this.worldTransform.a
              , x = this.canvasPadding / this.worldTransform.d
              , S = (l + c + d) / 3
              , T = (u + p + g) / 3
              , A = l - S
              , C = u - T
              , P = Math.sqrt(A * A + C * C);
            l = S + A / P * (P + w),
            u = T + C / P * (P + x),
            C = p - T,
            c = S + (A = c - S) / (P = Math.sqrt(A * A + C * C)) * (P + w),
            p = T + C / P * (P + x),
            C = g - T,
            d = S + (A = d - S) / (P = Math.sqrt(A * A + C * C)) * (P + w),
            g = T + C / P * (P + x)
        }
        t.save(),
        t.beginPath(),
        t.moveTo(l, u),
        t.lineTo(c, p),
        t.lineTo(d, g),
        t.closePath(),
        t.clip();
        var E = f * _ + v * y + m * b - _ * y - v * m - f * b
          , I = l * _ + v * d + c * b - _ * d - v * c - l * b
          , k = f * c + l * y + m * d - c * y - l * m - f * d
          , M = f * _ * d + v * c * y + l * m * b - l * _ * y - v * m * d - f * c * b
          , R = u * _ + v * g + p * b - _ * g - v * p - u * b
          , B = f * p + u * y + m * g - p * y - u * m - f * g
          , O = f * _ * g + v * p * y + u * m * b - u * _ * y - v * m * g - f * p * b;
        t.transform(I / E, R / E, k / E, B / E, M / E, O / E),
        t.drawImage(o, 0, 0),
        t.restore()
    }
    ,
    O.Strip.prototype.renderStripFlat = function(t) {
        var e = this.context
          , i = t.vertices
          , s = i.length / 2;
        this.count++,
        e.beginPath();
        for (var n = 1; n < s - 2; n++) {
            var r = 2 * n
              , o = i[r]
              , a = i[r + 2]
              , h = i[r + 4]
              , l = i[r + 1]
              , c = i[r + 3]
              , d = i[r + 5];
            e.moveTo(o, l),
            e.lineTo(a, c),
            e.lineTo(h, d)
        }
        e.fillStyle = "#FF0000",
        e.fill(),
        e.closePath()
    }
    ,
    O.Strip.prototype.onTextureUpdate = function() {
        this.updateFrame = !0
    }
    ,
    O.Strip.prototype.getBounds = function(t) {
        for (var e = t || this.worldTransform, i = e.a, s = e.b, n = e.c, r = e.d, o = e.tx, a = e.ty, h = -1 / 0, l = -1 / 0, c = 1 / 0, d = 1 / 0, u = this.vertices, p = 0, g = u.length; p < g; p += 2) {
            var f = u[p]
              , m = u[p + 1]
              , y = i * f + n * m + o
              , v = r * m + s * f + a;
            c = y < c ? y : c,
            d = v < d ? v : d,
            h = h < y ? y : h,
            l = l < v ? v : l
        }
        if (c === -1 / 0 || l === 1 / 0)
            return O.EmptyRectangle;
        var _ = this._bounds;
        return _.x = c,
        _.width = h - c,
        _.y = d,
        _.height = l - d,
        this._currentBounds = _
    }
    ,
    O.Strip.DrawModes = {
        TRIANGLE_STRIP: 0,
        TRIANGLES: 1
    },
    O.Rope = function(t, e) {
        O.Strip.call(this, t),
        this.points = e,
        this.vertices = new O.Float32Array(4 * e.length),
        this.uvs = new O.Float32Array(4 * e.length),
        this.colors = new O.Float32Array(2 * e.length),
        this.indices = new O.Uint16Array(2 * e.length),
        this.refresh()
    }
    ,
    O.Rope.prototype = Object.create(O.Strip.prototype),
    O.Rope.prototype.constructor = O.Rope,
    O.Rope.prototype.refresh = function() {
        var t = this.points;
        if (!(t.length < 1)) {
            var e = this.uvs
              , i = (t[0],
            this.indices)
              , s = this.colors;
            this.count -= .2,
            e[0] = 0,
            e[1] = 0,
            e[2] = 0,
            e[3] = 1,
            s[0] = 1,
            s[1] = 1,
            i[0] = 0,
            i[1] = 1;
            for (var n, r, o = t.length, a = 1; a < o; a++)
                t[a],
                r = a / (o - 1),
                e[n = 4 * a] = r,
                e[n + 1] = 0,
                e[n + 2] = r,
                e[n + 3] = 1,
                s[n = 2 * a] = 1,
                s[n + 1] = 1,
                i[n = 2 * a] = n,
                i[n + 1] = n + 1
        }
    }
    ,
    O.Rope.prototype.updateTransform = function() {
        var t = this.points;
        if (!(t.length < 1)) {
            var e, i = t[0], s = {
                x: 0,
                y: 0
            };
            this.count -= .2;
            for (var n, r, o, a, h = this.vertices, l = t.length, c = 0; c < l; c++)
                n = t[c],
                r = 4 * c,
                e = c < t.length - 1 ? t[c + 1] : n,
                s.y = -(e.x - i.x),
                s.x = e.y - i.y,
                1 < 10 * (1 - c / (l - 1)) && 1,
                o = Math.sqrt(s.x * s.x + s.y * s.y),
                a = this.texture.height / 2,
                s.x /= o,
                s.y /= o,
                s.x *= a,
                s.y *= a,
                h[r] = n.x + s.x,
                h[r + 1] = n.y + s.y,
                h[r + 2] = n.x - s.x,
                h[r + 3] = n.y - s.y,
                i = n;
            O.DisplayObjectContainer.prototype.updateTransform.call(this)
        }
    }
    ,
    O.Rope.prototype.setTexture = function(t) {
        this.texture = t
    }
    ,
    O.TilingSprite = function(t, e, i) {
        O.Sprite.call(this, t),
        this._width = e || 128,
        this._height = i || 128,
        this.tileScale = new O.Point(1,1),
        this.tileScaleOffset = new O.Point(1,1),
        this.tilePosition = new O.Point,
        this.renderable = !0,
        this.tint = 16777215,
        this.textureDebug = !1,
        this.blendMode = O.blendModes.NORMAL,
        this.canvasBuffer = null,
        this.tilingTexture = null,
        this.tilePattern = null,
        this.refreshTexture = !0,
        this.frameWidth = 0,
        this.frameHeight = 0
    }
    ,
    O.TilingSprite.prototype = Object.create(O.Sprite.prototype),
    O.TilingSprite.prototype.constructor = O.TilingSprite,
    O.TilingSprite.prototype.setTexture = function(t) {
        this.texture !== t && (this.texture = t,
        this.refreshTexture = !0,
        this.cachedTint = 16777215)
    }
    ,
    O.TilingSprite.prototype._renderWebGL = function(t) {
        if (this.visible && this.renderable && 0 !== this.alpha) {
            if (this._mask && (t.spriteBatch.stop(),
            t.maskManager.pushMask(this.mask, t),
            t.spriteBatch.start()),
            this._filters && (t.spriteBatch.flush(),
            t.filterManager.pushFilter(this._filterBlock)),
            this.refreshTexture) {
                if (this.generateTilingTexture(!0, t),
                !this.tilingTexture)
                    return;
                this.tilingTexture.needsUpdate && (t.renderer.updateTexture(this.tilingTexture.baseTexture),
                this.tilingTexture.needsUpdate = !1)
            }
            t.spriteBatch.renderTilingSprite(this);
            for (var e = 0; e < this.children.length; e++)
                this.children[e]._renderWebGL(t);
            t.spriteBatch.stop(),
            this._filters && t.filterManager.popFilter(),
            this._mask && t.maskManager.popMask(this._mask, t),
            t.spriteBatch.start()
        }
    }
    ,
    O.TilingSprite.prototype._renderCanvas = function(t) {
        if (this.visible && this.renderable && 0 !== this.alpha) {
            var e = t.context;
            this._mask && t.maskManager.pushMask(this._mask, t),
            e.globalAlpha = this.worldAlpha;
            var i = this.worldTransform
              , s = t.resolution
              , n = i.tx * s + t.shakeX
              , r = i.ty * s + t.shakeY;
            if (e.setTransform(i.a * s, i.b * s, i.c * s, i.d * s, n, r),
            this.refreshTexture) {
                if (this.generateTilingTexture(!1, t),
                !this.tilingTexture)
                    return;
                this.tilePattern = e.createPattern(this.tilingTexture.baseTexture.source, "repeat")
            }
            var o = t.currentBlendMode;
            this.blendMode !== t.currentBlendMode && (t.currentBlendMode = this.blendMode,
            e.globalCompositeOperation = O.blendModesCanvas[t.currentBlendMode]);
            var a = this.tilePosition
              , h = this.tileScale;
            a.x %= this.tilingTexture.baseTexture.width,
            a.y %= this.tilingTexture.baseTexture.height,
            e.scale(h.x, h.y),
            e.translate(a.x + this.anchor.x * -this._width, a.y + this.anchor.y * -this._height),
            e.fillStyle = this.tilePattern;
            n = -a.x,
            r = -a.y;
            var l = this._width / h.x
              , c = this._height / h.y;
            t.roundPixels && (n |= 0,
            r |= 0,
            l |= 0,
            c |= 0),
            e.fillRect(n, r, l, c),
            e.scale(1 / h.x, 1 / h.y),
            e.translate(-a.x + this.anchor.x * this._width, -a.y + this.anchor.y * this._height),
            this._mask && t.maskManager.popMask(t);
            for (var d = 0; d < this.children.length; d++)
                this.children[d]._renderCanvas(t);
            o !== this.blendMode && (t.currentBlendMode = o,
            e.globalCompositeOperation = O.blendModesCanvas[o])
        }
    }
    ,
    O.TilingSprite.prototype.onTextureUpdate = function() {}
    ,
    O.TilingSprite.prototype.generateTilingTexture = function(t, e) {
        if (this.texture.baseTexture.hasLoaded) {
            var i = this.texture
              , s = i.frame
              , n = this._frame.sourceSizeW || this._frame.width
              , r = this._frame.sourceSizeH || this._frame.height
              , o = 0
              , a = 0;
            this._frame.trimmed && (o = this._frame.spriteSourceSizeX,
            a = this._frame.spriteSourceSizeY),
            t && (n = O.getNextPowerOfTwo(n),
            r = O.getNextPowerOfTwo(r)),
            this.canvasBuffer ? (this.canvasBuffer.resize(n, r),
            this.tilingTexture.baseTexture.width = n,
            this.tilingTexture.baseTexture.height = r) : (this.canvasBuffer = new O.CanvasBuffer(n,r),
            this.tilingTexture = O.Texture.fromCanvas(this.canvasBuffer.canvas),
            this.tilingTexture.isTiling = !0),
            this.tilingTexture.needsUpdate = !0,
            this.textureDebug && (this.canvasBuffer.context.strokeStyle = "#00ff00",
            this.canvasBuffer.context.strokeRect(0, 0, n, r));
            var h = i.crop.width
              , l = i.crop.height;
            h === n && l === r || (h = n,
            l = r),
            this.canvasBuffer.context.drawImage(i.baseTexture.source, i.crop.x, i.crop.y, i.crop.width, i.crop.height, o, a, h, l),
            this.tileScaleOffset.x = s.width / n,
            this.tileScaleOffset.y = s.height / r,
            this.refreshTexture = !1,
            this.tilingTexture.baseTexture._powerOf2 = !0
        }
    }
    ,
    O.TilingSprite.prototype.getBounds = function() {
        var t = this._width
          , e = this._height
          , i = t * (1 - this.anchor.x)
          , s = t * -this.anchor.x
          , n = e * (1 - this.anchor.y)
          , r = e * -this.anchor.y
          , o = this.worldTransform
          , a = o.a
          , h = o.b
          , l = o.c
          , c = o.d
          , d = o.tx
          , u = o.ty
          , p = a * s + l * r + d
          , g = c * r + h * s + u
          , f = a * i + l * r + d
          , m = c * r + h * i + u
          , y = a * i + l * n + d
          , v = c * n + h * i + u
          , _ = a * s + l * n + d
          , b = c * n + h * s + u
          , w = -1 / 0
          , x = -1 / 0
          , S = 1 / 0
          , T = 1 / 0;
        S = _ < (S = y < (S = f < (S = p < S ? p : S) ? f : S) ? y : S) ? _ : S,
        T = b < (T = v < (T = m < (T = g < T ? g : T) ? m : T) ? v : T) ? b : T,
        w = (w = (w = (w = w < p ? p : w) < f ? f : w) < y ? y : w) < _ ? _ : w,
        x = (x = (x = (x = x < g ? g : x) < m ? m : x) < v ? v : x) < b ? b : x;
        var A = this._bounds;
        return A.x = S,
        A.width = w - S,
        A.y = T,
        A.height = x - T,
        this._currentBounds = A
    }
    ,
    O.TilingSprite.prototype.destroy = function() {
        O.Sprite.prototype.destroy.call(this),
        this.canvasBuffer && (this.canvasBuffer.destroy(),
        this.canvasBuffer = null),
        this.tileScale = null,
        this.tileScaleOffset = null,
        this.tilePosition = null,
        this.tilingTexture && (this.tilingTexture.destroy(!0),
        this.tilingTexture = null)
    }
    ,
    Object.defineProperty(O.TilingSprite.prototype, "width", {
        get: function() {
            return this._width
        },
        set: function(t) {
            this._width = t
        }
    }),
    Object.defineProperty(O.TilingSprite.prototype, "height", {
        get: function() {
            return this._height
        },
        set: function(t) {
            this._height = t
        }
    }),
    "undefined" != typeof exports ? ("undefined" != typeof module && module.exports && (exports = module.exports = O),
    exports.PIXI = O) : "undefined" != typeof define && define.amd ? define("PIXI", t.PIXI = O) : t.PIXI = O,
    O
}
.call(this),
function() {
    function s(t, e) {
        this._scaleFactor = t,
        this._deltaMode = e,
        this.originalEvent = null
    }
    var r, t = this, H = H || {
        VERSION: "2.6.15",
        GAMES: [],
        AUTO: 0,
        CANVAS: 1,
        WEBGL: 2,
        HEADLESS: 3,
        NONE: 0,
        LEFT: 1,
        RIGHT: 2,
        UP: 3,
        DOWN: 4,
        SPRITE: 0,
        BUTTON: 1,
        IMAGE: 2,
        GRAPHICS: 3,
        TEXT: 4,
        TILESPRITE: 5,
        BITMAPTEXT: 6,
        GROUP: 7,
        RENDERTEXTURE: 8,
        TILEMAP: 9,
        TILEMAPLAYER: 10,
        EMITTER: 11,
        POLYGON: 12,
        BITMAPDATA: 13,
        CANVAS_FILTER: 14,
        WEBGL_FILTER: 15,
        ELLIPSE: 16,
        SPRITEBATCH: 17,
        RETROFONT: 18,
        POINTER: 19,
        ROPE: 20,
        CIRCLE: 21,
        RECTANGLE: 22,
        LINE: 23,
        MATRIX: 24,
        POINT: 25,
        ROUNDEDRECTANGLE: 26,
        CREATURE: 27,
        VIDEO: 28,
        PENDING_ATLAS: -1,
        HORIZONTAL: 0,
        VERTICAL: 1,
        LANDSCAPE: 0,
        PORTRAIT: 1,
        ANGLE_UP: 270,
        ANGLE_DOWN: 90,
        ANGLE_LEFT: 180,
        ANGLE_RIGHT: 0,
        ANGLE_NORTH_EAST: 315,
        ANGLE_NORTH_WEST: 225,
        ANGLE_SOUTH_EAST: 45,
        ANGLE_SOUTH_WEST: 135,
        TOP_LEFT: 0,
        TOP_CENTER: 1,
        TOP_RIGHT: 2,
        LEFT_TOP: 3,
        LEFT_CENTER: 4,
        LEFT_BOTTOM: 5,
        CENTER: 6,
        RIGHT_TOP: 7,
        RIGHT_CENTER: 8,
        RIGHT_BOTTOM: 9,
        BOTTOM_LEFT: 10,
        BOTTOM_CENTER: 11,
        BOTTOM_RIGHT: 12,
        blendModes: {
            NORMAL: 0,
            ADD: 1,
            MULTIPLY: 2,
            SCREEN: 3,
            OVERLAY: 4,
            DARKEN: 5,
            LIGHTEN: 6,
            COLOR_DODGE: 7,
            COLOR_BURN: 8,
            HARD_LIGHT: 9,
            SOFT_LIGHT: 10,
            DIFFERENCE: 11,
            EXCLUSION: 12,
            HUE: 13,
            SATURATION: 14,
            COLOR: 15,
            LUMINOSITY: 16
        },
        scaleModes: {
            DEFAULT: 0,
            LINEAR: 0,
            NEAREST: 1
        },
        PIXI: PIXI || {}
    };
    if (Math.trunc || (Math.trunc = function(t) {
        return t < 0 ? Math.ceil(t) : Math.floor(t)
    }
    ),
    Function.prototype.bind || (Function.prototype.bind = (r = Array.prototype.slice,
    function(e) {
        function i() {
            var t = n.concat(r.call(arguments));
            s.apply(this instanceof i ? this : e, t)
        }
        var s = this
          , n = r.call(arguments, 1);
        if ("function" != typeof s)
            throw new TypeError;
        return i.prototype = function t(e) {
            if (e && (t.prototype = e),
            !(this instanceof t))
                return new t
        }(s.prototype),
        i
    }
    )),
    Array.isArray || (Array.isArray = function(t) {
        return "[object Array]" === Object.prototype.toString.call(t)
    }
    ),
    Array.prototype.forEach || (Array.prototype.forEach = function(t) {
        "use strict";
        if (null == this)
            throw new TypeError;
        var e = Object(this)
          , i = e.length >>> 0;
        if ("function" != typeof t)
            throw new TypeError;
        for (var s = 2 <= arguments.length ? arguments[1] : void 0, n = 0; n < i; n++)
            n in e && t.call(s, e[n], n, e)
    }
    ),
    "function" != typeof window.Uint32Array && "object" != typeof window.Uint32Array) {
        var e = function(t) {
            var e = new Array;
            window[t] = function(t) {
                if ("number" == typeof t) {
                    Array.call(this, t),
                    this.length = t;
                    for (var e = 0; e < this.length; e++)
                        this[e] = 0
                } else {
                    Array.call(this, t.length),
                    this.length = t.length;
                    for (e = 0; e < this.length; e++)
                        this[e] = t[e]
                }
            }
            ,
            window[t].prototype = e,
            window[t].constructor = window[t]
        };
        e("Uint32Array"),
        e("Int16Array")
    }
    for (var i in window.console || (window.console = {},
    window.console.log = window.console.assert = function() {}
    ,
    window.console.warn = window.console.assert = function() {}
    ),
    /firefox/i.test(navigator.userAgent) && (window.oldGetComputedStyle = window.getComputedStyle,
    window.getComputedStyle = function(t, e) {
        var i = window.oldGetComputedStyle(t, e);
        return null === i ? {
            getPropertyValue: function() {}
        } : i
    }
    ),
    H.Utils = {
        reverseString: function(t) {
            return t.split("").reverse().join("")
        },
        getProperty: function(t, e) {
            for (var i = e.split("."), s = i.pop(), n = i.length, r = 1, o = i[0]; r < n && (t = t[o]); )
                o = i[r],
                r++;
            return t ? t[s] : null
        },
        setProperty: function(t, e, i) {
            for (var s = e.split("."), n = s.pop(), r = s.length, o = 1, a = s[0]; o < r && (t = t[a]); )
                a = s[o],
                o++;
            return t && (t[n] = i),
            t
        },
        chanceRoll: function(t) {
            return void 0 === t && (t = 50),
            0 < t && 100 * Math.random() <= t
        },
        randomChoice: function(t, e) {
            return Math.random() < .5 ? t : e
        },
        parseDimension: function(t, e) {
            var i = 0;
            return "string" == typeof t ? "%" === t.substr(-1) ? (i = parseInt(t, 10) / 100,
            0 === e ? window.innerWidth * i : window.innerHeight * i) : parseInt(t, 10) : t
        },
        pad: function(t, e, i, s) {
            if (void 0 === e)
                e = 0;
            if (void 0 === i)
                i = " ";
            if (void 0 === s)
                s = 3;
            var n = 0;
            if (e + 1 >= (t = t.toString()).length)
                switch (s) {
                case 1:
                    t = new Array(e + 1 - t.length).join(i) + t;
                    break;
                case 3:
                    var r = Math.ceil((n = e - t.length) / 2);
                    t = new Array(n - r + 1).join(i) + t + new Array(r + 1).join(i);
                    break;
                default:
                    t += new Array(e + 1 - t.length).join(i)
                }
            return t
        },
        isPlainObject: function(t) {
            if ("object" != typeof t || t.nodeType || t === t.window)
                return !1;
            try {
                if (t.constructor && !{}.hasOwnProperty.call(t.constructor.prototype, "isPrototypeOf"))
                    return !1
            } catch (t) {
                return !1
            }
            return !0
        },
        extend: function() {
            var t, e, i, s, n, r, o = arguments[0] || {}, a = 1, h = arguments.length, l = !1;
            for ("boolean" == typeof o && (l = o,
            o = arguments[1] || {},
            a = 2),
            h === a && (o = this,
            --a); a < h; a++)
                if (null != (t = arguments[a]))
                    for (e in t)
                        i = o[e],
                        o !== (s = t[e]) && (l && s && (H.Utils.isPlainObject(s) || (n = Array.isArray(s))) ? (r = n ? (n = !1,
                        i && Array.isArray(i) ? i : []) : i && H.Utils.isPlainObject(i) ? i : {},
                        o[e] = H.Utils.extend(l, r, s)) : void 0 !== s && (o[e] = s));
            return o
        },
        mixinPrototype: function(t, e, i) {
            void 0 === i && (i = !1);
            for (var s = Object.keys(e), n = 0; n < s.length; n++) {
                var r = s[n]
                  , o = e[r];
                !i && r in t || (!o || "function" != typeof o.get && "function" != typeof o.set ? t[r] = o : "function" == typeof o.clone ? t[r] = o.clone() : Object.defineProperty(t, r, o))
            }
        },
        mixin: function(t, e) {
            if (!t || "object" != typeof t)
                return e;
            for (var i in t) {
                var s = t[i];
                if (!s.childNodes && !s.cloneNode) {
                    var n = typeof t[i];
                    t[i] && "object" === n ? typeof e[i] === n ? e[i] = H.Utils.mixin(t[i], e[i]) : e[i] = H.Utils.mixin(t[i], new s.constructor) : e[i] = t[i]
                }
            }
            return e
        }
    },
    H.Circle = function(t, e, i) {
        t = t || 0,
        e = e || 0,
        i = i || 0,
        this.x = t,
        this.y = e,
        this._diameter = i,
        (this._radius = 0) < i && (this._radius = .5 * i),
        this.type = H.CIRCLE
    }
    ,
    H.Circle.prototype = {
        circumference: function() {
            return Math.PI * this._radius * 2
        },
        random: function(t) {
            void 0 === t && (t = new H.Point);
            var e = 2 * Math.PI * Math.random()
              , i = Math.random() + Math.random()
              , s = 1 < i ? 2 - i : i
              , n = s * Math.cos(e)
              , r = s * Math.sin(e);
            return t.x = this.x + n * this.radius,
            t.y = this.y + r * this.radius,
            t
        },
        getBounds: function() {
            return new H.Rectangle(this.x - this.radius,this.y - this.radius,this.diameter,this.diameter)
        },
        setTo: function(t, e, i) {
            return this.x = t,
            this.y = e,
            this._diameter = i,
            this._radius = .5 * i,
            this
        },
        copyFrom: function(t) {
            return this.setTo(t.x, t.y, t.diameter)
        },
        copyTo: function(t) {
            return t.x = this.x,
            t.y = this.y,
            t.diameter = this._diameter,
            t
        },
        distance: function(t, e) {
            var i = H.Math.distance(this.x, this.y, t.x, t.y);
            return e ? Math.round(i) : i
        },
        clone: function(t) {
            return null == t ? t = new H.Circle(this.x,this.y,this.diameter) : t.setTo(this.x, this.y, this.diameter),
            t
        },
        contains: function(t, e) {
            return H.Circle.contains(this, t, e)
        },
        circumferencePoint: function(t, e, i) {
            return H.Circle.circumferencePoint(this, t, e, i)
        },
        offset: function(t, e) {
            return this.x += t,
            this.y += e,
            this
        },
        offsetPoint: function(t) {
            return this.offset(t.x, t.y)
        },
        toString: function() {
            return "[{Phaser.Circle (x=" + this.x + " y=" + this.y + " diameter=" + this.diameter + " radius=" + this.radius + ")}]"
        }
    },
    H.Circle.prototype.constructor = H.Circle,
    Object.defineProperty(H.Circle.prototype, "diameter", {
        get: function() {
            return this._diameter
        },
        set: function(t) {
            0 < t && (this._diameter = t,
            this._radius = .5 * t)
        }
    }),
    Object.defineProperty(H.Circle.prototype, "radius", {
        get: function() {
            return this._radius
        },
        set: function(t) {
            0 < t && (this._radius = t,
            this._diameter = 2 * t)
        }
    }),
    Object.defineProperty(H.Circle.prototype, "left", {
        get: function() {
            return this.x - this._radius
        },
        set: function(t) {
            t > this.x ? (this._radius = 0,
            this._diameter = 0) : this.radius = this.x - t
        }
    }),
    Object.defineProperty(H.Circle.prototype, "right", {
        get: function() {
            return this.x + this._radius
        },
        set: function(t) {
            t < this.x ? (this._radius = 0,
            this._diameter = 0) : this.radius = t - this.x
        }
    }),
    Object.defineProperty(H.Circle.prototype, "top", {
        get: function() {
            return this.y - this._radius
        },
        set: function(t) {
            t > this.y ? (this._radius = 0,
            this._diameter = 0) : this.radius = this.y - t
        }
    }),
    Object.defineProperty(H.Circle.prototype, "bottom", {
        get: function() {
            return this.y + this._radius
        },
        set: function(t) {
            t < this.y ? (this._radius = 0,
            this._diameter = 0) : this.radius = t - this.y
        }
    }),
    Object.defineProperty(H.Circle.prototype, "area", {
        get: function() {
            return 0 < this._radius ? Math.PI * this._radius * this._radius : 0
        }
    }),
    Object.defineProperty(H.Circle.prototype, "empty", {
        get: function() {
            return 0 === this._diameter
        },
        set: function(t) {
            !0 === t && this.setTo(0, 0, 0)
        }
    }),
    H.Circle.contains = function(t, e, i) {
        return 0 < t.radius && e >= t.left && e <= t.right && i >= t.top && i <= t.bottom && (t.x - e) * (t.x - e) + (t.y - i) * (t.y - i) <= t.radius * t.radius
    }
    ,
    H.Circle.equals = function(t, e) {
        return t.x === e.x && t.y === e.y && t.diameter === e.diameter
    }
    ,
    H.Circle.intersects = function(t, e) {
        return H.Math.distance(t.x, t.y, e.x, e.y) <= t.radius + e.radius
    }
    ,
    H.Circle.circumferencePoint = function(t, e, i, s) {
        return void 0 === i && (i = !1),
        void 0 === s && (s = new H.Point),
        !0 === i && (e = H.Math.degToRad(e)),
        s.x = t.x + t.radius * Math.cos(e),
        s.y = t.y + t.radius * Math.sin(e),
        s
    }
    ,
    H.Circle.intersectsRectangle = function(t, e) {
        var i = Math.abs(t.x - e.x - e.halfWidth);
        if (i > e.halfWidth + t.radius)
            return !1;
        var s = Math.abs(t.y - e.y - e.halfHeight);
        if (s > e.halfHeight + t.radius)
            return !1;
        if (i <= e.halfWidth || s <= e.halfHeight)
            return !0;
        var n = i - e.halfWidth
          , r = s - e.halfHeight;
        return n * n + r * r <= t.radius * t.radius
    }
    ,
    PIXI.Circle = H.Circle,
    H.Ellipse = function(t, e, i, s) {
        t = t || 0,
        e = e || 0,
        i = i || 0,
        s = s || 0,
        this.x = t,
        this.y = e,
        this.width = i,
        this.height = s,
        this.type = H.ELLIPSE
    }
    ,
    H.Ellipse.prototype = {
        setTo: function(t, e, i, s) {
            return this.x = t,
            this.y = e,
            this.width = i,
            this.height = s,
            this
        },
        getBounds: function() {
            return new H.Rectangle(this.x - this.width,this.y - this.height,this.width,this.height)
        },
        copyFrom: function(t) {
            return this.setTo(t.x, t.y, t.width, t.height)
        },
        copyTo: function(t) {
            return t.x = this.x,
            t.y = this.y,
            t.width = this.width,
            t.height = this.height,
            t
        },
        clone: function(t) {
            return null == t ? t = new H.Ellipse(this.x,this.y,this.width,this.height) : t.setTo(this.x, this.y, this.width, this.height),
            t
        },
        contains: function(t, e) {
            return H.Ellipse.contains(this, t, e)
        },
        random: function(t) {
            void 0 === t && (t = new H.Point);
            var e = Math.random() * Math.PI * 2
              , i = Math.random();
            return t.x = Math.sqrt(i) * Math.cos(e),
            t.y = Math.sqrt(i) * Math.sin(e),
            t.x = this.x + t.x * this.width / 2,
            t.y = this.y + t.y * this.height / 2,
            t
        },
        toString: function() {
            return "[{Phaser.Ellipse (x=" + this.x + " y=" + this.y + " width=" + this.width + " height=" + this.height + ")}]"
        }
    },
    H.Ellipse.prototype.constructor = H.Ellipse,
    Object.defineProperty(H.Ellipse.prototype, "left", {
        get: function() {
            return this.x
        },
        set: function(t) {
            this.x = t
        }
    }),
    Object.defineProperty(H.Ellipse.prototype, "right", {
        get: function() {
            return this.x + this.width
        },
        set: function(t) {
            t < this.x ? this.width = 0 : this.width = t - this.x
        }
    }),
    Object.defineProperty(H.Ellipse.prototype, "top", {
        get: function() {
            return this.y
        },
        set: function(t) {
            this.y = t
        }
    }),
    Object.defineProperty(H.Ellipse.prototype, "bottom", {
        get: function() {
            return this.y + this.height
        },
        set: function(t) {
            t < this.y ? this.height = 0 : this.height = t - this.y
        }
    }),
    Object.defineProperty(H.Ellipse.prototype, "empty", {
        get: function() {
            return 0 === this.width || 0 === this.height
        },
        set: function(t) {
            !0 === t && this.setTo(0, 0, 0, 0)
        }
    }),
    H.Ellipse.contains = function(t, e, i) {
        if (t.width <= 0 || t.height <= 0)
            return !1;
        var s = (e - t.x) / t.width - .5
          , n = (i - t.y) / t.height - .5;
        return (s *= s) + (n *= n) < .25
    }
    ,
    PIXI.Ellipse = H.Ellipse,
    H.Line = function(t, e, i, s) {
        t = t || 0,
        e = e || 0,
        i = i || 0,
        s = s || 0,
        this.start = new H.Point(t,e),
        this.end = new H.Point(i,s),
        this.type = H.LINE
    }
    ,
    H.Line.prototype = {
        setTo: function(t, e, i, s) {
            return this.start.setTo(t, e),
            this.end.setTo(i, s),
            this
        },
        fromSprite: function(t, e, i) {
            return void 0 === i && (i = !1),
            i ? this.setTo(t.center.x, t.center.y, e.center.x, e.center.y) : this.setTo(t.x, t.y, e.x, e.y)
        },
        fromAngle: function(t, e, i, s) {
            return this.start.setTo(t, e),
            this.end.setTo(t + Math.cos(i) * s, e + Math.sin(i) * s),
            this
        },
        rotate: function(t, e) {
            var i = (this.start.x + this.end.x) / 2
              , s = (this.start.y + this.end.y) / 2;
            return this.start.rotate(i, s, t, e),
            this.end.rotate(i, s, t, e),
            this
        },
        rotateAround: function(t, e, i, s) {
            return this.start.rotate(t, e, i, s),
            this.end.rotate(t, e, i, s),
            this
        },
        intersects: function(t, e, i) {
            return H.Line.intersectsPoints(this.start, this.end, t.start, t.end, e, i)
        },
        reflect: function(t) {
            return H.Line.reflect(this, t)
        },
        midPoint: function(t) {
            return void 0 === t && (t = new H.Point),
            t.x = (this.start.x + this.end.x) / 2,
            t.y = (this.start.y + this.end.y) / 2,
            t
        },
        centerOn: function(t, e) {
            var i = t - (this.start.x + this.end.x) / 2
              , s = e - (this.start.y + this.end.y) / 2;
            this.start.add(i, s),
            this.end.add(i, s)
        },
        pointOnLine: function(t, e) {
            return (t - this.start.x) * (this.end.y - this.start.y) == (this.end.x - this.start.x) * (e - this.start.y)
        },
        pointOnSegment: function(t, e) {
            var i = Math.min(this.start.x, this.end.x)
              , s = Math.max(this.start.x, this.end.x)
              , n = Math.min(this.start.y, this.end.y)
              , r = Math.max(this.start.y, this.end.y);
            return this.pointOnLine(t, e) && i <= t && t <= s && n <= e && e <= r
        },
        random: function(t) {
            void 0 === t && (t = new H.Point);
            var e = Math.random();
            return t.x = this.start.x + e * (this.end.x - this.start.x),
            t.y = this.start.y + e * (this.end.y - this.start.y),
            t
        },
        coordinatesOnLine: function(t, e) {
            void 0 === t && (t = 1),
            void 0 === e && (e = []);
            var i = Math.round(this.start.x)
              , s = Math.round(this.start.y)
              , n = Math.round(this.end.x)
              , r = Math.round(this.end.y)
              , o = Math.abs(n - i)
              , a = Math.abs(r - s)
              , h = i < n ? 1 : -1
              , l = s < r ? 1 : -1
              , c = o - a;
            e.push([i, s]);
            for (var d = 1; i !== n || s !== r; ) {
                var u = c << 1;
                -a < u && (c -= a,
                i += h),
                u < o && (c += o,
                s += l),
                d % t == 0 && e.push([i, s]),
                d++
            }
            return e
        },
        clone: function(t) {
            return null == t ? t = new H.Line(this.start.x,this.start.y,this.end.x,this.end.y) : t.setTo(this.start.x, this.start.y, this.end.x, this.end.y),
            t
        }
    },
    Object.defineProperty(H.Line.prototype, "length", {
        get: function() {
            return Math.sqrt((this.end.x - this.start.x) * (this.end.x - this.start.x) + (this.end.y - this.start.y) * (this.end.y - this.start.y))
        }
    }),
    Object.defineProperty(H.Line.prototype, "angle", {
        get: function() {
            return Math.atan2(this.end.y - this.start.y, this.end.x - this.start.x)
        }
    }),
    Object.defineProperty(H.Line.prototype, "slope", {
        get: function() {
            return (this.end.y - this.start.y) / (this.end.x - this.start.x)
        }
    }),
    Object.defineProperty(H.Line.prototype, "perpSlope", {
        get: function() {
            return -(this.end.x - this.start.x) / (this.end.y - this.start.y)
        }
    }),
    Object.defineProperty(H.Line.prototype, "x", {
        get: function() {
            return Math.min(this.start.x, this.end.x)
        }
    }),
    Object.defineProperty(H.Line.prototype, "y", {
        get: function() {
            return Math.min(this.start.y, this.end.y)
        }
    }),
    Object.defineProperty(H.Line.prototype, "left", {
        get: function() {
            return Math.min(this.start.x, this.end.x)
        }
    }),
    Object.defineProperty(H.Line.prototype, "right", {
        get: function() {
            return Math.max(this.start.x, this.end.x)
        }
    }),
    Object.defineProperty(H.Line.prototype, "top", {
        get: function() {
            return Math.min(this.start.y, this.end.y)
        }
    }),
    Object.defineProperty(H.Line.prototype, "bottom", {
        get: function() {
            return Math.max(this.start.y, this.end.y)
        }
    }),
    Object.defineProperty(H.Line.prototype, "width", {
        get: function() {
            return Math.abs(this.start.x - this.end.x)
        }
    }),
    Object.defineProperty(H.Line.prototype, "height", {
        get: function() {
            return Math.abs(this.start.y - this.end.y)
        }
    }),
    Object.defineProperty(H.Line.prototype, "normalX", {
        get: function() {
            return Math.cos(this.angle - 1.5707963267948966)
        }
    }),
    Object.defineProperty(H.Line.prototype, "normalY", {
        get: function() {
            return Math.sin(this.angle - 1.5707963267948966)
        }
    }),
    Object.defineProperty(H.Line.prototype, "normalAngle", {
        get: function() {
            return H.Math.wrap(this.angle - 1.5707963267948966, -Math.PI, Math.PI)
        }
    }),
    H.Line.intersectsPoints = function(t, e, i, s, n, r) {
        void 0 === n && (n = !0),
        void 0 === r && (r = new H.Point);
        var o = e.y - t.y
          , a = s.y - i.y
          , h = t.x - e.x
          , l = i.x - s.x
          , c = e.x * t.y - t.x * e.y
          , d = s.x * i.y - i.x * s.y
          , u = o * l - a * h;
        if (0 === u)
            return null;
        if (r.x = (h * d - l * c) / u,
        r.y = (a * c - o * d) / u,
        n) {
            var p = (s.y - i.y) * (e.x - t.x) - (s.x - i.x) * (e.y - t.y)
              , g = ((s.x - i.x) * (t.y - i.y) - (s.y - i.y) * (t.x - i.x)) / p
              , f = ((e.x - t.x) * (t.y - i.y) - (e.y - t.y) * (t.x - i.x)) / p;
            return 0 <= g && g <= 1 && 0 <= f && f <= 1 ? r : null
        }
        return r
    }
    ,
    H.Line.intersects = function(t, e, i, s) {
        return H.Line.intersectsPoints(t.start, t.end, e.start, e.end, i, s)
    }
    ,
    H.Line.intersectsRectangle = function(t, e) {
        if (!H.Rectangle.intersects(t, e))
            return !1;
        var i = t.start.x
          , s = t.start.y
          , n = t.end.x
          , r = t.end.y
          , o = e.x
          , a = e.y
          , h = e.right
          , l = e.bottom
          , c = 0;
        if (o <= i && i <= h && a <= s && s <= l || o <= n && n <= h && a <= r && r <= l)
            return !0;
        if (i < o && o <= n) {
            if ((c = s + (r - s) * (o - i) / (n - i)) > a && c <= l)
                return !0
        } else if (h < i && n <= h && (c = s + (r - s) * (h - i) / (n - i)) >= a && c <= l)
            return !0;
        if (s < a && a <= r) {
            if ((c = i + (n - i) * (a - s) / (r - s)) >= o && c <= h)
                return !0
        } else if (l < s && r <= l && (c = i + (n - i) * (l - s) / (r - s)) >= o && c <= h)
            return !0;
        return !1
    }
    ,
    H.Line.reflect = function(t, e) {
        return 2 * e.normalAngle - 3.141592653589793 - t.angle
    }
    ,
    H.Matrix = function(t, e, i, s, n, r) {
        null != t || (t = 1),
        null != e || (e = 0),
        null != i || (i = 0),
        null != s || (s = 1),
        null != n || (n = 0),
        null != r || (r = 0),
        this.a = t,
        this.b = e,
        this.c = i,
        this.d = s,
        this.tx = n,
        this.ty = r,
        this.type = H.MATRIX
    }
    ,
    H.Matrix.prototype = {
        fromArray: function(t) {
            return this.setTo(t[0], t[1], t[3], t[4], t[2], t[5])
        },
        setTo: function(t, e, i, s, n, r) {
            return this.a = t,
            this.b = e,
            this.c = i,
            this.d = s,
            this.tx = n,
            this.ty = r,
            this
        },
        clone: function(t) {
            return null == t ? t = new H.Matrix(this.a,this.b,this.c,this.d,this.tx,this.ty) : (t.a = this.a,
            t.b = this.b,
            t.c = this.c,
            t.d = this.d,
            t.tx = this.tx,
            t.ty = this.ty),
            t
        },
        copyTo: function(t) {
            return t.copyFrom(this),
            t
        },
        copyFrom: function(t) {
            return this.a = t.a,
            this.b = t.b,
            this.c = t.c,
            this.d = t.d,
            this.tx = t.tx,
            this.ty = t.ty,
            this
        },
        toArray: function(t, e) {
            return void 0 === e && (e = new PIXI.Float32Array(9)),
            t ? (e[0] = this.a,
            e[1] = this.b,
            e[2] = 0,
            e[3] = this.c,
            e[4] = this.d,
            e[5] = 0,
            e[6] = this.tx,
            e[7] = this.ty) : (e[0] = this.a,
            e[1] = this.c,
            e[2] = this.tx,
            e[3] = this.b,
            e[4] = this.d,
            e[5] = this.ty,
            e[6] = 0,
            e[7] = 0),
            e[8] = 1,
            e
        },
        apply: function(t, e) {
            return void 0 === e && (e = new H.Point),
            e.x = this.a * t.x + this.c * t.y + this.tx,
            e.y = this.b * t.x + this.d * t.y + this.ty,
            e
        },
        applyInverse: function(t, e) {
            void 0 === e && (e = new H.Point);
            var i = 1 / (this.a * this.d + this.c * -this.b)
              , s = t.x
              , n = t.y;
            return e.x = this.d * i * s + -this.c * i * n + (this.ty * this.c - this.tx * this.d) * i,
            e.y = this.a * i * n + -this.b * i * s + (-this.ty * this.a + this.tx * this.b) * i,
            e
        },
        translate: function(t, e) {
            return this.tx += t,
            this.ty += e,
            this
        },
        scale: function(t, e) {
            return this.a *= t,
            this.d *= e,
            this.c *= t,
            this.b *= e,
            this.tx *= t,
            this.ty *= e,
            this
        },
        rotate: function(t) {
            var e = Math.cos(t)
              , i = Math.sin(t)
              , s = this.a
              , n = this.c
              , r = this.tx;
            return this.a = s * e - this.b * i,
            this.b = s * i + this.b * e,
            this.c = n * e - this.d * i,
            this.d = n * i + this.d * e,
            this.tx = r * e - this.ty * i,
            this.ty = r * i + this.ty * e,
            this
        },
        append: function(t) {
            var e = this.a
              , i = this.b
              , s = this.c
              , n = this.d;
            return this.a = t.a * e + t.b * s,
            this.b = t.a * i + t.b * n,
            this.c = t.c * e + t.d * s,
            this.d = t.c * i + t.d * n,
            this.tx = t.tx * e + t.ty * s + this.tx,
            this.ty = t.tx * i + t.ty * n + this.ty,
            this
        },
        identity: function() {
            return this.setTo(1, 0, 0, 1, 0, 0)
        }
    },
    H.identityMatrix = new H.Matrix,
    PIXI.Matrix = H.Matrix,
    PIXI.identityMatrix = H.identityMatrix,
    H.Point = function(t, e) {
        t = t || 0,
        e = e || 0,
        this.x = t,
        this.y = e,
        this.type = H.POINT
    }
    ,
    H.Point.prototype = {
        copyFrom: function(t) {
            return this.setTo(t.x, t.y)
        },
        invert: function() {
            return this.setTo(this.y, this.x)
        },
        setTo: function(t, e) {
            return this.x = t || 0,
            this.y = e || (0 !== e ? this.x : 0),
            this
        },
        set: function(t, e) {
            return this.x = t || 0,
            this.y = e || (0 !== e ? this.x : 0),
            this
        },
        add: function(t, e) {
            return this.x += t,
            this.y += e,
            this
        },
        subtract: function(t, e) {
            return this.x -= t,
            this.y -= e,
            this
        },
        multiply: function(t, e) {
            return this.x *= t,
            this.y *= e,
            this
        },
        divide: function(t, e) {
            return this.x /= t,
            this.y /= e,
            this
        },
        clampX: function(t, e) {
            return this.x = H.Math.clamp(this.x, t, e),
            this
        },
        clampY: function(t, e) {
            return this.y = H.Math.clamp(this.y, t, e),
            this
        },
        clamp: function(t, e) {
            return this.x = H.Math.clamp(this.x, t, e),
            this.y = H.Math.clamp(this.y, t, e),
            this
        },
        clone: function(t) {
            return null == t ? t = new H.Point(this.x,this.y) : t.setTo(this.x, this.y),
            t
        },
        copyTo: function(t) {
            return t.x = this.x,
            t.y = this.y,
            t
        },
        distance: function(t, e) {
            return H.Point.distance(this, t, e)
        },
        equals: function(t) {
            return t.x === this.x && t.y === this.y
        },
        angle: function(t, e) {
            return void 0 === e && (e = !1),
            e ? H.Math.radToDeg(Math.atan2(t.y - this.y, t.x - this.x)) : Math.atan2(t.y - this.y, t.x - this.x)
        },
        rotate: function(t, e, i, s, n) {
            return H.Point.rotate(this, t, e, i, s, n)
        },
        getMagnitude: function() {
            return Math.sqrt(this.x * this.x + this.y * this.y)
        },
        getMagnitudeSq: function() {
            return this.x * this.x + this.y * this.y
        },
        setMagnitude: function(t) {
            return this.normalize().multiply(t, t)
        },
        normalize: function() {
            if (!this.isZero()) {
                var t = this.getMagnitude();
                this.x /= t,
                this.y /= t
            }
            return this
        },
        isZero: function() {
            return 0 === this.x && 0 === this.y
        },
        dot: function(t) {
            return this.x * t.x + this.y * t.y
        },
        cross: function(t) {
            return this.x * t.y - this.y * t.x
        },
        perp: function() {
            return this.setTo(-this.y, this.x)
        },
        rperp: function() {
            return this.setTo(this.y, -this.x)
        },
        normalRightHand: function() {
            return this.setTo(-1 * this.y, this.x)
        },
        floor: function() {
            return this.setTo(Math.floor(this.x), Math.floor(this.y))
        },
        ceil: function() {
            return this.setTo(Math.ceil(this.x), Math.ceil(this.y))
        },
        toString: function() {
            return "[{Point (x=" + this.x + " y=" + this.y + ")}]"
        }
    },
    H.Point.prototype.constructor = H.Point,
    H.Point.add = function(t, e, i) {
        return void 0 === i && (i = new H.Point),
        i.x = t.x + e.x,
        i.y = t.y + e.y,
        i
    }
    ,
    H.Point.subtract = function(t, e, i) {
        return void 0 === i && (i = new H.Point),
        i.x = t.x - e.x,
        i.y = t.y - e.y,
        i
    }
    ,
    H.Point.multiply = function(t, e, i) {
        return void 0 === i && (i = new H.Point),
        i.x = t.x * e.x,
        i.y = t.y * e.y,
        i
    }
    ,
    H.Point.divide = function(t, e, i) {
        return void 0 === i && (i = new H.Point),
        i.x = t.x / e.x,
        i.y = t.y / e.y,
        i
    }
    ,
    H.Point.equals = function(t, e) {
        return t.x === e.x && t.y === e.y
    }
    ,
    H.Point.angle = function(t, e) {
        return Math.atan2(t.y - e.y, t.x - e.x)
    }
    ,
    H.Point.negative = function(t, e) {
        return void 0 === e && (e = new H.Point),
        e.setTo(-t.x, -t.y)
    }
    ,
    H.Point.multiplyAdd = function(t, e, i, s) {
        return void 0 === s && (s = new H.Point),
        s.setTo(t.x + e.x * i, t.y + e.y * i)
    }
    ,
    H.Point.interpolate = function(t, e, i, s) {
        return void 0 === s && (s = new H.Point),
        s.setTo(t.x + (e.x - t.x) * i, t.y + (e.y - t.y) * i)
    }
    ,
    H.Point.perp = function(t, e) {
        return void 0 === e && (e = new H.Point),
        e.setTo(-t.y, t.x)
    }
    ,
    H.Point.rperp = function(t, e) {
        return void 0 === e && (e = new H.Point),
        e.setTo(t.y, -t.x)
    }
    ,
    H.Point.distance = function(t, e, i) {
        var s = H.Math.distance(t.x, t.y, e.x, e.y);
        return i ? Math.round(s) : s
    }
    ,
    H.Point.project = function(t, e, i) {
        void 0 === i && (i = new H.Point);
        var s = t.dot(e) / e.getMagnitudeSq();
        return 0 !== s && i.setTo(s * e.x, s * e.y),
        i
    }
    ,
    H.Point.projectUnit = function(t, e, i) {
        void 0 === i && (i = new H.Point);
        var s = t.dot(e);
        return 0 !== s && i.setTo(s * e.x, s * e.y),
        i
    }
    ,
    H.Point.normalRightHand = function(t, e) {
        return void 0 === e && (e = new H.Point),
        e.setTo(-1 * t.y, t.x)
    }
    ,
    H.Point.normalize = function(t, e) {
        void 0 === e && (e = new H.Point);
        var i = t.getMagnitude();
        return 0 !== i && e.setTo(t.x / i, t.y / i),
        e
    }
    ,
    H.Point.rotate = function(t, e, i, s, n, r) {
        if (n && (s = H.Math.degToRad(s)),
        void 0 === r) {
            t.subtract(e, i);
            var o = Math.sin(s)
              , a = Math.cos(s)
              , h = a * t.x - o * t.y
              , l = o * t.x + a * t.y;
            t.x = h + e,
            t.y = l + i
        } else {
            var c = s + Math.atan2(t.y - i, t.x - e);
            t.x = e + r * Math.cos(c),
            t.y = i + r * Math.sin(c)
        }
        return t
    }
    ,
    H.Point.centroid = function(t, e) {
        if (void 0 === e && (e = new H.Point),
        "[object Array]" !== Object.prototype.toString.call(t))
            throw new Error("Phaser.Point. Parameter 'points' must be an array");
        var i = t.length;
        if (i < 1)
            throw new Error("Phaser.Point. Parameter 'points' array must not be empty");
        if (1 === i)
            return e.copyFrom(t[0]),
            e;
        for (var s = 0; s < i; s++)
            H.Point.add(e, t[s], e);
        return e.divide(i, i),
        e
    }
    ,
    H.Point.parse = function(t, e, i) {
        e = e || "x",
        i = i || "y";
        var s = new H.Point;
        return t[e] && (s.x = parseInt(t[e], 10)),
        t[i] && (s.y = parseInt(t[i], 10)),
        s
    }
    ,
    PIXI.Point = H.Point,
    H.Polygon = function() {
        this.area = 0,
        this._points = [],
        0 < arguments.length && this.setTo.apply(this, arguments),
        this.closed = !0,
        this.flattened = !1,
        this.type = H.POLYGON
    }
    ,
    H.Polygon.prototype = {
        toNumberArray: function(t) {
            void 0 === t && (t = []);
            for (var e = 0; e < this._points.length; e++)
                "number" == typeof this._points[e] ? (t.push(this._points[e]),
                t.push(this._points[e + 1]),
                e++) : (t.push(this._points[e].x),
                t.push(this._points[e].y));
            return t
        },
        flatten: function() {
            return this._points = this.toNumberArray(),
            this.flattened = !0,
            this
        },
        clone: function(t) {
            var e = this._points.slice();
            return null == t ? t = new H.Polygon(e) : t.setTo(e),
            t
        },
        contains: function(t, e) {
            var i = !1;
            if (this.flattened)
                for (var s = -2, n = this._points.length - 2; (s += 2) < this._points.length; n = s) {
                    var r = this._points[s]
                      , o = this._points[s + 1]
                      , a = this._points[n]
                      , h = this._points[n + 1];
                    (o <= e && e < h || h <= e && e < o) && t < (a - r) * (e - o) / (h - o) + r && (i = !i)
                }
            else
                for (s = -1,
                n = this._points.length - 1; ++s < this._points.length; n = s) {
                    r = this._points[s].x,
                    o = this._points[s].y,
                    a = this._points[n].x,
                    h = this._points[n].y;
                    (o <= e && e < h || h <= e && e < o) && t < (a - r) * (e - o) / (h - o) + r && (i = !i)
                }
            return i
        },
        setTo: function(t) {
            if (this.area = 0,
            this._points = [],
            0 < arguments.length) {
                Array.isArray(t) || (t = Array.prototype.slice.call(arguments));
                for (var e = Number.MAX_VALUE, i = 0, s = t.length; i < s; i++) {
                    if ("number" == typeof t[i]) {
                        var n = new PIXI.Point(t[i],t[i + 1]);
                        i++
                    } else if (Array.isArray(t[i]))
                        n = new PIXI.Point(t[i][0],t[i][1]);
                    else
                        n = new PIXI.Point(t[i].x,t[i].y);
                    this._points.push(n),
                    n.y < e && (e = n.y)
                }
                this.calculateArea(e)
            }
            return this
        },
        calculateArea: function(t) {
            for (var e, i, s, n, r = 0, o = this._points.length; r < o; r++)
                e = this._points[r],
                i = r === o - 1 ? this._points[0] : this._points[r + 1],
                s = (e.y - t + (i.y - t)) / 2,
                n = e.x - i.x,
                this.area += s * n;
            return this.area
        }
    },
    H.Polygon.prototype.constructor = H.Polygon,
    Object.defineProperty(H.Polygon.prototype, "points", {
        get: function() {
            return this._points
        },
        set: function(t) {
            null != t ? this.setTo(t) : this.setTo()
        }
    }),
    PIXI.Polygon = H.Polygon,
    H.Rectangle = function(t, e, i, s) {
        t = t || 0,
        e = e || 0,
        i = i || 0,
        s = s || 0,
        this.x = t,
        this.y = e,
        this.width = i,
        this.height = s,
        this.type = H.RECTANGLE
    }
    ,
    H.Rectangle.prototype = {
        offset: function(t, e) {
            return this.x += t,
            this.y += e,
            this
        },
        offsetPoint: function(t) {
            return this.offset(t.x, t.y)
        },
        setTo: function(t, e, i, s) {
            return this.x = t,
            this.y = e,
            this.width = i,
            this.height = s,
            this
        },
        scale: function(t, e) {
            return void 0 === e && (e = t),
            this.width *= t,
            this.height *= e,
            this
        },
        centerOn: function(t, e) {
            return this.centerX = t,
            this.centerY = e,
            this
        },
        floor: function() {
            this.x = Math.floor(this.x),
            this.y = Math.floor(this.y)
        },
        floorAll: function() {
            this.x = Math.floor(this.x),
            this.y = Math.floor(this.y),
            this.width = Math.floor(this.width),
            this.height = Math.floor(this.height)
        },
        ceil: function() {
            this.x = Math.ceil(this.x),
            this.y = Math.ceil(this.y)
        },
        ceilAll: function() {
            this.x = Math.ceil(this.x),
            this.y = Math.ceil(this.y),
            this.width = Math.ceil(this.width),
            this.height = Math.ceil(this.height)
        },
        copyFrom: function(t) {
            return this.setTo(t.x, t.y, t.width, t.height)
        },
        copyTo: function(t) {
            return t.x = this.x,
            t.y = this.y,
            t.width = this.width,
            t.height = this.height,
            t
        },
        inflate: function(t, e) {
            return H.Rectangle.inflate(this, t, e)
        },
        size: function(t) {
            return H.Rectangle.size(this, t)
        },
        resize: function(t, e) {
            return this.width = t,
            this.height = e,
            this
        },
        clone: function(t) {
            return H.Rectangle.clone(this, t)
        },
        contains: function(t, e) {
            return H.Rectangle.contains(this, t, e)
        },
        containsRect: function(t) {
            return H.Rectangle.containsRect(t, this)
        },
        equals: function(t) {
            return H.Rectangle.equals(this, t)
        },
        intersection: function(t, e) {
            return H.Rectangle.intersection(this, t, e)
        },
        intersects: function(t) {
            return H.Rectangle.intersects(this, t)
        },
        intersectsRaw: function(t, e, i, s, n) {
            return H.Rectangle.intersectsRaw(this, t, e, i, s, n)
        },
        union: function(t, e) {
            return H.Rectangle.union(this, t, e)
        },
        random: function(t) {
            return void 0 === t && (t = new H.Point),
            t.x = this.randomX,
            t.y = this.randomY,
            t
        },
        getPoint: function(t, e) {
            switch (void 0 === e && (e = new H.Point),
            t) {
            default:
            case H.TOP_LEFT:
                return e.set(this.x, this.y);
            case H.TOP_CENTER:
                return e.set(this.centerX, this.y);
            case H.TOP_RIGHT:
                return e.set(this.right, this.y);
            case H.LEFT_CENTER:
                return e.set(this.x, this.centerY);
            case H.CENTER:
                return e.set(this.centerX, this.centerY);
            case H.RIGHT_CENTER:
                return e.set(this.right, this.centerY);
            case H.BOTTOM_LEFT:
                return e.set(this.x, this.bottom);
            case H.BOTTOM_CENTER:
                return e.set(this.centerX, this.bottom);
            case H.BOTTOM_RIGHT:
                return e.set(this.right, this.bottom)
            }
        },
        toString: function() {
            return "[{Rectangle (x=" + this.x + " y=" + this.y + " width=" + this.width + " height=" + this.height + " empty=" + this.empty + ")}]"
        }
    },
    Object.defineProperty(H.Rectangle.prototype, "halfWidth", {
        get: function() {
            return Math.round(this.width / 2)
        }
    }),
    Object.defineProperty(H.Rectangle.prototype, "halfHeight", {
        get: function() {
            return Math.round(this.height / 2)
        }
    }),
    Object.defineProperty(H.Rectangle.prototype, "bottom", {
        get: function() {
            return this.y + this.height
        },
        set: function(t) {
            t <= this.y ? this.height = 0 : this.height = t - this.y
        }
    }),
    Object.defineProperty(H.Rectangle.prototype, "bottomLeft", {
        get: function() {
            return new H.Point(this.x,this.bottom)
        },
        set: function(t) {
            this.x = t.x,
            this.bottom = t.y
        }
    }),
    Object.defineProperty(H.Rectangle.prototype, "bottomRight", {
        get: function() {
            return new H.Point(this.right,this.bottom)
        },
        set: function(t) {
            this.right = t.x,
            this.bottom = t.y
        }
    }),
    Object.defineProperty(H.Rectangle.prototype, "left", {
        get: function() {
            return this.x
        },
        set: function(t) {
            t >= this.right ? this.width = 0 : this.width = this.right - t,
            this.x = t
        }
    }),
    Object.defineProperty(H.Rectangle.prototype, "right", {
        get: function() {
            return this.x + this.width
        },
        set: function(t) {
            t <= this.x ? this.width = 0 : this.width = t - this.x
        }
    }),
    Object.defineProperty(H.Rectangle.prototype, "volume", {
        get: function() {
            return this.width * this.height
        }
    }),
    Object.defineProperty(H.Rectangle.prototype, "perimeter", {
        get: function() {
            return 2 * this.width + 2 * this.height
        }
    }),
    Object.defineProperty(H.Rectangle.prototype, "centerX", {
        get: function() {
            return this.x + this.halfWidth
        },
        set: function(t) {
            this.x = t - this.halfWidth
        }
    }),
    Object.defineProperty(H.Rectangle.prototype, "centerY", {
        get: function() {
            return this.y + this.halfHeight
        },
        set: function(t) {
            this.y = t - this.halfHeight
        }
    }),
    Object.defineProperty(H.Rectangle.prototype, "randomX", {
        get: function() {
            return this.x + Math.random() * this.width
        }
    }),
    Object.defineProperty(H.Rectangle.prototype, "randomY", {
        get: function() {
            return this.y + Math.random() * this.height
        }
    }),
    Object.defineProperty(H.Rectangle.prototype, "top", {
        get: function() {
            return this.y
        },
        set: function(t) {
            t >= this.bottom ? (this.height = 0,
            this.y = t) : this.height = this.bottom - t
        }
    }),
    Object.defineProperty(H.Rectangle.prototype, "topLeft", {
        get: function() {
            return new H.Point(this.x,this.y)
        },
        set: function(t) {
            this.x = t.x,
            this.y = t.y
        }
    }),
    Object.defineProperty(H.Rectangle.prototype, "topRight", {
        get: function() {
            return new H.Point(this.x + this.width,this.y)
        },
        set: function(t) {
            this.right = t.x,
            this.y = t.y
        }
    }),
    Object.defineProperty(H.Rectangle.prototype, "empty", {
        get: function() {
            return !this.width || !this.height
        },
        set: function(t) {
            !0 === t && this.setTo(0, 0, 0, 0)
        }
    }),
    H.Rectangle.prototype.constructor = H.Rectangle,
    H.Rectangle.inflate = function(t, e, i) {
        return t.x -= e,
        t.width += 2 * e,
        t.y -= i,
        t.height += 2 * i,
        t
    }
    ,
    H.Rectangle.inflatePoint = function(t, e) {
        return H.Rectangle.inflate(t, e.x, e.y)
    }
    ,
    H.Rectangle.size = function(t, e) {
        return null == e ? e = new H.Point(t.width,t.height) : e.setTo(t.width, t.height),
        e
    }
    ,
    H.Rectangle.clone = function(t, e) {
        return null == e ? e = new H.Rectangle(t.x,t.y,t.width,t.height) : e.setTo(t.x, t.y, t.width, t.height),
        e
    }
    ,
    H.Rectangle.contains = function(t, e, i) {
        return !(t.width <= 0 || t.height <= 0) && e >= t.x && e < t.right && i >= t.y && i < t.bottom
    }
    ,
    H.Rectangle.containsRaw = function(t, e, i, s, n, r) {
        return t <= n && n < t + i && e <= r && r < e + s
    }
    ,
    H.Rectangle.containsPoint = function(t, e) {
        return H.Rectangle.contains(t, e.x, e.y)
    }
    ,
    H.Rectangle.containsRect = function(t, e) {
        return !(t.volume > e.volume) && t.x >= e.x && t.y >= e.y && t.right < e.right && t.bottom < e.bottom
    }
    ,
    H.Rectangle.equals = function(t, e) {
        return t.x === e.x && t.y === e.y && t.width === e.width && t.height === e.height
    }
    ,
    H.Rectangle.sameDimensions = function(t, e) {
        return t.width === e.width && t.height === e.height
    }
    ,
    H.Rectangle.intersection = function(t, e, i) {
        return void 0 === i && (i = new H.Rectangle),
        H.Rectangle.intersects(t, e) && (i.x = Math.max(t.x, e.x),
        i.y = Math.max(t.y, e.y),
        i.width = Math.min(t.right, e.right) - i.x,
        i.height = Math.min(t.bottom, e.bottom) - i.y),
        i
    }
    ,
    H.Rectangle.intersects = function(t, e) {
        return !(t.width <= 0 || t.height <= 0 || e.width <= 0 || e.height <= 0 || t.right < e.x || t.bottom < e.y || t.x > e.right || t.y > e.bottom)
    }
    ,
    H.Rectangle.intersectsRaw = function(t, e, i, s, n, r) {
        return void 0 === r && (r = 0),
        !(e > t.right + r || i < t.left - r || s > t.bottom + r || n < t.top - r)
    }
    ,
    H.Rectangle.union = function(t, e, i) {
        return void 0 === i && (i = new H.Rectangle),
        i.setTo(Math.min(t.x, e.x), Math.min(t.y, e.y), Math.max(t.right, e.right) - Math.min(t.left, e.left), Math.max(t.bottom, e.bottom) - Math.min(t.top, e.top))
    }
    ,
    H.Rectangle.aabb = function(t, e) {
        void 0 === e && (e = new H.Rectangle);
        var i = Number.NEGATIVE_INFINITY
          , s = Number.POSITIVE_INFINITY
          , n = Number.NEGATIVE_INFINITY
          , r = Number.POSITIVE_INFINITY;
        return t.forEach(function(t) {
            t.x > i && (i = t.x),
            t.x < s && (s = t.x),
            t.y > n && (n = t.y),
            t.y < r && (r = t.y)
        }),
        e.setTo(s, r, i - s, n - r),
        e
    }
    ,
    PIXI.Rectangle = H.Rectangle,
    PIXI.EmptyRectangle = new H.Rectangle(0,0,0,0),
    H.RoundedRectangle = function(t, e, i, s, n) {
        void 0 === t && (t = 0),
        void 0 === e && (e = 0),
        void 0 === i && (i = 0),
        void 0 === s && (s = 0),
        void 0 === n && (n = 20),
        this.x = t,
        this.y = e,
        this.width = i,
        this.height = s,
        this.radius = n || 20,
        this.type = H.ROUNDEDRECTANGLE
    }
    ,
    H.RoundedRectangle.prototype = {
        clone: function() {
            return new H.RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)
        },
        contains: function(t, e) {
            if (this.width <= 0 || this.height <= 0)
                return !1;
            var i = this.x;
            if (i <= t && t <= i + this.width) {
                var s = this.y;
                if (s <= e && e <= s + this.height)
                    return !0
            }
            return !1
        }
    },
    H.RoundedRectangle.prototype.constructor = H.RoundedRectangle,
    PIXI.RoundedRectangle = H.RoundedRectangle,
    H.Camera = function(t, e, i, s, n, r) {
        this.game = t,
        this.world = t.world,
        this.id = 0,
        this.view = new H.Rectangle(i,s,n,r),
        this.bounds = new H.Rectangle(i,s,n,r),
        this.deadzone = null,
        this.visible = !0,
        this.roundPx = !0,
        this.atLimit = {
            x: !1,
            y: !1
        },
        this.target = null,
        this.displayObject = null,
        this.scale = null,
        this.totalInView = 0,
        this.lerp = new H.Point(1,1),
        this.onShakeComplete = new H.Signal,
        this.onFlashComplete = new H.Signal,
        this.onFadeComplete = new H.Signal,
        this.fx = null,
        this._targetPosition = new H.Point,
        this._edge = 0,
        this._position = new H.Point,
        this._shake = {
            intensity: 0,
            duration: 0,
            horizontal: !1,
            vertical: !1,
            shakeBounds: !0,
            x: 0,
            y: 0
        },
        this._fxDuration = 0,
        this._fxType = 0
    }
    ,
    H.Camera.FOLLOW_LOCKON = 0,
    H.Camera.FOLLOW_PLATFORMER = 1,
    H.Camera.FOLLOW_TOPDOWN = 2,
    H.Camera.FOLLOW_TOPDOWN_TIGHT = 3,
    H.Camera.SHAKE_BOTH = 4,
    H.Camera.SHAKE_HORIZONTAL = 5,
    H.Camera.SHAKE_VERTICAL = 6,
    H.Camera.ENABLE_FX = !0,
    H.Camera.prototype = {
        boot: function() {
            this.displayObject = this.game.world,
            this.scale = this.game.world.scale,
            this.game.camera = this,
            H.Graphics && H.Camera.ENABLE_FX && (this.fx = new H.Graphics(this.game),
            this.game.stage.addChild(this.fx))
        },
        preUpdate: function() {
            this.totalInView = 0
        },
        follow: function(t, e, i, s) {
            var n;
            switch (void 0 === e && (e = H.Camera.FOLLOW_LOCKON),
            void 0 === i && (i = 1),
            void 0 === s && (s = 1),
            this.target = t,
            this.lerp.set(i, s),
            e) {
            case H.Camera.FOLLOW_PLATFORMER:
                var r = this.width / 8
                  , o = this.height / 3;
                this.deadzone = new H.Rectangle((this.width - r) / 2,(this.height - o) / 2 - .25 * o,r,o);
                break;
            case H.Camera.FOLLOW_TOPDOWN:
                n = Math.max(this.width, this.height) / 4,
                this.deadzone = new H.Rectangle((this.width - n) / 2,(this.height - n) / 2,n,n);
                break;
            case H.Camera.FOLLOW_TOPDOWN_TIGHT:
                n = Math.max(this.width, this.height) / 8,
                this.deadzone = new H.Rectangle((this.width - n) / 2,(this.height - n) / 2,n,n);
                break;
            case H.Camera.FOLLOW_LOCKON:
            default:
                this.deadzone = null
            }
        },
        unfollow: function() {
            this.target = null
        },
        focusOn: function(t) {
            this.setPosition(Math.round(t.x - this.view.halfWidth), Math.round(t.y - this.view.halfHeight))
        },
        focusOnXY: function(t, e) {
            this.setPosition(Math.round(t - this.view.halfWidth), Math.round(e - this.view.halfHeight))
        },
        shake: function(t, e, i, s, n) {
            return void 0 === t && (t = .05),
            void 0 === e && (e = 500),
            void 0 === i && (i = !0),
            void 0 === s && (s = H.Camera.SHAKE_BOTH),
            void 0 === n && (n = !0),
            !(!i && 0 < this._shake.duration || (this._shake.intensity = t,
            this._shake.duration = e,
            this._shake.shakeBounds = n,
            this._shake.x = 0,
            this._shake.y = 0,
            this._shake.horizontal = s === H.Camera.SHAKE_BOTH || s === H.Camera.SHAKE_HORIZONTAL,
            this._shake.vertical = s === H.Camera.SHAKE_BOTH || s === H.Camera.SHAKE_VERTICAL,
            0))
        },
        flash: function(t, e, i) {
            return void 0 === t && (t = 16777215),
            void 0 === e && (e = 500),
            void 0 === i && (i = !1),
            !(!this.fx || !i && 0 < this._fxDuration || (this.fx.clear(),
            this.fx.beginFill(t),
            this.fx.drawRect(0, 0, this.width, this.height),
            this.fx.endFill(),
            this.fx.alpha = 1,
            this._fxDuration = e,
            this._fxType = 0))
        },
        fade: function(t, e, i) {
            return void 0 === t && (t = 0),
            void 0 === e && (e = 500),
            void 0 === i && (i = !1),
            !(!this.fx || !i && 0 < this._fxDuration || (this.fx.clear(),
            this.fx.beginFill(t),
            this.fx.drawRect(0, 0, this.width, this.height),
            this.fx.endFill(),
            this.fx.alpha = 0,
            this._fxDuration = e,
            this._fxType = 1,
            0))
        },
        update: function() {
            0 < this._fxDuration && this.updateFX(),
            0 < this._shake.duration && this.updateShake(),
            this.bounds && this.checkBounds(),
            this.roundPx && (this.view.floor(),
            this._shake.x = Math.floor(this._shake.x),
            this._shake.y = Math.floor(this._shake.y)),
            this.displayObject.position.x = -this.view.x,
            this.displayObject.position.y = -this.view.y
        },
        updateFX: function() {
            0 === this._fxType ? (this.fx.alpha -= this.game.time.elapsedMS / this._fxDuration,
            this.fx.alpha <= 0 && (this._fxDuration = 0,
            this.fx.alpha = 0,
            this.onFlashComplete.dispatch())) : (this.fx.alpha += this.game.time.elapsedMS / this._fxDuration,
            1 <= this.fx.alpha && (this._fxDuration = 0,
            this.fx.alpha = 1,
            this.onFadeComplete.dispatch()))
        },
        updateShake: function() {
            this._shake.duration -= this.game.time.elapsedMS,
            this._shake.duration <= 0 ? (this.onShakeComplete.dispatch(),
            this._shake.x = 0,
            this._shake.y = 0) : (this._shake.horizontal && (this._shake.x = this.game.rnd.frac() * this._shake.intensity * this.view.width * 2 - this._shake.intensity * this.view.width),
            this._shake.vertical && (this._shake.y = this.game.rnd.frac() * this._shake.intensity * this.view.height * 2 - this._shake.intensity * this.view.height))
        },
        updateTarget: function() {
            this._targetPosition.x = this.view.x + this.target.worldPosition.x,
            this._targetPosition.y = this.view.y + this.target.worldPosition.y,
            this.deadzone ? (this._edge = this._targetPosition.x - this.view.x,
            this._edge < this.deadzone.left ? this.view.x = this.game.math.linear(this.view.x, this._targetPosition.x - this.deadzone.left, this.lerp.x) : this._edge > this.deadzone.right && (this.view.x = this.game.math.linear(this.view.x, this._targetPosition.x - this.deadzone.right, this.lerp.x)),
            this._edge = this._targetPosition.y - this.view.y,
            this._edge < this.deadzone.top ? this.view.y = this.game.math.linear(this.view.y, this._targetPosition.y - this.deadzone.top, this.lerp.y) : this._edge > this.deadzone.bottom && (this.view.y = this.game.math.linear(this.view.y, this._targetPosition.y - this.deadzone.bottom, this.lerp.y))) : (this.view.x = this.game.math.linear(this.view.x, this._targetPosition.x - this.view.halfWidth, this.lerp.x),
            this.view.y = this.game.math.linear(this.view.y, this._targetPosition.y - this.view.halfHeight, this.lerp.y)),
            this.bounds && this.checkBounds(),
            this.roundPx && this.view.floor(),
            this.displayObject.position.x = -this.view.x,
            this.displayObject.position.y = -this.view.y
        },
        setBoundsToWorld: function() {
            this.bounds && this.bounds.copyFrom(this.game.world.bounds)
        },
        checkBounds: function() {
            this.atLimit.x = !1,
            this.atLimit.y = !1;
            var t = this.view.x + this._shake.x
              , e = this.view.right + this._shake.x
              , i = this.view.y + this._shake.y
              , s = this.view.bottom + this._shake.y;
            t <= this.bounds.x * this.scale.x && (this.atLimit.x = !0,
            this.view.x = this.bounds.x * this.scale.x,
            this._shake.shakeBounds || (this._shake.x = 0)),
            e >= this.bounds.right * this.scale.x && (this.atLimit.x = !0,
            this.view.x = this.bounds.right * this.scale.x - this.width,
            this._shake.shakeBounds || (this._shake.x = 0)),
            i <= this.bounds.top * this.scale.y && (this.atLimit.y = !0,
            this.view.y = this.bounds.top * this.scale.y,
            this._shake.shakeBounds || (this._shake.y = 0)),
            s >= this.bounds.bottom * this.scale.y && (this.atLimit.y = !0,
            this.view.y = this.bounds.bottom * this.scale.y - this.height,
            this._shake.shakeBounds || (this._shake.y = 0))
        },
        setPosition: function(t, e) {
            this.view.x = t,
            this.view.y = e,
            this.bounds && this.checkBounds()
        },
        setSize: function(t, e) {
            this.view.width = t,
            this.view.height = e
        },
        reset: function() {
            this.target = null,
            this.view.x = 0,
            this.view.y = 0,
            this._shake.duration = 0,
            this.resetFX()
        },
        resetFX: function() {
            this.fx && (this.fx.clear(),
            this.fx.alpha = 0,
            this._fxDuration = 0)
        }
    },
    H.Camera.prototype.constructor = H.Camera,
    Object.defineProperty(H.Camera.prototype, "x", {
        get: function() {
            return this.view.x
        },
        set: function(t) {
            this.view.x = t,
            this.bounds && this.checkBounds()
        }
    }),
    Object.defineProperty(H.Camera.prototype, "y", {
        get: function() {
            return this.view.y
        },
        set: function(t) {
            this.view.y = t,
            this.bounds && this.checkBounds()
        }
    }),
    Object.defineProperty(H.Camera.prototype, "position", {
        get: function() {
            return this._position.set(this.view.x, this.view.y),
            this._position
        },
        set: function(t) {
            void 0 !== t.x && (this.view.x = t.x),
            void 0 !== t.y && (this.view.y = t.y),
            this.bounds && this.checkBounds()
        }
    }),
    Object.defineProperty(H.Camera.prototype, "width", {
        get: function() {
            return this.view.width
        },
        set: function(t) {
            this.view.width = t
        }
    }),
    Object.defineProperty(H.Camera.prototype, "height", {
        get: function() {
            return this.view.height
        },
        set: function(t) {
            this.view.height = t
        }
    }),
    Object.defineProperty(H.Camera.prototype, "shakeIntensity", {
        get: function() {
            return this._shake.intensity
        },
        set: function(t) {
            this._shake.intensity = t
        }
    }),
    H.State = function() {
        this.game = null,
        this.key = "",
        this.add = null,
        this.make = null,
        this.camera = null,
        this.cache = null,
        this.input = null,
        this.load = null,
        this.math = null,
        this.sound = null,
        this.scale = null,
        this.stage = null,
        this.state = null,
        this.time = null,
        this.tweens = null,
        this.world = null,
        this.particles = null,
        this.physics = null,
        this.rnd = null
    }
    ,
    H.State.prototype = {
        init: function() {},
        preload: function() {},
        loadUpdate: function() {},
        loadRender: function() {},
        create: function() {},
        update: function() {},
        preRender: function() {},
        render: function() {},
        resize: function() {},
        paused: function() {},
        resumed: function() {},
        pauseUpdate: function() {},
        shutdown: function() {}
    },
    H.State.prototype.constructor = H.State,
    H.StateManager = function(t, e) {
        this.game = t,
        this.states = {},
        (this._pendingState = null) != e && (this._pendingState = e),
        this._clearWorld = !1,
        this._clearCache = !1,
        this._created = !1,
        this._args = [],
        this.current = "",
        this.onStateChange = new H.Signal,
        this.onInitCallback = null,
        this.onPreloadCallback = null,
        this.onCreateCallback = null,
        this.onUpdateCallback = null,
        this.onRenderCallback = null,
        this.onResizeCallback = null,
        this.onPreRenderCallback = null,
        this.onLoadUpdateCallback = null,
        this.onLoadRenderCallback = null,
        this.onPausedCallback = null,
        this.onResumedCallback = null,
        this.onPauseUpdateCallback = null,
        this.onShutDownCallback = null
    }
    ,
    H.StateManager.prototype = {
        boot: function() {
            this.game.onPause.add(this.pause, this),
            this.game.onResume.add(this.resume, this),
            null !== this._pendingState && "string" != typeof this._pendingState && this.add("default", this._pendingState, !0)
        },
        add: function(t, e, i) {
            var s;
            return void 0 === i && (i = !1),
            e instanceof H.State ? s = e : "object" == typeof e ? (s = e).game = this.game : "function" == typeof e && (s = new e(this.game)),
            this.states[t] = s,
            i && (this.game.isBooted ? this.start(t) : this._pendingState = t),
            s
        },
        remove: function(t) {
            this.current === t && (this.callbackContext = null,
            this.onInitCallback = null,
            this.onShutDownCallback = null,
            this.onPreloadCallback = null,
            this.onLoadRenderCallback = null,
            this.onLoadUpdateCallback = null,
            this.onCreateCallback = null,
            this.onUpdateCallback = null,
            this.onPreRenderCallback = null,
            this.onRenderCallback = null,
            this.onResizeCallback = null,
            this.onPausedCallback = null,
            this.onResumedCallback = null,
            this.onPauseUpdateCallback = null),
            delete this.states[t]
        },
        start: function(t, e, i) {
            void 0 === e && (e = !0),
            void 0 === i && (i = !1),
            this.checkState(t) && (this._pendingState = t,
            this._clearWorld = e,
            this._clearCache = i,
            3 < arguments.length && (this._args = Array.prototype.splice.call(arguments, 3)))
        },
        restart: function(t, e) {
            void 0 === t && (t = !0),
            void 0 === e && (e = !1),
            this._pendingState = this.current,
            this._clearWorld = t,
            this._clearCache = e,
            2 < arguments.length && (this._args = Array.prototype.slice.call(arguments, 2))
        },
        dummy: function() {},
        preUpdate: function() {
            if (this._pendingState && this.game.isBooted) {
                var t = this.current;
                if (this.clearCurrentState(),
                this.setCurrentState(this._pendingState),
                this.onStateChange.dispatch(this.current, t),
                this.current !== this._pendingState)
                    return;
                this._pendingState = null,
                this.onPreloadCallback ? (this.game.load.reset(!0),
                this.onPreloadCallback.call(this.callbackContext, this.game),
                0 === this.game.load.totalQueuedFiles() && 0 === this.game.load.totalQueuedPacks() ? this.loadComplete() : this.game.load.start()) : this.loadComplete()
            }
        },
        clearCurrentState: function() {
            this.current && (this.onShutDownCallback && this.onShutDownCallback.call(this.callbackContext, this.game),
            this.game.tweens.removeAll(),
            this.game.camera.reset(),
            this.game.input.reset(!0),
            this.game.physics.clear(),
            this.game.time.removeAll(),
            this.game.scale.reset(this._clearWorld),
            this.game.debug && this.game.debug.reset(),
            this._clearWorld && (this.game.world.shutdown(),
            this._clearCache && this.game.cache.destroy()))
        },
        checkState: function(t) {
            return this.states[t] && !!(this.states[t].preload || this.states[t].create || this.states[t].update || this.states[t].render) || !1
        },
        link: function(t) {
            this.states[t].game = this.game,
            this.states[t].add = this.game.add,
            this.states[t].make = this.game.make,
            this.states[t].camera = this.game.camera,
            this.states[t].cache = this.game.cache,
            this.states[t].input = this.game.input,
            this.states[t].load = this.game.load,
            this.states[t].math = this.game.math,
            this.states[t].sound = this.game.sound,
            this.states[t].scale = this.game.scale,
            (this.states[t].state = this).states[t].stage = this.game.stage,
            this.states[t].time = this.game.time,
            this.states[t].tweens = this.game.tweens,
            this.states[t].world = this.game.world,
            this.states[t].particles = this.game.particles,
            this.states[t].rnd = this.game.rnd,
            this.states[t].physics = this.game.physics,
            this.states[t].key = t
        },
        unlink: function(t) {
            this.states[t] && (this.states[t].game = null,
            this.states[t].add = null,
            this.states[t].make = null,
            this.states[t].camera = null,
            this.states[t].cache = null,
            this.states[t].input = null,
            this.states[t].load = null,
            this.states[t].math = null,
            this.states[t].sound = null,
            this.states[t].scale = null,
            this.states[t].state = null,
            this.states[t].stage = null,
            this.states[t].time = null,
            this.states[t].tweens = null,
            this.states[t].world = null,
            this.states[t].particles = null,
            this.states[t].rnd = null,
            this.states[t].physics = null)
        },
        setCurrentState: function(t) {
            this.callbackContext = this.states[t],
            this.link(t),
            this.onInitCallback = this.states[t].init || this.dummy,
            this.onPreloadCallback = this.states[t].preload || null,
            this.onLoadRenderCallback = this.states[t].loadRender || null,
            this.onLoadUpdateCallback = this.states[t].loadUpdate || null,
            this.onCreateCallback = this.states[t].create || null,
            this.onUpdateCallback = this.states[t].update || null,
            this.onPreRenderCallback = this.states[t].preRender || null,
            this.onRenderCallback = this.states[t].render || null,
            this.onResizeCallback = this.states[t].resize || null,
            this.onPausedCallback = this.states[t].paused || null,
            this.onResumedCallback = this.states[t].resumed || null,
            this.onPauseUpdateCallback = this.states[t].pauseUpdate || null,
            this.onShutDownCallback = this.states[t].shutdown || this.dummy,
            "" !== this.current && this.game.physics.reset(),
            this.current = t,
            this._created = !1,
            this.onInitCallback.apply(this.callbackContext, this._args),
            t === this._pendingState && (this._args = []),
            this.game._kickstart = !0
        },
        getCurrentState: function() {
            return this.states[this.current]
        },
        loadComplete: function() {
            !1 === this._created && this.onLoadUpdateCallback && this.onLoadUpdateCallback.call(this.callbackContext, this.game),
            !1 === this._created && this.onCreateCallback ? (this._created = !0,
            this.onCreateCallback.call(this.callbackContext, this.game)) : this._created = !0
        },
        pause: function() {
            this._created && this.onPausedCallback && this.onPausedCallback.call(this.callbackContext, this.game)
        },
        resume: function() {
            this._created && this.onResumedCallback && this.onResumedCallback.call(this.callbackContext, this.game)
        },
        update: function() {
            this._created ? this.onUpdateCallback && this.onUpdateCallback.call(this.callbackContext, this.game) : this.onLoadUpdateCallback && this.onLoadUpdateCallback.call(this.callbackContext, this.game)
        },
        pauseUpdate: function() {
            this._created ? this.onPauseUpdateCallback && this.onPauseUpdateCallback.call(this.callbackContext, this.game) : this.onLoadUpdateCallback && this.onLoadUpdateCallback.call(this.callbackContext, this.game)
        },
        preRender: function(t) {
            this._created && this.onPreRenderCallback && this.onPreRenderCallback.call(this.callbackContext, this.game, t)
        },
        resize: function(t, e) {
            this.onResizeCallback && this.onResizeCallback.call(this.callbackContext, t, e)
        },
        render: function() {
            this._created ? this.onRenderCallback && (this.game.renderType === H.CANVAS ? (this.game.context.save(),
            this.game.context.setTransform(1, 0, 0, 1, 0, 0),
            this.onRenderCallback.call(this.callbackContext, this.game),
            this.game.context.restore()) : this.onRenderCallback.call(this.callbackContext, this.game)) : this.onLoadRenderCallback && this.onLoadRenderCallback.call(this.callbackContext, this.game)
        },
        destroy: function() {
            this._clearWorld = !0,
            this._clearCache = !0,
            this.clearCurrentState(),
            this.callbackContext = null,
            this.onInitCallback = null,
            this.onShutDownCallback = null,
            this.onPreloadCallback = null,
            this.onLoadRenderCallback = null,
            this.onLoadUpdateCallback = null,
            this.onCreateCallback = null,
            this.onUpdateCallback = null,
            this.onRenderCallback = null,
            this.onPausedCallback = null,
            this.onResumedCallback = null,
            this.onPauseUpdateCallback = null,
            this.game = null,
            this.states = {},
            this._pendingState = null,
            this.current = ""
        }
    },
    H.StateManager.prototype.constructor = H.StateManager,
    Object.defineProperty(H.StateManager.prototype, "created", {
        get: function() {
            return this._created
        }
    }),
    H.Signal = function() {}
    ,
    H.Signal.prototype = {
        _bindings: null,
        _prevParams: null,
        memorize: !1,
        _shouldPropagate: !0,
        active: !0,
        _boundDispatch: !1,
        validateListener: function(t, e) {
            if ("function" != typeof t)
                throw new Error("Phaser.Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}", e))
        },
        _registerListener: function(t, e, i, s, n) {
            var r, o = this._indexOfListener(t, i);
            if (-1 !== o) {
                if ((r = this._bindings[o]).isOnce() !== e)
                    throw new Error("You cannot add" + (e ? "" : "Once") + "() then add" + (e ? "Once" : "") + "() the same listener without removing the relationship first.")
            } else
                r = new H.SignalBinding(this,t,e,i,s,n),
                this._addBinding(r);
            return this.memorize && this._prevParams && r.execute(this._prevParams),
            r
        },
        _addBinding: function(t) {
            this._bindings || (this._bindings = []);
            for (var e = this._bindings.length; e--,
            this._bindings[e] && t._priority <= this._bindings[e]._priority; )
                ;
            this._bindings.splice(e + 1, 0, t)
        },
        _indexOfListener: function(t, e) {
            if (!this._bindings)
                return -1;
            void 0 === e && (e = null);
            for (var i, s = this._bindings.length; s--; )
                if ((i = this._bindings[s])._listener === t && i.context === e)
                    return s;
            return -1
        },
        has: function(t, e) {
            return -1 !== this._indexOfListener(t, e)
        },
        add: function(t, e, i) {
            this.validateListener(t, "add");
            var s = [];
            if (3 < arguments.length)
                for (var n = 3; n < arguments.length; n++)
                    s.push(arguments[n]);
            return this._registerListener(t, !1, e, i, s)
        },
        addOnce: function(t, e, i) {
            this.validateListener(t, "addOnce");
            var s = [];
            if (3 < arguments.length)
                for (var n = 3; n < arguments.length; n++)
                    s.push(arguments[n]);
            return this._registerListener(t, !0, e, i, s)
        },
        remove: function(t, e) {
            this.validateListener(t, "remove");
            var i = this._indexOfListener(t, e);
            return -1 !== i && (this._bindings[i]._destroy(),
            this._bindings.splice(i, 1)),
            t
        },
        removeAll: function(t) {
            if (void 0 === t && (t = null),
            this._bindings) {
                for (var e = this._bindings.length; e--; )
                    t ? this._bindings[e].context === t && (this._bindings[e]._destroy(),
                    this._bindings.splice(e, 1)) : this._bindings[e]._destroy();
                t || (this._bindings.length = 0)
            }
        },
        getNumListeners: function() {
            return this._bindings ? this._bindings.length : 0
        },
        halt: function() {
            this._shouldPropagate = !1
        },
        dispatch: function() {
            if (this.active && this._bindings) {
                var t, e = Array.prototype.slice.call(arguments), i = this._bindings.length;
                if (this.memorize && (this._prevParams = e),
                i)
                    for (t = this._bindings.slice(),
                    this._shouldPropagate = !0; t[--i] && this._shouldPropagate && !1 !== t[i].execute(e); )
                        ;
            }
        },
        forget: function() {
            this._prevParams && (this._prevParams = null)
        },
        dispose: function() {
            this.removeAll(),
            this._bindings = null,
            this._prevParams && (this._prevParams = null)
        },
        toString: function() {
            return "[Phaser.Signal active:" + this.active + " numListeners:" + this.getNumListeners() + "]"
        }
    },
    Object.defineProperty(H.Signal.prototype, "boundDispatch", {
        get: function() {
            var t = this;
            return this._boundDispatch || (this._boundDispatch = function() {
                return t.dispatch.apply(t, arguments)
            }
            )
        }
    }),
    H.Signal.prototype.constructor = H.Signal,
    H.SignalBinding = function(t, e, i, s, n, r) {
        this._listener = e,
        i && (this._isOnce = !0),
        null != s && (this.context = s),
        this._signal = t,
        n && (this._priority = n),
        r && r.length && (this._args = r)
    }
    ,
    H.SignalBinding.prototype = {
        context: null,
        _isOnce: !1,
        _priority: 0,
        _args: null,
        callCount: 0,
        active: !0,
        params: null,
        execute: function(t) {
            var e, i;
            return this.active && this._listener && (i = this.params ? this.params.concat(t) : t,
            this._args && (i = i.concat(this._args)),
            e = this._listener.apply(this.context, i),
            this.callCount++,
            this._isOnce && this.detach()),
            e
        },
        detach: function() {
            return this.isBound() ? this._signal.remove(this._listener, this.context) : null
        },
        isBound: function() {
            return !!this._signal && !!this._listener
        },
        isOnce: function() {
            return this._isOnce
        },
        getListener: function() {
            return this._listener
        },
        getSignal: function() {
            return this._signal
        },
        _destroy: function() {
            delete this._signal,
            delete this._listener,
            delete this.context
        },
        toString: function() {
            return "[Phaser.SignalBinding isOnce:" + this._isOnce + ", isBound:" + this.isBound() + ", active:" + this.active + "]"
        }
    },
    H.SignalBinding.prototype.constructor = H.SignalBinding,
    H.Filter = function(t, e, i) {
        this.game = t,
        this.type = H.WEBGL_FILTER,
        this.passes = [this],
        this.shaders = [],
        this.dirty = !0,
        this.padding = 0,
        this.prevPoint = new H.Point;
        var s = new Date;
        if (this.uniforms = {
            resolution: {
                type: "2f",
                value: {
                    x: 256,
                    y: 256
                }
            },
            time: {
                type: "1f",
                value: 0
            },
            mouse: {
                type: "2f",
                value: {
                    x: 0,
                    y: 0
                }
            },
            date: {
                type: "4fv",
                value: [s.getFullYear(), s.getMonth(), s.getDate(), 60 * s.getHours() * 60 + 60 * s.getMinutes() + s.getSeconds()]
            },
            sampleRate: {
                type: "1f",
                value: 44100
            },
            iChannel0: {
                type: "sampler2D",
                value: null,
                textureData: {
                    repeat: !0
                }
            },
            iChannel1: {
                type: "sampler2D",
                value: null,
                textureData: {
                    repeat: !0
                }
            },
            iChannel2: {
                type: "sampler2D",
                value: null,
                textureData: {
                    repeat: !0
                }
            },
            iChannel3: {
                type: "sampler2D",
                value: null,
                textureData: {
                    repeat: !0
                }
            }
        },
        e)
            for (var n in e)
                this.uniforms[n] = e[n];
        this.fragmentSrc = i || ""
    }
    ,
    H.Filter.prototype = {
        init: function() {},
        setResolution: function(t, e) {
            this.uniforms.resolution.value.x = t,
            this.uniforms.resolution.value.y = e
        },
        update: function(t) {
            if (void 0 !== t) {
                var e = t.x / this.game.width
                  , i = 1 - t.y / this.game.height;
                e === this.prevPoint.x && i === this.prevPoint.y || (this.uniforms.mouse.value.x = e.toFixed(2),
                this.uniforms.mouse.value.y = i.toFixed(2),
                this.prevPoint.set(e, i))
            }
            this.uniforms.time.value = this.game.time.totalElapsedSeconds()
        },
        addToWorld: function(t, e, i, s, n, r) {
            void 0 === n && (n = 0),
            void 0 === r && (r = 0),
            null != i ? this.width = i : i = this.width,
            null != s ? this.height = s : s = this.height;
            var o = this.game.add.image(t, e, "__default");
            return o.width = i,
            o.height = s,
            o.anchor.set(n, r),
            o.filters = [this],
            o
        },
        destroy: function() {
            this.game = null
        }
    },
    H.Filter.prototype.constructor = H.Filter,
    Object.defineProperty(H.Filter.prototype, "width", {
        get: function() {
            return this.uniforms.resolution.value.x
        },
        set: function(t) {
            this.uniforms.resolution.value.x = t
        }
    }),
    Object.defineProperty(H.Filter.prototype, "height", {
        get: function() {
            return this.uniforms.resolution.value.y
        },
        set: function(t) {
            this.uniforms.resolution.value.y = t
        }
    }),
    H.Plugin = function(t, e) {
        void 0 === e && (e = null),
        this.game = t,
        this.parent = e,
        this.active = !1,
        this.visible = !1,
        this.hasPreUpdate = !1,
        this.hasUpdate = !1,
        this.hasPostUpdate = !1,
        this.hasRender = !1,
        this.hasPostRender = !1
    }
    ,
    H.Plugin.prototype = {
        preUpdate: function() {},
        update: function() {},
        render: function() {},
        postRender: function() {},
        destroy: function() {
            this.game = null,
            this.parent = null,
            this.active = !1,
            this.visible = !1
        }
    },
    H.Plugin.prototype.constructor = H.Plugin,
    H.PluginManager = function(t) {
        this.game = t,
        this.plugins = [],
        this._len = 0,
        this._i = 0
    }
    ,
    H.PluginManager.prototype = {
        add: function(t) {
            var e = Array.prototype.slice.call(arguments, 1)
              , i = !1;
            return "function" == typeof t ? t = new t(this.game,this) : (t.game = this.game,
            t.parent = this),
            "function" == typeof t.preUpdate && (i = t.hasPreUpdate = !0),
            "function" == typeof t.update && (i = t.hasUpdate = !0),
            "function" == typeof t.postUpdate && (i = t.hasPostUpdate = !0),
            "function" == typeof t.render && (i = t.hasRender = !0),
            "function" == typeof t.postRender && (i = t.hasPostRender = !0),
            i ? ((t.hasPreUpdate || t.hasUpdate || t.hasPostUpdate) && (t.active = !0),
            (t.hasRender || t.hasPostRender) && (t.visible = !0),
            this._len = this.plugins.push(t),
            "function" == typeof t.init && t.init.apply(t, e),
            t) : null
        },
        remove: function(t, e) {
            for (void 0 === e && (e = !0),
            this._i = this._len; this._i--; )
                if (this.plugins[this._i] === t)
                    return e && t.destroy(),
                    this.plugins.splice(this._i, 1),
                    void this._len--
        },
        removeAll: function() {
            for (this._i = this._len; this._i--; )
                this.plugins[this._i].destroy();
            this.plugins.length = 0,
            this._len = 0
        },
        preUpdate: function() {
            for (this._i = this._len; this._i--; )
                this.plugins[this._i].active && this.plugins[this._i].hasPreUpdate && this.plugins[this._i].preUpdate()
        },
        update: function() {
            for (this._i = this._len; this._i--; )
                this.plugins[this._i].active && this.plugins[this._i].hasUpdate && this.plugins[this._i].update()
        },
        postUpdate: function() {
            for (this._i = this._len; this._i--; )
                this.plugins[this._i].active && this.plugins[this._i].hasPostUpdate && this.plugins[this._i].postUpdate()
        },
        render: function() {
            for (this._i = this._len; this._i--; )
                this.plugins[this._i].visible && this.plugins[this._i].hasRender && this.plugins[this._i].render()
        },
        postRender: function() {
            for (this._i = this._len; this._i--; )
                this.plugins[this._i].visible && this.plugins[this._i].hasPostRender && this.plugins[this._i].postRender()
        },
        destroy: function() {
            this.removeAll(),
            this.game = null
        }
    },
    H.PluginManager.prototype.constructor = H.PluginManager,
    H.Stage = function(t) {
        this.game = t,
        PIXI.DisplayObjectContainer.call(this),
        this.name = "_stage_root",
        this.disableVisibilityChange = !1,
        this.exists = !0,
        this.worldTransform = new PIXI.Matrix,
        (this.stage = this).currentRenderOrderID = 0,
        this._hiddenVar = "hidden",
        this._onChange = null,
        this._bgColor = {
            r: 0,
            g: 0,
            b: 0,
            a: 0,
            color: 0,
            rgba: "#000000"
        },
        this.game.transparent || (this._bgColor.a = 1),
        t.config && this.parseConfig(t.config)
    }
    ,
    H.Stage.prototype = Object.create(PIXI.DisplayObjectContainer.prototype),
    H.Stage.prototype.constructor = H.Stage,
    H.Stage.prototype.parseConfig = function(t) {
        t.disableVisibilityChange && (this.disableVisibilityChange = t.disableVisibilityChange),
        t.backgroundColor && this.setBackgroundColor(t.backgroundColor)
    }
    ,
    H.Stage.prototype.boot = function() {
        H.DOM.getOffset(this.game.canvas, this.offset),
        H.Canvas.setUserSelect(this.game.canvas, "none"),
        H.Canvas.setTouchAction(this.game.canvas, "none"),
        this.checkVisibility()
    }
    ,
    H.Stage.prototype.preUpdate = function() {
        for (var t = this.currentRenderOrderID = 0; t < this.children.length; ) {
            var e = this.children[t];
            e.preUpdate(),
            this === e.parent && t++
        }
    }
    ,
    H.Stage.prototype.update = function() {
        for (var t = this.children.length; t--; )
            this.children[t].update()
    }
    ,
    H.Stage.prototype.postUpdate = function() {
        this.game.camera.update(),
        this.game.camera.target && (this.game.camera.target.postUpdate(),
        this.updateTransform(),
        this.game.camera.updateTarget());
        for (var t = 0; t < this.children.length; t++)
            this.children[t].postUpdate();
        this.updateTransform()
    }
    ,
    H.Stage.prototype.updateTransform = function() {
        this.worldAlpha = 1;
        for (var t = 0; t < this.children.length; t++)
            this.children[t].updateTransform()
    }
    ,
    H.Stage.prototype.checkVisibility = function() {
        void 0 !== document.hidden ? this._hiddenVar = "visibilitychange" : void 0 !== document.webkitHidden ? this._hiddenVar = "webkitvisibilitychange" : void 0 !== document.mozHidden ? this._hiddenVar = "mozvisibilitychange" : void 0 !== document.msHidden ? this._hiddenVar = "msvisibilitychange" : this._hiddenVar = null;
        var e = this;
        this._onChange = function(t) {
            return e.visibilityChange(t)
        }
        ,
        this._onClick = function(t) {
            document.hasFocus() || e.visibilityChange(t)
        }
        ,
        this._hiddenVar && document.addEventListener(this._hiddenVar, this._onChange, !1),
        window.onblur = this._onChange,
        window.onfocus = this._onChange,
        window.onpagehide = this._onChange,
        window.onpageshow = this._onChange,
        window.addEventListener("click", this._onClick),
        this.game.device.cocoonJSApp && (CocoonJS.App.onSuspended.addEventListener(function() {
            H.Stage.prototype.visibilityChange.call(e, {
                type: "pause"
            })
        }),
        CocoonJS.App.onActivated.addEventListener(function() {
            H.Stage.prototype.visibilityChange.call(e, {
                type: "resume"
            })
        }))
    }
    ,
    H.Stage.prototype.visibilityChange = function(t) {
        switch (t.type) {
        case "blur":
        case "pagehide":
            return void this.game.focusLoss(t);
        case "click":
        case "focus":
        case "pageshow":
            return void this.game.focusGain(t)
        }
        this.disableVisibilityChange || (document.hidden || document.mozHidden || document.msHidden || document.webkitHidden || "pause" === t.type ? this.game.gamePaused(t) : this.game.gameResumed(t))
    }
    ,
    H.Stage.prototype.setBackgroundColor = function(t) {
        this.game.transparent || (H.Color.valueToColor(t, this._bgColor),
        H.Color.updateColor(this._bgColor),
        this._bgColor.r /= 255,
        this._bgColor.g /= 255,
        this._bgColor.b /= 255,
        this._bgColor.a = 1)
    }
    ,
    H.Stage.prototype.destroy = function() {
        this._hiddenVar && document.removeEventListener(this._hiddenVar, this._onChange, !1),
        window.onpagehide = null,
        window.onpageshow = null,
        window.onblur = null,
        window.onfocus = null,
        window.removeEventListener("click", this._onClick)
    }
    ,
    Object.defineProperty(H.Stage.prototype, "backgroundColor", {
        get: function() {
            return this._bgColor.color
        },
        set: function(t) {
            this.setBackgroundColor(t)
        }
    }),
    Object.defineProperty(H.Stage.prototype, "smoothed", {
        get: function() {
            return PIXI.scaleModes.DEFAULT === PIXI.scaleModes.LINEAR
        },
        set: function(t) {
            PIXI.scaleModes.DEFAULT = t ? PIXI.scaleModes.LINEAR : PIXI.scaleModes.NEAREST
        }
    }),
    H.Group = function(t, e, i, s, n, r) {
        void 0 === s && (s = !1),
        void 0 === n && (n = !1),
        void 0 === r && (r = H.Physics.ARCADE),
        this.game = t,
        void 0 === e && (e = t.world),
        this.name = i || "group",
        this.z = 0,
        PIXI.DisplayObjectContainer.call(this),
        s ? (this.game.stage.addChild(this),
        this.z = this.game.stage.children.length) : e && (e.addChild(this),
        this.z = e.children.length),
        this.type = H.GROUP,
        this.physicsType = H.GROUP,
        this.alive = !0,
        this.exists = !0,
        this.ignoreDestroy = !1,
        this.pendingDestroy = !1,
        this.classType = H.Sprite,
        this.cursor = null,
        this.inputEnableChildren = !1,
        this.onChildInputDown = new H.Signal,
        this.onChildInputUp = new H.Signal,
        this.onChildInputOver = new H.Signal,
        this.onChildInputOut = new H.Signal,
        this.enableBody = n,
        this.enableBodyDebug = !1,
        this.physicsBodyType = r,
        this.physicsSortDirection = null,
        this.onDestroy = new H.Signal,
        this.cursorIndex = 0,
        this.fixedToCamera = !1,
        this.cameraOffset = new H.Point,
        this.hash = [],
        this._sortProperty = "z"
    }
    ,
    H.Group.prototype = Object.create(PIXI.DisplayObjectContainer.prototype),
    H.Group.prototype.constructor = H.Group,
    H.Group.RETURN_NONE = 0,
    H.Group.RETURN_TOTAL = 1,
    H.Group.RETURN_CHILD = 2,
    H.Group.RETURN_ALL = 3,
    H.Group.SORT_ASCENDING = -1,
    H.Group.SORT_DESCENDING = 1,
    H.Group.prototype.add = function(t, e, i) {
        return void 0 === e && (e = !1),
        t.parent === this || (t.body && t.parent && t.parent.hash && t.parent.removeFromHash(t),
        void 0 === i ? (t.z = this.children.length,
        this.addChild(t)) : (this.addChildAt(t, i),
        this.updateZ()),
        this.enableBody && t.hasOwnProperty("body") && null === t.body ? this.game.physics.enable(t, this.physicsBodyType) : t.body && this.addToHash(t),
        !this.inputEnableChildren || t.input && !t.inputEnabled || (t.inputEnabled = !0),
        !e && t.events && t.events.onAddedToGroup$dispatch(t, this),
        null === this.cursor && (this.cursor = t)),
        t
    }
    ,
    H.Group.prototype.addAt = function(t, e, i) {
        this.add(t, i, e)
    }
    ,
    H.Group.prototype.addToHash = function(t) {
        return t.parent === this && -1 === this.hash.indexOf(t) && (this.hash.push(t),
        !0)
    }
    ,
    H.Group.prototype.removeFromHash = function(t) {
        if (t) {
            var e = this.hash.indexOf(t);
            if (-1 !== e)
                return this.hash.splice(e, 1),
                !0
        }
        return !1
    }
    ,
    H.Group.prototype.addMultiple = function(t, e) {
        if (t instanceof H.Group)
            t.moveAll(this, e);
        else if (Array.isArray(t))
            for (var i = 0; i < t.length; i++)
                this.add(t[i], e);
        return t
    }
    ,
    H.Group.prototype.getAt = function(t) {
        return t < 0 || t >= this.children.length ? -1 : this.getChildAt(t)
    }
    ,
    H.Group.prototype.create = function(t, e, i, s, n, r) {
        void 0 === n && (n = !0);
        var o = new this.classType(this.game,t,e,i,s);
        return o.exists = n,
        o.visible = n,
        o.alive = n,
        this.add(o, !1, r)
    }
    ,
    H.Group.prototype.createMultiple = function(s, t, e, n) {
        void 0 === e && (e = 0),
        void 0 === n && (n = !1),
        Array.isArray(t) || (t = [t]),
        Array.isArray(e) || (e = [e]);
        var r = this
          , o = [];
        return t.forEach(function(i) {
            e.forEach(function(t) {
                for (var e = 0; e < s; e++)
                    o.push(r.create(0, 0, i, t, n))
            })
        }),
        o
    }
    ,
    H.Group.prototype.updateZ = function() {
        for (var t = this.children.length; t--; )
            this.children[t].z = t
    }
    ,
    H.Group.prototype.align = function(t, e, i, s, n, r) {
        if (void 0 === n && (n = H.TOP_LEFT),
        void 0 === r && (r = 0),
        0 === this.children.length || r > this.children.length || -1 === t && -1 === e)
            return !1;
        for (var o = new H.Rectangle(0,0,i,s), a = t * i, h = e * s, l = r; l < this.children.length; l++) {
            var c = this.children[l];
            if (c.alignIn)
                if (c.alignIn(o, n),
                -1 === t)
                    o.y += s,
                    o.y === h && (o.x += i,
                    o.y = 0);
                else if (-1 === e)
                    o.x += i,
                    o.x === a && (o.x = 0,
                    o.y += s);
                else if (o.x += i,
                o.x === a && (o.x = 0,
                o.y += s,
                o.y === h))
                    return !0
        }
        return !0
    }
    ,
    H.Group.prototype.resetCursor = function(t) {
        if (void 0 === t && (t = 0),
        t > this.children.length - 1 && (t = 0),
        this.cursor)
            return this.cursorIndex = t,
            this.cursor = this.children[this.cursorIndex],
            this.cursor
    }
    ,
    H.Group.prototype.next = function() {
        if (this.cursor)
            return this.cursorIndex >= this.children.length - 1 ? this.cursorIndex = 0 : this.cursorIndex++,
            this.cursor = this.children[this.cursorIndex],
            this.cursor
    }
    ,
    H.Group.prototype.previous = function() {
        if (this.cursor)
            return 0 === this.cursorIndex ? this.cursorIndex = this.children.length - 1 : this.cursorIndex--,
            this.cursor = this.children[this.cursorIndex],
            this.cursor
    }
    ,
    H.Group.prototype.swap = function(t, e) {
        this.swapChildren(t, e),
        this.updateZ()
    }
    ,
    H.Group.prototype.bringToTop = function(t) {
        return t.parent === this && this.getIndex(t) < this.children.length && (this.remove(t, !1, !0),
        this.add(t, !0)),
        t
    }
    ,
    H.Group.prototype.sendToBack = function(t) {
        return t.parent === this && 0 < this.getIndex(t) && (this.remove(t, !1, !0),
        this.addAt(t, 0, !0)),
        t
    }
    ,
    H.Group.prototype.moveUp = function(t) {
        if (t.parent === this && this.getIndex(t) < this.children.length - 1) {
            var e = this.getIndex(t)
              , i = this.getAt(e + 1);
            i && this.swap(t, i)
        }
        return t
    }
    ,
    H.Group.prototype.moveDown = function(t) {
        if (t.parent === this && 0 < this.getIndex(t)) {
            var e = this.getIndex(t)
              , i = this.getAt(e - 1);
            i && this.swap(t, i)
        }
        return t
    }
    ,
    H.Group.prototype.xy = function(t, e, i) {
        if (t < 0 || t > this.children.length)
            return -1;
        this.getChildAt(t).x = e,
        this.getChildAt(t).y = i
    }
    ,
    H.Group.prototype.reverse = function() {
        this.children.reverse(),
        this.updateZ()
    }
    ,
    H.Group.prototype.getIndex = function(t) {
        return this.children.indexOf(t)
    }
    ,
    H.Group.prototype.getByName = function(t) {
        for (var e = 0; e < this.children.length; e++)
            if (this.children[e].name === t)
                return this.children[e];
        return null
    }
    ,
    H.Group.prototype.replace = function(t, e) {
        var i = this.getIndex(t);
        if (-1 !== i)
            return e.parent && (e.parent instanceof H.Group ? e.parent.remove(e) : e.parent.removeChild(e)),
            this.remove(t),
            this.addAt(e, i),
            t
    }
    ,
    H.Group.prototype.hasProperty = function(t, e) {
        var i = e.length;
        return 1 === i && e[0]in t || 2 === i && e[0]in t && e[1]in t[e[0]] || 3 === i && e[0]in t && e[1]in t[e[0]] && e[2]in t[e[0]][e[1]] || 4 === i && e[0]in t && e[1]in t[e[0]] && e[2]in t[e[0]][e[1]] && e[3]in t[e[0]][e[1]][e[2]]
    }
    ,
    H.Group.prototype.setProperty = function(t, e, i, s, n) {
        if (void 0 === n && (n = !1),
        s = s || 0,
        !this.hasProperty(t, e) && (!n || 0 < s))
            return !1;
        var r = e.length;
        return 1 === r ? 0 === s ? t[e[0]] = i : 1 === s ? t[e[0]] += i : 2 === s ? t[e[0]] -= i : 3 === s ? t[e[0]] *= i : 4 === s && (t[e[0]] /= i) : 2 === r ? 0 === s ? t[e[0]][e[1]] = i : 1 === s ? t[e[0]][e[1]] += i : 2 === s ? t[e[0]][e[1]] -= i : 3 === s ? t[e[0]][e[1]] *= i : 4 === s && (t[e[0]][e[1]] /= i) : 3 === r ? 0 === s ? t[e[0]][e[1]][e[2]] = i : 1 === s ? t[e[0]][e[1]][e[2]] += i : 2 === s ? t[e[0]][e[1]][e[2]] -= i : 3 === s ? t[e[0]][e[1]][e[2]] *= i : 4 === s && (t[e[0]][e[1]][e[2]] /= i) : 4 === r && (0 === s ? t[e[0]][e[1]][e[2]][e[3]] = i : 1 === s ? t[e[0]][e[1]][e[2]][e[3]] += i : 2 === s ? t[e[0]][e[1]][e[2]][e[3]] -= i : 3 === s ? t[e[0]][e[1]][e[2]][e[3]] *= i : 4 === s && (t[e[0]][e[1]][e[2]][e[3]] /= i)),
        !0
    }
    ,
    H.Group.prototype.checkProperty = function(t, e, i, s) {
        return void 0 === s && (s = !1),
        !(!H.Utils.getProperty(t, e) && s) && H.Utils.getProperty(t, e) === i
    }
    ,
    H.Group.prototype.set = function(t, e, i, s, n, r, o) {
        if (void 0 === o && (o = !1),
        e = e.split("."),
        void 0 === s && (s = !1),
        void 0 === n && (n = !1),
        (!1 === s || s && t.alive) && (!1 === n || n && t.visible))
            return this.setProperty(t, e, i, r, o)
    }
    ,
    H.Group.prototype.setAll = function(t, e, i, s, n, r) {
        void 0 === i && (i = !1),
        void 0 === s && (s = !1),
        void 0 === r && (r = !1),
        t = t.split("."),
        n = n || 0;
        for (var o = 0; o < this.children.length; o++)
            (!i || i && this.children[o].alive) && (!s || s && this.children[o].visible) && this.setProperty(this.children[o], t, e, n, r)
    }
    ,
    H.Group.prototype.setAllChildren = function(t, e, i, s, n, r) {
        void 0 === i && (i = !1),
        void 0 === s && (s = !1),
        void 0 === r && (r = !1),
        n = n || 0;
        for (var o = 0; o < this.children.length; o++)
            (!i || i && this.children[o].alive) && (!s || s && this.children[o].visible) && (this.children[o]instanceof H.Group ? this.children[o].setAllChildren(t, e, i, s, n, r) : this.setProperty(this.children[o], t.split("."), e, n, r))
    }
    ,
    H.Group.prototype.checkAll = function(t, e, i, s, n) {
        void 0 === i && (i = !1),
        void 0 === s && (s = !1),
        void 0 === n && (n = !1);
        for (var r = 0; r < this.children.length; r++)
            if ((!i || i && this.children[r].alive) && (!s || s && this.children[r].visible) && !this.checkProperty(this.children[r], t, e, n))
                return !1;
        return !0
    }
    ,
    H.Group.prototype.addAll = function(t, e, i, s) {
        this.setAll(t, e, i, s, 1)
    }
    ,
    H.Group.prototype.subAll = function(t, e, i, s) {
        this.setAll(t, e, i, s, 2)
    }
    ,
    H.Group.prototype.multiplyAll = function(t, e, i, s) {
        this.setAll(t, e, i, s, 3)
    }
    ,
    H.Group.prototype.divideAll = function(t, e, i, s) {
        this.setAll(t, e, i, s, 4)
    }
    ,
    H.Group.prototype.callAllExists = function(t, e) {
        var i;
        if (2 < arguments.length) {
            i = [];
            for (var s = 2; s < arguments.length; s++)
                i.push(arguments[s])
        }
        for (s = 0; s < this.children.length; s++)
            this.children[s].exists === e && this.children[s][t] && this.children[s][t].apply(this.children[s], i)
    }
    ,
    H.Group.prototype.callbackFromArray = function(t, e, i) {
        if (1 === i) {
            if (t[e[0]])
                return t[e[0]]
        } else if (2 === i) {
            if (t[e[0]][e[1]])
                return t[e[0]][e[1]]
        } else if (3 === i) {
            if (t[e[0]][e[1]][e[2]])
                return t[e[0]][e[1]][e[2]]
        } else if (4 === i) {
            if (t[e[0]][e[1]][e[2]][e[3]])
                return t[e[0]][e[1]][e[2]][e[3]]
        } else if (t[e])
            return t[e];
        return !1
    }
    ,
    H.Group.prototype.callAll = function(t, e) {
        if (void 0 !== t) {
            var i, s = (t = t.split(".")).length;
            if (null == e || "" === e)
                e = null;
            else if ("string" == typeof e)
                var n = (e = e.split(".")).length;
            if (2 < arguments.length) {
                i = [];
                for (var r = 2; r < arguments.length; r++)
                    i.push(arguments[r])
            }
            var o = null
              , a = null;
            for (r = 0; r < this.children.length; r++)
                o = this.callbackFromArray(this.children[r], t, s),
                e && o ? (a = this.callbackFromArray(this.children[r], e, n),
                o && o.apply(a, i)) : o && o.apply(this.children[r], i)
        }
    }
    ,
    H.Group.prototype.preUpdate = function() {
        if (this.pendingDestroy)
            return this.destroy(),
            !1;
        if (!this.exists || !this.parent.exists)
            return !(this.renderOrderID = -1);
        for (var t = 0; t < this.children.length; t++)
            this.children[t].preUpdate();
        return !0
    }
    ,
    H.Group.prototype.update = function() {
        for (var t = this.children.length; t--; )
            this.children[t].update()
    }
    ,
    H.Group.prototype.postUpdate = function() {
        this.fixedToCamera && (this.x = this.game.camera.view.x + this.cameraOffset.x,
        this.y = this.game.camera.view.y + this.cameraOffset.y);
        for (var t = 0; t < this.children.length; t++)
            this.children[t].postUpdate()
    }
    ,
    H.Group.prototype.filter = function(t, e) {
        for (var i = -1, s = this.children.length, n = []; ++i < s; ) {
            var r = this.children[i];
            (!e || e && r.exists) && t(r, i, this.children) && n.push(r)
        }
        return new H.ArraySet(n)
    }
    ,
    H.Group.prototype.forEach = function(t, e, i) {
        if (void 0 === i && (i = !1),
        arguments.length <= 3)
            for (var s = 0; s < this.children.length; s++)
                (!i || i && this.children[s].exists) && t.call(e, this.children[s]);
        else {
            var n = [null];
            for (s = 3; s < arguments.length; s++)
                n.push(arguments[s]);
            for (s = 0; s < this.children.length; s++)
                (!i || i && this.children[s].exists) && (n[0] = this.children[s],
                t.apply(e, n))
        }
    }
    ,
    H.Group.prototype.forEachExists = function(t, e) {
        var i;
        if (2 < arguments.length) {
            i = [null];
            for (var s = 2; s < arguments.length; s++)
                i.push(arguments[s])
        }
        this.iterate("exists", !0, H.Group.RETURN_TOTAL, t, e, i)
    }
    ,
    H.Group.prototype.forEachAlive = function(t, e) {
        var i;
        if (2 < arguments.length) {
            i = [null];
            for (var s = 2; s < arguments.length; s++)
                i.push(arguments[s])
        }
        this.iterate("alive", !0, H.Group.RETURN_TOTAL, t, e, i)
    }
    ,
    H.Group.prototype.forEachDead = function(t, e) {
        var i;
        if (2 < arguments.length) {
            i = [null];
            for (var s = 2; s < arguments.length; s++)
                i.push(arguments[s])
        }
        this.iterate("alive", !1, H.Group.RETURN_TOTAL, t, e, i)
    }
    ,
    H.Group.prototype.sort = function(t, e) {
        this.children.length < 2 || (void 0 === t && (t = "z"),
        void 0 === e && (e = H.Group.SORT_ASCENDING),
        this._sortProperty = t,
        e === H.Group.SORT_ASCENDING ? this.children.sort(this.ascendingSortHandler.bind(this)) : this.children.sort(this.descendingSortHandler.bind(this)),
        this.updateZ())
    }
    ,
    H.Group.prototype.customSort = function(t, e) {
        this.children.length < 2 || (this.children.sort(t.bind(e)),
        this.updateZ())
    }
    ,
    H.Group.prototype.ascendingSortHandler = function(t, e) {
        return t[this._sortProperty] < e[this._sortProperty] ? -1 : t[this._sortProperty] > e[this._sortProperty] ? 1 : t.z < e.z ? -1 : 1
    }
    ,
    H.Group.prototype.descendingSortHandler = function(t, e) {
        return t[this._sortProperty] < e[this._sortProperty] ? 1 : t[this._sortProperty] > e[this._sortProperty] ? -1 : 0
    }
    ,
    H.Group.prototype.iterate = function(t, e, i, s, n, r) {
        if (0 === this.children.length) {
            if (i === H.Group.RETURN_TOTAL)
                return 0;
            if (i === H.Group.RETURN_ALL)
                return []
        }
        var o = 0;
        if (i === H.Group.RETURN_ALL)
            var a = [];
        for (var h = 0; h < this.children.length; h++)
            if (this.children[h][t] === e) {
                if (o++,
                s && (r ? (r[0] = this.children[h],
                s.apply(n, r)) : s.call(n, this.children[h])),
                i === H.Group.RETURN_CHILD)
                    return this.children[h];
                i === H.Group.RETURN_ALL && a.push(this.children[h])
            }
        return i === H.Group.RETURN_TOTAL ? o : i === H.Group.RETURN_ALL ? a : null
    }
    ,
    H.Group.prototype.getFirstExists = function(t, e, i, s, n, r) {
        void 0 === e && (e = !1),
        "boolean" != typeof t && (t = !0);
        var o = this.iterate("exists", t, H.Group.RETURN_CHILD);
        return null === o && e ? this.create(i, s, n, r) : this.resetChild(o, i, s, n, r)
    }
    ,
    H.Group.prototype.getFirstAlive = function(t, e, i, s, n) {
        void 0 === t && (t = !1);
        var r = this.iterate("alive", !0, H.Group.RETURN_CHILD);
        return null === r && t ? this.create(e, i, s, n) : this.resetChild(r, e, i, s, n)
    }
    ,
    H.Group.prototype.getFirstDead = function(t, e, i, s, n) {
        void 0 === t && (t = !1);
        var r = this.iterate("alive", !1, H.Group.RETURN_CHILD);
        return null === r && t ? this.create(e, i, s, n) : this.resetChild(r, e, i, s, n)
    }
    ,
    H.Group.prototype.resetChild = function(t, e, i, s, n) {
        return null === t ? null : (void 0 === e && (e = null),
        void 0 === i && (i = null),
        null !== e && null !== i && t.reset(e, i),
        void 0 !== s && t.loadTexture(s, n),
        t)
    }
    ,
    H.Group.prototype.getTop = function() {
        if (0 < this.children.length)
            return this.children[this.children.length - 1]
    }
    ,
    H.Group.prototype.getBottom = function() {
        if (0 < this.children.length)
            return this.children[0]
    }
    ,
    H.Group.prototype.getClosestTo = function(t, e, i) {
        for (var s = Number.MAX_VALUE, n = 0, r = null, o = 0; o < this.children.length; o++) {
            var a = this.children[o];
            a.exists && (n = Math.abs(H.Point.distance(t, a))) < s && (!e || e.call(i, a, n)) && (s = n,
            r = a)
        }
        return r
    }
    ,
    H.Group.prototype.getFurthestFrom = function(t, e, i) {
        for (var s = 0, n = 0, r = null, o = 0; o < this.children.length; o++) {
            var a = this.children[o];
            a.exists && (n = Math.abs(H.Point.distance(t, a))) > s && (!e || e.call(i, a, n)) && (s = n,
            r = a)
        }
        return r
    }
    ,
    H.Group.prototype.countLiving = function() {
        return this.iterate("alive", !0, H.Group.RETURN_TOTAL)
    }
    ,
    H.Group.prototype.countDead = function() {
        return this.iterate("alive", !1, H.Group.RETURN_TOTAL)
    }
    ,
    H.Group.prototype.getRandom = function(t, e) {
        return void 0 === t && (t = 0),
        void 0 === e && (e = this.children.length),
        0 === e ? null : H.ArrayUtils.getRandomItem(this.children, t, e)
    }
    ,
    H.Group.prototype.getRandomExists = function(t, e) {
        var i = this.getAll("exists", !0, t, e);
        return this.game.rnd.pick(i)
    }
    ,
    H.Group.prototype.getAll = function(t, e, i, s) {
        void 0 === i && (i = 0),
        void 0 === s && (s = this.children.length);
        for (var n = [], r = i; r < s; r++) {
            var o = this.children[r];
            t && o[t] === e && n.push(o)
        }
        return n
    }
    ,
    H.Group.prototype.remove = function(t, e, i) {
        if (void 0 === e && (e = !1),
        void 0 === i && (i = !1),
        0 === this.children.length || -1 === this.children.indexOf(t))
            return !1;
        i || !t.events || t.destroyPhase || t.events.onRemovedFromGroup$dispatch(t, this);
        var s = this.removeChild(t);
        return this.removeFromHash(t),
        this.updateZ(),
        this.cursor === t && this.next(),
        e && s && s.destroy(!0),
        !0
    }
    ,
    H.Group.prototype.moveAll = function(t, e) {
        if (void 0 === e && (e = !1),
        0 < this.children.length && t instanceof H.Group) {
            for (; t.add(this.children[0], e),
            0 < this.children.length; )
                ;
            this.hash = [],
            this.cursor = null
        }
        return t
    }
    ,
    H.Group.prototype.removeAll = function(t, e, i) {
        if (void 0 === t && (t = !1),
        void 0 === e && (e = !1),
        void 0 === i && (i = !1),
        0 !== this.children.length) {
            do {
                !e && this.children[0].events && this.children[0].events.onRemovedFromGroup$dispatch(this.children[0], this);
                var s = this.removeChild(this.children[0]);
                this.removeFromHash(s),
                t && s && s.destroy(!0, i)
            } while (0 < this.children.length);
            this.hash = [],
            this.cursor = null
        }
    }
    ,
    H.Group.prototype.removeBetween = function(t, e, i, s) {
        if (void 0 === e && (e = this.children.length - 1),
        void 0 === i && (i = !1),
        void 0 === s && (s = !1),
        0 !== this.children.length) {
            if (e < t || t < 0 || e > this.children.length)
                return !1;
            for (var n = e; t <= n; ) {
                !s && this.children[n].events && this.children[n].events.onRemovedFromGroup$dispatch(this.children[n], this);
                var r = this.removeChild(this.children[n]);
                this.removeFromHash(r),
                i && r && r.destroy(!0),
                this.cursor === this.children[n] && (this.cursor = null),
                n--
            }
            this.updateZ()
        }
    }
    ,
    H.Group.prototype.destroy = function(t, e) {
        null === this.game || this.ignoreDestroy || (void 0 === t && (t = !0),
        void 0 === e && (e = !1),
        this.onDestroy.dispatch(this, t, e),
        this.removeAll(t),
        this.cursor = null,
        this.filters = null,
        this.pendingDestroy = !1,
        e || (this.parent && this.parent.removeChild(this),
        this.game = null,
        this.exists = !1))
    }
    ,
    Object.defineProperty(H.Group.prototype, "total", {
        get: function() {
            return this.iterate("exists", !0, H.Group.RETURN_TOTAL)
        }
    }),
    Object.defineProperty(H.Group.prototype, "length", {
        get: function() {
            return this.children.length
        }
    }),
    Object.defineProperty(H.Group.prototype, "angle", {
        get: function() {
            return H.Math.radToDeg(this.rotation)
        },
        set: function(t) {
            this.rotation = H.Math.degToRad(t)
        }
    }),
    Object.defineProperty(H.Group.prototype, "centerX", {
        get: function() {
            return this.getBounds(this.parent).centerX
        },
        set: function(t) {
            var e = this.getBounds(this.parent)
              , i = this.x - e.x;
            this.x = t + i - e.halfWidth
        }
    }),
    Object.defineProperty(H.Group.prototype, "centerY", {
        get: function() {
            return this.getBounds(this.parent).centerY
        },
        set: function(t) {
            var e = this.getBounds(this.parent)
              , i = this.y - e.y;
            this.y = t + i - e.halfHeight
        }
    }),
    Object.defineProperty(H.Group.prototype, "left", {
        get: function() {
            return this.getBounds(this.parent).left
        },
        set: function(t) {
            var e = this.getBounds(this.parent)
              , i = this.x - e.x;
            this.x = t + i
        }
    }),
    Object.defineProperty(H.Group.prototype, "right", {
        get: function() {
            return this.getBounds(this.parent).right
        },
        set: function(t) {
            var e = this.getBounds(this.parent)
              , i = this.x - e.x;
            this.x = t + i - e.width
        }
    }),
    Object.defineProperty(H.Group.prototype, "top", {
        get: function() {
            return this.getBounds(this.parent).top
        },
        set: function(t) {
            var e = this.getBounds(this.parent)
              , i = this.y - e.y;
            this.y = t + i
        }
    }),
    Object.defineProperty(H.Group.prototype, "bottom", {
        get: function() {
            return this.getBounds(this.parent).bottom
        },
        set: function(t) {
            var e = this.getBounds(this.parent)
              , i = this.y - e.y;
            this.y = t + i - e.height
        }
    }),
    H.World = function(t) {
        H.Group.call(this, t, null, "__world", !1),
        this.bounds = new H.Rectangle(0,0,t.width,t.height),
        this.camera = null,
        this._definedSize = !1,
        this._width = t.width,
        this._height = t.height,
        this.game.state.onStateChange.add(this.stateChange, this)
    }
    ,
    H.World.prototype = Object.create(H.Group.prototype),
    H.World.prototype.constructor = H.World,
    H.World.prototype.boot = function() {
        this.camera = new H.Camera(this.game,0,0,0,this.game.width,this.game.height),
        this.game.stage.addChild(this),
        this.camera.boot()
    }
    ,
    H.World.prototype.stateChange = function() {
        this.x = 0,
        this.y = 0,
        this.camera.reset()
    }
    ,
    H.World.prototype.setBounds = function(t, e, i, s) {
        this._definedSize = !0,
        this._width = i,
        this._height = s,
        this.bounds.setTo(t, e, i, s),
        this.x = t,
        this.y = e,
        this.camera.bounds && this.camera.bounds.setTo(t, e, Math.max(i, this.game.width), Math.max(s, this.game.height)),
        this.game.physics.setBoundsToWorld()
    }
    ,
    H.World.prototype.resize = function(t, e) {
        this._definedSize && (t < this._width && (t = this._width),
        e < this._height && (e = this._height)),
        this.bounds.width = t,
        this.bounds.height = e,
        this.game.camera.setBoundsToWorld(),
        this.game.physics.setBoundsToWorld()
    }
    ,
    H.World.prototype.shutdown = function() {
        this.destroy(!0, !0)
    }
    ,
    H.World.prototype.wrap = function(t, e, i, s, n) {
        void 0 === e && (e = 0),
        void 0 === i && (i = !1),
        void 0 === s && (s = !0),
        void 0 === n && (n = !0),
        i ? (t.getBounds(),
        s && (t.x + t._currentBounds.width < this.bounds.x ? t.x = this.bounds.right : t.x > this.bounds.right && (t.x = this.bounds.left)),
        n && (t.y + t._currentBounds.height < this.bounds.top ? t.y = this.bounds.bottom : t.y > this.bounds.bottom && (t.y = this.bounds.top))) : (s && t.x + e < this.bounds.x ? t.x = this.bounds.right + e : s && t.x - e > this.bounds.right && (t.x = this.bounds.left - e),
        n && t.y + e < this.bounds.top ? t.y = this.bounds.bottom + e : n && t.y - e > this.bounds.bottom && (t.y = this.bounds.top - e))
    }
    ,
    Object.defineProperty(H.World.prototype, "width", {
        get: function() {
            return this.bounds.width
        },
        set: function(t) {
            t < this.game.width && (t = this.game.width),
            this.bounds.width = t,
            this._width = t,
            this._definedSize = !0
        }
    }),
    Object.defineProperty(H.World.prototype, "height", {
        get: function() {
            return this.bounds.height
        },
        set: function(t) {
            t < this.game.height && (t = this.game.height),
            this.bounds.height = t,
            this._height = t,
            this._definedSize = !0
        }
    }),
    Object.defineProperty(H.World.prototype, "centerX", {
        get: function() {
            return this.bounds.halfWidth + this.bounds.x
        }
    }),
    Object.defineProperty(H.World.prototype, "centerY", {
        get: function() {
            return this.bounds.halfHeight + this.bounds.y
        }
    }),
    Object.defineProperty(H.World.prototype, "randomX", {
        get: function() {
            return this.bounds.x < 0 ? this.game.rnd.between(this.bounds.x, this.bounds.width - Math.abs(this.bounds.x)) : this.game.rnd.between(this.bounds.x, this.bounds.width)
        }
    }),
    Object.defineProperty(H.World.prototype, "randomY", {
        get: function() {
            return this.bounds.y < 0 ? this.game.rnd.between(this.bounds.y, this.bounds.height - Math.abs(this.bounds.y)) : this.game.rnd.between(this.bounds.y, this.bounds.height)
        }
    }),
    H.Game = function(t, e, i, s, n, r, o, a) {
        return this.id = H.GAMES.push(this) - 1,
        this.config = null,
        this.physicsConfig = a,
        this.parent = "",
        this.width = 800,
        this.height = 600,
        this.resolution = 1,
        this._width = 800,
        this._height = 600,
        this.transparent = !1,
        this.antialias = !0,
        this.preserveDrawingBuffer = !1,
        this.clearBeforeRender = !0,
        this.renderer = null,
        this.renderType = H.AUTO,
        this.state = null,
        this.isBooted = !1,
        this.isRunning = !1,
        this.raf = null,
        this.add = null,
        this.make = null,
        this.cache = null,
        this.input = null,
        this.load = null,
        this.math = null,
        this.net = null,
        this.scale = null,
        this.sound = null,
        this.stage = null,
        this.time = null,
        this.tweens = null,
        this.world = null,
        this.physics = null,
        this.plugins = null,
        this.rnd = null,
        this.device = H.Device,
        this.camera = null,
        this.canvas = null,
        this.context = null,
        this.debug = null,
        this.particles = null,
        this.create = null,
        this.lockRender = !1,
        this.stepping = !1,
        this.pendingStep = !1,
        this.stepCount = 0,
        this.onPause = null,
        this.onResume = null,
        this.onBlur = null,
        this.onFocus = null,
        this._paused = !1,
        this._codePaused = !1,
        this.currentUpdateID = 0,
        this.updatesThisFrame = 1,
        this._deltaTime = 0,
        this._lastCount = 0,
        this._spiraling = 0,
        this._kickstart = !0,
        this.fpsProblemNotifier = new H.Signal,
        this.forceSingleUpdate = !0,
        this._nextFpsNotification = 0,
        1 === arguments.length && "object" == typeof t ? this.parseConfig(t) : (this.config = {
            enableDebug: !0
        },
        void 0 !== t && (this._width = t),
        void 0 !== e && (this._height = e),
        void 0 !== i && (this.renderType = i),
        void 0 !== s && (this.parent = s),
        void 0 !== r && (this.transparent = r),
        void 0 !== o && (this.antialias = o),
        this.rnd = new H.RandomDataGenerator([(Date.now() * Math.random()).toString()]),
        this.state = new H.StateManager(this,n)),
        this.device.whenReady(this.boot, this),
        this
    }
    ,
    H.Game.prototype = {
        parseConfig: function(t) {
            void 0 === (this.config = t).enableDebug && (this.config.enableDebug = !0),
            t.width && (this._width = t.width),
            t.height && (this._height = t.height),
            t.renderer && (this.renderType = t.renderer),
            t.parent && (this.parent = t.parent),
            void 0 !== t.transparent && (this.transparent = t.transparent),
            void 0 !== t.antialias && (this.antialias = t.antialias),
            t.resolution && (this.resolution = t.resolution),
            void 0 !== t.preserveDrawingBuffer && (this.preserveDrawingBuffer = t.preserveDrawingBuffer),
            t.physicsConfig && (this.physicsConfig = t.physicsConfig);
            var e = [(Date.now() * Math.random()).toString()];
            t.seed && (e = t.seed),
            this.rnd = new H.RandomDataGenerator(e);
            var i = null;
            t.state && (i = t.state),
            this.state = new H.StateManager(this,i)
        },
        boot: function() {
            this.isBooted || (this.onPause = new H.Signal,
            this.onResume = new H.Signal,
            this.onBlur = new H.Signal,
            this.onFocus = new H.Signal,
            this.isBooted = !0,
            (PIXI.game = this).math = H.Math,
            this.scale = new H.ScaleManager(this,this._width,this._height),
            this.stage = new H.Stage(this),
            this.setUpRenderer(),
            this.world = new H.World(this),
            this.add = new H.GameObjectFactory(this),
            this.make = new H.GameObjectCreator(this),
            this.cache = new H.Cache(this),
            this.load = new H.Loader(this),
            this.time = new H.Time(this),
            this.tweens = new H.TweenManager(this),
            this.input = new H.Input(this),
            this.sound = new H.SoundManager(this),
            this.physics = new H.Physics(this,this.physicsConfig),
            this.particles = new H.Particles(this),
            this.create = new H.Create(this),
            this.plugins = new H.PluginManager(this),
            this.net = new H.Net(this),
            this.time.boot(),
            this.stage.boot(),
            this.world.boot(),
            this.scale.boot(),
            this.input.boot(),
            this.sound.boot(),
            this.state.boot(),
            this.config.enableDebug ? (this.debug = new H.Utils.Debug(this),
            this.debug.boot()) : this.debug = {
                preUpdate: function() {},
                update: function() {},
                reset: function() {}
            },
            this.showDebugHeader(),
            this.isRunning = !0,
            this.config && this.config.forceSetTimeOut ? this.raf = new H.RequestAnimationFrame(this,this.config.forceSetTimeOut) : this.raf = new H.RequestAnimationFrame(this,!1),
            this._kickstart = !0,
            window.focus && (!window.PhaserGlobal || window.PhaserGlobal && !window.PhaserGlobal.stopFocus) && window.focus(),
            this.raf.start())
        },
        showDebugHeader: function() {
            if (!window.PhaserGlobal || !window.PhaserGlobal.hideBanner) {
                var t = H.VERSION
                  , e = "Canvas"
                  , i = "HTML Audio"
                  , s = 1;
                if (this.renderType === H.WEBGL ? (e = "WebGL",
                s++) : this.renderType === H.HEADLESS && (e = "Headless"),
                this.device.webAudio && (i = "WebAudio",
                s++),
                this.device.chrome)
                    for (var n = ["%c %c %c @azerion/phaser v" + t + " | Pixi.js | " + e + " | " + i + "  %c %c %c https://github.com/azerion / https://www.azerion.com %c%c%c", "background: #7ab3eb", "background: #378ce1", "color: #ffffff; background: #207cd8;", "background: #378ce1", "background: #7ab3eb", "background: #ffffff"], r = 0; r < 3; r++)
                        r < s ? n.push("color: #ff2424; background: #fff") : n.push("color: #959595; background: #fff");
                else
                    window.console
            }
        },
        setUpRenderer: function() {
            if (this.config.canvas ? this.canvas = this.config.canvas : this.canvas = H.Canvas.create(this, this.width, this.height, this.config.canvasID, !0),
            this.config.canvasStyle ? this.canvas.style = this.config.canvasStyle : this.canvas.style["-webkit-full-screen"] = "width: 100%; height: 100%",
            this.renderType === H.HEADLESS || this.renderType === H.CANVAS || this.renderType === H.AUTO && !this.device.webGL) {
                if (!this.device.canvas)
                    throw new Error("Phaser.Game - Cannot create Canvas or WebGL context, aborting.");
                this.renderType = H.CANVAS,
                this.renderer = new PIXI.CanvasRenderer(this),
                this.context = this.renderer.context
            } else
                this.renderType = H.WEBGL,
                this.renderer = new PIXI.WebGLRenderer(this),
                this.context = null,
                this.canvas.addEventListener("webglcontextlost", this.contextLost.bind(this), !1),
                this.canvas.addEventListener("webglcontextrestored", this.contextRestored.bind(this), !1);
            this.device.cocoonJS && (this.canvas.screencanvas = this.renderType === H.CANVAS),
            this.renderType !== H.HEADLESS && (this.stage.smoothed = this.antialias,
            H.Canvas.addToDOM(this.canvas, this.parent, !1),
            H.Canvas.setTouchAction(this.canvas))
        },
        contextLost: function(t) {
            t.preventDefault(),
            this.renderer.contextLost = !0
        },
        contextRestored: function() {
            this.renderer.initContext(),
            this.cache.clearGLTextures(),
            this.renderer.contextLost = !1
        },
        update: function(t) {
            if (this.time.update(t),
            this._kickstart)
                return this.updateLogic(this.time.desiredFpsMult),
                this.updateRender(this.time.slowMotion * this.time.desiredFps),
                void (this._kickstart = !1);
            if (1 < this._spiraling && !this.forceSingleUpdate)
                this.time.time > this._nextFpsNotification && (this._nextFpsNotification = this.time.time + 1e4,
                this.fpsProblemNotifier.dispatch()),
                this._deltaTime = 0,
                this._spiraling = 0,
                this.updateRender(this.time.slowMotion * this.time.desiredFps);
            else {
                var e = 1e3 * this.time.slowMotion / this.time.desiredFps;
                this._deltaTime += Math.max(Math.min(3 * e, this.time.elapsed), 0);
                var i = 0;
                for (this.updatesThisFrame = Math.floor(this._deltaTime / e),
                this.forceSingleUpdate && (this.updatesThisFrame = Math.min(1, this.updatesThisFrame)); this._deltaTime >= e && (this._deltaTime -= e,
                this.currentUpdateID = i,
                this.updateLogic(this.time.desiredFpsMult),
                i++,
                !this.forceSingleUpdate || 1 !== i); )
                    this.time.refresh();
                i > this._lastCount ? this._spiraling++ : i < this._lastCount && (this._spiraling = 0),
                this._lastCount = i,
                this.updateRender(this._deltaTime / e)
            }
        },
        updateLogic: function(t) {
            this._paused || this.pendingStep ? (this.scale.pauseUpdate(),
            this.state.pauseUpdate(),
            this.debug.preUpdate()) : (this.stepping && (this.pendingStep = !0),
            this.scale.preUpdate(),
            this.debug.preUpdate(),
            this.camera.preUpdate(),
            this.physics.preUpdate(),
            this.state.preUpdate(t),
            this.plugins.preUpdate(t),
            this.stage.preUpdate(),
            this.state.update(),
            this.stage.update(),
            this.tweens.update(),
            this.sound.update(),
            this.input.update(),
            this.physics.update(),
            this.particles.update(),
            this.plugins.update(),
            this.stage.postUpdate(),
            this.plugins.postUpdate()),
            this.stage.updateTransform()
        },
        updateRender: function(t) {
            this.lockRender || (this.state.preRender(t),
            this.renderType !== H.HEADLESS && (this.renderer.render(this.stage),
            this.plugins.render(t),
            this.state.render(t)),
            this.plugins.postRender(t))
        },
        enableStep: function() {
            this.stepping = !0,
            this.pendingStep = !1,
            this.stepCount = 0
        },
        disableStep: function() {
            this.stepping = !1,
            this.pendingStep = !1
        },
        step: function() {
            this.pendingStep = !1,
            this.stepCount++
        },
        destroy: function() {
            this.raf.stop(),
            this.state.destroy(),
            this.sound.destroy(),
            this.scale.destroy(),
            this.stage.destroy(),
            this.input.destroy(),
            this.physics.destroy(),
            this.plugins.destroy(),
            this.state = null,
            this.sound = null,
            this.scale = null,
            this.stage = null,
            this.input = null,
            this.physics = null,
            this.plugins = null,
            this.cache = null,
            this.load = null,
            this.time = null,
            this.world = null,
            this.isBooted = !1,
            this.renderer.destroy(!1),
            H.Canvas.removeFromDOM(this.canvas),
            PIXI.defaultRenderer = null,
            H.GAMES[this.id] = null
        },
        gamePaused: function(t) {
            this._paused || (this._paused = !0,
            this.time.gamePaused(),
            this.sound.muteOnPause && this.sound.setMute(),
            this.onPause.dispatch(t),
            this.device.cordova && this.device.iOS && (this.lockRender = !0))
        },
        gameResumed: function(t) {
            this._paused && !this._codePaused && (this._paused = !1,
            this.time.gameResumed(),
            this.input.reset(),
            this.sound.muteOnPause && this.sound.unsetMute(),
            this.onResume.dispatch(t),
            this.device.cordova && this.device.iOS && (this.lockRender = !1))
        },
        focusLoss: function(t) {
            this.onBlur.dispatch(t),
            this.stage.disableVisibilityChange || this.gamePaused(t)
        },
        focusGain: function(t) {
            this.onFocus.dispatch(t),
            this.stage.disableVisibilityChange || this.gameResumed(t)
        }
    },
    H.Game.prototype.constructor = H.Game,
    Object.defineProperty(H.Game.prototype, "paused", {
        get: function() {
            return this._paused
        },
        set: function(t) {
            !0 === t ? (!1 === this._paused && (this._paused = !0,
            this.sound.setMute(),
            this.time.gamePaused(),
            this.onPause.dispatch(this)),
            this._codePaused = !0) : (this._paused && (this._paused = !1,
            this.input.reset(),
            this.sound.unsetMute(),
            this.time.gameResumed(),
            this.onResume.dispatch(this)),
            this._codePaused = !1)
        }
    }),
    H.Input = function(t) {
        this.game = t,
        this.hitCanvas = null,
        this.hitContext = null,
        this.moveCallbacks = [],
        this.customCandidateHandler = null,
        this.customCandidateHandlerContext = null,
        this.pollRate = 0,
        this.enabled = !0,
        this.multiInputOverride = H.Input.MOUSE_TOUCH_COMBINE,
        this.position = null,
        this.speed = null,
        this.circle = null,
        this.scale = null,
        this.maxPointers = -1,
        this.tapRate = 200,
        this.doubleTapRate = 300,
        this.holdRate = 2e3,
        this.justPressedRate = 200,
        this.justReleasedRate = 200,
        this.recordPointerHistory = !1,
        this.recordRate = 100,
        this.recordLimit = 100,
        this.pointer1 = null,
        this.pointer2 = null,
        this.pointer3 = null,
        this.pointer4 = null,
        this.pointer5 = null,
        this.pointer6 = null,
        this.pointer7 = null,
        this.pointer8 = null,
        this.pointer9 = null,
        this.pointer10 = null,
        this.pointers = [],
        this.activePointer = null,
        this.mousePointer = null,
        this.mouse = null,
        this.keyboard = null,
        this.touch = null,
        this.mspointer = null,
        this.gamepad = null,
        this.resetLocked = !1,
        this.onDown = null,
        this.onUp = null,
        this.onTap = null,
        this.onHold = null,
        this.minPriorityID = 0,
        this.interactiveItems = new H.ArraySet,
        this._localPoint = new H.Point,
        this._pollCounter = 0,
        this._oldPosition = null,
        this._x = 0,
        this._y = 0
    }
    ,
    H.Input.MOUSE_OVERRIDES_TOUCH = 0,
    H.Input.TOUCH_OVERRIDES_MOUSE = 1,
    H.Input.MOUSE_TOUCH_COMBINE = 2,
    H.Input.MAX_POINTERS = 10,
    H.Input.prototype = {
        boot: function() {
            this.mousePointer = new H.Pointer(this.game,0,H.PointerMode.CURSOR),
            this.addPointer(),
            this.addPointer(),
            this.mouse = new H.Mouse(this.game),
            this.touch = new H.Touch(this.game),
            this.mspointer = new H.MSPointer(this.game),
            H.Keyboard && (this.keyboard = new H.Keyboard(this.game)),
            H.Gamepad && (this.gamepad = new H.Gamepad(this.game)),
            this.onDown = new H.Signal,
            this.onUp = new H.Signal,
            this.onTap = new H.Signal,
            this.onHold = new H.Signal,
            this.scale = new H.Point(1,1),
            this.speed = new H.Point,
            this.position = new H.Point,
            this._oldPosition = new H.Point,
            this.circle = new H.Circle(0,0,45),
            this.activePointer = this.mousePointer,
            this.hitCanvas = PIXI.CanvasPool.create(this, 1, 1),
            this.hitContext = this.hitCanvas.getContext("2d"),
            this.game.device.mspointer ? this.mspointer.start() : this.game.device.touch && this.touch.start(),
            this.mspointer.active || this.mouse.start(),
            this.mousePointer.active = !0,
            this.keyboard && this.keyboard.start();
            var e = this;
            this._onClickTrampoline = function(t) {
                e.onClickTrampoline(t)
            }
            ,
            this.game.canvas.addEventListener("click", this._onClickTrampoline, !1)
        },
        destroy: function() {
            this.mouse.stop(),
            this.touch.stop(),
            this.mspointer.stop(),
            this.keyboard && this.keyboard.stop(),
            this.gamepad && this.gamepad.stop(),
            this.moveCallbacks = [],
            PIXI.CanvasPool.remove(this),
            this.game.canvas.removeEventListener("click", this._onClickTrampoline)
        },
        setInteractiveCandidateHandler: function(t, e) {
            this.customCandidateHandler = t,
            this.customCandidateHandlerContext = e
        },
        addMoveCallback: function(t, e) {
            this.moveCallbacks.push({
                callback: t,
                context: e
            })
        },
        deleteMoveCallback: function(t, e) {
            for (var i = this.moveCallbacks.length; i--; )
                if (this.moveCallbacks[i].callback === t && this.moveCallbacks[i].context === e)
                    return void this.moveCallbacks.splice(i, 1)
        },
        addPointer: function() {
            if (this.pointers.length >= H.Input.MAX_POINTERS)
                return null;
            var t = this.pointers.length + 1
              , e = new H.Pointer(this.game,t,H.PointerMode.TOUCH);
            return this.pointers.push(e),
            this["pointer" + t] = e
        },
        update: function() {
            if (this.keyboard && this.keyboard.update(),
            0 < this.pollRate && this._pollCounter < this.pollRate)
                this._pollCounter++;
            else {
                this.speed.x = this.position.x - this._oldPosition.x,
                this.speed.y = this.position.y - this._oldPosition.y,
                this._oldPosition.copyFrom(this.position),
                this.mousePointer.update(),
                this.gamepad && this.gamepad.active && this.gamepad.update();
                for (var t = 0; t < this.pointers.length; t++)
                    this.pointers[t].update();
                this._pollCounter = 0
            }
        },
        reset: function(t) {
            if (this.game.isBooted && !this.resetLocked) {
                void 0 === t && (t = !1),
                this.mousePointer.reset(),
                this.keyboard && this.keyboard.reset(t),
                this.gamepad && this.gamepad.reset();
                for (var e = 0; e < this.pointers.length; e++)
                    this.pointers[e].reset();
                "none" !== this.game.canvas.style.cursor && (this.game.canvas.style.cursor = "inherit"),
                t && (this.onDown.dispose(),
                this.onUp.dispose(),
                this.onTap.dispose(),
                this.onHold.dispose(),
                this.onDown = new H.Signal,
                this.onUp = new H.Signal,
                this.onTap = new H.Signal,
                this.onHold = new H.Signal,
                this.moveCallbacks = []),
                this._pollCounter = 0
            }
        },
        resetSpeed: function(t, e) {
            this._oldPosition.setTo(t, e),
            this.speed.setTo(0, 0)
        },
        startPointer: function(t) {
            if (0 <= this.maxPointers && this.countActivePointers(this.maxPointers) >= this.maxPointers)
                return null;
            if (!this.pointer1.active)
                return this.pointer1.start(t);
            if (!this.pointer2.active)
                return this.pointer2.start(t);
            for (var e = 2; e < this.pointers.length; e++) {
                var i = this.pointers[e];
                if (!i.active)
                    return i.start(t)
            }
            return null
        },
        updatePointer: function(t) {
            if (this.pointer1.active && this.pointer1.identifier === t.identifier)
                return this.pointer1.move(t);
            if (this.pointer2.active && this.pointer2.identifier === t.identifier)
                return this.pointer2.move(t);
            for (var e = 2; e < this.pointers.length; e++) {
                var i = this.pointers[e];
                if (i.active && i.identifier === t.identifier)
                    return i.move(t)
            }
            return null
        },
        stopPointer: function(t) {
            if (this.pointer1.active && this.pointer1.identifier === t.identifier)
                return this.pointer1.stop(t);
            if (this.pointer2.active && this.pointer2.identifier === t.identifier)
                return this.pointer2.stop(t);
            for (var e = 2; e < this.pointers.length; e++) {
                var i = this.pointers[e];
                if (i.active && i.identifier === t.identifier)
                    return i.stop(t)
            }
            return null
        },
        countActivePointers: function(t) {
            void 0 === t && (t = this.pointers.length);
            for (var e = t, i = 0; i < this.pointers.length && 0 < e; i++)
                this.pointers[i].active && e--;
            return t - e
        },
        getPointer: function(t) {
            void 0 === t && (t = !1);
            for (var e = 0; e < this.pointers.length; e++) {
                var i = this.pointers[e];
                if (i.active === t)
                    return i
            }
            return null
        },
        getPointerFromIdentifier: function(t) {
            for (var e = 0; e < this.pointers.length; e++) {
                var i = this.pointers[e];
                if (i.identifier === t)
                    return i
            }
            return null
        },
        getPointerFromId: function(t) {
            for (var e = 0; e < this.pointers.length; e++) {
                var i = this.pointers[e];
                if (i.pointerId === t)
                    return i
            }
            return null
        },
        getLocalPosition: function(t, e, i) {
            void 0 === i && (i = new H.Point);
            var s = t.worldTransform
              , n = 1 / (s.a * s.d + s.c * -s.b);
            return i.setTo(s.d * n * e.x + -s.c * n * e.y + (s.ty * s.c - s.tx * s.d) * n, s.a * n * e.y + -s.b * n * e.x + (-s.ty * s.a + s.tx * s.b) * n)
        },
        hitTest: function(t, e, i) {
            if (!t.worldVisible)
                return !1;
            if (this.getLocalPosition(t, e, this._localPoint),
            i.copyFrom(this._localPoint),
            t.hitArea && t.hitArea.contains)
                return t.hitArea.contains(this._localPoint.x, this._localPoint.y);
            if (t instanceof H.TileSprite) {
                var s = t.width
                  , n = t.height
                  , r = -s * t.anchor.x;
                if (this._localPoint.x >= r && this._localPoint.x < r + s) {
                    var o = -n * t.anchor.y;
                    if (this._localPoint.y >= o && this._localPoint.y < o + n)
                        return !0
                }
            } else if (t instanceof PIXI.Sprite) {
                s = t.texture.frame.width,
                n = t.texture.frame.height,
                r = -s * t.anchor.x;
                if (this._localPoint.x >= r && this._localPoint.x < r + s) {
                    o = -n * t.anchor.y;
                    if (this._localPoint.y >= o && this._localPoint.y < o + n)
                        return !0
                }
            } else if (H.Graphics && t instanceof H.Graphics)
                for (var a = 0; a < t.graphicsData.length; a++) {
                    var h = t.graphicsData[a];
                    if (h.fill && h.shape && h.shape.contains(this._localPoint.x, this._localPoint.y))
                        return !0
                }
            for (a = 0; a < t.children.length; a++)
                if (this.hitTest(t.children[a], e, i))
                    return !0;
            return !1
        },
        onClickTrampoline: function() {
            this.activePointer.processClickTrampolines()
        }
    },
    H.Input.prototype.constructor = H.Input,
    Object.defineProperty(H.Input.prototype, "x", {
        get: function() {
            return this._x
        },
        set: function(t) {
            this._x = Math.floor(t)
        }
    }),
    Object.defineProperty(H.Input.prototype, "y", {
        get: function() {
            return this._y
        },
        set: function(t) {
            this._y = Math.floor(t)
        }
    }),
    Object.defineProperty(H.Input.prototype, "pollLocked", {
        get: function() {
            return 0 < this.pollRate && this._pollCounter < this.pollRate
        }
    }),
    Object.defineProperty(H.Input.prototype, "totalInactivePointers", {
        get: function() {
            return this.pointers.length - this.countActivePointers()
        }
    }),
    Object.defineProperty(H.Input.prototype, "totalActivePointers", {
        get: function() {
            return this.countActivePointers()
        }
    }),
    Object.defineProperty(H.Input.prototype, "worldX", {
        get: function() {
            return this.game.camera.view.x + this.x
        }
    }),
    Object.defineProperty(H.Input.prototype, "worldY", {
        get: function() {
            return this.game.camera.view.y + this.y
        }
    }),
    H.Mouse = function(t) {
        this.game = t,
        this.input = t.input,
        this.callbackContext = this.game,
        this.mouseDownCallback = null,
        this.mouseUpCallback = null,
        this.mouseOutCallback = null,
        this.mouseOverCallback = null,
        this.mouseWheelCallback = null,
        this.capture = !1,
        this.button = -1,
        this.wheelDelta = 0,
        this.enabled = !0,
        this.locked = !1,
        this.stopOnGameOut = !1,
        this.pointerLock = new H.Signal,
        this.event = null,
        this._onMouseDown = null,
        this._onMouseMove = null,
        this._onMouseUp = null,
        this._onMouseOut = null,
        this._onMouseOver = null,
        this._onMouseWheel = null,
        this._wheelEvent = null
    }
    ,
    H.Mouse.NO_BUTTON = -1,
    H.Mouse.LEFT_BUTTON = 0,
    H.Mouse.MIDDLE_BUTTON = 1,
    H.Mouse.RIGHT_BUTTON = 2,
    H.Mouse.BACK_BUTTON = 3,
    H.Mouse.FORWARD_BUTTON = 4,
    H.Mouse.WHEEL_UP = 1,
    H.Mouse.WHEEL_DOWN = -1,
    H.Mouse.prototype = {
        start: function() {
            if ((!this.game.device.android || !1 !== this.game.device.chrome) && null === this._onMouseDown) {
                var e = this;
                this._onMouseDown = function(t) {
                    return e.onMouseDown(t)
                }
                ,
                this._onMouseMove = function(t) {
                    return e.onMouseMove(t)
                }
                ,
                this._onMouseUp = function(t) {
                    return e.onMouseUp(t)
                }
                ,
                this._onMouseUpGlobal = function(t) {
                    return e.onMouseUpGlobal(t)
                }
                ,
                this._onMouseOutGlobal = function(t) {
                    return e.onMouseOutGlobal(t)
                }
                ,
                this._onMouseOut = function(t) {
                    return e.onMouseOut(t)
                }
                ,
                this._onMouseOver = function(t) {
                    return e.onMouseOver(t)
                }
                ,
                this._onMouseWheel = function(t) {
                    return e.onMouseWheel(t)
                }
                ;
                var t = this.game.canvas;
                t.addEventListener("mousedown", this._onMouseDown, !0),
                t.addEventListener("mousemove", this._onMouseMove, !0),
                t.addEventListener("mouseup", this._onMouseUp, !0),
                this.game.device.cocoonJS || (window.addEventListener("mouseup", this._onMouseUpGlobal, !0),
                window.addEventListener("mouseout", this._onMouseOutGlobal, !0),
                t.addEventListener("mouseover", this._onMouseOver, !0),
                t.addEventListener("mouseout", this._onMouseOut, !0));
                var i = this.game.device.wheelEvent;
                i && (t.addEventListener(i, this._onMouseWheel, !0),
                "mousewheel" === i ? this._wheelEvent = new s(-.025,1) : "DOMMouseScroll" === i && (this._wheelEvent = new s(1,1)))
            }
        },
        onMouseDown: function(t) {
            this.event = t,
            this.capture && t.preventDefault(),
            this.mouseDownCallback && this.mouseDownCallback.call(this.callbackContext, t),
            this.input.enabled && this.enabled && (t.identifier = 0,
            this.input.mousePointer.start(t))
        },
        onMouseMove: function(t) {
            this.event = t,
            this.capture && t.preventDefault(),
            this.mouseMoveCallback && this.mouseMoveCallback.call(this.callbackContext, t),
            this.input.enabled && this.enabled && (t.identifier = 0,
            this.input.mousePointer.move(t))
        },
        onMouseUp: function(t) {
            this.event = t,
            this.capture && t.preventDefault(),
            this.mouseUpCallback && this.mouseUpCallback.call(this.callbackContext, t),
            this.input.enabled && this.enabled && (t.identifier = 0,
            this.input.mousePointer.stop(t))
        },
        onMouseUpGlobal: function(t) {
            this.input.mousePointer.withinGame || (this.mouseUpCallback && this.mouseUpCallback.call(this.callbackContext, t),
            t.identifier = 0,
            this.input.mousePointer.stop(t))
        },
        onMouseOutGlobal: function(t) {
            this.event = t,
            this.capture && t.preventDefault(),
            this.input.mousePointer.withinGame = !1,
            this.input.enabled && this.enabled && (this.input.mousePointer.stop(t),
            this.input.mousePointer.leftButton.stop(t),
            this.input.mousePointer.rightButton.stop(t))
        },
        onMouseOut: function(t) {
            this.event = t,
            this.capture && t.preventDefault(),
            this.input.mousePointer.withinGame = !1,
            this.mouseOutCallback && this.mouseOutCallback.call(this.callbackContext, t),
            this.input.enabled && this.enabled && this.stopOnGameOut && (t.identifier = 0,
            this.input.mousePointer.stop(t))
        },
        onMouseOver: function(t) {
            this.event = t,
            this.capture && t.preventDefault(),
            this.input.mousePointer.withinGame = !0,
            this.mouseOverCallback && this.mouseOverCallback.call(this.callbackContext, t)
        },
        onMouseWheel: function(t) {
            this._wheelEvent && (t = this._wheelEvent.bindEvent(t)),
            this.event = t,
            this.capture && t.preventDefault(),
            this.wheelDelta = H.Math.clamp(-t.deltaY, -1, 1),
            this.mouseWheelCallback && this.mouseWheelCallback.call(this.callbackContext, t)
        },
        requestPointerLock: function() {
            if (this.game.device.pointerLock) {
                var t = this.game.canvas;
                t.requestPointerLock = t.requestPointerLock || t.mozRequestPointerLock || t.webkitRequestPointerLock,
                t.requestPointerLock();
                var e = this;
                this._pointerLockChange = function(t) {
                    return e.pointerLockChange(t)
                }
                ,
                document.addEventListener("pointerlockchange", this._pointerLockChange, !0),
                document.addEventListener("mozpointerlockchange", this._pointerLockChange, !0),
                document.addEventListener("webkitpointerlockchange", this._pointerLockChange, !0)
            }
        },
        pointerLockChange: function(t) {
            var e = this.game.canvas;
            document.pointerLockElement === e || document.mozPointerLockElement === e || document.webkitPointerLockElement === e ? (this.locked = !0,
            this.pointerLock.dispatch(!0, t)) : (this.locked = !1,
            this.pointerLock.dispatch(!1, t))
        },
        releasePointerLock: function() {
            document.exitPointerLock = document.exitPointerLock || document.mozExitPointerLock || document.webkitExitPointerLock,
            document.exitPointerLock(),
            document.removeEventListener("pointerlockchange", this._pointerLockChange, !0),
            document.removeEventListener("mozpointerlockchange", this._pointerLockChange, !0),
            document.removeEventListener("webkitpointerlockchange", this._pointerLockChange, !0)
        },
        stop: function() {
            var t = this.game.canvas;
            t.removeEventListener("mousedown", this._onMouseDown, !0),
            t.removeEventListener("mousemove", this._onMouseMove, !0),
            t.removeEventListener("mouseup", this._onMouseUp, !0),
            t.removeEventListener("mouseover", this._onMouseOver, !0),
            t.removeEventListener("mouseout", this._onMouseOut, !0);
            var e = this.game.device.wheelEvent;
            e && t.removeEventListener(e, this._onMouseWheel, !0),
            window.removeEventListener("mouseup", this._onMouseUpGlobal, !0),
            window.removeEventListener("mouseout", this._onMouseOutGlobal, !0),
            document.removeEventListener("pointerlockchange", this._pointerLockChange, !0),
            document.removeEventListener("mozpointerlockchange", this._pointerLockChange, !0),
            document.removeEventListener("webkitpointerlockchange", this._pointerLockChange, !0)
        }
    },
    H.Mouse.prototype.constructor = H.Mouse,
    ((s.prototype = {}).constructor = s).prototype.bindEvent = function(t) {
        if (!s._stubsGenerated && t) {
            var e = function(e) {
                return function() {
                    var t = this.originalEvent[e];
                    return "function" != typeof t ? t : t.bind(this.originalEvent)
                }
            };
            for (var i in t)
                i in s.prototype || Object.defineProperty(s.prototype, i, {
                    get: e(i)
                });
            s._stubsGenerated = !0
        }
        return this.originalEvent = t,
        this
    }
    ,
    Object.defineProperties(s.prototype, {
        type: {
            value: "wheel"
        },
        deltaMode: {
            get: function() {
                return this._deltaMode
            }
        },
        deltaY: {
            get: function() {
                return this._scaleFactor * (this.originalEvent.wheelDelta || this.originalEvent.detail) || 0
            }
        },
        deltaX: {
            get: function() {
                return this._scaleFactor * this.originalEvent.wheelDeltaX || 0
            }
        },
        deltaZ: {
            value: 0
        }
    }),
    H.MSPointer = function(t) {
        this.game = t,
        this.input = t.input,
        this.callbackContext = this.game,
        this.pointerDownCallback = null,
        this.pointerMoveCallback = null,
        this.pointerUpCallback = null,
        this.capture = !1,
        this.event = null,
        this.active = !1,
        this.enabled = !0,
        this._onMSPointerDown = null,
        this._onMSPointerMove = null,
        this._onMSPointerUp = null,
        this._onMSPointerUpGlobal = null,
        this._onMSPointerOut = null,
        this._onMSPointerOver = null
    }
    ,
    H.MSPointer.prototype = {
        start: function() {
            if (!this.game.device.mspointer)
                return !1;
            if (null !== this._onMSPointerDown)
                return !1;
            var e = this;
            this._onMSPointerDown = function(t) {
                return e.onPointerDown(t)
            }
            ,
            this._onMSPointerMove = function(t) {
                return e.onPointerMove(t)
            }
            ,
            this._onMSPointerUp = function(t) {
                return e.onPointerUp(t)
            }
            ,
            this._onMSPointerUpGlobal = function(t) {
                return e.onPointerUpGlobal(t)
            }
            ,
            this._onMSPointerOut = function(t) {
                return e.onPointerOut(t)
            }
            ,
            this._onMSPointerOver = function(t) {
                return e.onPointerOver(t)
            }
            ;
            var t = this.game.canvas;
            return t.addEventListener("MSPointerDown", this._onMSPointerDown, !1),
            t.addEventListener("MSPointerMove", this._onMSPointerMove, !1),
            t.addEventListener("MSPointerUp", this._onMSPointerUp, !1),
            t.addEventListener("pointerdown", this._onMSPointerDown, !1),
            t.addEventListener("pointermove", this._onMSPointerMove, !1),
            t.addEventListener("pointerup", this._onMSPointerUp, !1),
            t.style["-ms-content-zooming"] = "none",
            t.style["-ms-touch-action"] = "none",
            this.game.device.cocoonJS || (window.addEventListener("MSPointerUp", this._onMSPointerUpGlobal, !0),
            t.addEventListener("MSPointerOver", this._onMSPointerOver, !0),
            t.addEventListener("MSPointerOut", this._onMSPointerOut, !0),
            window.addEventListener("pointerup", this._onMSPointerUpGlobal, !0),
            t.addEventListener("pointerover", this._onMSPointerOver, !0),
            t.addEventListener("pointerout", this._onMSPointerOut, !0)),
            this.active = !0
        },
        onPointerDown: function(t) {
            this.event = t,
            this.capture && t.preventDefault(),
            this.pointerDownCallback && this.pointerDownCallback.call(this.callbackContext, t),
            this.input.enabled && this.enabled && (t.identifier = t.pointerId,
            "mouse" === t.pointerType || 4 === t.pointerType ? this.input.mousePointer.start(t) : this.input.startPointer(t))
        },
        onPointerMove: function(t) {
            this.event = t,
            this.capture && t.preventDefault(),
            this.pointerMoveCallback && this.pointerMoveCallback.call(this.callbackContext, t),
            this.input.enabled && this.enabled && (t.identifier = t.pointerId,
            "mouse" === t.pointerType || 4 === t.pointerType ? this.input.mousePointer.move(t) : this.input.updatePointer(t))
        },
        onPointerUp: function(t) {
            this.event = t,
            this.capture && t.preventDefault(),
            this.pointerUpCallback && this.pointerUpCallback.call(this.callbackContext, t),
            this.input.enabled && this.enabled && (t.identifier = t.pointerId,
            "mouse" === t.pointerType || 4 === t.pointerType ? this.input.mousePointer.stop(t) : this.input.stopPointer(t))
        },
        onPointerUpGlobal: function(t) {
            if ("mouse" !== t.pointerType && 4 !== t.pointerType || this.input.mousePointer.withinGame) {
                var e = this.input.getPointerFromIdentifier(t.identifier);
                e && e.withinGame && this.onPointerUp(t)
            } else
                this.onPointerUp(t)
        },
        onPointerOut: function(t) {
            if (this.event = t,
            this.capture && t.preventDefault(),
            "mouse" === t.pointerType || 4 === t.pointerType)
                this.input.mousePointer.withinGame = !1;
            else {
                var e = this.input.getPointerFromIdentifier(t.identifier);
                e && (e.withinGame = !1)
            }
            this.input.mouse.mouseOutCallback && this.input.mouse.mouseOutCallback.call(this.input.mouse.callbackContext, t),
            this.input.enabled && this.enabled && this.input.mouse.stopOnGameOut && (t.identifier = 0,
            e ? e.stop(t) : this.input.mousePointer.stop(t))
        },
        onPointerOver: function(t) {
            if (this.event = t,
            this.capture && t.preventDefault(),
            "mouse" === t.pointerType || 4 === t.pointerType)
                this.input.mousePointer.withinGame = !0;
            else {
                var e = this.input.getPointerFromIdentifier(t.identifier);
                e && (e.withinGame = !0)
            }
            this.input.mouse.mouseOverCallback && this.input.mouse.mouseOverCallback.call(this.input.mouse.callbackContext, t)
        },
        stop: function() {
            var t = this.game.canvas;
            t.removeEventListener("MSPointerDown", this._onMSPointerDown, !1),
            t.removeEventListener("MSPointerMove", this._onMSPointerMove, !1),
            t.removeEventListener("MSPointerUp", this._onMSPointerUp, !1),
            t.removeEventListener("pointerdown", this._onMSPointerDown, !1),
            t.removeEventListener("pointermove", this._onMSPointerMove, !1),
            t.removeEventListener("pointerup", this._onMSPointerUp, !1),
            window.removeEventListener("MSPointerUp", this._onMSPointerUpGlobal, !0),
            t.removeEventListener("MSPointerOver", this._onMSPointerOver, !0),
            t.removeEventListener("MSPointerOut", this._onMSPointerOut, !0),
            window.removeEventListener("pointerup", this._onMSPointerUpGlobal, !0),
            t.removeEventListener("pointerover", this._onMSPointerOver, !0),
            t.removeEventListener("pointerout", this._onMSPointerOut, !0),
            this.active = !1
        }
    },
    H.MSPointer.prototype.constructor = H.MSPointer,
    H.DeviceButton = function(t, e) {
        this.parent = t,
        this.game = t.game,
        this.event = null,
        this.isDown = !1,
        this.isUp = !0,
        this.timeDown = 0,
        this.timeUp = 0,
        this.repeats = 0,
        this.altKey = !1,
        this.shiftKey = !1,
        this.ctrlKey = !1,
        this.value = 0,
        this.buttonCode = e,
        this.onDown = new H.Signal,
        this.onUp = new H.Signal,
        this.onFloat = new H.Signal
    }
    ,
    H.DeviceButton.prototype = {
        start: function(t, e) {
            this.isDown || (this.isDown = !0,
            this.isUp = !1,
            this.timeDown = this.game.time.time,
            this.repeats = 0,
            this.event = t,
            this.value = e,
            t && (this.altKey = t.altKey,
            this.shiftKey = t.shiftKey,
            this.ctrlKey = t.ctrlKey),
            this.onDown.dispatch(this, e))
        },
        stop: function(t, e) {
            this.isUp || (this.isDown = !1,
            this.isUp = !0,
            this.timeUp = this.game.time.time,
            this.event = t,
            this.value = e,
            t && (this.altKey = t.altKey,
            this.shiftKey = t.shiftKey,
            this.ctrlKey = t.ctrlKey),
            this.onUp.dispatch(this, e))
        },
        padFloat: function(t) {
            this.value = t,
            this.onFloat.dispatch(this, t)
        },
        justPressed: function(t) {
            return t = t || 250,
            this.isDown && this.timeDown + t > this.game.time.time
        },
        justReleased: function(t) {
            return t = t || 250,
            this.isUp && this.timeUp + t > this.game.time.time
        },
        reset: function() {
            this.isDown = !1,
            this.isUp = !0,
            this.timeDown = this.game.time.time,
            this.repeats = 0,
            this.altKey = !1,
            this.shiftKey = !1,
            this.ctrlKey = !1
        },
        destroy: function() {
            this.onDown.dispose(),
            this.onUp.dispose(),
            this.onFloat.dispose(),
            this.parent = null,
            this.game = null
        }
    },
    H.DeviceButton.prototype.constructor = H.DeviceButton,
    Object.defineProperty(H.DeviceButton.prototype, "duration", {
        get: function() {
            return this.isUp ? -1 : this.game.time.time - this.timeDown
        }
    }),
    H.Pointer = function(t, e, i) {
        this.game = t,
        this.id = e,
        this.type = H.POINTER,
        this.exists = !0,
        this.identifier = 0,
        this.pointerId = null,
        this.pointerMode = i || H.PointerMode.CURSOR | H.PointerMode.CONTACT,
        this.target = null,
        this.button = null,
        this.leftButton = new H.DeviceButton(this,H.Pointer.LEFT_BUTTON),
        this.middleButton = new H.DeviceButton(this,H.Pointer.MIDDLE_BUTTON),
        this.rightButton = new H.DeviceButton(this,H.Pointer.RIGHT_BUTTON),
        this.backButton = new H.DeviceButton(this,H.Pointer.BACK_BUTTON),
        this.forwardButton = new H.DeviceButton(this,H.Pointer.FORWARD_BUTTON),
        this.eraserButton = new H.DeviceButton(this,H.Pointer.ERASER_BUTTON),
        this._holdSent = !1,
        this._history = [],
        this._nextDrop = 0,
        this._stateReset = !1,
        this.withinGame = !1,
        this.clientX = -1,
        this.clientY = -1,
        this.pageX = -1,
        this.pageY = -1,
        this.screenX = -1,
        this.screenY = -1,
        this.rawMovementX = 0,
        this.rawMovementY = 0,
        this.movementX = 0,
        this.movementY = 0,
        this.x = -1,
        this.y = -1,
        this.isMouse = 0 === e,
        this.isDown = !1,
        this.isUp = !0,
        this.timeDown = 0,
        this.timeUp = 0,
        this.previousTapTime = 0,
        this.totalTouches = 0,
        this.msSinceLastClick = Number.MAX_VALUE,
        this.targetObject = null,
        this.interactiveCandidates = [],
        this.active = !1,
        this.dirty = !1,
        this.position = new H.Point,
        this.positionDown = new H.Point,
        this.positionUp = new H.Point,
        this.circle = new H.Circle(0,0,44),
        this._clickTrampolines = null,
        this._trampolineTargetObject = null
    }
    ,
    H.Pointer.NO_BUTTON = 0,
    H.Pointer.LEFT_BUTTON = 1,
    H.Pointer.RIGHT_BUTTON = 2,
    H.Pointer.MIDDLE_BUTTON = 4,
    H.Pointer.BACK_BUTTON = 8,
    H.Pointer.FORWARD_BUTTON = 16,
    H.Pointer.ERASER_BUTTON = 32,
    H.Pointer.prototype = {
        resetButtons: function() {
            this.isDown = !1,
            this.isUp = !0,
            this.isMouse && (this.leftButton.reset(),
            this.middleButton.reset(),
            this.rightButton.reset(),
            this.backButton.reset(),
            this.forwardButton.reset(),
            this.eraserButton.reset())
        },
        processButtonsDown: function(t, e) {
            H.Pointer.LEFT_BUTTON & t && this.leftButton.start(e),
            H.Pointer.RIGHT_BUTTON & t && this.rightButton.start(e),
            H.Pointer.MIDDLE_BUTTON & t && this.middleButton.start(e),
            H.Pointer.BACK_BUTTON & t && this.backButton.start(e),
            H.Pointer.FORWARD_BUTTON & t && this.forwardButton.start(e),
            H.Pointer.ERASER_BUTTON & t && this.eraserButton.start(e)
        },
        processButtonsUp: function(t, e) {
            t === H.Mouse.LEFT_BUTTON && this.leftButton.stop(e),
            t === H.Mouse.RIGHT_BUTTON && this.rightButton.stop(e),
            t === H.Mouse.MIDDLE_BUTTON && this.middleButton.stop(e),
            t === H.Mouse.BACK_BUTTON && this.backButton.stop(e),
            t === H.Mouse.FORWARD_BUTTON && this.forwardButton.stop(e),
            5 === t && this.eraserButton.stop(e)
        },
        updateButtons: function(t) {
            this.button = t.button;
            var e = "down" === t.type.toLowerCase().substr(-4);
            void 0 !== t.buttons ? e ? this.processButtonsDown(t.buttons, t) : this.processButtonsUp(t.button, t) : e ? this.leftButton.start(t) : (this.leftButton.stop(t),
            this.rightButton.stop(t)),
            1 === t.buttons && t.ctrlKey && this.leftButton.isDown && (this.leftButton.stop(t),
            this.rightButton.start(t)),
            this.isUp = !0,
            this.isDown = !1,
            (this.leftButton.isDown || this.rightButton.isDown || this.middleButton.isDown || this.backButton.isDown || this.forwardButton.isDown || this.eraserButton.isDown) && (this.isUp = !1,
            this.isDown = !0)
        },
        start: function(t) {
            var e = this.game.input;
            return t.pointerId && (this.pointerId = t.pointerId),
            this.identifier = t.identifier,
            this.target = t.target,
            this.isMouse ? this.updateButtons(t) : (this.isDown = !0,
            this.isUp = !1),
            this.active = !0,
            this.withinGame = !0,
            this.dirty = !1,
            this._history = [],
            this._clickTrampolines = null,
            this._trampolineTargetObject = null,
            this.msSinceLastClick = this.game.time.time - this.timeDown,
            this.timeDown = this.game.time.time,
            this._holdSent = !1,
            this.move(t, !0),
            this.positionDown.setTo(this.x, this.y),
            (e.multiInputOverride === H.Input.MOUSE_OVERRIDES_TOUCH || e.multiInputOverride === H.Input.MOUSE_TOUCH_COMBINE || e.multiInputOverride === H.Input.TOUCH_OVERRIDES_MOUSE && 0 === e.totalActivePointers) && (e.x = this.x,
            e.y = this.y,
            e.position.setTo(this.x, this.y),
            e.onDown.dispatch(this, t),
            e.resetSpeed(this.x, this.y)),
            this._stateReset = !1,
            this.totalTouches++,
            null !== this.targetObject && this.targetObject._touchedHandler(this),
            this
        },
        update: function() {
            var t = this.game.input;
            this.active && (this.dirty && (0 < t.interactiveItems.total && this.processInteractiveObjects(!1),
            this.dirty = !1),
            !1 === this._holdSent && this.duration >= t.holdRate && ((t.multiInputOverride === H.Input.MOUSE_OVERRIDES_TOUCH || t.multiInputOverride === H.Input.MOUSE_TOUCH_COMBINE || t.multiInputOverride === H.Input.TOUCH_OVERRIDES_MOUSE && 0 === t.totalActivePointers) && t.onHold.dispatch(this),
            this._holdSent = !0),
            t.recordPointerHistory && this.game.time.time >= this._nextDrop && (this._nextDrop = this.game.time.time + t.recordRate,
            this._history.push({
                x: this.position.x,
                y: this.position.y
            }),
            this._history.length > t.recordLimit && this._history.shift()))
        },
        move: function(t, e) {
            var i = this.game.input;
            if (!i.pollLocked) {
                void 0 === e && (e = !1),
                void 0 !== t.button && (this.button = t.button),
                e && this.isMouse && this.updateButtons(t),
                this.clientX = t.clientX,
                this.clientY = t.clientY,
                this.pageX = t.pageX,
                this.pageY = t.pageY,
                this.screenX = t.screenX,
                this.screenY = t.screenY,
                this.isMouse && i.mouse.locked && !e && (this.rawMovementX = t.movementX || t.mozMovementX || t.webkitMovementX || 0,
                this.rawMovementY = t.movementY || t.mozMovementY || t.webkitMovementY || 0,
                this.movementX += this.rawMovementX,
                this.movementY += this.rawMovementY),
                this.x = (this.pageX - this.game.scale.offset.x) * i.scale.x,
                this.y = (this.pageY - this.game.scale.offset.y) * i.scale.y,
                this.position.setTo(this.x, this.y),
                this.circle.x = this.x,
                this.circle.y = this.y,
                (i.multiInputOverride === H.Input.MOUSE_OVERRIDES_TOUCH || i.multiInputOverride === H.Input.MOUSE_TOUCH_COMBINE || i.multiInputOverride === H.Input.TOUCH_OVERRIDES_MOUSE && 0 === i.totalActivePointers) && (i.activePointer = this,
                i.x = this.x,
                i.y = this.y,
                i.position.setTo(i.x, i.y),
                i.circle.x = i.x,
                i.circle.y = i.y),
                this.withinGame = this.game.scale.bounds.contains(this.pageX, this.pageY);
                for (var s = i.moveCallbacks.length; s--; )
                    i.moveCallbacks[s].callback.call(i.moveCallbacks[s].context, this, this.x, this.y, e);
                return null !== this.targetObject && !0 === this.targetObject.isDragged ? !1 === this.targetObject.update(this) && (this.targetObject = null) : 0 < i.interactiveItems.total && this.processInteractiveObjects(e),
                this
            }
        },
        processInteractiveObjects: function(t) {
            var e = 0
              , i = -1
              , s = null
              , n = this.game.input.interactiveItems.first;
            for (this.interactiveCandidates = []; n; )
                n.checked = !1,
                n.validForInput(i, e, !1) && (n.checked = !0,
                (t && n.checkPointerDown(this, !0) || !t && n.checkPointerOver(this, !0)) && (e = n.sprite.renderOrderID,
                i = n.priorityID,
                s = n,
                this.interactiveCandidates.push(n))),
                n = this.game.input.interactiveItems.next;
            for (n = this.game.input.interactiveItems.first; n; )
                !n.checked && n.validForInput(i, e, !0) && (t && n.checkPointerDown(this, !1) || !t && n.checkPointerOver(this, !1)) && (e = n.sprite.renderOrderID,
                i = n.priorityID,
                s = n,
                this.interactiveCandidates.push(n)),
                n = this.game.input.interactiveItems.next;
            return this.game.input.customCandidateHandler && (s = this.game.input.customCandidateHandler.call(this.game.input.customCandidateHandlerContext, this, this.interactiveCandidates, s)),
            this.swapTarget(s, !1),
            null !== this.targetObject
        },
        swapTarget: function(t, e) {
            void 0 === e && (e = !1),
            null === t ? this.targetObject && (this.targetObject._pointerOutHandler(this, e),
            this.targetObject = null) : null === this.targetObject ? (this.targetObject = t)._pointerOverHandler(this, e) : this.targetObject === t ? !1 === t.update(this) && (this.targetObject = null) : (this.targetObject._pointerOutHandler(this, e),
            this.targetObject = t,
            this.targetObject._pointerOverHandler(this, e))
        },
        leave: function(t) {
            this.withinGame = !1,
            this.move(t, !1)
        },
        stop: function(t) {
            var e = this.game.input;
            return this._stateReset && this.withinGame ? void t.preventDefault() : (this.timeUp = this.game.time.time,
            (e.multiInputOverride === H.Input.MOUSE_OVERRIDES_TOUCH || e.multiInputOverride === H.Input.MOUSE_TOUCH_COMBINE || e.multiInputOverride === H.Input.TOUCH_OVERRIDES_MOUSE && 0 === e.totalActivePointers) && (e.onUp.dispatch(this, t),
            0 <= this.duration && this.duration <= e.tapRate && (this.timeUp - this.previousTapTime < e.doubleTapRate ? e.onTap.dispatch(this, !0) : e.onTap.dispatch(this, !1),
            this.previousTapTime = this.timeUp)),
            this.isMouse ? this.updateButtons(t) : (this.isDown = !1,
            this.isUp = !0),
            0 < this.id && (this.active = !1),
            this.withinGame = this.game.scale.bounds.contains(t.pageX, t.pageY),
            this.pointerId = null,
            this.identifier = null,
            this.positionUp.setTo(this.x, this.y),
            !1 === this.isMouse && e.currentPointers--,
            e.interactiveItems.callAll("_releasedHandler", this),
            this._clickTrampolines && (this._trampolineTargetObject = this.targetObject),
            this.targetObject = null,
            this)
        },
        justPressed: function(t) {
            return t = t || this.game.input.justPressedRate,
            !0 === this.isDown && this.timeDown + t > this.game.time.time
        },
        justReleased: function(t) {
            return t = t || this.game.input.justReleasedRate,
            this.isUp && this.timeUp + t > this.game.time.time
        },
        addClickTrampoline: function(t, e, i, s) {
            if (this.isDown) {
                for (var n = this._clickTrampolines = this._clickTrampolines || [], r = 0; r < n.length; r++)
                    if (n[r].name === t) {
                        n.splice(r, 1);
                        break
                    }
                n.push({
                    name: t,
                    targetObject: this.targetObject,
                    callback: e,
                    callbackContext: i,
                    callbackArgs: s
                })
            }
        },
        processClickTrampolines: function() {
            var t = this._clickTrampolines;
            if (t) {
                for (var e = 0; e < t.length; e++) {
                    var i = t[e];
                    i.targetObject === this._trampolineTargetObject && i.callback.apply(i.callbackContext, i.callbackArgs)
                }
                this._clickTrampolines = null,
                this._trampolineTargetObject = null
            }
        },
        reset: function() {
            !1 === this.isMouse && (this.active = !1),
            this.pointerId = null,
            this.identifier = null,
            this.dirty = !1,
            this.totalTouches = 0,
            this._holdSent = !1,
            this._history.length = 0,
            this._stateReset = !0,
            this.resetButtons(),
            this.targetObject && this.targetObject._releasedHandler(this),
            this.targetObject = null
        },
        resetMovement: function() {
            this.movementX = 0,
            this.movementY = 0
        }
    },
    H.Pointer.prototype.constructor = H.Pointer,
    Object.defineProperty(H.Pointer.prototype, "duration", {
        get: function() {
            return this.isUp ? -1 : this.game.time.time - this.timeDown
        }
    }),
    Object.defineProperty(H.Pointer.prototype, "worldX", {
        get: function() {
            return this.game.world.camera.x + this.x
        }
    }),
    Object.defineProperty(H.Pointer.prototype, "worldY", {
        get: function() {
            return this.game.world.camera.y + this.y
        }
    }),
    H.PointerMode = {
        CURSOR: 1,
        CONTACT: 2
    },
    H.Touch = function(t) {
        this.game = t,
        this.enabled = !0,
        this.touchLockCallbacks = [],
        this.callbackContext = this.game,
        this.touchStartCallback = null,
        this.touchMoveCallback = null,
        this.touchEndCallback = null,
        this.touchEnterCallback = null,
        this.touchLeaveCallback = null,
        this.touchCancelCallback = null,
        this.preventDefault = !0,
        this.event = null,
        this._onTouchStart = null,
        this._onTouchMove = null,
        this._onTouchEnd = null,
        this._onTouchEnter = null,
        this._onTouchLeave = null,
        this._onTouchCancel = null,
        this._onTouchMove = null
    }
    ,
    H.Touch.prototype = {
        start: function() {
            if (null === this._onTouchStart) {
                var e = this;
                this.game.device.touch && (this._onTouchStart = function(t) {
                    return e.onTouchStart(t)
                }
                ,
                this._onTouchMove = function(t) {
                    return e.onTouchMove(t)
                }
                ,
                this._onTouchEnd = function(t) {
                    return e.onTouchEnd(t)
                }
                ,
                this._onTouchEnter = function(t) {
                    return e.onTouchEnter(t)
                }
                ,
                this._onTouchLeave = function(t) {
                    return e.onTouchLeave(t)
                }
                ,
                this._onTouchCancel = function(t) {
                    return e.onTouchCancel(t)
                }
                ,
                this.game.canvas.addEventListener("touchstart", this._onTouchStart, !1),
                this.game.canvas.addEventListener("touchmove", this._onTouchMove, !1),
                this.game.canvas.addEventListener("touchend", this._onTouchEnd, !1),
                this.game.canvas.addEventListener("touchcancel", this._onTouchCancel, !1),
                this.game.device.cocoonJS || (this.game.canvas.addEventListener("touchenter", this._onTouchEnter, !1),
                this.game.canvas.addEventListener("touchleave", this._onTouchLeave, !1)))
            }
        },
        consumeDocumentTouches: function() {
            this._documentTouchMove = function(t) {
                t.preventDefault()
            }
            ,
            document.addEventListener("touchmove", this._documentTouchMove, !1)
        },
        addTouchLockCallback: function(t, e, i) {
            void 0 === i && (i = !1),
            this.touchLockCallbacks.push({
                callback: t,
                context: e,
                onEnd: i
            })
        },
        removeTouchLockCallback: function(t, e) {
            for (var i = this.touchLockCallbacks.length; i--; )
                if (this.touchLockCallbacks[i].callback === t && this.touchLockCallbacks[i].context === e)
                    return this.touchLockCallbacks.splice(i, 1),
                    !0;
            return !1
        },
        onTouchStart: function(t) {
            for (var e = this.touchLockCallbacks.length; e--; ) {
                var i = this.touchLockCallbacks[e];
                !i.onEnd && i.callback.call(i.context, this, t) && this.touchLockCallbacks.splice(e, 1)
            }
            if (this.event = t,
            this.game.input.enabled && this.enabled) {
                this.touchStartCallback && this.touchStartCallback.call(this.callbackContext, t),
                this.preventDefault && t.preventDefault();
                for (e = 0; e < t.changedTouches.length; e++)
                    this.game.input.startPointer(t.changedTouches[e])
            }
        },
        onTouchCancel: function(t) {
            if (this.event = t,
            this.touchCancelCallback && this.touchCancelCallback.call(this.callbackContext, t),
            this.game.input.enabled && this.enabled) {
                this.preventDefault && t.preventDefault();
                for (var e = 0; e < t.changedTouches.length; e++)
                    this.game.input.stopPointer(t.changedTouches[e])
            }
        },
        onTouchEnter: function(t) {
            this.event = t,
            this.touchEnterCallback && this.touchEnterCallback.call(this.callbackContext, t),
            this.game.input.enabled && this.enabled && this.preventDefault && t.preventDefault()
        },
        onTouchLeave: function(t) {
            this.event = t,
            this.touchLeaveCallback && this.touchLeaveCallback.call(this.callbackContext, t),
            this.preventDefault && t.preventDefault()
        },
        onTouchMove: function(t) {
            this.event = t,
            this.touchMoveCallback && this.touchMoveCallback.call(this.callbackContext, t),
            this.preventDefault && t.preventDefault();
            for (var e = 0; e < t.changedTouches.length; e++)
                this.game.input.updatePointer(t.changedTouches[e])
        },
        onTouchEnd: function(t) {
            for (var e = this.touchLockCallbacks.length; e--; ) {
                var i = this.touchLockCallbacks[e];
                i.onEnd && i.callback.call(i.context, this, t) && this.touchLockCallbacks.splice(e, 1)
            }
            this.event = t,
            this.touchEndCallback && this.touchEndCallback.call(this.callbackContext, t),
            this.preventDefault && t.preventDefault();
            for (e = 0; e < t.changedTouches.length; e++)
                this.game.input.stopPointer(t.changedTouches[e])
        },
        stop: function() {
            this.game.device.touch && (this.game.canvas.removeEventListener("touchstart", this._onTouchStart),
            this.game.canvas.removeEventListener("touchmove", this._onTouchMove),
            this.game.canvas.removeEventListener("touchend", this._onTouchEnd),
            this.game.canvas.removeEventListener("touchenter", this._onTouchEnter),
            this.game.canvas.removeEventListener("touchleave", this._onTouchLeave),
            this.game.canvas.removeEventListener("touchcancel", this._onTouchCancel))
        }
    },
    H.Touch.prototype.constructor = H.Touch,
    H.InputHandler = function(t) {
        this.sprite = t,
        this.game = t.game,
        this.enabled = !1,
        this.checked = !1,
        this.priorityID = 0,
        this.useHandCursor = !1,
        this._setHandCursor = !1,
        this.isDragged = !1,
        this.allowHorizontalDrag = !0,
        this.allowVerticalDrag = !0,
        this.bringToTop = !1,
        this.snapOffset = null,
        this.snapOnDrag = !1,
        this.snapOnRelease = !1,
        this.snapX = 0,
        this.snapY = 0,
        this.snapOffsetX = 0,
        this.snapOffsetY = 0,
        this.pixelPerfectOver = !1,
        this.pixelPerfectClick = !1,
        this.pixelPerfectAlpha = 255,
        this.draggable = !1,
        this.boundsRect = null,
        this.boundsSprite = null,
        this.scaleLayer = !1,
        this.dragOffset = new H.Point,
        this.dragFromCenter = !1,
        this.dragStopBlocksInputUp = !1,
        this.dragStartPoint = new H.Point,
        this.dragDistanceThreshold = 0,
        this.dragTimeThreshold = 0,
        this.downPoint = new H.Point,
        this.snapPoint = new H.Point,
        this._dragPoint = new H.Point,
        this._dragPhase = !1,
        this._pendingDrag = !1,
        this._dragTimePass = !1,
        this._dragDistancePass = !1,
        this._wasEnabled = !1,
        this._tempPoint = new H.Point,
        this._pointerData = [],
        this._pointerData.push({
            id: 0,
            x: 0,
            y: 0,
            camX: 0,
            camY: 0,
            isDown: !1,
            isUp: !1,
            isOver: !1,
            isOut: !1,
            timeOver: 0,
            timeOut: 0,
            timeDown: 0,
            timeUp: 0,
            downDuration: 0,
            isDragged: !1
        })
    }
    ,
    H.InputHandler.prototype = {
        start: function(t, e) {
            if (t = t || 0,
            void 0 === e && (e = !1),
            !1 === this.enabled) {
                this.game.input.interactiveItems.add(this),
                this.useHandCursor = e,
                this.priorityID = t;
                for (var i = 0; i < 10; i++)
                    this._pointerData[i] = {
                        id: i,
                        x: 0,
                        y: 0,
                        isDown: !1,
                        isUp: !1,
                        isOver: !1,
                        isOut: !1,
                        timeOver: 0,
                        timeOut: 0,
                        timeDown: 0,
                        timeUp: 0,
                        downDuration: 0,
                        isDragged: !1
                    };
                this.snapOffset = new H.Point,
                this.enabled = !0,
                this._wasEnabled = !0
            }
            return this.sprite.events.onAddedToGroup.add(this.addedToGroup, this),
            this.sprite.events.onRemovedFromGroup.add(this.removedFromGroup, this),
            this.sprite
        },
        addedToGroup: function() {
            this._dragPhase || this._wasEnabled && !this.enabled && this.start()
        },
        removedFromGroup: function() {
            this._dragPhase || (this.enabled ? (this._wasEnabled = !0,
            this.stop()) : this._wasEnabled = !1)
        },
        reset: function() {
            this.enabled = !1;
            for (var t = 0; t < 10; t++)
                this._pointerData[t] = {
                    id: t,
                    x: 0,
                    y: 0,
                    isDown: !1,
                    isUp: !1,
                    isOver: !1,
                    isOut: !1,
                    timeOver: 0,
                    timeOut: 0,
                    timeDown: 0,
                    timeUp: 0,
                    downDuration: 0,
                    isDragged: !1
                }
        },
        stop: function() {
            !1 !== this.enabled && (this.enabled = !1,
            this.game.input.interactiveItems.remove(this))
        },
        destroy: function() {
            this.sprite && (this._setHandCursor && (this.game.canvas.style.cursor = "default",
            this._setHandCursor = !1),
            this.enabled = !1,
            this.game.input.interactiveItems.remove(this),
            this._pointerData.length = 0,
            this.boundsRect = null,
            this.boundsSprite = null,
            this.sprite = null)
        },
        validForInput: function(t, e, i) {
            return void 0 === i && (i = !0),
            !(!this.enabled || 0 === this.sprite.scale.x || 0 === this.sprite.scale.y || this.priorityID < this.game.input.minPriorityID || this.sprite.parent && this.sprite.parent.ignoreChildInput || !i && (this.pixelPerfectClick || this.pixelPerfectOver) || !(this.priorityID > t || this.priorityID === t && this.sprite.renderOrderID > e))
        },
        isPixelPerfect: function() {
            return this.pixelPerfectClick || this.pixelPerfectOver
        },
        pointerX: function(t) {
            return t = t || 0,
            this._pointerData[t].x
        },
        pointerY: function(t) {
            return t = t || 0,
            this._pointerData[t].y
        },
        pointerDown: function(t) {
            return t = t || 0,
            this._pointerData[t].isDown
        },
        pointerUp: function(t) {
            return t = t || 0,
            this._pointerData[t].isUp
        },
        pointerTimeDown: function(t) {
            return t = t || 0,
            this._pointerData[t].timeDown
        },
        pointerTimeUp: function(t) {
            return t = t || 0,
            this._pointerData[t].timeUp
        },
        pointerOver: function(t) {
            if (!this.enabled)
                return !1;
            if (void 0 !== t)
                return this._pointerData[t].isOver;
            for (var e = 0; e < 10; e++)
                if (this._pointerData[e].isOver)
                    return !0;
            return !1
        },
        pointerOut: function(t) {
            if (!this.enabled)
                return !1;
            if (void 0 !== t)
                return this._pointerData[t].isOut;
            for (var e = 0; e < 10; e++)
                if (this._pointerData[e].isOut)
                    return !0
        },
        pointerTimeOver: function(t) {
            return t = t || 0,
            this._pointerData[t].timeOver
        },
        pointerTimeOut: function(t) {
            return t = t || 0,
            this._pointerData[t].timeOut
        },
        pointerDragged: function(t) {
            return t = t || 0,
            this._pointerData[t].isDragged
        },
        checkPointerDown: function(t, e) {
            return !!(t.isDown && this.enabled && this.sprite && this.sprite.parent && this.sprite.visible && this.sprite.parent.visible && 0 !== this.sprite.worldScale.x && 0 !== this.sprite.worldScale.y) && !!this.game.input.hitTest(this.sprite, t, this._tempPoint) && (void 0 === e && (e = !1),
            !(!e && this.pixelPerfectClick) || this.checkPixel(this._tempPoint.x, this._tempPoint.y))
        },
        checkPointerOver: function(t, e) {
            return !!(this.enabled && this.sprite && this.sprite.parent && this.sprite.visible && this.sprite.parent.visible && 0 !== this.sprite.worldScale.x && 0 !== this.sprite.worldScale.y) && !!this.game.input.hitTest(this.sprite, t, this._tempPoint) && (void 0 === e && (e = !1),
            !(!e && this.pixelPerfectOver) || this.checkPixel(this._tempPoint.x, this._tempPoint.y))
        },
        checkPixel: function(t, e, i) {
            if (this.sprite.texture.baseTexture.source) {
                if (null === t && null === e) {
                    this.game.input.getLocalPosition(this.sprite, i, this._tempPoint);
                    t = this._tempPoint.x,
                    e = this._tempPoint.y
                }
                if (0 !== this.sprite.anchor.x && (t -= -this.sprite.texture.frame.width * this.sprite.anchor.x),
                0 !== this.sprite.anchor.y && (e -= -this.sprite.texture.frame.height * this.sprite.anchor.y),
                t += this.sprite.texture.frame.x,
                e += this.sprite.texture.frame.y,
                this.sprite.texture.trim && (t -= this.sprite.texture.trim.x,
                e -= this.sprite.texture.trim.y,
                t < this.sprite.texture.crop.x || t > this.sprite.texture.crop.right || e < this.sprite.texture.crop.y || e > this.sprite.texture.crop.bottom))
                    return this._dx = t,
                    this._dy = e,
                    !1;
                if (this._dx = t,
                this._dy = e,
                this.game.input.hitContext.clearRect(0, 0, 1, 1),
                this.game.input.hitContext.drawImage(this.sprite.texture.baseTexture.source, t, e, 1, 1, 0, 0, 1, 1),
                this.game.input.hitContext.getImageData(0, 0, 1, 1).data[3] >= this.pixelPerfectAlpha)
                    return !0
            }
            return !1
        },
        update: function(t) {
            if (null !== this.sprite && void 0 !== this.sprite.parent)
                return this.enabled && this.sprite.visible && this.sprite.parent.visible ? this._pendingDrag ? (this._dragDistancePass || (this._dragDistancePass = H.Math.distance(t.x, t.y, this.downPoint.x, this.downPoint.y) >= this.dragDistanceThreshold),
                this._dragDistancePass && this._dragTimePass && this.startDrag(t),
                !0) : this.draggable && this._draggedPointerID === t.id ? this.updateDrag(t, !1) : this._pointerData[t.id].isOver ? this.checkPointerOver(t) ? (this._pointerData[t.id].x = t.x - this.sprite.x,
                this._pointerData[t.id].y = t.y - this.sprite.y,
                !0) : (this._pointerOutHandler(t),
                !1) : void 0 : (this._pointerOutHandler(t),
                !1)
        },
        _pointerOverHandler: function(t, e) {
            if (null !== this.sprite) {
                var i = this._pointerData[t.id];
                if (!1 === i.isOver || t.dirty) {
                    var s = !1 === i.isOver;
                    i.isOver = !0,
                    i.isOut = !1,
                    i.timeOver = this.game.time.time,
                    i.x = t.x - this.sprite.x,
                    i.y = t.y - this.sprite.y,
                    this.useHandCursor && !1 === i.isDragged && (this.game.canvas.style.cursor = "pointer",
                    this._setHandCursor = !0),
                    !e && s && this.sprite && this.sprite.events && this.sprite.events.onInputOver$dispatch(this.sprite, t),
                    this.sprite.parent && this.sprite.parent.type === H.GROUP && this.sprite.parent.onChildInputOver.dispatch(this.sprite, t)
                }
            }
        },
        _pointerOutHandler: function(t, e) {
            if (null !== this.sprite) {
                var i = this._pointerData[t.id];
                i.isOver = !1,
                i.isOut = !0,
                i.timeOut = this.game.time.time,
                this.useHandCursor && !1 === i.isDragged && (this.game.canvas.style.cursor = "default",
                this._setHandCursor = !1),
                !e && this.sprite && this.sprite.events && (this.sprite.events.onInputOut$dispatch(this.sprite, t),
                this.sprite && this.sprite.parent && this.sprite.parent.type === H.GROUP && this.sprite.parent.onChildInputOut.dispatch(this.sprite, t))
            }
        },
        _touchedHandler: function(t) {
            if (null !== this.sprite) {
                var e = this._pointerData[t.id];
                if (!e.isDown && e.isOver) {
                    if (this.pixelPerfectClick && !this.checkPixel(null, null, t))
                        return;
                    if (e.isDown = !0,
                    e.isUp = !1,
                    e.timeDown = this.game.time.time,
                    this.downPoint.set(t.x, t.y),
                    t.dirty = !0,
                    this.sprite && this.sprite.events && (this.sprite.events.onInputDown$dispatch(this.sprite, t),
                    this.sprite && this.sprite.parent && this.sprite.parent.type === H.GROUP && this.sprite.parent.onChildInputDown.dispatch(this.sprite, t),
                    null === this.sprite))
                        return;
                    this.draggable && !1 === this.isDragged && (0 === this.dragTimeThreshold && 0 === this.dragDistanceThreshold ? this.startDrag(t) : (this._pendingDrag = !0,
                    this._dragDistancePass = 0 === this.dragDistanceThreshold,
                    0 < this.dragTimeThreshold ? (this._dragTimePass = !1,
                    this.game.time.events.add(this.dragTimeThreshold, this.dragTimeElapsed, this, t)) : this._dragTimePass = !0)),
                    this.bringToTop && this.sprite.bringToTop()
                }
            }
        },
        dragTimeElapsed: function(t) {
            this._dragTimePass = !0,
            this._pendingDrag && this.sprite && this._dragDistancePass && this.startDrag(t)
        },
        _releasedHandler: function(t) {
            if (null !== this.sprite) {
                var e = this._pointerData[t.id];
                if (e.isDown && t.isUp) {
                    e.isDown = !1,
                    e.isUp = !0,
                    e.timeUp = this.game.time.time,
                    e.downDuration = e.timeUp - e.timeDown;
                    var i = this.checkPointerOver(t);
                    this.sprite && this.sprite.events && (this.dragStopBlocksInputUp && (!this.dragStopBlocksInputUp || this.draggable && this.isDragged && this._draggedPointerID === t.id) || this.sprite.events.onInputUp$dispatch(this.sprite, t, i),
                    this.sprite && this.sprite.parent && this.sprite.parent.type === H.GROUP && this.sprite.parent.onChildInputUp.dispatch(this.sprite, t, i),
                    i && (i = this.checkPointerOver(t))),
                    !(e.isOver = i) && this.useHandCursor && (this.game.canvas.style.cursor = "default",
                    this._setHandCursor = !1),
                    t.dirty = !0,
                    this._pendingDrag = !1,
                    this.draggable && this.isDragged && this._draggedPointerID === t.id && this.stopDrag(t)
                }
            }
        },
        updateDrag: function(t, e) {
            if (void 0 === e && (e = !1),
            t.isUp)
                return this.stopDrag(t),
                !1;
            var i = this.globalToLocalX(t.x) + this._dragPoint.x + this.dragOffset.x
              , s = this.globalToLocalY(t.y) + this._dragPoint.y + this.dragOffset.y;
            if (this.sprite.fixedToCamera)
                this.allowHorizontalDrag && (this.sprite.cameraOffset.x = i),
                this.allowVerticalDrag && (this.sprite.cameraOffset.y = s),
                this.boundsRect && this.checkBoundsRect(),
                this.boundsSprite && this.checkBoundsSprite(),
                this.snapOnDrag && (this.sprite.cameraOffset.x = Math.round((this.sprite.cameraOffset.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX,
                this.sprite.cameraOffset.y = Math.round((this.sprite.cameraOffset.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY,
                this.snapPoint.set(this.sprite.cameraOffset.x, this.sprite.cameraOffset.y));
            else {
                var n = this.game.camera.x - this._pointerData[t.id].camX
                  , r = this.game.camera.y - this._pointerData[t.id].camY;
                this.allowHorizontalDrag && (this.sprite.x = i + n),
                this.allowVerticalDrag && (this.sprite.y = s + r),
                this.boundsRect && this.checkBoundsRect(),
                this.boundsSprite && this.checkBoundsSprite(),
                this.snapOnDrag && (this.sprite.x = Math.round((this.sprite.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX,
                this.sprite.y = Math.round((this.sprite.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY,
                this.snapPoint.set(this.sprite.x, this.sprite.y))
            }
            return this.sprite.events.onDragUpdate.dispatch(this.sprite, t, i, s, this.snapPoint, e),
            !0
        },
        justOver: function(t, e) {
            return t = t || 0,
            e = e || 500,
            this._pointerData[t].isOver && this.overDuration(t) < e
        },
        justOut: function(t, e) {
            return t = t || 0,
            e = e || 500,
            this._pointerData[t].isOut && this.game.time.time - this._pointerData[t].timeOut < e
        },
        justPressed: function(t, e) {
            return t = t || 0,
            e = e || 500,
            this._pointerData[t].isDown && this.downDuration(t) < e
        },
        justReleased: function(t, e) {
            return t = t || 0,
            e = e || 500,
            this._pointerData[t].isUp && this.game.time.time - this._pointerData[t].timeUp < e
        },
        overDuration: function(t) {
            return t = t || 0,
            this._pointerData[t].isOver ? this.game.time.time - this._pointerData[t].timeOver : -1
        },
        downDuration: function(t) {
            return t = t || 0,
            this._pointerData[t].isDown ? this.game.time.time - this._pointerData[t].timeDown : -1
        },
        enableDrag: function(t, e, i, s, n, r) {
            void 0 === t && (t = !1),
            void 0 === e && (e = !1),
            void 0 === i && (i = !1),
            void 0 === s && (s = 255),
            void 0 === n && (n = null),
            void 0 === r && (r = null),
            this._dragPoint = new H.Point,
            this.draggable = !0,
            this.bringToTop = e,
            this.dragOffset = new H.Point,
            this.dragFromCenter = t,
            this.pixelPerfectClick = i,
            this.pixelPerfectAlpha = s,
            n && (this.boundsRect = n),
            r && (this.boundsSprite = r)
        },
        disableDrag: function() {
            if (this._pointerData)
                for (var t = 0; t < 10; t++)
                    this._pointerData[t].isDragged = !1;
            this.draggable = !1,
            this.isDragged = !1,
            this._draggedPointerID = -1,
            this._pendingDrag = !1
        },
        startDrag: function(t) {
            var e = this.sprite.x
              , i = this.sprite.y;
            if (this.isDragged = !0,
            this._draggedPointerID = t.id,
            this._pointerData[t.id].camX = this.game.camera.x,
            this._pointerData[t.id].camY = this.game.camera.y,
            this._pointerData[t.id].isDragged = !0,
            this.sprite.fixedToCamera) {
                if (this.dragFromCenter) {
                    var s = this.sprite.getBounds();
                    this.sprite.cameraOffset.x = this.globalToLocalX(t.x) + (this.sprite.cameraOffset.x - s.centerX),
                    this.sprite.cameraOffset.y = this.globalToLocalY(t.y) + (this.sprite.cameraOffset.y - s.centerY)
                }
                this._dragPoint.setTo(this.sprite.cameraOffset.x - t.x, this.sprite.cameraOffset.y - t.y)
            } else {
                if (this.dragFromCenter) {
                    s = this.sprite.getBounds();
                    this.sprite.x = this.globalToLocalX(t.x) + (this.sprite.x - s.centerX),
                    this.sprite.y = this.globalToLocalY(t.y) + (this.sprite.y - s.centerY)
                }
                this._dragPoint.setTo(this.sprite.x - this.globalToLocalX(t.x), this.sprite.y - this.globalToLocalY(t.y))
            }
            this.updateDrag(t, !0),
            this.bringToTop && (this._dragPhase = !0,
            this.sprite.bringToTop()),
            this.dragStartPoint.set(e, i),
            this.sprite.events.onDragStart$dispatch(this.sprite, t, e, i),
            this._pendingDrag = !1
        },
        globalToLocalX: function(t) {
            return this.scaleLayer && (t -= this.game.scale.grid.boundsFluid.x,
            t *= this.game.scale.grid.scaleFluidInversed.x),
            t
        },
        globalToLocalY: function(t) {
            return this.scaleLayer && (t -= this.game.scale.grid.boundsFluid.y,
            t *= this.game.scale.grid.scaleFluidInversed.y),
            t
        },
        stopDrag: function(t) {
            this.isDragged = !1,
            this._draggedPointerID = -1,
            this._pointerData[t.id].isDragged = !1,
            this._dragPhase = !1,
            this._pendingDrag = !1,
            this.snapOnRelease && (this.sprite.fixedToCamera ? (this.sprite.cameraOffset.x = Math.round((this.sprite.cameraOffset.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX,
            this.sprite.cameraOffset.y = Math.round((this.sprite.cameraOffset.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY) : (this.sprite.x = Math.round((this.sprite.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX,
            this.sprite.y = Math.round((this.sprite.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY)),
            this.sprite.events.onDragStop$dispatch(this.sprite, t),
            !1 === this.checkPointerOver(t) && this._pointerOutHandler(t)
        },
        setDragLock: function(t, e) {
            void 0 === t && (t = !0),
            void 0 === e && (e = !0),
            this.allowHorizontalDrag = t,
            this.allowVerticalDrag = e
        },
        enableSnap: function(t, e, i, s, n, r) {
            void 0 === i && (i = !0),
            void 0 === s && (s = !1),
            void 0 === n && (n = 0),
            void 0 === r && (r = 0),
            this.snapX = t,
            this.snapY = e,
            this.snapOffsetX = n,
            this.snapOffsetY = r,
            this.snapOnDrag = i,
            this.snapOnRelease = s
        },
        disableSnap: function() {
            this.snapOnDrag = !1,
            this.snapOnRelease = !1
        },
        checkBoundsRect: function() {
            this.sprite.fixedToCamera ? (this.sprite.cameraOffset.x < this.boundsRect.left ? this.sprite.cameraOffset.x = this.boundsRect.left : this.sprite.cameraOffset.x + this.sprite.width > this.boundsRect.right && (this.sprite.cameraOffset.x = this.boundsRect.right - this.sprite.width),
            this.sprite.cameraOffset.y < this.boundsRect.top ? this.sprite.cameraOffset.y = this.boundsRect.top : this.sprite.cameraOffset.y + this.sprite.height > this.boundsRect.bottom && (this.sprite.cameraOffset.y = this.boundsRect.bottom - this.sprite.height)) : (this.sprite.left < this.boundsRect.left ? this.sprite.x = this.boundsRect.x + this.sprite.offsetX : this.sprite.right > this.boundsRect.right && (this.sprite.x = this.boundsRect.right - (this.sprite.width - this.sprite.offsetX)),
            this.sprite.top < this.boundsRect.top ? this.sprite.y = this.boundsRect.top + this.sprite.offsetY : this.sprite.bottom > this.boundsRect.bottom && (this.sprite.y = this.boundsRect.bottom - (this.sprite.height - this.sprite.offsetY)))
        },
        checkBoundsSprite: function() {
            this.sprite.fixedToCamera && this.boundsSprite.fixedToCamera ? (this.sprite.cameraOffset.x < this.boundsSprite.cameraOffset.x ? this.sprite.cameraOffset.x = this.boundsSprite.cameraOffset.x : this.sprite.cameraOffset.x + this.sprite.width > this.boundsSprite.cameraOffset.x + this.boundsSprite.width && (this.sprite.cameraOffset.x = this.boundsSprite.cameraOffset.x + this.boundsSprite.width - this.sprite.width),
            this.sprite.cameraOffset.y < this.boundsSprite.cameraOffset.y ? this.sprite.cameraOffset.y = this.boundsSprite.cameraOffset.y : this.sprite.cameraOffset.y + this.sprite.height > this.boundsSprite.cameraOffset.y + this.boundsSprite.height && (this.sprite.cameraOffset.y = this.boundsSprite.cameraOffset.y + this.boundsSprite.height - this.sprite.height)) : (this.sprite.left < this.boundsSprite.left ? this.sprite.x = this.boundsSprite.left + this.sprite.offsetX : this.sprite.right > this.boundsSprite.right && (this.sprite.x = this.boundsSprite.right - (this.sprite.width - this.sprite.offsetX)),
            this.sprite.top < this.boundsSprite.top ? this.sprite.y = this.boundsSprite.top + this.sprite.offsetY : this.sprite.bottom > this.boundsSprite.bottom && (this.sprite.y = this.boundsSprite.bottom - (this.sprite.height - this.sprite.offsetY)))
        }
    },
    H.InputHandler.prototype.constructor = H.InputHandler,
    H.Gamepad = function(t) {
        this.game = t,
        this._gamepadIndexMap = {},
        this._rawPads = [],
        this._active = !1,
        this.enabled = !0,
        this._gamepadSupportAvailable = !!navigator.webkitGetGamepads || !!navigator.webkitGamepads || -1 !== navigator.userAgent.indexOf("Firefox/") || !!navigator.getGamepads,
        this._prevRawGamepadTypes = [],
        this._prevTimestamps = [],
        (this.callbackContext = this).onConnectCallback = null,
        this.onDisconnectCallback = null,
        this.onDownCallback = null,
        this.onUpCallback = null,
        this.onAxisCallback = null,
        this.onFloatCallback = null,
        this._ongamepadconnected = null,
        this._gamepaddisconnected = null,
        this._gamepads = [new H.SinglePad(t,this), new H.SinglePad(t,this), new H.SinglePad(t,this), new H.SinglePad(t,this)]
    }
    ,
    H.Gamepad.prototype = {
        addCallbacks: function(t, e) {
            void 0 !== e && (this.onConnectCallback = "function" == typeof e.onConnect ? e.onConnect : this.onConnectCallback,
            this.onDisconnectCallback = "function" == typeof e.onDisconnect ? e.onDisconnect : this.onDisconnectCallback,
            this.onDownCallback = "function" == typeof e.onDown ? e.onDown : this.onDownCallback,
            this.onUpCallback = "function" == typeof e.onUp ? e.onUp : this.onUpCallback,
            this.onAxisCallback = "function" == typeof e.onAxis ? e.onAxis : this.onAxisCallback,
            this.onFloatCallback = "function" == typeof e.onFloat ? e.onFloat : this.onFloatCallback,
            this.callbackContext = t)
        },
        start: function() {
            if (!this._active) {
                this._active = !0;
                var e = this;
                this._onGamepadConnected = function(t) {
                    return e.onGamepadConnected(t)
                }
                ,
                this._onGamepadDisconnected = function(t) {
                    return e.onGamepadDisconnected(t)
                }
                ,
                window.addEventListener("gamepadconnected", this._onGamepadConnected, !1),
                window.addEventListener("gamepaddisconnected", this._onGamepadDisconnected, !1)
            }
        },
        onGamepadConnected: function(t) {
            var e = t.gamepad;
            this._rawPads.push(e),
            this._gamepads[e.index].connect(e)
        },
        onGamepadDisconnected: function(t) {
            var e = t.gamepad;
            for (var i in this._rawPads)
                this._rawPads[i].index === e.index && this._rawPads.splice(i, 1);
            this._gamepads[e.index].disconnect()
        },
        update: function() {
            this._pollGamepads(),
            this.pad1.pollStatus(),
            this.pad2.pollStatus(),
            this.pad3.pollStatus(),
            this.pad4.pollStatus()
        },
        _pollGamepads: function() {
            if (this._active) {
                if (navigator.getGamepads)
                    var t = navigator.getGamepads();
                else if (navigator.webkitGetGamepads)
                    t = navigator.webkitGetGamepads();
                else if (navigator.webkitGamepads)
                    t = navigator.webkitGamepads();
                if (t) {
                    for (var e = !(this._rawPads = []), i = 0; i < t.length && (typeof t[i] !== this._prevRawGamepadTypes[i] && (e = !0,
                    this._prevRawGamepadTypes[i] = typeof t[i]),
                    t[i] && this._rawPads.push(t[i]),
                    3 !== i); i++)
                        ;
                    for (var s = 0; s < this._gamepads.length; s++)
                        this._gamepads[s]._rawPad = this._rawPads[s];
                    if (e) {
                        for (var n, r = {
                            rawIndices: {},
                            padIndices: {}
                        }, o = 0; o < this._gamepads.length; o++)
                            if ((n = this._gamepads[o]).connected)
                                for (var a = 0; a < this._rawPads.length; a++)
                                    this._rawPads[a].index === n.index && (r.rawIndices[n.index] = !0,
                                    r.padIndices[o] = !0);
                        for (var h = 0; h < this._gamepads.length; h++)
                            if (n = this._gamepads[h],
                            !r.padIndices[h]) {
                                this._rawPads.length < 1 && n.disconnect();
                                for (var l = 0; l < this._rawPads.length && !r.padIndices[h]; l++) {
                                    var c = this._rawPads[l];
                                    if (c) {
                                        if (r.rawIndices[c.index]) {
                                            n.disconnect();
                                            continue
                                        }
                                        n.connect(c),
                                        r.rawIndices[c.index] = !0,
                                        r.padIndices[h] = !0
                                    } else
                                        n.disconnect()
                                }
                            }
                    }
                }
            }
        },
        setDeadZones: function(t) {
            for (var e = 0; e < this._gamepads.length; e++)
                this._gamepads[e].deadZone = t
        },
        stop: function() {
            this._active = !1,
            window.removeEventListener("gamepadconnected", this._onGamepadConnected),
            window.removeEventListener("gamepaddisconnected", this._onGamepadDisconnected)
        },
        reset: function() {
            this.update();
            for (var t = 0; t < this._gamepads.length; t++)
                this._gamepads[t].reset()
        },
        justPressed: function(t, e) {
            for (var i = 0; i < this._gamepads.length; i++)
                if (!0 === this._gamepads[i].justPressed(t, e))
                    return !0;
            return !1
        },
        justReleased: function(t, e) {
            for (var i = 0; i < this._gamepads.length; i++)
                if (!0 === this._gamepads[i].justReleased(t, e))
                    return !0;
            return !1
        },
        isDown: function(t) {
            for (var e = 0; e < this._gamepads.length; e++)
                if (!0 === this._gamepads[e].isDown(t))
                    return !0;
            return !1
        },
        destroy: function() {
            this.stop();
            for (var t = 0; t < this._gamepads.length; t++)
                this._gamepads[t].destroy()
        }
    },
    H.Gamepad.prototype.constructor = H.Gamepad,
    Object.defineProperty(H.Gamepad.prototype, "active", {
        get: function() {
            return this._active
        }
    }),
    Object.defineProperty(H.Gamepad.prototype, "supported", {
        get: function() {
            return this._gamepadSupportAvailable
        }
    }),
    Object.defineProperty(H.Gamepad.prototype, "padsConnected", {
        get: function() {
            return this._rawPads.length
        }
    }),
    Object.defineProperty(H.Gamepad.prototype, "pad1", {
        get: function() {
            return this._gamepads[0]
        }
    }),
    Object.defineProperty(H.Gamepad.prototype, "pad2", {
        get: function() {
            return this._gamepads[1]
        }
    }),
    Object.defineProperty(H.Gamepad.prototype, "pad3", {
        get: function() {
            return this._gamepads[2]
        }
    }),
    Object.defineProperty(H.Gamepad.prototype, "pad4", {
        get: function() {
            return this._gamepads[3]
        }
    }),
    H.Gamepad.BUTTON_0 = 0,
    H.Gamepad.BUTTON_1 = 1,
    H.Gamepad.BUTTON_2 = 2,
    H.Gamepad.BUTTON_3 = 3,
    H.Gamepad.BUTTON_4 = 4,
    H.Gamepad.BUTTON_5 = 5,
    H.Gamepad.BUTTON_6 = 6,
    H.Gamepad.BUTTON_7 = 7,
    H.Gamepad.BUTTON_8 = 8,
    H.Gamepad.BUTTON_9 = 9,
    H.Gamepad.BUTTON_10 = 10,
    H.Gamepad.BUTTON_11 = 11,
    H.Gamepad.BUTTON_12 = 12,
    H.Gamepad.BUTTON_13 = 13,
    H.Gamepad.BUTTON_14 = 14,
    H.Gamepad.BUTTON_15 = 15,
    H.Gamepad.AXIS_0 = 0,
    H.Gamepad.AXIS_1 = 1,
    H.Gamepad.AXIS_2 = 2,
    H.Gamepad.AXIS_3 = 3,
    H.Gamepad.AXIS_4 = 4,
    H.Gamepad.AXIS_5 = 5,
    H.Gamepad.AXIS_6 = 6,
    H.Gamepad.AXIS_7 = 7,
    H.Gamepad.AXIS_8 = 8,
    H.Gamepad.AXIS_9 = 9,
    H.Gamepad.XBOX360_A = 0,
    H.Gamepad.XBOX360_B = 1,
    H.Gamepad.XBOX360_X = 2,
    H.Gamepad.XBOX360_Y = 3,
    H.Gamepad.XBOX360_LEFT_BUMPER = 4,
    H.Gamepad.XBOX360_RIGHT_BUMPER = 5,
    H.Gamepad.XBOX360_LEFT_TRIGGER = 6,
    H.Gamepad.XBOX360_RIGHT_TRIGGER = 7,
    H.Gamepad.XBOX360_BACK = 8,
    H.Gamepad.XBOX360_START = 9,
    H.Gamepad.XBOX360_STICK_LEFT_BUTTON = 10,
    H.Gamepad.XBOX360_STICK_RIGHT_BUTTON = 11,
    H.Gamepad.XBOX360_DPAD_LEFT = 14,
    H.Gamepad.XBOX360_DPAD_RIGHT = 15,
    H.Gamepad.XBOX360_DPAD_UP = 12,
    H.Gamepad.XBOX360_DPAD_DOWN = 13,
    H.Gamepad.XBOX360_STICK_LEFT_X = 0,
    H.Gamepad.XBOX360_STICK_LEFT_Y = 1,
    H.Gamepad.XBOX360_STICK_RIGHT_X = 2,
    H.Gamepad.XBOX360_STICK_RIGHT_Y = 3,
    H.Gamepad.PS3XC_X = 0,
    H.Gamepad.PS3XC_CIRCLE = 1,
    H.Gamepad.PS3XC_SQUARE = 2,
    H.Gamepad.PS3XC_TRIANGLE = 3,
    H.Gamepad.PS3XC_L1 = 4,
    H.Gamepad.PS3XC_R1 = 5,
    H.Gamepad.PS3XC_L2 = 6,
    H.Gamepad.PS3XC_R2 = 7,
    H.Gamepad.PS3XC_SELECT = 8,
    H.Gamepad.PS3XC_START = 9,
    H.Gamepad.PS3XC_STICK_LEFT_BUTTON = 10,
    H.Gamepad.PS3XC_STICK_RIGHT_BUTTON = 11,
    H.Gamepad.PS3XC_DPAD_UP = 12,
    H.Gamepad.PS3XC_DPAD_DOWN = 13,
    H.Gamepad.PS3XC_DPAD_LEFT = 14,
    H.Gamepad.PS3XC_DPAD_RIGHT = 15,
    H.Gamepad.PS3XC_STICK_LEFT_X = 0,
    H.Gamepad.PS3XC_STICK_LEFT_Y = 1,
    H.Gamepad.PS3XC_STICK_RIGHT_X = 2,
    H.Gamepad.PS3XC_STICK_RIGHT_Y = 3,
    H.SinglePad = function(t, e) {
        this.game = t,
        this.index = null,
        this.connected = !1,
        (this.callbackContext = this).onConnectCallback = null,
        this.onDisconnectCallback = null,
        this.onDownCallback = null,
        this.onUpCallback = null,
        this.onAxisCallback = null,
        this.onFloatCallback = null,
        this.deadZone = .26,
        this._padParent = e,
        this._rawPad = null,
        this._prevTimestamp = null,
        this._buttons = [],
        this._buttonsLen = 0,
        this._axes = [],
        this._axesLen = 0
    }
    ,
    H.SinglePad.prototype = {
        addCallbacks: function(t, e) {
            void 0 !== e && (this.onConnectCallback = "function" == typeof e.onConnect ? e.onConnect : this.onConnectCallback,
            this.onDisconnectCallback = "function" == typeof e.onDisconnect ? e.onDisconnect : this.onDisconnectCallback,
            this.onDownCallback = "function" == typeof e.onDown ? e.onDown : this.onDownCallback,
            this.onUpCallback = "function" == typeof e.onUp ? e.onUp : this.onUpCallback,
            this.onAxisCallback = "function" == typeof e.onAxis ? e.onAxis : this.onAxisCallback,
            this.onFloatCallback = "function" == typeof e.onFloat ? e.onFloat : this.onFloatCallback,
            this.callbackContext = t)
        },
        getButton: function(t) {
            return this._buttons[t] ? this._buttons[t] : null
        },
        pollStatus: function() {
            if (this.connected && this.game.input.enabled && this.game.input.gamepad.enabled && (!this._rawPad.timestamp || this._rawPad.timestamp !== this._prevTimestamp)) {
                for (var t = 0; t < this._buttonsLen; t++) {
                    var e = isNaN(this._rawPad.buttons[t]) ? this._rawPad.buttons[t].value : this._rawPad.buttons[t];
                    e !== this._buttons[t].value && (1 === e ? this.processButtonDown(t, e) : 0 === e ? this.processButtonUp(t, e) : this.processButtonFloat(t, e))
                }
                for (var i = 0; i < this._axesLen; i++) {
                    var s = this._rawPad.axes[i];
                    0 < s && s > this.deadZone || s < 0 && s < -this.deadZone ? this.processAxisChange(i, s) : this.processAxisChange(i, 0)
                }
                this._prevTimestamp = this._rawPad.timestamp
            }
        },
        connect: function(t) {
            var e = !this.connected;
            this.connected = !0,
            this.index = t.index,
            this._rawPad = t,
            this._buttons = [],
            this._buttonsLen = t.buttons.length,
            this._axes = [],
            this._axesLen = t.axes.length;
            for (var i = 0; i < this._axesLen; i++)
                this._axes[i] = t.axes[i];
            for (var s in t.buttons)
                s = parseInt(s, 10),
                this._buttons[s] = new H.DeviceButton(this,s);
            e && this._padParent.onConnectCallback && this._padParent.onConnectCallback.call(this._padParent.callbackContext, this.index),
            e && this.onConnectCallback && this.onConnectCallback.call(this.callbackContext)
        },
        disconnect: function() {
            var t = this.connected
              , e = this.index;
            this.connected = !1,
            this.index = null,
            this._rawPad = void 0;
            for (var i = 0; i < this._buttonsLen; i++)
                this._buttons[i].destroy();
            this._buttons = [],
            this._buttonsLen = 0,
            this._axes = [],
            this._axesLen = 0,
            t && this._padParent.onDisconnectCallback && this._padParent.onDisconnectCallback.call(this._padParent.callbackContext, e),
            t && this.onDisconnectCallback && this.onDisconnectCallback.call(this.callbackContext)
        },
        destroy: function() {
            this._rawPad = void 0;
            for (var t = 0; t < this._buttonsLen; t++)
                this._buttons[t].destroy();
            this._buttons = [],
            this._buttonsLen = 0,
            this._axes = [],
            this._axesLen = 0,
            this.onConnectCallback = null,
            this.onDisconnectCallback = null,
            this.onDownCallback = null,
            this.onUpCallback = null,
            this.onAxisCallback = null,
            this.onFloatCallback = null
        },
        processAxisChange: function(t, e) {
            this._axes[t] !== e && (this._axes[t] = e,
            this._padParent.onAxisCallback && this._padParent.onAxisCallback.call(this._padParent.callbackContext, this, t, e),
            this.onAxisCallback && this.onAxisCallback.call(this.callbackContext, this, t, e))
        },
        processButtonDown: function(t, e) {
            this._buttons[t] && this._buttons[t].start(null, e),
            this._padParent.onDownCallback && this._padParent.onDownCallback.call(this._padParent.callbackContext, t, e, this.index),
            this.onDownCallback && this.onDownCallback.call(this.callbackContext, t, e)
        },
        processButtonUp: function(t, e) {
            this._padParent.onUpCallback && this._padParent.onUpCallback.call(this._padParent.callbackContext, t, e, this.index),
            this.onUpCallback && this.onUpCallback.call(this.callbackContext, t, e),
            this._buttons[t] && this._buttons[t].stop(null, e)
        },
        processButtonFloat: function(t, e) {
            this._padParent.onFloatCallback && this._padParent.onFloatCallback.call(this._padParent.callbackContext, t, e, this.index),
            this.onFloatCallback && this.onFloatCallback.call(this.callbackContext, t, e),
            this._buttons[t] && this._buttons[t].padFloat(e)
        },
        axis: function(t) {
            return !!this._axes[t] && this._axes[t]
        },
        isDown: function(t) {
            return !!this._buttons[t] && this._buttons[t].isDown
        },
        isUp: function(t) {
            return !!this._buttons[t] && this._buttons[t].isUp
        },
        justReleased: function(t, e) {
            if (this._buttons[t])
                return this._buttons[t].justReleased(e)
        },
        justPressed: function(t, e) {
            if (this._buttons[t])
                return this._buttons[t].justPressed(e)
        },
        buttonValue: function(t) {
            return this._buttons[t] ? this._buttons[t].value : null
        },
        reset: function() {
            for (var t = 0; t < this._axes.length; t++)
                this._axes[t] = 0
        }
    },
    H.SinglePad.prototype.constructor = H.SinglePad,
    H.Key = function(t, e) {
        this.game = t,
        this._enabled = !0,
        this.event = null,
        this.isDown = !1,
        this.isUp = !0,
        this.altKey = !1,
        this.ctrlKey = !1,
        this.shiftKey = !1,
        this.timeDown = 0,
        this.duration = 0,
        this.timeUp = -2500,
        this.repeats = 0,
        this.keyCode = e,
        this.onDown = new H.Signal,
        this.onHoldCallback = null,
        this.onHoldContext = null,
        this.onUp = new H.Signal,
        this._justDown = !1,
        this._justUp = !1
    }
    ,
    H.Key.prototype = {
        update: function() {
            this._enabled && this.isDown && (this.duration = this.game.time.time - this.timeDown,
            this.repeats++,
            this.onHoldCallback && this.onHoldCallback.call(this.onHoldContext, this))
        },
        processKeyDown: function(t) {
            this._enabled && (this.event = t,
            this.isDown || (this.altKey = t.altKey,
            this.ctrlKey = t.ctrlKey,
            this.shiftKey = t.shiftKey,
            this.isDown = !0,
            this.isUp = !1,
            this.timeDown = this.game.time.time,
            this.duration = 0,
            this.repeats = 0,
            this._justDown = !0,
            this.onDown.dispatch(this)))
        },
        processKeyUp: function(t) {
            this._enabled && (this.event = t,
            this.isUp || (this.isDown = !1,
            this.isUp = !0,
            this.timeUp = this.game.time.time,
            this.duration = this.game.time.time - this.timeDown,
            this._justUp = !0,
            this.onUp.dispatch(this)))
        },
        reset: function(t) {
            void 0 === t && (t = !0),
            this.isDown = !1,
            this.isUp = !0,
            this.timeUp = this.game.time.time,
            this.duration = 0,
            this._enabled = !0,
            this._justDown = !1,
            this._justUp = !1,
            t && (this.onDown.removeAll(),
            this.onUp.removeAll(),
            this.onHoldCallback = null,
            this.onHoldContext = null)
        },
        downDuration: function(t) {
            return void 0 === t && (t = 50),
            this.isDown && this.duration < t
        },
        upDuration: function(t) {
            return void 0 === t && (t = 50),
            !this.isDown && this.game.time.time - this.timeUp < t
        }
    },
    Object.defineProperty(H.Key.prototype, "justDown", {
        get: function() {
            var t = this._justDown;
            return this._justDown = !1,
            t
        }
    }),
    Object.defineProperty(H.Key.prototype, "justUp", {
        get: function() {
            var t = this._justUp;
            return this._justUp = !1,
            t
        }
    }),
    Object.defineProperty(H.Key.prototype, "enabled", {
        get: function() {
            return this._enabled
        },
        set: function(t) {
            (t = !!t) !== this._enabled && (t || this.reset(!1),
            this._enabled = t)
        }
    }),
    H.Key.prototype.constructor = H.Key,
    H.Keyboard = function(t) {
        this.game = t,
        this.enabled = !0,
        this.event = null,
        this.pressEvent = null,
        (this.callbackContext = this).onDownCallback = null,
        this.onPressCallback = null,
        this.onUpCallback = null,
        this._keys = [],
        this._capture = [],
        this._onKeyDown = null,
        this._onKeyPress = null,
        this._onKeyUp = null,
        this._i = 0,
        this._k = 0
    }
    ,
    H.Keyboard.prototype = {
        addCallbacks: function(t, e, i, s) {
            this.callbackContext = t,
            null != e && (this.onDownCallback = e),
            null != i && (this.onUpCallback = i),
            null != s && (this.onPressCallback = s)
        },
        addKey: function(t) {
            return this._keys[t] || (this._keys[t] = new H.Key(this.game,t),
            this.addKeyCapture(t)),
            this._keys[t]
        },
        addKeys: function(t) {
            var e = {};
            for (var i in t)
                e[i] = this.addKey(t[i]);
            return e
        },
        removeKey: function(t) {
            this._keys[t] && (this._keys[t] = null,
            this.removeKeyCapture(t))
        },
        createCursorKeys: function() {
            return this.addKeys({
                up: H.KeyCode.UP,
                down: H.KeyCode.DOWN,
                left: H.KeyCode.LEFT,
                right: H.KeyCode.RIGHT
            })
        },
        start: function() {
            if (!this.game.device.cocoonJS && null === this._onKeyDown) {
                var e = this;
                this._onKeyDown = function(t) {
                    return e.processKeyDown(t)
                }
                ,
                this._onKeyUp = function(t) {
                    return e.processKeyUp(t)
                }
                ,
                this._onKeyPress = function(t) {
                    return e.processKeyPress(t)
                }
                ,
                window.addEventListener("keydown", this._onKeyDown, !1),
                window.addEventListener("keyup", this._onKeyUp, !1),
                window.addEventListener("keypress", this._onKeyPress, !1)
            }
        },
        stop: function() {
            window.removeEventListener("keydown", this._onKeyDown),
            window.removeEventListener("keyup", this._onKeyUp),
            window.removeEventListener("keypress", this._onKeyPress),
            this._onKeyDown = null,
            this._onKeyUp = null,
            this._onKeyPress = null
        },
        destroy: function() {
            this.stop(),
            this.clearCaptures(),
            this._keys.length = 0,
            this._i = 0
        },
        addKeyCapture: function(t) {
            if ("object" == typeof t)
                for (var e in t)
                    this._capture[t[e]] = !0;
            else
                this._capture[t] = !0
        },
        removeKeyCapture: function(t) {
            delete this._capture[t]
        },
        clearCaptures: function() {
            this._capture = {}
        },
        update: function() {
            for (this._i = this._keys.length; this._i--; )
                this._keys[this._i] && this._keys[this._i].update()
        },
        processKeyDown: function(t) {
            if (this.event = t,
            this.game.input.enabled && this.enabled) {
                var e = t.keyCode;
                this._capture[e] && t.preventDefault(),
                this._keys[e] || (this._keys[e] = new H.Key(this.game,e)),
                this._keys[e].processKeyDown(t),
                this._k = e,
                this.onDownCallback && this.onDownCallback.call(this.callbackContext, t)
            }
        },
        processKeyPress: function(t) {
            this.pressEvent = t,
            this.game.input.enabled && this.enabled && this.onPressCallback && this.onPressCallback.call(this.callbackContext, String.fromCharCode(t.charCode), t)
        },
        processKeyUp: function(t) {
            if (this.event = t,
            this.game.input.enabled && this.enabled) {
                var e = t.keyCode;
                this._capture[e] && t.preventDefault(),
                this._keys[e] || (this._keys[e] = new H.Key(this.game,e)),
                this._keys[e].processKeyUp(t),
                this.onUpCallback && this.onUpCallback.call(this.callbackContext, t)
            }
        },
        reset: function(t) {
            void 0 === t && (t = !0),
            this.event = null;
            for (var e = this._keys.length; e--; )
                this._keys[e] && this._keys[e].reset(t)
        },
        downDuration: function(t, e) {
            return this._keys[t] ? this._keys[t].downDuration(e) : null
        },
        upDuration: function(t, e) {
            return this._keys[t] ? this._keys[t].upDuration(e) : null
        },
        isDown: function(t) {
            return this._keys[t] ? this._keys[t].isDown : null
        }
    },
    Object.defineProperty(H.Keyboard.prototype, "lastChar", {
        get: function() {
            return 32 === this.event.charCode ? "" : String.fromCharCode(this.pressEvent.charCode)
        }
    }),
    Object.defineProperty(H.Keyboard.prototype, "lastKey", {
        get: function() {
            return this._keys[this._k]
        }
    }),
    H.Keyboard.prototype.constructor = H.Keyboard,
    H.KeyCode = {
        A: "A".charCodeAt(0),
        B: "B".charCodeAt(0),
        C: "C".charCodeAt(0),
        D: "D".charCodeAt(0),
        E: "E".charCodeAt(0),
        F: "F".charCodeAt(0),
        G: "G".charCodeAt(0),
        H: "H".charCodeAt(0),
        I: "I".charCodeAt(0),
        J: "J".charCodeAt(0),
        K: "K".charCodeAt(0),
        L: "L".charCodeAt(0),
        M: "M".charCodeAt(0),
        N: "N".charCodeAt(0),
        O: "O".charCodeAt(0),
        P: "P".charCodeAt(0),
        Q: "Q".charCodeAt(0),
        R: "R".charCodeAt(0),
        S: "S".charCodeAt(0),
        T: "T".charCodeAt(0),
        U: "U".charCodeAt(0),
        V: "V".charCodeAt(0),
        W: "W".charCodeAt(0),
        X: "X".charCodeAt(0),
        Y: "Y".charCodeAt(0),
        Z: "Z".charCodeAt(0),
        ZERO: "0".charCodeAt(0),
        ONE: "1".charCodeAt(0),
        TWO: "2".charCodeAt(0),
        THREE: "3".charCodeAt(0),
        FOUR: "4".charCodeAt(0),
        FIVE: "5".charCodeAt(0),
        SIX: "6".charCodeAt(0),
        SEVEN: "7".charCodeAt(0),
        EIGHT: "8".charCodeAt(0),
        NINE: "9".charCodeAt(0),
        NUMPAD_0: 96,
        NUMPAD_1: 97,
        NUMPAD_2: 98,
        NUMPAD_3: 99,
        NUMPAD_4: 100,
        NUMPAD_5: 101,
        NUMPAD_6: 102,
        NUMPAD_7: 103,
        NUMPAD_8: 104,
        NUMPAD_9: 105,
        NUMPAD_MULTIPLY: 106,
        NUMPAD_ADD: 107,
        NUMPAD_ENTER: 108,
        NUMPAD_SUBTRACT: 109,
        NUMPAD_DECIMAL: 110,
        NUMPAD_DIVIDE: 111,
        F1: 112,
        F2: 113,
        F3: 114,
        F4: 115,
        F5: 116,
        F6: 117,
        F7: 118,
        F8: 119,
        F9: 120,
        F10: 121,
        F11: 122,
        F12: 123,
        F13: 124,
        F14: 125,
        F15: 126,
        COLON: 186,
        EQUALS: 187,
        COMMA: 188,
        UNDERSCORE: 189,
        PERIOD: 190,
        QUESTION_MARK: 191,
        TILDE: 192,
        OPEN_BRACKET: 219,
        BACKWARD_SLASH: 220,
        CLOSED_BRACKET: 221,
        QUOTES: 222,
        BACKSPACE: 8,
        TAB: 9,
        CLEAR: 12,
        ENTER: 13,
        SHIFT: 16,
        CONTROL: 17,
        ALT: 18,
        CAPS_LOCK: 20,
        ESC: 27,
        SPACEBAR: 32,
        PAGE_UP: 33,
        PAGE_DOWN: 34,
        END: 35,
        HOME: 36,
        LEFT: 37,
        UP: 38,
        RIGHT: 39,
        DOWN: 40,
        PLUS: 43,
        MINUS: 44,
        INSERT: 45,
        DELETE: 46,
        HELP: 47,
        NUM_LOCK: 144
    },
    H.KeyCode)
        H.KeyCode.hasOwnProperty(i) && !i.match(/[a-z]/) && (H.Keyboard[i] = H.KeyCode[i]);
    for (var n in H.Component = function() {}
    ,
    H.Component.Angle = function() {}
    ,
    H.Component.Angle.prototype = {
        angle: {
            get: function() {
                return H.Math.wrapAngle(H.Math.radToDeg(this.rotation))
            },
            set: function(t) {
                this.rotation = H.Math.degToRad(H.Math.wrapAngle(t))
            }
        }
    },
    H.Component.Animation = function() {}
    ,
    H.Component.Animation.prototype = {
        play: function(t, e, i, s) {
            if (this.animations)
                return this.animations.play(t, e, i, s)
        }
    },
    H.Component.AutoCull = function() {}
    ,
    H.Component.AutoCull.prototype = {
        autoCull: !1,
        inCamera: {
            get: function() {
                return this.autoCull || this.checkWorldBounds || (this._bounds.copyFrom(this.getBounds()),
                this._bounds.x += this.game.camera.view.x,
                this._bounds.y += this.game.camera.view.y),
                this.game.world.camera.view.intersects(this._bounds)
            }
        }
    },
    H.Component.Bounds = function() {}
    ,
    H.Component.Bounds.prototype = {
        offsetX: {
            get: function() {
                return this.anchor.x * this.width
            }
        },
        offsetY: {
            get: function() {
                return this.anchor.y * this.height
            }
        },
        centerX: {
            get: function() {
                return this.x - this.offsetX + .5 * this.width
            },
            set: function(t) {
                this.x = t + this.offsetX - .5 * this.width
            }
        },
        centerY: {
            get: function() {
                return this.y - this.offsetY + .5 * this.height
            },
            set: function(t) {
                this.y = t + this.offsetY - .5 * this.height
            }
        },
        left: {
            get: function() {
                return this.x - this.offsetX
            },
            set: function(t) {
                this.x = t + this.offsetX
            }
        },
        right: {
            get: function() {
                return this.x + this.width - this.offsetX
            },
            set: function(t) {
                this.x = t - this.width + this.offsetX
            }
        },
        top: {
            get: function() {
                return this.y - this.offsetY
            },
            set: function(t) {
                this.y = t + this.offsetY
            }
        },
        bottom: {
            get: function() {
                return this.y + this.height - this.offsetY
            },
            set: function(t) {
                this.y = t - this.height + this.offsetY
            }
        },
        alignIn: function(t, e, i, s) {
            switch (void 0 === i && (i = 0),
            void 0 === s && (s = 0),
            e) {
            default:
            case H.TOP_LEFT:
                this.left = t.left - i,
                this.top = t.top - s;
                break;
            case H.TOP_CENTER:
                this.centerX = t.centerX + i,
                this.top = t.top - s;
                break;
            case H.TOP_RIGHT:
                this.right = t.right + i,
                this.top = t.top - s;
                break;
            case H.LEFT_CENTER:
                this.left = t.left - i,
                this.centerY = t.centerY + s;
                break;
            case H.CENTER:
                this.centerX = t.centerX + i,
                this.centerY = t.centerY + s;
                break;
            case H.RIGHT_CENTER:
                this.right = t.right + i,
                this.centerY = t.centerY + s;
                break;
            case H.BOTTOM_LEFT:
                this.left = t.left - i,
                this.bottom = t.bottom + s;
                break;
            case H.BOTTOM_CENTER:
                this.centerX = t.centerX + i,
                this.bottom = t.bottom + s;
                break;
            case H.BOTTOM_RIGHT:
                this.right = t.right + i,
                this.bottom = t.bottom + s
            }
            return this
        },
        alignTo: function(t, e, i, s) {
            switch (void 0 === i && (i = 0),
            void 0 === s && (s = 0),
            e) {
            default:
            case H.TOP_LEFT:
                this.left = t.left - i,
                this.bottom = t.top - s;
                break;
            case H.TOP_CENTER:
                this.centerX = t.centerX + i,
                this.bottom = t.top - s;
                break;
            case H.TOP_RIGHT:
                this.right = t.right + i,
                this.bottom = t.top - s;
                break;
            case H.LEFT_TOP:
                this.right = t.left - i,
                this.top = t.top - s;
                break;
            case H.LEFT_CENTER:
                this.right = t.left - i,
                this.centerY = t.centerY + s;
                break;
            case H.LEFT_BOTTOM:
                this.right = t.left - i,
                this.bottom = t.bottom + s;
                break;
            case H.RIGHT_TOP:
                this.left = t.right + i,
                this.top = t.top - s;
                break;
            case H.RIGHT_CENTER:
                this.left = t.right + i,
                this.centerY = t.centerY + s;
                break;
            case H.RIGHT_BOTTOM:
                this.left = t.right + i,
                this.bottom = t.bottom + s;
                break;
            case H.BOTTOM_LEFT:
                this.left = t.left - i,
                this.top = t.bottom + s;
                break;
            case H.BOTTOM_CENTER:
                this.centerX = t.centerX + i,
                this.top = t.bottom + s;
                break;
            case H.BOTTOM_RIGHT:
                this.right = t.right + i,
                this.top = t.bottom + s
            }
            return this
        }
    },
    H.Group.prototype.alignIn = H.Component.Bounds.prototype.alignIn,
    H.Group.prototype.alignTo = H.Component.Bounds.prototype.alignTo,
    H.Component.BringToTop = function() {}
    ,
    H.Component.BringToTop.prototype.bringToTop = function() {
        return this.parent && this.parent.bringToTop(this),
        this
    }
    ,
    H.Component.BringToTop.prototype.sendToBack = function() {
        return this.parent && this.parent.sendToBack(this),
        this
    }
    ,
    H.Component.BringToTop.prototype.moveUp = function() {
        return this.parent && this.parent.moveUp(this),
        this
    }
    ,
    H.Component.BringToTop.prototype.moveDown = function() {
        return this.parent && this.parent.moveDown(this),
        this
    }
    ,
    H.Component.Core = function() {}
    ,
    H.Component.Core.install = function(t) {
        H.Utils.mixinPrototype(this, H.Component.Core.prototype),
        this.components = {};
        for (var e = 0; e < t.length; e++) {
            var i = t[e]
              , s = !1;
            "Destroy" === i && (s = !0),
            H.Utils.mixinPrototype(this, H.Component[i].prototype, s),
            this.components[i] = !0
        }
    }
    ,
    H.Component.Core.init = function(t, e, i, s, n) {
        this.game = t,
        this.key = s,
        this.data = {},
        this.position.set(e, i),
        this.world = new H.Point(e,i),
        this.previousPosition = new H.Point(e,i),
        this.events = new H.Events(this),
        this._bounds = new H.Rectangle,
        this.components.PhysicsBody && (this.body = this.body),
        this.components.Animation && (this.animations = new H.AnimationManager(this)),
        this.components.LoadTexture && null !== s && this.loadTexture(s, n),
        this.components.FixedToCamera && (this.cameraOffset = new H.Point(e,i))
    }
    ,
    H.Component.Core.preUpdate = function() {
        if (!this.pendingDestroy) {
            if (this.previousPosition.set(this.world.x, this.world.y),
            this.previousRotation = this.rotation,
            !this.exists || !this.parent.exists)
                return !(this.renderOrderID = -1);
            this.world.setTo(this.game.camera.x + this.worldTransform.tx, this.game.camera.y + this.worldTransform.ty),
            this.visible && (this.renderOrderID = this.game.stage.currentRenderOrderID++),
            this.animations && this.animations.update(),
            this.body && this.body.preUpdate();
            for (var t = 0; t < this.children.length; t++)
                this.children[t].preUpdate();
            return !0
        }
        this.destroy()
    }
    ,
    H.Component.Core.prototype = {
        game: null,
        name: "",
        data: {},
        components: {},
        z: 0,
        events: void 0,
        animations: void 0,
        key: "",
        world: null,
        debug: !1,
        previousPosition: null,
        previousRotation: 0,
        renderOrderID: 0,
        fresh: !0,
        pendingDestroy: !1,
        _bounds: null,
        _exists: !0,
        exists: {
            get: function() {
                return this._exists
            },
            set: function(t) {
                t ? (this._exists = !0,
                this.body && this.body.type === H.Physics.P2JS && this.body.addToWorld(),
                this.visible = !0) : (this._exists = !1,
                this.body && this.body.type === H.Physics.P2JS && this.body.removeFromWorld(),
                this.visible = !1)
            }
        },
        update: function() {},
        postUpdate: function() {
            this.customRender && this.key.render(),
            this.components.PhysicsBody && H.Component.PhysicsBody.postUpdate.call(this),
            this.components.FixedToCamera && H.Component.FixedToCamera.postUpdate.call(this);
            for (var t = 0; t < this.children.length; t++)
                this.children[t].postUpdate()
        }
    },
    H.Component.Crop = function() {}
    ,
    H.Component.Crop.prototype = {
        cropRect: null,
        _crop: null,
        crop: function(t, e) {
            void 0 === e && (e = !1),
            t ? (e && null !== this.cropRect ? this.cropRect.setTo(t.x, t.y, t.width, t.height) : e && null === this.cropRect ? this.cropRect = new H.Rectangle(t.x,t.y,t.width,t.height) : this.cropRect = t,
            this.updateCrop()) : (this._crop = null,
            this.cropRect = null,
            this.resetFrame())
        },
        updateCrop: function() {
            if (this.cropRect) {
                var t = this.texture.crop.x
                  , e = this.texture.crop.y
                  , i = this.texture.crop.width
                  , s = this.texture.crop.height;
                this._crop = H.Rectangle.clone(this.cropRect, this._crop),
                this._crop.x += this._frame.x,
                this._crop.y += this._frame.y;
                var n = Math.max(this._frame.x, this._crop.x)
                  , r = Math.max(this._frame.y, this._crop.y)
                  , o = Math.min(this._frame.right, this._crop.right) - n
                  , a = Math.min(this._frame.bottom, this._crop.bottom) - r;
                this.texture.crop.x = n,
                this.texture.crop.y = r,
                this.texture.crop.width = o,
                this.texture.crop.height = a,
                this.texture.frame.width = Math.min(o, this.cropRect.width),
                this.texture.frame.height = Math.min(a, this.cropRect.height),
                this.texture.width = this.texture.frame.width,
                this.texture.height = this.texture.frame.height,
                this.texture._updateUvs(),
                16777215 === this.tint || t === n && e === r && i === o && s === a || (this.texture.requiresReTint = !0)
            }
        }
    },
    H.Component.Delta = function() {}
    ,
    H.Component.Delta.prototype = {
        deltaX: {
            get: function() {
                return this.world.x - this.previousPosition.x
            }
        },
        deltaY: {
            get: function() {
                return this.world.y - this.previousPosition.y
            }
        },
        deltaZ: {
            get: function() {
                return this.rotation - this.previousRotation
            }
        }
    },
    H.Component.Destroy = function() {}
    ,
    H.Component.Destroy.prototype = {
        destroyPhase: !1,
        destroy: function(t, e) {
            if (null !== this.game && !this.destroyPhase) {
                void 0 === t && (t = !0),
                void 0 === e && (e = !1),
                this.destroyPhase = !0,
                this.events && this.events.onDestroy$dispatch(this),
                this.parent && (this.parent instanceof H.Group ? this.parent.remove(this) : this.parent.removeChild(this)),
                this.input && this.input.destroy(),
                this.animations && this.animations.destroy(),
                this.body && this.body.destroy(),
                this.events && this.events.destroy(),
                this.game.tweens.removeFrom(this);
                var i = this.children.length;
                if (t)
                    for (; i--; )
                        this.children[i].destroy(t);
                else
                    for (; i--; )
                        this.removeChild(this.children[i]);
                this._crop && (this._crop = null,
                this.cropRect = null),
                this._frame && (this._frame = null),
                H.Video && this.key instanceof H.Video && this.key.onChangeSource.remove(this.resizeFrame, this),
                H.BitmapText && this._glyphs && (this._glyphs = []),
                this.alive = !1,
                this.exists = !1,
                this.visible = !1,
                this.filters = null,
                this.mask = null,
                this.game = null,
                this.data = {},
                this.renderable = !1,
                this.transformCallback && (this.transformCallback = null,
                this.transformCallbackContext = null),
                this.hitArea = null,
                this.parent = null,
                this.stage = null,
                this.worldTransform = null,
                this.filterArea = null,
                this._bounds = null,
                this._currentBounds = null,
                this._mask = null,
                this._destroyCachedSprite(),
                e && this.texture.destroy(!0),
                this.destroyPhase = !1,
                this.pendingDestroy = !1
            }
        }
    },
    H.Events = function(t) {
        this.parent = t
    }
    ,
    H.Events.prototype = {
        destroy: function() {
            this._parent = null,
            this._onDestroy && this._onDestroy.dispose(),
            this._onAddedToGroup && this._onAddedToGroup.dispose(),
            this._onRemovedFromGroup && this._onRemovedFromGroup.dispose(),
            this._onRemovedFromWorld && this._onRemovedFromWorld.dispose(),
            this._onKilled && this._onKilled.dispose(),
            this._onRevived && this._onRevived.dispose(),
            this._onEnterBounds && this._onEnterBounds.dispose(),
            this._onOutOfBounds && this._onOutOfBounds.dispose(),
            this._onInputOver && this._onInputOver.dispose(),
            this._onInputOut && this._onInputOut.dispose(),
            this._onInputDown && this._onInputDown.dispose(),
            this._onInputUp && this._onInputUp.dispose(),
            this._onDragStart && this._onDragStart.dispose(),
            this._onDragUpdate && this._onDragUpdate.dispose(),
            this._onDragStop && this._onDragStop.dispose(),
            this._onAnimationStart && this._onAnimationStart.dispose(),
            this._onAnimationComplete && this._onAnimationComplete.dispose(),
            this._onAnimationLoop && this._onAnimationLoop.dispose()
        },
        onAddedToGroup: null,
        onRemovedFromGroup: null,
        onRemovedFromWorld: null,
        onDestroy: null,
        onKilled: null,
        onRevived: null,
        onOutOfBounds: null,
        onEnterBounds: null,
        onInputOver: null,
        onInputOut: null,
        onInputDown: null,
        onInputUp: null,
        onDragStart: null,
        onDragUpdate: null,
        onDragStop: null,
        onAnimationStart: null,
        onAnimationComplete: null,
        onAnimationLoop: null
    },
    H.Events.prototype.constructor = H.Events,
    H.Events.prototype)
        H.Events.prototype.hasOwnProperty(n) && 0 === n.indexOf("on") && null === H.Events.prototype[n] && function(t, e) {
            "use strict";
            Object.defineProperty(H.Events.prototype, t, {
                get: function() {
                    return this[e] || (this[e] = new H.Signal)
                }
            }),
            H.Events.prototype[t + "$dispatch"] = function() {
                return this[e] ? this[e].dispatch.apply(this[e], arguments) : null
            }
        }(n, "_" + n);
    H.Component.FixedToCamera = function() {}
    ,
    H.Component.FixedToCamera.postUpdate = function() {
        this.fixedToCamera && (this.position.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x,
        this.position.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y)
    }
    ,
    H.Component.FixedToCamera.prototype = {
        _fixedToCamera: !1,
        fixedToCamera: {
            get: function() {
                return this._fixedToCamera
            },
            set: function(t) {
                t ? (this._fixedToCamera = !0,
                this.cameraOffset.set(this.x, this.y)) : this._fixedToCamera = !1
            }
        },
        cameraOffset: new H.Point
    },
    H.Component.Health = function() {}
    ,
    H.Component.Health.prototype = {
        health: 1,
        maxHealth: 100,
        damage: function(t) {
            return this.alive && (this.health -= t,
            this.health <= 0 && this.kill()),
            this
        },
        setHealth: function(t) {
            return this.health = t,
            this.health > this.maxHealth && (this.health = this.maxHealth),
            this
        },
        heal: function(t) {
            return this.alive && (this.health += t,
            this.health > this.maxHealth && (this.health = this.maxHealth)),
            this
        }
    },
    H.Component.InCamera = function() {}
    ,
    H.Component.InCamera.prototype = {
        inCamera: {
            get: function() {
                return this.game.world.camera.view.intersects(this._bounds)
            }
        }
    },
    H.Component.InputEnabled = function() {}
    ,
    H.Component.InputEnabled.prototype = {
        input: null,
        inputEnabled: {
            get: function() {
                return this.input && this.input.enabled
            },
            set: function(t) {
                t ? null === this.input ? (this.input = new H.InputHandler(this),
                this.input.start()) : this.input && !this.input.enabled && this.input.start() : this.input && this.input.enabled && this.input.stop()
            }
        }
    },
    H.Component.InWorld = function() {}
    ,
    H.Component.InWorld.preUpdate = function() {
        if (this.autoCull || this.checkWorldBounds) {
            if (this._bounds.copyFrom(this.getBounds()),
            this._bounds.x += this.game.camera.view.x,
            this._bounds.y += this.game.camera.view.y,
            this.autoCull)
                if (this.game.world.camera.view.intersects(this._bounds))
                    this.renderable = !0,
                    this.game.world.camera.totalInView++;
                else if (this.renderable = !1,
                this.outOfCameraBoundsKill)
                    return this.kill(),
                    !1;
            if (this.checkWorldBounds)
                if (this._outOfBoundsFired && this.game.world.bounds.intersects(this._bounds))
                    this._outOfBoundsFired = !1,
                    this.events.onEnterBounds$dispatch(this);
                else if (!this._outOfBoundsFired && !this.game.world.bounds.intersects(this._bounds) && (this._outOfBoundsFired = !0,
                this.events.onOutOfBounds$dispatch(this),
                this.outOfBoundsKill))
                    return this.kill(),
                    !1
        }
        return !0
    }
    ,
    H.Component.InWorld.prototype = {
        checkWorldBounds: !1,
        outOfBoundsKill: !1,
        outOfCameraBoundsKill: !1,
        _outOfBoundsFired: !1,
        inWorld: {
            get: function() {
                return this.game.world.bounds.intersects(this.getBounds())
            }
        }
    },
    H.Component.LifeSpan = function() {}
    ,
    H.Component.LifeSpan.preUpdate = function() {
        return !(0 < this.lifespan && (this.lifespan -= this.game.time.physicsElapsedMS,
        this.lifespan <= 0) && (this.kill(),
        1))
    }
    ,
    H.Component.LifeSpan.prototype = {
        alive: !0,
        lifespan: 0,
        revive: function(t) {
            return void 0 === t && (t = 100),
            this.alive = !0,
            this.exists = !0,
            this.visible = !0,
            "function" == typeof this.setHealth && this.setHealth(t),
            this.events && this.events.onRevived$dispatch(this),
            this
        },
        kill: function() {
            return this.alive = !1,
            this.exists = !1,
            this.visible = !1,
            this.events && this.events.onKilled$dispatch(this),
            this
        }
    },
    H.Component.LoadTexture = function() {}
    ,
    H.Component.LoadTexture.prototype = {
        customRender: !1,
        _frame: null,
        loadTexture: function(t, e, i) {
            e = t === H.PENDING_ATLAS ? (t = e,
            0) : e || 0,
            (i || void 0 === i) && this.animations && this.animations.stop(),
            this.key = t,
            this.customRender = !1;
            var s = this.game.cache
              , n = !0
              , r = !this.texture.baseTexture.scaleMode;
            if (H.RenderTexture && t instanceof H.RenderTexture)
                this.key = t.key,
                this.setTexture(t);
            else if (H.BitmapData && t instanceof H.BitmapData)
                this.customRender = !0,
                this.setTexture(t.texture),
                n = s.hasFrameData(t.key, H.Cache.BITMAPDATA) ? !this.animations.loadFrameData(s.getFrameData(t.key, H.Cache.BITMAPDATA), e) : !this.animations.loadFrameData(t.frameData, 0);
            else if (H.Video && t instanceof H.Video) {
                this.customRender = !0;
                var o = t.texture.valid;
                this.setTexture(t.texture),
                this.setFrame(t.texture.frame.clone()),
                t.onChangeSource.add(this.resizeFrame, this),
                this.texture.valid = o
            } else if (H.Tilemap && t instanceof H.TilemapLayer)
                this.setTexture(PIXI.Texture.fromCanvas(t.canvas));
            else if (t instanceof PIXI.Texture)
                this.setTexture(t);
            else {
                var a = s.getImage(t, !0);
                this.key = a.key,
                this.setTexture(new PIXI.Texture(a.base)),
                this.texture.baseTexture.skipRender = "__default" === t,
                n = !this.animations.loadFrameData(a.frameData, e)
            }
            n && (this._frame = H.Rectangle.clone(this.texture.frame)),
            r || (this.texture.baseTexture.scaleMode = 1)
        },
        setFrame: function(t) {
            this._frame = t,
            this.texture.frame.x = t.x,
            this.texture.frame.y = t.y,
            this.texture.frame.width = t.width,
            this.texture.frame.height = t.height,
            this.texture.crop.x = t.x,
            this.texture.crop.y = t.y,
            this.texture.crop.width = t.width,
            this.texture.crop.height = t.height,
            t.trimmed ? (this.texture.trim ? (this.texture.trim.x = t.spriteSourceSizeX,
            this.texture.trim.y = t.spriteSourceSizeY,
            this.texture.trim.width = t.sourceSizeW,
            this.texture.trim.height = t.sourceSizeH) : this.texture.trim = {
                x: t.spriteSourceSizeX,
                y: t.spriteSourceSizeY,
                width: t.sourceSizeW,
                height: t.sourceSizeH
            },
            this.texture.width = t.sourceSizeW,
            this.texture.height = t.sourceSizeH,
            this.texture.frame.width = t.sourceSizeW,
            this.texture.frame.height = t.sourceSizeH) : !t.trimmed && this.texture.trim && (this.texture.trim = null),
            this.cropRect && this.updateCrop(),
            this.texture.requiresReTint = !0,
            this.texture._updateUvs(),
            this.tilingTexture && (this.refreshTexture = !0)
        },
        resizeFrame: function(t, e, i) {
            this.texture.frame.resize(e, i),
            this.texture.setFrame(this.texture.frame)
        },
        resetFrame: function() {
            this._frame && this.setFrame(this._frame)
        },
        frame: {
            get: function() {
                return this.animations.frame
            },
            set: function(t) {
                this.animations.frame = t
            }
        },
        frameName: {
            get: function() {
                return this.animations.frameName
            },
            set: function(t) {
                this.animations.frameName = t
            }
        }
    },
    H.Component.Overlap = function() {}
    ,
    H.Component.Overlap.prototype = {
        overlap: function(t) {
            return H.Rectangle.intersects(this.getBounds(), t.getBounds())
        }
    },
    H.Component.PhysicsBody = function() {}
    ,
    H.Component.PhysicsBody.preUpdate = function() {
        return this.fresh && this.exists ? (this.world.setTo(this.parent.position.x + this.position.x, this.parent.position.y + this.position.y),
        this.worldTransform.tx = this.world.x,
        this.worldTransform.ty = this.world.y,
        this.previousPosition.set(this.world.x, this.world.y),
        this.previousRotation = this.rotation,
        this.body && this.body.preUpdate(),
        this.fresh = !1) : (this.previousPosition.set(this.world.x, this.world.y),
        this.previousRotation = this.rotation,
        !(!this._exists || !this.parent.exists) || !(this.renderOrderID = -1))
    }
    ,
    H.Component.PhysicsBody.postUpdate = function() {
        this.exists && this.body && this.body.postUpdate()
    }
    ,
    H.Component.PhysicsBody.prototype = {
        body: null,
        x: {
            get: function() {
                return this.position.x
            },
            set: function(t) {
                this.position.x = t,
                this.body && !this.body.dirty && (this.body._reset = !0)
            }
        },
        y: {
            get: function() {
                return this.position.y
            },
            set: function(t) {
                this.position.y = t,
                this.body && !this.body.dirty && (this.body._reset = !0)
            }
        }
    },
    H.Component.Reset = function() {}
    ,
    H.Component.Reset.prototype.reset = function(t, e, i) {
        return void 0 === i && (i = 1),
        this.world.set(t, e),
        this.position.set(t, e),
        this.fresh = !0,
        this.exists = !0,
        this.visible = !0,
        this.renderable = !0,
        this.components.InWorld && (this._outOfBoundsFired = !1),
        this.components.LifeSpan && (this.alive = !0,
        this.health = i),
        this.components.PhysicsBody && this.body && this.body.reset(t, e, !1, !1),
        this
    }
    ,
    H.Component.ScaleMinMax = function() {}
    ,
    H.Component.ScaleMinMax.prototype = {
        transformCallback: null,
        transformCallbackContext: this,
        scaleMin: null,
        scaleMax: null,
        checkTransform: function(t) {
            this.scaleMin && (t.a < this.scaleMin.x && (t.a = this.scaleMin.x),
            t.d < this.scaleMin.y && (t.d = this.scaleMin.y)),
            this.scaleMax && (t.a > this.scaleMax.x && (t.a = this.scaleMax.x),
            t.d > this.scaleMax.y && (t.d = this.scaleMax.y))
        },
        setScaleMinMax: function(t, e, i, s) {
            void 0 === e ? e = i = s = t : void 0 === i && (i = s = e,
            e = t),
            null === t ? this.scaleMin = null : this.scaleMin ? this.scaleMin.set(t, e) : this.scaleMin = new H.Point(t,e),
            null === i ? this.scaleMax = null : this.scaleMax ? this.scaleMax.set(i, s) : this.scaleMax = new H.Point(i,s),
            null === this.scaleMin ? this.transformCallback = null : (this.transformCallback = this.checkTransform,
            this.transformCallbackContext = this)
        }
    },
    H.Component.Smoothed = function() {}
    ,
    H.Component.Smoothed.prototype = {
        smoothed: {
            get: function() {
                return !this.texture.baseTexture.scaleMode
            },
            set: function(t) {
                t ? this.texture && (this.texture.baseTexture.scaleMode = 0) : this.texture && (this.texture.baseTexture.scaleMode = 1)
            }
        }
    },
    H.GameObjectFactory = function(t) {
        this.game = t,
        this.world = this.game.world
    }
    ,
    H.GameObjectFactory.prototype = {
        existing: function(t) {
            return this.world.add(t)
        },
        weapon: function(t, e, i, s) {
            var n = this.game.plugins.add(H.Weapon);
            return n.createBullets(t, e, i, s),
            n
        },
        image: function(t, e, i, s, n) {
            return void 0 === n && (n = this.world),
            n.add(new H.Image(this.game,t,e,i,s))
        },
        sprite: function(t, e, i, s, n) {
            return void 0 === n && (n = this.world),
            n.create(t, e, i, s)
        },
        creature: function(t, e, i, s, n) {
            void 0 === n && (n = this.world);
            var r = new H.Creature(this.game,t,e,i,s);
            return n.add(r),
            r
        },
        tween: function(t) {
            return this.game.tweens.create(t)
        },
        group: function(t, e, i, s, n) {
            return new H.Group(this.game,t,e,i,s,n)
        },
        physicsGroup: function(t, e, i, s) {
            return new H.Group(this.game,e,i,s,!0,t)
        },
        spriteBatch: function(t, e, i) {
            return void 0 === t && (t = null),
            void 0 === e && (e = "group"),
            void 0 === i && (i = !1),
            new H.SpriteBatch(this.game,t,e,i)
        },
        audio: function(t, e, i, s) {
            return this.game.sound.add(t, e, i, s)
        },
        sound: function(t, e, i, s) {
            return this.game.sound.add(t, e, i, s)
        },
        audioSprite: function(t) {
            return this.game.sound.addSprite(t)
        },
        tileSprite: function(t, e, i, s, n, r, o) {
            return void 0 === o && (o = this.world),
            o.add(new H.TileSprite(this.game,t,e,i,s,n,r))
        },
        rope: function(t, e, i, s, n, r) {
            return void 0 === r && (r = this.world),
            r.add(new H.Rope(this.game,t,e,i,s,n))
        },
        text: function(t, e, i, s, n) {
            return void 0 === n && (n = this.world),
            n.add(new H.Text(this.game,t,e,i,s))
        },
        button: function(t, e, i, s, n, r, o, a, h, l) {
            return void 0 === l && (l = this.world),
            l.add(new H.Button(this.game,t,e,i,s,n,r,o,a,h))
        },
        graphics: function(t, e, i) {
            return void 0 === i && (i = this.world),
            i.add(new H.Graphics(this.game,t,e))
        },
        emitter: function(t, e, i) {
            return this.game.particles.add(new H.Particles.Arcade.Emitter(this.game,t,e,i))
        },
        retroFont: function(t, e, i, s, n, r, o, a, h) {
            return new H.RetroFont(this.game,t,e,i,s,n,r,o,a,h)
        },
        bitmapText: function(t, e, i, s, n, r) {
            return void 0 === r && (r = this.world),
            r.add(new H.BitmapText(this.game,t,e,i,s,n))
        },
        tilemap: function(t, e, i, s, n) {
            return new H.Tilemap(this.game,t,e,i,s,n)
        },
        renderTexture: function(t, e, i, s) {
            void 0 !== i && "" !== i || (i = this.game.rnd.uuid()),
            void 0 === s && (s = !1);
            var n = new H.RenderTexture(this.game,t,e,i);
            return s && this.game.cache.addRenderTexture(i, n),
            n
        },
        video: function(t, e) {
            return new H.Video(this.game,t,e)
        },
        bitmapData: function(t, e, i, s) {
            void 0 === s && (s = !1),
            void 0 !== i && "" !== i || (i = this.game.rnd.uuid());
            var n = new H.BitmapData(this.game,i,t,e);
            return s && this.game.cache.addBitmapData(i, n),
            n
        },
        filter: function(t) {
            var e = Array.prototype.slice.call(arguments, 1);
            return (t = new H.Filter[t](this.game)).init.apply(t, e),
            t
        },
        plugin: function(t) {
            return this.game.plugins.add(t)
        }
    },
    H.GameObjectFactory.prototype.constructor = H.GameObjectFactory,
    H.GameObjectCreator = function(t) {
        this.game = t,
        this.world = this.game.world
    }
    ,
    H.GameObjectCreator.prototype = {
        image: function(t, e, i, s) {
            return new H.Image(this.game,t,e,i,s)
        },
        sprite: function(t, e, i, s) {
            return new H.Sprite(this.game,t,e,i,s)
        },
        tween: function(t) {
            return new H.Tween(t,this.game,this.game.tweens)
        },
        group: function(t, e, i, s, n) {
            return new H.Group(this.game,t,e,i,s,n)
        },
        spriteBatch: function(t, e, i) {
            return void 0 === e && (e = "group"),
            void 0 === i && (i = !1),
            new H.SpriteBatch(this.game,t,e,i)
        },
        audio: function(t, e, i, s) {
            return this.game.sound.add(t, e, i, s)
        },
        audioSprite: function(t) {
            return this.game.sound.addSprite(t)
        },
        sound: function(t, e, i, s) {
            return this.game.sound.add(t, e, i, s)
        },
        tileSprite: function(t, e, i, s, n, r) {
            return new H.TileSprite(this.game,t,e,i,s,n,r)
        },
        rope: function(t, e, i, s, n) {
            return new H.Rope(this.game,t,e,i,s,n)
        },
        text: function(t, e, i, s) {
            return new H.Text(this.game,t,e,i,s)
        },
        button: function(t, e, i, s, n, r, o, a, h) {
            return new H.Button(this.game,t,e,i,s,n,r,o,a,h)
        },
        graphics: function(t, e) {
            return new H.Graphics(this.game,t,e)
        },
        emitter: function(t, e, i) {
            return new H.Particles.Arcade.Emitter(this.game,t,e,i)
        },
        retroFont: function(t, e, i, s, n, r, o, a, h) {
            return new H.RetroFont(this.game,t,e,i,s,n,r,o,a,h)
        },
        bitmapText: function(t, e, i, s, n, r) {
            return new H.BitmapText(this.game,t,e,i,s,n,r)
        },
        tilemap: function(t, e, i, s, n) {
            return new H.Tilemap(this.game,t,e,i,s,n)
        },
        renderTexture: function(t, e, i, s) {
            void 0 !== i && "" !== i || (i = this.game.rnd.uuid()),
            void 0 === s && (s = !1);
            var n = new H.RenderTexture(this.game,t,e,i);
            return s && this.game.cache.addRenderTexture(i, n),
            n
        },
        bitmapData: function(t, e, i, s) {
            void 0 === s && (s = !1),
            void 0 !== i && "" !== i || (i = this.game.rnd.uuid());
            var n = new H.BitmapData(this.game,i,t,e);
            return s && this.game.cache.addBitmapData(i, n),
            n
        },
        filter: function(t) {
            var e = Array.prototype.slice.call(arguments, 1);
            return (t = new H.Filter[t](this.game)).init.apply(t, e),
            t
        }
    },
    H.GameObjectCreator.prototype.constructor = H.GameObjectCreator,
    H.Sprite = function(t, e, i, s, n) {
        e = e || 0,
        i = i || 0,
        s = s || null,
        n = n || null,
        this.type = H.SPRITE,
        this.physicsType = H.SPRITE,
        PIXI.Sprite.call(this, H.Cache.DEFAULT),
        H.Component.Core.init.call(this, t, e, i, s, n)
    }
    ,
    H.Sprite.prototype = Object.create(PIXI.Sprite.prototype),
    H.Sprite.prototype.constructor = H.Sprite,
    H.Component.Core.install.call(H.Sprite.prototype, ["Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Crop", "Delta", "Destroy", "FixedToCamera", "Health", "InCamera", "InputEnabled", "InWorld", "LifeSpan", "LoadTexture", "Overlap", "PhysicsBody", "Reset", "ScaleMinMax", "Smoothed"]),
    H.Sprite.prototype.preUpdatePhysics = H.Component.PhysicsBody.preUpdate,
    H.Sprite.prototype.preUpdateLifeSpan = H.Component.LifeSpan.preUpdate,
    H.Sprite.prototype.preUpdateInWorld = H.Component.InWorld.preUpdate,
    H.Sprite.prototype.preUpdateCore = H.Component.Core.preUpdate,
    H.Sprite.prototype.preUpdate = function() {
        return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore()
    }
    ,
    H.Image = function(t, e, i, s, n) {
        e = e || 0,
        i = i || 0,
        s = s || null,
        n = n || null,
        this.type = H.IMAGE,
        PIXI.Sprite.call(this, H.Cache.DEFAULT),
        H.Component.Core.init.call(this, t, e, i, s, n)
    }
    ,
    H.Image.prototype = Object.create(PIXI.Sprite.prototype),
    H.Image.prototype.constructor = H.Image,
    H.Component.Core.install.call(H.Image.prototype, ["Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Crop", "Destroy", "FixedToCamera", "InputEnabled", "LifeSpan", "LoadTexture", "Overlap", "Reset", "ScaleMinMax", "Smoothed"]),
    H.Image.prototype.preUpdateInWorld = H.Component.InWorld.preUpdate,
    H.Image.prototype.preUpdateCore = H.Component.Core.preUpdate,
    H.Image.prototype.preUpdate = function() {
        return !!this.preUpdateInWorld() && this.preUpdateCore()
    }
    ,
    H.Button = function(t, e, i, s, n, r, o, a, h, l) {
        e = e || 0,
        i = i || 0,
        s = s || null,
        n = n || null,
        r = r || this,
        H.Image.call(this, t, e, i, s, a),
        this.type = H.BUTTON,
        this.physicsType = H.SPRITE,
        this._onOverFrame = null,
        this._onOutFrame = null,
        this._onDownFrame = null,
        this._onUpFrame = null,
        this.onOverSound = null,
        this.onOutSound = null,
        this.onDownSound = null,
        this.onUpSound = null,
        this.onOverSoundMarker = "",
        this.onOutSoundMarker = "",
        this.onDownSoundMarker = "",
        this.onUpSoundMarker = "",
        this.onInputOver = new H.Signal,
        this.onInputOut = new H.Signal,
        this.onInputDown = new H.Signal,
        this.onInputUp = new H.Signal,
        this.onOverMouseOnly = !0,
        this.justReleasedPreventsOver = H.PointerMode.TOUCH,
        this.freezeFrames = !1,
        this.forceOut = !1,
        this.inputEnabled = !0,
        this.input.start(0, !0),
        this.input.useHandCursor = !0,
        this.setFrames(o, a, h, l),
        null !== n && this.onInputUp.add(n, r),
        this.events.onInputOver.add(this.onInputOverHandler, this),
        this.events.onInputOut.add(this.onInputOutHandler, this),
        this.events.onInputDown.add(this.onInputDownHandler, this),
        this.events.onInputUp.add(this.onInputUpHandler, this),
        this.events.onRemovedFromWorld.add(this.removedFromWorld, this)
    }
    ,
    H.Button.prototype = Object.create(H.Image.prototype),
    H.Button.prototype.constructor = H.Button;
    var h = "Over"
      , l = "Out"
      , c = "Down"
      , d = "Up";
    H.Button.prototype.clearFrames = function() {
        this.setFrames(null, null, null, null)
    }
    ,
    H.Button.prototype.removedFromWorld = function() {
        this.inputEnabled = !1
    }
    ,
    H.Button.prototype.setStateFrame = function(t, e, i) {
        var s = "_on" + t + "Frame";
        null !== e ? (this[s] = e,
        i && this.changeStateFrame(t)) : this[s] = null
    }
    ,
    H.Button.prototype.changeStateFrame = function(t) {
        if (this.freezeFrames)
            return !1;
        var e = this["_on" + t + "Frame"];
        return "string" == typeof e ? (this.frameName = e,
        !0) : "number" == typeof e && (this.frame = e,
        !0)
    }
    ,
    H.Button.prototype.setFrames = function(t, e, i, s) {
        this.setStateFrame(h, t, this.input.pointerOver()),
        this.setStateFrame(l, e, !this.input.pointerOver()),
        this.setStateFrame(c, i, this.input.pointerDown()),
        this.setStateFrame(d, s, this.input.pointerUp())
    }
    ,
    H.Button.prototype.setStateSound = function(t, e, i) {
        var s = "on" + t + "Sound"
          , n = "on" + t + "SoundMarker";
        e instanceof H.Sound || e instanceof H.AudioSprite ? (this[s] = e,
        this[n] = "string" == typeof i ? i : "") : (this[s] = null,
        this[n] = "")
    }
    ,
    H.Button.prototype.playStateSound = function(t) {
        var e = this["on" + t + "Sound"];
        if (e) {
            var i = this["on" + t + "SoundMarker"];
            return e.play(i),
            !0
        }
        return !1
    }
    ,
    H.Button.prototype.setSounds = function(t, e, i, s, n, r, o, a) {
        this.setStateSound(h, t, e),
        this.setStateSound(l, n, r),
        this.setStateSound(c, i, s),
        this.setStateSound(d, o, a)
    }
    ,
    H.Button.prototype.setOverSound = function(t, e) {
        this.setStateSound(h, t, e)
    }
    ,
    H.Button.prototype.setOutSound = function(t, e) {
        this.setStateSound(l, t, e)
    }
    ,
    H.Button.prototype.setDownSound = function(t, e) {
        this.setStateSound(c, t, e)
    }
    ,
    H.Button.prototype.setUpSound = function(t, e) {
        this.setStateSound(d, t, e)
    }
    ,
    H.Button.prototype.onInputOverHandler = function(t, e) {
        e.justReleased() && (this.justReleasedPreventsOver & e.pointerMode) === e.pointerMode || (this.changeStateFrame(h),
        this.onOverMouseOnly && !e.isMouse || (this.playStateSound(h),
        this.onInputOver && this.onInputOver.dispatch(this, e)))
    }
    ,
    H.Button.prototype.onInputOutHandler = function(t, e) {
        this.changeStateFrame(l),
        this.playStateSound(l),
        this.onInputOut && this.onInputOut.dispatch(this, e)
    }
    ,
    H.Button.prototype.onInputDownHandler = function(t, e) {
        this.changeStateFrame(c),
        this.playStateSound(c),
        this.onInputDown && this.onInputDown.dispatch(this, e)
    }
    ,
    H.Button.prototype.onInputUpHandler = function(t, e, i) {
        if (this.playStateSound(d),
        this.onInputUp && this.onInputUp.dispatch(this, e, i),
        !this.freezeFrames)
            if (!0 === this.forceOut || (this.forceOut & e.pointerMode) === e.pointerMode)
                this.changeStateFrame(l);
            else {
                this.changeStateFrame(d) || (i ? this.changeStateFrame(h) : this.changeStateFrame(l))
            }
    }
    ,
    H.SpriteBatch = function(t, e, i, s) {
        null != e || (e = t.world),
        PIXI.SpriteBatch.call(this),
        H.Group.call(this, t, e, i, s),
        this.type = H.SPRITEBATCH
    }
    ,
    H.SpriteBatch.prototype = H.Utils.extend(!0, H.SpriteBatch.prototype, PIXI.SpriteBatch.prototype, H.Group.prototype),
    H.SpriteBatch.prototype.constructor = H.SpriteBatch,
    H.BitmapData = function(t, e, i, s, n) {
        void 0 !== i && 0 !== i || (i = 256),
        void 0 !== s && 0 !== s || (s = 256),
        void 0 === n && (n = !1),
        this.game = t,
        this.key = e,
        this.width = i,
        this.height = s,
        this.canvas = H.Canvas.create(this, i, s, null, n),
        this.context = this.canvas.getContext("2d", {
            alpha: !0
        }),
        this.ctx = this.context,
        this.smoothProperty = t.renderType === H.CANVAS ? t.renderer.renderSession.smoothProperty : H.Canvas.getSmoothingPrefix(this.context),
        this.imageData = this.context.getImageData(0, 0, i, s),
        this.data = null,
        this.imageData && (this.data = this.imageData.data),
        this.pixels = null,
        this.data && (this.imageData.data.buffer ? (this.buffer = this.imageData.data.buffer,
        this.pixels = new Uint32Array(this.buffer)) : window.ArrayBuffer ? (this.buffer = new ArrayBuffer(this.imageData.data.length),
        this.pixels = new Uint32Array(this.buffer)) : this.pixels = this.imageData.data),
        this.baseTexture = new PIXI.BaseTexture(this.canvas),
        this.texture = new PIXI.Texture(this.baseTexture),
        this.frameData = new H.FrameData,
        this.textureFrame = this.frameData.addFrame(new H.Frame(0,0,0,i,s,"bitmapData")),
        this.texture.frame = this.textureFrame,
        this.type = H.BITMAPDATA,
        this.disableTextureUpload = !1,
        this.dirty = !1,
        this.cls = this.clear,
        this._image = null,
        this._pos = new H.Point,
        this._size = new H.Point,
        this._scale = new H.Point,
        this._rotate = 0,
        this._alpha = {
            prev: 1,
            current: 1
        },
        this._anchor = new H.Point,
        this._tempR = 0,
        this._tempG = 0,
        this._tempB = 0,
        this._circle = new H.Circle,
        this._swapCanvas = void 0
    }
    ,
    H.BitmapData.prototype = {
        move: function(t, e, i) {
            return 0 !== t && this.moveH(t, i),
            0 !== e && this.moveV(e, i),
            this
        },
        moveH: function(t, e) {
            void 0 === e && (e = !0),
            void 0 === this._swapCanvas && (this._swapCanvas = PIXI.CanvasPool.create(this, this.width, this.height));
            var i = this._swapCanvas.getContext("2d")
              , s = this.height
              , n = this.canvas;
            if (i.clearRect(0, 0, this.width, this.height),
            t < 0) {
                t = Math.abs(t);
                var r = this.width - t;
                e && i.drawImage(n, 0, 0, t, s, r, 0, t, s),
                i.drawImage(n, t, 0, r, s, 0, 0, r, s)
            } else {
                r = this.width - t;
                e && i.drawImage(n, r, 0, t, s, 0, 0, t, s),
                i.drawImage(n, 0, 0, r, s, t, 0, r, s)
            }
            return this.clear(),
            this.copy(this._swapCanvas)
        },
        moveV: function(t, e) {
            void 0 === e && (e = !0),
            void 0 === this._swapCanvas && (this._swapCanvas = PIXI.CanvasPool.create(this, this.width, this.height));
            var i = this._swapCanvas.getContext("2d")
              , s = this.width
              , n = this.canvas;
            if (i.clearRect(0, 0, this.width, this.height),
            t < 0) {
                t = Math.abs(t);
                var r = this.height - t;
                e && i.drawImage(n, 0, 0, s, t, 0, r, s, t),
                i.drawImage(n, 0, t, s, r, 0, 0, s, r)
            } else {
                r = this.height - t;
                e && i.drawImage(n, 0, r, s, t, 0, 0, s, t),
                i.drawImage(n, 0, 0, s, r, 0, t, s, r)
            }
            return this.clear(),
            this.copy(this._swapCanvas)
        },
        add: function(t) {
            if (Array.isArray(t))
                for (var e = 0; e < t.length; e++)
                    t[e].loadTexture && t[e].loadTexture(this);
            else
                t.loadTexture(this);
            return this
        },
        load: function(t) {
            if ("string" == typeof t && (t = this.game.cache.getImage(t)),
            t)
                return this.resize(t.width, t.height),
                this.cls(),
                this.draw(t),
                this.update(),
                this
        },
        clear: function(t, e, i, s) {
            return void 0 === t && (t = 0),
            void 0 === e && (e = 0),
            void 0 === i && (i = this.width),
            void 0 === s && (s = this.height),
            this.context.clearRect(t, e, i, s),
            this.dirty = !0,
            this
        },
        fill: function(t, e, i, s) {
            return void 0 === s && (s = 1),
            this.context.fillStyle = "rgba(" + t + "," + e + "," + i + "," + s + ")",
            this.context.fillRect(0, 0, this.width, this.height),
            this.dirty = !0,
            this
        },
        generateTexture: function(t) {
            var e = new Image;
            e.src = this.canvas.toDataURL("image/png");
            var i = this.game.cache.addImage(t, "", e);
            return new PIXI.Texture(i.base)
        },
        resize: function(t, e) {
            return t === this.width && e === this.height || (this.width = t,
            this.height = e,
            this.canvas.width = t,
            this.canvas.height = e,
            void 0 !== this._swapCanvas && (this._swapCanvas.width = t,
            this._swapCanvas.height = e),
            this.baseTexture.width = t,
            this.baseTexture.height = e,
            this.textureFrame.width = t,
            this.textureFrame.height = e,
            this.texture.width = t,
            this.texture.height = e,
            this.texture.crop.width = t,
            this.texture.crop.height = e,
            this.update(),
            this.dirty = !0),
            this
        },
        update: function(t, e, i, s) {
            return void 0 === t && (t = 0),
            void 0 === e && (e = 0),
            void 0 === i && (i = Math.max(1, this.width)),
            void 0 === s && (s = Math.max(1, this.height)),
            this.imageData = this.context.getImageData(t, e, i, s),
            this.data = this.imageData.data,
            this.imageData.data.buffer ? (this.buffer = this.imageData.data.buffer,
            this.pixels = new Uint32Array(this.buffer)) : window.ArrayBuffer ? (this.buffer = new ArrayBuffer(this.imageData.data.length),
            this.pixels = new Uint32Array(this.buffer)) : this.pixels = this.imageData.data,
            this
        },
        processPixelRGB: function(t, e, i, s, n, r) {
            void 0 === i && (i = 0),
            void 0 === s && (s = 0),
            void 0 === n && (n = this.width),
            void 0 === r && (r = this.height);
            for (var o = i + n, a = s + r, h = H.Color.createColor(), l = {
                r: 0,
                g: 0,
                b: 0,
                a: 0
            }, c = !1, d = s; d < a; d++)
                for (var u = i; u < o; u++)
                    H.Color.unpackPixel(this.getPixel32(u, d), h),
                    !1 !== (l = t.call(e, h, u, d)) && null != l && (this.setPixel32(u, d, l.r, l.g, l.b, l.a, !1),
                    c = !0);
            return c && (this.context.putImageData(this.imageData, 0, 0),
            this.dirty = !0),
            this
        },
        processPixel: function(t, e, i, s, n, r) {
            void 0 === i && (i = 0),
            void 0 === s && (s = 0),
            void 0 === n && (n = this.width),
            void 0 === r && (r = this.height);
            for (var o = i + n, a = s + r, h = 0, l = 0, c = !1, d = s; d < a; d++)
                for (var u = i; u < o; u++)
                    h = this.getPixel32(u, d),
                    (l = t.call(e, h, u, d)) !== h && (this.pixels[d * this.width + u] = l,
                    c = !0);
            return c && (this.context.putImageData(this.imageData, 0, 0),
            this.dirty = !0),
            this
        },
        replaceRGB: function(t, e, i, s, n, r, o, a, h) {
            var l = 0
              , c = 0
              , d = this.width
              , u = this.height
              , p = H.Color.packPixel(t, e, i, s);
            void 0 !== h && h instanceof H.Rectangle && (l = h.x,
            c = h.y,
            d = h.width,
            u = h.height);
            for (var g = 0; g < u; g++)
                for (var f = 0; f < d; f++)
                    this.getPixel32(l + f, c + g) === p && this.setPixel32(l + f, c + g, n, r, o, a, !1);
            return this.context.putImageData(this.imageData, 0, 0),
            this.dirty = !0,
            this
        },
        setHSL: function(t, e, i, s) {
            var n = t || 0 === t
              , r = e || 0 === e
              , o = i || 0 === i;
            if (n || r || o) {
                void 0 === s && (s = new H.Rectangle(0,0,this.width,this.height));
                for (var a = H.Color.createColor(), h = s.y; h < s.bottom; h++)
                    for (var l = s.x; l < s.right; l++)
                        H.Color.unpackPixel(this.getPixel32(l, h), a, !0),
                        n && (a.h = t),
                        r && (a.s = e),
                        o && (a.l = i),
                        H.Color.HSLtoRGB(a.h, a.s, a.l, a),
                        this.setPixel32(l, h, a.r, a.g, a.b, a.a, !1);
                return this.context.putImageData(this.imageData, 0, 0),
                this.dirty = !0,
                this
            }
        },
        shiftHSL: function(t, e, i, s) {
            if (null != t || (t = !1),
            null != e || (e = !1),
            null != i || (i = !1),
            t || e || i) {
                void 0 === s && (s = new H.Rectangle(0,0,this.width,this.height));
                for (var n = H.Color.createColor(), r = s.y; r < s.bottom; r++)
                    for (var o = s.x; o < s.right; o++)
                        H.Color.unpackPixel(this.getPixel32(o, r), n, !0),
                        t && (n.h = this.game.math.wrap(n.h + t, 0, 1)),
                        e && (n.s = this.game.math.clamp(n.s + e, 0, 1)),
                        i && (n.l = this.game.math.clamp(n.l + i, 0, 1)),
                        H.Color.HSLtoRGB(n.h, n.s, n.l, n),
                        this.setPixel32(o, r, n.r, n.g, n.b, n.a, !1);
                return this.context.putImageData(this.imageData, 0, 0),
                this.dirty = !0,
                this
            }
        },
        setPixel32: function(t, e, i, s, n, r, o) {
            return void 0 === o && (o = !0),
            0 <= t && t <= this.width && 0 <= e && e <= this.height && (H.Device.LITTLE_ENDIAN ? this.pixels[e * this.width + t] = r << 24 | n << 16 | s << 8 | i : this.pixels[e * this.width + t] = i << 24 | s << 16 | n << 8 | r,
            o && (this.context.putImageData(this.imageData, 0, 0),
            this.dirty = !0)),
            this
        },
        setPixel: function(t, e, i, s, n, r) {
            return this.setPixel32(t, e, i, s, n, 255, r)
        },
        getPixel: function(t, e, i) {
            i || (i = H.Color.createColor());
            var s = ~~(t + e * this.width);
            return s *= 4,
            i.r = this.data[s],
            i.g = this.data[++s],
            i.b = this.data[++s],
            i.a = this.data[++s],
            i
        },
        getPixel32: function(t, e) {
            if (0 <= t && t <= this.width && 0 <= e && e <= this.height)
                return this.pixels[e * this.width + t]
        },
        getPixelRGB: function(t, e, i, s, n) {
            return H.Color.unpackPixel(this.getPixel32(t, e), i, s, n)
        },
        getPixels: function(t) {
            return this.context.getImageData(t.x, t.y, t.width, t.height)
        },
        getFirstPixel: function(t) {
            void 0 === t && (t = 0);
            var e = H.Color.createColor()
              , i = 0
              , s = 0
              , n = 1
              , r = !1;
            for (1 === t ? (n = -1,
            s = this.height) : 3 === t && (n = -1,
            i = this.width); H.Color.unpackPixel(this.getPixel32(i, s), e),
            0 === t || 1 === t ? ++i === this.width && (i = 0,
            ((s += n) >= this.height || s <= 0) && (r = !0)) : 2 !== t && 3 !== t || ++s === this.height && (s = 0,
            ((i += n) >= this.width || i <= 0) && (r = !0)),
            0 === e.a && !r; )
                ;
            return e.x = i,
            e.y = s,
            e
        },
        getBounds: function(t) {
            return void 0 === t && (t = new H.Rectangle),
            t.x = this.getFirstPixel(2).x,
            t.x === this.width ? t.setTo(0, 0, 0, 0) : (t.y = this.getFirstPixel(0).y,
            t.width = this.getFirstPixel(3).x - t.x + 1,
            t.height = this.getFirstPixel(1).y - t.y + 1,
            t)
        },
        addToWorld: function(t, e, i, s, n, r) {
            n = n || 1,
            r = r || 1;
            var o = this.game.add.image(t, e, this);
            return o.anchor.set(i, s),
            o.scale.set(n, r),
            o
        },
        copy: function(t, e, i, s, n, r, o, a, h, l, c, d, u, p, g, f, m) {
            if (null != t || (t = this),
            (t instanceof H.RenderTexture || t instanceof PIXI.RenderTexture) && (t = t.getCanvas()),
            (this._image = t)instanceof H.Sprite || t instanceof H.Image || t instanceof H.Text || t instanceof PIXI.Sprite)
                this._pos.set(t.texture.crop.x, t.texture.crop.y),
                this._size.set(t.texture.crop.width, t.texture.crop.height),
                this._scale.set(t.scale.x, t.scale.y),
                this._anchor.set(t.anchor.x, t.anchor.y),
                this._rotate = t.rotation,
                this._alpha.current = t.alpha,
                t.texture instanceof H.RenderTexture || t.texture instanceof PIXI.RenderTexture ? this._image = t.texture.getCanvas() : this._image = t.texture.baseTexture.source,
                null != r || (r = t.x),
                null != o || (o = t.y),
                t.texture.trim && (r += t.texture.trim.x - t.anchor.x * t.texture.trim.width,
                o += t.texture.trim.y - t.anchor.y * t.texture.trim.height),
                16777215 !== t.tint && (t.cachedTint !== t.tint && (t.cachedTint = t.tint,
                t.tintedTexture = PIXI.CanvasTinter.getTintedTexture(t, t.tint)),
                this._image = t.tintedTexture,
                this._pos.set(0));
            else {
                if (this._pos.set(0),
                this._scale.set(1),
                this._anchor.set(0),
                this._rotate = 0,
                this._alpha.current = 1,
                t instanceof H.BitmapData)
                    this._image = t.canvas;
                else if ("string" == typeof t) {
                    if (null === (t = this.game.cache.getImage(t)))
                        return;
                    this._image = t
                }
                this._size.set(this._image.width, this._image.height)
            }
            if (null != e || (e = 0),
            null != i || (i = 0),
            s && (this._size.x = s),
            n && (this._size.y = n),
            null != r || (r = e),
            null != o || (o = i),
            null != a || (a = this._size.x),
            null != h || (h = this._size.y),
            "number" == typeof l && (this._rotate = l),
            "number" == typeof c && (this._anchor.x = c),
            "number" == typeof d && (this._anchor.y = d),
            "number" == typeof u && (this._scale.x = u),
            "number" == typeof p && (this._scale.y = p),
            "number" == typeof g && (this._alpha.current = g),
            void 0 === f && (f = null),
            void 0 === m && (m = !1),
            !(this._alpha.current <= 0 || 0 === this._scale.x || 0 === this._scale.y || 0 === this._size.x || 0 === this._size.y)) {
                var y = this.context;
                return this._alpha.prev = y.globalAlpha,
                y.save(),
                y.globalAlpha = this._alpha.current,
                f && (this.op = f),
                m && (r |= 0,
                o |= 0),
                y.translate(r, o),
                y.scale(this._scale.x, this._scale.y),
                y.rotate(this._rotate),
                y.drawImage(this._image, this._pos.x + e, this._pos.y + i, this._size.x, this._size.y, -a * this._anchor.x, -h * this._anchor.y, a, h),
                y.restore(),
                y.globalAlpha = this._alpha.prev,
                this.dirty = !0,
                this
            }
        },
        copyTransform: function(t, e, i) {
            if (void 0 === e && (e = null),
            void 0 === i && (i = !1),
            !t.hasOwnProperty("worldTransform") || !t.worldVisible || 0 === t.worldAlpha)
                return this;
            var s = t.worldTransform;
            if (this._pos.set(t.texture.crop.x, t.texture.crop.y),
            this._size.set(t.texture.crop.width, t.texture.crop.height),
            0 === s.a || 0 === s.d || 0 === this._size.x || 0 === this._size.y)
                return this;
            t.texture instanceof H.RenderTexture || t.texture instanceof PIXI.RenderTexture ? this._image = t.texture.getCanvas() : this._image = t.texture.baseTexture.source;
            var n = s.tx
              , r = s.ty;
            t.texture.trim && (n += t.texture.trim.x - t.anchor.x * t.texture.trim.width,
            r += t.texture.trim.y - t.anchor.y * t.texture.trim.height),
            16777215 !== t.tint && (t.cachedTint !== t.tint && (t.cachedTint = t.tint,
            t.tintedTexture = PIXI.CanvasTinter.getTintedTexture(t, t.tint)),
            this._image = t.tintedTexture,
            this._pos.set(0)),
            i && (n |= 0,
            r |= 0);
            var o = this.context;
            return this._alpha.prev = o.globalAlpha,
            o.save(),
            o.globalAlpha = this._alpha.current,
            e && (this.op = e),
            o[this.smoothProperty] = t.texture.baseTexture.scaleMode === PIXI.scaleModes.LINEAR,
            o.setTransform(s.a, s.b, s.c, s.d, n, r),
            o.drawImage(this._image, this._pos.x, this._pos.y, this._size.x, this._size.y, -this._size.x * t.anchor.x, -this._size.y * t.anchor.y, this._size.x, this._size.y),
            o.restore(),
            o.globalAlpha = this._alpha.prev,
            this.dirty = !0,
            this
        },
        copyRect: function(t, e, i, s, n, r, o) {
            return this.copy(t, e.x, e.y, e.width, e.height, i, s, e.width, e.height, 0, 0, 0, 1, 1, n, r, o)
        },
        draw: function(t, e, i, s, n, r, o) {
            return this.copy(t, null, null, null, null, e, i, s, n, null, null, null, null, null, null, r, o)
        },
        drawGroup: function(t, e, i) {
            return 0 < t.total && t.forEachExists(this.drawGroupProxy, this, e, i),
            this
        },
        drawGroupProxy: function(t, e, i) {
            if (t.hasOwnProperty("texture") && this.copyTransform(t, e, i),
            t.type === H.GROUP && t.exists)
                this.drawGroup(t, e, i);
            else if (t.hasOwnProperty("children") && 0 < t.children.length)
                for (var s = 0; s < t.children.length; s++)
                    t.children[s].exists && this.copyTransform(t.children[s], e, i)
        },
        drawFull: function(t, e, i) {
            if (!1 === t.worldVisible || 0 === t.worldAlpha || t.hasOwnProperty("exists") && !1 === t.exists)
                return this;
            if (t.type !== H.GROUP && t.type !== H.EMITTER && t.type !== H.BITMAPTEXT)
                if (t.type === H.GRAPHICS) {
                    var s = t.getBounds();
                    this.ctx.save(),
                    this.ctx.translate(s.x, s.y),
                    PIXI.CanvasGraphics.renderGraphics(t, this.ctx),
                    this.ctx.restore()
                } else
                    this.copy(t, null, null, null, null, t.worldPosition.x, t.worldPosition.y, null, null, t.worldRotation, null, null, t.worldScale.x, t.worldScale.y, t.worldAlpha, e, i);
            if (t.children)
                for (var n = 0; n < t.children.length; n++)
                    this.drawFull(t.children[n], e, i);
            return this
        },
        shadow: function(t, e, i, s) {
            var n = this.context;
            return null == t ? n.shadowColor = "rgba(0,0,0,0)" : (n.shadowColor = t,
            n.shadowBlur = e || 5,
            n.shadowOffsetX = i || 10,
            n.shadowOffsetY = s || 10),
            this
        },
        alphaMask: function(t, e, i, s) {
            return null == s ? this.draw(e).blendSourceAtop() : this.draw(e, s.x, s.y, s.width, s.height).blendSourceAtop(),
            null == i ? this.draw(t).blendReset() : this.draw(t, i.x, i.y, i.width, i.height).blendReset(),
            this
        },
        extract: function(s, n, r, o, a, t, h, l, c) {
            return void 0 === a && (a = 255),
            void 0 === t && (t = !1),
            void 0 === h && (h = n),
            void 0 === l && (l = r),
            void 0 === c && (c = o),
            t && s.resize(this.width, this.height),
            this.processPixelRGB(function(t, e, i) {
                return t.r === n && t.g === r && t.b === o && s.setPixel32(e, i, h, l, c, a, !1),
                !1
            }, this),
            s.context.putImageData(s.imageData, 0, 0),
            s.dirty = !0,
            s
        },
        rect: function(t, e, i, s, n) {
            return void 0 !== n && (this.context.fillStyle = n),
            this.context.fillRect(t, e, i, s),
            this
        },
        text: function(t, e, i, s, n, r) {
            void 0 === e && (e = 0),
            void 0 === i && (i = 0),
            void 0 === s && (s = "14px Courier"),
            void 0 === n && (n = "rgb(255,255,255)"),
            void 0 === r && (r = !0);
            var o = this.context
              , a = o.font;
            return o.font = s,
            r && (o.fillStyle = "rgb(0,0,0)",
            o.fillText(t, e + 1, i + 1)),
            o.fillStyle = n,
            o.fillText(t, e, i),
            o.font = a,
            this
        },
        circle: function(t, e, i, s) {
            var n = this.context;
            return void 0 !== s && (n.fillStyle = s),
            n.beginPath(),
            n.arc(t, e, i, 0, 2 * Math.PI, !1),
            n.closePath(),
            n.fill(),
            this
        },
        line: function(t, e, i, s, n, r) {
            void 0 === n && (n = "#fff"),
            void 0 === r && (r = 1);
            var o = this.context;
            return o.beginPath(),
            o.moveTo(t, e),
            o.lineTo(i, s),
            o.lineWidth = r,
            o.strokeStyle = n,
            o.stroke(),
            o.closePath(),
            this
        },
        textureLine: function(t, e, i) {
            if (void 0 === i && (i = "repeat-x"),
            "string" != typeof e || (e = this.game.cache.getImage(e))) {
                var s = t.length;
                "no-repeat" === i && s > e.width && (s = e.width);
                var n = this.context;
                return n.fillStyle = n.createPattern(e, i),
                this._circle = new H.Circle(t.start.x,t.start.y,e.height),
                this._circle.circumferencePoint(t.angle - 1.5707963267948966, !1, this._pos),
                n.save(),
                n.translate(this._pos.x, this._pos.y),
                n.rotate(t.angle),
                n.fillRect(0, 0, s, e.height),
                n.restore(),
                this.dirty = !0,
                this
            }
        },
        render: function() {
            return !this.disableTextureUpload && this.dirty && (this.baseTexture.dirty(),
            this.dirty = !1),
            this
        },
        destroy: function() {
            this.frameData.destroy(),
            this.texture.destroy(!0),
            PIXI.CanvasPool.remove(this)
        },
        blendReset: function() {
            return this.op = "source-over",
            this
        },
        blendSourceOver: function() {
            return this.op = "source-over",
            this
        },
        blendSourceIn: function() {
            return this.op = "source-in",
            this
        },
        blendSourceOut: function() {
            return this.op = "source-out",
            this
        },
        blendSourceAtop: function() {
            return this.op = "source-atop",
            this
        },
        blendDestinationOver: function() {
            return this.op = "destination-over",
            this
        },
        blendDestinationIn: function() {
            return this.op = "destination-in",
            this
        },
        blendDestinationOut: function() {
            return this.op = "destination-out",
            this
        },
        blendDestinationAtop: function() {
            return this.op = "destination-atop",
            this
        },
        blendXor: function() {
            return this.op = "xor",
            this
        },
        blendAdd: function() {
            return this.op = "lighter",
            this
        },
        blendMultiply: function() {
            return this.op = "multiply",
            this
        },
        blendScreen: function() {
            return this.op = "screen",
            this
        },
        blendOverlay: function() {
            return this.op = "overlay",
            this
        },
        blendDarken: function() {
            return this.op = "darken",
            this
        },
        blendLighten: function() {
            return this.op = "lighten",
            this
        },
        blendColorDodge: function() {
            return this.op = "color-dodge",
            this
        },
        blendColorBurn: function() {
            return this.op = "color-burn",
            this
        },
        blendHardLight: function() {
            return this.op = "hard-light",
            this
        },
        blendSoftLight: function() {
            return this.op = "soft-light",
            this
        },
        blendDifference: function() {
            return this.op = "difference",
            this
        },
        blendExclusion: function() {
            return this.op = "exclusion",
            this
        },
        blendHue: function() {
            return this.op = "hue",
            this
        },
        blendSaturation: function() {
            return this.op = "saturation",
            this
        },
        blendColor: function() {
            return this.op = "color",
            this
        },
        blendLuminosity: function() {
            return this.op = "luminosity",
            this
        }
    },
    Object.defineProperty(H.BitmapData.prototype, "smoothed", {
        get: function() {
            H.Canvas.getSmoothingEnabled(this.context)
        },
        set: function(t) {
            H.Canvas.setSmoothingEnabled(this.context, t)
        }
    }),
    Object.defineProperty(H.BitmapData.prototype, "op", {
        get: function() {
            return this.context.globalCompositeOperation
        },
        set: function(t) {
            this.context.globalCompositeOperation = t
        }
    }),
    H.BitmapData.getTransform = function(t, e, i, s, n, r) {
        return "number" != typeof t && (t = 0),
        "number" != typeof e && (e = 0),
        "number" != typeof i && (i = 1),
        "number" != typeof s && (s = 1),
        "number" != typeof n && (n = 0),
        "number" != typeof r && (r = 0),
        {
            sx: i,
            sy: s,
            scaleX: i,
            scaleY: s,
            skewX: n,
            skewY: r,
            translateX: t,
            translateY: e,
            tx: t,
            ty: e
        }
    }
    ,
    H.BitmapData.prototype.constructor = H.BitmapData,
    PIXI.Graphics = function() {
        PIXI.DisplayObjectContainer.call(this),
        this.renderable = !0,
        this.fillAlpha = 1,
        this.lineWidth = 0,
        this.lineColor = 0,
        this.graphicsData = [],
        this.tint = 16777215,
        this.blendMode = PIXI.blendModes.NORMAL,
        this.currentPath = null,
        this._webGL = [],
        this.isMask = !1,
        this.boundsPadding = 0,
        this._localBounds = new PIXI.Rectangle(0,0,1,1),
        this.dirty = !0,
        this._boundsDirty = !1,
        this.webGLDirty = !1,
        this.cachedSpriteDirty = !1
    }
    ,
    PIXI.Graphics.prototype = Object.create(PIXI.DisplayObjectContainer.prototype),
    PIXI.Graphics.prototype.constructor = PIXI.Graphics,
    PIXI.Graphics.prototype.lineStyle = function(t, e, i) {
        return this.lineWidth = t || 0,
        this.lineColor = e || 0,
        this.lineAlpha = void 0 === i ? 1 : i,
        this.currentPath && (this.currentPath.shape.points.length ? this.drawShape(new PIXI.Polygon(this.currentPath.shape.points.slice(-2))) : (this.currentPath.lineWidth = this.lineWidth,
        this.currentPath.lineColor = this.lineColor,
        this.currentPath.lineAlpha = this.lineAlpha)),
        this
    }
    ,
    PIXI.Graphics.prototype.moveTo = function(t, e) {
        return this.drawShape(new PIXI.Polygon([t, e])),
        this
    }
    ,
    PIXI.Graphics.prototype.lineTo = function(t, e) {
        return this.currentPath || this.moveTo(0, 0),
        this.currentPath.shape.points.push(t, e),
        this.dirty = !0,
        this._boundsDirty = !0,
        this
    }
    ,
    PIXI.Graphics.prototype.quadraticCurveTo = function(t, e, i, s) {
        this.currentPath ? 0 === this.currentPath.shape.points.length && (this.currentPath.shape.points = [0, 0]) : this.moveTo(0, 0);
        var n, r, o = this.currentPath.shape.points;
        0 === o.length && this.moveTo(0, 0);
        for (var a = o[o.length - 2], h = o[o.length - 1], l = 0, c = 1; c <= 20; ++c)
            n = a + (t - a) * (l = c / 20),
            r = h + (e - h) * l,
            o.push(n + (t + (i - t) * l - n) * l, r + (e + (s - e) * l - r) * l);
        return this.dirty = !0,
        this._boundsDirty = !0,
        this
    }
    ,
    PIXI.Graphics.prototype.bezierCurveTo = function(t, e, i, s, n, r) {
        this.currentPath ? 0 === this.currentPath.shape.points.length && (this.currentPath.shape.points = [0, 0]) : this.moveTo(0, 0);
        for (var o, a, h, l, c, d = this.currentPath.shape.points, u = d[d.length - 2], p = d[d.length - 1], g = 0, f = 1; f <= 20; ++f)
            h = (a = (o = 1 - (g = f / 20)) * o) * o,
            c = (l = g * g) * g,
            d.push(h * u + 3 * a * g * t + 3 * o * l * i + c * n, h * p + 3 * a * g * e + 3 * o * l * s + c * r);
        return this.dirty = !0,
        this._boundsDirty = !0,
        this
    }
    ,
    PIXI.Graphics.prototype.arcTo = function(t, e, i, s, n) {
        this.currentPath ? 0 === this.currentPath.shape.points.length && this.currentPath.shape.points.push(t, e) : this.moveTo(t, e);
        var r = this.currentPath.shape.points
          , o = r[r.length - 2]
          , a = r[r.length - 1] - e
          , h = o - t
          , l = s - e
          , c = i - t
          , d = Math.abs(a * c - h * l);
        if (d < 1e-8 || 0 === n)
            r[r.length - 2] === t && r[r.length - 1] === e || r.push(t, e);
        else {
            var u = a * a + h * h
              , p = l * l + c * c
              , g = a * l + h * c
              , f = n * Math.sqrt(u) / d
              , m = n * Math.sqrt(p) / d
              , y = f * g / u
              , v = m * g / p
              , _ = f * c + m * h
              , b = f * l + m * a
              , w = h * (m + y)
              , x = a * (m + y)
              , S = c * (f + v)
              , T = l * (f + v)
              , A = Math.atan2(x - b, w - _)
              , C = Math.atan2(T - b, S - _);
            this.arc(_ + t, b + e, n, A, C, c * a < h * l)
        }
        return this.dirty = !0,
        this._boundsDirty = !0,
        this
    }
    ,
    PIXI.Graphics.prototype.arc = function(t, e, i, s, n, r, o) {
        if (s === n)
            return this;
        void 0 === r && (r = !1),
        void 0 === o && (o = 40),
        !r && n <= s ? n += 2 * Math.PI : r && s <= n && (s += 2 * Math.PI);
        var a = r ? -1 * (s - n) : n - s
          , h = Math.ceil(Math.abs(a) / (2 * Math.PI)) * o;
        if (0 === a)
            return this;
        var l = t + Math.cos(s) * i
          , c = e + Math.sin(s) * i;
        r && this.filling ? this.moveTo(t, e) : this.moveTo(l, c);
        for (var d = this.currentPath.shape.points, u = a / (2 * h), p = 2 * u, g = Math.cos(u), f = Math.sin(u), m = h - 1, y = m % 1 / m, v = 0; v <= m; v++) {
            var _ = u + s + p * (v + y * v)
              , b = Math.cos(_)
              , w = -Math.sin(_);
            d.push((g * b + f * w) * i + t, (g * -w + f * b) * i + e)
        }
        return this.dirty = !0,
        this._boundsDirty = !0,
        this
    }
    ,
    PIXI.Graphics.prototype.beginFill = function(t, e) {
        return this.filling = !0,
        this.fillColor = t || 0,
        this.fillAlpha = void 0 === e ? 1 : e,
        this.currentPath && this.currentPath.shape.points.length <= 2 && (this.currentPath.fill = this.filling,
        this.currentPath.fillColor = this.fillColor,
        this.currentPath.fillAlpha = this.fillAlpha),
        this
    }
    ,
    PIXI.Graphics.prototype.endFill = function() {
        return this.filling = !1,
        this.fillColor = null,
        this.fillAlpha = 1,
        this
    }
    ,
    PIXI.Graphics.prototype.drawRect = function(t, e, i, s) {
        return this.drawShape(new PIXI.Rectangle(t,e,i,s)),
        this
    }
    ,
    PIXI.Graphics.prototype.drawRoundedRect = function(t, e, i, s, n) {
        return this.drawShape(new PIXI.RoundedRectangle(t,e,i,s,n)),
        this
    }
    ,
    PIXI.Graphics.prototype.drawCircle = function(t, e, i) {
        return this.drawShape(new PIXI.Circle(t,e,i)),
        this
    }
    ,
    PIXI.Graphics.prototype.drawEllipse = function(t, e, i, s) {
        return this.drawShape(new PIXI.Ellipse(t,e,i,s)),
        this
    }
    ,
    PIXI.Graphics.prototype.drawPolygon = function(t) {
        (t instanceof H.Polygon || t instanceof PIXI.Polygon) && (t = t.points);
        var e = t;
        if (!Array.isArray(e)) {
            e = new Array(arguments.length);
            for (var i = 0; i < e.length; ++i)
                e[i] = arguments[i]
        }
        return this.drawShape(new H.Polygon(e)),
        this
    }
    ,
    PIXI.Graphics.prototype.clear = function() {
        return this.lineWidth = 0,
        this.filling = !1,
        this.dirty = !0,
        this._boundsDirty = !0,
        this.clearDirty = !0,
        this.graphicsData = [],
        this.updateLocalBounds(),
        this
    }
    ,
    PIXI.Graphics.prototype.generateTexture = function(t, e, i) {
        void 0 === t && (t = 1),
        void 0 === e && (e = PIXI.scaleModes.DEFAULT),
        void 0 === i && (i = 0);
        var s = this.getBounds();
        s.width += i,
        s.height += i;
        var n = new PIXI.CanvasBuffer(s.width * t,s.height * t)
          , r = PIXI.Texture.fromCanvas(n.canvas, e);
        return r.baseTexture.resolution = t,
        n.context.scale(t, t),
        n.context.translate(-s.x, -s.y),
        PIXI.CanvasGraphics.renderGraphics(this, n.context),
        r
    }
    ,
    PIXI.Graphics.prototype._renderWebGL = function(t) {
        if (!1 !== this.visible && 0 !== this.alpha && !0 !== this.isMask) {
            if (this._cacheAsBitmap)
                return (this.dirty || this.cachedSpriteDirty) && (this._generateCachedSprite(),
                this.updateCachedSpriteTexture(),
                this.cachedSpriteDirty = !1,
                this.dirty = !1),
                this._cachedSprite.worldAlpha = this.worldAlpha,
                void PIXI.Sprite.prototype._renderWebGL.call(this._cachedSprite, t);
            if (t.spriteBatch.stop(),
            t.blendModeManager.setBlendMode(this.blendMode),
            this._mask && t.maskManager.pushMask(this._mask, t),
            this._filters && t.filterManager.pushFilter(this._filterBlock),
            this.blendMode !== t.spriteBatch.currentBlendMode) {
                t.spriteBatch.currentBlendMode = this.blendMode;
                var e = PIXI.blendModesWebGL[t.spriteBatch.currentBlendMode];
                t.spriteBatch.gl.blendFunc(e[0], e[1])
            }
            if (this.webGLDirty && (this.dirty = !0,
            this.webGLDirty = !1),
            PIXI.WebGLGraphics.renderGraphics(this, t),
            this.children.length) {
                t.spriteBatch.start();
                for (var i = 0; i < this.children.length; i++)
                    this.children[i]._renderWebGL(t);
                t.spriteBatch.stop()
            }
            this._filters && t.filterManager.popFilter(),
            this._mask && t.maskManager.popMask(this.mask, t),
            t.drawCount++,
            t.spriteBatch.start()
        }
    }
    ,
    PIXI.Graphics.prototype._renderCanvas = function(t) {
        if (!1 !== this.visible && 0 !== this.alpha && !0 !== this.isMask) {
            if (this._prevTint !== this.tint && (this.dirty = !0,
            this._prevTint = this.tint),
            this._cacheAsBitmap)
                return (this.dirty || this.cachedSpriteDirty) && (this._generateCachedSprite(),
                this.updateCachedSpriteTexture(),
                this.cachedSpriteDirty = !1,
                this.dirty = !1),
                this._cachedSprite.alpha = this.alpha,
                void PIXI.Sprite.prototype._renderCanvas.call(this._cachedSprite, t);
            var e = t.context
              , i = this.worldTransform;
            this.blendMode !== t.currentBlendMode && (t.currentBlendMode = this.blendMode,
            e.globalCompositeOperation = PIXI.blendModesCanvas[t.currentBlendMode]),
            this._mask && t.maskManager.pushMask(this._mask, t);
            var s = t.resolution
              , n = i.tx * t.resolution + t.shakeX
              , r = i.ty * t.resolution + t.shakeY;
            e.setTransform(i.a * s, i.b * s, i.c * s, i.d * s, n, r),
            PIXI.CanvasGraphics.renderGraphics(this, e);
            for (var o = 0; o < this.children.length; o++)
                this.children[o]._renderCanvas(t);
            this._mask && t.maskManager.popMask(t)
        }
    }
    ,
    PIXI.Graphics.prototype.getBounds = function(t) {
        if (!this._currentBounds) {
            if (!this.renderable)
                return PIXI.EmptyRectangle;
            this.dirty && (this.updateLocalBounds(),
            this.webGLDirty = !0,
            this.cachedSpriteDirty = !0,
            this.dirty = !1);
            var e = this._localBounds
              , i = e.x
              , s = e.width + e.x
              , n = e.y
              , r = e.height + e.y
              , o = t || this.worldTransform
              , a = o.a
              , h = o.b
              , l = o.c
              , c = o.d
              , d = o.tx
              , u = o.ty
              , p = a * s + l * r + d
              , g = c * r + h * s + u
              , f = a * i + l * r + d
              , m = c * r + h * i + u
              , y = a * i + l * n + d
              , v = c * n + h * i + u
              , _ = a * s + l * n + d
              , b = c * n + h * s + u
              , w = p
              , x = g
              , S = p
              , T = g;
            S = _ < (S = y < (S = f < S ? f : S) ? y : S) ? _ : S,
            T = b < (T = v < (T = m < T ? m : T) ? v : T) ? b : T,
            w = (w = (w = w < f ? f : w) < y ? y : w) < _ ? _ : w,
            x = (x = (x = x < m ? m : x) < v ? v : x) < b ? b : x,
            this._bounds.x = S,
            this._bounds.width = w - S,
            this._bounds.y = T,
            this._bounds.height = x - T,
            this._currentBounds = this._bounds
        }
        return this._currentBounds
    }
    ,
    PIXI.Graphics.prototype.getLocalBounds = function() {
        var t = this.worldTransform;
        this.worldTransform = PIXI.identityMatrix;
        for (var e = 0; e < this.children.length; e++)
            this.children[e].updateTransform();
        var i = this.getBounds();
        for (this.worldTransform = t,
        e = 0; e < this.children.length; e++)
            this.children[e].updateTransform();
        return i
    }
    ,
    PIXI.Graphics.prototype.containsPoint = function(t) {
        this.worldTransform.applyInverse(t, tempPoint);
        for (var e = this.graphicsData, i = 0; i < e.length; i++) {
            var s = e[i];
            if (s.fill && s.shape && s.shape.contains(tempPoint.x, tempPoint.y))
                return !0
        }
        return !1
    }
    ,
    PIXI.Graphics.prototype.updateLocalBounds = function() {
        var t = 1 / 0
          , e = -1 / 0
          , i = 1 / 0
          , s = -1 / 0;
        if (this.graphicsData.length)
            for (var n, r, o, a, h, l, c = 0; c < this.graphicsData.length; c++) {
                var d = this.graphicsData[c]
                  , u = d.type
                  , p = d.lineWidth;
                if (n = d.shape,
                u === PIXI.Graphics.RECT || u === PIXI.Graphics.RREC)
                    o = n.x - p / 2,
                    a = n.y - p / 2,
                    t = o < t ? o : t,
                    e = e < o + (h = n.width + p) ? o + h : e,
                    i = a < i ? a : i,
                    s = s < a + (l = n.height + p) ? a + l : s;
                else if (u === PIXI.Graphics.CIRC)
                    o = n.x,
                    a = n.y,
                    t = o - (h = n.radius + p / 2) < t ? o - h : t,
                    e = e < o + h ? o + h : e,
                    i = a - (l = n.radius + p / 2) < i ? a - l : i,
                    s = s < a + l ? a + l : s;
                else if (u === PIXI.Graphics.ELIP)
                    o = n.x,
                    a = n.y,
                    t = o - (h = n.width + p / 2) < t ? o - h : t,
                    e = e < o + h ? o + h : e,
                    i = a - (l = n.height + p / 2) < i ? a - l : i,
                    s = s < a + l ? a + l : s;
                else {
                    r = n.points;
                    for (var g = 0; g < r.length; g++)
                        r[g]instanceof H.Point ? (o = r[g].x,
                        a = r[g].y) : (o = r[g],
                        a = r[g + 1],
                        g < r.length - 1 && g++),
                        t = o - p < t ? o - p : t,
                        e = e < o + p ? o + p : e,
                        i = a - p < i ? a - p : i,
                        s = s < a + p ? a + p : s
                }
            }
        else
            s = i = e = t = 0;
        var f = this.boundsPadding;
        this._localBounds.x = t - f,
        this._localBounds.width = e - t + 2 * f,
        this._localBounds.y = i - f,
        this._localBounds.height = s - i + 2 * f
    }
    ,
    PIXI.Graphics.prototype._generateCachedSprite = function() {
        var t = this.getLocalBounds();
        if (this._cachedSprite)
            this._cachedSprite.buffer.resize(t.width, t.height);
        else {
            var e = new PIXI.CanvasBuffer(t.width,t.height)
              , i = PIXI.Texture.fromCanvas(e.canvas);
            this._cachedSprite = new PIXI.Sprite(i),
            this._cachedSprite.buffer = e,
            this._cachedSprite.worldTransform = this.worldTransform
        }
        this._cachedSprite.anchor.x = -t.x / t.width,
        this._cachedSprite.anchor.y = -t.y / t.height,
        this._cachedSprite.buffer.context.translate(-t.x, -t.y),
        this.worldAlpha = 1,
        PIXI.CanvasGraphics.renderGraphics(this, this._cachedSprite.buffer.context),
        this._cachedSprite.alpha = this.alpha
    }
    ,
    PIXI.Graphics.prototype.updateCachedSpriteTexture = function() {
        var t = this._cachedSprite
          , e = t.texture
          , i = t.buffer.canvas;
        e.baseTexture.width = i.width,
        e.baseTexture.height = i.height,
        e.crop.width = e.frame.width = i.width,
        e.crop.height = e.frame.height = i.height,
        t._width = i.width,
        t._height = i.height,
        e.baseTexture.dirty()
    }
    ,
    PIXI.Graphics.prototype.destroyCachedSprite = function() {
        this._cachedSprite.texture.destroy(!0),
        this._cachedSprite = null
    }
    ,
    PIXI.Graphics.prototype.drawShape = function(t) {
        this.currentPath && this.currentPath.shape.points.length <= 2 && this.graphicsData.pop(),
        this.currentPath = null,
        t instanceof H.Polygon && (t = t.clone()).flatten();
        var e = new PIXI.GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,t);
        return this.graphicsData.push(e),
        e.type === PIXI.Graphics.POLY && (e.shape.closed = this.filling,
        this.currentPath = e),
        this.dirty = !0,
        this._boundsDirty = !0,
        e
    }
    ,
    Object.defineProperty(PIXI.Graphics.prototype, "cacheAsBitmap", {
        get: function() {
            return this._cacheAsBitmap
        },
        set: function(t) {
            this._cacheAsBitmap = t,
            this._cacheAsBitmap ? this._generateCachedSprite() : this.destroyCachedSprite(),
            this.dirty = !0,
            this.webGLDirty = !0
        }
    }),
    PIXI.GraphicsData = function(t, e, i, s, n, r, o) {
        this.lineWidth = t,
        this.lineColor = e,
        this.lineAlpha = i,
        this._lineTint = e,
        this.fillColor = s,
        this.fillAlpha = n,
        this._fillTint = s,
        this.fill = r,
        this.shape = o,
        this.type = o.type
    }
    ,
    PIXI.GraphicsData.prototype.constructor = PIXI.GraphicsData,
    PIXI.GraphicsData.prototype.clone = function() {
        return new GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)
    }
    ,
    PIXI.EarCut = {},
    PIXI.EarCut.Triangulate = function(t, e, i) {
        i = i || 2;
        var s, n, r, o, a, h, l, c = e && e.length, d = c ? e[0] * i : t.length, u = PIXI.EarCut.linkedList(t, 0, d, i, !0), p = [];
        if (!u)
            return p;
        if (c && (u = PIXI.EarCut.eliminateHoles(t, e, u, i)),
        t.length > 80 * i) {
            s = r = t[0],
            n = o = t[1];
            for (var g = i; g < d; g += i)
                (a = t[g]) < s && (s = a),
                (h = t[g + 1]) < n && (n = h),
                r < a && (r = a),
                o < h && (o = h);
            l = Math.max(r - s, o - n)
        }
        return PIXI.EarCut.earcutLinked(u, p, i, s, n, l),
        p
    }
    ,
    PIXI.EarCut.linkedList = function(t, e, i, s, n) {
        var r, o, a, h = 0;
        for (r = e,
        o = i - s; r < i; r += s)
            h += (t[o] - t[r]) * (t[r + 1] + t[o + 1]),
            o = r;
        if (n === 0 < h)
            for (r = e; r < i; r += s)
                a = PIXI.EarCut.insertNode(r, t[r], t[r + 1], a);
        else
            for (r = i - s; e <= r; r -= s)
                a = PIXI.EarCut.insertNode(r, t[r], t[r + 1], a);
        return a
    }
    ,
    PIXI.EarCut.filterPoints = function(t, e) {
        if (!t)
            return t;
        e || (e = t);
        var i, s = t;
        do {
            if (i = !1,
            s.steiner || !PIXI.EarCut.equals(s, s.next) && 0 !== PIXI.EarCut.area(s.prev, s, s.next))
                s = s.next;
            else {
                if (PIXI.EarCut.removeNode(s),
                (s = e = s.prev) === s.next)
                    return null;
                i = !0
            }
        } while (i || s !== e);
        return e
    }
    ,
    PIXI.EarCut.earcutLinked = function(t, e, i, s, n, r, o) {
        if (t) {
            !o && r && PIXI.EarCut.indexCurve(t, s, n, r);
            for (var a, h, l = t; t.prev !== t.next; )
                if (a = t.prev,
                h = t.next,
                r ? PIXI.EarCut.isEarHashed(t, s, n, r) : PIXI.EarCut.isEar(t))
                    e.push(a.i / i),
                    e.push(t.i / i),
                    e.push(h.i / i),
                    PIXI.EarCut.removeNode(t),
                    t = h.next,
                    l = h.next;
                else if ((t = h) === l) {
                    o ? 1 === o ? (t = PIXI.EarCut.cureLocalIntersections(t, e, i),
                    PIXI.EarCut.earcutLinked(t, e, i, s, n, r, 2)) : 2 === o && PIXI.EarCut.splitEarcut(t, e, i, s, n, r) : PIXI.EarCut.earcutLinked(PIXI.EarCut.filterPoints(t), e, i, s, n, r, 1);
                    break
                }
        }
    }
    ,
    PIXI.EarCut.isEar = function(t) {
        var e = t.prev
          , i = t
          , s = t.next;
        if (0 <= PIXI.EarCut.area(e, i, s))
            return !1;
        for (var n = t.next.next; n !== t.prev; ) {
            if (PIXI.EarCut.pointInTriangle(e.x, e.y, i.x, i.y, s.x, s.y, n.x, n.y) && 0 <= PIXI.EarCut.area(n.prev, n, n.next))
                return !1;
            n = n.next
        }
        return !0
    }
    ,
    PIXI.EarCut.isEarHashed = function(t, e, i, s) {
        var n = t.prev
          , r = t
          , o = t.next;
        if (0 <= PIXI.EarCut.area(n, r, o))
            return !1;
        for (var a = n.x < r.x ? n.x < o.x ? n.x : o.x : r.x < o.x ? r.x : o.x, h = n.y < r.y ? n.y < o.y ? n.y : o.y : r.y < o.y ? r.y : o.y, l = n.x > r.x ? n.x > o.x ? n.x : o.x : r.x > o.x ? r.x : o.x, c = n.y > r.y ? n.y > o.y ? n.y : o.y : r.y > o.y ? r.y : o.y, d = PIXI.EarCut.zOrder(a, h, e, i, s), u = PIXI.EarCut.zOrder(l, c, e, i, s), p = t.nextZ; p && p.z <= u; ) {
            if (p !== t.prev && p !== t.next && PIXI.EarCut.pointInTriangle(n.x, n.y, r.x, r.y, o.x, o.y, p.x, p.y) && 0 <= PIXI.EarCut.area(p.prev, p, p.next))
                return !1;
            p = p.nextZ
        }
        for (p = t.prevZ; p && p.z >= d; ) {
            if (p !== t.prev && p !== t.next && PIXI.EarCut.pointInTriangle(n.x, n.y, r.x, r.y, o.x, o.y, p.x, p.y) && 0 <= PIXI.EarCut.area(p.prev, p, p.next))
                return !1;
            p = p.prevZ
        }
        return !0
    }
    ,
    PIXI.EarCut.cureLocalIntersections = function(t, e, i) {
        var s = t;
        do {
            var n = s.prev
              , r = s.next.next;
            PIXI.EarCut.intersects(n, s, s.next, r) && PIXI.EarCut.locallyInside(n, r) && PIXI.EarCut.locallyInside(r, n) && (e.push(n.i / i),
            e.push(s.i / i),
            e.push(r.i / i),
            PIXI.EarCut.removeNode(s),
            PIXI.EarCut.removeNode(s.next),
            s = t = r),
            s = s.next
        } while (s !== t);
        return s
    }
    ,
    PIXI.EarCut.splitEarcut = function(t, e, i, s, n, r) {
        var o = t;
        do {
            for (var a = o.next.next; a !== o.prev; ) {
                if (o.i !== a.i && PIXI.EarCut.isValidDiagonal(o, a)) {
                    var h = PIXI.EarCut.splitPolygon(o, a);
                    return o = PIXI.EarCut.filterPoints(o, o.next),
                    h = PIXI.EarCut.filterPoints(h, h.next),
                    PIXI.EarCut.earcutLinked(o, e, i, s, n, r),
                    void PIXI.EarCut.earcutLinked(h, e, i, s, n, r)
                }
                a = a.next
            }
            o = o.next
        } while (o !== t)
    }
    ,
    PIXI.EarCut.eliminateHoles = function(t, e, i, s) {
        var n, r, o, a, h, l = [];
        for (n = 0,
        r = e.length; n < r; n++)
            o = e[n] * s,
            a = n < r - 1 ? e[n + 1] * s : t.length,
            (h = PIXI.EarCut.linkedList(t, o, a, s, !1)) === h.next && (h.steiner = !0),
            l.push(PIXI.EarCut.getLeftmost(h));
        for (l.sort(compareX),
        n = 0; n < l.length; n++)
            PIXI.EarCut.eliminateHole(l[n], i),
            i = PIXI.EarCut.filterPoints(i, i.next);
        return i
    }
    ,
    PIXI.EarCut.compareX = function(t, e) {
        return t.x - e.x
    }
    ,
    PIXI.EarCut.eliminateHole = function(t, e) {
        if (e = PIXI.EarCut.findHoleBridge(t, e)) {
            var i = PIXI.EarCut.splitPolygon(e, t);
            PIXI.EarCut.filterPoints(i, i.next)
        }
    }
    ,
    PIXI.EarCut.findHoleBridge = function(t, e) {
        var i, s = e, n = t.x, r = t.y, o = -1 / 0;
        do {
            if (r <= s.y && r >= s.next.y) {
                var a = s.x + (r - s.y) * (s.next.x - s.x) / (s.next.y - s.y);
                a <= n && o < a && (o = a,
                i = s.x < s.next.x ? s : s.next)
            }
            s = s.next
        } while (s !== e);
        if (!i)
            return null;
        if (t.x === i.x)
            return i.prev;
        var h, l = i, c = 1 / 0;
        for (s = i.next; s !== l; )
            n >= s.x && s.x >= i.x && PIXI.EarCut.pointInTriangle(r < i.y ? n : o, r, i.x, i.y, r < i.y ? o : n, r, s.x, s.y) && ((h = Math.abs(r - s.y) / (n - s.x)) < c || h === c && s.x > i.x) && PIXI.EarCut.locallyInside(s, t) && (i = s,
            c = h),
            s = s.next;
        return i
    }
    ,
    PIXI.EarCut.indexCurve = function(t, e, i, s) {
        for (var n = t; null === n.z && (n.z = PIXI.EarCut.zOrder(n.x, n.y, e, i, s)),
        n.prevZ = n.prev,
        n.nextZ = n.next,
        (n = n.next) !== t; )
            ;
        n.prevZ.nextZ = null,
        n.prevZ = null,
        PIXI.EarCut.sortLinked(n)
    }
    ,
    PIXI.EarCut.sortLinked = function(t) {
        var e, i, s, n, r, o, a, h, l = 1;
        do {
            for (i = t,
            r = t = null,
            o = 0; i; ) {
                for (o++,
                s = i,
                e = a = 0; e < l && (a++,
                s = s.nextZ); e++)
                    ;
                for (h = l; 0 < a || 0 < h && s; )
                    0 === a ? (s = (n = s).nextZ,
                    h--) : 0 !== h && s ? i.z <= s.z ? (i = (n = i).nextZ,
                    a--) : (s = (n = s).nextZ,
                    h--) : (i = (n = i).nextZ,
                    a--),
                    r ? r.nextZ = n : t = n,
                    n.prevZ = r,
                    r = n;
                i = s
            }
            r.nextZ = null,
            l *= 2
        } while (1 < o);
        return t
    }
    ,
    PIXI.EarCut.zOrder = function(t, e, i, s, n) {
        return (t = 1431655765 & ((t = 858993459 & ((t = 252645135 & ((t = 16711935 & ((t = 32767 * (t - i) / n) | t << 8)) | t << 4)) | t << 2)) | t << 1)) | (e = 1431655765 & ((e = 858993459 & ((e = 252645135 & ((e = 16711935 & ((e = 32767 * (e - s) / n) | e << 8)) | e << 4)) | e << 2)) | e << 1)) << 1
    }
    ,
    PIXI.EarCut.getLeftmost = function(t) {
        for (var e = t, i = t; e.x < i.x && (i = e),
        (e = e.next) !== t; )
            ;
        return i
    }
    ,
    PIXI.EarCut.pointInTriangle = function(t, e, i, s, n, r, o, a) {
        return 0 <= (n - o) * (e - a) - (t - o) * (r - a) && 0 <= (t - o) * (s - a) - (i - o) * (e - a) && 0 <= (i - o) * (r - a) - (n - o) * (s - a)
    }
    ,
    PIXI.EarCut.isValidDiagonal = function(t, e) {
        return PIXI.EarCut.equals(t, e) || t.next.i !== e.i && t.prev.i !== e.i && !PIXI.EarCut.intersectsPolygon(t, e) && PIXI.EarCut.locallyInside(t, e) && PIXI.EarCut.locallyInside(e, t) && PIXI.EarCut.middleInside(t, e)
    }
    ,
    PIXI.EarCut.area = function(t, e, i) {
        return (e.y - t.y) * (i.x - e.x) - (e.x - t.x) * (i.y - e.y)
    }
    ,
    PIXI.EarCut.equals = function(t, e) {
        return t.x === e.x && t.y === e.y
    }
    ,
    PIXI.EarCut.intersects = function(t, e, i, s) {
        return 0 < PIXI.EarCut.area(t, e, i) != 0 < PIXI.EarCut.area(t, e, s) && 0 < PIXI.EarCut.area(i, s, t) != 0 < PIXI.EarCut.area(i, s, e)
    }
    ,
    PIXI.EarCut.intersectsPolygon = function(t, e) {
        var i = t;
        do {
            if (i.i !== t.i && i.next.i !== t.i && i.i !== e.i && i.next.i !== e.i && PIXI.EarCut.intersects(i, i.next, t, e))
                return !0;
            i = i.next
        } while (i !== t);
        return !1
    }
    ,
    PIXI.EarCut.locallyInside = function(t, e) {
        return PIXI.EarCut.area(t.prev, t, t.next) < 0 ? 0 <= PIXI.EarCut.area(t, e, t.next) && 0 <= PIXI.EarCut.area(t, t.prev, e) : PIXI.EarCut.area(t, e, t.prev) < 0 || PIXI.EarCut.area(t, t.next, e) < 0
    }
    ,
    PIXI.EarCut.middleInside = function(t, e) {
        for (var i = t, s = !1, n = (t.x + e.x) / 2, r = (t.y + e.y) / 2; i.y > r != i.next.y > r && n < (i.next.x - i.x) * (r - i.y) / (i.next.y - i.y) + i.x && (s = !s),
        (i = i.next) !== t; )
            ;
        return s
    }
    ,
    PIXI.EarCut.splitPolygon = function(t, e) {
        var i = new PIXI.EarCut.Node(t.i,t.x,t.y)
          , s = new PIXI.EarCut.Node(e.i,e.x,e.y)
          , n = t.next
          , r = e.prev;
        return (t.next = e).prev = t,
        (i.next = n).prev = i,
        (s.next = i).prev = s,
        (r.next = s).prev = r,
        s
    }
    ,
    PIXI.EarCut.insertNode = function(t, e, i, s) {
        var n = new PIXI.EarCut.Node(t,e,i);
        return s ? (n.next = s.next,
        (n.prev = s).next.prev = n,
        s.next = n) : (n.prev = n).next = n,
        n
    }
    ,
    PIXI.EarCut.removeNode = function(t) {
        t.next.prev = t.prev,
        t.prev.next = t.next,
        t.prevZ && (t.prevZ.nextZ = t.nextZ),
        t.nextZ && (t.nextZ.prevZ = t.prevZ)
    }
    ,
    PIXI.EarCut.Node = function(t, e, i) {
        this.i = t,
        this.x = e,
        this.y = i,
        this.prev = null,
        this.next = null,
        this.z = null,
        this.prevZ = null,
        this.nextZ = null,
        this.steiner = !1
    }
    ,
    PIXI.WebGLGraphics = function() {}
    ,
    PIXI.WebGLGraphics.stencilBufferLimit = 6,
    PIXI.WebGLGraphics.renderGraphics = function(t, e) {
        var i, s = e.gl, n = e.projection, r = e.offset, o = e.shaderManager.primitiveShader;
        t.dirty && PIXI.WebGLGraphics.updateGraphics(t, s);
        for (var a = t._webGL[s.id], h = 0; h < a.data.length; h++)
            1 === a.data[h].mode ? (i = a.data[h],
            e.stencilManager.pushStencil(t, i, e),
            s.drawElements(s.TRIANGLE_FAN, 4, s.UNSIGNED_SHORT, 2 * (i.indices.length - 4)),
            e.stencilManager.popStencil(t, i, e)) : (i = a.data[h],
            e.shaderManager.setShader(o),
            o = e.shaderManager.primitiveShader,
            s.uniformMatrix3fv(o.translationMatrix, !1, t.worldTransform.toArray(!0)),
            s.uniform1f(o.flipY, 1),
            s.uniform2f(o.projectionVector, n.x, -n.y),
            s.uniform2f(o.offsetVector, -r.x, -r.y),
            s.uniform3fv(o.tintColor, PIXI.hex2rgb(t.tint)),
            s.uniform1f(o.alpha, t.worldAlpha),
            s.bindBuffer(s.ARRAY_BUFFER, i.buffer),
            s.vertexAttribPointer(o.aVertexPosition, 2, s.FLOAT, !1, 24, 0),
            s.vertexAttribPointer(o.colorAttribute, 4, s.FLOAT, !1, 24, 8),
            s.bindBuffer(s.ELEMENT_ARRAY_BUFFER, i.indexBuffer),
            s.drawElements(s.TRIANGLE_STRIP, i.indices.length, s.UNSIGNED_SHORT, 0))
    }
    ,
    PIXI.WebGLGraphics.updateGraphics = function(t, e) {
        var i, s, n = t._webGL[e.id];
        if (n || (n = t._webGL[e.id] = {
            lastIndex: 0,
            data: [],
            gl: e
        }),
        t.dirty = !1,
        t.clearDirty) {
            for (t.clearDirty = !1,
            i = 0; i < n.data.length; i++) {
                var r = n.data[i];
                r.reset(),
                PIXI.WebGLGraphics.graphicsDataPool.push(r)
            }
            n.data = [],
            n.lastIndex = 0
        }
        for (i = n.lastIndex; i < t.graphicsData.length; i++) {
            var o = t.graphicsData[i];
            if (o.type === PIXI.Graphics.POLY) {
                if (o.points = o.shape.points.slice(),
                o.shape.closed && (o.points[0] === o.points[o.points.length - 2] && o.points[1] === o.points[o.points.length - 1] || o.points.push(o.points[0], o.points[1])),
                o.fill && o.points.length >= PIXI.WebGLGraphics.stencilBufferLimit)
                    if (o.points.length < 2 * PIXI.WebGLGraphics.stencilBufferLimit) {
                        s = PIXI.WebGLGraphics.switchMode(n, 0),
                        PIXI.WebGLGraphics.buildPoly(o, s) || (s = PIXI.WebGLGraphics.switchMode(n, 1),
                        PIXI.WebGLGraphics.buildComplexPoly(o, s))
                    } else
                        s = PIXI.WebGLGraphics.switchMode(n, 1),
                        PIXI.WebGLGraphics.buildComplexPoly(o, s);
                0 < o.lineWidth && (s = PIXI.WebGLGraphics.switchMode(n, 0),
                PIXI.WebGLGraphics.buildLine(o, s))
            } else
                s = PIXI.WebGLGraphics.switchMode(n, 0),
                o.type === PIXI.Graphics.RECT ? PIXI.WebGLGraphics.buildRectangle(o, s) : o.type === PIXI.Graphics.CIRC || o.type === PIXI.Graphics.ELIP ? PIXI.WebGLGraphics.buildCircle(o, s) : o.type === PIXI.Graphics.RREC && PIXI.WebGLGraphics.buildRoundedRectangle(o, s);
            n.lastIndex++
        }
        for (i = 0; i < n.data.length; i++)
            (s = n.data[i]).dirty && s.upload()
    }
    ,
    PIXI.WebGLGraphics.switchMode = function(t, e) {
        var i;
        return t.data.length ? (i = t.data[t.data.length - 1]).mode === e && 1 !== e || ((i = PIXI.WebGLGraphics.graphicsDataPool.pop() || new PIXI.WebGLGraphicsData(t.gl)).mode = e,
        t.data.push(i)) : ((i = PIXI.WebGLGraphics.graphicsDataPool.pop() || new PIXI.WebGLGraphicsData(t.gl)).mode = e,
        t.data.push(i)),
        i.dirty = !0,
        i
    }
    ,
    PIXI.WebGLGraphics.buildRectangle = function(t, e) {
        var i = t.shape
          , s = i.x
          , n = i.y
          , r = i.width
          , o = i.height;
        if (t.fill) {
            var a = PIXI.hex2rgb(t.fillColor)
              , h = t.fillAlpha
              , l = a[0] * h
              , c = a[1] * h
              , d = a[2] * h
              , u = e.points
              , p = e.indices
              , g = u.length / 6;
            u.push(s, n),
            u.push(l, c, d, h),
            u.push(s + r, n),
            u.push(l, c, d, h),
            u.push(s, n + o),
            u.push(l, c, d, h),
            u.push(s + r, n + o),
            u.push(l, c, d, h),
            p.push(g, g, g + 1, g + 2, g + 3, g + 3)
        }
        if (t.lineWidth) {
            var f = t.points;
            t.points = [s, n, s + r, n, s + r, n + o, s, n + o, s, n],
            PIXI.WebGLGraphics.buildLine(t, e),
            t.points = f
        }
    }
    ,
    PIXI.WebGLGraphics.buildRoundedRectangle = function(t, e) {
        var i = t.shape
          , s = i.x
          , n = i.y
          , r = i.width
          , o = i.height
          , a = i.radius
          , h = [];
        if (h.push(s, n + a),
        h = (h = (h = (h = h.concat(PIXI.WebGLGraphics.quadraticBezierCurve(s, n + o - a, s, n + o, s + a, n + o))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(s + r - a, n + o, s + r, n + o, s + r, n + o - a))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(s + r, n + a, s + r, n, s + r - a, n))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(s + a, n, s, n, s, n + a)),
        t.fill) {
            var l = PIXI.hex2rgb(t.fillColor)
              , c = t.fillAlpha
              , d = l[0] * c
              , u = l[1] * c
              , p = l[2] * c
              , g = e.points
              , f = e.indices
              , m = g.length / 6
              , y = PIXI.EarCut.Triangulate(h, null, 2)
              , v = 0;
            for (v = 0; v < y.length; v += 3)
                f.push(y[v] + m),
                f.push(y[v] + m),
                f.push(y[v + 1] + m),
                f.push(y[v + 2] + m),
                f.push(y[v + 2] + m);
            for (v = 0; v < h.length; v++)
                g.push(h[v], h[++v], d, u, p, c)
        }
        if (t.lineWidth) {
            var _ = t.points;
            t.points = h,
            PIXI.WebGLGraphics.buildLine(t, e),
            t.points = _
        }
    }
    ,
    PIXI.WebGLGraphics.quadraticBezierCurve = function(t, e, i, s, n, r) {
        function o(t, e, i) {
            return t + (e - t) * i
        }
        for (var a, h, l, c, d, u, p = [], g = 0, f = 0; f <= 20; f++)
            a = o(t, i, g = f / 20),
            h = o(e, s, g),
            l = o(i, n, g),
            c = o(s, r, g),
            d = o(a, l, g),
            u = o(h, c, g),
            p.push(d, u);
        return p
    }
    ,
    PIXI.WebGLGraphics.buildCircle = function(t, e) {
        var i, s, n = t.shape, r = n.x, o = n.y;
        s = t.type === PIXI.Graphics.CIRC ? (i = n.radius,
        n.radius) : (i = n.width,
        n.height);
        var a = 2 * Math.PI / 40
          , h = 0;
        if (t.fill) {
            var l = PIXI.hex2rgb(t.fillColor)
              , c = t.fillAlpha
              , d = l[0] * c
              , u = l[1] * c
              , p = l[2] * c
              , g = e.points
              , f = e.indices
              , m = g.length / 6;
            for (f.push(m),
            h = 0; h < 41; h++)
                g.push(r, o, d, u, p, c),
                g.push(r + Math.sin(a * h) * i, o + Math.cos(a * h) * s, d, u, p, c),
                f.push(m++, m++);
            f.push(m - 1)
        }
        if (t.lineWidth) {
            var y = t.points;
            for (t.points = [],
            h = 0; h < 41; h++)
                t.points.push(r + Math.sin(a * h) * i, o + Math.cos(a * h) * s);
            PIXI.WebGLGraphics.buildLine(t, e),
            t.points = y
        }
    }
    ,
    PIXI.WebGLGraphics.buildLine = function(t, e) {
        var i = 0
          , s = t.points;
        if (0 !== s.length) {
            if (t.lineWidth % 2)
                for (i = 0; i < s.length; i++)
                    s[i] += .5;
            var n = new PIXI.Point(s[0],s[1])
              , r = new PIXI.Point(s[s.length - 2],s[s.length - 1]);
            if (n.x === r.x && n.y === r.y) {
                (s = s.slice()).pop(),
                s.pop();
                var o = (r = new PIXI.Point(s[s.length - 2],s[s.length - 1])).x + .5 * (n.x - r.x)
                  , a = r.y + .5 * (n.y - r.y);
                s.unshift(o, a),
                s.push(o, a)
            }
            var h, l, c, d, u, p, g, f, m, y, v, _, b, w, x, S, T, A, C, P, E, I, k = e.points, M = e.indices, R = s.length / 2, B = s.length, O = k.length / 6, L = t.lineWidth / 2, G = PIXI.hex2rgb(t.lineColor), D = t.lineAlpha, F = G[0] * D, U = G[1] * D, N = G[2] * D;
            for (c = s[0],
            d = s[1],
            u = s[2],
            m = -(d - (p = s[3])),
            y = c - u,
            m /= I = Math.sqrt(m * m + y * y),
            y /= I,
            m *= L,
            y *= L,
            k.push(c - m, d - y, F, U, N, D),
            k.push(c + m, d + y, F, U, N, D),
            i = 1; i < R - 1; i++)
                c = s[2 * (i - 1)],
                d = s[2 * (i - 1) + 1],
                u = s[2 * i],
                p = s[2 * i + 1],
                g = s[2 * (i + 1)],
                f = s[2 * (i + 1) + 1],
                m = -(d - p),
                y = c - u,
                m /= I = Math.sqrt(m * m + y * y),
                y /= I,
                m *= L,
                y *= L,
                v = -(p - f),
                _ = u - g,
                v /= I = Math.sqrt(v * v + _ * _),
                _ /= I,
                T = (-m + c) * (-y + p) - (-m + u) * (-y + d),
                P = (-(v *= L) + g) * (-(_ *= L) + p) - (-v + u) * (-_ + f),
                E = (x = -y + d - (-y + p)) * (C = -v + u - (-v + g)) - (A = -_ + f - (-_ + p)) * (S = -m + u - (-m + c)),
                Math.abs(E) < .1 ? (E += 10.1,
                k.push(u - m, p - y, F, U, N, D),
                k.push(u + m, p + y, F, U, N, D)) : 19600 < ((h = (S * P - C * T) / E) - u) * (h - u) + ((l = (A * T - x * P) / E) - p) + (l - p) ? (b = m - v,
                w = y - _,
                b /= I = Math.sqrt(b * b + w * w),
                w /= I,
                b *= L,
                w *= L,
                k.push(u - b, p - w),
                k.push(F, U, N, D),
                k.push(u + b, p + w),
                k.push(F, U, N, D),
                k.push(u - b, p - w),
                k.push(F, U, N, D),
                B++) : (k.push(h, l),
                k.push(F, U, N, D),
                k.push(u - (h - u), p - (l - p)),
                k.push(F, U, N, D));
            for (c = s[2 * (R - 2)],
            d = s[2 * (R - 2) + 1],
            u = s[2 * (R - 1)],
            m = -(d - (p = s[2 * (R - 1) + 1])),
            y = c - u,
            m /= I = Math.sqrt(m * m + y * y),
            y /= I,
            m *= L,
            y *= L,
            k.push(u - m, p - y),
            k.push(F, U, N, D),
            k.push(u + m, p + y),
            k.push(F, U, N, D),
            M.push(O),
            i = 0; i < B; i++)
                M.push(O++);
            M.push(O - 1)
        }
    }
    ,
    PIXI.WebGLGraphics.buildComplexPoly = function(t, e) {
        var i = t.points.slice();
        if (!(i.length < 6)) {
            var s = e.indices;
            e.points = i,
            e.alpha = t.fillAlpha,
            e.color = PIXI.hex2rgb(t.fillColor);
            for (var n, r, o = 1 / 0, a = -1 / 0, h = 1 / 0, l = -1 / 0, c = 0; c < i.length; c += 2)
                o = (n = i[c]) < o ? n : o,
                a = a < n ? n : a,
                h = (r = i[c + 1]) < h ? r : h,
                l = l < r ? r : l;
            i.push(o, h, a, h, a, l, o, l);
            var d = i.length / 2;
            for (c = 0; c < d; c++)
                s.push(c)
        }
    }
    ,
    PIXI.WebGLGraphics.buildPoly = function(t, e) {
        var i = t.points;
        if (!(i.length < 6)) {
            var s = e.points
              , n = e.indices
              , r = i.length / 2
              , o = PIXI.hex2rgb(t.fillColor)
              , a = t.fillAlpha
              , h = o[0] * a
              , l = o[1] * a
              , c = o[2] * a
              , d = PIXI.EarCut.Triangulate(i, null, 2);
            if (!d)
                return !1;
            var u = s.length / 6
              , p = 0;
            for (p = 0; p < d.length; p += 3)
                n.push(d[p] + u),
                n.push(d[p] + u),
                n.push(d[p + 1] + u),
                n.push(d[p + 2] + u),
                n.push(d[p + 2] + u);
            for (p = 0; p < r; p++)
                s.push(i[2 * p], i[2 * p + 1], h, l, c, a);
            return !0
        }
    }
    ,
    PIXI.WebGLGraphics.graphicsDataPool = [],
    PIXI.WebGLGraphicsData = function(t) {
        this.gl = t,
        this.color = [0, 0, 0],
        this.points = [],
        this.indices = [],
        this.buffer = t.createBuffer(),
        this.indexBuffer = t.createBuffer(),
        this.mode = 1,
        this.alpha = 1,
        this.dirty = !0
    }
    ,
    PIXI.WebGLGraphicsData.prototype.reset = function() {
        this.points = [],
        this.indices = []
    }
    ,
    PIXI.WebGLGraphicsData.prototype.upload = function() {
        var t = this.gl;
        this.glPoints = new PIXI.Float32Array(this.points),
        t.bindBuffer(t.ARRAY_BUFFER, this.buffer),
        t.bufferData(t.ARRAY_BUFFER, this.glPoints, t.STATIC_DRAW),
        this.glIndicies = new PIXI.Uint16Array(this.indices),
        t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer),
        t.bufferData(t.ELEMENT_ARRAY_BUFFER, this.glIndicies, t.STATIC_DRAW),
        this.dirty = !1
    }
    ,
    PIXI.CanvasGraphics = function() {}
    ,
    PIXI.CanvasGraphics.renderGraphics = function(t, e) {
        var i = t.worldAlpha;
        t.dirty && (this.updateGraphicsTint(t),
        t.dirty = !1);
        for (var s = 0; s < t.graphicsData.length; s++) {
            var n = t.graphicsData[s]
              , r = n.shape
              , o = n._fillTint
              , a = n._lineTint;
            if (e.lineWidth = n.lineWidth,
            n.type === PIXI.Graphics.POLY) {
                e.beginPath();
                var h = r.points;
                e.moveTo(h[0], h[1]);
                for (var l = 1; l < h.length / 2; l++)
                    e.lineTo(h[2 * l], h[2 * l + 1]);
                r.closed && e.lineTo(h[0], h[1]),
                h[0] === h[h.length - 2] && h[1] === h[h.length - 1] && e.closePath(),
                n.fill && (e.globalAlpha = n.fillAlpha * i,
                e.fillStyle = "#" + ("00000" + (0 | o).toString(16)).substr(-6),
                e.fill()),
                n.lineWidth && (e.globalAlpha = n.lineAlpha * i,
                e.strokeStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6),
                e.stroke())
            } else if (n.type === PIXI.Graphics.RECT)
                (n.fillColor || 0 === n.fillColor) && (e.globalAlpha = n.fillAlpha * i,
                e.fillStyle = "#" + ("00000" + (0 | o).toString(16)).substr(-6),
                e.fillRect(r.x, r.y, r.width, r.height)),
                n.lineWidth && (e.globalAlpha = n.lineAlpha * i,
                e.strokeStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6),
                e.strokeRect(r.x, r.y, r.width, r.height));
            else if (n.type === PIXI.Graphics.CIRC)
                e.beginPath(),
                e.arc(r.x, r.y, r.radius, 0, 2 * Math.PI),
                e.closePath(),
                n.fill && (e.globalAlpha = n.fillAlpha * i,
                e.fillStyle = "#" + ("00000" + (0 | o).toString(16)).substr(-6),
                e.fill()),
                n.lineWidth && (e.globalAlpha = n.lineAlpha * i,
                e.strokeStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6),
                e.stroke());
            else if (n.type === PIXI.Graphics.ELIP) {
                var c = 2 * r.width
                  , d = 2 * r.height
                  , u = r.x - c / 2
                  , p = r.y - d / 2;
                e.beginPath();
                var g = c / 2 * .5522848
                  , f = d / 2 * .5522848
                  , m = u + c
                  , y = p + d
                  , v = u + c / 2
                  , _ = p + d / 2;
                e.moveTo(u, _),
                e.bezierCurveTo(u, _ - f, v - g, p, v, p),
                e.bezierCurveTo(v + g, p, m, _ - f, m, _),
                e.bezierCurveTo(m, _ + f, v + g, y, v, y),
                e.bezierCurveTo(v - g, y, u, _ + f, u, _),
                e.closePath(),
                n.fill && (e.globalAlpha = n.fillAlpha * i,
                e.fillStyle = "#" + ("00000" + (0 | o).toString(16)).substr(-6),
                e.fill()),
                n.lineWidth && (e.globalAlpha = n.lineAlpha * i,
                e.strokeStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6),
                e.stroke())
            } else if (n.type === PIXI.Graphics.RREC) {
                var b = r.x
                  , w = r.y
                  , x = r.width
                  , S = r.height
                  , T = r.radius
                  , A = Math.min(x, S) / 2 | 0;
                T = A < T ? A : T,
                e.beginPath(),
                e.moveTo(b, w + T),
                e.lineTo(b, w + S - T),
                e.quadraticCurveTo(b, w + S, b + T, w + S),
                e.lineTo(b + x - T, w + S),
                e.quadraticCurveTo(b + x, w + S, b + x, w + S - T),
                e.lineTo(b + x, w + T),
                e.quadraticCurveTo(b + x, w, b + x - T, w),
                e.lineTo(b + T, w),
                e.quadraticCurveTo(b, w, b, w + T),
                e.closePath(),
                (n.fillColor || 0 === n.fillColor) && (e.globalAlpha = n.fillAlpha * i,
                e.fillStyle = "#" + ("00000" + (0 | o).toString(16)).substr(-6),
                e.fill()),
                n.lineWidth && (e.globalAlpha = n.lineAlpha * i,
                e.strokeStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6),
                e.stroke())
            }
        }
    }
    ,
    PIXI.CanvasGraphics.renderGraphicsMask = function(t, e) {
        var i = t.graphicsData.length;
        if (0 !== i) {
            e.beginPath();
            for (var s = 0; s < i; s++) {
                var n = t.graphicsData[s]
                  , r = n.shape;
                if (n.type === PIXI.Graphics.POLY) {
                    var o = r.points;
                    e.moveTo(o[0], o[1]);
                    for (var a = 1; a < o.length / 2; a++)
                        e.lineTo(o[2 * a], o[2 * a + 1]);
                    o[0] === o[o.length - 2] && o[1] === o[o.length - 1] && e.closePath()
                } else if (n.type === PIXI.Graphics.RECT)
                    e.rect(r.x, r.y, r.width, r.height),
                    e.closePath();
                else if (n.type === PIXI.Graphics.CIRC)
                    e.arc(r.x, r.y, r.radius, 0, 2 * Math.PI),
                    e.closePath();
                else if (n.type === PIXI.Graphics.ELIP) {
                    var h = 2 * r.width
                      , l = 2 * r.height
                      , c = r.x - h / 2
                      , d = r.y - l / 2
                      , u = h / 2 * .5522848
                      , p = l / 2 * .5522848
                      , g = c + h
                      , f = d + l
                      , m = c + h / 2
                      , y = d + l / 2;
                    e.moveTo(c, y),
                    e.bezierCurveTo(c, y - p, m - u, d, m, d),
                    e.bezierCurveTo(m + u, d, g, y - p, g, y),
                    e.bezierCurveTo(g, y + p, m + u, f, m, f),
                    e.bezierCurveTo(m - u, f, c, y + p, c, y),
                    e.closePath()
                } else if (n.type === PIXI.Graphics.RREC) {
                    var v = r.x
                      , _ = r.y
                      , b = r.width
                      , w = r.height
                      , x = r.radius
                      , S = Math.min(b, w) / 2 | 0;
                    x = S < x ? S : x,
                    e.moveTo(v, _ + x),
                    e.lineTo(v, _ + w - x),
                    e.quadraticCurveTo(v, _ + w, v + x, _ + w),
                    e.lineTo(v + b - x, _ + w),
                    e.quadraticCurveTo(v + b, _ + w, v + b, _ + w - x),
                    e.lineTo(v + b, _ + x),
                    e.quadraticCurveTo(v + b, _, v + b - x, _),
                    e.lineTo(v + x, _),
                    e.quadraticCurveTo(v, _, v, _ + x),
                    e.closePath()
                }
            }
        }
    }
    ,
    PIXI.CanvasGraphics.updateGraphicsTint = function(t) {
        if (16777215 !== t.tint)
            for (var e = (t.tint >> 16 & 255) / 255, i = (t.tint >> 8 & 255) / 255, s = (255 & t.tint) / 255, n = 0; n < t.graphicsData.length; n++) {
                var r = t.graphicsData[n]
                  , o = 0 | r.fillColor
                  , a = 0 | r.lineColor;
                r._fillTint = ((o >> 16 & 255) / 255 * e * 255 << 16) + ((o >> 8 & 255) / 255 * i * 255 << 8) + (255 & o) / 255 * s * 255,
                r._lineTint = ((a >> 16 & 255) / 255 * e * 255 << 16) + ((a >> 8 & 255) / 255 * i * 255 << 8) + (255 & a) / 255 * s * 255
            }
    }
    ,
    H.Graphics = function(t, e, i) {
        void 0 === e && (e = 0),
        void 0 === i && (i = 0),
        this.type = H.GRAPHICS,
        this.physicsType = H.SPRITE,
        this.anchor = new H.Point,
        PIXI.Graphics.call(this),
        H.Component.Core.init.call(this, t, e, i, "", null)
    }
    ,
    H.Graphics.prototype = Object.create(PIXI.Graphics.prototype),
    H.Graphics.prototype.constructor = H.Graphics,
    H.Component.Core.install.call(H.Graphics.prototype, ["Angle", "AutoCull", "Bounds", "Destroy", "FixedToCamera", "InputEnabled", "InWorld", "LifeSpan", "PhysicsBody", "Reset"]),
    H.Graphics.prototype.preUpdatePhysics = H.Component.PhysicsBody.preUpdate,
    H.Graphics.prototype.preUpdateLifeSpan = H.Component.LifeSpan.preUpdate,
    H.Graphics.prototype.preUpdateInWorld = H.Component.InWorld.preUpdate,
    H.Graphics.prototype.preUpdateCore = H.Component.Core.preUpdate,
    H.Graphics.prototype.preUpdate = function() {
        return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore()
    }
    ,
    H.Graphics.prototype.postUpdate = function() {
        H.Component.PhysicsBody.postUpdate.call(this),
        H.Component.FixedToCamera.postUpdate.call(this),
        this._boundsDirty && (this.updateLocalBounds(),
        this._boundsDirty = !1);
        for (var t = 0; t < this.children.length; t++)
            this.children[t].postUpdate()
    }
    ,
    H.Graphics.prototype.destroy = function(t) {
        this.clear(),
        H.Component.Destroy.prototype.destroy.call(this, t)
    }
    ,
    H.Graphics.prototype.drawTriangle = function(t, e) {
        void 0 === e && (e = !1);
        var i = new H.Polygon(t);
        if (e) {
            var s = new H.Point(this.game.camera.x - t[0].x,this.game.camera.y - t[0].y)
              , n = new H.Point(t[1].x - t[0].x,t[1].y - t[0].y)
              , r = new H.Point(t[1].x - t[2].x,t[1].y - t[2].y).cross(n);
            0 < s.dot(r) && this.drawPolygon(i)
        } else
            this.drawPolygon(i)
    }
    ,
    H.Graphics.prototype.drawTriangles = function(t, e, i) {
        void 0 === i && (i = !1);
        var s, n = new H.Point, r = new H.Point, o = new H.Point, a = [];
        if (e)
            if (t[0]instanceof H.Point)
                for (s = 0; s < e.length / 3; s++)
                    a.push(t[e[3 * s]]),
                    a.push(t[e[3 * s + 1]]),
                    a.push(t[e[3 * s + 2]]),
                    3 === a.length && (this.drawTriangle(a, i),
                    a = []);
            else
                for (s = 0; s < e.length; s++)
                    n.x = t[2 * e[s]],
                    n.y = t[2 * e[s] + 1],
                    a.push(n.copyTo({})),
                    3 === a.length && (this.drawTriangle(a, i),
                    a = []);
        else if (t[0]instanceof H.Point)
            for (s = 0; s < t.length / 3; s++)
                this.drawTriangle([t[3 * s], t[3 * s + 1], t[3 * s + 2]], i);
        else
            for (s = 0; s < t.length / 6; s++)
                n.x = t[6 * s + 0],
                n.y = t[6 * s + 1],
                r.x = t[6 * s + 2],
                r.y = t[6 * s + 3],
                o.x = t[6 * s + 4],
                o.y = t[6 * s + 5],
                this.drawTriangle([n, r, o], i)
    }
    ,
    H.RenderTexture = function(t, e, i, s, n, r) {
        void 0 === s && (s = ""),
        void 0 === n && (n = H.scaleModes.DEFAULT),
        void 0 === r && (r = 1),
        this.game = t,
        this.key = s,
        this.type = H.RENDERTEXTURE,
        this._tempMatrix = new PIXI.Matrix,
        PIXI.RenderTexture.call(this, e, i, this.game.renderer, n, r),
        this.render = H.RenderTexture.prototype.render
    }
    ,
    H.RenderTexture.prototype = Object.create(PIXI.RenderTexture.prototype),
    H.RenderTexture.prototype.constructor = H.RenderTexture,
    H.RenderTexture.prototype.renderXY = function(t, e, i, s) {
        t.updateTransform(),
        this._tempMatrix.copyFrom(t.worldTransform),
        this._tempMatrix.tx = e,
        this._tempMatrix.ty = i,
        this.renderer.type === PIXI.WEBGL_RENDERER ? this.renderWebGL(t, this._tempMatrix, s) : this.renderCanvas(t, this._tempMatrix, s)
    }
    ,
    H.RenderTexture.prototype.renderRawXY = function(t, e, i, s) {
        this._tempMatrix.identity().translate(e, i),
        this.renderer.type === PIXI.WEBGL_RENDERER ? this.renderWebGL(t, this._tempMatrix, s) : this.renderCanvas(t, this._tempMatrix, s)
    }
    ,
    H.RenderTexture.prototype.render = function(t, e, i) {
        null == e ? this._tempMatrix.copyFrom(t.worldTransform) : this._tempMatrix.copyFrom(e),
        this.renderer.type === PIXI.WEBGL_RENDERER ? this.renderWebGL(t, this._tempMatrix, i) : this.renderCanvas(t, this._tempMatrix, i)
    }
    ,
    H.Text = function(t, e, i, s, n) {
        e = e || 0,
        i = i || 0,
        s = null == s ? "" : s.toString(),
        n = H.Utils.extend({}, n),
        this.type = H.TEXT,
        this.physicsType = H.SPRITE,
        this.padding = new H.Point,
        this.textBounds = null,
        this.canvas = PIXI.CanvasPool.create(this),
        this.context = this.canvas.getContext("2d"),
        this.colors = [],
        this.strokeColors = [],
        this.fontStyles = [],
        this.fontWeights = [],
        this.autoRound = !1,
        this.useAdvancedWrap = !1,
        this._res = t.renderer.resolution,
        this._text = s,
        this._fontComponents = null,
        this._lineSpacing = 0,
        this._charCount = 0,
        this._width = 0,
        this._height = 0,
        H.Sprite.call(this, t, e, i, PIXI.Texture.fromCanvas(this.canvas)),
        this.setStyle(n),
        "" !== s && this.updateText()
    }
    ,
    H.Text.prototype = Object.create(H.Sprite.prototype),
    H.Text.prototype.constructor = H.Text,
    H.Text.prototype.preUpdate = function() {
        return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore()
    }
    ,
    H.Text.prototype.update = function() {}
    ,
    H.Text.prototype.destroy = function(t) {
        this.texture.destroy(!0),
        H.Component.Destroy.prototype.destroy.call(this, t)
    }
    ,
    H.Text.prototype.setShadow = function(t, e, i, s, n, r) {
        return void 0 === t && (t = 0),
        void 0 === e && (e = 0),
        void 0 === i && (i = "rgba(0, 0, 0, 1)"),
        void 0 === s && (s = 0),
        void 0 === n && (n = !0),
        void 0 === r && (r = !0),
        this.style.shadowOffsetX = t,
        this.style.shadowOffsetY = e,
        this.style.shadowColor = i,
        this.style.shadowBlur = s,
        this.style.shadowStroke = n,
        this.style.shadowFill = r,
        this.dirty = !0,
        this
    }
    ,
    H.Text.prototype.setStyle = function(t, e) {
        void 0 === e && (e = !1),
        (t = t || {}).font = t.font || "bold 20pt Arial",
        t.backgroundColor = t.backgroundColor || null,
        t.fill = t.fill || "black",
        t.align = t.align || "left",
        t.boundsAlignH = t.boundsAlignH || "left",
        t.boundsAlignV = t.boundsAlignV || "top",
        t.stroke = t.stroke || "black",
        t.strokeThickness = t.strokeThickness || 0,
        t.wordWrap = t.wordWrap || !1,
        t.wordWrapWidth = t.wordWrapWidth || 100,
        t.maxLines = t.maxLines || 0,
        t.shadowOffsetX = t.shadowOffsetX || 0,
        t.shadowOffsetY = t.shadowOffsetY || 0,
        t.shadowColor = t.shadowColor || "rgba(0,0,0,0)",
        t.shadowBlur = t.shadowBlur || 0,
        t.tabs = t.tabs || 0;
        var i = this.fontToComponents(t.font);
        return t.fontStyle && (i.fontStyle = t.fontStyle),
        t.fontVariant && (i.fontVariant = t.fontVariant),
        t.fontWeight && (i.fontWeight = t.fontWeight),
        t.fontSize && ("number" == typeof t.fontSize && (t.fontSize = t.fontSize + "px"),
        i.fontSize = t.fontSize),
        this._fontComponents = i,
        t.font = this.componentsToFont(this._fontComponents),
        this.style = t,
        this.dirty = !0,
        e && this.updateText(),
        this
    }
    ,
    H.Text.prototype.updateText = function() {
        this.texture.baseTexture.resolution = this._res,
        this.context.font = this.style.font;
        var t = this.text;
        this.style.wordWrap && (t = this.runWordWrap(this.text));
        var e = t.split(/(?:\r\n|\r|\n)/)
          , i = this.style.tabs
          , s = []
          , n = 0
          , r = this.determineFontProperties(this.style.font)
          , o = e.length;
        0 < this.style.maxLines && this.style.maxLines < e.length && (o = this.style.maxLines);
        for (var a = this._charCount = 0; a < o; a++) {
            if (0 === i) {
                var h = this.style.strokeThickness + this.padding.x;
                0 < this.colors.length || 0 < this.strokeColors.length || 0 < this.fontWeights.length || 0 < this.fontStyles.length ? h += this.measureLine(e[a]) : h += this.context.measureText(e[a]).width,
                this.style.wordWrap && (h -= this.context.measureText(" ").width)
            } else {
                var l = e[a].split(/(?:\t)/);
                h = this.padding.x + this.style.strokeThickness;
                if (Array.isArray(i))
                    for (var c = 0, d = 0; d < l.length; d++) {
                        var u;
                        u = 0 < this.colors.length || 0 < this.strokeColors.length || 0 < this.fontWeights.length || 0 < this.fontStyles.length ? this.measureLine(l[d]) : Math.ceil(this.context.measureText(l[d]).width),
                        0 < d && (c += i[d - 1]),
                        h = c + u
                    }
                else
                    for (d = 0; d < l.length; d++) {
                        0 < this.colors.length || 0 < this.strokeColors.length || 0 < this.fontWeights.length || 0 < this.fontStyles.length ? h += this.measureLine(l[d]) : h += Math.ceil(this.context.measureText(l[d]).width),
                        h += this.game.math.snapToCeil(h, i) - h
                    }
            }
            s[a] = Math.ceil(h),
            n = Math.max(n, s[a])
        }
        this.canvas.width = n * this._res;
        var p, g, f = r.fontSize + this.style.strokeThickness + this.padding.y, m = f * o, y = this._lineSpacing;
        for (y < 0 && Math.abs(y) > f && (y = -f),
        0 !== y && (m += 0 < y ? y * e.length : y * (e.length - 1)),
        this.canvas.height = m * this._res,
        this.context.scale(this._res, this._res),
        navigator.isCocoonJS && this.context.clearRect(0, 0, this.canvas.width, this.canvas.height),
        this.style.backgroundColor && (this.context.fillStyle = this.style.backgroundColor,
        this.context.fillRect(0, 0, this.canvas.width, this.canvas.height)),
        this.context.fillStyle = this.style.fill,
        this.context.font = this.style.font,
        this.context.strokeStyle = this.style.stroke,
        this.context.textBaseline = "alphabetic",
        this.context.lineWidth = this.style.strokeThickness,
        this.context.lineCap = "round",
        this.context.lineJoin = "round",
        a = this._charCount = 0; a < o; a++)
            p = this.style.strokeThickness / 2,
            g = this.style.strokeThickness / 2 + a * f + r.ascent,
            0 < a && (g += y * a),
            "right" === this.style.align ? p += n - s[a] : "center" === this.style.align && (p += (n - s[a]) / 2),
            this.autoRound && (p = Math.round(p),
            g = Math.round(g)),
            0 < this.colors.length || 0 < this.strokeColors.length || 0 < this.fontWeights.length || 0 < this.fontStyles.length ? this.updateLine(e[a], p, g) : (this.style.stroke && this.style.strokeThickness && (this.updateShadow(this.style.shadowStroke),
            0 === i ? this.context.strokeText(e[a], p, g) : this.renderTabLine(e[a], p, g, !1)),
            this.style.fill && (this.updateShadow(this.style.shadowFill),
            0 === i ? this.context.fillText(e[a], p, g) : this.renderTabLine(e[a], p, g, !0)));
        this.updateTexture(),
        this.dirty = !1
    }
    ,
    H.Text.prototype.renderTabLine = function(t, e, i, s) {
        var n = t.split(/(?:\t)/)
          , r = this.style.tabs
          , o = 0;
        if (Array.isArray(r))
            for (var a = 0, h = 0; h < n.length; h++)
                0 < h && (a += r[h - 1]),
                o = e + a,
                s ? this.context.fillText(n[h], o, i) : this.context.strokeText(n[h], o, i);
        else
            for (h = 0; h < n.length; h++) {
                var l = Math.ceil(this.context.measureText(n[h]).width);
                o = this.game.math.snapToCeil(e, r),
                s ? this.context.fillText(n[h], o, i) : this.context.strokeText(n[h], o, i),
                e = o + l
            }
    }
    ,
    H.Text.prototype.updateShadow = function(t) {
        t ? (this.context.shadowOffsetX = this.style.shadowOffsetX,
        this.context.shadowOffsetY = this.style.shadowOffsetY,
        this.context.shadowColor = this.style.shadowColor,
        this.context.shadowBlur = this.style.shadowBlur) : (this.context.shadowOffsetX = 0,
        this.context.shadowOffsetY = 0,
        this.context.shadowColor = 0,
        this.context.shadowBlur = 0)
    }
    ,
    H.Text.prototype.measureLine = function(t) {
        for (var e = 0, i = 0; i < t.length; i++) {
            var s = t[i];
            if (0 < this.fontWeights.length || 0 < this.fontStyles.length) {
                var n = this.fontToComponents(this.context.font);
                this.fontStyles[this._charCount] && (n.fontStyle = this.fontStyles[this._charCount]),
                this.fontWeights[this._charCount] && (n.fontWeight = this.fontWeights[this._charCount]),
                this.context.font = this.componentsToFont(n)
            }
            this.style.stroke && this.style.strokeThickness && (this.strokeColors[this._charCount] && (this.context.strokeStyle = this.strokeColors[this._charCount]),
            this.updateShadow(this.style.shadowStroke)),
            this.style.fill && (this.colors[this._charCount] && (this.context.fillStyle = this.colors[this._charCount]),
            this.updateShadow(this.style.shadowFill)),
            e += this.context.measureText(s).width,
            this._charCount++
        }
        return Math.ceil(e)
    }
    ,
    H.Text.prototype.updateLine = function(t, e, i) {
        for (var s = 0; s < t.length; s++) {
            var n = t[s];
            if (0 < this.fontWeights.length || 0 < this.fontStyles.length) {
                var r = this.fontToComponents(this.context.font);
                this.fontStyles[this._charCount] && (r.fontStyle = this.fontStyles[this._charCount]),
                this.fontWeights[this._charCount] && (r.fontWeight = this.fontWeights[this._charCount]),
                this.context.font = this.componentsToFont(r)
            }
            this.style.stroke && this.style.strokeThickness && (this.strokeColors[this._charCount] && (this.context.strokeStyle = this.strokeColors[this._charCount]),
            this.updateShadow(this.style.shadowStroke),
            this.context.strokeText(n, e, i)),
            this.style.fill && (this.colors[this._charCount] && (this.context.fillStyle = this.colors[this._charCount]),
            this.updateShadow(this.style.shadowFill),
            this.context.fillText(n, e, i)),
            e += this.context.measureText(n).width,
            this._charCount++
        }
    }
    ,
    H.Text.prototype.clearColors = function() {
        return this.colors = [],
        this.strokeColors = [],
        this.dirty = !0,
        this
    }
    ,
    H.Text.prototype.clearFontValues = function() {
        return this.fontStyles = [],
        this.fontWeights = [],
        this.dirty = !0,
        this
    }
    ,
    H.Text.prototype.addColor = function(t, e) {
        return this.colors[e] = t,
        this.dirty = !0,
        this
    }
    ,
    H.Text.prototype.addStrokeColor = function(t, e) {
        return this.strokeColors[e] = t,
        this.dirty = !0,
        this
    }
    ,
    H.Text.prototype.addFontStyle = function(t, e) {
        return this.fontStyles[e] = t,
        this.dirty = !0,
        this
    }
    ,
    H.Text.prototype.addFontWeight = function(t, e) {
        return this.fontWeights[e] = t,
        this.dirty = !0,
        this
    }
    ,
    H.Text.prototype.precalculateWordWrap = function(t) {
        return this.texture.baseTexture.resolution = this._res,
        this.context.font = this.style.font,
        this.runWordWrap(t).split(/(?:\r\n|\r|\n)/)
    }
    ,
    H.Text.prototype.runWordWrap = function(t) {
        return this.useAdvancedWrap ? this.advancedWordWrap(t) : this.basicWordWrap(t)
    }
    ,
    H.Text.prototype.advancedWordWrap = function(t) {
        for (var e = this.context, i = this.style.wordWrapWidth, s = "", n = t.replace(/ +/gi, " ").split(/\r?\n/gi), r = n.length, o = 0; o < r; o++) {
            var a = n[o]
              , h = "";
            if (a = a.replace(/^ *|\s*$/gi, ""),
            e.measureText(a).width < i)
                s += a + "\n";
            else {
                for (var l = i, c = a.split(" "), d = 0; d < c.length; d++) {
                    var u = c[d]
                      , p = u + " "
                      , g = e.measureText(p).width;
                    if (l < g) {
                        if (0 === d) {
                            for (var f = p; f.length && (f = f.slice(0, -1),
                            !((g = e.measureText(f).width) <= l)); )
                                ;
                            if (!f.length)
                                throw new Error("This text's wordWrapWidth setting is less than a single character!");
                            var m = u.substr(f.length);
                            c[d] = m,
                            h += f
                        }
                        var y = c[d].length ? d : d + 1
                          , v = c.slice(y).join(" ").replace(/[ \n]*$/gi, "");
                        n[o + 1] = v + " " + (n[o + 1] || ""),
                        r = n.length;
                        break
                    }
                    h += p,
                    l -= g
                }
                s += h.replace(/[ \n]*$/gi, "") + "\n"
            }
        }
        return s.replace(/[\s|\n]*$/gi, "")
    }
    ,
    H.Text.prototype.basicWordWrap = function(t) {
        for (var e = "", i = t.split("\n"), s = 0; s < i.length; s++) {
            for (var n = this.style.wordWrapWidth, r = i[s].split(" "), o = 0; o < r.length; o++) {
                var a = this.context.measureText(r[o]).width
                  , h = a + this.context.measureText(" ").width;
                n < h ? (0 < o && (e += "\n"),
                e += r[o] + " ",
                n = this.style.wordWrapWidth - a) : (n -= h,
                e += r[o] + " ")
            }
            s < i.length - 1 && (e += "\n")
        }
        return e
    }
    ,
    H.Text.prototype.updateFont = function(t) {
        var e = this.componentsToFont(t);
        this.style.font !== e && (this.style.font = e,
        this.dirty = !0,
        this.parent && this.updateTransform())
    }
    ,
    H.Text.prototype.fontToComponents = function(t) {
        var e = t.match(/^\s*(?:\b(normal|italic|oblique|inherit)?\b)\s*(?:\b(normal|small-caps|inherit)?\b)\s*(?:\b(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit)?\b)\s*(?:\b(xx-small|x-small|small|medium|large|x-large|xx-large|larger|smaller|0|\d*(?:[.]\d*)?(?:%|[a-z]{2,5}))?\b)\s*(.*)\s*$/);
        if (e) {
            var i = e[5].trim();
            return /^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(i) || /['",]/.exec(i) || (i = "'" + i + "'"),
            {
                font: t,
                fontStyle: e[1] || "normal",
                fontVariant: e[2] || "normal",
                fontWeight: e[3] || "normal",
                fontSize: e[4] || "medium",
                fontFamily: i
            }
        }
        return {
            font: t
        }
    }
    ,
    H.Text.prototype.componentsToFont = function(t) {
        var e, i = [];
        return (e = t.fontStyle) && "normal" !== e && i.push(e),
        (e = t.fontVariant) && "normal" !== e && i.push(e),
        (e = t.fontWeight) && "normal" !== e && i.push(e),
        (e = t.fontSize) && "medium" !== e && i.push(e),
        (e = t.fontFamily) && i.push(e),
        i.length || i.push(t.font),
        i.join(" ")
    }
    ,
    H.Text.prototype.setText = function(t, e) {
        return void 0 === e && (e = !1),
        this.text = t.toString() || "",
        e ? this.updateText() : this.dirty = !0,
        this
    }
    ,
    H.Text.prototype.parseList = function(t) {
        if (!Array.isArray(t))
            return this;
        for (var e = "", i = 0; i < t.length; i++)
            Array.isArray(t[i]) ? (e += t[i].join("\t"),
            i < t.length - 1 && (e += "\n")) : (e += t[i],
            i < t.length - 1 && (e += "\t"));
        return this.text = e,
        this.dirty = !0,
        this
    }
    ,
    H.Text.prototype.setTextBounds = function(t, e, i, s) {
        return void 0 === t ? this.textBounds = null : (this.textBounds ? this.textBounds.setTo(t, e, i, s) : this.textBounds = new H.Rectangle(t,e,i,s),
        this.style.wordWrapWidth > i && (this.style.wordWrapWidth = i)),
        this.updateTexture(),
        this
    }
    ,
    H.Text.prototype.updateTexture = function() {
        var t = this.texture.baseTexture
          , e = this.texture.crop
          , i = this.texture.frame
          , s = this.canvas.width
          , n = this.canvas.height;
        if (t.width = s,
        t.height = n,
        e.width = s,
        e.height = n,
        i.width = s,
        i.height = n,
        this.texture.width = s,
        this.texture.height = n,
        this._width = s,
        this._height = n,
        this.textBounds) {
            var r = this.textBounds.x
              , o = this.textBounds.y;
            "right" === this.style.boundsAlignH ? r += this.textBounds.width - this.canvas.width / this.resolution : "center" === this.style.boundsAlignH && (r += this.textBounds.halfWidth - this.canvas.width / this.resolution / 2),
            "bottom" === this.style.boundsAlignV ? o += this.textBounds.height - this.canvas.height / this.resolution : "middle" === this.style.boundsAlignV && (o += this.textBounds.halfHeight - this.canvas.height / this.resolution / 2),
            this.pivot.x = -r,
            this.pivot.y = -o
        }
        this.renderable = 0 !== s && 0 !== n,
        this.texture.requiresReTint = !0,
        this.texture.baseTexture.dirty()
    }
    ,
    H.Text.prototype._renderWebGL = function(t) {
        this.dirty && (this.updateText(),
        this.dirty = !1),
        PIXI.Sprite.prototype._renderWebGL.call(this, t)
    }
    ,
    H.Text.prototype._renderCanvas = function(t) {
        this.dirty && (this.updateText(),
        this.dirty = !1),
        PIXI.Sprite.prototype._renderCanvas.call(this, t)
    }
    ,
    H.Text.prototype.determineFontProperties = function(t) {
        var e = H.Text.fontPropertiesCache[t];
        if (!e) {
            e = {};
            var i = H.Text.fontPropertiesCanvas
              , s = H.Text.fontPropertiesContext;
            s.font = t;
            var n = Math.ceil(s.measureText("|Mq").width)
              , r = Math.ceil(s.measureText("|Mq").width)
              , o = 2 * r;
            if (r = 1.4 * r | 0,
            i.width = n,
            i.height = o,
            s.fillStyle = "#f00",
            s.fillRect(0, 0, n, o),
            s.font = t,
            s.textBaseline = "alphabetic",
            s.fillStyle = "#000",
            s.fillText("|Mq", 0, r),
            !s.getImageData(0, 0, n, o))
                return e.ascent = r,
                e.descent = r + 6,
                e.fontSize = e.ascent + e.descent,
                H.Text.fontPropertiesCache[t] = e;
            var a, h, l = s.getImageData(0, 0, n, o).data, c = l.length, d = 4 * n, u = 0, p = !1;
            for (a = 0; a < r; a++) {
                for (h = 0; h < d; h += 4)
                    if (255 !== l[u + h]) {
                        p = !0;
                        break
                    }
                if (p)
                    break;
                u += d
            }
            for (e.ascent = r - a,
            u = c - d,
            p = !1,
            a = o; r < a; a--) {
                for (h = 0; h < d; h += 4)
                    if (255 !== l[u + h]) {
                        p = !0;
                        break
                    }
                if (p)
                    break;
                u -= d
            }
            e.descent = a - r,
            e.descent += 6,
            e.fontSize = e.ascent + e.descent,
            H.Text.fontPropertiesCache[t] = e
        }
        return e
    }
    ,
    H.Text.prototype.getBounds = function(t) {
        return this.dirty && (this.updateText(),
        this.dirty = !1),
        PIXI.Sprite.prototype.getBounds.call(this, t)
    }
    ,
    Object.defineProperty(H.Text.prototype, "text", {
        get: function() {
            return this._text
        },
        set: function(t) {
            t !== this._text && (this._text = t.toString() || "",
            this.dirty = !0,
            this.parent && this.updateTransform())
        }
    }),
    Object.defineProperty(H.Text.prototype, "cssFont", {
        get: function() {
            return this.componentsToFont(this._fontComponents)
        },
        set: function(t) {
            t = t || "bold 20pt Arial",
            this._fontComponents = this.fontToComponents(t),
            this.updateFont(this._fontComponents)
        }
    }),
    Object.defineProperty(H.Text.prototype, "font", {
        get: function() {
            return this._fontComponents.fontFamily
        },
        set: function(t) {
            t = (t = t || "Arial").trim(),
            /^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(t) || /['",]/.exec(t) || (t = "'" + t + "'"),
            this._fontComponents.fontFamily = t,
            this.updateFont(this._fontComponents)
        }
    }),
    Object.defineProperty(H.Text.prototype, "fontSize", {
        get: function() {
            var t = this._fontComponents.fontSize;
            return t && /(?:^0$|px$)/.exec(t) ? parseInt(t, 10) : t
        },
        set: function(t) {
            "number" == typeof (t = t || "0") && (t += "px"),
            this._fontComponents.fontSize = t,
            this.updateFont(this._fontComponents)
        }
    }),
    Object.defineProperty(H.Text.prototype, "fontWeight", {
        get: function() {
            return this._fontComponents.fontWeight || "normal"
        },
        set: function(t) {
            t = t || "normal",
            this._fontComponents.fontWeight = t,
            this.updateFont(this._fontComponents)
        }
    }),
    Object.defineProperty(H.Text.prototype, "fontStyle", {
        get: function() {
            return this._fontComponents.fontStyle || "normal"
        },
        set: function(t) {
            t = t || "normal",
            this._fontComponents.fontStyle = t,
            this.updateFont(this._fontComponents)
        }
    }),
    Object.defineProperty(H.Text.prototype, "fontVariant", {
        get: function() {
            return this._fontComponents.fontVariant || "normal"
        },
        set: function(t) {
            t = t || "normal",
            this._fontComponents.fontVariant = t,
            this.updateFont(this._fontComponents)
        }
    }),
    Object.defineProperty(H.Text.prototype, "fill", {
        get: function() {
            return this.style.fill
        },
        set: function(t) {
            t !== this.style.fill && (this.style.fill = t,
            this.dirty = !0)
        }
    }),
    Object.defineProperty(H.Text.prototype, "align", {
        get: function() {
            return this.style.align
        },
        set: function(t) {
            t !== this.style.align && (this.style.align = t,
            this.dirty = !0)
        }
    }),
    Object.defineProperty(H.Text.prototype, "resolution", {
        get: function() {
            return this._res
        },
        set: function(t) {
            t !== this._res && (this._res = t,
            this.dirty = !0)
        }
    }),
    Object.defineProperty(H.Text.prototype, "tabs", {
        get: function() {
            return this.style.tabs
        },
        set: function(t) {
            t !== this.style.tabs && (this.style.tabs = t,
            this.dirty = !0)
        }
    }),
    Object.defineProperty(H.Text.prototype, "boundsAlignH", {
        get: function() {
            return this.style.boundsAlignH
        },
        set: function(t) {
            t !== this.style.boundsAlignH && (this.style.boundsAlignH = t,
            this.dirty = !0)
        }
    }),
    Object.defineProperty(H.Text.prototype, "boundsAlignV", {
        get: function() {
            return this.style.boundsAlignV
        },
        set: function(t) {
            t !== this.style.boundsAlignV && (this.style.boundsAlignV = t,
            this.dirty = !0)
        }
    }),
    Object.defineProperty(H.Text.prototype, "stroke", {
        get: function() {
            return this.style.stroke
        },
        set: function(t) {
            t !== this.style.stroke && (this.style.stroke = t,
            this.dirty = !0)
        }
    }),
    Object.defineProperty(H.Text.prototype, "strokeThickness", {
        get: function() {
            return this.style.strokeThickness
        },
        set: function(t) {
            t !== this.style.strokeThickness && (this.style.strokeThickness = t,
            this.dirty = !0)
        }
    }),
    Object.defineProperty(H.Text.prototype, "wordWrap", {
        get: function() {
            return this.style.wordWrap
        },
        set: function(t) {
            t !== this.style.wordWrap && (this.style.wordWrap = t,
            this.dirty = !0)
        }
    }),
    Object.defineProperty(H.Text.prototype, "wordWrapWidth", {
        get: function() {
            return this.style.wordWrapWidth
        },
        set: function(t) {
            t !== this.style.wordWrapWidth && (this.style.wordWrapWidth = t,
            this.dirty = !0)
        }
    }),
    Object.defineProperty(H.Text.prototype, "lineSpacing", {
        get: function() {
            return this._lineSpacing
        },
        set: function(t) {
            t !== this._lineSpacing && (this._lineSpacing = parseFloat(t),
            this.dirty = !0,
            this.parent && this.updateTransform())
        }
    }),
    Object.defineProperty(H.Text.prototype, "shadowOffsetX", {
        get: function() {
            return this.style.shadowOffsetX
        },
        set: function(t) {
            t !== this.style.shadowOffsetX && (this.style.shadowOffsetX = t,
            this.dirty = !0)
        }
    }),
    Object.defineProperty(H.Text.prototype, "shadowOffsetY", {
        get: function() {
            return this.style.shadowOffsetY
        },
        set: function(t) {
            t !== this.style.shadowOffsetY && (this.style.shadowOffsetY = t,
            this.dirty = !0)
        }
    }),
    Object.defineProperty(H.Text.prototype, "shadowColor", {
        get: function() {
            return this.style.shadowColor
        },
        set: function(t) {
            t !== this.style.shadowColor && (this.style.shadowColor = t,
            this.dirty = !0)
        }
    }),
    Object.defineProperty(H.Text.prototype, "shadowBlur", {
        get: function() {
            return this.style.shadowBlur
        },
        set: function(t) {
            t !== this.style.shadowBlur && (this.style.shadowBlur = t,
            this.dirty = !0)
        }
    }),
    Object.defineProperty(H.Text.prototype, "shadowStroke", {
        get: function() {
            return this.style.shadowStroke
        },
        set: function(t) {
            t !== this.style.shadowStroke && (this.style.shadowStroke = t,
            this.dirty = !0)
        }
    }),
    Object.defineProperty(H.Text.prototype, "shadowFill", {
        get: function() {
            return this.style.shadowFill
        },
        set: function(t) {
            t !== this.style.shadowFill && (this.style.shadowFill = t,
            this.dirty = !0)
        }
    }),
    Object.defineProperty(H.Text.prototype, "width", {
        get: function() {
            return this.dirty && (this.updateText(),
            this.dirty = !1),
            this.scale.x * this.texture.frame.width
        },
        set: function(t) {
            this.scale.x = t / this.texture.frame.width,
            this._width = t
        }
    }),
    Object.defineProperty(H.Text.prototype, "height", {
        get: function() {
            return this.dirty && (this.updateText(),
            this.dirty = !1),
            this.scale.y * this.texture.frame.height
        },
        set: function(t) {
            this.scale.y = t / this.texture.frame.height,
            this._height = t
        }
    }),
    H.Text.fontPropertiesCache = {},
    H.Text.fontPropertiesCanvas = document.createElement("canvas"),
    H.Text.fontPropertiesContext = H.Text.fontPropertiesCanvas.getContext("2d"),
    H.BitmapText = function(t, e, i, s, n, r, o) {
        e = e || 0,
        i = i || 0,
        s = s || "",
        n = n || "",
        r = r || 32,
        o = o || "left",
        PIXI.DisplayObjectContainer.call(this),
        this.type = H.BITMAPTEXT,
        this.physicsType = H.SPRITE,
        this.textWidth = 0,
        this.textHeight = 0,
        this.anchor = new H.Point,
        this._prevAnchor = new H.Point,
        this._glyphs = [],
        this._maxWidth = 0,
        this._text = n.toString() || "",
        this._data = t.cache.getBitmapFont(s),
        this._font = s,
        this._fontSize = r,
        this._align = o,
        this._tint = 16777215,
        this.updateText(),
        this.dirty = !1,
        H.Component.Core.init.call(this, t, e, i, "", null)
    }
    ,
    H.BitmapText.prototype = Object.create(PIXI.DisplayObjectContainer.prototype),
    H.BitmapText.prototype.constructor = H.BitmapText,
    H.Component.Core.install.call(H.BitmapText.prototype, ["Angle", "AutoCull", "Bounds", "Destroy", "FixedToCamera", "InputEnabled", "InWorld", "LifeSpan", "PhysicsBody", "Reset"]),
    H.BitmapText.prototype.preUpdatePhysics = H.Component.PhysicsBody.preUpdate,
    H.BitmapText.prototype.preUpdateLifeSpan = H.Component.LifeSpan.preUpdate,
    H.BitmapText.prototype.preUpdateInWorld = H.Component.InWorld.preUpdate,
    H.BitmapText.prototype.preUpdateCore = H.Component.Core.preUpdate,
    H.BitmapText.prototype.preUpdate = function() {
        return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore()
    }
    ,
    H.BitmapText.prototype.postUpdate = function() {
        H.Component.PhysicsBody.postUpdate.call(this),
        H.Component.FixedToCamera.postUpdate.call(this),
        this.body && this.body.type === H.Physics.ARCADE && (this.textWidth === this.body.sourceWidth && this.textHeight === this.body.sourceHeight || this.body.setSize(this.textWidth, this.textHeight))
    }
    ,
    H.BitmapText.prototype.setText = function(t) {
        this.text = t
    }
    ,
    H.BitmapText.prototype.scanLine = function(t, e, i) {
        for (var s = 0, n = 0, r = -1, o = 0, a = null, h = 0 < this._maxWidth ? this._maxWidth : null, l = [], c = 0; c < i.length; c++) {
            var d = c === i.length - 1;
            if (/(?:\r\n|\r|\n)/.test(i.charAt(c)))
                return {
                    width: n,
                    text: i.substr(0, c),
                    end: d,
                    chars: l
                };
            var u, p = i.charCodeAt(c), g = t.chars[p];
            void 0 === g && (p = 32,
            g = t.chars[p]);
            var f = a && g.kerning[a] ? g.kerning[a] : 0;
            if (/(\s)/.test(i.charAt(c)) && (r = c,
            o = n),
            u = (f + g.texture.width + g.xOffset) * e,
            h && h <= n + u && -1 < r)
                return {
                    width: o || n,
                    text: i.substr(0, c - (c - r)),
                    end: d,
                    chars: l
                };
            n += (g.xAdvance + f) * e,
            l.push(s + (g.xOffset + f) * e),
            s += (g.xAdvance + f) * e,
            a = p
        }
        return {
            width: n,
            text: i,
            end: d,
            chars: l
        }
    }
    ,
    H.BitmapText.prototype.cleanText = function(t, e) {
        void 0 === e && (e = "");
        var i = this._data.font;
        if (!i)
            return "";
        for (var s = t.replace(/\r\n|\n\r|\n|\r/g, "\n").split("\n"), n = 0; n < s.length; n++) {
            for (var r = "", o = s[n], a = 0; a < o.length; a++)
                r = i.chars[o.charCodeAt(a)] ? r.concat(o[a]) : r.concat(e);
            s[n] = r
        }
        return s.join("\n")
    }
    ,
    H.BitmapText.prototype.updateText = function() {
        var t = this._data.font;
        if (t) {
            var e = this.text
              , i = this._fontSize / t.size
              , s = []
              , n = 0;
            this.textWidth = 0;
            do {
                (c = this.scanLine(t, i, e)).y = n,
                s.push(c),
                c.width > this.textWidth && (this.textWidth = c.width),
                n += t.lineHeight * i,
                e = e.substr(c.text.length + 1)
            } while (!1 === c.end);
            this.textHeight = n;
            for (var r = 0, o = 0, a = this.textWidth * this.anchor.x, h = this.textHeight * this.anchor.y, l = 0; l < s.length; l++) {
                var c = s[l];
                "right" === this._align ? o = this.textWidth - c.width : "center" === this._align && (o = (this.textWidth - c.width) / 2);
                for (var d = 0; d < c.text.length; d++) {
                    var u = c.text.charCodeAt(d)
                      , p = t.chars[u];
                    void 0 === p && (u = 32,
                    p = t.chars[u]);
                    var g = this._glyphs[r];
                    g ? g.texture = p.texture : ((g = new PIXI.Sprite(p.texture)).name = c.text[d],
                    this._glyphs.push(g)),
                    g.position.x = c.chars[d] + o - a,
                    g.position.y = c.y + p.yOffset * i - h,
                    g.scale.set(i),
                    g.tint = this.tint,
                    g.texture.requiresReTint = !0,
                    g.parent || this.addChild(g),
                    r++
                }
            }
            for (l = r; l < this._glyphs.length; l++)
                this.removeChild(this._glyphs[l])
        }
    }
    ,
    H.BitmapText.prototype.purgeGlyphs = function() {
        for (var t = this._glyphs.length, e = [], i = 0; i < this._glyphs.length; i++)
            this._glyphs[i].parent !== this ? this._glyphs[i].destroy() : e.push(this._glyphs[i]);
        return this._glyphs = [],
        this._glyphs = e,
        this.updateText(),
        t - e.length
    }
    ,
    H.BitmapText.prototype.updateTransform = function() {
        !this.dirty && this.anchor.equals(this._prevAnchor) || (this.updateText(),
        this.dirty = !1,
        this._prevAnchor.copyFrom(this.anchor)),
        PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)
    }
    ,
    Object.defineProperty(H.BitmapText.prototype, "align", {
        get: function() {
            return this._align
        },
        set: function(t) {
            t === this._align || "left" !== t && "center" !== t && "right" !== t || (this._align = t,
            this.updateText())
        }
    }),
    Object.defineProperty(H.BitmapText.prototype, "tint", {
        get: function() {
            return this._tint
        },
        set: function(t) {
            t !== this._tint && (this._tint = t,
            this.updateText())
        }
    }),
    Object.defineProperty(H.BitmapText.prototype, "font", {
        get: function() {
            return this._font
        },
        set: function(t) {
            t !== this._font && (this._font = t.trim(),
            this._data = this.game.cache.getBitmapFont(this._font),
            this.updateText())
        }
    }),
    Object.defineProperty(H.BitmapText.prototype, "fontSize", {
        get: function() {
            return this._fontSize
        },
        set: function(t) {
            (t = parseInt(t, 10)) !== this._fontSize && 0 < t && (this._fontSize = t,
            this.updateText())
        }
    }),
    Object.defineProperty(H.BitmapText.prototype, "text", {
        get: function() {
            return this._text
        },
        set: function(t) {
            t !== this._text && (this._text = t.toString() || "",
            this.updateText())
        }
    }),
    Object.defineProperty(H.BitmapText.prototype, "maxWidth", {
        get: function() {
            return this._maxWidth
        },
        set: function(t) {
            t !== this._maxWidth && (this._maxWidth = t,
            this.updateText())
        }
    }),
    Object.defineProperty(H.BitmapText.prototype, "smoothed", {
        get: function() {
            return !this._data.base.scaleMode
        },
        set: function(t) {
            this._data.base.scaleMode = t ? 0 : 1
        }
    }),
    H.RetroFont = function(t, e, i, s, n, r, o, a, h, l) {
        if (!t.cache.checkImageKey(e))
            return !1;
        null != r || (r = t.cache.getImage(e).width / i),
        this.characterWidth = i,
        this.characterHeight = s,
        this.characterSpacingX = o || 0,
        this.characterSpacingY = a || 0,
        this.characterPerRow = r,
        this.offsetX = h || 0,
        this.offsetY = l || 0,
        this.align = "left",
        this.multiLine = !1,
        this.autoUpperCase = !0,
        this.customSpacingX = 0,
        this.customSpacingY = 0,
        this.fixedWidth = 0,
        this.fontSet = t.cache.getImage(e),
        this._text = "",
        this.grabData = [],
        this.frameData = new H.FrameData;
        for (var c = this.offsetX, d = this.offsetY, u = 0, p = 0; p < n.length; p++) {
            var g = this.frameData.addFrame(new H.Frame(p,c,d,this.characterWidth,this.characterHeight));
            this.grabData[n.charCodeAt(p)] = g.index,
            ++u === this.characterPerRow ? (u = 0,
            c = this.offsetX,
            d += this.characterHeight + this.characterSpacingY) : c += this.characterWidth + this.characterSpacingX
        }
        t.cache.updateFrameData(e, this.frameData),
        this.stamp = new H.Image(t,0,0,e,0),
        H.RenderTexture.call(this, t, 100, 100, "", H.scaleModes.NEAREST),
        this.type = H.RETROFONT
    }
    ,
    H.RetroFont.prototype = Object.create(H.RenderTexture.prototype),
    H.RetroFont.prototype.constructor = H.RetroFont,
    H.RetroFont.ALIGN_LEFT = "left",
    H.RetroFont.ALIGN_RIGHT = "right",
    H.RetroFont.ALIGN_CENTER = "center",
    H.RetroFont.TEXT_SET1 = " !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",
    H.RetroFont.TEXT_SET2 = " !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ",
    H.RetroFont.TEXT_SET3 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",
    H.RetroFont.TEXT_SET4 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789",
    H.RetroFont.TEXT_SET5 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789",
    H.RetroFont.TEXT_SET6 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ",
    H.RetroFont.TEXT_SET7 = "AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39",
    H.RetroFont.TEXT_SET8 = "0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ",
    H.RetroFont.TEXT_SET9 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!",
    H.RetroFont.TEXT_SET10 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ",
    H.RetroFont.TEXT_SET11 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789",
    H.RetroFont.prototype.setFixedWidth = function(t, e) {
        void 0 === e && (e = "left"),
        this.fixedWidth = t,
        this.align = e
    }
    ,
    H.RetroFont.prototype.setText = function(t, e, i, s, n, r) {
        this.multiLine = e || !1,
        this.customSpacingX = i || 0,
        this.customSpacingY = s || 0,
        this.align = n || "left",
        this.autoUpperCase = !r,
        0 < t.length && (this.text = t)
    }
    ,
    H.RetroFont.prototype.buildRetroFontText = function() {
        var t = 0
          , e = 0;
        if (this.clear(),
        this.multiLine) {
            var i = this._text.split("\n");
            0 < this.fixedWidth ? this.resize(this.fixedWidth, i.length * (this.characterHeight + this.customSpacingY) - this.customSpacingY, !0) : this.resize(this.getLongestLine() * (this.characterWidth + this.customSpacingX), i.length * (this.characterHeight + this.customSpacingY) - this.customSpacingY, !0);
            for (var s = 0; s < i.length; s++)
                t = 0,
                this.align === H.RetroFont.ALIGN_RIGHT ? t = this.width - i[s].length * (this.characterWidth + this.customSpacingX) : this.align === H.RetroFont.ALIGN_CENTER && (t = this.width / 2 - i[s].length * (this.characterWidth + this.customSpacingX) / 2,
                t += this.customSpacingX / 2),
                t < 0 && (t = 0),
                this.pasteLine(i[s], t, e, this.customSpacingX),
                e += this.characterHeight + this.customSpacingY
        } else
            0 < this.fixedWidth ? this.resize(this.fixedWidth, this.characterHeight, !0) : this.resize(this._text.length * (this.characterWidth + this.customSpacingX), this.characterHeight, !0),
            t = 0,
            this.align === H.RetroFont.ALIGN_RIGHT ? t = this.width - this._text.length * (this.characterWidth + this.customSpacingX) : this.align === H.RetroFont.ALIGN_CENTER && (t = this.width / 2 - this._text.length * (this.characterWidth + this.customSpacingX) / 2,
            t += this.customSpacingX / 2),
            t < 0 && (t = 0),
            this.pasteLine(this._text, t, 0, this.customSpacingX);
        this.requiresReTint = !0
    }
    ,
    H.RetroFont.prototype.pasteLine = function(t, e, i, s) {
        for (var n = 0; n < t.length; n++)
            if (" " === t.charAt(n))
                e += this.characterWidth + s;
            else if (0 <= this.grabData[t.charCodeAt(n)] && (this.stamp.frame = this.grabData[t.charCodeAt(n)],
            this.renderXY(this.stamp, e, i, !1),
            (e += this.characterWidth + s) > this.width))
                break
    }
    ,
    H.RetroFont.prototype.getLongestLine = function() {
        var t = 0;
        if (0 < this._text.length)
            for (var e = this._text.split("\n"), i = 0; i < e.length; i++)
                e[i].length > t && (t = e[i].length);
        return t
    }
    ,
    H.RetroFont.prototype.removeUnsupportedCharacters = function(t) {
        for (var e = "", i = 0; i < this._text.length; i++) {
            var s = this._text[i]
              , n = s.charCodeAt(0);
            (0 <= this.grabData[n] || !t && "\n" === s) && (e = e.concat(s))
        }
        return e
    }
    ,
    H.RetroFont.prototype.updateOffset = function(t, e) {
        if (this.offsetX !== t || this.offsetY !== e) {
            for (var i = t - this.offsetX, s = e - this.offsetY, n = this.game.cache.getFrameData(this.stamp.key).getFrames(), r = n.length; r--; )
                n[r].x += i,
                n[r].y += s;
            this.buildRetroFontText()
        }
    }
    ,
    Object.defineProperty(H.RetroFont.prototype, "text", {
        get: function() {
            return this._text
        },
        set: function(t) {
            var e;
            (e = this.autoUpperCase ? t.toUpperCase() : t) !== this._text && (this._text = e,
            this.removeUnsupportedCharacters(this.multiLine),
            this.buildRetroFontText())
        }
    }),
    Object.defineProperty(H.RetroFont.prototype, "smoothed", {
        get: function() {
            return this.stamp.smoothed
        },
        set: function(t) {
            this.stamp.smoothed = t,
            this.buildRetroFontText()
        }
    }),
    H.Rope = function(t, e, i, s, n, r) {
        this.points = [],
        this.points = r,
        this._hasUpdateAnimation = !1,
        this._updateAnimationCallback = null,
        e = e || 0,
        i = i || 0,
        s = s || null,
        n = n || null,
        this.type = H.ROPE,
        PIXI.Rope.call(this, H.Cache.DEFAULT, this.points),
        H.Component.Core.init.call(this, t, e, i, s, n)
    }
    ,
    H.Rope.prototype = Object.create(PIXI.Rope.prototype),
    H.Rope.prototype.constructor = H.Rope,
    H.Component.Core.install.call(H.Rope.prototype, ["Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Crop", "Delta", "Destroy", "FixedToCamera", "InWorld", "LifeSpan", "LoadTexture", "Overlap", "PhysicsBody", "Reset", "ScaleMinMax", "Smoothed"]),
    H.Rope.prototype.preUpdatePhysics = H.Component.PhysicsBody.preUpdate,
    H.Rope.prototype.preUpdateLifeSpan = H.Component.LifeSpan.preUpdate,
    H.Rope.prototype.preUpdateInWorld = H.Component.InWorld.preUpdate,
    H.Rope.prototype.preUpdateCore = H.Component.Core.preUpdate,
    H.Rope.prototype.preUpdate = function() {
        return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore()
    }
    ,
    H.Rope.prototype.update = function() {
        this._hasUpdateAnimation && this.updateAnimation.call(this)
    }
    ,
    H.Rope.prototype.reset = function(t, e) {
        return H.Component.Reset.prototype.reset.call(this, t, e),
        this
    }
    ,
    Object.defineProperty(H.Rope.prototype, "updateAnimation", {
        get: function() {
            return this._updateAnimation
        },
        set: function(t) {
            t && "function" == typeof t ? (this._hasUpdateAnimation = !0,
            this._updateAnimation = t) : (this._hasUpdateAnimation = !1,
            this._updateAnimation = null)
        }
    }),
    Object.defineProperty(H.Rope.prototype, "segments", {
        get: function() {
            for (var t, e, i, s, n, r, o, a, h = [], l = 0; l < this.points.length; l++)
                t = 4 * l,
                e = this.vertices[t] * this.scale.x,
                i = this.vertices[t + 1] * this.scale.y,
                s = this.vertices[t + 4] * this.scale.x,
                n = this.vertices[t + 3] * this.scale.y,
                r = H.Math.difference(e, s),
                o = H.Math.difference(i, n),
                e += this.world.x,
                i += this.world.y,
                a = new H.Rectangle(e,i,r,o),
                h.push(a);
            return h
        }
    }),
    H.TileSprite = function(t, e, i, s, n, r, o) {
        e = e || 0,
        i = i || 0,
        s = s || 256,
        n = n || 256,
        r = r || null,
        o = o || null,
        this.type = H.TILESPRITE,
        this.physicsType = H.SPRITE,
        this._scroll = new H.Point;
        var a = t.cache.getImage("__default", !0);
        PIXI.TilingSprite.call(this, new PIXI.Texture(a.base), s, n),
        H.Component.Core.init.call(this, t, e, i, r, o)
    }
    ,
    H.TileSprite.prototype = Object.create(PIXI.TilingSprite.prototype),
    H.TileSprite.prototype.constructor = H.TileSprite,
    H.Component.Core.install.call(H.TileSprite.prototype, ["Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Destroy", "FixedToCamera", "Health", "InCamera", "InputEnabled", "InWorld", "LifeSpan", "LoadTexture", "Overlap", "PhysicsBody", "Reset", "Smoothed"]),
    H.TileSprite.prototype.preUpdatePhysics = H.Component.PhysicsBody.preUpdate,
    H.TileSprite.prototype.preUpdateLifeSpan = H.Component.LifeSpan.preUpdate,
    H.TileSprite.prototype.preUpdateInWorld = H.Component.InWorld.preUpdate,
    H.TileSprite.prototype.preUpdateCore = H.Component.Core.preUpdate,
    H.TileSprite.prototype.preUpdate = function() {
        return 0 !== this._scroll.x && (this.tilePosition.x += this._scroll.x * this.game.time.physicsElapsed),
        0 !== this._scroll.y && (this.tilePosition.y += this._scroll.y * this.game.time.physicsElapsed),
        !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore()
    }
    ,
    H.TileSprite.prototype.autoScroll = function(t, e) {
        this._scroll.set(t, e)
    }
    ,
    H.TileSprite.prototype.stopScroll = function() {
        this._scroll.set(0, 0)
    }
    ,
    H.TileSprite.prototype.destroy = function(t) {
        H.Component.Destroy.prototype.destroy.call(this, t),
        PIXI.TilingSprite.prototype.destroy.call(this)
    }
    ,
    H.TileSprite.prototype.reset = function(t, e) {
        return H.Component.Reset.prototype.reset.call(this, t, e),
        this.tilePosition.x = 0,
        this.tilePosition.y = 0,
        this
    }
    ,
    H.Device = function() {
        this.deviceReadyAt = 0,
        this.initialized = !1,
        this.desktop = !1,
        this.iOS = !1,
        this.iOSVersion = 0,
        this.cocoonJS = !1,
        this.cocoonJSApp = !1,
        this.wechatMinigame = !1,
        this.cordova = !1,
        this.node = !1,
        this.nodeWebkit = !1,
        this.electron = !1,
        this.ejecta = !1,
        this.crosswalk = !1,
        this.android = !1,
        this.chromeOS = !1,
        this.linux = !1,
        this.macOS = !1,
        this.windows = !1,
        this.windowsPhone = !1,
        this.canvas = !1,
        this.canvasBitBltShift = null,
        this.webGL = !1,
        this.file = !1,
        this.fileSystem = !1,
        this.localStorage = !1,
        this.worker = !1,
        this.css3D = !1,
        this.pointerLock = !1,
        this.typedArray = !1,
        this.vibration = !1,
        this.getUserMedia = !0,
        this.quirksMode = !1,
        this.touch = !1,
        this.mspointer = !1,
        this.wheelEvent = null,
        this.arora = !1,
        this.chrome = !1,
        this.chromeVersion = 0,
        this.epiphany = !1,
        this.firefox = !1,
        this.firefoxVersion = 0,
        this.ie = !1,
        this.ieVersion = 0,
        this.trident = !1,
        this.tridentVersion = 0,
        this.edge = !1,
        this.mobileSafari = !1,
        this.midori = !1,
        this.opera = !1,
        this.safari = !1,
        this.safariVersion = 0,
        this.webApp = !1,
        this.silk = !1,
        this.audioData = !1,
        this.webAudio = !1,
        this.ogg = !1,
        this.opus = !1,
        this.mp3 = !1,
        this.wav = !1,
        this.m4a = !1,
        this.webm = !1,
        this.dolby = !1,
        this.oggVideo = !1,
        this.h264Video = !1,
        this.mp4Video = !1,
        this.webmVideo = !1,
        this.vp9Video = !1,
        this.hlsVideo = !1,
        this.iPhone = !1,
        this.iPhone4 = !1,
        this.iPad = !1,
        this.pixelRatio = 0,
        this.littleEndian = !1,
        this.LITTLE_ENDIAN = !1,
        this.support32bit = !1,
        this.fullscreen = !1,
        this.requestFullscreen = "",
        this.cancelFullscreen = "",
        this.fullscreenKeyboard = !1
    }
    ,
    H.Device = new H.Device,
    H.Device.onInitialized = new H.Signal,
    H.Device.whenReady = function(t, e, i) {
        var s = this._readyCheck;
        if (this.deviceReadyAt || !s)
            t.call(e, this);
        else if (s._monitor || i)
            s._queue = s._queue || [],
            s._queue.push([t, e]);
        else {
            s._monitor = s.bind(this),
            s._queue = s._queue || [],
            s._queue.push([t, e]);
            var n = void 0 !== window.cordova
              , r = navigator.isCocoonJS;
            "complete" === document.readyState || "interactive" === document.readyState ? window.setTimeout(s._monitor, 0) : n && !r ? document.addEventListener("deviceready", s._monitor, !1) : (document.addEventListener("DOMContentLoaded", s._monitor, !1),
            window.addEventListener("load", s._monitor, !1))
        }
    }
    ,
    H.Device._readyCheck = function() {
        var t = this._readyCheck;
        if (document.body) {
            if (!this.deviceReadyAt) {
                this.deviceReadyAt = Date.now(),
                document.removeEventListener("deviceready", t._monitor),
                document.removeEventListener("DOMContentLoaded", t._monitor),
                window.removeEventListener("load", t._monitor),
                this._initialize(),
                this.initialized = !0,
                this.onInitialized.dispatch(this);
                for (var e; e = t._queue.shift(); ) {
                    var i = e[0]
                      , s = e[1];
                    i.call(s, this)
                }
                this._readyCheck = null,
                this._initialize = null,
                this.onInitialized = null
            }
        } else
            window.setTimeout(t._monitor, 20)
    }
    ,
    H.Device._initialize = function() {
        var t, e, i, s, n = this;
        (function() {
            var t = navigator.userAgent;
            /Playstation Vita/.test(t) ? n.vita = !0 : /Kindle/.test(t) || /\bKF[A-Z][A-Z]+/.test(t) || /Silk.*Mobile Safari/.test(t) ? n.kindle = !0 : /Android/.test(t) ? n.android = !0 : /CrOS/.test(t) ? n.chromeOS = !0 : /iP[ao]d|iPhone/i.test(t) ? (n.iOS = !0,
            navigator.appVersion.match(/OS (\d+)/),
            n.iOSVersion = parseInt(RegExp.$1, 10)) : /Linux/.test(t) ? n.linux = !0 : /Mac OS/.test(t) ? n.macOS = !0 : /Windows/.test(t) && (n.windows = !0),
            (/Windows Phone/i.test(t) || /IEMobile/i.test(t)) && (n.android = !1,
            n.iOS = !1,
            n.macOS = !1,
            n.windows = !0,
            n.windowsPhone = !0);
            var e = /Silk/.test(t);
            (n.windows || n.macOS || n.linux && !e || n.chromeOS) && (n.desktop = !0),
            (n.windowsPhone || /Windows NT/i.test(t) && /Touch/i.test(t)) && (n.desktop = !1)
        }
        )(),
        function() {
            var t = navigator.userAgent;
            if (/Arora/.test(t) ? n.arora = !0 : /Edge\/\d+/.test(t) ? n.edge = !0 : /Chrome\/(\d+)/.test(t) && !n.windowsPhone ? (n.chrome = !0,
            n.chromeVersion = parseInt(RegExp.$1, 10)) : /Epiphany/.test(t) ? n.epiphany = !0 : /Firefox\D+(\d+)/.test(t) ? (n.firefox = !0,
            n.firefoxVersion = parseInt(RegExp.$1, 10)) : /AppleWebKit/.test(t) && n.iOS ? n.mobileSafari = !0 : /MSIE (\d+\.\d+);/.test(t) ? (n.ie = !0,
            n.ieVersion = parseInt(RegExp.$1, 10)) : /Midori/.test(t) ? n.midori = !0 : /Opera/.test(t) ? n.opera = !0 : /Safari\/(\d+)/.test(t) && !n.windowsPhone ? (n.safari = !0,
            /Version\/(\d+)\./.test(t) && (n.safariVersion = parseInt(RegExp.$1, 10))) : /Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(t) && (n.ie = !0,
            n.trident = !0,
            n.tridentVersion = parseInt(RegExp.$1, 10),
            n.ieVersion = parseInt(RegExp.$3, 10)),
            /Silk/.test(t) && (n.silk = !0),
            navigator.standalone && (n.webApp = !0),
            void 0 !== window.cordova && (n.cordova = !0),
            "undefined" != typeof process && "undefined" != typeof require && (n.node = !0),
            n.node && "object" == typeof process.versions && (n.nodeWebkit = !!process.versions["node-webkit"],
            n.electron = !!process.versions.electron),
            navigator.isCocoonJS && (n.cocoonJS = !0),
            void 0 !== window.wx && (n.wechatMinigame = !0),
            n.cocoonJS)
                try {
                    n.cocoonJSApp = "undefined" != typeof CocoonJS
                } catch (t) {
                    n.cocoonJSApp = !1
                }
            void 0 !== window.ejecta && (n.ejecta = !0),
            /Crosswalk/.test(t) && (n.crosswalk = !0)
        }(),
        function() {
            n.audioData = !!window.Audio,
            n.webAudio = !(!window.AudioContext && !window.webkitAudioContext);
            var t = document.createElement("audio");
            try {
                if (t.canPlayType && (t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/, "") && (n.ogg = !0),
                (t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/, "") || t.canPlayType("audio/opus;").replace(/^no$/, "")) && (n.opus = !0),
                t.canPlayType("audio/mpeg;").replace(/^no$/, "") && (n.mp3 = !0),
                t.canPlayType('audio/wav; codecs="1"').replace(/^no$/, "") && (n.wav = !0),
                (t.canPlayType("audio/x-m4a;") || t.canPlayType("audio/aac;").replace(/^no$/, "")) && (n.m4a = !0),
                t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/, "") && (n.webm = !0),
                "" !== t.canPlayType('audio/mp4;codecs="ec-3"')))
                    if (n.edge)
                        n.dolby = !0;
                    else if (n.safari && 9 <= n.safariVersion && /Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)) {
                        var e = parseInt(RegExp.$1, 10)
                          , i = parseInt(RegExp.$2, 10);
                        (10 === e && 11 <= i || 10 < e) && (n.dolby = !0)
                    }
            } catch (t) {}
        }(),
        function() {
            var t = document.createElement("video");
            try {
                t.canPlayType && (t.canPlayType('video/ogg; codecs="theora"').replace(/^no$/, "") && (n.oggVideo = !0),
                t.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/, "") && (n.h264Video = !0,
                n.mp4Video = !0),
                t.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/, "") && (n.webmVideo = !0),
                t.canPlayType('video/webm; codecs="vp9"').replace(/^no$/, "") && (n.vp9Video = !0),
                t.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/, "") && (n.hlsVideo = !0))
            } catch (t) {}
        }(),
        function() {
            var t, e = document.createElement("p"), i = {
                webkitTransform: "-webkit-transform",
                OTransform: "-o-transform",
                msTransform: "-ms-transform",
                MozTransform: "-moz-transform",
                transform: "transform"
            };
            for (var s in document.body.insertBefore(e, null),
            i)
                void 0 !== e.style[s] && (e.style[s] = "translate3d(1px,1px,1px)",
                t = window.getComputedStyle(e).getPropertyValue(i[s]));
            document.body.removeChild(e),
            n.css3D = void 0 !== t && 0 < t.length && "none" !== t
        }(),
        n.pixelRatio = window.devicePixelRatio || 1,
        n.iPhone = -1 !== navigator.userAgent.toLowerCase().indexOf("iphone"),
        n.iPhone4 = 2 === n.pixelRatio && n.iPhone,
        n.iPad = !!(!(s = -1 !== navigator.userAgent.toLowerCase().indexOf("ipad")) && navigator.userAgent.match(/Mac/) && navigator.maxTouchPoints && 2 < navigator.maxTouchPoints) || s,
        "undefined" != typeof Int8Array ? n.typedArray = !0 : n.typedArray = !1,
        "undefined" != typeof ArrayBuffer && "undefined" != typeof Uint8Array && "undefined" != typeof Uint32Array && (n.littleEndian = (t = new ArrayBuffer(4),
        e = new Uint8Array(t),
        i = new Uint32Array(t),
        e[0] = 161,
        e[1] = 178,
        e[2] = 195,
        e[3] = 212,
        3569595041 === i[0] || 2712847316 !== i[0] && null),
        n.LITTLE_ENDIAN = n.littleEndian),
        n.support32bit = "undefined" != typeof ArrayBuffer && "undefined" != typeof Uint8ClampedArray && "undefined" != typeof Int32Array && null !== n.littleEndian && function() {
            if (void 0 === Uint8ClampedArray)
                return !1;
            var t = PIXI.CanvasPool.create(this, 1, 1).getContext("2d");
            if (!t)
                return !1;
            var e = t.createImageData(1, 1);
            return PIXI.CanvasPool.remove(this),
            e.data instanceof Uint8ClampedArray
        }(),
        navigator.vibrate = navigator.vibrate || navigator.webkitVibrate || navigator.mozVibrate || navigator.msVibrate,
        navigator.vibrate && (n.vibration = !0),
        function() {
            n.canvas = !!window.CanvasRenderingContext2D || n.cocoonJS;
            try {
                n.localStorage = !!localStorage.getItem
            } catch (e) {
                n.localStorage = !1
            }
            n.file = !!(window.File && window.FileReader && window.FileList && window.Blob),
            n.fileSystem = !!window.requestFileSystem;
            var e = {
                stencil: !0
            };
            n.webGL = function() {
                try {
                    var t = document.createElement("canvas");
                    return t.screencanvas = !1,
                    !!window.WebGLRenderingContext && (t.getContext("webgl", e) || t.getContext("experimental-webgl", e))
                } catch (t) {
                    return !1
                }
            }(),
            n.webGL = !!n.webGL,
            n.worker = !!window.Worker,
            n.pointerLock = "pointerLockElement"in document || "mozPointerLockElement"in document || "webkitPointerLockElement"in document,
            n.quirksMode = "CSS1Compat" !== document.compatMode,
            navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || navigator.oGetUserMedia,
            window.URL = window.URL || window.webkitURL || window.mozURL || window.msURL,
            n.getUserMedia = n.getUserMedia && !!navigator.getUserMedia && !!window.URL,
            n.firefox && n.firefoxVersion < 21 && (n.getUserMedia = !1),
            !n.iOS && (n.ie || n.firefox || n.chrome) && (n.canvasBitBltShift = !0),
            (n.safari || n.mobileSafari) && (n.canvasBitBltShift = !1)
        }(),
        function() {
            for (var t = ["requestFullscreen", "requestFullScreen", "webkitRequestFullscreen", "webkitRequestFullScreen", "msRequestFullscreen", "msRequestFullScreen", "mozRequestFullScreen", "mozRequestFullscreen"], e = document.createElement("div"), i = 0; i < t.length; i++)
                if (e[t[i]]) {
                    n.fullscreen = !0,
                    n.requestFullscreen = t[i];
                    break
                }
            var s = ["cancelFullScreen", "exitFullscreen", "webkitCancelFullScreen", "webkitExitFullscreen", "msCancelFullScreen", "msExitFullscreen", "mozCancelFullScreen", "mozExitFullscreen"];
            if (n.fullscreen)
                for (i = 0; i < s.length; i++)
                    if (document[s[i]]) {
                        n.cancelFullscreen = s[i];
                        break
                    }
            window.Element && Element.ALLOW_KEYBOARD_INPUT && (n.fullscreenKeyboard = !0)
        }(),
        ("ontouchstart"in document.documentElement || window.navigator.maxTouchPoints && 1 <= window.navigator.maxTouchPoints) && (n.touch = !0),
        (window.PointerEvent || window.MSPointerEvent || window.navigator.msPointerEnabled || window.navigator.pointerEnabled) && (n.mspointer = !0),
        n.cocoonJS || ("onwheel"in window || n.ie && "WheelEvent"in window ? n.wheelEvent = "wheel" : "onmousewheel"in window ? n.wheelEvent = "mousewheel" : n.firefox && "MouseScrollEvent"in window && (n.wheelEvent = "DOMMouseScroll"))
    }
    ,
    H.Device.canPlayAudio = function(t) {
        return !!("mp3" === t && this.mp3 || "ogg" === t && (this.ogg || this.opus) || "m4a" === t && this.m4a || "opus" === t && this.opus || "wav" === t && this.wav || "webm" === t && this.webm || "mp4" === t && this.dolby)
    }
    ,
    H.Device.canPlayVideo = function(t) {
        return !!("webm" === t && (this.webmVideo || this.vp9Video) || "mp4" === t && (this.mp4Video || this.h264Video) || ("ogg" === t || "ogv" === t) && this.oggVideo || "mpeg" === t && this.hlsVideo)
    }
    ,
    H.Device.isConsoleOpen = function() {
        return !(!window.console || !window.console.firebug) || !(!window.console || (console.clear,
        !console.profiles)) && 0 < console.profiles.length
    }
    ,
    H.Device.isAndroidStockBrowser = function() {
        var t = window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);
        return t && t[1] < 537
    }
    ,
    H.Canvas = {
        create: function(t, e, i, s, n) {
            e = e || 256,
            i = i || 256;
            var r = n ? document.createElement("canvas") : PIXI.CanvasPool.create(t, e, i);
            return "string" == typeof s && "" !== s && (r.id = s),
            r.width = e,
            r.height = i,
            r.style.display = "block",
            r
        },
        setBackgroundColor: function(t, e) {
            return e = e || "rgb(0,0,0)",
            t.style.backgroundColor = e,
            t
        },
        setTouchAction: function(t, e) {
            return e = e || "none",
            t.style.msTouchAction = e,
            t.style["ms-touch-action"] = e,
            t.style["touch-action"] = e,
            t
        },
        setUserSelect: function(t, e) {
            return e = e || "none",
            t.style["-webkit-touch-callout"] = e,
            t.style["-webkit-user-select"] = e,
            t.style["-khtml-user-select"] = e,
            t.style["-moz-user-select"] = e,
            t.style["-ms-user-select"] = e,
            t.style["user-select"] = e,
            t.style["-webkit-tap-highlight-color"] = "rgba(0, 0, 0, 0)",
            t
        },
        addToDOM: function(t, e, i) {
            var s;
            return void 0 === i && (i = !0),
            e && ("string" == typeof e ? s = document.getElementById(e) : "object" == typeof e && 1 === e.nodeType && (s = e)),
            s || (s = document.body),
            i && s.style && (s.style.overflow = "hidden"),
            s.appendChild(t),
            t
        },
        removeFromDOM: function(t) {
            t.parentNode && t.parentNode.removeChild(t)
        },
        setTransform: function(t, e, i, s, n, r, o) {
            return t.setTransform(s, r, o, n, e, i),
            t
        },
        setSmoothingEnabled: function(t, e) {
            var i = H.Canvas.getSmoothingPrefix(t);
            return i && (t[i] = e),
            t
        },
        getSmoothingPrefix: function(t) {
            var e = ["i", "webkitI", "msI", "mozI", "oI"];
            for (var i in e) {
                var s = e[i] + "mageSmoothingEnabled";
                if (s in t)
                    return s
            }
            return null
        },
        getSmoothingEnabled: function(t) {
            var e = H.Canvas.getSmoothingPrefix(t);
            if (e)
                return t[e]
        },
        setImageRenderingCrisp: function(t) {
            for (var e = ["optimizeSpeed", "crisp-edges", "-moz-crisp-edges", "-webkit-optimize-contrast", "optimize-contrast", "pixelated"], i = 0; i < e.length; i++)
                t.style["image-rendering"] = e[i];
            return t.style.msInterpolationMode = "nearest-neighbor",
            t
        },
        setImageRenderingBicubic: function(t) {
            return t.style["image-rendering"] = "auto",
            t.style.msInterpolationMode = "bicubic",
            t
        }
    },
    H.RequestAnimationFrame = function(t, e) {
        void 0 === e && (e = !1),
        this.game = t,
        this.isRunning = !1,
        this.forceSetTimeOut = e;
        for (var i = ["ms", "moz", "webkit", "o"], s = 0; s < i.length && !window.requestAnimationFrame; s++)
            window.requestAnimationFrame = window[i[s] + "RequestAnimationFrame"],
            window.cancelAnimationFrame = window[i[s] + "CancelAnimationFrame"];
        this._isSetTimeOut = !1,
        this._onLoop = null,
        this._timeOutID = null
    }
    ,
    H.RequestAnimationFrame.prototype = {
        start: function() {
            this.isRunning = !0;
            var e = this;
            !window.requestAnimationFrame || this.forceSetTimeOut ? (this._isSetTimeOut = !0,
            this._onLoop = function() {
                return e.updateSetTimeout()
            }
            ,
            this._timeOutID = window.setTimeout(this._onLoop, 0)) : (this._isSetTimeOut = !1,
            this._onLoop = function(t) {
                return e.updateRAF(t)
            }
            ,
            this._timeOutID = window.requestAnimationFrame(this._onLoop))
        },
        updateRAF: function(t) {
            this.isRunning && (this.game.update(Math.floor(t)),
            this._timeOutID = window.requestAnimationFrame(this._onLoop))
        },
        updateSetTimeout: function() {
            this.isRunning && (this.game.update(Date.now()),
            this._timeOutID = window.setTimeout(this._onLoop, this.game.time.timeToCall))
        },
        stop: function() {
            this._isSetTimeOut ? clearTimeout(this._timeOutID) : window.cancelAnimationFrame(this._timeOutID),
            this.isRunning = !1
        },
        isSetTimeOut: function() {
            return this._isSetTimeOut
        },
        isRAF: function() {
            return !1 === this._isSetTimeOut
        }
    },
    H.RequestAnimationFrame.prototype.constructor = H.RequestAnimationFrame,
    H.Math = {
        PI2: 2 * Math.PI,
        between: function(t, e) {
            return Math.floor(Math.random() * (e - t + 1) + t)
        },
        fuzzyEqual: function(t, e, i) {
            return void 0 === i && (i = 1e-4),
            Math.abs(t - e) < i
        },
        fuzzyLessThan: function(t, e, i) {
            return void 0 === i && (i = 1e-4),
            t < e + i
        },
        fuzzyGreaterThan: function(t, e, i) {
            return void 0 === i && (i = 1e-4),
            e - i < t
        },
        fuzzyCeil: function(t, e) {
            return void 0 === e && (e = 1e-4),
            Math.ceil(t - e)
        },
        fuzzyFloor: function(t, e) {
            return void 0 === e && (e = 1e-4),
            Math.floor(t + e)
        },
        average: function() {
            for (var t = 0, e = arguments.length, i = 0; i < e; i++)
                t += +arguments[i];
            return t / e
        },
        shear: function(t) {
            return t % 1
        },
        snapTo: function(t, e, i) {
            return void 0 === i && (i = 0),
            0 === e ? t : (t -= i,
            i + (t = e * Math.round(t / e)))
        },
        snapToFloor: function(t, e, i) {
            return void 0 === i && (i = 0),
            0 === e ? t : (t -= i,
            i + (t = e * Math.floor(t / e)))
        },
        snapToCeil: function(t, e, i) {
            return void 0 === i && (i = 0),
            0 === e ? t : (t -= i,
            i + (t = e * Math.ceil(t / e)))
        },
        roundTo: function(t, e, i) {
            void 0 === e && (e = 0),
            void 0 === i && (i = 10);
            var s = Math.pow(i, -e);
            return Math.round(t * s) / s
        },
        floorTo: function(t, e, i) {
            void 0 === e && (e = 0),
            void 0 === i && (i = 10);
            var s = Math.pow(i, -e);
            return Math.floor(t * s) / s
        },
        ceilTo: function(t, e, i) {
            void 0 === e && (e = 0),
            void 0 === i && (i = 10);
            var s = Math.pow(i, -e);
            return Math.ceil(t * s) / s
        },
        rotateToAngle: function(t, e, i) {
            return void 0 === i && (i = .05),
            t === e || (Math.abs(e - t) <= i || Math.abs(e - t) >= H.Math.PI2 - i ? t = e : (Math.abs(e - t) > Math.PI && (e < t ? e += H.Math.PI2 : e -= H.Math.PI2),
            t < e ? t += i : e < t && (t -= i))),
            t
        },
        getShortestAngle: function(t, e) {
            var i = e - t;
            return 0 === i ? 0 : i - 360 * Math.floor((i - -180) / 360)
        },
        angleBetween: function(t, e, i, s) {
            return Math.atan2(s - e, i - t)
        },
        angleBetweenY: function(t, e, i, s) {
            return Math.atan2(i - t, s - e)
        },
        angleBetweenPoints: function(t, e) {
            return Math.atan2(e.y - t.y, e.x - t.x)
        },
        angleBetweenPointsY: function(t, e) {
            return Math.atan2(e.x - t.x, e.y - t.y)
        },
        reverseAngle: function(t) {
            return this.normalizeAngle(t + Math.PI, !0)
        },
        normalizeAngle: function(t) {
            return 0 <= (t %= 2 * Math.PI) ? t : t + 2 * Math.PI
        },
        maxAdd: function(t, e, i) {
            return Math.min(t + e, i)
        },
        minSub: function(t, e, i) {
            return Math.max(t - e, i)
        },
        wrap: function(t, e, i) {
            var s = i - e;
            if (s <= 0)
                return 0;
            var n = (t - e) % s;
            return n < 0 && (n += s),
            n + e
        },
        wrapValue: function(t, e, i) {
            return ((t = Math.abs(t)) + (e = Math.abs(e))) % (i = Math.abs(i))
        },
        isOdd: function(t) {
            return !!(1 & t)
        },
        isEven: function(t) {
            return !(1 & t)
        },
        min: function() {
            if (1 === arguments.length && "object" == typeof arguments[0])
                var t = arguments[0];
            else
                t = arguments;
            for (var e = 1, i = 0, s = t.length; e < s; e++)
                t[e] < t[i] && (i = e);
            return t[i]
        },
        max: function() {
            if (1 === arguments.length && "object" == typeof arguments[0])
                var t = arguments[0];
            else
                t = arguments;
            for (var e = 1, i = 0, s = t.length; e < s; e++)
                t[e] > t[i] && (i = e);
            return t[i]
        },
        minProperty: function(t) {
            if (2 === arguments.length && "object" == typeof arguments[1])
                var e = arguments[1];
            else
                e = arguments.slice(1);
            for (var i = 1, s = 0, n = e.length; i < n; i++)
                e[i][t] < e[s][t] && (s = i);
            return e[s][t]
        },
        maxProperty: function(t) {
            if (2 === arguments.length && "object" == typeof arguments[1])
                var e = arguments[1];
            else
                e = arguments.slice(1);
            for (var i = 1, s = 0, n = e.length; i < n; i++)
                e[i][t] > e[s][t] && (s = i);
            return e[s][t]
        },
        wrapAngle: function(t, e) {
            return e ? this.wrap(t, -Math.PI, Math.PI) : this.wrap(t, -180, 180)
        },
        linearInterpolation: function(t, e) {
            var i = t.length - 1
              , s = i * e
              , n = Math.floor(s);
            return e < 0 ? this.linear(t[0], t[1], s) : 1 < e ? this.linear(t[i], t[i - 1], i - s) : this.linear(t[n], t[i < n + 1 ? i : n + 1], s - n)
        },
        bezierInterpolation: function(t, e) {
            for (var i = 0, s = t.length - 1, n = 0; n <= s; n++)
                i += Math.pow(1 - e, s - n) * Math.pow(e, n) * t[n] * this.bernstein(s, n);
            return i
        },
        catmullRomInterpolation: function(t, e) {
            var i = t.length - 1
              , s = i * e
              , n = Math.floor(s);
            return t[0] === t[i] ? (e < 0 && (n = Math.floor(s = i * (1 + e))),
            this.catmullRom(t[(n - 1 + i) % i], t[n], t[(n + 1) % i], t[(n + 2) % i], s - n)) : e < 0 ? t[0] - (this.catmullRom(t[0], t[0], t[1], t[1], -s) - t[0]) : 1 < e ? t[i] - (this.catmullRom(t[i], t[i], t[i - 1], t[i - 1], s - i) - t[i]) : this.catmullRom(t[n ? n - 1 : 0], t[n], t[i < n + 1 ? i : n + 1], t[i < n + 2 ? i : n + 2], s - n)
        },
        linear: function(t, e, i) {
            return (e - t) * i + t
        },
        bernstein: function(t, e) {
            return this.factorial(t) / this.factorial(e) / this.factorial(t - e)
        },
        factorial: function(t) {
            if (0 === t)
                return 1;
            for (var e = t; --t; )
                e *= t;
            return e
        },
        catmullRom: function(t, e, i, s, n) {
            var r = .5 * (i - t)
              , o = .5 * (s - e)
              , a = n * n;
            return (2 * e - 2 * i + r + o) * (n * a) + (-3 * e + 3 * i - 2 * r - o) * a + r * n + e
        },
        difference: function(t, e) {
            return Math.abs(t - e)
        },
        roundAwayFromZero: function(t) {
            return 0 < t ? Math.ceil(t) : Math.floor(t)
        },
        sinCosGenerator: function(t, e, i, s) {
            void 0 === e && (e = 1),
            void 0 === i && (i = 1),
            void 0 === s && (s = 1);
            for (var n = e, r = i, o = s * Math.PI / t, a = [], h = [], l = 0; l < t; l++)
                n += (r -= n * o) * o,
                a[l] = r,
                h[l] = n;
            return {
                sin: h,
                cos: a,
                length: t
            }
        },
        distance: function(t, e, i, s) {
            var n = t - i
              , r = e - s;
            return Math.sqrt(n * n + r * r)
        },
        distanceSq: function(t, e, i, s) {
            var n = t - i
              , r = e - s;
            return n * n + r * r
        },
        distancePow: function(t, e, i, s, n) {
            return void 0 === n && (n = 2),
            Math.sqrt(Math.pow(i - t, n) + Math.pow(s - e, n))
        },
        clamp: function(t, e, i) {
            return t < e ? e : i < t ? i : t
        },
        clampBottom: function(t, e) {
            return t < e ? e : t
        },
        within: function(t, e, i) {
            return Math.abs(t - e) <= i
        },
        mapLinear: function(t, e, i, s, n) {
            return s + (t - e) * (n - s) / (i - e)
        },
        smoothstep: function(t, e, i) {
            return (t = Math.max(0, Math.min(1, (t - e) / (i - e)))) * t * (3 - 2 * t)
        },
        smootherstep: function(t, e, i) {
            return (t = Math.max(0, Math.min(1, (t - e) / (i - e)))) * t * t * (t * (6 * t - 15) + 10)
        },
        sign: function(t) {
            return t < 0 ? -1 : 0 < t ? 1 : 0
        },
        percent: function(t, e, i) {
            return void 0 === i && (i = 0),
            e < t || e < i ? 1 : t < i || t < i ? 0 : (t - i) / e
        }
    };
    var o = Math.PI / 180
      , a = 180 / Math.PI;
    return H.Math.degToRad = function(t) {
        return t * o
    }
    ,
    H.Math.radToDeg = function(t) {
        return t * a
    }
    ,
    H.RandomDataGenerator = function(t) {
        void 0 === t && (t = []),
        this.c = 1,
        this.s0 = 0,
        this.s1 = 0,
        this.s2 = 0,
        "string" == typeof t ? this.state(t) : this.sow(t)
    }
    ,
    H.RandomDataGenerator.prototype = {
        rnd: function() {
            var t = 2091639 * this.s0 + 2.3283064365386963e-10 * this.c;
            return this.c = 0 | t,
            this.s0 = this.s1,
            this.s1 = this.s2,
            this.s2 = t - this.c,
            this.s2
        },
        sow: function(t) {
            if (this.s0 = this.hash(" "),
            this.s1 = this.hash(this.s0),
            this.s2 = this.hash(this.s1),
            this.c = 1,
            t)
                for (var e = 0; e < t.length && null != t[e]; e++) {
                    var i = t[e];
                    this.s0 -= this.hash(i),
                    this.s0 += ~~(this.s0 < 0),
                    this.s1 -= this.hash(i),
                    this.s1 += ~~(this.s1 < 0),
                    this.s2 -= this.hash(i),
                    this.s2 += ~~(this.s2 < 0)
                }
        },
        hash: function(t) {
            var e, i, s;
            for (s = 4022871197,
            t = t.toString(),
            i = 0; i < t.length; i++)
                e = .02519603282416938 * (s += t.charCodeAt(i)),
                e -= s = e >>> 0,
                s = (e *= s) >>> 0,
                s += 4294967296 * (e -= s);
            return 2.3283064365386963e-10 * (s >>> 0)
        },
        integer: function() {
            return 4294967296 * this.rnd.apply(this)
        },
        frac: function() {
            return this.rnd.apply(this) + 11102230246251565e-32 * (2097152 * this.rnd.apply(this) | 0)
        },
        real: function() {
            return this.integer() + this.frac()
        },
        integerInRange: function(t, e) {
            return Math.floor(this.realInRange(0, e - t + 1) + t)
        },
        between: function(t, e) {
            return this.integerInRange(t, e)
        },
        realInRange: function(t, e) {
            return this.frac() * (e - t) + t
        },
        normal: function() {
            return 1 - 2 * this.frac()
        },
        uuid: function() {
            var t = ""
              , e = "";
            for (e = t = ""; t++ < 36; e += ~t % 5 | 3 * t & 4 ? (15 ^ t ? 8 ^ this.frac() * (20 ^ t ? 16 : 4) : 4).toString(16) : "-")
                ;
            return e
        },
        pick: function(t) {
            return t[this.integerInRange(0, t.length - 1)]
        },
        sign: function() {
            return this.pick([-1, 1])
        },
        weightedPick: function(t) {
            return t[~~(Math.pow(this.frac(), 2) * (t.length - 1) + .5)]
        },
        timestamp: function(t, e) {
            return this.realInRange(t || 9466848e5, e || 1577862e6)
        },
        angle: function() {
            return this.integerInRange(-180, 180)
        },
        state: function(t) {
            return "string" == typeof t && t.match(/^!rnd/) && (t = t.split(","),
            this.c = parseFloat(t[1]),
            this.s0 = parseFloat(t[2]),
            this.s1 = parseFloat(t[3]),
            this.s2 = parseFloat(t[4])),
            ["!rnd", this.c, this.s0, this.s1, this.s2].join(",")
        }
    },
    H.RandomDataGenerator.prototype.constructor = H.RandomDataGenerator,
    H.QuadTree = function(t, e, i, s, n, r, o) {
        this.maxObjects = 10,
        this.maxLevels = 4,
        this.level = 0,
        this.bounds = {},
        this.objects = [],
        this.nodes = [],
        this._empty = [],
        this.reset(t, e, i, s, n, r, o)
    }
    ,
    H.QuadTree.prototype = {
        reset: function(t, e, i, s, n, r, o) {
            this.maxObjects = n || 10,
            this.maxLevels = r || 4,
            this.level = o || 0,
            this.bounds = {
                x: Math.round(t),
                y: Math.round(e),
                width: i,
                height: s,
                subWidth: Math.floor(i / 2),
                subHeight: Math.floor(s / 2),
                right: Math.round(t) + Math.floor(i / 2),
                bottom: Math.round(e) + Math.floor(s / 2)
            },
            this.objects.length = 0,
            this.nodes.length = 0
        },
        populate: function(t) {
            t.forEach(this.populateHandler, this, !0)
        },
        populateHandler: function(t) {
            t.body && t.exists && this.insert(t.body)
        },
        split: function() {
            this.nodes[0] = new H.QuadTree(this.bounds.right,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level + 1),
            this.nodes[1] = new H.QuadTree(this.bounds.x,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level + 1),
            this.nodes[2] = new H.QuadTree(this.bounds.x,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level + 1),
            this.nodes[3] = new H.QuadTree(this.bounds.right,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level + 1)
        },
        insert: function(t) {
            var e, i = 0;
            if (null == this.nodes[0] || -1 === (e = this.getIndex(t))) {
                if (this.objects.push(t),
                this.objects.length > this.maxObjects && this.level < this.maxLevels)
                    for (null == this.nodes[0] && this.split(); i < this.objects.length; )
                        -1 !== (e = this.getIndex(this.objects[i])) ? this.nodes[e].insert(this.objects.splice(i, 1)[0]) : i++
            } else
                this.nodes[e].insert(t)
        },
        getIndex: function(t) {
            var e = -1;
            return t.x < this.bounds.right && t.right < this.bounds.right ? t.y < this.bounds.bottom && t.bottom < this.bounds.bottom ? e = 1 : t.y > this.bounds.bottom && (e = 2) : t.x > this.bounds.right && (t.y < this.bounds.bottom && t.bottom < this.bounds.bottom ? e = 0 : t.y > this.bounds.bottom && (e = 3)),
            e
        },
        retrieve: function(t) {
            if (t instanceof H.Rectangle)
                var e = this.objects
                  , i = this.getIndex(t);
            else {
                if (!t.body)
                    return this._empty;
                e = this.objects,
                i = this.getIndex(t.body)
            }
            return this.nodes[0] && (e = -1 !== i ? e.concat(this.nodes[i].retrieve(t)) : (e = (e = (e = e.concat(this.nodes[0].retrieve(t))).concat(this.nodes[1].retrieve(t))).concat(this.nodes[2].retrieve(t))).concat(this.nodes[3].retrieve(t))),
            e
        },
        clear: function() {
            this.objects.length = 0;
            for (var t = this.nodes.length; t--; )
                this.nodes[t].clear(),
                this.nodes.splice(t, 1);
            this.nodes.length = 0
        }
    },
    H.QuadTree.prototype.constructor = H.QuadTree,
    H.Net = function(t) {
        this.game = t
    }
    ,
    H.Net.prototype = {
        getHostName: function() {
            return window.location && window.location.hostname ? window.location.hostname : null
        },
        checkDomainName: function(t) {
            return -1 !== window.location.hostname.indexOf(t)
        },
        updateQueryString: function(t, e, i, s) {
            void 0 === i && (i = !1),
            void 0 !== s && "" !== s || (s = window.location.href);
            var n = ""
              , r = new RegExp("([?|&])" + t + "=.*?(&|#|$)(.*)","gi");
            if (r.test(s))
                n = null != e ? s.replace(r, "$1" + t + "=" + e + "$2$3") : s.replace(r, "$1$3").replace(/(&|\?)$/, "");
            else if (null != e) {
                var o = -1 !== s.indexOf("?") ? "&" : "?"
                  , a = s.split("#");
                s = a[0] + o + t + "=" + e,
                a[1] && (s += "#" + a[1]),
                n = s
            } else
                n = s;
            if (!i)
                return n;
            window.location.href = n
        },
        getQueryString: function(t) {
            void 0 === t && (t = "");
            var e = {}
              , i = location.search.substring(1).split("&");
            for (var s in i) {
                var n = i[s].split("=");
                if (1 < n.length) {
                    if (t && t === this.decodeURI(n[0]))
                        return this.decodeURI(n[1]);
                    e[this.decodeURI(n[0])] = this.decodeURI(n[1])
                }
            }
            return e
        },
        decodeURI: function(t) {
            return decodeURIComponent(t.replace(/\+/g, " "))
        }
    },
    H.Net.prototype.constructor = H.Net,
    H.TweenManager = function(t) {
        this.game = t,
        this.frameBased = !1,
        this._tweens = [],
        this._add = [],
        this.easeMap = {
            Power0: H.Easing.Power0,
            Power1: H.Easing.Power1,
            Power2: H.Easing.Power2,
            Power3: H.Easing.Power3,
            Power4: H.Easing.Power4,
            Linear: H.Easing.Linear.None,
            Quad: H.Easing.Quadratic.Out,
            Cubic: H.Easing.Cubic.Out,
            Quart: H.Easing.Quartic.Out,
            Quint: H.Easing.Quintic.Out,
            Sine: H.Easing.Sinusoidal.Out,
            Expo: H.Easing.Exponential.Out,
            Circ: H.Easing.Circular.Out,
            Elastic: H.Easing.Elastic.Out,
            Back: H.Easing.Back.Out,
            Bounce: H.Easing.Bounce.Out,
            "Quad.easeIn": H.Easing.Quadratic.In,
            "Cubic.easeIn": H.Easing.Cubic.In,
            "Quart.easeIn": H.Easing.Quartic.In,
            "Quint.easeIn": H.Easing.Quintic.In,
            "Sine.easeIn": H.Easing.Sinusoidal.In,
            "Expo.easeIn": H.Easing.Exponential.In,
            "Circ.easeIn": H.Easing.Circular.In,
            "Elastic.easeIn": H.Easing.Elastic.In,
            "Back.easeIn": H.Easing.Back.In,
            "Bounce.easeIn": H.Easing.Bounce.In,
            "Quad.easeOut": H.Easing.Quadratic.Out,
            "Cubic.easeOut": H.Easing.Cubic.Out,
            "Quart.easeOut": H.Easing.Quartic.Out,
            "Quint.easeOut": H.Easing.Quintic.Out,
            "Sine.easeOut": H.Easing.Sinusoidal.Out,
            "Expo.easeOut": H.Easing.Exponential.Out,
            "Circ.easeOut": H.Easing.Circular.Out,
            "Elastic.easeOut": H.Easing.Elastic.Out,
            "Back.easeOut": H.Easing.Back.Out,
            "Bounce.easeOut": H.Easing.Bounce.Out,
            "Quad.easeInOut": H.Easing.Quadratic.InOut,
            "Cubic.easeInOut": H.Easing.Cubic.InOut,
            "Quart.easeInOut": H.Easing.Quartic.InOut,
            "Quint.easeInOut": H.Easing.Quintic.InOut,
            "Sine.easeInOut": H.Easing.Sinusoidal.InOut,
            "Expo.easeInOut": H.Easing.Exponential.InOut,
            "Circ.easeInOut": H.Easing.Circular.InOut,
            "Elastic.easeInOut": H.Easing.Elastic.InOut,
            "Back.easeInOut": H.Easing.Back.InOut,
            "Bounce.easeInOut": H.Easing.Bounce.InOut
        },
        this.game.onPause.add(this._pauseAll, this),
        this.game.onResume.add(this._resumeAll, this)
    }
    ,
    H.TweenManager.prototype = {
        getAll: function() {
            return this._tweens
        },
        removeAll: function() {
            for (var t = 0; t < this._tweens.length; t++)
                this._tweens[t].pendingDelete = !0;
            this._add = []
        },
        removeFrom: function(t, e) {
            if (void 0 === e && (e = !0),
            Array.isArray(t))
                for (i = 0,
                s = t.length; i < s; i++)
                    this.removeFrom(t[i]);
            else if (t.type === H.GROUP && e)
                for (var i = 0, s = t.children.length; i < s; i++)
                    this.removeFrom(t.children[i]);
            else {
                for (i = 0,
                s = this._tweens.length; i < s; i++)
                    t === this._tweens[i].target && this.remove(this._tweens[i]);
                for (i = 0,
                s = this._add.length; i < s; i++)
                    t === this._add[i].target && this.remove(this._add[i])
            }
        },
        add: function(t) {
            (t._manager = this)._add.push(t)
        },
        create: function(t) {
            return new H.Tween(t,this.game,this)
        },
        remove: function(t) {
            var e = this._tweens.indexOf(t);
            -1 !== e ? this._tweens[e].pendingDelete = !0 : -1 !== (e = this._add.indexOf(t)) && (this._add[e].pendingDelete = !0)
        },
        update: function() {
            var t = this._add.length
              , e = this._tweens.length;
            if (0 === e && 0 === t)
                return !1;
            for (var i = 0; i < e; )
                this._tweens[i].update(this.game.time.time) ? i++ : (this._tweens.splice(i, 1),
                e--);
            return 0 < t && (this._tweens = this._tweens.concat(this._add),
            this._add.length = 0),
            !0
        },
        isTweening: function(e) {
            return this._tweens.some(function(t) {
                return t.target === e
            })
        },
        _pauseAll: function() {
            for (var t = this._tweens.length - 1; 0 <= t; t--)
                this._tweens[t]._pause()
        },
        _resumeAll: function() {
            for (var t = this._tweens.length - 1; 0 <= t; t--)
                this._tweens[t]._resume()
        },
        pauseAll: function() {
            for (var t = this._tweens.length - 1; 0 <= t; t--)
                this._tweens[t].pause()
        },
        resumeAll: function() {
            for (var t = this._tweens.length - 1; 0 <= t; t--)
                this._tweens[t].resume(!0)
        }
    },
    H.TweenManager.prototype.constructor = H.TweenManager,
    H.Tween = function(t, e, i) {
        this.game = e,
        this.target = t,
        this.manager = i,
        this.timeline = [],
        this.reverse = !1,
        this.timeScale = 1,
        this.repeatCounter = 0,
        this.pendingDelete = !1,
        this.onStart = new H.Signal,
        this.onLoop = new H.Signal,
        this.onRepeat = new H.Signal,
        this.onChildComplete = new H.Signal,
        this.onComplete = new H.Signal,
        this.isRunning = !1,
        this.current = 0,
        this.properties = {},
        this.chainedTween = null,
        this.isPaused = !1,
        this.frameBased = i.frameBased,
        this._onUpdateCallback = null,
        this._onUpdateCallbackContext = null,
        this._pausedTime = 0,
        this._codePaused = !1,
        this._hasStarted = !1
    }
    ,
    H.Tween.prototype = {
        to: function(t, e, i, s, n, r, o) {
            return (void 0 === e || e <= 0) && (e = 1e3),
            null != i || (i = H.Easing.Default),
            void 0 === s && (s = !1),
            void 0 === n && (n = 0),
            void 0 === r && (r = 0),
            void 0 === o && (o = !1),
            "string" == typeof i && this.manager.easeMap[i] && (i = this.manager.easeMap[i]),
            this.isRunning || (this.timeline.push(new H.TweenData(this).to(t, e, i, n, r, o)),
            s && this.start()),
            this
        },
        from: function(t, e, i, s, n, r, o) {
            return void 0 === e && (e = 1e3),
            null != i || (i = H.Easing.Default),
            void 0 === s && (s = !1),
            void 0 === n && (n = 0),
            void 0 === r && (r = 0),
            void 0 === o && (o = !1),
            "string" == typeof i && this.manager.easeMap[i] && (i = this.manager.easeMap[i]),
            this.isRunning || (this.timeline.push(new H.TweenData(this).from(t, e, i, n, r, o)),
            s && this.start()),
            this
        },
        start: function(t) {
            if (void 0 === t && (t = 0),
            null === this.game || null === this.target || 0 === this.timeline.length || this.isRunning)
                return this;
            for (var e = 0; e < this.timeline.length; e++)
                for (var i in this.timeline[e].vEnd)
                    this.properties[i] = this.target[i] || 0,
                    Array.isArray(this.properties[i]) || (this.properties[i] *= 1);
            for (e = 0; e < this.timeline.length; e++)
                this.timeline[e].loadValues();
            return this.manager.add(this),
            this.isRunning = !0,
            (t < 0 || t > this.timeline.length - 1) && (t = 0),
            this.current = t,
            this.timeline[this.current].start(),
            this
        },
        stop: function(t) {
            return void 0 === t && (t = !1),
            this.isRunning = !1,
            this._onUpdateCallback = null,
            this._onUpdateCallbackContext = null,
            t && (this.onComplete.dispatch(this.target, this),
            this._hasStarted = !1,
            this.chainedTween && this.chainedTween.start()),
            this.manager.remove(this),
            this
        },
        updateTweenData: function(t, e, i) {
            if (0 === this.timeline.length)
                return this;
            if (void 0 === i && (i = 0),
            -1 === i)
                for (var s = 0; s < this.timeline.length; s++)
                    this.timeline[s][t] = e;
            else
                this.timeline[i][t] = e;
            return this
        },
        delay: function(t, e) {
            return this.updateTweenData("delay", t, e)
        },
        repeat: function(t, e, i) {
            return void 0 === e && (e = 0),
            this.updateTweenData("repeatCounter", t, i),
            this.updateTweenData("repeatDelay", e, i)
        },
        repeatDelay: function(t, e) {
            return this.updateTweenData("repeatDelay", t, e)
        },
        yoyo: function(t, e, i) {
            return void 0 === e && (e = 0),
            this.updateTweenData("yoyo", t, i),
            this.updateTweenData("yoyoDelay", e, i)
        },
        yoyoDelay: function(t, e) {
            return this.updateTweenData("yoyoDelay", t, e)
        },
        easing: function(t, e) {
            return "string" == typeof t && this.manager.easeMap[t] && (t = this.manager.easeMap[t]),
            this.updateTweenData("easingFunction", t, e)
        },
        interpolation: function(t, e, i) {
            return void 0 === e && (e = H.Math),
            this.updateTweenData("interpolationFunction", t, i),
            this.updateTweenData("interpolationContext", e, i)
        },
        repeatAll: function(t) {
            return void 0 === t && (t = 0),
            this.repeatCounter = t,
            this
        },
        chain: function() {
            for (var t = arguments.length; t--; )
                0 < t ? arguments[t - 1].chainedTween = arguments[t] : this.chainedTween = arguments[t];
            return this
        },
        loop: function(t) {
            return void 0 === t && (t = !0),
            this.repeatCounter = t ? -1 : 0,
            this
        },
        onUpdateCallback: function(t, e) {
            return this._onUpdateCallback = t,
            this._onUpdateCallbackContext = e,
            this
        },
        pause: function() {
            this.isPaused = !0,
            this._codePaused = !0,
            this._pausedTime = this.game.time.time
        },
        _pause: function() {
            this._codePaused || (this.isPaused = !0,
            this._pausedTime = this.game.time.time)
        },
        resume: function() {
            if (this.isPaused) {
                this.isPaused = !1,
                this._codePaused = !1;
                for (var t = 0; t < this.timeline.length; t++)
                    this.timeline[t].isRunning || (this.timeline[t].startTime += this.game.time.time - this._pausedTime)
            }
        },
        _resume: function() {
            this._codePaused || this.resume()
        },
        update: function(t) {
            if (this.pendingDelete || !this.target)
                return !1;
            if (this.isPaused)
                return !0;
            var e = this.timeline[this.current].update(t);
            if (e === H.TweenData.PENDING)
                return !0;
            if (e === H.TweenData.RUNNING)
                return this._hasStarted || (this.onStart.dispatch(this.target, this),
                this._hasStarted = !0),
                null !== this._onUpdateCallback && this._onUpdateCallback.call(this._onUpdateCallbackContext, this, this.timeline[this.current].value, this.timeline[this.current]),
                this.isRunning;
            if (e === H.TweenData.LOOPED)
                return -1 === this.timeline[this.current].repeatCounter ? this.onLoop.dispatch(this.target, this) : this.onRepeat.dispatch(this.target, this),
                !0;
            if (e === H.TweenData.COMPLETE) {
                var i = !1;
                return this.reverse ? --this.current < 0 && (this.current = this.timeline.length - 1,
                i = !0) : ++this.current === this.timeline.length && (i = !(this.current = 0)),
                i ? -1 === this.repeatCounter ? (this.timeline[this.current].start(),
                this.onLoop.dispatch(this.target, this),
                !0) : 0 < this.repeatCounter ? (this.repeatCounter--,
                this.timeline[this.current].start(),
                this.onRepeat.dispatch(this.target, this),
                !0) : (this.isRunning = !1,
                this.onComplete.dispatch(this.target, this),
                this._hasStarted = !1,
                this.chainedTween && this.chainedTween.start(),
                !1) : (this.onChildComplete.dispatch(this.target, this),
                this.timeline[this.current].start(),
                !0)
            }
        },
        generateData: function(t, e) {
            if (null === this.game || null === this.target)
                return null;
            void 0 === t && (t = 60),
            void 0 === e && (e = []);
            for (var i = 0; i < this.timeline.length; i++)
                for (var s in this.timeline[i].vEnd)
                    this.properties[s] = this.target[s] || 0,
                    Array.isArray(this.properties[s]) || (this.properties[s] *= 1);
            for (i = 0; i < this.timeline.length; i++)
                this.timeline[i].loadValues();
            for (i = 0; i < this.timeline.length; i++)
                e = e.concat(this.timeline[i].generateData(t));
            return e
        }
    },
    Object.defineProperty(H.Tween.prototype, "totalDuration", {
        get: function() {
            for (var t = 0, e = 0; e < this.timeline.length; e++)
                t += this.timeline[e].duration;
            return t
        }
    }),
    H.Tween.prototype.constructor = H.Tween,
    H.TweenData = function(t) {
        this.parent = t,
        this.game = t.game,
        this.vStart = {},
        this.vStartCache = {},
        this.vEnd = {},
        this.vEndCache = {},
        this.duration = 1e3,
        this.percent = 0,
        this.value = 0,
        this.repeatCounter = 0,
        this.repeatDelay = 0,
        this.repeatTotal = 0,
        this.interpolate = !1,
        this.yoyo = !1,
        this.yoyoDelay = 0,
        this.inReverse = !1,
        this.delay = 0,
        this.dt = 0,
        this.startTime = null,
        this.easingFunction = H.Easing.Default,
        this.interpolationFunction = H.Math.linearInterpolation,
        this.interpolationContext = H.Math,
        this.isRunning = !1,
        this.isFrom = !1
    }
    ,
    H.TweenData.PENDING = 0,
    H.TweenData.RUNNING = 1,
    H.TweenData.LOOPED = 2,
    H.TweenData.COMPLETE = 3,
    H.TweenData.prototype = {
        to: function(t, e, i, s, n, r) {
            return this.vEnd = t,
            this.duration = e,
            this.easingFunction = i,
            this.delay = s,
            this.repeatTotal = n,
            this.yoyo = r,
            this.isFrom = !1,
            this
        },
        from: function(t, e, i, s, n, r) {
            return this.vEnd = t,
            this.duration = e,
            this.easingFunction = i,
            this.delay = s,
            this.repeatTotal = n,
            this.yoyo = r,
            this.isFrom = !0,
            this
        },
        start: function() {
            if (this.startTime = this.game.time.time + this.delay,
            this.parent.reverse ? this.dt = this.duration : this.dt = 0,
            0 < this.delay ? this.isRunning = !1 : this.isRunning = !0,
            this.isFrom)
                for (var t in this.vStartCache)
                    this.vStart[t] = this.vEndCache[t],
                    this.vEnd[t] = this.vStartCache[t],
                    this.parent.target[t] = this.vStart[t];
            return this.value = 0,
            this.yoyoCounter = 0,
            this.repeatCounter = this.repeatTotal,
            this
        },
        loadValues: function() {
            for (var t in this.parent.properties) {
                if (this.vStart[t] = this.parent.properties[t],
                Array.isArray(this.vEnd[t])) {
                    if (0 === this.vEnd[t].length)
                        continue;
                    0 === this.percent && (this.vEnd[t] = [this.vStart[t]].concat(this.vEnd[t]))
                }
                void 0 !== this.vEnd[t] ? ("string" == typeof this.vEnd[t] && (this.vEnd[t] = this.vStart[t] + parseFloat(this.vEnd[t], 10)),
                this.parent.properties[t] = this.vEnd[t]) : this.vEnd[t] = this.vStart[t],
                this.vStartCache[t] = this.vStart[t],
                this.vEndCache[t] = this.vEnd[t]
            }
            return this
        },
        update: function(t) {
            if (this.isRunning) {
                if (t < this.startTime)
                    return H.TweenData.RUNNING
            } else {
                if (!(t >= this.startTime))
                    return H.TweenData.PENDING;
                this.isRunning = !0
            }
            var e = this.parent.frameBased ? this.game.time.physicsElapsedMS : this.game.time.elapsedMS;
            for (var i in this.parent.reverse ? (this.dt -= e * this.parent.timeScale,
            this.dt = Math.max(this.dt, 0)) : (this.dt += e * this.parent.timeScale,
            this.dt = Math.min(this.dt, this.duration)),
            this.percent = this.dt / this.duration,
            this.value = this.easingFunction(this.percent),
            this.vEnd) {
                var s = this.vStart[i]
                  , n = this.vEnd[i];
                Array.isArray(n) ? this.parent.target[i] = this.interpolationFunction.call(this.interpolationContext, n, this.value) : this.parent.target[i] = s + (n - s) * this.value
            }
            return !this.parent.reverse && 1 === this.percent || this.parent.reverse && 0 === this.percent ? this.repeat() : H.TweenData.RUNNING
        },
        generateData: function(t) {
            this.parent.reverse ? this.dt = this.duration : this.dt = 0;
            var e = []
              , i = !1
              , s = 1 / t * 1e3;
            do {
                this.parent.reverse ? (this.dt -= s,
                this.dt = Math.max(this.dt, 0)) : (this.dt += s,
                this.dt = Math.min(this.dt, this.duration)),
                this.percent = this.dt / this.duration,
                this.value = this.easingFunction(this.percent);
                var n = {};
                for (var r in this.vEnd) {
                    var o = this.vStart[r]
                      , a = this.vEnd[r];
                    Array.isArray(a) ? n[r] = this.interpolationFunction(a, this.value) : n[r] = o + (a - o) * this.value
                }
                e.push(n),
                (!this.parent.reverse && 1 === this.percent || this.parent.reverse && 0 === this.percent) && (i = !0)
            } while (!i);
            if (this.yoyo) {
                var h = e.slice();
                h.reverse(),
                e = e.concat(h)
            }
            return e
        },
        repeat: function() {
            if (this.yoyo) {
                if (this.inReverse && 0 === this.repeatCounter) {
                    for (var t in this.vStartCache)
                        this.vStart[t] = this.vStartCache[t],
                        this.vEnd[t] = this.vEndCache[t];
                    return this.inReverse = !1,
                    H.TweenData.COMPLETE
                }
                this.inReverse = !this.inReverse
            } else if (0 === this.repeatCounter)
                return H.TweenData.COMPLETE;
            if (this.inReverse)
                for (var t in this.vStartCache)
                    this.vStart[t] = this.vEndCache[t],
                    this.vEnd[t] = this.vStartCache[t];
            else {
                for (var t in this.vStartCache)
                    this.vStart[t] = this.vStartCache[t],
                    this.vEnd[t] = this.vEndCache[t];
                0 < this.repeatCounter && this.repeatCounter--
            }
            return this.startTime = this.game.time.time,
            this.yoyo && this.inReverse ? this.startTime += this.yoyoDelay : this.inReverse || (this.startTime += this.repeatDelay),
            this.parent.reverse ? this.dt = this.duration : this.dt = 0,
            H.TweenData.LOOPED
        }
    },
    H.TweenData.prototype.constructor = H.TweenData,
    H.Easing = {
        Linear: {
            None: function(t) {
                return t
            }
        },
        Quadratic: {
            In: function(t) {
                return t * t
            },
            Out: function(t) {
                return t * (2 - t)
            },
            InOut: function(t) {
                return (t *= 2) < 1 ? .5 * t * t : -.5 * (--t * (t - 2) - 1)
            }
        },
        Cubic: {
            In: function(t) {
                return t * t * t
            },
            Out: function(t) {
                return --t * t * t + 1
            },
            InOut: function(t) {
                return (t *= 2) < 1 ? .5 * t * t * t : .5 * ((t -= 2) * t * t + 2)
            }
        },
        Quartic: {
            In: function(t) {
                return t * t * t * t
            },
            Out: function(t) {
                return 1 - --t * t * t * t
            },
            InOut: function(t) {
                return (t *= 2) < 1 ? .5 * t * t * t * t : -.5 * ((t -= 2) * t * t * t - 2)
            }
        },
        Quintic: {
            In: function(t) {
                return t * t * t * t * t
            },
            Out: function(t) {
                return --t * t * t * t * t + 1
            },
            InOut: function(t) {
                return (t *= 2) < 1 ? .5 * t * t * t * t * t : .5 * ((t -= 2) * t * t * t * t + 2)
            }
        },
        Sinusoidal: {
            In: function(t) {
                return 0 === t ? 0 : 1 === t ? 1 : 1 - Math.cos(t * Math.PI / 2)
            },
            Out: function(t) {
                return 0 === t ? 0 : 1 === t ? 1 : Math.sin(t * Math.PI / 2)
            },
            InOut: function(t) {
                return 0 === t ? 0 : 1 === t ? 1 : .5 * (1 - Math.cos(Math.PI * t))
            }
        },
        Exponential: {
            In: function(t) {
                return 0 === t ? 0 : Math.pow(1024, t - 1)
            },
            Out: function(t) {
                return 1 === t ? 1 : 1 - Math.pow(2, -10 * t)
            },
            InOut: function(t) {
                return 0 === t ? 0 : 1 === t ? 1 : (t *= 2) < 1 ? .5 * Math.pow(1024, t - 1) : .5 * (2 - Math.pow(2, -10 * (t - 1)))
            }
        },
        Circular: {
            In: function(t) {
                return 1 - Math.sqrt(1 - t * t)
            },
            Out: function(t) {
                return Math.sqrt(1 - --t * t)
            },
            InOut: function(t) {
                return (t *= 2) < 1 ? -.5 * (Math.sqrt(1 - t * t) - 1) : .5 * (Math.sqrt(1 - (t -= 2) * t) + 1)
            }
        },
        Elastic: {
            In: function(t) {
                var e, i = .1;
                return 0 === t ? 0 : 1 === t ? 1 : (e = !i || i < 1 ? (i = 1,
                .1) : .4 * Math.asin(1 / i) / (2 * Math.PI),
                -i * Math.pow(2, 10 * (t -= 1)) * Math.sin((t - e) * (2 * Math.PI) / .4))
            },
            Out: function(t) {
                var e, i = .1;
                return 0 === t ? 0 : 1 === t ? 1 : (e = !i || i < 1 ? (i = 1,
                .1) : .4 * Math.asin(1 / i) / (2 * Math.PI),
                i * Math.pow(2, -10 * t) * Math.sin((t - e) * (2 * Math.PI) / .4) + 1)
            },
            InOut: function(t) {
                var e, i = .1;
                return 0 === t ? 0 : 1 === t ? 1 : (e = !i || i < 1 ? (i = 1,
                .1) : .4 * Math.asin(1 / i) / (2 * Math.PI),
                (t *= 2) < 1 ? i * Math.pow(2, 10 * (t -= 1)) * Math.sin((t - e) * (2 * Math.PI) / .4) * -.5 : i * Math.pow(2, -10 * (t -= 1)) * Math.sin((t - e) * (2 * Math.PI) / .4) * .5 + 1)
            }
        },
        Back: {
            In: function(t) {
                return t * t * (2.70158 * t - 1.70158)
            },
            Out: function(t) {
                return --t * t * (2.70158 * t + 1.70158) + 1
            },
            InOut: function(t) {
                var e = 2.5949095;
                return (t *= 2) < 1 ? t * t * ((e + 1) * t - e) * .5 : .5 * ((t -= 2) * t * ((e + 1) * t + e) + 2)
            }
        },
        Bounce: {
            In: function(t) {
                return 1 - H.Easing.Bounce.Out(1 - t)
            },
            Out: function(t) {
                return t < 1 / 2.75 ? 7.5625 * t * t : t < 2 / 2.75 ? 7.5625 * (t -= 1.5 / 2.75) * t + .75 : t < 2.5 / 2.75 ? 7.5625 * (t -= 2.25 / 2.75) * t + .9375 : 7.5625 * (t -= 2.625 / 2.75) * t + .984375
            },
            InOut: function(t) {
                return t < .5 ? .5 * H.Easing.Bounce.In(2 * t) : .5 * H.Easing.Bounce.Out(2 * t - 1) + .5
            }
        }
    },
    H.Easing.Default = H.Easing.Linear.None,
    H.Easing.Power0 = H.Easing.Linear.None,
    H.Easing.Power1 = H.Easing.Quadratic.Out,
    H.Easing.Power2 = H.Easing.Cubic.Out,
    H.Easing.Power3 = H.Easing.Quartic.Out,
    H.Easing.Power4 = H.Easing.Quintic.Out,
    H.Time = function(t) {
        this.game = t,
        this.time = 0,
        this.prevTime = 0,
        this.now = 0,
        this.elapsed = 0,
        this.elapsedMS = 0,
        this.physicsElapsed = 1 / 60,
        this.physicsElapsedMS = 1 / 60 * 1e3,
        this.desiredFpsMult = 1 / 60,
        this._desiredFps = 60,
        this.suggestedFps = this.desiredFps,
        this.slowMotion = 1,
        this.advancedTiming = !1,
        this.frames = 0,
        this.fps = 0,
        this.fpsMin = 1e3,
        this.fpsMax = 0,
        this.msMin = 1e3,
        this.msMax = 0,
        this.pauseDuration = 0,
        this.timeToCall = 0,
        this.timeExpected = 0,
        this.events = new H.Timer(this.game,!1),
        this._frameCount = 0,
        this._elapsedAccumulator = 0,
        this._started = 0,
        this._timeLastSecond = 0,
        this._pauseStarted = 0,
        this._justResumed = !1,
        this._timers = []
    }
    ,
    H.Time.prototype = {
        boot: function() {
            this._started = Date.now(),
            this.time = Date.now(),
            this.events.start(),
            this.timeExpected = this.time
        },
        add: function(t) {
            return this._timers.push(t),
            t
        },
        create: function(t) {
            void 0 === t && (t = !0);
            var e = new H.Timer(this.game,t);
            return this._timers.push(e),
            e
        },
        removeAll: function() {
            for (var t = 0; t < this._timers.length; t++)
                this._timers[t].destroy();
            this._timers = [],
            this.events.removeAll()
        },
        refresh: function() {
            var t = this.time;
            this.time = Date.now(),
            this.elapsedMS = this.time - t
        },
        update: function(t) {
            var e = this.time;
            this.time = Date.now(),
            this.elapsedMS = this.time - e,
            this.prevTime = this.now,
            this.now = t,
            this.elapsed = this.now - this.prevTime,
            this.game.raf._isSetTimeOut && (this.timeToCall = Math.floor(Math.max(0, 1e3 / this._desiredFps - (this.timeExpected - t))),
            this.timeExpected = t + this.timeToCall),
            this.advancedTiming && this.updateAdvancedTiming(),
            this.game.paused || (this.events.update(this.time),
            this._timers.length && this.updateTimers())
        },
        updateTimers: function() {
            for (var t = 0, e = this._timers.length; t < e; )
                this._timers[t].update(this.time) ? t++ : (this._timers.splice(t, 1),
                e--)
        },
        updateAdvancedTiming: function() {
            this._frameCount++,
            this._elapsedAccumulator += this.elapsed,
            this._frameCount >= 2 * this._desiredFps && (this.suggestedFps = 5 * Math.floor(200 / (this._elapsedAccumulator / this._frameCount)),
            this._frameCount = 0,
            this._elapsedAccumulator = 0),
            this.msMin = Math.min(this.msMin, this.elapsed),
            this.msMax = Math.max(this.msMax, this.elapsed),
            this.frames++,
            this.now > this._timeLastSecond + 1e3 && (this.fps = Math.round(1e3 * this.frames / (this.now - this._timeLastSecond)),
            this.fpsMin = Math.min(this.fpsMin, this.fps),
            this.fpsMax = Math.max(this.fpsMax, this.fps),
            this._timeLastSecond = this.now,
            this.frames = 0)
        },
        gamePaused: function() {
            this._pauseStarted = Date.now(),
            this.events.pause();
            for (var t = this._timers.length; t--; )
                this._timers[t]._pause()
        },
        gameResumed: function() {
            this.time = Date.now(),
            this.pauseDuration = this.time - this._pauseStarted,
            this.events.resume();
            for (var t = this._timers.length; t--; )
                this._timers[t]._resume()
        },
        totalElapsedSeconds: function() {
            return .001 * (this.time - this._started)
        },
        elapsedSince: function(t) {
            return this.time - t
        },
        elapsedSecondsSince: function(t) {
            return .001 * (this.time - t)
        },
        reset: function() {
            this._started = this.time,
            this.removeAll()
        }
    },
    Object.defineProperty(H.Time.prototype, "desiredFps", {
        get: function() {
            return this._desiredFps
        },
        set: function(t) {
            this._desiredFps = t,
            this.physicsElapsed = 1 / t,
            this.physicsElapsedMS = 1e3 * this.physicsElapsed,
            this.desiredFpsMult = 1 / t
        }
    }),
    H.Time.prototype.constructor = H.Time,
    H.Timer = function(t, e) {
        void 0 === e && (e = !0),
        this.game = t,
        this.running = !1,
        this.autoDestroy = e,
        this.expired = !1,
        this.elapsed = 0,
        this.events = [],
        this.onComplete = new H.Signal,
        this.nextTick = 0,
        this.timeCap = 1e3,
        this.paused = !1,
        this._codePaused = !1,
        this._started = 0,
        this._pauseStarted = 0,
        this._pauseTotal = 0,
        this._now = Date.now(),
        this._len = 0,
        this._marked = 0,
        this._i = 0,
        this._diff = 0,
        this._newTick = 0
    }
    ,
    H.Timer.MINUTE = 6e4,
    H.Timer.SECOND = 1e3,
    H.Timer.HALF = 500,
    H.Timer.QUARTER = 250,
    H.Timer.prototype = {
        create: function(t, e, i, s, n, r) {
            var o = t = Math.round(t);
            0 === this._now ? o += this.game.time.time : o += this._now;
            var a = new H.TimerEvent(this,t,o,i,e,s,n,r);
            return this.events.push(a),
            this.order(),
            this.expired = !1,
            a
        },
        add: function(t, e, i) {
            return this.create(t, !1, 0, e, i, Array.prototype.slice.call(arguments, 3))
        },
        repeat: function(t, e, i, s) {
            return this.create(t, !1, e, i, s, Array.prototype.slice.call(arguments, 4))
        },
        loop: function(t, e, i) {
            return this.create(t, !0, 0, e, i, Array.prototype.slice.call(arguments, 3))
        },
        start: function(t) {
            if (!this.running) {
                this._started = this.game.time.time + (t || 0),
                this.running = !0;
                for (var e = 0; e < this.events.length; e++)
                    this.events[e].tick = this.events[e].delay + this._started
            }
        },
        stop: function(t) {
            this.running = !1,
            void 0 === t && (t = !0),
            t && (this.events.length = 0)
        },
        remove: function(t) {
            for (var e = 0; e < this.events.length; e++)
                if (this.events[e] === t)
                    return this.events[e].pendingDelete = !0;
            return !1
        },
        order: function() {
            0 < this.events.length && (this.events.sort(this.sortHandler),
            this.nextTick = this.events[0].tick)
        },
        sortHandler: function(t, e) {
            return t.tick < e.tick ? -1 : t.tick > e.tick ? 1 : 0
        },
        clearPendingEvents: function() {
            for (this._i = this.events.length; this._i--; )
                this.events[this._i].pendingDelete && this.events.splice(this._i, 1);
            this._len = this.events.length,
            this._i = 0
        },
        update: function(t) {
            if (this.paused)
                return !0;
            if (this.elapsed = t - this._now,
            this._now = t,
            this.elapsed > this.timeCap && this.adjustEvents(t - this.elapsed),
            this._marked = 0,
            this.clearPendingEvents(),
            this.running && this._now >= this.nextTick && 0 < this._len) {
                for (; this._i < this._len && this.running && this._now >= this.events[this._i].tick && !this.events[this._i].pendingDelete; )
                    this._newTick = this._now + this.events[this._i].delay - (this._now - this.events[this._i].tick),
                    this._newTick < 0 && (this._newTick = this._now + this.events[this._i].delay),
                    !0 === this.events[this._i].loop ? this.events[this._i].tick = this._newTick : 0 < this.events[this._i].repeatCount ? (this.events[this._i].repeatCount--,
                    this.events[this._i].tick = this._newTick) : (this._marked++,
                    this.events[this._i].pendingDelete = !0),
                    this.events[this._i].callback.apply(this.events[this._i].callbackContext, this.events[this._i].args),
                    this._i++;
                this.events.length > this._marked ? this.order() : (this.expired = !0,
                this.onComplete.dispatch(this))
            }
            return !this.expired || !this.autoDestroy
        },
        pause: function() {
            this.running && (this._codePaused = !0,
            this.paused || (this._pauseStarted = this.game.time.time,
            this.paused = !0))
        },
        _pause: function() {
            !this.paused && this.running && (this._pauseStarted = this.game.time.time,
            this.paused = !0)
        },
        adjustEvents: function(t) {
            for (var e = 0; e < this.events.length; e++)
                if (!this.events[e].pendingDelete) {
                    var i = this.events[e].tick - t;
                    i < 0 && (i = 0),
                    this.events[e].tick = this._now + i
                }
            var s = this.nextTick - t;
            this.nextTick = s < 0 ? this._now : this._now + s
        },
        resume: function() {
            if (this.paused) {
                var t = this.game.time.time;
                this._pauseTotal += t - this._now,
                this._now = t,
                this.adjustEvents(this._pauseStarted),
                this.paused = !1,
                this._codePaused = !1
            }
        },
        _resume: function() {
            this._codePaused || this.resume()
        },
        removeAll: function() {
            this.onComplete.removeAll(),
            this.events.length = 0,
            this._len = 0,
            this._i = 0
        },
        destroy: function() {
            this.onComplete.removeAll(),
            this.running = !1,
            this.events = [],
            this._len = 0,
            this._i = 0
        }
    },
    Object.defineProperty(H.Timer.prototype, "next", {
        get: function() {
            return this.nextTick
        }
    }),
    Object.defineProperty(H.Timer.prototype, "duration", {
        get: function() {
            return this.running && this.nextTick > this._now ? this.nextTick - this._now : 0
        }
    }),
    Object.defineProperty(H.Timer.prototype, "length", {
        get: function() {
            return this.events.length
        }
    }),
    Object.defineProperty(H.Timer.prototype, "ms", {
        get: function() {
            return this.running ? this._now - this._started - this._pauseTotal : 0
        }
    }),
    Object.defineProperty(H.Timer.prototype, "seconds", {
        get: function() {
            return this.running ? .001 * this.ms : 0
        }
    }),
    H.Timer.prototype.constructor = H.Timer,
    H.TimerEvent = function(t, e, i, s, n, r, o, a) {
        this.timer = t,
        this.delay = e,
        this.tick = i,
        this.repeatCount = s - 1,
        this.loop = n,
        this.callback = r,
        this.callbackContext = o,
        this.args = a,
        this.pendingDelete = !1
    }
    ,
    H.TimerEvent.prototype.constructor = H.TimerEvent,
    H.AnimationManager = function(t) {
        this.sprite = t,
        this.game = t.game,
        this.currentFrame = null,
        this.currentAnim = null,
        this.updateIfVisible = !0,
        this.isLoaded = !1,
        this._frameData = null,
        this._anims = {},
        this._outputFrames = []
    }
    ,
    H.AnimationManager.prototype = {
        loadFrameData: function(t, e) {
            if (void 0 === t)
                return !1;
            if (this.isLoaded)
                for (var i in this._anims)
                    this._anims[i].updateFrameData(t);
            return this._frameData = t,
            null == e ? this.frame = 0 : "string" == typeof e ? this.frameName = e : this.frame = e,
            this.isLoaded = !0
        },
        copyFrameData: function(t, e) {
            if (this._frameData = t.clone(),
            this.isLoaded)
                for (var i in this._anims)
                    this._anims[i].updateFrameData(this._frameData);
            return null == e ? this.frame = 0 : "string" == typeof e ? this.frameName = e : this.frame = e,
            this.isLoaded = !0
        },
        add: function(t, e, i, s, n) {
            return e = e || [],
            i = i || 60,
            void 0 === s && (s = !1),
            void 0 === n && (n = !(!e || "number" != typeof e[0])),
            this._outputFrames = [],
            this._frameData.getFrameIndexes(e, n, this._outputFrames),
            this._anims[t] = new H.Animation(this.game,this.sprite,t,this._frameData,this._outputFrames,i,s),
            this.currentAnim = this._anims[t],
            this.sprite.tilingTexture && (this.sprite.refreshTexture = !0),
            this._anims[t]
        },
        validateFrames: function(t, e) {
            void 0 === e && (e = !0);
            for (var i = 0; i < t.length; i++)
                if (!0 === e) {
                    if (t[i] > this._frameData.total)
                        return !1
                } else if (!1 === this._frameData.checkFrameName(t[i]))
                    return !1;
            return !0
        },
        play: function(t, e, i, s) {
            if (this._anims[t])
                return this.currentAnim === this._anims[t] ? !1 === this.currentAnim.isPlaying ? (this.currentAnim.paused = !1,
                this.currentAnim.play(e, i, s)) : this.currentAnim : (this.currentAnim && this.currentAnim.isPlaying && this.currentAnim.stop(),
                this.currentAnim = this._anims[t],
                this.currentAnim.paused = !1,
                this.currentFrame = this.currentAnim.currentFrame,
                this.currentAnim.play(e, i, s))
        },
        stop: function(t, e) {
            void 0 === e && (e = !1),
            !this.currentAnim || "string" == typeof t && t !== this.currentAnim.name || this.currentAnim.stop(e)
        },
        update: function() {
            return !(this.updateIfVisible && !this.sprite.visible || !this.currentAnim || !this.currentAnim.update() || (this.currentFrame = this.currentAnim.currentFrame,
            0))
        },
        next: function(t) {
            this.currentAnim && (this.currentAnim.next(t),
            this.currentFrame = this.currentAnim.currentFrame)
        },
        previous: function(t) {
            this.currentAnim && (this.currentAnim.previous(t),
            this.currentFrame = this.currentAnim.currentFrame)
        },
        getAnimation: function(t) {
            return "string" == typeof t && this._anims[t] ? this._anims[t] : null
        },
        refreshFrame: function() {},
        destroy: function() {
            var t = null;
            for (var t in this._anims)
                this._anims.hasOwnProperty(t) && this._anims[t].destroy();
            this._anims = {},
            this._outputFrames = [],
            this._frameData = null,
            this.currentAnim = null,
            this.currentFrame = null,
            this.sprite = null,
            this.game = null
        }
    },
    H.AnimationManager.prototype.constructor = H.AnimationManager,
    Object.defineProperty(H.AnimationManager.prototype, "frameData", {
        get: function() {
            return this._frameData
        }
    }),
    Object.defineProperty(H.AnimationManager.prototype, "frameTotal", {
        get: function() {
            return this._frameData.total
        }
    }),
    Object.defineProperty(H.AnimationManager.prototype, "paused", {
        get: function() {
            return this.currentAnim.isPaused
        },
        set: function(t) {
            this.currentAnim.paused = t
        }
    }),
    Object.defineProperty(H.AnimationManager.prototype, "name", {
        get: function() {
            if (this.currentAnim)
                return this.currentAnim.name
        }
    }),
    Object.defineProperty(H.AnimationManager.prototype, "frame", {
        get: function() {
            if (this.currentFrame)
                return this.currentFrame.index
        },
        set: function(t) {
            "number" == typeof t && this._frameData && null !== this._frameData.getFrame(t) && (this.currentFrame = this._frameData.getFrame(t),
            this.currentFrame && this.sprite.setFrame(this.currentFrame))
        }
    }),
    Object.defineProperty(H.AnimationManager.prototype, "frameName", {
        get: function() {
            if (this.currentFrame)
                return this.currentFrame.name
        },
        set: function(t) {
            "string" == typeof t && this._frameData && null !== this._frameData.getFrameByName(t) && (this.currentFrame = this._frameData.getFrameByName(t),
            this.currentFrame && (this._frameIndex = this.currentFrame.index,
            this.sprite.setFrame(this.currentFrame)))
        }
    }),
    H.Animation = function(t, e, i, s, n, r, o) {
        void 0 === o && (o = !1),
        this.game = t,
        this._parent = e,
        this._frameData = s,
        this.name = i,
        this._frames = [],
        this._frames = this._frames.concat(n),
        this.delay = 1e3 / r,
        this.loop = o,
        this.loopCount = 0,
        this.killOnComplete = !1,
        this.isFinished = !1,
        this.isPlaying = !1,
        this.isPaused = !1,
        this._pauseStartTime = 0,
        this._frameIndex = 0,
        this._frameDiff = 0,
        this._frameSkip = 1,
        this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]),
        this.onStart = new H.Signal,
        this.onUpdate = null,
        this.onComplete = new H.Signal,
        this.onLoop = new H.Signal,
        this.isReversed = !1,
        this.game.onPause.add(this.onPause, this),
        this.game.onResume.add(this.onResume, this)
    }
    ,
    H.Animation.prototype = {
        play: function(t, e, i) {
            return "number" == typeof t && (this.delay = 1e3 / t),
            "boolean" == typeof e && (this.loop = e),
            void 0 !== i && (this.killOnComplete = i),
            this.isPlaying = !0,
            this.isFinished = !1,
            this.paused = !1,
            this.loopCount = 0,
            this._timeLastFrame = this.game.time.time,
            this._timeNextFrame = this.game.time.time + this.delay,
            this._frameIndex = this.isReversed ? this._frames.length - 1 : 0,
            this.updateCurrentFrame(!1, !0),
            this._parent.events.onAnimationStart$dispatch(this._parent, this),
            this.onStart.dispatch(this._parent, this),
            (this._parent.animations.currentAnim = this)._parent.animations.currentFrame = this.currentFrame,
            this
        },
        restart: function() {
            this.isPlaying = !0,
            this.isFinished = !1,
            this.paused = !1,
            this.loopCount = 0,
            this._timeLastFrame = this.game.time.time,
            this._timeNextFrame = this.game.time.time + this.delay,
            this._frameIndex = 0,
            this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]),
            this._parent.setFrame(this.currentFrame),
            (this._parent.animations.currentAnim = this)._parent.animations.currentFrame = this.currentFrame,
            this.onStart.dispatch(this._parent, this)
        },
        reverse: function() {
            return this.reversed = !this.reversed,
            this
        },
        reverseOnce: function() {
            return this.onComplete.addOnce(this.reverse, this),
            this.reverse()
        },
        setFrame: function(t, e) {
            var i;
            if (void 0 === e && (e = !1),
            "string" == typeof t)
                for (var s = 0; s < this._frames.length; s++)
                    this._frameData.getFrame(this._frames[s]).name === t && (i = s);
            else if ("number" == typeof t)
                if (e)
                    i = t;
                else
                    for (s = 0; s < this._frames.length; s++)
                        this._frames[s] === t && (i = s);
            i && (this._frameIndex = i - 1,
            this._timeNextFrame = this.game.time.time,
            this.update())
        },
        stop: function(t, e) {
            void 0 === t && (t = !1),
            void 0 === e && (e = !1),
            this.isPlaying = !1,
            this.isFinished = !0,
            this.paused = !1,
            t && (this.currentFrame = this._frameData.getFrame(this._frames[0]),
            this._parent.setFrame(this.currentFrame)),
            e && (this._parent.events.onAnimationComplete$dispatch(this._parent, this),
            this.onComplete.dispatch(this._parent, this))
        },
        onPause: function() {
            this.isPlaying && (this._frameDiff = this._timeNextFrame - this.game.time.time)
        },
        onResume: function() {
            this.isPlaying && (this._timeNextFrame = this.game.time.time + this._frameDiff)
        },
        update: function() {
            return !this.isPaused && !!(this.isPlaying && this.game.time.time >= this._timeNextFrame) && (this._frameSkip = 1,
            this._frameDiff = this.game.time.time - this._timeNextFrame,
            this._timeLastFrame = this.game.time.time,
            this._frameDiff > this.delay && (this._frameSkip = Math.floor(this._frameDiff / this.delay),
            this._frameDiff -= this._frameSkip * this.delay),
            this._timeNextFrame = this.game.time.time + (this.delay - this._frameDiff),
            this.isReversed ? this._frameIndex -= this._frameSkip : this._frameIndex += this._frameSkip,
            !this.isReversed && this._frameIndex >= this._frames.length || this.isReversed && this._frameIndex <= -1 ? this.loop ? (this._frameIndex = Math.abs(this._frameIndex) % this._frames.length,
            this.isReversed && (this._frameIndex = this._frames.length - 1 - this._frameIndex),
            this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]),
            this.currentFrame && this._parent.setFrame(this.currentFrame),
            this.loopCount++,
            this._parent.events.onAnimationLoop$dispatch(this._parent, this),
            this.onLoop.dispatch(this._parent, this),
            !this.onUpdate || (this.onUpdate.dispatch(this, this.currentFrame),
            !!this._frameData)) : (this.complete(),
            !1) : this.updateCurrentFrame(!0))
        },
        updateCurrentFrame: function(t, e) {
            if (void 0 === e && (e = !1),
            !this._frameData)
                return !1;
            var i = this.currentFrame.index;
            return this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]),
            this.currentFrame && (e || !e && i !== this.currentFrame.index) && this._parent.setFrame(this.currentFrame),
            !this.onUpdate || !t || (this.onUpdate.dispatch(this, this.currentFrame),
            !!this._frameData)
        },
        next: function(t) {
            void 0 === t && (t = 1);
            var e = this._frameIndex + t;
            e >= this._frames.length && (this.loop ? e %= this._frames.length : e = this._frames.length - 1),
            e !== this._frameIndex && (this._frameIndex = e,
            this.updateCurrentFrame(!0))
        },
        previous: function(t) {
            void 0 === t && (t = 1);
            var e = this._frameIndex - t;
            e < 0 && (this.loop ? e = this._frames.length + e : e++),
            e !== this._frameIndex && (this._frameIndex = e,
            this.updateCurrentFrame(!0))
        },
        updateFrameData: function(t) {
            this._frameData = t,
            this.currentFrame = this._frameData ? this._frameData.getFrame(this._frames[this._frameIndex % this._frames.length]) : null
        },
        destroy: function() {
            this._frameData && (this.game.onPause.remove(this.onPause, this),
            this.game.onResume.remove(this.onResume, this),
            this.game = null,
            this._parent = null,
            this._frames = null,
            this._frameData = null,
            this.currentFrame = null,
            this.isPlaying = !1,
            this.onStart.dispose(),
            this.onLoop.dispose(),
            this.onComplete.dispose(),
            this.onUpdate && this.onUpdate.dispose())
        },
        complete: function() {
            this._frameIndex = this._frames.length - 1,
            this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]),
            this.isPlaying = !1,
            this.isFinished = !0,
            this.paused = !1,
            this._parent.events.onAnimationComplete$dispatch(this._parent, this),
            this.onComplete.dispatch(this._parent, this),
            this.killOnComplete && this._parent.kill()
        }
    },
    H.Animation.prototype.constructor = H.Animation,
    Object.defineProperty(H.Animation.prototype, "paused", {
        get: function() {
            return this.isPaused
        },
        set: function(t) {
            (this.isPaused = t) ? this._pauseStartTime = this.game.time.time : this.isPlaying && (this._timeNextFrame = this.game.time.time + this.delay)
        }
    }),
    Object.defineProperty(H.Animation.prototype, "reversed", {
        get: function() {
            return this.isReversed
        },
        set: function(t) {
            this.isReversed = t
        }
    }),
    Object.defineProperty(H.Animation.prototype, "frameTotal", {
        get: function() {
            return this._frames.length
        }
    }),
    Object.defineProperty(H.Animation.prototype, "frame", {
        get: function() {
            return null !== this.currentFrame ? this.currentFrame.index : this._frameIndex
        },
        set: function(t) {
            this.currentFrame = this._frameData.getFrame(this._frames[t]),
            null !== this.currentFrame && (this._frameIndex = t,
            this._parent.setFrame(this.currentFrame),
            this.onUpdate && this.onUpdate.dispatch(this, this.currentFrame))
        }
    }),
    Object.defineProperty(H.Animation.prototype, "speed", {
        get: function() {
            return 1e3 / this.delay
        },
        set: function(t) {
            0 < t && (this.delay = 1e3 / t)
        }
    }),
    Object.defineProperty(H.Animation.prototype, "enableUpdate", {
        get: function() {
            return null !== this.onUpdate
        },
        set: function(t) {
            t && null === this.onUpdate ? this.onUpdate = new H.Signal : t || null === this.onUpdate || (this.onUpdate.dispose(),
            this.onUpdate = null)
        }
    }),
    H.Animation.generateFrameNames = function(t, e, i, s, n) {
        void 0 === s && (s = "");
        var r = []
          , o = "";
        if (e < i)
            for (var a = e; a <= i; a++)
                o = t + (o = "number" == typeof n ? H.Utils.pad(a.toString(), n, "0", 1) : a.toString()) + s,
                r.push(o);
        else
            for (a = e; i <= a; a--)
                o = t + (o = "number" == typeof n ? H.Utils.pad(a.toString(), n, "0", 1) : a.toString()) + s,
                r.push(o);
        return r
    }
    ,
    H.Frame = function(t, e, i, s, n, r) {
        this.index = t,
        this.x = e,
        this.y = i,
        this.width = s,
        this.height = n,
        this.name = r,
        this.centerX = Math.floor(s / 2),
        this.centerY = Math.floor(n / 2),
        this.distance = H.Math.distance(0, 0, s, n),
        this.rotated = !1,
        this.rotationDirection = "cw",
        this.trimmed = !1,
        this.sourceSizeW = s,
        this.sourceSizeH = n,
        this.spriteSourceSizeX = 0,
        this.spriteSourceSizeY = 0,
        this.spriteSourceSizeW = 0,
        this.spriteSourceSizeH = 0,
        this.right = this.x + this.width,
        this.bottom = this.y + this.height
    }
    ,
    H.Frame.prototype = {
        resize: function(t, e) {
            this.width = t,
            this.height = e,
            this.centerX = Math.floor(t / 2),
            this.centerY = Math.floor(e / 2),
            this.distance = H.Math.distance(0, 0, t, e),
            this.sourceSizeW = t,
            this.sourceSizeH = e,
            this.right = this.x + t,
            this.bottom = this.y + e
        },
        setTrim: function(t, e, i, s, n, r, o) {
            (this.trimmed = t) && (this.sourceSizeW = e,
            this.sourceSizeH = i,
            this.centerX = Math.floor(e / 2),
            this.centerY = Math.floor(i / 2),
            this.spriteSourceSizeX = s,
            this.spriteSourceSizeY = n,
            this.spriteSourceSizeW = r,
            this.spriteSourceSizeH = o)
        },
        clone: function() {
            var t = new H.Frame(this.index,this.x,this.y,this.width,this.height,this.name);
            for (var e in this)
                this.hasOwnProperty(e) && (t[e] = this[e]);
            return t
        },
        getRect: function(t) {
            return void 0 === t ? t = new H.Rectangle(this.x,this.y,this.width,this.height) : t.setTo(this.x, this.y, this.width, this.height),
            t
        }
    },
    H.Frame.prototype.constructor = H.Frame,
    H.FrameData = function() {
        this._frames = [],
        this._frameNames = []
    }
    ,
    H.FrameData.prototype = {
        addFrame: function(t) {
            return t.index = this._frames.length,
            this._frames.push(t),
            "" !== t.name && (this._frameNames[t.name] = t.index),
            t
        },
        getFrame: function(t) {
            return t >= this._frames.length && (t = 0),
            this._frames[t]
        },
        getFrameByName: function(t) {
            return "number" == typeof this._frameNames[t] ? this._frames[this._frameNames[t]] : null
        },
        checkFrameName: function(t) {
            return null != this._frameNames[t]
        },
        clone: function() {
            for (var t = new H.FrameData, e = 0; e < this._frames.length; e++)
                t._frames.push(this._frames[e].clone());
            for (var i in this._frameNames)
                this._frameNames.hasOwnProperty(i) && t._frameNames.push(this._frameNames[i]);
            return t
        },
        getFrameRange: function(t, e, i) {
            void 0 === i && (i = []);
            for (var s = t; s <= e; s++)
                i.push(this._frames[s]);
            return i
        },
        getFrames: function(t, e, i) {
            if (void 0 === e && (e = !0),
            void 0 === i && (i = []),
            void 0 === t || 0 === t.length)
                for (var s = 0; s < this._frames.length; s++)
                    i.push(this._frames[s]);
            else
                for (s = 0; s < t.length; s++)
                    e ? i.push(this.getFrame(t[s])) : i.push(this.getFrameByName(t[s]));
            return i
        },
        getFrameIndexes: function(t, e, i) {
            if (void 0 === e && (e = !0),
            void 0 === i && (i = []),
            void 0 === t || 0 === t.length)
                for (var s = 0; s < this._frames.length; s++)
                    i.push(this._frames[s].index);
            else
                for (s = 0; s < t.length; s++)
                    e && this._frames[t[s]] ? i.push(this._frames[t[s]].index) : this.getFrameByName(t[s]) && i.push(this.getFrameByName(t[s]).index);
            return i
        },
        destroy: function() {
            this._frames = null,
            this._frameNames = null
        }
    },
    H.FrameData.prototype.constructor = H.FrameData,
    Object.defineProperty(H.FrameData.prototype, "total", {
        get: function() {
            return this._frames.length
        }
    }),
    H.AnimationParser = {
        spriteSheet: function(t, e, i, s, n, r, o) {
            var a = e;
            if ("string" == typeof e && (a = t.cache.getImage(e)),
            null === a)
                return null;
            var h = a.width
              , l = a.height;
            i <= 0 && (i = Math.floor(-h / Math.min(-1, i))),
            s <= 0 && (s = Math.floor(-l / Math.min(-1, s)));
            var c = Math.floor((h - r) / (i + o)) * Math.floor((l - r) / (s + o));
            if (-1 !== n && (c = n),
            0 === h || 0 === l || h < i || l < s || 0 === c)
                return null;
            for (var d = new H.FrameData, u = r, p = r, g = 0; g < c; g++)
                d.addFrame(new H.Frame(g,u,p,i,s,"")),
                (u += i + o) + i > h && (u = r,
                p += s + o);
            return d
        },
        JSONData: function(t, e) {
            if (e.frames) {
                for (var i, s = new H.FrameData, n = e.frames, r = 0; r < n.length; r++)
                    i = s.addFrame(new H.Frame(r,n[r].frame.x,n[r].frame.y,n[r].frame.w,n[r].frame.h,n[r].filename)),
                    n[r].trimmed && i.setTrim(n[r].trimmed, n[r].sourceSize.w, n[r].sourceSize.h, n[r].spriteSourceSize.x, n[r].spriteSourceSize.y, n[r].spriteSourceSize.w, n[r].spriteSourceSize.h);
                return s
            }
        },
        JSONDataPyxel: function(t, e) {
            if (["layers", "tilewidth", "tileheight", "tileswide", "tileshigh"].forEach(function(t) {
                e[t]
            }),
            1 === e.layers.length) {
                for (var i = new H.FrameData, s = e.tileheight, n = e.tilewidth, r = e.layers[0].tiles, o = 0; o < r.length; o++)
                    i.addFrame(new H.Frame(o,r[o].x,r[o].y,n,s,"frame_" + o)).setTrim(!1);
                return i
            }
        },
        JSONDataHash: function(t, e) {
            if (e.frames) {
                var i, s = new H.FrameData, n = e.frames, r = 0;
                for (var o in n)
                    i = s.addFrame(new H.Frame(r,n[o].frame.x,n[o].frame.y,n[o].frame.w,n[o].frame.h,o)),
                    n[o].trimmed && i.setTrim(n[o].trimmed, n[o].sourceSize.w, n[o].sourceSize.h, n[o].spriteSourceSize.x, n[o].spriteSourceSize.y, n[o].spriteSourceSize.w, n[o].spriteSourceSize.h),
                    r++;
                return s
            }
        },
        XMLData: function(t, e) {
            if (e.getElementsByTagName("TextureAtlas")) {
                for (var i, s, n, r, o, a, h, l, c, d, u, p = new H.FrameData, g = e.getElementsByTagName("SubTexture"), f = 0; f < g.length; f++)
                    s = (n = g[f].attributes).name.value,
                    r = parseInt(n.x.value, 10),
                    o = parseInt(n.y.value, 10),
                    a = parseInt(n.width.value, 10),
                    h = parseInt(n.height.value, 10),
                    c = l = null,
                    n.frameX && (l = Math.abs(parseInt(n.frameX.value, 10)),
                    c = Math.abs(parseInt(n.frameY.value, 10)),
                    d = parseInt(n.frameWidth.value, 10),
                    u = parseInt(n.frameHeight.value, 10)),
                    i = p.addFrame(new H.Frame(f,r,o,a,h,s)),
                    null === l && null === c || i.setTrim(!0, a, h, l, c, d, u);
                return p
            }
        }
    },
    H.Cache = function(t) {
        this.game = t,
        this.autoResolveURL = !1,
        this._cache = {
            canvas: {},
            image: {},
            texture: {},
            sound: {},
            video: {},
            text: {},
            json: {},
            xml: {},
            physics: {},
            tilemap: {},
            binary: {},
            bitmapData: {},
            bitmapFont: {},
            shader: {},
            renderTexture: {}
        },
        this._urlMap = {},
        this._urlResolver = new Image,
        this._urlTemp = null,
        this.onSoundUnlock = new H.Signal,
        this._cacheMap = [],
        this._cacheMap[H.Cache.CANVAS] = this._cache.canvas,
        this._cacheMap[H.Cache.IMAGE] = this._cache.image,
        this._cacheMap[H.Cache.TEXTURE] = this._cache.texture,
        this._cacheMap[H.Cache.SOUND] = this._cache.sound,
        this._cacheMap[H.Cache.TEXT] = this._cache.text,
        this._cacheMap[H.Cache.PHYSICS] = this._cache.physics,
        this._cacheMap[H.Cache.TILEMAP] = this._cache.tilemap,
        this._cacheMap[H.Cache.BINARY] = this._cache.binary,
        this._cacheMap[H.Cache.BITMAPDATA] = this._cache.bitmapData,
        this._cacheMap[H.Cache.BITMAPFONT] = this._cache.bitmapFont,
        this._cacheMap[H.Cache.JSON] = this._cache.json,
        this._cacheMap[H.Cache.XML] = this._cache.xml,
        this._cacheMap[H.Cache.VIDEO] = this._cache.video,
        this._cacheMap[H.Cache.SHADER] = this._cache.shader,
        this._cacheMap[H.Cache.RENDER_TEXTURE] = this._cache.renderTexture,
        this.addDefaultImage(),
        this.addMissingImage()
    }
    ,
    H.Cache.CANVAS = 1,
    H.Cache.IMAGE = 2,
    H.Cache.TEXTURE = 3,
    H.Cache.SOUND = 4,
    H.Cache.TEXT = 5,
    H.Cache.PHYSICS = 6,
    H.Cache.TILEMAP = 7,
    H.Cache.BINARY = 8,
    H.Cache.BITMAPDATA = 9,
    H.Cache.BITMAPFONT = 10,
    H.Cache.JSON = 11,
    H.Cache.XML = 12,
    H.Cache.VIDEO = 13,
    H.Cache.SHADER = 14,
    H.Cache.RENDER_TEXTURE = 15,
    H.Cache.DEFAULT = null,
    H.Cache.MISSING = null,
    H.Cache.prototype = {
        addCanvas: function(t, e, i) {
            void 0 === i && (i = e.getContext("2d")),
            this._cache.canvas[t] = {
                canvas: e,
                context: i
            }
        },
        addImage: function(t, e, i) {
            this.checkImageKey(t) && this.removeImage(t);
            var s = {
                key: t,
                url: e,
                data: i,
                base: new PIXI.BaseTexture(i),
                frame: new H.Frame(0,0,0,i.width,i.height,t),
                frameData: new H.FrameData
            };
            return s.frameData.addFrame(new H.Frame(0,0,0,i.width,i.height,e)),
            this._cache.image[t] = s,
            this._resolveURL(e, s),
            "__default" === t ? H.Cache.DEFAULT = new PIXI.Texture(s.base) : "__missing" === t && (H.Cache.MISSING = new PIXI.Texture(s.base)),
            s
        },
        addDefaultImage: function() {
            var t = new Image;
            t.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg==";
            var e = this.addImage("__default", null, t);
            e.base.skipRender = !0,
            H.Cache.DEFAULT = new PIXI.Texture(e.base)
        },
        addMissingImage: function() {
            var t = new Image;
            t.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg==";
            var e = this.addImage("__missing", null, t);
            H.Cache.MISSING = new PIXI.Texture(e.base)
        },
        addSound: function(t, e, i, s, n) {
            void 0 === s && (n = !(s = !0)),
            void 0 === n && (n = !(s = !1));
            var r = !1;
            n && (r = !0),
            this._cache.sound[t] = {
                url: e,
                data: i,
                isDecoding: !1,
                decoded: r,
                webAudio: s,
                audioTag: n,
                locked: this.game.sound.touchLocked
            },
            this._resolveURL(e, this._cache.sound[t])
        },
        addText: function(t, e, i) {
            this._cache.text[t] = {
                url: e,
                data: i
            },
            this._resolveURL(e, this._cache.text[t])
        },
        addPhysicsData: function(t, e, i, s) {
            this._cache.physics[t] = {
                url: e,
                data: i,
                format: s
            },
            this._resolveURL(e, this._cache.physics[t])
        },
        addTilemap: function(t, e, i, s) {
            this._cache.tilemap[t] = {
                url: e,
                data: i,
                format: s
            },
            this._resolveURL(e, this._cache.tilemap[t])
        },
        addBinary: function(t, e) {
            this._cache.binary[t] = e
        },
        addBitmapData: function(t, e, i) {
            return e.key = t,
            void 0 === i && (i = new H.FrameData).addFrame(e.textureFrame),
            this._cache.bitmapData[t] = {
                data: e,
                frameData: i
            },
            e
        },
        addBitmapFont: function(t, e, i, s, n, r, o) {
            var a = {
                url: e,
                data: i,
                font: null,
                base: new PIXI.BaseTexture(i)
            };
            void 0 === r && (r = 0),
            void 0 === o && (o = 0),
            a.font = "json" === n ? H.LoaderParser.jsonBitmapFont(s, a.base, r, o) : H.LoaderParser.xmlBitmapFont(s, a.base, r, o),
            this._cache.bitmapFont[t] = a,
            this._resolveURL(e, a)
        },
        addJSON: function(t, e, i) {
            this._cache.json[t] = {
                url: e,
                data: i
            },
            this._resolveURL(e, this._cache.json[t])
        },
        addXML: function(t, e, i) {
            this._cache.xml[t] = {
                url: e,
                data: i
            },
            this._resolveURL(e, this._cache.xml[t])
        },
        addVideo: function(t, e, i, s) {
            this._cache.video[t] = {
                url: e,
                data: i,
                isBlob: s,
                locked: !0
            },
            this._resolveURL(e, this._cache.video[t])
        },
        addShader: function(t, e, i) {
            this._cache.shader[t] = {
                url: e,
                data: i
            },
            this._resolveURL(e, this._cache.shader[t])
        },
        addRenderTexture: function(t, e) {
            this._cache.renderTexture[t] = {
                texture: e,
                frame: new H.Frame(0,0,0,e.width,e.height,"","")
            }
        },
        addSpriteSheet: function(t, e, i, s, n, r, o, a) {
            void 0 === r && (r = -1),
            void 0 === o && (o = 0),
            void 0 === a && (a = 0);
            var h = {
                key: t,
                url: e,
                data: i,
                frameWidth: s,
                frameHeight: n,
                margin: o,
                spacing: a,
                base: new PIXI.BaseTexture(i),
                frameData: H.AnimationParser.spriteSheet(this.game, i, s, n, r, o, a)
            };
            this._cache.image[t] = h,
            this._resolveURL(e, h)
        },
        addTextureAtlas: function(t, e, i, s, n) {
            var r = {
                key: t,
                url: e,
                data: i,
                base: new PIXI.BaseTexture(i)
            };
            n === H.Loader.TEXTURE_ATLAS_XML_STARLING ? r.frameData = H.AnimationParser.XMLData(this.game, s, t) : n === H.Loader.TEXTURE_ATLAS_JSON_PYXEL ? r.frameData = H.AnimationParser.JSONDataPyxel(this.game, s, t) : Array.isArray(s.frames) ? r.frameData = H.AnimationParser.JSONData(this.game, s, t) : r.frameData = H.AnimationParser.JSONDataHash(this.game, s, t),
            this._cache.image[t] = r,
            this._resolveURL(e, r)
        },
        reloadSound: function(t) {
            var e = this
              , i = this.getSound(t);
            i && (i.data.src = i.url,
            i.data.addEventListener("canplaythrough", function() {
                return e.reloadSoundComplete(t)
            }, !1),
            i.data.load())
        },
        reloadSoundComplete: function(t) {
            var e = this.getSound(t);
            e && (e.locked = !1,
            this.onSoundUnlock.dispatch(t))
        },
        updateSound: function(t, e, i) {
            var s = this.getSound(t);
            s && (s[e] = i)
        },
        decodedSound: function(t, e) {
            var i = this.getSound(t);
            i.data = e,
            i.decoded = !0,
            i.isDecoding = !1
        },
        isSoundDecoded: function(t) {
            var e = this.getItem(t, H.Cache.SOUND, "isSoundDecoded");
            if (e)
                return e.decoded
        },
        isSoundReady: function(t) {
            var e = this.getItem(t, H.Cache.SOUND, "isSoundDecoded");
            if (e)
                return e.decoded && !this.game.sound.touchLocked
        },
        checkKey: function(t, e) {
            return !!this._cacheMap[t][e]
        },
        checkURL: function(t) {
            return !!this._urlMap[this._resolveURL(t)]
        },
        checkCanvasKey: function(t) {
            return this.checkKey(H.Cache.CANVAS, t)
        },
        checkImageKey: function(t) {
            return this.checkKey(H.Cache.IMAGE, t)
        },
        checkTextureKey: function(t) {
            return this.checkKey(H.Cache.TEXTURE, t)
        },
        checkSoundKey: function(t) {
            return this.checkKey(H.Cache.SOUND, t)
        },
        checkTextKey: function(t) {
            return this.checkKey(H.Cache.TEXT, t)
        },
        checkPhysicsKey: function(t) {
            return this.checkKey(H.Cache.PHYSICS, t)
        },
        checkTilemapKey: function(t) {
            return this.checkKey(H.Cache.TILEMAP, t)
        },
        checkBinaryKey: function(t) {
            return this.checkKey(H.Cache.BINARY, t)
        },
        checkBitmapDataKey: function(t) {
            return this.checkKey(H.Cache.BITMAPDATA, t)
        },
        checkBitmapFontKey: function(t) {
            return this.checkKey(H.Cache.BITMAPFONT, t)
        },
        checkJSONKey: function(t) {
            return this.checkKey(H.Cache.JSON, t)
        },
        checkXMLKey: function(t) {
            return this.checkKey(H.Cache.XML, t)
        },
        checkVideoKey: function(t) {
            return this.checkKey(H.Cache.VIDEO, t)
        },
        checkShaderKey: function(t) {
            return this.checkKey(H.Cache.SHADER, t)
        },
        checkRenderTextureKey: function(t) {
            return this.checkKey(H.Cache.RENDER_TEXTURE, t)
        },
        getItem: function(t, e, i, s) {
            return this.checkKey(e, t) ? void 0 === s ? this._cacheMap[e][t] : this._cacheMap[e][t][s] : null
        },
        getCanvas: function(t) {
            return this.getItem(t, H.Cache.CANVAS, "getCanvas", "canvas")
        },
        getImage: function(t, e) {
            null != t || (t = "__default"),
            void 0 === e && (e = !1);
            var i = this.getItem(t, H.Cache.IMAGE, "getImage");
            return null === i && (i = this.getItem("__missing", H.Cache.IMAGE, "getImage")),
            e ? i : i.data
        },
        getTextureFrame: function(t) {
            return this.getItem(t, H.Cache.TEXTURE, "getTextureFrame", "frame")
        },
        getSound: function(t) {
            return this.getItem(t, H.Cache.SOUND, "getSound")
        },
        getSoundData: function(t) {
            return this.getItem(t, H.Cache.SOUND, "getSoundData", "data")
        },
        getText: function(t) {
            return this.getItem(t, H.Cache.TEXT, "getText", "data")
        },
        getPhysicsData: function(t, e, i) {
            var s = this.getItem(t, H.Cache.PHYSICS, "getPhysicsData", "data");
            if (null === s || null == e)
                return s;
            if (s[e]) {
                var n = s[e];
                if (!n || !i)
                    return n;
                for (var r in n)
                    if ((r = n[r]).fixtureKey === i)
                        return r
            }
            return null
        },
        getTilemapData: function(t) {
            return this.getItem(t, H.Cache.TILEMAP, "getTilemapData")
        },
        getBinary: function(t) {
            return this.getItem(t, H.Cache.BINARY, "getBinary")
        },
        getBitmapData: function(t) {
            return this.getItem(t, H.Cache.BITMAPDATA, "getBitmapData", "data")
        },
        getBitmapFont: function(t) {
            return this.getItem(t, H.Cache.BITMAPFONT, "getBitmapFont")
        },
        getJSON: function(t, e) {
            var i = this.getItem(t, H.Cache.JSON, "getJSON", "data");
            return i ? e ? H.Utils.extend(!0, Array.isArray(i) ? [] : {}, i) : i : null
        },
        getXML: function(t) {
            return this.getItem(t, H.Cache.XML, "getXML", "data")
        },
        getVideo: function(t) {
            return this.getItem(t, H.Cache.VIDEO, "getVideo")
        },
        getShader: function(t) {
            return this.getItem(t, H.Cache.SHADER, "getShader", "data")
        },
        getRenderTexture: function(t) {
            return this.getItem(t, H.Cache.RENDER_TEXTURE, "getRenderTexture")
        },
        getBaseTexture: function(t, e) {
            return void 0 === e && (e = H.Cache.IMAGE),
            this.getItem(t, e, "getBaseTexture", "base")
        },
        getFrame: function(t, e) {
            return void 0 === e && (e = H.Cache.IMAGE),
            this.getItem(t, e, "getFrame", "frame")
        },
        getFrameCount: function(t, e) {
            var i = this.getFrameData(t, e);
            return i ? i.total : 0
        },
        getFrameData: function(t, e) {
            return void 0 === e && (e = H.Cache.IMAGE),
            this.getItem(t, e, "getFrameData", "frameData")
        },
        hasFrameData: function(t, e) {
            return void 0 === e && (e = H.Cache.IMAGE),
            null !== this.getItem(t, e, "", "frameData")
        },
        updateFrameData: function(t, e, i) {
            void 0 === i && (i = H.Cache.IMAGE),
            this._cacheMap[i][t] && (this._cacheMap[i][t].frameData = e)
        },
        getFrameByIndex: function(t, e, i) {
            var s = this.getFrameData(t, i);
            return s ? s.getFrame(e) : null
        },
        getFrameByName: function(t, e, i) {
            var s = this.getFrameData(t, i);
            return s ? s.getFrameByName(e) : null
        },
        getURL: function(t) {
            return (t = this._resolveURL(t)) ? this._urlMap[t] : null
        },
        getKeys: function(t) {
            void 0 === t && (t = H.Cache.IMAGE);
            var e = [];
            if (this._cacheMap[t])
                for (var i in this._cacheMap[t])
                    "__default" !== i && "__missing" !== i && e.push(i);
            return e
        },
        removeCanvas: function(t) {
            delete this._cache.canvas[t]
        },
        removeImage: function(t, e) {
            void 0 === e && (e = !0);
            var i = this.getImage(t, !0);
            e && i.base && i.base.destroy(),
            delete this._cache.image[t]
        },
        removeSound: function(t) {
            delete this._cache.sound[t]
        },
        removeText: function(t) {
            delete this._cache.text[t]
        },
        removePhysics: function(t) {
            delete this._cache.physics[t]
        },
        removeTilemap: function(t) {
            delete this._cache.tilemap[t]
        },
        removeBinary: function(t) {
            delete this._cache.binary[t]
        },
        removeBitmapData: function(t) {
            delete this._cache.bitmapData[t]
        },
        removeBitmapFont: function(t) {
            delete this._cache.bitmapFont[t]
        },
        removeJSON: function(t) {
            delete this._cache.json[t]
        },
        removeXML: function(t) {
            delete this._cache.xml[t]
        },
        removeVideo: function(t) {
            delete this._cache.video[t]
        },
        removeShader: function(t) {
            delete this._cache.shader[t]
        },
        removeRenderTexture: function(t) {
            delete this._cache.renderTexture[t]
        },
        removeSpriteSheet: function(t) {
            delete this._cache.spriteSheet[t]
        },
        removeTextureAtlas: function(t) {
            delete this._cache.atlas[t]
        },
        clearGLTextures: function() {
            for (var t in this._cache.image)
                this._cache.image[t].base._glTextures = []
        },
        _resolveURL: function(t, e) {
            return this.autoResolveURL ? (this._urlResolver.src = this.game.load.baseURL + t,
            this._urlTemp = this._urlResolver.src,
            this._urlResolver.src = "",
            e && (this._urlMap[this._urlTemp] = e),
            this._urlTemp) : null
        },
        destroy: function() {
            for (var t = 0; t < this._cacheMap.length; t++) {
                var e = this._cacheMap[t];
                for (var i in e)
                    "__default" !== i && "__missing" !== i && (e[i].destroy && e[i].destroy(),
                    delete e[i])
            }
            this._urlMap = null,
            this._urlResolver = null,
            this._urlTemp = null
        }
    },
    H.Cache.prototype.constructor = H.Cache,
    H.Loader = function(t) {
        this.game = t,
        this.cache = t.cache,
        this.resetLocked = !1,
        this.isLoading = !1,
        this.hasLoaded = !1,
        this.preloadSprite = null,
        this.crossOrigin = !1,
        this.baseURL = "",
        this.path = "",
        this.headers = {
            requestedWith: !1,
            json: "application/json",
            xml: "application/xml"
        },
        this.onLoadStart = new H.Signal,
        this.onLoadComplete = new H.Signal,
        this.onPackComplete = new H.Signal,
        this.onFileStart = new H.Signal,
        this.onFileComplete = new H.Signal,
        this.onFileError = new H.Signal,
        this.useXDomainRequest = !1,
        this._warnedAboutXDomainRequest = !1,
        this.enableParallel = !0,
        this.maxParallelDownloads = 4,
        this._withSyncPointDepth = 0,
        this._fileList = [],
        this._flightQueue = [],
        this._processingHead = 0,
        this._fileLoadStarted = !1,
        this._totalPackCount = 0,
        this._totalFileCount = 0,
        this._loadedPackCount = 0,
        this._loadedFileCount = 0
    }
    ,
    H.Loader.TEXTURE_ATLAS_JSON_ARRAY = 0,
    H.Loader.TEXTURE_ATLAS_JSON_HASH = 1,
    H.Loader.TEXTURE_ATLAS_XML_STARLING = 2,
    H.Loader.PHYSICS_LIME_CORONA_JSON = 3,
    H.Loader.PHYSICS_PHASER_JSON = 4,
    H.Loader.TEXTURE_ATLAS_JSON_PYXEL = 5,
    H.Loader.prototype = {
        setPreloadSprite: function(t, e) {
            e = e || 0,
            this.preloadSprite = {
                sprite: t,
                direction: e,
                width: t.width,
                height: t.height,
                rect: null
            },
            this.preloadSprite.rect = 0 === e ? new H.Rectangle(0,0,1,t.height) : new H.Rectangle(0,0,t.width,1),
            t.crop(this.preloadSprite.rect),
            t.visible = !0
        },
        resize: function() {
            this.preloadSprite && this.preloadSprite.height !== this.preloadSprite.sprite.height && (this.preloadSprite.rect.height = this.preloadSprite.sprite.height)
        },
        checkKeyExists: function(t, e) {
            return -1 < this.getAssetIndex(t, e)
        },
        getAssetIndex: function(t, e) {
            for (var i = -1, s = 0; s < this._fileList.length; s++) {
                var n = this._fileList[s];
                if (n.type === t && n.key === e && (i = s,
                !n.loaded && !n.loading))
                    break
            }
            return i
        },
        getAsset: function(t, e) {
            var i = this.getAssetIndex(t, e);
            return -1 < i && {
                index: i,
                file: this._fileList[i]
            }
        },
        reset: function(t, e) {
            void 0 === e && (e = !1),
            this.resetLocked || (t && (this.preloadSprite = null),
            this.isLoading = !1,
            this._processingHead = 0,
            this._fileList.length = 0,
            this._flightQueue.length = 0,
            this._fileLoadStarted = !1,
            this._totalFileCount = 0,
            this._totalPackCount = 0,
            this._loadedPackCount = 0,
            this._loadedFileCount = 0,
            e && (this.onLoadStart.removeAll(),
            this.onLoadComplete.removeAll(),
            this.onPackComplete.removeAll(),
            this.onFileStart.removeAll(),
            this.onFileComplete.removeAll(),
            this.onFileError.removeAll()))
        },
        addToFileList: function(t, e, i, s, n, r) {
            if (void 0 === n && (n = !1),
            void 0 === e || "" === e)
                return this;
            if (null == i) {
                if (!r)
                    return this;
                i = e + r
            }
            var o = {
                type: t,
                key: e,
                path: this.path,
                url: i,
                syncPoint: 0 < this._withSyncPointDepth,
                data: null,
                loading: !1,
                loaded: !1,
                error: !1
            };
            if (s)
                for (var a in s)
                    o[a] = s[a];
            var h = this.getAssetIndex(t, e);
            if (n && -1 < h) {
                var l = this._fileList[h];
                l.loading || l.loaded ? (this._fileList.push(o),
                this._totalFileCount++) : this._fileList[h] = o
            } else
                -1 === h && (this._fileList.push(o),
                this._totalFileCount++);
            return this
        },
        replaceInFileList: function(t, e, i, s) {
            return this.addToFileList(t, e, i, s, !0)
        },
        pack: function(t, e, i, s) {
            if (void 0 === e && (e = null),
            void 0 === i && (i = null),
            void 0 === s && (s = null),
            !e && !i)
                return this;
            var n = {
                type: "packfile",
                key: t,
                url: e,
                path: this.path,
                syncPoint: !0,
                data: null,
                loading: !1,
                loaded: !1,
                error: !1,
                callbackContext: s
            };
            i && ("string" == typeof i && (i = JSON.parse(i)),
            n.data = i || {},
            n.loaded = !0);
            for (var r = 0; r < this._fileList.length + 1; r++) {
                var o = this._fileList[r];
                if (!o || !o.loaded && !o.loading && "packfile" !== o.type) {
                    this._fileList.splice(r, 0, n),
                    this._totalPackCount++;
                    break
                }
            }
            return this
        },
        image: function(t, e, i) {
            return this.addToFileList("image", t, e, void 0, i, ".png")
        },
        images: function(t, e) {
            if (Array.isArray(e))
                for (var i = 0; i < t.length; i++)
                    this.image(t[i], e[i]);
            else
                for (i = 0; i < t.length; i++)
                    this.image(t[i]);
            return this
        },
        text: function(t, e, i) {
            return this.addToFileList("text", t, e, void 0, i, ".txt")
        },
        json: function(t, e, i) {
            return this.addToFileList("json", t, e, void 0, i, ".json")
        },
        shader: function(t, e, i) {
            return this.addToFileList("shader", t, e, void 0, i, ".frag")
        },
        xml: function(t, e, i) {
            return this.addToFileList("xml", t, e, void 0, i, ".xml")
        },
        script: function(t, e, i, s) {
            return void 0 === i && (i = !1),
            !1 !== i && void 0 === s && (s = this),
            this.addToFileList("script", t, e, {
                syncPoint: !0,
                callback: i,
                callbackContext: s
            }, !1, ".js")
        },
        binary: function(t, e, i, s) {
            return void 0 === i && (i = !1),
            !1 !== i && void 0 === s && (s = i),
            this.addToFileList("binary", t, e, {
                callback: i,
                callbackContext: s
            }, !1, ".bin")
        },
        spritesheet: function(t, e, i, s, n, r, o) {
            return void 0 === n && (n = -1),
            void 0 === r && (r = 0),
            void 0 === o && (o = 0),
            this.addToFileList("spritesheet", t, e, {
                frameWidth: i,
                frameHeight: s,
                frameMax: n,
                margin: r,
                spacing: o
            }, !1, ".png")
        },
        audio: function(t, e, i) {
            return this.game.sound.noAudio ? this : (void 0 === i && (i = !0),
            "string" == typeof e && (e = [e]),
            this.addToFileList("audio", t, e, {
                buffer: null,
                autoDecode: i
            }))
        },
        audioSprite: function(t, e, i, s, n) {
            return this.game.sound.noAudio || (void 0 === i && (i = null),
            void 0 === s && (s = null),
            void 0 === n && (n = !0),
            this.audio(t, e, n),
            i ? this.json(t + "-audioatlas", i) : s && ("string" == typeof s && (s = JSON.parse(s)),
            this.cache.addJSON(t + "-audioatlas", "", s))),
            this
        },
        audiosprite: function(t, e, i, s, n) {
            return this.audioSprite(t, e, i, s, n)
        },
        video: function(t, e, i, s) {
            return void 0 === i && (i = this.game.device.firefox ? "loadeddata" : "canplaythrough"),
            void 0 === s && (s = !1),
            "string" == typeof e && (e = [e]),
            this.addToFileList("video", t, e, {
                buffer: null,
                asBlob: s,
                loadEvent: i
            })
        },
        tilemap: function(t, e, i, s) {
            if (void 0 === e && (e = null),
            void 0 === i && (i = null),
            void 0 === s && (s = H.Tilemap.CSV),
            e || i || (e = s === H.Tilemap.CSV ? t + ".csv" : t + ".json"),
            i) {
                switch (s) {
                case H.Tilemap.CSV:
                    break;
                case H.Tilemap.TILED_JSON:
                    "string" == typeof i && (i = JSON.parse(i))
                }
                this.cache.addTilemap(t, null, i, s)
            } else
                this.addToFileList("tilemap", t, e, {
                    format: s
                });
            return this
        },
        physics: function(t, e, i, s) {
            return void 0 === e && (e = null),
            void 0 === i && (i = null),
            void 0 === s && (s = H.Physics.LIME_CORONA_JSON),
            e || i || (e = t + ".json"),
            i ? ("string" == typeof i && (i = JSON.parse(i)),
            this.cache.addPhysicsData(t, null, i, s)) : this.addToFileList("physics", t, e, {
                format: s
            }),
            this
        },
        bitmapFont: function(t, e, i, s, n, r) {
            if (null != e || (e = t + ".png"),
            void 0 === i && (i = null),
            void 0 === s && (s = null),
            null === i && null === s && (i = t + ".xml"),
            void 0 === n && (n = 0),
            void 0 === r && (r = 0),
            i)
                this.addToFileList("bitmapfont", t, e, {
                    atlasURL: i,
                    xSpacing: n,
                    ySpacing: r
                });
            else if ("string" == typeof s) {
                var o, a;
                try {
                    o = JSON.parse(s)
                } catch (t) {
                    a = this.parseXml(s)
                }
                if (!a && !o)
                    throw new Error("Phaser.Loader. Invalid Bitmap Font atlas given");
                this.addToFileList("bitmapfont", t, e, {
                    atlasURL: null,
                    atlasData: o || a,
                    atlasType: o ? "json" : "xml",
                    xSpacing: n,
                    ySpacing: r
                })
            }
            return this
        },
        atlasJSONArray: function(t, e, i, s) {
            return this.atlas(t, e, i, s, H.Loader.TEXTURE_ATLAS_JSON_ARRAY)
        },
        atlasJSONHash: function(t, e, i, s) {
            return this.atlas(t, e, i, s, H.Loader.TEXTURE_ATLAS_JSON_HASH)
        },
        atlasXML: function(t, e, i, s) {
            return void 0 === i && (i = null),
            void 0 === s && (s = null),
            i || s || (i = t + ".xml"),
            this.atlas(t, e, i, s, H.Loader.TEXTURE_ATLAS_XML_STARLING)
        },
        atlas: function(t, e, i, s, n) {
            if (null != e || (e = t + ".png"),
            void 0 === i && (i = null),
            void 0 === s && (s = null),
            void 0 === n && (n = H.Loader.TEXTURE_ATLAS_JSON_ARRAY),
            i || s || (i = n === H.Loader.TEXTURE_ATLAS_XML_STARLING ? t + ".xml" : t + ".json"),
            i)
                this.addToFileList("textureatlas", t, e, {
                    atlasURL: i,
                    format: n
                });
            else {
                switch (n) {
                case H.Loader.TEXTURE_ATLAS_JSON_ARRAY:
                    "string" == typeof s && (s = JSON.parse(s));
                    break;
                case H.Loader.TEXTURE_ATLAS_XML_STARLING:
                    if ("string" == typeof s) {
                        var r = this.parseXml(s);
                        if (!r)
                            throw new Error("Phaser.Loader. Invalid Texture Atlas XML given");
                        s = r
                    }
                }
                this.addToFileList("textureatlas", t, e, {
                    atlasURL: null,
                    atlasData: s,
                    format: n
                })
            }
            return this
        },
        withSyncPoint: function(t, e) {
            this._withSyncPointDepth++;
            try {
                t.call(e || this, this)
            } finally {
                this._withSyncPointDepth--
            }
            return this
        },
        addSyncPoint: function(t, e) {
            var i = this.getAsset(t, e);
            return i && (i.file.syncPoint = !0),
            this
        },
        removeFile: function(t, e) {
            var i = this.getAsset(t, e);
            i && (i.loaded || i.loading || this._fileList.splice(i.index, 1))
        },
        removeAll: function() {
            this._fileList.length = 0,
            this._flightQueue.length = 0
        },
        start: function() {
            this.isLoading || (this.hasLoaded = !1,
            this.isLoading = !0,
            this.updateProgress(),
            this.processLoadQueue())
        },
        processLoadQueue: function() {
            if (this.isLoading) {
                for (var t = 0; t < this._flightQueue.length; t++) {
                    ((s = this._flightQueue[t]).loaded || s.error) && (this._flightQueue.splice(t, 1),
                    t--,
                    s.loading = !1,
                    s.requestUrl = null,
                    s.requestObject = null,
                    s.error && this.onFileError.dispatch(s.key, s),
                    "packfile" !== s.type ? (this._loadedFileCount++,
                    this.onFileComplete.dispatch(this.progress, s.key, !s.error, this._loadedFileCount, this._totalFileCount)) : "packfile" === s.type && s.error && (this._loadedPackCount++,
                    this.onPackComplete.dispatch(s.key, !s.error, this._loadedPackCount, this._totalPackCount)))
                }
                var e = !1
                  , i = this.enableParallel ? H.Math.clamp(this.maxParallelDownloads, 1, 12) : 1;
                for (t = this._processingHead; t < this._fileList.length; t++) {
                    var s;
                    if ("packfile" === (s = this._fileList[t]).type && !s.error && s.loaded && t === this._processingHead && (this.processPack(s),
                    this._loadedPackCount++,
                    this.onPackComplete.dispatch(s.key, !s.error, this._loadedPackCount, this._totalPackCount)),
                    s.loaded || s.error ? t === this._processingHead && (this._processingHead = t + 1) : !s.loading && this._flightQueue.length < i && ("packfile" !== s.type || s.data ? e || (this._fileLoadStarted || (this._fileLoadStarted = !0,
                    this.onLoadStart.dispatch()),
                    this._flightQueue.push(s),
                    s.loading = !0,
                    this.onFileStart.dispatch(this.progress, s.key, s.url),
                    this.loadFile(s)) : (this._flightQueue.push(s),
                    s.loading = !0,
                    this.loadFile(s))),
                    !s.loaded && s.syncPoint && (e = !0),
                    this._flightQueue.length >= i || e && this._loadedPackCount === this._totalPackCount)
                        break
                }
                if (this.updateProgress(),
                this._processingHead >= this._fileList.length)
                    this.finishedLoading();
                else if (!this._flightQueue.length) {
                    var n = this;
                    setTimeout(function() {
                        n.finishedLoading(!0)
                    }, 2e3)
                }
            } else
                this.finishedLoading(!0)
        },
        finishedLoading: function(t) {
            this.hasLoaded || (this.hasLoaded = !0,
            this.isLoading = !1,
            t || this._fileLoadStarted || (this._fileLoadStarted = !0,
            this.onLoadStart.dispatch()),
            this.onLoadComplete.dispatch(),
            this.game.state.loadComplete(),
            this.reset())
        },
        asyncComplete: function(t, e) {
            void 0 === e && (e = ""),
            t.loaded = !0,
            t.error = !!e,
            e && (t.errorMessage = e),
            this.processLoadQueue()
        },
        processPack: function(t) {
            var e = t.data[t.key];
            if (e)
                for (var i = 0; i < e.length; i++) {
                    var s = e[i];
                    switch (s.type) {
                    case "image":
                        this.image(s.key, s.url, s.overwrite);
                        break;
                    case "text":
                        this.text(s.key, s.url, s.overwrite);
                        break;
                    case "json":
                        this.json(s.key, s.url, s.overwrite);
                        break;
                    case "xml":
                        this.xml(s.key, s.url, s.overwrite);
                        break;
                    case "script":
                        this.script(s.key, s.url, s.callback, t.callbackContext || this);
                        break;
                    case "binary":
                        this.binary(s.key, s.url, s.callback, t.callbackContext || this);
                        break;
                    case "spritesheet":
                        this.spritesheet(s.key, s.url, s.frameWidth, s.frameHeight, s.frameMax, s.margin, s.spacing);
                        break;
                    case "video":
                        this.video(s.key, s.urls);
                        break;
                    case "audio":
                        this.audio(s.key, s.urls, s.autoDecode);
                        break;
                    case "audiosprite":
                        this.audiosprite(s.key, s.urls, s.jsonURL, s.jsonData, s.autoDecode);
                        break;
                    case "tilemap":
                        this.tilemap(s.key, s.url, s.data, H.Tilemap[s.format]);
                        break;
                    case "physics":
                        this.physics(s.key, s.url, s.data, H.Loader[s.format]);
                        break;
                    case "bitmapFont":
                        this.bitmapFont(s.key, s.textureURL, s.atlasURL, s.atlasData, s.xSpacing, s.ySpacing);
                        break;
                    case "atlasJSONArray":
                        this.atlasJSONArray(s.key, s.textureURL, s.atlasURL, s.atlasData);
                        break;
                    case "atlasJSONHash":
                        this.atlasJSONHash(s.key, s.textureURL, s.atlasURL, s.atlasData);
                        break;
                    case "atlasXML":
                        this.atlasXML(s.key, s.textureURL, s.atlasURL, s.atlasData);
                        break;
                    case "atlas":
                        this.atlas(s.key, s.textureURL, s.atlasURL, s.atlasData, H.Loader[s.format]);
                        break;
                    case "shader":
                        this.shader(s.key, s.url, s.overwrite)
                    }
                }
        },
        transformUrl: function(t, e) {
            return !!t && (t.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/) ? t : this.baseURL + e.path + t)
        },
        loadFile: function(t) {
            switch (t.type) {
            case "packfile":
                this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.fileComplete);
                break;
            case "image":
            case "spritesheet":
            case "textureatlas":
            case "bitmapfont":
                this.loadImageTag(t);
                break;
            case "audio":
                t.url = this.getAudioURL(t.url),
                t.url ? this.game.sound.usingWebAudio ? this.xhrLoad(t, this.transformUrl(t.url, t), "arraybuffer", this.fileComplete) : this.game.sound.usingAudioTag && this.loadAudioTag(t) : this.fileError(t, null, "No supported audio URL specified or device does not have audio playback support");
                break;
            case "video":
                t.url = this.getVideoURL(t.url),
                t.url ? t.asBlob ? this.xhrLoad(t, this.transformUrl(t.url, t), "blob", this.fileComplete) : this.loadVideoTag(t) : this.fileError(t, null, "No supported video URL specified or device does not have video playback support");
                break;
            case "json":
                this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.jsonLoadComplete);
                break;
            case "xml":
                this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.xmlLoadComplete);
                break;
            case "tilemap":
                t.format === H.Tilemap.TILED_JSON ? this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.jsonLoadComplete) : t.format === H.Tilemap.CSV ? this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.csvLoadComplete) : this.asyncComplete(t, "invalid Tilemap format: " + t.format);
                break;
            case "text":
            case "script":
            case "shader":
            case "physics":
                this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.fileComplete);
                break;
            case "binary":
                this.xhrLoad(t, this.transformUrl(t.url, t), "arraybuffer", this.fileComplete)
            }
        },
        loadImageTag: function(t) {
            var e = this;
            t.data = new Image,
            t.data.name = t.key,
            this.crossOrigin && (t.data.crossOrigin = this.crossOrigin),
            t.data.onload = function() {
                t.data.onload && (t.data.onload = null,
                t.data.onerror = null,
                e.fileComplete(t))
            }
            ,
            t.data.onerror = function() {
                t.data.onload && (t.data.onload = null,
                t.data.onerror = null,
                e.fileError(t))
            }
            ,
            t.data.src = this.transformUrl(t.url, t),
            t.data.complete && t.data.width && t.data.height && (t.data.onload = null,
            t.data.onerror = null,
            this.fileComplete(t))
        },
        loadVideoTag: function(t) {
            var e = this;
            t.data = document.createElement("video"),
            t.data.name = t.key,
            t.data.controls = !1,
            t.data.autoplay = !1;
            var i = function() {
                t.data.removeEventListener(t.loadEvent, i, !1),
                t.data.onerror = null,
                t.data.canplay = !0,
                H.GAMES[e.game.id].load.fileComplete(t)
            };
            t.data.onerror = function() {
                t.data.removeEventListener(t.loadEvent, i, !1),
                t.data.onerror = null,
                t.data.canplay = !1,
                e.fileError(t)
            }
            ,
            t.data.addEventListener(t.loadEvent, i, !1),
            t.data.src = this.transformUrl(t.url, t),
            t.data.load()
        },
        loadAudioTag: function(t) {
            var e = this;
            if (this.game.sound.touchLocked)
                t.data = new Audio,
                t.data.name = t.key,
                t.data.preload = "auto",
                t.data.src = this.transformUrl(t.url, t),
                this.fileComplete(t);
            else {
                t.data = new Audio,
                t.data.name = t.key;
                var i = function() {
                    t.data.removeEventListener("canplaythrough", i, !1),
                    t.data.onerror = null,
                    e.fileComplete(t)
                };
                t.data.onerror = function() {
                    t.data.removeEventListener("canplaythrough", i, !1),
                    t.data.onerror = null,
                    e.fileError(t)
                }
                ,
                t.data.preload = "auto",
                t.data.src = this.transformUrl(t.url, t),
                t.data.addEventListener("canplaythrough", i, !1),
                t.data.load()
            }
        },
        xhrLoad: function(e, t, i, s, n) {
            if (this.useXDomainRequest && window.XDomainRequest)
                this.xhrLoadWithXDR(e, t, i, s, n);
            else {
                var r = new XMLHttpRequest;
                r.open("GET", t, !0),
                r.responseType = i,
                !1 !== this.headers.requestedWith && r.setRequestHeader("X-Requested-With", this.headers.requestedWith),
                this.headers[e.type] && r.setRequestHeader("Accept", this.headers[e.type]),
                n = n || this.fileError;
                var o = this;
                r.onload = function() {
                    try {
                        return 4 === r.readyState && 400 <= r.status && r.status <= 599 ? n.call(o, e, r) : s.call(o, e, r)
                    } catch (t) {
                        o.hasLoaded ? window.console : o.asyncComplete(e, t.message || "Exception")
                    }
                }
                ,
                r.onerror = function() {
                    try {
                        return n.call(o, e, r)
                    } catch (t) {
                        o.hasLoaded ? window.console : o.asyncComplete(e, t.message || "Exception")
                    }
                }
                ,
                e.requestObject = r,
                e.requestUrl = t,
                r.send()
            }
        },
        xhrLoadWithXDR: function(e, t, i, s, n) {
            this._warnedAboutXDomainRequest || this.game.device.ie && !(10 <= this.game.device.ieVersion) || (this._warnedAboutXDomainRequest = !0);
            var r = new window.XDomainRequest;
            r.open("GET", t, !0),
            r.responseType = i,
            r.timeout = 3e3,
            n = n || this.fileError;
            var o = this;
            r.onerror = function() {
                try {
                    return n.call(o, e, r)
                } catch (t) {
                    o.asyncComplete(e, t.message || "Exception")
                }
            }
            ,
            r.ontimeout = function() {
                try {
                    return n.call(o, e, r)
                } catch (t) {
                    o.asyncComplete(e, t.message || "Exception")
                }
            }
            ,
            r.onprogress = function() {}
            ,
            r.onload = function() {
                try {
                    return 4 === r.readyState && 400 <= r.status && r.status <= 599 ? n.call(o, e, r) : s.call(o, e, r)
                } catch (t) {
                    o.asyncComplete(e, t.message || "Exception")
                }
            }
            ,
            e.requestObject = r,
            e.requestUrl = t,
            setTimeout(function() {
                r.send()
            }, 0)
        },
        getVideoURL: function(t) {
            for (var e = 0; e < t.length; e++) {
                var i, s = t[e];
                if (s.uri) {
                    if (i = s.type,
                    s = s.uri,
                    this.game.device.canPlayVideo(i))
                        return s
                } else {
                    if (0 === s.indexOf("blob:") || 0 === s.indexOf("data:"))
                        return s;
                    if (0 <= s.indexOf("?") && (s = s.substr(0, s.indexOf("?"))),
                    i = s.substr((Math.max(0, s.lastIndexOf(".")) || 1 / 0) + 1).toLowerCase(),
                    this.game.device.canPlayVideo(i))
                        return t[e]
                }
            }
            return null
        },
        getAudioURL: function(t) {
            if (this.game.sound.noAudio)
                return null;
            for (var e = 0; e < t.length; e++) {
                var i, s = t[e];
                if (s.uri) {
                    if (i = s.type,
                    s = s.uri,
                    this.game.device.canPlayAudio(i))
                        return s
                } else {
                    if (0 === s.indexOf("blob:") || 0 === s.indexOf("data:"))
                        return s;
                    if (0 <= s.indexOf("?") && (s = s.substr(0, s.indexOf("?"))),
                    i = s.substr((Math.max(0, s.lastIndexOf(".")) || 1 / 0) + 1).toLowerCase(),
                    this.game.device.canPlayAudio(i))
                        return t[e]
                }
            }
            return null
        },
        fileError: function(t, e, i) {
            var s = "error loading asset from URL " + (t.requestUrl || this.transformUrl(t.url, t));
            !i && e && (i = e.status),
            i && (s = s + " (" + i + ")"),
            this.asyncComplete(t, s)
        },
        fileComplete: function(t, e) {
            var i = !0;
            switch (t.type) {
            case "packfile":
                var s = JSON.parse(e.responseText);
                t.data = s || {};
                break;
            case "image":
                this.cache.addImage(t.key, t.url, t.data);
                break;
            case "spritesheet":
                this.cache.addSpriteSheet(t.key, t.url, t.data, t.frameWidth, t.frameHeight, t.frameMax, t.margin, t.spacing);
                break;
            case "textureatlas":
                if (null == t.atlasURL)
                    this.cache.addTextureAtlas(t.key, t.url, t.data, t.atlasData, t.format);
                else if (i = !1,
                t.format === H.Loader.TEXTURE_ATLAS_JSON_ARRAY || t.format === H.Loader.TEXTURE_ATLAS_JSON_HASH || t.format === H.Loader.TEXTURE_ATLAS_JSON_PYXEL)
                    this.xhrLoad(t, this.transformUrl(t.atlasURL, t), "text", this.jsonLoadComplete);
                else {
                    if (t.format !== H.Loader.TEXTURE_ATLAS_XML_STARLING)
                        throw new Error("Phaser.Loader. Invalid Texture Atlas format: " + t.format);
                    this.xhrLoad(t, this.transformUrl(t.atlasURL, t), "text", this.xmlLoadComplete)
                }
                break;
            case "bitmapfont":
                t.atlasURL ? (i = !1,
                this.xhrLoad(t, this.transformUrl(t.atlasURL, t), "text", function(t, e) {
                    var i;
                    try {
                        i = JSON.parse(e.responseText)
                    } catch (t) {}
                    i ? (t.atlasType = "json",
                    this.jsonLoadComplete(t, e)) : (t.atlasType = "xml",
                    this.xmlLoadComplete(t, e))
                })) : this.cache.addBitmapFont(t.key, t.url, t.data, t.atlasData, t.atlasType, t.xSpacing, t.ySpacing);
                break;
            case "video":
                if (t.asBlob)
                    try {
                        t.data = e.response
                    } catch (e) {
                        throw new Error("Phaser.Loader. Unable to parse video file as Blob: " + t.key)
                    }
                this.cache.addVideo(t.key, t.url, t.data, t.asBlob);
                break;
            case "audio":
                this.game.sound.usingWebAudio ? (t.data = e.response,
                this.cache.addSound(t.key, t.url, t.data, !0, !1),
                t.autoDecode && this.game.sound.decode(t.key)) : this.cache.addSound(t.key, t.url, t.data, !1, !0);
                break;
            case "text":
                t.data = e.responseText,
                this.cache.addText(t.key, t.url, t.data);
                break;
            case "shader":
                t.data = e.responseText,
                this.cache.addShader(t.key, t.url, t.data);
                break;
            case "physics":
                s = JSON.parse(e.responseText);
                this.cache.addPhysicsData(t.key, t.url, s, t.format);
                break;
            case "script":
                t.data = document.createElement("script"),
                t.data.language = "javascript",
                t.data.type = "text/javascript",
                t.data.defer = !1,
                t.data.text = e.responseText,
                document.head.appendChild(t.data),
                t.callback && (t.data = t.callback.call(t.callbackContext, t.key, e.responseText));
                break;
            case "binary":
                t.callback ? t.data = t.callback.call(t.callbackContext, t.key, e.response) : t.data = e.response,
                this.cache.addBinary(t.key, t.data)
            }
            i && this.asyncComplete(t)
        },
        jsonLoadComplete: function(t, e) {
            var i = JSON.parse(e.responseText);
            "tilemap" === t.type ? this.cache.addTilemap(t.key, t.url, i, t.format) : "bitmapfont" === t.type ? this.cache.addBitmapFont(t.key, t.url, t.data, i, t.atlasType, t.xSpacing, t.ySpacing) : "json" === t.type ? this.cache.addJSON(t.key, t.url, i) : this.cache.addTextureAtlas(t.key, t.url, t.data, i, t.format),
            this.asyncComplete(t)
        },
        csvLoadComplete: function(t, e) {
            var i = e.responseText;
            this.cache.addTilemap(t.key, t.url, i, t.format),
            this.asyncComplete(t)
        },
        xmlLoadComplete: function(t, e) {
            var i = e.responseText
              , s = this.parseXml(i);
            if (s)
                "bitmapfont" === t.type ? this.cache.addBitmapFont(t.key, t.url, t.data, s, t.atlasType, t.xSpacing, t.ySpacing) : "textureatlas" === t.type ? this.cache.addTextureAtlas(t.key, t.url, t.data, s, t.format) : "xml" === t.type && this.cache.addXML(t.key, t.url, s),
                this.asyncComplete(t);
            else {
                e.responseType || e.contentType;
                this.asyncComplete(t, "invalid XML")
            }
        },
        parseXml: function(t) {
            var e;
            try {
                if (window.DOMParser)
                    e = (new DOMParser).parseFromString(t, "text/xml");
                else
                    (e = new ActiveXObject("Microsoft.XMLDOM")).async = "false",
                    e.loadXML(t)
            } catch (t) {
                e = null
            }
            return e && e.documentElement && !e.getElementsByTagName("parsererror").length ? e : null
        },
        updateProgress: function() {
            this.preloadSprite && (0 === this.preloadSprite.direction ? this.preloadSprite.rect.width = Math.floor(this.preloadSprite.width / 100 * this.progress) : this.preloadSprite.rect.height = Math.floor(this.preloadSprite.height / 100 * this.progress),
            this.preloadSprite.sprite ? this.preloadSprite.sprite.updateCrop() : this.preloadSprite = null)
        },
        totalLoadedFiles: function() {
            return this._loadedFileCount
        },
        totalQueuedFiles: function() {
            return this._totalFileCount - this._loadedFileCount
        },
        totalLoadedPacks: function() {
            return this._totalPackCount
        },
        totalQueuedPacks: function() {
            return this._totalPackCount - this._loadedPackCount
        }
    },
    Object.defineProperty(H.Loader.prototype, "progressFloat", {
        get: function() {
            var t = this._loadedFileCount / this._totalFileCount * 100;
            return H.Math.clamp(t || 0, 0, 100)
        }
    }),
    Object.defineProperty(H.Loader.prototype, "progress", {
        get: function() {
            return Math.round(this.progressFloat)
        }
    }),
    H.Loader.prototype.constructor = H.Loader,
    H.LoaderParser = {
        bitmapFont: function(t, e, i, s) {
            return this.xmlBitmapFont(t, e, i, s)
        },
        xmlBitmapFont: function(t, e, i, s) {
            var n = {}
              , r = t.getElementsByTagName("info")[0]
              , o = t.getElementsByTagName("common")[0];
            n.font = r.getAttribute("face"),
            n.size = parseInt(r.getAttribute("size"), 10),
            n.lineHeight = parseInt(o.getAttribute("lineHeight"), 10) + s,
            n.chars = {};
            for (var a = t.getElementsByTagName("char"), h = 0; h < a.length; h++) {
                var l = parseInt(a[h].getAttribute("id"), 10);
                n.chars[l] = {
                    x: parseInt(a[h].getAttribute("x"), 10),
                    y: parseInt(a[h].getAttribute("y"), 10),
                    width: parseInt(a[h].getAttribute("width"), 10),
                    height: parseInt(a[h].getAttribute("height"), 10),
                    xOffset: parseInt(a[h].getAttribute("xoffset"), 10),
                    yOffset: parseInt(a[h].getAttribute("yoffset"), 10),
                    xAdvance: parseInt(a[h].getAttribute("xadvance"), 10) + i,
                    kerning: {}
                }
            }
            var c = t.getElementsByTagName("kerning");
            for (h = 0; h < c.length; h++) {
                var d = parseInt(c[h].getAttribute("first"), 10)
                  , u = parseInt(c[h].getAttribute("second"), 10)
                  , p = parseInt(c[h].getAttribute("amount"), 10);
                n.chars[u].kerning[d] = p
            }
            return this.finalizeBitmapFont(e, n)
        },
        jsonBitmapFont: function(t, e, i, s) {
            var n = {
                font: t.font.info._face,
                size: parseInt(t.font.info._size, 10),
                lineHeight: parseInt(t.font.common._lineHeight, 10) + s,
                chars: {}
            };
            return t.font.chars.char.forEach(function(t) {
                var e = parseInt(t._id, 10);
                n.chars[e] = {
                    x: parseInt(t._x, 10),
                    y: parseInt(t._y, 10),
                    width: parseInt(t._width, 10),
                    height: parseInt(t._height, 10),
                    xOffset: parseInt(t._xoffset, 10),
                    yOffset: parseInt(t._yoffset, 10),
                    xAdvance: parseInt(t._xadvance, 10) + i,
                    kerning: {}
                }
            }),
            t.font.kernings && t.font.kernings.kerning && t.font.kernings.kerning.forEach(function(t) {
                n.chars[t._second].kerning[t._first] = parseInt(t._amount, 10)
            }),
            this.finalizeBitmapFont(e, n)
        },
        finalizeBitmapFont: function(i, s) {
            return Object.keys(s.chars).forEach(function(t) {
                var e = s.chars[t];
                e.texture = new PIXI.Texture(i,new H.Rectangle(e.x,e.y,e.width,e.height))
            }),
            s
        }
    },
    H.AudioSprite = function(t, e) {
        for (var i in this.game = t,
        this.key = e,
        this.config = this.game.cache.getJSON(e + "-audioatlas"),
        this.autoplayKey = null,
        this.autoplay = !1,
        this.sounds = {},
        this.config.spritemap) {
            var s = this.config.spritemap[i]
              , n = this.game.add.sound(this.key);
            n.addMarker(i, s.start, s.end - s.start, null, s.loop),
            this.sounds[i] = n
        }
        this.config.autoplay && (this.autoplayKey = this.config.autoplay,
        this.play(this.autoplayKey),
        this.autoplay = this.sounds[this.autoplayKey])
    }
    ,
    H.AudioSprite.prototype = {
        play: function(t, e) {
            return void 0 === e && (e = 1),
            this.sounds[t].play(t, null, e)
        },
        stop: function(t) {
            if (t)
                this.sounds[t].stop();
            else
                for (var e in this.sounds)
                    this.sounds[e].stop()
        },
        get: function(t) {
            return this.sounds[t]
        }
    },
    H.AudioSprite.prototype.constructor = H.AudioSprite,
    H.Sound = function(t, e, i, s, n) {
        void 0 === i && (i = 1),
        void 0 === s && (s = !1),
        void 0 === n && (n = t.sound.connectToMaster),
        this.game = t,
        this.name = e,
        this.key = e,
        this.loop = s,
        this.markers = {},
        this.context = null,
        this.autoplay = !1,
        this.totalDuration = 0,
        this.startTime = 0,
        this.currentTime = 0,
        this.duration = 0,
        this.durationMS = 0,
        this.position = 0,
        this.stopTime = 0,
        this.paused = !1,
        this.pausedPosition = 0,
        this.pausedTime = 0,
        this.isPlaying = !1,
        this.currentMarker = "",
        this.fadeTween = null,
        this.pendingPlayback = !1,
        this.override = !1,
        this.allowMultiple = !1,
        this.usingWebAudio = this.game.sound.usingWebAudio,
        this.usingAudioTag = this.game.sound.usingAudioTag,
        this.externalNode = null,
        this.masterGainNode = null,
        this.gainNode = null,
        this._sound = null,
        this.usingWebAudio ? (this.context = this.game.sound.context,
        this.masterGainNode = this.game.sound.masterGain,
        void 0 === this.context.createGain ? this.gainNode = this.context.createGainNode() : this.gainNode = this.context.createGain(),
        this.gainNode.gain.value = i * this.game.sound.volume,
        n && this.gainNode.connect(this.masterGainNode)) : this.usingAudioTag && (this.game.cache.getSound(e) && this.game.cache.isSoundReady(e) ? (this._sound = this.game.cache.getSoundData(e),
        this.totalDuration = 0,
        this._sound.duration && (this.totalDuration = this._sound.duration)) : this.game.cache.onSoundUnlock.add(this.soundHasUnlocked, this)),
        this.onDecoded = new H.Signal,
        this.onPlay = new H.Signal,
        this.onPause = new H.Signal,
        this.onResume = new H.Signal,
        this.onLoop = new H.Signal,
        this.onStop = new H.Signal,
        this.onMute = new H.Signal,
        this.onMarkerComplete = new H.Signal,
        this.onFadeComplete = new H.Signal,
        this._volume = i,
        this._buffer = null,
        this._muted = !1,
        this._tempMarker = 0,
        this._tempPosition = 0,
        this._tempVolume = 0,
        this._tempPause = 0,
        this._muteVolume = 0,
        this._tempLoop = 0,
        this._paused = !1,
        this._onDecodedEventDispatched = !1
    }
    ,
    H.Sound.prototype = {
        soundHasUnlocked: function(t) {
            t === this.key && (this._sound = this.game.cache.getSoundData(this.key),
            this.totalDuration = this._sound.duration)
        },
        addMarker: function(t, e, i, s, n) {
            null != i || (i = 1),
            null != s || (s = 1),
            void 0 === n && (n = !1),
            this.markers[t] = {
                name: t,
                start: e,
                stop: e + i,
                volume: s,
                duration: i,
                durationMS: 1e3 * i,
                loop: n
            }
        },
        removeMarker: function(t) {
            delete this.markers[t]
        },
        onEndedHandler: function() {
            this._sound.onended = null,
            this.isPlaying = !1,
            this.currentTime = this.durationMS,
            this.stop()
        },
        update: function() {
            this.game.cache.checkSoundKey(this.key) ? (this.isDecoded && !this._onDecodedEventDispatched && (this.onDecoded.dispatch(this),
            this._onDecodedEventDispatched = !0),
            this.pendingPlayback && this.game.cache.isSoundReady(this.key) && (this.pendingPlayback = !1,
            this.play(this._tempMarker, this._tempPosition, this._tempVolume, this._tempLoop)),
            this.isPlaying && (this.currentTime = this.game.time.time - this.startTime,
            this.currentTime >= this.durationMS && (this.usingWebAudio ? this.loop ? (this.onLoop.dispatch(this),
            this.isPlaying = !1,
            "" === this.currentMarker ? (this.currentTime = 0,
            this.startTime = this.game.time.time,
            this.isPlaying = !0) : (this.onMarkerComplete.dispatch(this.currentMarker, this),
            this.play(this.currentMarker, 0, this.volume, !0, !0))) : "" !== this.currentMarker && this.stop() : this.loop ? (this.onLoop.dispatch(this),
            "" === this.currentMarker && (this.currentTime = 0,
            this.startTime = this.game.time.time),
            this.isPlaying = !1,
            this.play(this.currentMarker, 0, this.volume, !0, !0)) : this.stop()))) : this.destroy()
        },
        loopFull: function(t) {
            return this.play(null, 0, t, !0)
        },
        play: function(t, e, i, s, n) {
            if (void 0 !== t && !1 !== t && null !== t || (t = ""),
            void 0 === n && (n = !0),
            this.isPlaying && !this.allowMultiple && !n && !this.override)
                return this;
            if (this._sound && this.isPlaying && !this.allowMultiple && (this.override || n)) {
                if (this.usingWebAudio) {
                    if (void 0 === this._sound.stop)
                        this._sound.noteOff(0);
                    else
                        try {
                            this._sound.stop(0)
                        } catch (t) {}
                    this.externalNode ? this._sound.disconnect(this.externalNode) : this.gainNode && this._sound.disconnect(this.gainNode)
                } else
                    this.usingAudioTag && (this._sound.pause(),
                    this._sound.currentTime = 0);
                this.isPlaying = !1
            }
            var r = Object.keys(this.markers);
            if ("" === t && 1 === r.length && (t = r[0]),
            "" === t && 0 < r.length)
                return this;
            if ("" !== t) {
                if (!this.markers[t])
                    return this;
                this.currentMarker = t,
                this.position = this.markers[t].start,
                this.volume = this.markers[t].volume,
                this.loop = this.markers[t].loop,
                this.duration = this.markers[t].duration,
                this.durationMS = this.markers[t].durationMS,
                void 0 !== i && (this.volume = i),
                void 0 !== s && (this.loop = s),
                this._tempMarker = t,
                this._tempPosition = this.position,
                this._tempVolume = this.volume,
                this._tempLoop = this.loop
            } else
                e = e || 0,
                void 0 === i && (i = this._volume),
                void 0 === s && (s = this.loop),
                this.position = Math.max(0, e),
                this.volume = i,
                this.loop = s,
                this.duration = 0,
                this.durationMS = 0,
                this._tempMarker = t,
                this._tempPosition = e,
                this._tempVolume = i,
                this._tempLoop = s;
            return this.usingWebAudio ? this.game.cache.isSoundDecoded(this.key) ? (this._sound = this.context.createBufferSource(),
            this.externalNode ? this._sound.connect(this.externalNode) : this._sound.connect(this.gainNode),
            this._buffer = this.game.cache.getSoundData(this.key),
            this._sound.buffer = this._buffer,
            this.loop && "" === t && (this._sound.loop = !0),
            this.loop || "" !== t || (this._sound.onended = this.onEndedHandler.bind(this)),
            this.totalDuration = this._sound.buffer.duration,
            0 === this.duration && (this.duration = this.totalDuration,
            this.durationMS = Math.ceil(1e3 * this.totalDuration)),
            void 0 === this._sound.start ? this._sound.noteGrainOn(0, this.position, this.duration) : this.loop && "" === t ? this._sound.start(0, 0) : this._sound.start(0, this.position, this.duration),
            this.isPlaying = !0,
            this.startTime = this.game.time.time,
            this.currentTime = 0,
            this.stopTime = this.startTime + this.durationMS,
            this.onPlay.dispatch(this)) : (this.pendingPlayback = !0,
            this.game.cache.getSound(this.key) && !1 === this.game.cache.getSound(this.key).isDecoding && this.game.sound.decode(this.key, this)) : this.game.cache.getSound(this.key) && this.game.cache.getSound(this.key).locked ? (this.game.cache.reloadSound(this.key),
            this.pendingPlayback = !0) : this._sound && (this.game.device.wechatMinigame || this.game.device.cocoonJS || 4 === this._sound.readyState) ? (this.loop && (this._sound.loop = !0),
            !this.loop && "" === t && this.game.device.wechatMinigame && this._sound.addEventListener("ended", this.onEndedHandler.bind(this)),
            this._sound.play(),
            this.totalDuration = this._sound.duration,
            0 === this.duration && (this.duration = this.totalDuration,
            this.durationMS = 1e3 * this.totalDuration),
            this._sound.currentTime = this.position,
            this._sound.muted = this._muted,
            this._muted || this.game.sound.mute ? this._sound.volume = 0 : this._sound.volume = this._volume,
            this.isPlaying = !0,
            this.startTime = this.game.time.time,
            this.currentTime = 0,
            this.stopTime = this.startTime + this.durationMS,
            this.onPlay.dispatch(this)) : this.pendingPlayback = !0,
            this
        },
        restart: function(t, e, i, s) {
            t = t || "",
            e = e || 0,
            i = i || 1,
            void 0 === s && (s = !1),
            this.play(t, e, i, s, !0)
        },
        pause: function() {
            this.isPlaying && this._sound && (this.paused = !0,
            this.pausedPosition = this.currentTime,
            this.pausedTime = this.game.time.time,
            this._tempPause = this._sound.currentTime,
            this.onPause.dispatch(this),
            this.stop())
        },
        resume: function() {
            if (this.paused && this._sound) {
                if (this.usingWebAudio) {
                    var t = Math.max(0, this.position + this.pausedPosition / 1e3);
                    this._sound = this.context.createBufferSource(),
                    this._sound.buffer = this._buffer,
                    this.externalNode ? this._sound.connect(this.externalNode) : this._sound.connect(this.gainNode),
                    this.loop && (this._sound.loop = !0),
                    this.loop || "" !== this.currentMarker || (this._sound.onended = this.onEndedHandler.bind(this));
                    var e = this.duration - this.pausedPosition / 1e3;
                    void 0 === this._sound.start ? this._sound.noteGrainOn(0, t, e) : this.loop && this.game.device.chrome ? 42 === this.game.device.chromeVersion ? this._sound.start(0) : this._sound.start(0, t) : this._sound.start(0, t, e)
                } else
                    this._sound.currentTime = this._tempPause,
                    this._sound.play();
                this.isPlaying = !0,
                this.paused = !1,
                this.startTime += this.game.time.time - this.pausedTime,
                this.onResume.dispatch(this)
            }
        },
        stop: function() {
            if (this.isPlaying && this._sound)
                if (this.usingWebAudio) {
                    if (void 0 === this._sound.stop)
                        this._sound.noteOff(0);
                    else
                        try {
                            this._sound.stop(0)
                        } catch (t) {}
                    this.externalNode ? this._sound.disconnect(this.externalNode) : this.gainNode && this._sound.disconnect(this.gainNode)
                } else
                    this.usingAudioTag && (this._sound.pause(),
                    this._sound.currentTime = 0);
            if (this.pendingPlayback = !1,
            this.isPlaying = !1,
            !this.paused) {
                var t = this.currentMarker;
                "" !== this.currentMarker && this.onMarkerComplete.dispatch(this.currentMarker, this),
                this.currentMarker = "",
                null !== this.fadeTween && this.fadeTween.stop(),
                this.onStop.dispatch(this, t)
            }
        },
        fadeIn: function(t, e, i) {
            void 0 === e && (e = !1),
            void 0 === i && (i = this.currentMarker),
            this.paused || (this.play(i, 0, 0, e),
            this.fadeTo(t, 1))
        },
        fadeOut: function(t) {
            this.fadeTo(t, 0)
        },
        fadeTo: function(t, e) {
            if (this.isPlaying && !this.paused && e !== this.volume) {
                if (void 0 === t && (t = 1e3),
                void 0 === e)
                    return;
                this.fadeTween = this.game.add.tween(this).to({
                    volume: e
                }, t, H.Easing.Linear.None, !0),
                this.fadeTween.onComplete.add(this.fadeComplete, this)
            }
        },
        fadeComplete: function() {
            this.onFadeComplete.dispatch(this, this.volume),
            0 === this.volume && this.stop()
        },
        updateGlobalVolume: function(t) {
            this.usingAudioTag && this._sound && (this._sound.volume = t * this._volume)
        },
        destroy: function(t) {
            void 0 === t && (t = !0),
            this.stop(),
            t ? this.game.sound.remove(this) : (this.markers = {},
            this.context = null,
            this._buffer = null,
            this.externalNode = null,
            this.onDecoded.dispose(),
            this.onPlay.dispose(),
            this.onPause.dispose(),
            this.onResume.dispose(),
            this.onLoop.dispose(),
            this.onStop.dispose(),
            this.onMute.dispose(),
            this.onMarkerComplete.dispose())
        }
    },
    H.Sound.prototype.constructor = H.Sound,
    Object.defineProperty(H.Sound.prototype, "isDecoding", {
        get: function() {
            return this.game.cache.getSound(this.key).isDecoding
        }
    }),
    Object.defineProperty(H.Sound.prototype, "isDecoded", {
        get: function() {
            return this.game.cache.isSoundDecoded(this.key)
        }
    }),
    Object.defineProperty(H.Sound.prototype, "mute", {
        get: function() {
            return this._muted || this.game.sound.mute
        },
        set: function(t) {
            (t = t || !1) !== this._muted && (t ? (this._muted = !0,
            this._muteVolume = this._tempVolume,
            this.game.device.wechatMinigame ? this._sound.pause() : this.usingWebAudio ? this.gainNode.gain.value = 0 : this.usingAudioTag && this._sound && (this._sound.volume = 0)) : (this._muted = !1,
            this.game.device.wechatMinigame && this.isPlaying ? this._sound.play() : this.usingWebAudio ? this.gainNode.gain.value = this._muteVolume : this.usingAudioTag && this._sound && (this._sound.volume = this._muteVolume)),
            this.onMute.dispatch(this))
        }
    }),
    Object.defineProperty(H.Sound.prototype, "volume", {
        get: function() {
            return this._volume
        },
        set: function(t) {
            this.game.device.firefox && this.usingAudioTag && (t = this.game.math.clamp(t, 0, 1)),
            this._muted ? this._muteVolume = t : (this._tempVolume = t,
            this._volume = t,
            this.usingWebAudio ? this.gainNode.gain.value = t : this.usingAudioTag && this._sound && (this._sound.volume = t))
        }
    }),
    H.SoundManager = function(t) {
        this.game = t,
        this.onSoundDecode = new H.Signal,
        this.onVolumeChange = new H.Signal,
        this.onMute = new H.Signal,
        this.onUnMute = new H.Signal,
        this.context = null,
        this.usingWebAudio = !1,
        this.usingAudioTag = !1,
        this.noAudio = !1,
        this.connectToMaster = !0,
        this.touchLocked = !1,
        this.channels = 32,
        this.muteOnPause = !0,
        this._codeMuted = !1,
        this._muted = !1,
        this._unlockSource = null,
        this._volume = 1,
        this._sounds = [],
        this._watchList = new H.ArraySet,
        this._watching = !1,
        this._watchCallback = null,
        this._watchContext = null
    }
    ,
    H.SoundManager.prototype = {
        boot: function() {
            if (this.game.device.iOS && !1 === this.game.device.webAudio && (this.channels = 1),
            window.PhaserGlobal) {
                if (!0 === window.PhaserGlobal.disableAudio)
                    return this.noAudio = !0,
                    void (this.touchLocked = !1);
                if (!0 === window.PhaserGlobal.disableWebAudio)
                    return this.usingAudioTag = !0,
                    void (this.touchLocked = !1)
            }
            if (window.PhaserGlobal && window.PhaserGlobal.audioContext)
                this.context = window.PhaserGlobal.audioContext;
            else if (window.AudioContext)
                try {
                    this.context = new window.AudioContext
                } catch (t) {
                    this.context = null,
                    this.usingWebAudio = !1,
                    this.touchLocked = !1
                }
            else if (window.webkitAudioContext)
                try {
                    this.context = new window.webkitAudioContext
                } catch (t) {
                    this.context = null,
                    this.usingWebAudio = !1,
                    this.touchLocked = !1
                }
            if (null === this.context) {
                if (void 0 === window.Audio)
                    return void (this.noAudio = !0);
                this.usingAudioTag = !0
            } else
                this.usingWebAudio = !0,
                void 0 === this.context.createGain ? this.masterGain = this.context.createGainNode() : this.masterGain = this.context.createGain(),
                this.masterGain.gain.value = 1,
                this.masterGain.connect(this.context.destination);
            this.noAudio || !this.game.device.cocoonJS && (this.game.device.chrome || this.game.device.iOS || window.PhaserGlobal && window.PhaserGlobal.fakeiOSTouchLock) && this.setTouchLock()
        },
        setTouchLock: function() {
            this.noAudio || window.PhaserGlobal && !0 === window.PhaserGlobal.disableAudio || (8 < this.game.device.iOSVersion || 55 <= this.game.device.chromeVersion ? this.game.input.touch.addTouchLockCallback(this.unlock, this, !0) : this.game.input.touch.addTouchLockCallback(this.unlock, this),
            this.touchLocked = !0)
        },
        unlock: function() {
            if (this.noAudio || !this.touchLocked || null !== this._unlockSource)
                return !0;
            if (this.usingAudioTag)
                this.touchLocked = !1,
                this._unlockSource = null;
            else if (this.usingWebAudio) {
                var t = this.context.createBuffer(1, 1, 22050);
                this._unlockSource = this.context.createBufferSource(),
                this._unlockSource.buffer = t,
                this._unlockSource.connect(this.context.destination),
                void 0 === this._unlockSource.start ? this._unlockSource.noteOn(0) : this._unlockSource.start(0),
                "suspended" === this._unlockSource.context.state && this._unlockSource.context.resume()
            }
            return !0
        },
        stopAll: function() {
            if (!this.noAudio)
                for (var t = 0; t < this._sounds.length; t++)
                    this._sounds[t] && this._sounds[t].stop()
        },
        pauseAll: function() {
            if (!this.noAudio)
                for (var t = 0; t < this._sounds.length; t++)
                    this._sounds[t] && this._sounds[t].pause()
        },
        resumeAll: function() {
            if (!this.noAudio)
                for (var t = 0; t < this._sounds.length; t++)
                    this._sounds[t] && this._sounds[t].resume()
        },
        decode: function(e, i) {
            i = i || null;
            var t = this.game.cache.getSoundData(e);
            if (t && !1 === this.game.cache.isSoundDecoded(e)) {
                this.game.cache.updateSound(e, "isDecoding", !0);
                var s = this;
                try {
                    this.context.decodeAudioData(t, function(t) {
                        t && (s.game.cache.decodedSound(e, t),
                        s.onSoundDecode.dispatch(e, i))
                    })
                } catch (e) {}
            }
        },
        setDecodedCallback: function(t, e, i) {
            "string" == typeof t && (t = [t]),
            this._watchList.reset();
            for (var s = 0; s < t.length; s++)
                t[s]instanceof H.Sound ? this.game.cache.isSoundDecoded(t[s].key) || this._watchList.add(t[s].key) : this.game.cache.isSoundDecoded(t[s]) || this._watchList.add(t[s]);
            0 === this._watchList.total ? (this._watching = !1,
            e.call(i)) : (this._watching = !0,
            this._watchCallback = e,
            this._watchContext = i)
        },
        update: function() {
            if (!this.noAudio) {
                !this.touchLocked || null === this._unlockSource || this._unlockSource.playbackState !== this._unlockSource.PLAYING_STATE && this._unlockSource.playbackState !== this._unlockSource.FINISHED_STATE || (this.touchLocked = !1,
                this._unlockSource = null);
                for (var t = 0; t < this._sounds.length; t++)
                    this._sounds[t].update();
                if (this._watching) {
                    for (var e = this._watchList.first; e; )
                        this.game.cache.isSoundDecoded(e) && this._watchList.remove(e),
                        e = this._watchList.next;
                    0 === this._watchList.total && (this._watching = !1,
                    this._watchCallback.call(this._watchContext))
                }
            }
        },
        add: function(t, e, i, s) {
            void 0 === e && (e = 1),
            void 0 === i && (i = !1),
            void 0 === s && (s = this.connectToMaster);
            var n = new H.Sound(this.game,t,e,i,s);
            return this._sounds.push(n),
            n
        },
        addSprite: function(t) {
            return new H.AudioSprite(this.game,t)
        },
        remove: function(t) {
            for (var e = this._sounds.length; e--; )
                if (this._sounds[e] === t)
                    return this._sounds[e].destroy(!1),
                    this._sounds.splice(e, 1),
                    !0;
            return !1
        },
        removeByKey: function(t) {
            for (var e = this._sounds.length, i = 0; e--; )
                this._sounds[e].key === t && (this._sounds[e].destroy(!1),
                this._sounds.splice(e, 1),
                i++);
            return i
        },
        play: function(t, e, i) {
            if (!this.noAudio) {
                var s = this.add(t, e, i);
                return s.play(),
                s
            }
        },
        setMute: function() {
            if (!this._muted) {
                this._muted = !0,
                this.usingWebAudio && (this._muteVolume = this.masterGain.gain.value,
                this.masterGain.gain.value = 0);
                for (var t = 0; t < this._sounds.length; t++)
                    this._sounds[t].usingAudioTag && (this._sounds[t].mute = !0);
                this.onMute.dispatch()
            }
        },
        unsetMute: function() {
            if (this._muted && !this._codeMuted) {
                this._muted = !1,
                this.usingWebAudio && (this.masterGain.gain.value = this._muteVolume);
                for (var t = 0; t < this._sounds.length; t++)
                    this._sounds[t].usingAudioTag && (this._sounds[t].mute = !1);
                this.onUnMute.dispatch()
            }
        },
        destroy: function() {
            this.stopAll();
            for (var t = 0; t < this._sounds.length; t++)
                this._sounds[t] && this._sounds[t].destroy();
            this._sounds = [],
            this.onSoundDecode.dispose(),
            this.context && (window.PhaserGlobal ? window.PhaserGlobal.audioContext = this.context : this.context.close && this.context.close())
        }
    },
    H.SoundManager.prototype.constructor = H.SoundManager,
    Object.defineProperty(H.SoundManager.prototype, "mute", {
        get: function() {
            return this._muted
        },
        set: function(t) {
            if (t = t || !1) {
                if (this._muted)
                    return;
                this._codeMuted = !0,
                this.setMute()
            } else {
                if (!this._muted)
                    return;
                this._codeMuted = !1,
                this.unsetMute()
            }
        }
    }),
    Object.defineProperty(H.SoundManager.prototype, "volume", {
        get: function() {
            return this._volume
        },
        set: function(t) {
            if (t < 0 ? t = 0 : 1 < t && (t = 1),
            this._volume !== t) {
                if (this._volume = t,
                this.usingWebAudio)
                    this.masterGain.gain.value = t;
                else
                    for (var e = 0; e < this._sounds.length; e++)
                        this._sounds[e].usingAudioTag && this._sounds[e].updateGlobalVolume(t);
                this.onVolumeChange.dispatch(t)
            }
        }
    }),
    H.ScaleManager = function(t, e, i) {
        this.game = t,
        this.dom = H.DOM,
        this.grid = null,
        this.width = 0,
        this.height = 0,
        this.minWidth = null,
        this.maxWidth = null,
        this.minHeight = null,
        this.maxHeight = null,
        this.offset = new H.Point,
        this.forceLandscape = !1,
        this.forcePortrait = !1,
        this.incorrectOrientation = !1,
        this._pageAlignHorizontally = !1,
        this._pageAlignVertically = !1,
        this.onOrientationChange = new H.Signal,
        this.enterIncorrectOrientation = new H.Signal,
        this.leaveIncorrectOrientation = new H.Signal,
        this.hasPhaserSetFullScreen = !1,
        this.fullScreenTarget = null,
        this._createdFullScreenTarget = null,
        this.onFullScreenInit = new H.Signal,
        this.onFullScreenChange = new H.Signal,
        this.onFullScreenError = new H.Signal,
        this.screenOrientation = this.dom.getScreenOrientation(),
        this.scaleFactor = new H.Point(1,1),
        this.scaleFactorInversed = new H.Point(1,1),
        this.margin = {
            left: 0,
            top: 0,
            right: 0,
            bottom: 0,
            x: 0,
            y: 0
        },
        this.bounds = new H.Rectangle,
        this.aspectRatio = 0,
        this.sourceAspectRatio = 0,
        this.event = null,
        this.windowConstraints = {
            right: "layout",
            bottom: ""
        },
        this.compatibility = {
            supportsFullScreen: !1,
            orientationFallback: null,
            noMargins: !1,
            scrollTo: null,
            forceMinimumDocumentHeight: !1,
            canExpandParent: !0,
            clickTrampoline: ""
        },
        this._scaleMode = H.ScaleManager.NO_SCALE,
        this._fullScreenScaleMode = H.ScaleManager.NO_SCALE,
        this.parentIsWindow = !1,
        this.parentNode = null,
        this.parentScaleFactor = new H.Point(1,1),
        this.trackParentInterval = 2e3,
        this.onSizeChange = new H.Signal,
        this.onResize = null,
        this.onResizeContext = null,
        this._pendingScaleMode = null,
        this._fullScreenRestore = null,
        this._gameSize = new H.Rectangle,
        this._userScaleFactor = new H.Point(1,1),
        this._userScaleTrim = new H.Point(0,0),
        this._lastUpdate = 0,
        this._updateThrottle = 0,
        this._updateThrottleReset = 100,
        this._parentBounds = new H.Rectangle,
        this._tempBounds = new H.Rectangle,
        this._lastReportedCanvasSize = new H.Rectangle,
        this._lastReportedGameSize = new H.Rectangle,
        this._booted = !1,
        t.config && this.parseConfig(t.config),
        this.setupScale(e, i)
    }
    ,
    H.ScaleManager.EXACT_FIT = 0,
    H.ScaleManager.NO_SCALE = 1,
    H.ScaleManager.SHOW_ALL = 2,
    H.ScaleManager.RESIZE = 3,
    H.ScaleManager.USER_SCALE = 4,
    H.ScaleManager.prototype = {
        boot: function() {
            var t = this.compatibility;
            t.supportsFullScreen = this.game.device.fullscreen && !this.game.device.cocoonJS,
            this.game.device.iPad || this.game.device.webApp || this.game.device.desktop || (this.game.device.android && !this.game.device.chrome ? t.scrollTo = new H.Point(0,1) : t.scrollTo = new H.Point(0,0)),
            this.game.device.desktop ? (t.orientationFallback = "screen",
            t.clickTrampoline = "when-not-mouse") : (t.orientationFallback = "",
            t.clickTrampoline = "");
            var e = this;
            this._orientationChange = function(t) {
                return e.orientationChange(t)
            }
            ,
            this._windowResize = function(t) {
                return e.windowResize(t)
            }
            ,
            window.addEventListener("orientationchange", this._orientationChange, !1),
            window.addEventListener("resize", this._windowResize, !1),
            this.compatibility.supportsFullScreen && (this._fullScreenChange = function(t) {
                return e.fullScreenChange(t)
            }
            ,
            this._fullScreenError = function(t) {
                return e.fullScreenError(t)
            }
            ,
            document.addEventListener("webkitfullscreenchange", this._fullScreenChange, !1),
            document.addEventListener("mozfullscreenchange", this._fullScreenChange, !1),
            document.addEventListener("MSFullscreenChange", this._fullScreenChange, !1),
            document.addEventListener("fullscreenchange", this._fullScreenChange, !1),
            document.addEventListener("webkitfullscreenerror", this._fullScreenError, !1),
            document.addEventListener("mozfullscreenerror", this._fullScreenError, !1),
            document.addEventListener("MSFullscreenError", this._fullScreenError, !1),
            document.addEventListener("fullscreenerror", this._fullScreenError, !1)),
            this.game.onResume.add(this._gameResumed, this),
            this.dom.getOffset(this.game.canvas, this.offset),
            this.bounds.setTo(this.offset.x, this.offset.y, this.width, this.height),
            this.setGameSize(this.game.width, this.game.height),
            this.screenOrientation = this.dom.getScreenOrientation(this.compatibility.orientationFallback),
            H.FlexGrid && (this.grid = new H.FlexGrid(this,this.width,this.height)),
            this._booted = !0,
            null !== this._pendingScaleMode && (this.scaleMode = this._pendingScaleMode,
            this._pendingScaleMode = null)
        },
        parseConfig: function(t) {
            void 0 !== t.scaleMode && (this._booted ? this.scaleMode = t.scaleMode : this._pendingScaleMode = t.scaleMode),
            void 0 !== t.fullScreenScaleMode && (this.fullScreenScaleMode = t.fullScreenScaleMode),
            t.fullScreenTarget && (this.fullScreenTarget = t.fullScreenTarget)
        },
        setupScale: function(t, e) {
            var i, s = new H.Rectangle;
            "" !== this.game.parent && ("string" == typeof this.game.parent ? i = document.getElementById(this.game.parent) : this.game.parent && 1 === this.game.parent.nodeType && (i = this.game.parent)),
            i ? (this.parentNode = i,
            this.parentIsWindow = !1,
            this.getParentBounds(this._parentBounds),
            s.width = this._parentBounds.width,
            s.height = this._parentBounds.height,
            this.offset.set(this._parentBounds.x, this._parentBounds.y)) : (this.parentNode = null,
            this.parentIsWindow = !0,
            s.width = this.dom.visualBounds.width,
            s.height = this.dom.visualBounds.height,
            this.offset.set(0, 0));
            var n = 0
              , r = 0;
            n = "number" == typeof t ? t : (this.parentScaleFactor.x = parseInt(t, 10) / 100,
            s.width * this.parentScaleFactor.x),
            r = "number" == typeof e ? e : (this.parentScaleFactor.y = parseInt(e, 10) / 100,
            s.height * this.parentScaleFactor.y),
            n = Math.floor(n),
            r = Math.floor(r),
            this._gameSize.setTo(0, 0, n, r),
            this.updateDimensions(n, r, !1)
        },
        _gameResumed: function() {
            this.queueUpdate(!0)
        },
        setGameSize: function(t, e) {
            this._gameSize.setTo(0, 0, t, e),
            this.currentScaleMode !== H.ScaleManager.RESIZE && this.updateDimensions(t, e, !0),
            this.queueUpdate(!0)
        },
        setUserScale: function(t, e, i, s) {
            this._userScaleFactor.setTo(t, e),
            this._userScaleTrim.setTo(0 | i, 0 | s),
            this.queueUpdate(!0)
        },
        setResizeCallback: function(t, e) {
            this.onResize = t,
            this.onResizeContext = e
        },
        signalSizeChange: function() {
            if (!H.Rectangle.sameDimensions(this, this._lastReportedCanvasSize) || !H.Rectangle.sameDimensions(this.game, this._lastReportedGameSize)) {
                var t = this.width
                  , e = this.height;
                this._lastReportedCanvasSize.setTo(0, 0, t, e),
                this._lastReportedGameSize.setTo(0, 0, this.game.width, this.game.height),
                this.grid && this.grid.onResize(t, e),
                this.onSizeChange.dispatch(this, t, e),
                this.currentScaleMode === H.ScaleManager.RESIZE && (this.game.state.resize(t, e),
                this.game.load.resize(t, e))
            }
        },
        setMinMax: function(t, e, i, s) {
            this.minWidth = t,
            this.minHeight = e,
            void 0 !== i && (this.maxWidth = i),
            void 0 !== s && (this.maxHeight = s)
        },
        preUpdate: function() {
            if (!(this.game.time.time < this._lastUpdate + this._updateThrottle)) {
                var t = this._updateThrottle;
                this._updateThrottleReset = 400 <= t ? 0 : 100,
                this.dom.getOffset(this.game.canvas, this.offset);
                var e = this._parentBounds.width
                  , i = this._parentBounds.height
                  , s = this.getParentBounds(this._parentBounds)
                  , n = s.width !== e || s.height !== i
                  , r = this.updateOrientationState();
                (n || r) && (this.onResize && this.onResize.call(this.onResizeContext, this, s),
                this.updateLayout(),
                this.signalSizeChange());
                var o = 2 * this._updateThrottle;
                this._updateThrottle < t && (o = Math.min(t, this._updateThrottleReset)),
                this._updateThrottle = H.Math.clamp(o, 25, this.trackParentInterval),
                this._lastUpdate = this.game.time.time
            }
        },
        pauseUpdate: function() {
            this.preUpdate(),
            this._updateThrottle = this.trackParentInterval
        },
        updateDimensions: function(t, e, i) {
            this.width = t * this.parentScaleFactor.x,
            this.height = e * this.parentScaleFactor.y,
            this.game.width = this.width,
            this.game.height = this.height,
            this.sourceAspectRatio = this.width / this.height,
            this.updateScalingAndBounds(),
            i && (this.game.renderer.resize(this.width, this.height),
            this.game.camera.setSize(this.width, this.height),
            this.game.world.resize(this.width, this.height))
        },
        updateScalingAndBounds: function() {
            this.scaleFactor.x = this.game.width / this.width,
            this.scaleFactor.y = this.game.height / this.height,
            this.scaleFactorInversed.x = this.width / this.game.width,
            this.scaleFactorInversed.y = this.height / this.game.height,
            this.aspectRatio = this.width / this.height,
            this.game.canvas && this.dom.getOffset(this.game.canvas, this.offset),
            this.bounds.setTo(this.offset.x, this.offset.y, this.width, this.height),
            this.game.input && this.game.input.scale && this.game.input.scale.setTo(this.scaleFactor.x, this.scaleFactor.y)
        },
        forceOrientation: function(t, e) {
            void 0 === e && (e = !1),
            this.forceLandscape = t,
            this.forcePortrait = e,
            this.queueUpdate(!0)
        },
        classifyOrientation: function(t) {
            return "portrait-primary" === t || "portrait-secondary" === t ? "portrait" : "landscape-primary" === t || "landscape-secondary" === t ? "landscape" : null
        },
        updateOrientationState: function() {
            var t = this.screenOrientation
              , e = this.incorrectOrientation;
            this.screenOrientation = this.dom.getScreenOrientation(this.compatibility.orientationFallback),
            this.incorrectOrientation = this.forceLandscape && !this.isLandscape || this.forcePortrait && !this.isPortrait;
            var i = t !== this.screenOrientation
              , s = e !== this.incorrectOrientation;
            return s && (this.incorrectOrientation ? this.enterIncorrectOrientation.dispatch() : this.leaveIncorrectOrientation.dispatch()),
            (i || s) && this.onOrientationChange.dispatch(this, t, e),
            i || s
        },
        orientationChange: function(t) {
            this.event = t,
            this.queueUpdate(!0)
        },
        windowResize: function(t) {
            this.event = t,
            this.queueUpdate(!0)
        },
        scrollTop: function() {
            var t = this.compatibility.scrollTo;
            t && window.scrollTo(t.x, t.y)
        },
        refresh: function() {
            this.scrollTop(),
            this.queueUpdate(!0)
        },
        updateLayout: function() {
            var t = this.currentScaleMode;
            if (t !== H.ScaleManager.RESIZE) {
                if (this.scrollTop(),
                this.compatibility.forceMinimumDocumentHeight && (document.documentElement.style.minHeight = window.innerHeight + "px"),
                this.incorrectOrientation ? this.setMaximum() : t === H.ScaleManager.EXACT_FIT ? this.setExactFit() : t === H.ScaleManager.SHOW_ALL ? (this.setShowAll(!0),
                this.resetCanvas(),
                this.setShowAll()) : t === H.ScaleManager.NO_SCALE ? (this.width = this.game.width,
                this.height = this.game.height) : t === H.ScaleManager.USER_SCALE && (this.width = this.game.width * this._userScaleFactor.x - this._userScaleTrim.x,
                this.height = this.game.height * this._userScaleFactor.y - this._userScaleTrim.y),
                !this.compatibility.canExpandParent && (t === H.ScaleManager.SHOW_ALL || t === H.ScaleManager.USER_SCALE)) {
                    var e = this.getParentBounds(this._tempBounds);
                    this.width = Math.min(this.width, e.width),
                    this.height = Math.min(this.height, e.height)
                }
                this.width = 0 | this.width,
                this.height = 0 | this.height,
                this.reflowCanvas()
            } else
                this.reflowGame()
        },
        getParentBounds: function(t) {
            var e = t || new H.Rectangle
              , i = this.boundingParent
              , s = this.dom.visualBounds
              , n = this.dom.layoutBounds;
            if (i) {
                var r = i.getBoundingClientRect()
                  , o = i.offsetParent ? i.offsetParent.getBoundingClientRect() : i.getBoundingClientRect();
                e.setTo(r.left - o.left, r.top - o.top, r.width, r.height);
                var a = this.windowConstraints;
                if (a.right) {
                    var h = "layout" === a.right ? n : s;
                    e.right = Math.min(e.right, h.width)
                }
                if (a.bottom) {
                    h = "layout" === a.bottom ? n : s;
                    e.bottom = Math.min(e.bottom, h.height)
                }
            } else
                e.setTo(0, 0, s.width, s.height);
            return e.setTo(Math.round(e.x), Math.round(e.y), Math.round(e.width), Math.round(e.height)),
            e
        },
        alignCanvas: function(t, e) {
            var i = this.getParentBounds(this._tempBounds)
              , s = this.game.canvas
              , n = this.margin;
            if (t) {
                n.left = n.right = 0;
                var r = s.getBoundingClientRect();
                if (this.width < i.width && !this.incorrectOrientation) {
                    var o = r.left - i.x
                      , a = i.width / 2 - this.width / 2
                      , h = (a = Math.max(a, 0)) - o;
                    n.left = Math.round(h)
                }
                s.style.marginLeft = n.left + "px",
                0 !== n.left && (n.right = -(i.width - r.width - n.left),
                s.style.marginRight = n.right + "px")
            }
            if (e) {
                n.top = n.bottom = 0;
                r = s.getBoundingClientRect();
                if (this.height < i.height && !this.incorrectOrientation) {
                    o = r.top - i.y,
                    a = i.height / 2 - this.height / 2,
                    h = (a = Math.max(a, 0)) - o;
                    n.top = Math.round(h)
                }
                s.style.marginTop = n.top + "px",
                0 !== n.top && (n.bottom = -(i.height - r.height - n.top),
                s.style.marginBottom = n.bottom + "px")
            }
            n.x = n.left,
            n.y = n.top
        },
        reflowGame: function() {
            this.resetCanvas("", "");
            var t = this.getParentBounds(this._tempBounds);
            this.updateDimensions(t.width, t.height, !0)
        },
        reflowCanvas: function() {
            this.incorrectOrientation || (this.width = H.Math.clamp(this.width, this.minWidth || 0, this.maxWidth || this.width),
            this.height = H.Math.clamp(this.height, this.minHeight || 0, this.maxHeight || this.height)),
            this.resetCanvas(),
            this.compatibility.noMargins || (this.isFullScreen && this._createdFullScreenTarget ? this.alignCanvas(!0, !0) : this.alignCanvas(this.pageAlignHorizontally, this.pageAlignVertically)),
            this.updateScalingAndBounds()
        },
        resetCanvas: function(t, e) {
            void 0 === t && (t = this.width + "px"),
            void 0 === e && (e = this.height + "px");
            var i = this.game.canvas;
            this.compatibility.noMargins || (i.style.marginLeft = "",
            i.style.marginTop = "",
            i.style.marginRight = "",
            i.style.marginBottom = ""),
            i.style.width = t,
            i.style.height = e
        },
        queueUpdate: function(t) {
            t && (this._parentBounds.width = 0,
            this._parentBounds.height = 0),
            this._updateThrottle = this._updateThrottleReset
        },
        reset: function(t) {
            t && this.grid && this.grid.reset()
        },
        setMaximum: function() {
            this.width = this.dom.visualBounds.width,
            this.height = this.dom.visualBounds.height
        },
        setShowAll: function(t) {
            var e, i = this.getParentBounds(this._tempBounds), s = i.width, n = i.height;
            e = t ? Math.max(n / this.game.height, s / this.game.width) : Math.min(n / this.game.height, s / this.game.width),
            this.width = Math.round(this.game.width * e),
            this.height = Math.round(this.game.height * e)
        },
        setExactFit: function() {
            var t = this.getParentBounds(this._tempBounds);
            this.width = t.width,
            this.height = t.height,
            this.isFullScreen || (this.maxWidth && (this.width = Math.min(this.width, this.maxWidth)),
            this.maxHeight && (this.height = Math.min(this.height, this.maxHeight)))
        },
        createFullScreenTarget: function() {
            var t = document.createElement("div");
            return t.style.margin = "0",
            t.style.padding = "0",
            t.style.background = "#000",
            t
        },
        startFullScreen: function(t, e) {
            if (this.isFullScreen)
                return !1;
            if (this.compatibility.supportsFullScreen) {
                if ("when-not-mouse" === this.compatibility.clickTrampoline) {
                    var i = this.game.input;
                    if (i.activePointer && i.activePointer !== i.mousePointer && (e || !1 !== e))
                        return void i.activePointer.addClickTrampoline("startFullScreen", this.startFullScreen, this, [t, !1])
                }
                void 0 !== t && this.game.renderType === H.CANVAS && (this.game.stage.smoothed = t);
                var s = this.fullScreenTarget;
                s || (this.cleanupCreatedTarget(),
                this._createdFullScreenTarget = this.createFullScreenTarget(),
                s = this._createdFullScreenTarget);
                var n = {
                    targetElement: s
                };
                if (this.hasPhaserSetFullScreen = !0,
                this.onFullScreenInit.dispatch(this, n),
                this._createdFullScreenTarget) {
                    var r = this.game.canvas;
                    r.parentNode.insertBefore(s, r),
                    s.appendChild(r)
                }
                return this.game.device.fullscreenKeyboard ? s[this.game.device.requestFullscreen](Element.ALLOW_KEYBOARD_INPUT) : s[this.game.device.requestFullscreen](),
                !0
            }
            var o = this;
            setTimeout(function() {
                o.fullScreenError()
            }, 10)
        },
        stopFullScreen: function() {
            return !(!this.isFullScreen || !this.compatibility.supportsFullScreen || (this.hasPhaserSetFullScreen = !1,
            document[this.game.device.cancelFullscreen](),
            0))
        },
        cleanupCreatedTarget: function() {
            var t = this._createdFullScreenTarget;
            if (t && t.parentNode) {
                var e = t.parentNode;
                e.insertBefore(this.game.canvas, t),
                e.removeChild(t)
            }
            this._createdFullScreenTarget = null
        },
        prepScreenMode: function(t) {
            var e = !!this._createdFullScreenTarget
              , i = this._createdFullScreenTarget || this.fullScreenTarget;
            t ? (e || this.fullScreenScaleMode === H.ScaleManager.EXACT_FIT) && i !== this.game.canvas && (this._fullScreenRestore = {
                targetWidth: i.style.width,
                targetHeight: i.style.height
            },
            i.style.width = "100%",
            i.style.height = "100%") : (this._fullScreenRestore && (i.style.width = this._fullScreenRestore.targetWidth,
            i.style.height = this._fullScreenRestore.targetHeight,
            this._fullScreenRestore = null),
            this.updateDimensions(this._gameSize.width, this._gameSize.height, !0),
            this.resetCanvas())
        },
        fullScreenChange: function(t) {
            this.event = t,
            this.isFullScreen ? this.prepScreenMode(!0) : (this.prepScreenMode(!1),
            this.cleanupCreatedTarget()),
            this.updateLayout(),
            this.queueUpdate(!0),
            this.onFullScreenChange.dispatch(this, this.width, this.height)
        },
        fullScreenError: function(t) {
            this.event = t,
            this.cleanupCreatedTarget(),
            this.onFullScreenError.dispatch(this)
        },
        scaleSprite: function(t, e, i, s) {
            if (void 0 === e && (e = this.width),
            void 0 === i && (i = this.height),
            void 0 === s && (s = !1),
            !t || !t.scale)
                return t;
            if (t.scale.x = 1,
            t.scale.y = 1,
            t.width <= 0 || t.height <= 0 || e <= 0 || i <= 0)
                return t;
            var n = e
              , r = t.height * e / t.width
              , o = t.width * i / t.height
              , a = i
              , h = e < o;
            return (h = h ? s : !s) ? (t.width = Math.floor(n),
            t.height = Math.floor(r)) : (t.width = Math.floor(o),
            t.height = Math.floor(a)),
            t
        },
        destroy: function() {
            this.game.onResume.remove(this._gameResumed, this),
            window.removeEventListener("orientationchange", this._orientationChange, !1),
            window.removeEventListener("resize", this._windowResize, !1),
            this.compatibility.supportsFullScreen && (document.removeEventListener("webkitfullscreenchange", this._fullScreenChange, !1),
            document.removeEventListener("mozfullscreenchange", this._fullScreenChange, !1),
            document.removeEventListener("MSFullscreenChange", this._fullScreenChange, !1),
            document.removeEventListener("fullscreenchange", this._fullScreenChange, !1),
            document.removeEventListener("webkitfullscreenerror", this._fullScreenError, !1),
            document.removeEventListener("mozfullscreenerror", this._fullScreenError, !1),
            document.removeEventListener("MSFullscreenError", this._fullScreenError, !1),
            document.removeEventListener("fullscreenerror", this._fullScreenError, !1))
        }
    },
    H.ScaleManager.prototype.constructor = H.ScaleManager,
    Object.defineProperty(H.ScaleManager.prototype, "boundingParent", {
        get: function() {
            return this.parentIsWindow || this.isFullScreen && this.hasPhaserSetFullScreen && !this._createdFullScreenTarget ? null : this.game.canvas && this.game.canvas.parentNode || null
        }
    }),
    Object.defineProperty(H.ScaleManager.prototype, "scaleMode", {
        get: function() {
            return this._scaleMode
        },
        set: function(t) {
            return t !== this._scaleMode && (this.isFullScreen || (this.updateDimensions(this._gameSize.width, this._gameSize.height, !0),
            this.queueUpdate(!0)),
            this._scaleMode = t),
            this._scaleMode
        }
    }),
    Object.defineProperty(H.ScaleManager.prototype, "fullScreenScaleMode", {
        get: function() {
            return this._fullScreenScaleMode
        },
        set: function(t) {
            return t !== this._fullScreenScaleMode && (this.isFullScreen ? (this.prepScreenMode(!1),
            this._fullScreenScaleMode = t,
            this.prepScreenMode(!0),
            this.queueUpdate(!0)) : this._fullScreenScaleMode = t),
            this._fullScreenScaleMode
        }
    }),
    Object.defineProperty(H.ScaleManager.prototype, "currentScaleMode", {
        get: function() {
            return this.isFullScreen ? this._fullScreenScaleMode : this._scaleMode
        }
    }),
    Object.defineProperty(H.ScaleManager.prototype, "pageAlignHorizontally", {
        get: function() {
            return this._pageAlignHorizontally
        },
        set: function(t) {
            t !== this._pageAlignHorizontally && (this._pageAlignHorizontally = t,
            this.queueUpdate(!0))
        }
    }),
    Object.defineProperty(H.ScaleManager.prototype, "pageAlignVertically", {
        get: function() {
            return this._pageAlignVertically
        },
        set: function(t) {
            t !== this._pageAlignVertically && (this._pageAlignVertically = t,
            this.queueUpdate(!0))
        }
    }),
    Object.defineProperty(H.ScaleManager.prototype, "isFullScreen", {
        get: function() {
            return !!(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)
        }
    }),
    Object.defineProperty(H.ScaleManager.prototype, "isPortrait", {
        get: function() {
            return "portrait" === this.classifyOrientation(this.screenOrientation)
        }
    }),
    Object.defineProperty(H.ScaleManager.prototype, "isLandscape", {
        get: function() {
            return "landscape" === this.classifyOrientation(this.screenOrientation)
        }
    }),
    Object.defineProperty(H.ScaleManager.prototype, "isGamePortrait", {
        get: function() {
            return this.height > this.width
        }
    }),
    Object.defineProperty(H.ScaleManager.prototype, "isGameLandscape", {
        get: function() {
            return this.width > this.height
        }
    }),
    H.Utils.Debug = function(t) {
        this.game = t,
        this.sprite = null,
        this.bmd = null,
        this.canvas = null,
        this.context = null,
        this.font = "14px Courier",
        this.columnWidth = 100,
        this.lineHeight = 16,
        this.renderShadow = !0,
        this.currentX = 0,
        this.currentY = 0,
        this.currentAlpha = 1,
        this.dirty = !1
    }
    ,
    H.Utils.Debug.prototype = {
        boot: function() {
            this.game.renderType === H.CANVAS ? this.context = this.game.context : (this.bmd = new H.BitmapData(this.game,"__DEBUG",this.game.width,this.game.height,!0),
            this.sprite = this.game.make.image(0, 0, this.bmd),
            this.game.stage.addChild(this.sprite),
            this.game.scale.onSizeChange.add(this.resize, this),
            this.canvas = PIXI.CanvasPool.create(this, this.game.width, this.game.height),
            this.context = this.canvas.getContext("2d"))
        },
        resize: function(t, e, i) {
            this.bmd.resize(e, i),
            this.canvas.width = e,
            this.canvas.height = i
        },
        preUpdate: function() {
            this.dirty && this.sprite && (this.bmd.clear(),
            this.bmd.draw(this.canvas, 0, 0),
            this.context.clearRect(0, 0, this.game.width, this.game.height),
            this.dirty = !1)
        },
        reset: function() {
            this.context && this.context.clearRect(0, 0, this.game.width, this.game.height),
            this.sprite && this.bmd.clear()
        },
        start: function(t, e, i, s) {
            "number" != typeof t && (t = 0),
            "number" != typeof e && (e = 0),
            i = i || "rgb(255,255,255)",
            void 0 === s && (s = 0),
            this.currentX = t,
            this.currentY = e,
            this.currentColor = i,
            this.columnWidth = s,
            this.dirty = !0,
            this.context.save(),
            this.context.setTransform(1, 0, 0, 1, 0, 0),
            this.context.strokeStyle = i,
            this.context.fillStyle = i,
            this.context.font = this.font,
            this.context.globalAlpha = this.currentAlpha
        },
        stop: function() {
            this.context.restore()
        },
        line: function() {
            for (var t = this.currentX, e = 0; e < arguments.length; e++)
                this.renderShadow && (this.context.fillStyle = "rgb(0,0,0)",
                this.context.fillText(arguments[e], t + 1, this.currentY + 1),
                this.context.fillStyle = this.currentColor),
                this.context.fillText(arguments[e], t, this.currentY),
                t += this.columnWidth;
            this.currentY += this.lineHeight
        },
        soundInfo: function(t, e, i, s) {
            this.start(e, i, s),
            this.line("Sound: " + t.key + " Locked: " + t.game.sound.touchLocked),
            this.line("Is Ready?: " + this.game.cache.isSoundReady(t.key) + " Pending Playback: " + t.pendingPlayback),
            this.line("Decoded: " + t.isDecoded + " Decoding: " + t.isDecoding),
            this.line("Total Duration: " + t.totalDuration + " Playing: " + t.isPlaying),
            this.line("Time: " + t.currentTime),
            this.line("Volume: " + t.volume + " Muted: " + t.mute),
            this.line("WebAudio: " + t.usingWebAudio + " Audio: " + t.usingAudioTag),
            "" !== t.currentMarker && (this.line("Marker: " + t.currentMarker + " Duration: " + t.duration + " (ms: " + t.durationMS + ")"),
            this.line("Start: " + t.markers[t.currentMarker].start + " Stop: " + t.markers[t.currentMarker].stop),
            this.line("Position: " + t.position)),
            this.stop()
        },
        cameraInfo: function(t, e, i, s) {
            this.start(e, i, s),
            this.line("Camera (" + t.width + " x " + t.height + ")"),
            this.line("X: " + t.x + " Y: " + t.y),
            t.bounds && this.line("Bounds x: " + t.bounds.x + " Y: " + t.bounds.y + " w: " + t.bounds.width + " h: " + t.bounds.height),
            this.line("View x: " + t.view.x + " Y: " + t.view.y + " w: " + t.view.width + " h: " + t.view.height),
            this.line("Total in view: " + t.totalInView),
            this.stop()
        },
        timer: function(t, e, i, s) {
            this.start(e, i, s),
            this.line("Timer (running: " + t.running + " expired: " + t.expired + ")"),
            this.line("Next Tick: " + t.next + " Duration: " + t.duration),
            this.line("Paused: " + t.paused + " Length: " + t.length),
            this.stop()
        },
        pointer: function(t, e, i, s, n) {
            null != t && (void 0 === e && (e = !1),
            i = i || "rgba(0,255,0,0.5)",
            s = s || "rgba(255,0,0,0.5)",
            !0 === e && !0 === t.isUp || (this.start(t.x, t.y - 100, n),
            this.context.beginPath(),
            this.context.arc(t.x, t.y, t.circle.radius, 0, 2 * Math.PI),
            t.active ? this.context.fillStyle = i : this.context.fillStyle = s,
            this.context.fill(),
            this.context.closePath(),
            this.context.beginPath(),
            this.context.moveTo(t.positionDown.x, t.positionDown.y),
            this.context.lineTo(t.position.x, t.position.y),
            this.context.lineWidth = 2,
            this.context.stroke(),
            this.context.closePath(),
            this.line("ID: " + t.id + " Active: " + t.active),
            this.line("World X: " + t.worldX + " World Y: " + t.worldY),
            this.line("Screen X: " + t.x + " Screen Y: " + t.y + " In: " + t.withinGame),
            this.line("Duration: " + t.duration + " ms"),
            this.line("is Down: " + t.isDown + " is Up: " + t.isUp),
            this.stop()))
        },
        spriteInputInfo: function(t, e, i, s) {
            this.start(e, i, s),
            this.line("Sprite Input: (" + t.width + " x " + t.height + ")"),
            this.line("x: " + t.input.pointerX().toFixed(1) + " y: " + t.input.pointerY().toFixed(1)),
            this.line("over: " + t.input.pointerOver() + " duration: " + t.input.overDuration().toFixed(0)),
            this.line("down: " + t.input.pointerDown() + " duration: " + t.input.downDuration().toFixed(0)),
            this.line("just over: " + t.input.justOver() + " just out: " + t.input.justOut()),
            this.stop()
        },
        key: function(t, e, i, s) {
            this.start(e, i, s, 150),
            this.line("Key:", t.keyCode, "isDown:", t.isDown),
            this.line("justDown:", t.justDown, "justUp:", t.justUp),
            this.line("Time Down:", t.timeDown.toFixed(0), "duration:", t.duration.toFixed(0)),
            this.stop()
        },
        inputInfo: function(t, e, i) {
            this.start(t, e, i),
            this.line("Input"),
            this.line("X: " + this.game.input.x + " Y: " + this.game.input.y),
            this.line("World X: " + this.game.input.worldX + " World Y: " + this.game.input.worldY),
            this.line("Scale X: " + this.game.input.scale.x.toFixed(1) + " Scale Y: " + this.game.input.scale.x.toFixed(1)),
            this.line("Screen X: " + this.game.input.activePointer.screenX + " Screen Y: " + this.game.input.activePointer.screenY),
            this.stop()
        },
        spriteBounds: function(t, e, i) {
            var s = t.getBounds();
            s.x += this.game.camera.x,
            s.y += this.game.camera.y,
            this.rectangle(s, e, i)
        },
        ropeSegments: function(t, e, i) {
            var s = this;
            t.segments.forEach(function(t) {
                s.rectangle(t, e, i)
            }, this)
        },
        spriteInfo: function(t, e, i, s) {
            this.start(e, i, s),
            this.line("Sprite:  (" + t.width + " x " + t.height + ") anchor: " + t.anchor.x + " x " + t.anchor.y),
            this.line("x: " + t.x.toFixed(1) + " y: " + t.y.toFixed(1)),
            this.line("angle: " + t.angle.toFixed(1) + " rotation: " + t.rotation.toFixed(1)),
            this.line("visible: " + t.visible + " in camera: " + t.inCamera),
            this.line("bounds x: " + t._bounds.x.toFixed(1) + " y: " + t._bounds.y.toFixed(1) + " w: " + t._bounds.width.toFixed(1) + " h: " + t._bounds.height.toFixed(1)),
            this.stop()
        },
        spriteCoords: function(t, e, i, s) {
            this.start(e, i, s, 100),
            t.name && this.line(t.name),
            this.line("x:", t.x.toFixed(2), "y:", t.y.toFixed(2)),
            this.line("pos x:", t.position.x.toFixed(2), "pos y:", t.position.y.toFixed(2)),
            this.line("world x:", t.world.x.toFixed(2), "world y:", t.world.y.toFixed(2)),
            this.stop()
        },
        lineInfo: function(t, e, i, s) {
            this.start(e, i, s, 80),
            this.line("start.x:", t.start.x.toFixed(2), "start.y:", t.start.y.toFixed(2)),
            this.line("end.x:", t.end.x.toFixed(2), "end.y:", t.end.y.toFixed(2)),
            this.line("length:", t.length.toFixed(2), "angle:", t.angle),
            this.stop()
        },
        pixel: function(t, e, i, s) {
            s = s || 2,
            this.start(),
            this.context.fillStyle = i,
            this.context.fillRect(t, e, s, s),
            this.stop()
        },
        geom: function(t, e, i, s) {
            void 0 === i && (i = !0),
            void 0 === s && (s = 0),
            e = e || "rgba(0,255,0,0.4)",
            this.start(),
            this.context.fillStyle = e,
            this.context.strokeStyle = e,
            t instanceof H.Rectangle || 1 === s ? i ? this.context.fillRect(t.x - this.game.camera.x, t.y - this.game.camera.y, t.width, t.height) : this.context.strokeRect(t.x - this.game.camera.x, t.y - this.game.camera.y, t.width, t.height) : t instanceof H.Circle || 2 === s ? (this.context.beginPath(),
            this.context.arc(t.x - this.game.camera.x, t.y - this.game.camera.y, t.radius, 0, 2 * Math.PI, !1),
            this.context.closePath(),
            i ? this.context.fill() : this.context.stroke()) : t instanceof H.Point || 3 === s ? this.context.fillRect(t.x - this.game.camera.x, t.y - this.game.camera.y, 4, 4) : (t instanceof H.Line || 4 === s) && (this.context.lineWidth = 1,
            this.context.beginPath(),
            this.context.moveTo(t.start.x + .5 - this.game.camera.x, t.start.y + .5 - this.game.camera.y),
            this.context.lineTo(t.end.x + .5 - this.game.camera.x, t.end.y + .5 - this.game.camera.y),
            this.context.closePath(),
            this.context.stroke()),
            this.stop()
        },
        rectangle: function(t, e, i) {
            void 0 === i && (i = !0),
            e = e || "rgba(0, 255, 0, 0.4)",
            this.start(),
            i ? (this.context.fillStyle = e,
            this.context.fillRect(t.x - this.game.camera.x, t.y - this.game.camera.y, t.width, t.height)) : (this.context.strokeStyle = e,
            this.context.strokeRect(t.x - this.game.camera.x, t.y - this.game.camera.y, t.width, t.height)),
            this.stop()
        },
        text: function(t, e, i, s, n) {
            s = s || "rgb(255,255,255)",
            n = n || "16px Courier",
            this.start(),
            this.context.font = n,
            this.renderShadow && (this.context.fillStyle = "rgb(0,0,0)",
            this.context.fillText(t, e + 1, i + 1)),
            this.context.fillStyle = s,
            this.context.fillText(t, e, i),
            this.stop()
        },
        quadTree: function(t, e) {
            e = e || "rgba(255,0,0,0.3)",
            this.start();
            var i = t.bounds;
            if (0 === t.nodes.length) {
                this.context.strokeStyle = e,
                this.context.strokeRect(i.x, i.y, i.width, i.height),
                this.text("size: " + t.objects.length, i.x + 4, i.y + 16, "rgb(0,200,0)", "12px Courier"),
                this.context.strokeStyle = "rgb(0,255,0)";
                for (var s = 0; s < t.objects.length; s++)
                    this.context.strokeRect(t.objects[s].x, t.objects[s].y, t.objects[s].width, t.objects[s].height)
            } else
                for (s = 0; s < t.nodes.length; s++)
                    this.quadTree(t.nodes[s]);
            this.stop()
        },
        body: function(t, e, i) {
            t.body && (this.start(),
            t.body.type === H.Physics.ARCADE ? H.Physics.Arcade.Body.render(this.context, t.body, e, i) : t.body.type === H.Physics.NINJA ? H.Physics.Ninja.Body.render(this.context, t.body, e, i) : t.body.type === H.Physics.BOX2D && H.Physics.Box2D.renderBody(this.context, t.body, e),
            this.stop())
        },
        bodyInfo: function(t, e, i, s) {
            t.body && (this.start(e, i, s, 210),
            t.body.type === H.Physics.ARCADE ? H.Physics.Arcade.Body.renderBodyInfo(this, t.body) : t.body.type === H.Physics.BOX2D && this.game.physics.box2d.renderBodyInfo(this, t.body),
            this.stop())
        },
        box2dWorld: function() {
            this.start(),
            this.context.translate(-this.game.camera.view.x, -this.game.camera.view.y, 0),
            this.game.physics.box2d.renderDebugDraw(this.context),
            this.stop()
        },
        box2dBody: function(t, e) {
            this.start(),
            H.Physics.Box2D.renderBody(this.context, t, e),
            this.stop()
        },
        displayList: function(t) {
            if (void 0 === t && (t = this.game.world),
            t.hasOwnProperty("renderOrderID"),
            t.children && 0 < t.children.length)
                for (var e = 0; e < t.children.length; e++)
                    this.game.debug.displayList(t.children[e])
        },
        destroy: function() {
            PIXI.CanvasPool.remove(this)
        }
    },
    H.Utils.Debug.prototype.constructor = H.Utils.Debug,
    H.DOM = {
        getOffset: function(t, e) {
            e = e || new H.Point;
            var i = t.getBoundingClientRect()
              , s = H.DOM.scrollY
              , n = H.DOM.scrollX
              , r = document.documentElement.clientTop
              , o = document.documentElement.clientLeft;
            return e.x = i.left + n - o,
            e.y = i.top + s - r,
            e
        },
        getBounds: function(t, e) {
            return void 0 === e && (e = 0),
            !(!(t = t && !t.nodeType ? t[0] : t) || 1 !== t.nodeType) && this.calibrate(t.getBoundingClientRect(), e)
        },
        calibrate: function(t, e) {
            e = +e || 0;
            var i = {
                width: 0,
                height: 0,
                left: 0,
                right: 0,
                top: 0,
                bottom: 0
            };
            return i.width = (i.right = t.right + e) - (i.left = t.left - e),
            i.height = (i.bottom = t.bottom + e) - (i.top = t.top - e),
            i
        },
        getAspectRatio: function(t) {
            var e = (t = null == t ? this.visualBounds : 1 === t.nodeType ? this.getBounds(t) : t).width
              , i = t.height;
            return "function" == typeof e && (e = e.call(t)),
            "function" == typeof i && (i = i.call(t)),
            e / i
        },
        inLayoutViewport: function(t, e) {
            var i = this.getBounds(t, e);
            return !!i && 0 <= i.bottom && 0 <= i.right && i.top <= this.layoutBounds.width && i.left <= this.layoutBounds.height
        },
        getScreenOrientation: function(t) {
            var e = window.screen
              , i = e.orientation || e.mozOrientation || e.msOrientation;
            if (i && "string" == typeof i.type)
                return i.type;
            if ("string" == typeof i)
                return i;
            var s = "portrait-primary"
              , n = "landscape-primary";
            if ("screen" === t)
                return e.height > e.width ? s : n;
            if ("viewport" === t)
                return this.visualBounds.height > this.visualBounds.width ? s : n;
            if ("window.orientation" === t && "number" == typeof window.orientation)
                return 0 === window.orientation || 180 === window.orientation ? s : n;
            if (window.matchMedia) {
                if (window.matchMedia("(orientation: portrait)").matches)
                    return s;
                if (window.matchMedia("(orientation: landscape)").matches)
                    return n
            }
            return this.visualBounds.height > this.visualBounds.width ? s : n
        },
        visualBounds: new H.Rectangle,
        layoutBounds: new H.Rectangle,
        documentBounds: new H.Rectangle
    },
    H.Device.whenReady(function(t) {
        var e = window && "pageXOffset"in window ? function() {
            return window.pageXOffset
        }
        : function() {
            return document.documentElement.scrollLeft
        }
          , i = window && "pageYOffset"in window ? function() {
            return window.pageYOffset
        }
        : function() {
            return document.documentElement.scrollTop
        }
        ;
        if (Object.defineProperty(H.DOM, "scrollX", {
            get: e
        }),
        Object.defineProperty(H.DOM, "scrollY", {
            get: i
        }),
        Object.defineProperty(H.DOM.visualBounds, "x", {
            get: e
        }),
        Object.defineProperty(H.DOM.visualBounds, "y", {
            get: i
        }),
        Object.defineProperty(H.DOM.layoutBounds, "x", {
            value: 0
        }),
        Object.defineProperty(H.DOM.layoutBounds, "y", {
            value: 0
        }),
        t.desktop && document.documentElement.clientWidth <= window.innerWidth && document.documentElement.clientHeight <= window.innerHeight) {
            var s = function() {
                return Math.max(window.innerWidth, document.documentElement.clientWidth)
            }
              , n = function() {
                return Math.max(window.innerHeight, document.documentElement.clientHeight)
            };
            Object.defineProperty(H.DOM.visualBounds, "width", {
                get: s
            }),
            Object.defineProperty(H.DOM.visualBounds, "height", {
                get: n
            }),
            Object.defineProperty(H.DOM.layoutBounds, "width", {
                get: s
            }),
            Object.defineProperty(H.DOM.layoutBounds, "height", {
                get: n
            })
        } else
            Object.defineProperty(H.DOM.visualBounds, "width", {
                get: function() {
                    return window.innerWidth
                }
            }),
            Object.defineProperty(H.DOM.visualBounds, "height", {
                get: function() {
                    return window.innerHeight
                }
            }),
            Object.defineProperty(H.DOM.layoutBounds, "width", {
                get: function() {
                    var t = document.documentElement.clientWidth
                      , e = window.innerWidth;
                    return t < e ? e : t
                }
            }),
            Object.defineProperty(H.DOM.layoutBounds, "height", {
                get: function() {
                    var t = document.documentElement.clientHeight
                      , e = window.innerHeight;
                    return t < e ? e : t
                }
            });
        Object.defineProperty(H.DOM.documentBounds, "x", {
            value: 0
        }),
        Object.defineProperty(H.DOM.documentBounds, "y", {
            value: 0
        }),
        Object.defineProperty(H.DOM.documentBounds, "width", {
            get: function() {
                var t = document.documentElement;
                return Math.max(t.clientWidth, t.offsetWidth, t.scrollWidth)
            }
        }),
        Object.defineProperty(H.DOM.documentBounds, "height", {
            get: function() {
                var t = document.documentElement;
                return Math.max(t.clientHeight, t.offsetHeight, t.scrollHeight)
            }
        })
    }, null, !0),
    H.ArraySet = function(t) {
        this.position = 0,
        this.list = t || []
    }
    ,
    H.ArraySet.prototype = {
        add: function(t) {
            return this.exists(t) || this.list.push(t),
            t
        },
        getIndex: function(t) {
            return this.list.indexOf(t)
        },
        getByKey: function(t, e) {
            for (var i = this.list.length; i--; )
                if (this.list[i][t] === e)
                    return this.list[i];
            return null
        },
        exists: function(t) {
            return -1 < this.list.indexOf(t)
        },
        reset: function() {
            this.list.length = 0
        },
        remove: function(t) {
            var e = this.list.indexOf(t);
            if (-1 < e)
                return this.list.splice(e, 1),
                t
        },
        setAll: function(t, e) {
            for (var i = this.list.length; i--; )
                this.list[i] && (this.list[i][t] = e)
        },
        callAll: function(t) {
            for (var e = Array.prototype.slice.call(arguments, 1), i = this.list.length; i--; )
                this.list[i] && this.list[i][t] && this.list[i][t].apply(this.list[i], e)
        },
        removeAll: function(t) {
            void 0 === t && (t = !1);
            for (var e = this.list.length; e--; )
                if (this.list[e]) {
                    var i = this.remove(this.list[e]);
                    t && i.destroy()
                }
            this.position = 0,
            this.list = []
        }
    },
    Object.defineProperty(H.ArraySet.prototype, "total", {
        get: function() {
            return this.list.length
        }
    }),
    Object.defineProperty(H.ArraySet.prototype, "first", {
        get: function() {
            return (this.position = 0) < this.list.length ? this.list[0] : null
        }
    }),
    Object.defineProperty(H.ArraySet.prototype, "next", {
        get: function() {
            return this.position < this.list.length ? (this.position++,
            this.list[this.position]) : null
        }
    }),
    H.ArraySet.prototype.constructor = H.ArraySet,
    H.ArrayUtils = {
        getRandomItem: function(t, e, i) {
            if (null === t)
                return null;
            void 0 === e && (e = 0),
            void 0 === i && (i = t.length);
            var s = e + Math.floor(Math.random() * i);
            return void 0 === t[s] ? null : t[s]
        },
        removeRandomItem: function(t, e, i) {
            if (null == t)
                return null;
            void 0 === e && (e = 0),
            void 0 === i && (i = t.length);
            var s = e + Math.floor(Math.random() * i);
            if (s < t.length) {
                var n = t.splice(s, 1);
                return void 0 === n[0] ? null : n[0]
            }
            return null
        },
        shuffle: function(t) {
            for (var e = t.length - 1; 0 < e; e--) {
                var i = Math.floor(Math.random() * (e + 1))
                  , s = t[e];
                t[e] = t[i],
                t[i] = s
            }
            return t
        },
        transposeMatrix: function(t) {
            for (var e = t.length, i = t[0].length, s = new Array(i), n = 0; n < i; n++) {
                s[n] = new Array(e);
                for (var r = e - 1; -1 < r; r--)
                    s[n][r] = t[r][n]
            }
            return s
        },
        rotateMatrix: function(t, e) {
            if ("string" != typeof e && (e = (e % 360 + 360) % 360),
            90 === e || -270 === e || "rotateLeft" === e)
                t = (t = H.ArrayUtils.transposeMatrix(t)).reverse();
            else if (-90 === e || 270 === e || "rotateRight" === e)
                t = t.reverse(),
                t = H.ArrayUtils.transposeMatrix(t);
            else if (180 === Math.abs(e) || "rotate180" === e) {
                for (var i = 0; i < t.length; i++)
                    t[i].reverse();
                t = t.reverse()
            }
            return t
        },
        findClosest: function(t, e) {
            if (!e.length)
                return NaN;
            if (1 === e.length || t < e[0])
                return e[0];
            for (var i = 1; e[i] < t; )
                i++;
            var s = e[i - 1]
              , n = i < e.length ? e[i] : Number.POSITIVE_INFINITY;
            return n - t <= t - s ? n : s
        },
        rotateRight: function(t) {
            var e = t.pop();
            return t.unshift(e),
            e
        },
        rotateLeft: function(t) {
            var e = t.shift();
            return t.push(e),
            e
        },
        rotate: function(t) {
            var e = t.shift();
            return t.push(e),
            e
        },
        numberArray: function(t, e) {
            for (var i = [], s = t; s <= e; s++)
                i.push(s);
            return i
        },
        numberArrayStep: function(t, e, i) {
            null != t || (t = 0),
            null != e || (e = t,
            t = 0),
            void 0 === i && (i = 1);
            for (var s = [], n = Math.max(H.Math.roundAwayFromZero((e - t) / (i || 1)), 0), r = 0; r < n; r++)
                s.push(t),
                t += i;
            return s
        }
    },
    H.LinkedList = function() {
        this.next = null,
        this.prev = null,
        this.first = null,
        this.last = null,
        this.total = 0
    }
    ,
    H.LinkedList.prototype = {
        add: function(t) {
            return 0 === this.total && null === this.first && null === this.last ? (this.first = t,
            this.last = t,
            (this.next = t).prev = this) : ((this.last.next = t).prev = this.last,
            this.last = t),
            this.total++,
            t
        },
        reset: function() {
            this.first = null,
            this.last = null,
            this.next = null,
            this.prev = null,
            this.total = 0
        },
        remove: function(t) {
            if (1 === this.total)
                return this.reset(),
                void (t.next = t.prev = null);
            t === this.first ? this.first = this.first.next : t === this.last && (this.last = this.last.prev),
            t.prev && (t.prev.next = t.next),
            t.next && (t.next.prev = t.prev),
            t.next = t.prev = null,
            null === this.first && (this.last = null),
            this.total--
        },
        callAll: function(t) {
            if (this.first && this.last)
                for (var e = this.first; e && e[t] && e[t].call(e),
                (e = e.next) !== this.last.next; )
                    ;
        }
    },
    H.LinkedList.prototype.constructor = H.LinkedList,
    H.Create = function(t) {
        this.game = t,
        this.bmd = null,
        this.canvas = null,
        this.ctx = null,
        this.palettes = [{
            0: "#000",
            1: "#9D9D9D",
            2: "#FFF",
            3: "#BE2633",
            4: "#E06F8B",
            5: "#493C2B",
            6: "#A46422",
            7: "#EB8931",
            8: "#F7E26B",
            9: "#2F484E",
            A: "#44891A",
            B: "#A3CE27",
            C: "#1B2632",
            D: "#005784",
            E: "#31A2F2",
            F: "#B2DCEF"
        }, {
            0: "#000",
            1: "#191028",
            2: "#46af45",
            3: "#a1d685",
            4: "#453e78",
            5: "#7664fe",
            6: "#833129",
            7: "#9ec2e8",
            8: "#dc534b",
            9: "#e18d79",
            A: "#d6b97b",
            B: "#e9d8a1",
            C: "#216c4b",
            D: "#d365c8",
            E: "#afaab9",
            F: "#f5f4eb"
        }, {
            0: "#000",
            1: "#2234d1",
            2: "#0c7e45",
            3: "#44aacc",
            4: "#8a3622",
            5: "#5c2e78",
            6: "#aa5c3d",
            7: "#b5b5b5",
            8: "#5e606e",
            9: "#4c81fb",
            A: "#6cd947",
            B: "#7be2f9",
            C: "#eb8a60",
            D: "#e23d69",
            E: "#ffd93f",
            F: "#fff"
        }, {
            0: "#000",
            1: "#fff",
            2: "#8b4131",
            3: "#7bbdc5",
            4: "#8b41ac",
            5: "#6aac41",
            6: "#3931a4",
            7: "#d5de73",
            8: "#945a20",
            9: "#5a4100",
            A: "#bd736a",
            B: "#525252",
            C: "#838383",
            D: "#acee8b",
            E: "#7b73de",
            F: "#acacac"
        }, {
            0: "#000",
            1: "#191028",
            2: "#46af45",
            3: "#a1d685",
            4: "#453e78",
            5: "#7664fe",
            6: "#833129",
            7: "#9ec2e8",
            8: "#dc534b",
            9: "#e18d79",
            A: "#d6b97b",
            B: "#e9d8a1",
            C: "#216c4b",
            D: "#d365c8",
            E: "#afaab9",
            F: "#fff"
        }]
    }
    ,
    H.Create.PALETTE_ARNE = 0,
    H.Create.PALETTE_JMP = 1,
    H.Create.PALETTE_CGA = 2,
    H.Create.PALETTE_C64 = 3,
    H.Create.PALETTE_JAPANESE_MACHINE = 4,
    H.Create.prototype = {
        texture: function(t, e, i, s, n) {
            void 0 === i && (i = 8),
            void 0 === s && (s = i),
            void 0 === n && (n = 0);
            var r = e[0].length * i
              , o = e.length * s;
            null === this.bmd && (this.bmd = this.game.make.bitmapData(),
            this.canvas = this.bmd.canvas,
            this.ctx = this.bmd.context),
            this.bmd.resize(r, o),
            this.bmd.clear();
            for (var a = 0; a < e.length; a++)
                for (var h = e[a], l = 0; l < h.length; l++) {
                    var c = h[l];
                    "." !== c && " " !== c && (this.ctx.fillStyle = this.palettes[n][c],
                    this.ctx.fillRect(l * i, a * s, i, s))
                }
            return this.bmd.generateTexture(t)
        },
        grid: function(t, e, i, s, n, r) {
            null === this.bmd && (this.bmd = this.game.make.bitmapData(),
            this.canvas = this.bmd.canvas,
            this.ctx = this.bmd.context),
            this.bmd.resize(e, i),
            this.ctx.fillStyle = r;
            for (var o = 0; o < i; o += n)
                this.ctx.fillRect(0, o, e, 1);
            for (var a = 0; a < e; a += s)
                this.ctx.fillRect(a, 0, 1, i);
            return this.bmd.generateTexture(t)
        }
    },
    H.Create.prototype.constructor = H.Create,
    H.FlexGrid = function(t, e, i) {
        this.game = t.game,
        this.manager = t,
        this.width = e,
        this.height = i,
        this.boundsCustom = new H.Rectangle(0,0,e,i),
        this.boundsFluid = new H.Rectangle(0,0,e,i),
        this.boundsFull = new H.Rectangle(0,0,e,i),
        this.boundsNone = new H.Rectangle(0,0,e,i),
        this.positionCustom = new H.Point(0,0),
        this.positionFluid = new H.Point(0,0),
        this.positionFull = new H.Point(0,0),
        this.positionNone = new H.Point(0,0),
        this.scaleCustom = new H.Point(1,1),
        this.scaleFluid = new H.Point(1,1),
        this.scaleFluidInversed = new H.Point(1,1),
        this.scaleFull = new H.Point(1,1),
        this.scaleNone = new H.Point(1,1),
        this.customWidth = 0,
        this.customHeight = 0,
        this.customOffsetX = 0,
        this.customOffsetY = 0,
        this.ratioH = e / i,
        this.ratioV = i / e,
        this.multiplier = 0,
        this.layers = []
    }
    ,
    H.FlexGrid.prototype = {
        setSize: function(t, e) {
            this.width = t,
            this.height = e,
            this.ratioH = t / e,
            this.ratioV = e / t,
            this.scaleNone = new H.Point(1,1),
            this.boundsNone.width = this.width,
            this.boundsNone.height = this.height,
            this.refresh()
        },
        createCustomLayer: function(t, e, i, s) {
            void 0 === s && (s = !0),
            this.customWidth = t,
            this.customHeight = e,
            this.boundsCustom.width = t,
            this.boundsCustom.height = e;
            var n = new H.FlexLayer(this,this.positionCustom,this.boundsCustom,this.scaleCustom);
            return s && this.game.world.add(n),
            this.layers.push(n),
            void 0 !== i && null !== typeof i && n.addMultiple(i),
            n
        },
        createFluidLayer: function(t, e) {
            void 0 === e && (e = !0);
            var i = new H.FlexLayer(this,this.positionFluid,this.boundsFluid,this.scaleFluid);
            return e && this.game.world.add(i),
            this.layers.push(i),
            void 0 !== t && null !== typeof t && i.addMultiple(t),
            i
        },
        createFullLayer: function(t) {
            var e = new H.FlexLayer(this,this.positionFull,this.boundsFull,this.scaleFluid);
            return this.game.world.add(e),
            this.layers.push(e),
            void 0 !== t && e.addMultiple(t),
            e
        },
        createFixedLayer: function(t) {
            var e = new H.FlexLayer(this,this.positionNone,this.boundsNone,this.scaleNone);
            return this.game.world.add(e),
            this.layers.push(e),
            void 0 !== t && e.addMultiple(t),
            e
        },
        reset: function() {
            for (var t = this.layers.length; t--; )
                this.layers[t].persist || (this.layers[t].position = null,
                this.layers[t].scale = null,
                this.layers.slice(t, 1))
        },
        onResize: function(t, e) {
            this.ratioH = t / e,
            this.ratioV = e / t,
            this.refresh(t, e)
        },
        refresh: function() {
            this.multiplier = Math.min(this.manager.height / this.height, this.manager.width / this.width),
            this.boundsFluid.width = Math.round(this.width * this.multiplier),
            this.boundsFluid.height = Math.round(this.height * this.multiplier),
            this.scaleFluid.set(this.boundsFluid.width / this.width, this.boundsFluid.height / this.height),
            this.scaleFluidInversed.set(this.width / this.boundsFluid.width, this.height / this.boundsFluid.height),
            this.scaleFull.set(this.boundsFull.width / this.width, this.boundsFull.height / this.height),
            this.boundsFull.width = Math.round(this.manager.width * this.scaleFluidInversed.x),
            this.boundsFull.height = Math.round(this.manager.height * this.scaleFluidInversed.y),
            this.boundsFluid.centerOn(this.manager.bounds.centerX, this.manager.bounds.centerY),
            this.boundsNone.centerOn(this.manager.bounds.centerX, this.manager.bounds.centerY),
            this.positionFluid.set(this.boundsFluid.x, this.boundsFluid.y),
            this.positionNone.set(this.boundsNone.x, this.boundsNone.y)
        },
        fitSprite: function(t) {
            this.manager.scaleSprite(t),
            t.x = this.manager.bounds.centerX,
            t.y = this.manager.bounds.centerY
        },
        debug: function() {
            this.game.debug.text(this.boundsFluid.width + " x " + this.boundsFluid.height, this.boundsFluid.x + 4, this.boundsFluid.y + 16),
            this.game.debug.geom(this.boundsFluid, "rgba(255,0,0,0.9", !1)
        }
    },
    H.FlexGrid.prototype.constructor = H.FlexGrid,
    H.FlexLayer = function(t, e, i, s) {
        H.Group.call(this, t.game, null, "__flexLayer" + t.game.rnd.uuid(), !1),
        this.manager = t.manager,
        this.grid = t,
        this.persist = !1,
        this.position = e,
        this.bounds = i,
        this.scale = s,
        this.topLeft = i.topLeft,
        this.topMiddle = new H.Point(i.halfWidth,0),
        this.topRight = i.topRight,
        this.bottomLeft = i.bottomLeft,
        this.bottomMiddle = new H.Point(i.halfWidth,i.bottom),
        this.bottomRight = i.bottomRight
    }
    ,
    H.FlexLayer.prototype = Object.create(H.Group.prototype),
    H.FlexLayer.prototype.constructor = H.FlexLayer,
    H.FlexLayer.prototype.resize = function() {}
    ,
    H.FlexLayer.prototype.debug = function() {
        this.game.debug.text(this.bounds.width + " x " + this.bounds.height, this.bounds.x + 4, this.bounds.y + 16),
        this.game.debug.geom(this.bounds, "rgba(0,0,255,0.9", !1),
        this.game.debug.geom(this.topLeft, "rgba(255,255,255,0.9"),
        this.game.debug.geom(this.topMiddle, "rgba(255,255,255,0.9"),
        this.game.debug.geom(this.topRight, "rgba(255,255,255,0.9")
    }
    ,
    H.Color = {
        packPixel: function(t, e, i, s) {
            return H.Device.LITTLE_ENDIAN ? (s << 24 | i << 16 | e << 8 | t) >>> 0 : (t << 24 | e << 16 | i << 8 | s) >>> 0
        },
        unpackPixel: function(t, e, i, s) {
            return null != e || (e = H.Color.createColor()),
            null != i || (i = !1),
            null != s || (s = !1),
            H.Device.LITTLE_ENDIAN ? (e.a = (4278190080 & t) >>> 24,
            e.b = (16711680 & t) >>> 16,
            e.g = (65280 & t) >>> 8,
            e.r = 255 & t) : (e.r = (4278190080 & t) >>> 24,
            e.g = (16711680 & t) >>> 16,
            e.b = (65280 & t) >>> 8,
            e.a = 255 & t),
            e.color = t,
            e.rgba = "rgba(" + e.r + "," + e.g + "," + e.b + "," + e.a / 255 + ")",
            i && H.Color.RGBtoHSL(e.r, e.g, e.b, e),
            s && H.Color.RGBtoHSV(e.r, e.g, e.b, e),
            e
        },
        fromRGBA: function(t, e) {
            return e || (e = H.Color.createColor()),
            e.r = (4278190080 & t) >>> 24,
            e.g = (16711680 & t) >>> 16,
            e.b = (65280 & t) >>> 8,
            e.a = 255 & t,
            e.rgba = "rgba(" + e.r + "," + e.g + "," + e.b + "," + e.a + ")",
            e
        },
        toRGBA: function(t, e, i, s) {
            return t << 24 | e << 16 | i << 8 | s
        },
        toABGR: function(t, e, i, s) {
            return (s << 24 | i << 16 | e << 8 | t) >>> 0
        },
        RGBtoHSL: function(t, e, i, s) {
            s || (s = H.Color.createColor(t, e, i, 1)),
            t /= 255,
            e /= 255,
            i /= 255;
            var n = Math.min(t, e, i)
              , r = Math.max(t, e, i);
            if (s.h = 0,
            s.s = 0,
            s.l = (r + n) / 2,
            r !== n) {
                var o = r - n;
                s.s = .5 < s.l ? o / (2 - r - n) : o / (r + n),
                r === t ? s.h = (e - i) / o + (e < i ? 6 : 0) : r === e ? s.h = (i - t) / o + 2 : r === i && (s.h = (t - e) / o + 4),
                s.h /= 6
            }
            return s
        },
        HSLtoRGB: function(t, e, i, s) {
            if (s ? (s.r = i,
            s.g = i,
            s.b = i) : s = H.Color.createColor(i, i, i),
            0 !== e) {
                var n = i < .5 ? i * (1 + e) : i + e - i * e
                  , r = 2 * i - n;
                s.r = H.Color.hueToColor(r, n, t + 1 / 3),
                s.g = H.Color.hueToColor(r, n, t),
                s.b = H.Color.hueToColor(r, n, t - 1 / 3)
            }
            return s.r = Math.floor(255 * s.r | 0),
            s.g = Math.floor(255 * s.g | 0),
            s.b = Math.floor(255 * s.b | 0),
            H.Color.updateColor(s),
            s
        },
        RGBtoHSV: function(t, e, i, s) {
            s || (s = H.Color.createColor(t, e, i, 255)),
            t /= 255,
            e /= 255,
            i /= 255;
            var n = Math.min(t, e, i)
              , r = Math.max(t, e, i)
              , o = r - n;
            return s.h = 0,
            s.s = 0 === r ? 0 : o / r,
            (s.v = r) !== n && (r === t ? s.h = (e - i) / o + (e < i ? 6 : 0) : r === e ? s.h = (i - t) / o + 2 : r === i && (s.h = (t - e) / o + 4),
            s.h /= 6),
            s
        },
        HSVtoRGB: function(t, e, i, s) {
            void 0 === s && (s = H.Color.createColor(0, 0, 0, 1, t, e, 0, i));
            var n, r, o, a = Math.floor(6 * t), h = 6 * t - a, l = i * (1 - e), c = i * (1 - h * e), d = i * (1 - (1 - h) * e);
            switch (a % 6) {
            case 0:
                n = i,
                r = d,
                o = l;
                break;
            case 1:
                n = c,
                r = i,
                o = l;
                break;
            case 2:
                n = l,
                r = i,
                o = d;
                break;
            case 3:
                n = l,
                r = c,
                o = i;
                break;
            case 4:
                n = d,
                r = l,
                o = i;
                break;
            case 5:
                n = i,
                r = l,
                o = c
            }
            return s.r = Math.floor(255 * n),
            s.g = Math.floor(255 * r),
            s.b = Math.floor(255 * o),
            H.Color.updateColor(s),
            s
        },
        hueToColor: function(t, e, i) {
            return i < 0 && (i += 1),
            1 < i && (i -= 1),
            i < 1 / 6 ? t + 6 * (e - t) * i : i < .5 ? e : i < 2 / 3 ? t + (e - t) * (2 / 3 - i) * 6 : t
        },
        createColor: function(t, e, i, s, n, r, o, a) {
            var h = {
                r: t || 0,
                g: e || 0,
                b: i || 0,
                a: s || 1,
                h: n || 0,
                s: r || 0,
                l: o || 0,
                v: a || 0,
                color: 0,
                color32: 0,
                rgba: ""
            };
            return H.Color.updateColor(h)
        },
        updateColor: function(t) {
            return t.rgba = "rgba(" + t.r.toString() + "," + t.g.toString() + "," + t.b.toString() + "," + t.a.toString() + ")",
            t.color = H.Color.getColor(t.r, t.g, t.b),
            t.color32 = H.Color.getColor32(255 * t.a, t.r, t.g, t.b),
            t
        },
        getColor32: function(t, e, i, s) {
            return t << 24 | e << 16 | i << 8 | s
        },
        getColor: function(t, e, i) {
            return t << 16 | e << 8 | i
        },
        RGBtoString: function(t, e, i, s, n) {
            return void 0 === s && (s = 255),
            void 0 === n && (n = "#"),
            "#" === n ? "#" + ((1 << 24) + (t << 16) + (e << 8) + i).toString(16).slice(1) : "0x" + H.Color.componentToHex(s) + H.Color.componentToHex(t) + H.Color.componentToHex(e) + H.Color.componentToHex(i)
        },
        hexToRGB: function(t) {
            var e = H.Color.hexToColor(t);
            if (e)
                return H.Color.getColor32(e.a, e.r, e.g, e.b)
        },
        hexToColor: function(t, e) {
            t = t.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i, function(t, e, i, s) {
                return e + e + i + i + s + s
            });
            var i = /^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);
            if (i) {
                var s = parseInt(i[1], 16)
                  , n = parseInt(i[2], 16)
                  , r = parseInt(i[3], 16);
                e ? (e.r = s,
                e.g = n,
                e.b = r) : e = H.Color.createColor(s, n, r)
            }
            return e
        },
        webToColor: function(t, e) {
            e || (e = H.Color.createColor());
            var i = /^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(t);
            return i && (e.r = parseInt(i[1], 10),
            e.g = parseInt(i[2], 10),
            e.b = parseInt(i[3], 10),
            e.a = void 0 !== i[4] ? parseFloat(i[4]) : 1,
            H.Color.updateColor(e)),
            e
        },
        valueToColor: function(t, e) {
            if (e || (e = H.Color.createColor()),
            "string" == typeof t)
                return 0 === t.indexOf("rgb") ? H.Color.webToColor(t, e) : (e.a = 1,
                H.Color.hexToColor(t, e));
            if ("number" != typeof t)
                return e;
            var i = H.Color.getRGB(t);
            return e.r = i.r,
            e.g = i.g,
            e.b = i.b,
            e.a = i.a / 255,
            e
        },
        componentToHex: function(t) {
            var e = t.toString(16);
            return 1 === e.length ? "0" + e : e
        },
        HSVColorWheel: function(t, e) {
            void 0 === t && (t = 1),
            void 0 === e && (e = 1);
            for (var i = [], s = 0; s <= 359; s++)
                i.push(H.Color.HSVtoRGB(s / 359, t, e));
            return i
        },
        HSLColorWheel: function(t, e) {
            void 0 === t && (t = .5),
            void 0 === e && (e = .5);
            for (var i = [], s = 0; s <= 359; s++)
                i.push(H.Color.HSLtoRGB(s / 359, t, e));
            return i
        },
        interpolateColor: function(t, e, i, s, n) {
            void 0 === n && (n = 255);
            var r = H.Color.getRGB(t)
              , o = H.Color.getRGB(e)
              , a = (o.red - r.red) * s / i + r.red
              , h = (o.green - r.green) * s / i + r.green
              , l = (o.blue - r.blue) * s / i + r.blue;
            return H.Color.getColor32(n, a, h, l)
        },
        interpolateColorWithRGB: function(t, e, i, s, n, r) {
            var o = H.Color.getRGB(t)
              , a = (e - o.red) * r / n + o.red
              , h = (i - o.green) * r / n + o.green
              , l = (s - o.blue) * r / n + o.blue;
            return H.Color.getColor(a, h, l)
        },
        interpolateRGB: function(t, e, i, s, n, r, o, a) {
            var h = (s - t) * a / o + t
              , l = (n - e) * a / o + e
              , c = (r - i) * a / o + i;
            return H.Color.getColor(h, l, c)
        },
        getRandomColor: function(t, e, i) {
            if (void 0 === t && (t = 0),
            void 0 === e && (e = 255),
            void 0 === i && (i = 255),
            255 < e || e < t)
                return H.Color.getColor(255, 255, 255);
            var s = t + Math.round(Math.random() * (e - t))
              , n = t + Math.round(Math.random() * (e - t))
              , r = t + Math.round(Math.random() * (e - t));
            return H.Color.getColor32(i, s, n, r)
        },
        getRGB: function(t) {
            return 16777215 < t ? {
                alpha: t >>> 24,
                red: t >> 16 & 255,
                green: t >> 8 & 255,
                blue: 255 & t,
                a: t >>> 24,
                r: t >> 16 & 255,
                g: t >> 8 & 255,
                b: 255 & t
            } : {
                alpha: 255,
                red: t >> 16 & 255,
                green: t >> 8 & 255,
                blue: 255 & t,
                a: 255,
                r: t >> 16 & 255,
                g: t >> 8 & 255,
                b: 255 & t
            }
        },
        getWebRGB: function(t) {
            if ("object" == typeof t)
                return "rgba(" + t.r.toString() + "," + t.g.toString() + "," + t.b.toString() + "," + (t.a / 255).toString() + ")";
            var e = H.Color.getRGB(t);
            return "rgba(" + e.r.toString() + "," + e.g.toString() + "," + e.b.toString() + "," + (e.a / 255).toString() + ")"
        },
        getAlpha: function(t) {
            return t >>> 24
        },
        getAlphaFloat: function(t) {
            return (t >>> 24) / 255
        },
        getRed: function(t) {
            return t >> 16 & 255
        },
        getGreen: function(t) {
            return t >> 8 & 255
        },
        getBlue: function(t) {
            return 255 & t
        },
        blendNormal: function(t) {
            return t
        },
        blendLighten: function(t, e) {
            return t < e ? e : t
        },
        blendDarken: function(t, e) {
            return t < e ? t : e
        },
        blendMultiply: function(t, e) {
            return t * e / 255
        },
        blendAverage: function(t, e) {
            return (t + e) / 2
        },
        blendAdd: function(t, e) {
            return Math.min(255, t + e)
        },
        blendSubtract: function(t, e) {
            return Math.max(0, t + e - 255)
        },
        blendDifference: function(t, e) {
            return Math.abs(t - e)
        },
        blendNegation: function(t, e) {
            return 255 - Math.abs(255 - t - e)
        },
        blendScreen: function(t, e) {
            return 255 - ((255 - t) * (255 - e) >> 8)
        },
        blendExclusion: function(t, e) {
            return t + e - 2 * t * e / 255
        },
        blendOverlay: function(t, e) {
            return e < 128 ? 2 * t * e / 255 : 255 - 2 * (255 - t) * (255 - e) / 255
        },
        blendSoftLight: function(t, e) {
            return e < 128 ? 2 * (64 + (t >> 1)) * (e / 255) : 255 - 2 * (255 - (64 + (t >> 1))) * (255 - e) / 255
        },
        blendHardLight: function(t, e) {
            return H.Color.blendOverlay(e, t)
        },
        blendColorDodge: function(t, e) {
            return 255 === e ? e : Math.min(255, (t << 8) / (255 - e))
        },
        blendColorBurn: function(t, e) {
            return 0 === e ? e : Math.max(0, 255 - (255 - t << 8) / e)
        },
        blendLinearDodge: function(t, e) {
            return H.Color.blendAdd(t, e)
        },
        blendLinearBurn: function(t, e) {
            return H.Color.blendSubtract(t, e)
        },
        blendLinearLight: function(t, e) {
            return e < 128 ? H.Color.blendLinearBurn(t, 2 * e) : H.Color.blendLinearDodge(t, 2 * (e - 128))
        },
        blendVividLight: function(t, e) {
            return e < 128 ? H.Color.blendColorBurn(t, 2 * e) : H.Color.blendColorDodge(t, 2 * (e - 128))
        },
        blendPinLight: function(t, e) {
            return e < 128 ? H.Color.blendDarken(t, 2 * e) : H.Color.blendLighten(t, 2 * (e - 128))
        },
        blendHardMix: function(t, e) {
            return H.Color.blendVividLight(t, e) < 128 ? 0 : 255
        },
        blendReflect: function(t, e) {
            return 255 === e ? e : Math.min(255, t * t / (255 - e))
        },
        blendGlow: function(t, e) {
            return H.Color.blendReflect(e, t)
        },
        blendPhoenix: function(t, e) {
            return Math.min(t, e) - Math.max(t, e) + 255
        }
    },
    H.Physics = function(t, e) {
        e = e || {},
        this.game = t,
        this.config = e,
        this.arcade = null,
        this.p2 = null,
        this.ninja = null,
        this.box2d = null,
        this.chipmunk = null,
        this.matter = null,
        this.parseConfig()
    }
    ,
    H.Physics.ARCADE = 0,
    H.Physics.P2JS = 1,
    H.Physics.NINJA = 2,
    H.Physics.BOX2D = 3,
    H.Physics.CHIPMUNK = 4,
    H.Physics.MATTERJS = 5,
    H.Physics.prototype = {
        parseConfig: function() {
            this.config.hasOwnProperty("arcade") && !0 !== this.config.arcade || !H.Physics.hasOwnProperty("Arcade") || (this.arcade = new H.Physics.Arcade(this.game)),
            this.config.hasOwnProperty("ninja") && !0 === this.config.ninja && H.Physics.hasOwnProperty("Ninja") && (this.ninja = new H.Physics.Ninja(this.game)),
            this.config.hasOwnProperty("p2") && !0 === this.config.p2 && H.Physics.hasOwnProperty("P2") && (this.p2 = new H.Physics.P2(this.game,this.config)),
            this.config.hasOwnProperty("box2d") && !0 === this.config.box2d && H.Physics.hasOwnProperty("BOX2D") && (this.box2d = new H.Physics.BOX2D(this.game,this.config)),
            this.config.hasOwnProperty("matter") && !0 === this.config.matter && H.Physics.hasOwnProperty("Matter") && (this.matter = new H.Physics.Matter(this.game,this.config))
        },
        startSystem: function(t) {
            t === H.Physics.ARCADE ? this.arcade = new H.Physics.Arcade(this.game) : t === H.Physics.P2JS ? null === this.p2 ? this.p2 = new H.Physics.P2(this.game,this.config) : this.p2.reset() : t === H.Physics.NINJA ? this.ninja = new H.Physics.Ninja(this.game) : t === H.Physics.BOX2D ? null === this.box2d ? this.box2d = new H.Physics.Box2D(this.game,this.config) : this.box2d.reset() : t === H.Physics.MATTERJS && (null === this.matter ? this.matter = new H.Physics.Matter(this.game,this.config) : this.matter.reset())
        },
        enable: function(t, e, i) {
            void 0 === e && (e = H.Physics.ARCADE),
            void 0 === i && (i = !1),
            e === H.Physics.ARCADE ? this.arcade.enable(t) : e === H.Physics.P2JS && this.p2 ? this.p2.enable(t, i) : e === H.Physics.NINJA && this.ninja ? this.ninja.enableAABB(t) : e === H.Physics.BOX2D && this.box2d ? this.box2d.enable(t) : e === H.Physics.MATTERJS && this.matter && this.matter.enable(t)
        },
        preUpdate: function() {
            this.p2 && this.p2.preUpdate(),
            this.box2d && this.box2d.preUpdate(),
            this.matter && this.matter.preUpdate()
        },
        update: function() {
            this.p2 && this.p2.update(),
            this.box2d && this.box2d.update(),
            this.matter && this.matter.update()
        },
        setBoundsToWorld: function() {
            this.arcade && this.arcade.setBoundsToWorld(),
            this.ninja && this.ninja.setBoundsToWorld(),
            this.p2 && this.p2.setBoundsToWorld(),
            this.box2d && this.box2d.setBoundsToWorld(),
            this.matter && this.matter.setBoundsToWorld()
        },
        clear: function() {
            this.p2 && this.p2.clear(),
            this.box2d && this.box2d.clear(),
            this.matter && this.matter.clear()
        },
        reset: function() {
            this.p2 && this.p2.reset(),
            this.box2d && this.box2d.reset(),
            this.matter && this.matter.reset()
        },
        destroy: function() {
            this.p2 && this.p2.destroy(),
            this.box2d && this.box2d.destroy(),
            this.matter && this.matter.destroy(),
            this.arcade = null,
            this.ninja = null,
            this.p2 = null,
            this.box2d = null,
            this.matter = null
        }
    },
    H.Physics.prototype.constructor = H.Physics,
    H.Physics.Arcade = function(t) {
        this.game = t,
        this.gravity = new H.Point,
        this.bounds = new H.Rectangle(0,0,t.world.width,t.world.height),
        this.checkCollision = {
            up: !0,
            down: !0,
            left: !0,
            right: !0
        },
        this.maxObjects = 10,
        this.maxLevels = 4,
        this.OVERLAP_BIAS = 4,
        this.forceX = !1,
        this.sortDirection = H.Physics.Arcade.LEFT_RIGHT,
        this.skipQuadTree = !0,
        this.isPaused = !1,
        this.quadTree = new H.QuadTree(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),
        this._total = 0,
        this.setBoundsToWorld()
    }
    ,
    H.Physics.Arcade.prototype.constructor = H.Physics.Arcade,
    H.Physics.Arcade.SORT_NONE = 0,
    H.Physics.Arcade.LEFT_RIGHT = 1,
    H.Physics.Arcade.RIGHT_LEFT = 2,
    H.Physics.Arcade.TOP_BOTTOM = 3,
    H.Physics.Arcade.BOTTOM_TOP = 4,
    H.Physics.Arcade.prototype = {
        setBounds: function(t, e, i, s) {
            this.bounds.setTo(t, e, i, s)
        },
        setBoundsToWorld: function() {
            this.bounds.copyFrom(this.game.world.bounds)
        },
        enable: function(t, e) {
            void 0 === e && (e = !0);
            var i = 1;
            if (Array.isArray(t))
                for (i = t.length; i--; )
                    t[i]instanceof H.Group ? this.enable(t[i].children, e) : (this.enableBody(t[i]),
                    e && t[i].hasOwnProperty("children") && 0 < t[i].children.length && this.enable(t[i], !0));
            else
                t instanceof H.Group ? this.enable(t.children, e) : (this.enableBody(t),
                e && t.hasOwnProperty("children") && 0 < t.children.length && this.enable(t.children, !0))
        },
        enableBody: function(t) {
            t.hasOwnProperty("body") && null === t.body && (t.body = new H.Physics.Arcade.Body(t),
            t.parent && t.parent instanceof H.Group && t.parent.addToHash(t))
        },
        updateMotion: function(t) {
            var e = this.computeVelocity(0, t, t.angularVelocity, t.angularAcceleration, t.angularDrag, t.maxAngular) - t.angularVelocity;
            t.angularVelocity += e,
            t.rotation += t.angularVelocity * this.game.time.physicsElapsed,
            t.velocity.x = this.computeVelocity(1, t, t.velocity.x, t.acceleration.x, t.drag.x, t.maxVelocity.x),
            t.velocity.y = this.computeVelocity(2, t, t.velocity.y, t.acceleration.y, t.drag.y, t.maxVelocity.y)
        },
        computeVelocity: function(t, e, i, s, n, r) {
            return void 0 === r && (r = 1e4),
            1 === t && e.allowGravity ? i += (this.gravity.x + e.gravity.x) * this.game.time.physicsElapsed : 2 === t && e.allowGravity && (i += (this.gravity.y + e.gravity.y) * this.game.time.physicsElapsed),
            s ? i += s * this.game.time.physicsElapsed : n && (0 < i - (n *= this.game.time.physicsElapsed) ? i -= n : i + n < 0 ? i += n : i = 0),
            r < i ? i = r : i < -r && (i = -r),
            i
        },
        overlap: function(t, e, i, s, n) {
            if (i = i || null,
            s = s || null,
            n = n || i,
            this._total = 0,
            !Array.isArray(t) && Array.isArray(e))
                for (var r = 0; r < e.length; r++)
                    this.collideHandler(t, e[r], i, s, n, !0);
            else if (Array.isArray(t) && !Array.isArray(e))
                for (r = 0; r < t.length; r++)
                    this.collideHandler(t[r], e, i, s, n, !0);
            else if (Array.isArray(t) && Array.isArray(e))
                for (r = 0; r < t.length; r++)
                    for (var o = 0; o < e.length; o++)
                        this.collideHandler(t[r], e[o], i, s, n, !0);
            else
                this.collideHandler(t, e, i, s, n, !0);
            return 0 < this._total
        },
        collide: function(t, e, i, s, n) {
            if (i = i || null,
            s = s || null,
            n = n || i,
            this._total = 0,
            !Array.isArray(t) && Array.isArray(e))
                for (var r = 0; r < e.length; r++)
                    this.collideHandler(t, e[r], i, s, n, !1);
            else if (Array.isArray(t) && !Array.isArray(e))
                for (r = 0; r < t.length; r++)
                    this.collideHandler(t[r], e, i, s, n, !1);
            else if (Array.isArray(t) && Array.isArray(e))
                for (r = 0; r < t.length; r++)
                    for (var o = 0; o < e.length; o++)
                        this.collideHandler(t[r], e[o], i, s, n, !1);
            else
                this.collideHandler(t, e, i, s, n, !1);
            return 0 < this._total
        },
        sortLeftRight: function(t, e) {
            return t.body && e.body ? t.body.x - e.body.x : 0
        },
        sortRightLeft: function(t, e) {
            return t.body && e.body ? e.body.x - t.body.x : 0
        },
        sortTopBottom: function(t, e) {
            return t.body && e.body ? t.body.y - e.body.y : 0
        },
        sortBottomTop: function(t, e) {
            return t.body && e.body ? e.body.y - t.body.y : 0
        },
        sort: function(t, e) {
            null !== t.physicsSortDirection ? e = t.physicsSortDirection : void 0 === e && (e = this.sortDirection),
            e === H.Physics.Arcade.LEFT_RIGHT ? t.hash.sort(this.sortLeftRight) : e === H.Physics.Arcade.RIGHT_LEFT ? t.hash.sort(this.sortRightLeft) : e === H.Physics.Arcade.TOP_BOTTOM ? t.hash.sort(this.sortTopBottom) : e === H.Physics.Arcade.BOTTOM_TOP && t.hash.sort(this.sortBottomTop)
        },
        collideHandler: function(t, e, i, s, n, r) {
            if (void 0 === e && t.physicsType === H.GROUP)
                return this.sort(t),
                void this.collideGroupVsSelf(t, i, s, n, r);
            t && e && t.exists && e.exists && (this.sortDirection !== H.Physics.Arcade.SORT_NONE && (t.physicsType === H.GROUP && this.sort(t),
            e.physicsType === H.GROUP && this.sort(e)),
            t.physicsType === H.SPRITE ? e.physicsType === H.SPRITE ? this.collideSpriteVsSprite(t, e, i, s, n, r) : e.physicsType === H.GROUP ? this.collideSpriteVsGroup(t, e, i, s, n, r) : e.physicsType === H.TILEMAPLAYER && this.collideSpriteVsTilemapLayer(t, e, i, s, n, r) : t.physicsType === H.GROUP ? e.physicsType === H.SPRITE ? this.collideSpriteVsGroup(e, t, i, s, n, r) : e.physicsType === H.GROUP ? this.collideGroupVsGroup(t, e, i, s, n, r) : e.physicsType === H.TILEMAPLAYER && this.collideGroupVsTilemapLayer(t, e, i, s, n, r) : t.physicsType === H.TILEMAPLAYER && (e.physicsType === H.SPRITE ? this.collideSpriteVsTilemapLayer(e, t, i, s, n, r) : e.physicsType === H.GROUP && this.collideGroupVsTilemapLayer(e, t, i, s, n, r)))
        },
        collideSpriteVsSprite: function(t, e, i, s, n, r) {
            return !(!t.body || !e.body || (this.separate(t.body, e.body, s, n, r) && (i && i.call(n, t, e),
            this._total++),
            0))
        },
        collideSpriteVsGroup: function(t, e, i, s, n, r) {
            if (0 !== e.length && t.body)
                if (this.skipQuadTree || t.body.skipQuadTree)
                    for (var o = {}, a = 0; a < e.hash.length; a++) {
                        var h = e.hash[a];
                        if (h && h.exists && h.body) {
                            if (o = h.body.getBounds(o),
                            this.sortDirection === H.Physics.Arcade.LEFT_RIGHT) {
                                if (t.body.right < o.x)
                                    break;
                                if (o.right < t.body.x)
                                    continue
                            } else if (this.sortDirection === H.Physics.Arcade.RIGHT_LEFT) {
                                if (t.body.x > o.right)
                                    break;
                                if (o.x > t.body.right)
                                    continue
                            } else if (this.sortDirection === H.Physics.Arcade.TOP_BOTTOM) {
                                if (t.body.bottom < o.y)
                                    break;
                                if (o.bottom < t.body.y)
                                    continue
                            } else if (this.sortDirection === H.Physics.Arcade.BOTTOM_TOP) {
                                if (t.body.y > o.bottom)
                                    break;
                                if (o.y > t.body.bottom)
                                    continue
                            }
                            this.collideSpriteVsSprite(t, h, i, s, n, r)
                        }
                    }
                else {
                    this.quadTree.clear(),
                    this.quadTree.reset(this.game.world.bounds.x, this.game.world.bounds.y, this.game.world.bounds.width, this.game.world.bounds.height, this.maxObjects, this.maxLevels),
                    this.quadTree.populate(e);
                    var l = this.quadTree.retrieve(t);
                    for (a = 0; a < l.length; a++)
                        this.separate(t.body, l[a], s, n, r) && (i && i.call(n, t, l[a].sprite),
                        this._total++)
                }
        },
        collideGroupVsSelf: function(t, e, i, s, n) {
            if (0 !== t.length)
                for (var r = 0; r < t.hash.length; r++) {
                    var o = {}
                      , a = t.hash[r];
                    if (a && a.exists && a.body) {
                        o = a.body.getBounds(o);
                        for (var h = r + 1; h < t.hash.length; h++) {
                            var l = {}
                              , c = t.hash[h];
                            if (c && c.exists && c.body) {
                                if (l = c.body.getBounds(l),
                                this.sortDirection === H.Physics.Arcade.LEFT_RIGHT) {
                                    if (o.right < l.x)
                                        break;
                                    if (l.right < o.x)
                                        continue
                                } else if (this.sortDirection === H.Physics.Arcade.RIGHT_LEFT) {
                                    if (o.x > l.right)
                                        continue;
                                    if (l.x > o.right)
                                        break
                                } else if (this.sortDirection === H.Physics.Arcade.TOP_BOTTOM) {
                                    if (o.bottom < l.y)
                                        continue;
                                    if (l.bottom < o.y)
                                        break
                                } else if (this.sortDirection === H.Physics.Arcade.BOTTOM_TOP) {
                                    if (o.y > l.bottom)
                                        continue;
                                    if (l.y > a.body.bottom)
                                        break
                                }
                                this.collideSpriteVsSprite(a, c, e, i, s, n)
                            }
                        }
                    }
                }
        },
        collideGroupVsGroup: function(t, e, i, s, n, r) {
            if (0 !== t.length && 0 !== e.length)
                for (var o = 0; o < t.children.length; o++)
                    t.children[o].exists && (t.children[o].physicsType === H.GROUP ? this.collideGroupVsGroup(t.children[o], e, i, s, n, r) : this.collideSpriteVsGroup(t.children[o], e, i, s, n, r))
        },
        separate: function(t, e, i, s, n) {
            if (!t.enable || !e.enable || t.checkCollision.none || e.checkCollision.none || !this.intersects(t, e))
                return !1;
            if (i && !1 === i.call(s, t.sprite, e.sprite))
                return !1;
            if (t.isCircle && e.isCircle)
                return this.separateCircle(t, e, n);
            if (t.isCircle !== e.isCircle) {
                var r = t.isCircle ? e : t
                  , o = t.isCircle ? t : e
                  , a = r.x
                  , h = r.y
                  , l = r.right
                  , c = r.bottom
                  , d = o.x + o.radius
                  , u = o.y + o.radius;
                if ((u < h || c < u) && (d < a || l < d))
                    return this.separateCircle(t, e, n)
            }
            var p = !1
              , g = !1;
            this.forceX || Math.abs(this.gravity.y + t.gravity.y) < Math.abs(this.gravity.x + t.gravity.x) ? (p = this.separateX(t, e, n),
            this.intersects(t, e) && (g = this.separateY(t, e, n))) : (g = this.separateY(t, e, n),
            this.intersects(t, e) && (p = this.separateX(t, e, n)));
            var f = p || g;
            return f && (n ? (t.onOverlap && t.onOverlap.dispatch(t.sprite, e.sprite),
            e.onOverlap && e.onOverlap.dispatch(e.sprite, t.sprite)) : (t.onCollide && t.onCollide.dispatch(t.sprite, e.sprite),
            e.onCollide && e.onCollide.dispatch(e.sprite, t.sprite))),
            f
        },
        intersects: function(t, e) {
            return t !== e && (t.isCircle ? e.isCircle ? H.Math.distance(t.center.x, t.center.y, e.center.x, e.center.y) <= t.radius + e.radius : this.circleBodyIntersects(t, e) : e.isCircle ? this.circleBodyIntersects(e, t) : !(t.right <= e.position.x || t.bottom <= e.position.y || t.position.x >= e.right || t.position.y >= e.bottom))
        },
        circleBodyIntersects: function(t, e) {
            var i = H.Math.clamp(t.center.x, e.left, e.right)
              , s = H.Math.clamp(t.center.y, e.top, e.bottom);
            return (t.center.x - i) * (t.center.x - i) + (t.center.y - s) * (t.center.y - s) <= t.radius * t.radius
        },
        separateCircle: function(t, e, i) {
            this.getOverlapX(t, e),
            this.getOverlapY(t, e);
            var s = e.center.x - t.center.x
              , n = e.center.y - t.center.y
              , r = Math.atan2(n, s)
              , o = 0;
            if (t.isCircle !== e.isCircle) {
                var a = {
                    x: e.isCircle ? t.position.x : e.position.x,
                    y: e.isCircle ? t.position.y : e.position.y,
                    right: e.isCircle ? t.right : e.right,
                    bottom: e.isCircle ? t.bottom : e.bottom
                }
                  , h = {
                    x: t.isCircle ? t.position.x + t.radius : e.position.x + e.radius,
                    y: t.isCircle ? t.position.y + t.radius : e.position.y + e.radius,
                    radius: t.isCircle ? t.radius : e.radius
                };
                h.y < a.y ? h.x < a.x ? o = H.Math.distance(h.x, h.y, a.x, a.y) - h.radius : a.right < h.x && (o = H.Math.distance(h.x, h.y, a.right, a.y) - h.radius) : a.bottom < h.y && (h.x < a.x ? o = H.Math.distance(h.x, h.y, a.x, a.bottom) - h.radius : a.right < h.x && (o = H.Math.distance(h.x, h.y, a.right, a.bottom) - h.radius)),
                o *= -1
            } else
                o = t.radius + e.radius - H.Math.distance(t.center.x, t.center.y, e.center.x, e.center.y);
            if (i || 0 === o || t.immovable && e.immovable || t.customSeparateX || e.customSeparateX)
                return 0 !== o && (t.onOverlap && t.onOverlap.dispatch(t.sprite, e.sprite),
                e.onOverlap && e.onOverlap.dispatch(e.sprite, t.sprite)),
                0 !== o;
            var l = t.velocity.x * Math.cos(r) + t.velocity.y * Math.sin(r)
              , c = t.velocity.x * Math.sin(r) - t.velocity.y * Math.cos(r)
              , d = e.velocity.x * Math.cos(r) + e.velocity.y * Math.sin(r)
              , u = e.velocity.x * Math.sin(r) - e.velocity.y * Math.cos(r)
              , p = ((t.mass - e.mass) * l + 2 * e.mass * d) / (t.mass + e.mass)
              , g = (2 * t.mass * l + (e.mass - t.mass) * d) / (t.mass + e.mass);
            return t.immovable || (t.velocity.x = (p * Math.cos(r) - c * Math.sin(r)) * t.bounce.x,
            t.velocity.y = (c * Math.cos(r) + p * Math.sin(r)) * t.bounce.y),
            e.immovable || (e.velocity.x = (g * Math.cos(r) - u * Math.sin(r)) * e.bounce.x,
            e.velocity.y = (u * Math.cos(r) + g * Math.sin(r)) * e.bounce.y),
            Math.abs(r) < Math.PI / 2 ? 0 < t.velocity.x && !t.immovable && e.velocity.x > t.velocity.x ? t.velocity.x *= -1 : e.velocity.x < 0 && !e.immovable && t.velocity.x < e.velocity.x ? e.velocity.x *= -1 : 0 < t.velocity.y && !t.immovable && e.velocity.y > t.velocity.y ? t.velocity.y *= -1 : e.velocity.y < 0 && !e.immovable && t.velocity.y < e.velocity.y && (e.velocity.y *= -1) : Math.abs(r) > Math.PI / 2 && (t.velocity.x < 0 && !t.immovable && e.velocity.x < t.velocity.x ? t.velocity.x *= -1 : 0 < e.velocity.x && !e.immovable && t.velocity.x > e.velocity.x ? e.velocity.x *= -1 : t.velocity.y < 0 && !t.immovable && e.velocity.y < t.velocity.y ? t.velocity.y *= -1 : 0 < e.velocity.y && !e.immovable && t.velocity.x > e.velocity.y && (e.velocity.y *= -1)),
            t.immovable || (t.x += t.velocity.x * this.game.time.physicsElapsed - o * Math.cos(r),
            t.y += t.velocity.y * this.game.time.physicsElapsed - o * Math.sin(r)),
            e.immovable || (e.x += e.velocity.x * this.game.time.physicsElapsed + o * Math.cos(r),
            e.y += e.velocity.y * this.game.time.physicsElapsed + o * Math.sin(r)),
            t.onCollide && t.onCollide.dispatch(t.sprite, e.sprite),
            e.onCollide && e.onCollide.dispatch(e.sprite, t.sprite),
            !0
        },
        getOverlapX: function(t, e, i) {
            var s = 0
              , n = t.deltaAbsX() + e.deltaAbsX() + this.OVERLAP_BIAS;
            return 0 === t.deltaX() && 0 === e.deltaX() ? (t.embedded = !0,
            e.embedded = !0) : t.deltaX() > e.deltaX() ? n < (s = t.right - e.x) && !i || !1 === t.checkCollision.right || !1 === e.checkCollision.left ? s = 0 : (t.touching.none = !1,
            t.touching.right = !0,
            e.touching.none = !1,
            e.touching.left = !0) : t.deltaX() < e.deltaX() && (n < -(s = t.x - e.width - e.x) && !i || !1 === t.checkCollision.left || !1 === e.checkCollision.right ? s = 0 : (t.touching.none = !1,
            t.touching.left = !0,
            e.touching.none = !1,
            e.touching.right = !0)),
            t.overlapX = s,
            e.overlapX = s
        },
        getOverlapY: function(t, e, i) {
            var s = 0
              , n = t.deltaAbsY() + e.deltaAbsY() + this.OVERLAP_BIAS;
            return 0 === t.deltaY() && 0 === e.deltaY() ? (t.embedded = !0,
            e.embedded = !0) : t.deltaY() > e.deltaY() ? n < (s = t.bottom - e.y) && !i || !1 === t.checkCollision.down || !1 === e.checkCollision.up ? s = 0 : (t.touching.none = !1,
            t.touching.down = !0,
            e.touching.none = !1,
            e.touching.up = !0) : t.deltaY() < e.deltaY() && (n < -(s = t.y - e.bottom) && !i || !1 === t.checkCollision.up || !1 === e.checkCollision.down ? s = 0 : (t.touching.none = !1,
            t.touching.up = !0,
            e.touching.none = !1,
            e.touching.down = !0)),
            t.overlapY = s,
            e.overlapY = s
        },
        separateX: function(t, e, i) {
            var s = this.getOverlapX(t, e, i);
            if (i || 0 === s || t.immovable && e.immovable || t.customSeparateX || e.customSeparateX)
                return 0 !== s || t.embedded && e.embedded;
            var n = t.velocity.x
              , r = e.velocity.x;
            if (t.immovable || e.immovable)
                t.immovable ? (e.x += s,
                e.velocity.x = n - r * e.bounce.x,
                t.moves && (e.y += (t.y - t.prev.y) * t.friction.y)) : (t.x -= s,
                t.velocity.x = r - n * t.bounce.x,
                e.moves && (t.y += (e.y - e.prev.y) * e.friction.y));
            else {
                s *= .5,
                t.x -= s,
                e.x += s;
                var o = Math.sqrt(r * r * e.mass / t.mass) * (0 < r ? 1 : -1)
                  , a = Math.sqrt(n * n * t.mass / e.mass) * (0 < n ? 1 : -1)
                  , h = .5 * (o + a);
                o -= h,
                a -= h,
                t.velocity.x = h + o * t.bounce.x,
                e.velocity.x = h + a * e.bounce.x
            }
            return !0
        },
        separateY: function(t, e, i) {
            var s = this.getOverlapY(t, e, i);
            if (i || 0 === s || t.immovable && e.immovable || t.customSeparateY || e.customSeparateY)
                return 0 !== s || t.embedded && e.embedded;
            var n = t.velocity.y
              , r = e.velocity.y;
            if (t.immovable || e.immovable)
                t.immovable ? (e.y += s,
                e.velocity.y = n - r * e.bounce.y,
                t.moves && (e.x += (t.x - t.prev.x) * t.friction.x)) : (t.y -= s,
                t.velocity.y = r - n * t.bounce.y,
                e.moves && (t.x += (e.x - e.prev.x) * e.friction.x));
            else {
                s *= .5,
                t.y -= s,
                e.y += s;
                var o = Math.sqrt(r * r * e.mass / t.mass) * (0 < r ? 1 : -1)
                  , a = Math.sqrt(n * n * t.mass / e.mass) * (0 < n ? 1 : -1)
                  , h = .5 * (o + a);
                o -= h,
                a -= h,
                t.velocity.y = h + o * t.bounce.y,
                e.velocity.y = h + a * e.bounce.y
            }
            return !0
        },
        getObjectsUnderPointer: function(t, e, i, s) {
            if (0 !== e.length && t.exists)
                return this.getObjectsAtLocation(t.x, t.y, e, i, s, t)
        },
        getObjectsAtLocation: function(t, e, i, s, n, r) {
            this.quadTree.clear(),
            this.quadTree.reset(this.game.world.bounds.x, this.game.world.bounds.y, this.game.world.bounds.width, this.game.world.bounds.height, this.maxObjects, this.maxLevels),
            this.quadTree.populate(i);
            for (var o = new H.Rectangle(t,e,1,1), a = [], h = this.quadTree.retrieve(o), l = 0; l < h.length; l++)
                h[l].hitTest(t, e) && (s && s.call(n, r, h[l].sprite),
                a.push(h[l].sprite));
            return a
        },
        moveToObject: function(t, e, i, s) {
            void 0 === i && (i = 60),
            void 0 === s && (s = 0);
            var n = Math.atan2(e.y - t.y, e.x - t.x);
            return 0 < s && (i = this.distanceBetween(t, e) / (s / 1e3)),
            t.body.velocity.x = Math.cos(n) * i,
            t.body.velocity.y = Math.sin(n) * i,
            n
        },
        moveToPointer: function(t, e, i, s) {
            void 0 === e && (e = 60),
            i = i || this.game.input.activePointer,
            void 0 === s && (s = 0);
            var n = this.angleToPointer(t, i);
            return 0 < s && (e = this.distanceToPointer(t, i) / (s / 1e3)),
            t.body.velocity.x = Math.cos(n) * e,
            t.body.velocity.y = Math.sin(n) * e,
            n
        },
        moveToXY: function(t, e, i, s, n) {
            void 0 === s && (s = 60),
            void 0 === n && (n = 0);
            var r = Math.atan2(i - t.y, e - t.x);
            return 0 < n && (s = this.distanceToXY(t, e, i) / (n / 1e3)),
            t.body.velocity.x = Math.cos(r) * s,
            t.body.velocity.y = Math.sin(r) * s,
            r
        },
        velocityFromAngle: function(t, e, i) {
            return void 0 === e && (e = 60),
            (i = i || new H.Point).setTo(Math.cos(this.game.math.degToRad(t)) * e, Math.sin(this.game.math.degToRad(t)) * e)
        },
        velocityFromRotation: function(t, e, i) {
            return void 0 === e && (e = 60),
            (i = i || new H.Point).setTo(Math.cos(t) * e, Math.sin(t) * e)
        },
        accelerationFromRotation: function(t, e, i) {
            return void 0 === e && (e = 60),
            (i = i || new H.Point).setTo(Math.cos(t) * e, Math.sin(t) * e)
        },
        accelerateToObject: function(t, e, i, s, n) {
            void 0 === i && (i = 60),
            void 0 === s && (s = 1e3),
            void 0 === n && (n = 1e3);
            var r = this.angleBetween(t, e);
            return t.body.acceleration.setTo(Math.cos(r) * i, Math.sin(r) * i),
            t.body.maxVelocity.setTo(s, n),
            r
        },
        accelerateToPointer: function(t, e, i, s, n) {
            void 0 === i && (i = 60),
            void 0 === e && (e = this.game.input.activePointer),
            void 0 === s && (s = 1e3),
            void 0 === n && (n = 1e3);
            var r = this.angleToPointer(t, e);
            return t.body.acceleration.setTo(Math.cos(r) * i, Math.sin(r) * i),
            t.body.maxVelocity.setTo(s, n),
            r
        },
        accelerateToXY: function(t, e, i, s, n, r) {
            void 0 === s && (s = 60),
            void 0 === n && (n = 1e3),
            void 0 === r && (r = 1e3);
            var o = this.angleToXY(t, e, i);
            return t.body.acceleration.setTo(Math.cos(o) * s, Math.sin(o) * s),
            t.body.maxVelocity.setTo(n, r),
            o
        },
        distanceBetween: function(t, e, i) {
            void 0 === i && (i = !1);
            var s = i ? t.world.x - e.world.x : t.x - e.x
              , n = i ? t.world.y - e.world.y : t.y - e.y;
            return Math.sqrt(s * s + n * n)
        },
        distanceToXY: function(t, e, i, s) {
            void 0 === s && (s = !1);
            var n = s ? t.world.x - e : t.x - e
              , r = s ? t.world.y - i : t.y - i;
            return Math.sqrt(n * n + r * r)
        },
        distanceToPointer: function(t, e, i) {
            void 0 === e && (e = this.game.input.activePointer),
            void 0 === i && (i = !1);
            var s = i ? t.world.x - e.worldX : t.x - e.worldX
              , n = i ? t.world.y - e.worldY : t.y - e.worldY;
            return Math.sqrt(s * s + n * n)
        },
        angleBetween: function(t, e, i) {
            return void 0 === i && (i = !1),
            i ? Math.atan2(e.world.y - t.world.y, e.world.x - t.world.x) : Math.atan2(e.y - t.y, e.x - t.x)
        },
        angleBetweenCenters: function(t, e) {
            var i = e.centerX - t.centerX
              , s = e.centerY - t.centerY;
            return Math.atan2(s, i)
        },
        angleToXY: function(t, e, i, s) {
            return void 0 === s && (s = !1),
            s ? Math.atan2(i - t.world.y, e - t.world.x) : Math.atan2(i - t.y, e - t.x)
        },
        angleToPointer: function(t, e, i) {
            return void 0 === e && (e = this.game.input.activePointer),
            void 0 === i && (i = !1),
            i ? Math.atan2(e.worldY - t.world.y, e.worldX - t.world.x) : Math.atan2(e.worldY - t.y, e.worldX - t.x)
        },
        worldAngleToPointer: function(t, e) {
            return this.angleToPointer(t, e, !0)
        }
    },
    H.Physics.Arcade.Body = function(t) {
        this.sprite = t,
        this.game = t.game,
        this.type = H.Physics.ARCADE,
        this.enable = !0,
        this.isCircle = !1,
        this.radius = 0,
        this.offset = new H.Point,
        this.position = new H.Point(t.x,t.y),
        this.prev = new H.Point(this.position.x,this.position.y),
        this.allowRotation = !0,
        this.rotation = t.angle,
        this.preRotation = t.angle,
        this.width = t.width,
        this.height = t.height,
        this.sourceWidth = t.width,
        this.sourceHeight = t.height,
        t.texture && (this.sourceWidth = t.texture.frame.width,
        this.sourceHeight = t.texture.frame.height),
        this.halfWidth = Math.abs(t.width / 2),
        this.halfHeight = Math.abs(t.height / 2),
        this.center = new H.Point(t.x + this.halfWidth,t.y + this.halfHeight),
        this.velocity = new H.Point,
        this.newVelocity = new H.Point,
        this.deltaMax = new H.Point,
        this.acceleration = new H.Point,
        this.drag = new H.Point,
        this.allowGravity = !0,
        this.gravity = new H.Point,
        this.bounce = new H.Point,
        this.worldBounce = null,
        this.onWorldBounds = null,
        this.onCollide = null,
        this.onOverlap = null,
        this.maxVelocity = new H.Point(1e4,1e4),
        this.friction = new H.Point(1,0),
        this.angularVelocity = 0,
        this.angularAcceleration = 0,
        this.angularDrag = 0,
        this.maxAngular = 1e3,
        this.mass = 1,
        this.angle = 0,
        this.speed = 0,
        this.facing = H.NONE,
        this.immovable = !1,
        this.moves = !0,
        this.customSeparateX = !1,
        this.customSeparateY = !1,
        this.overlapX = 0,
        this.overlapY = 0,
        this.overlapR = 0,
        this.embedded = !1,
        this.collideWorldBounds = !1,
        this.checkCollision = {
            none: !1,
            any: !0,
            up: !0,
            down: !0,
            left: !0,
            right: !0
        },
        this.touching = {
            none: !0,
            up: !1,
            down: !1,
            left: !1,
            right: !1
        },
        this.wasTouching = {
            none: !0,
            up: !1,
            down: !1,
            left: !1,
            right: !1
        },
        this.blocked = {
            up: !1,
            down: !1,
            left: !1,
            right: !1
        },
        this.tilePadding = new H.Point,
        this.dirty = !1,
        this.skipQuadTree = !1,
        this.syncBounds = !1,
        this.isMoving = !1,
        this.stopVelocityOnCollide = !0,
        this.moveTimer = 0,
        this.moveDistance = 0,
        this.moveDuration = 0,
        this.moveTarget = null,
        this.moveEnd = null,
        this.onMoveComplete = new H.Signal,
        this.movementCallback = null,
        this.movementCallbackContext = null,
        this._reset = !0,
        this._sx = t.scale.x,
        this._sy = t.scale.y,
        this._dx = 0,
        this._dy = 0
    }
    ,
    H.Physics.Arcade.Body.prototype = {
        updateBounds: function() {
            if (this.syncBounds) {
                var t = this.sprite.getBounds();
                t.ceilAll(),
                t.width === this.width && t.height === this.height || (this.width = t.width,
                this.height = t.height,
                this._reset = !0)
            } else {
                var e = Math.abs(this.sprite.scale.x)
                  , i = Math.abs(this.sprite.scale.y);
                e === this._sx && i === this._sy || (this.width = this.sourceWidth * e,
                this.height = this.sourceHeight * i,
                this._sx = e,
                this._sy = i,
                this._reset = !0)
            }
            this._reset && (this.halfWidth = Math.floor(this.width / 2),
            this.halfHeight = Math.floor(this.height / 2),
            this.center.setTo(this.position.x + this.halfWidth, this.position.y + this.halfHeight))
        },
        preUpdate: function() {
            this.enable && !this.game.physics.arcade.isPaused && (this.dirty = !0,
            this.wasTouching.none = this.touching.none,
            this.wasTouching.up = this.touching.up,
            this.wasTouching.down = this.touching.down,
            this.wasTouching.left = this.touching.left,
            this.wasTouching.right = this.touching.right,
            this.touching.none = !0,
            this.touching.up = !1,
            this.touching.down = !1,
            this.touching.left = !1,
            this.touching.right = !1,
            this.blocked.up = !1,
            this.blocked.down = !1,
            this.blocked.left = !1,
            this.blocked.right = !1,
            this.embedded = !1,
            this.updateBounds(),
            this.position.x = this.sprite.world.x - this.sprite.anchor.x * this.sprite.width + this.sprite.scale.x * this.offset.x,
            this.position.x -= this.sprite.scale.x < 0 ? this.width : 0,
            this.position.y = this.sprite.world.y - this.sprite.anchor.y * this.sprite.height + this.sprite.scale.y * this.offset.y,
            this.position.y -= this.sprite.scale.y < 0 ? this.height : 0,
            this.rotation = this.sprite.angle,
            this.preRotation = this.rotation,
            (this._reset || this.sprite.fresh) && (this.prev.x = this.position.x,
            this.prev.y = this.position.y),
            this.moves && (this.game.physics.arcade.updateMotion(this),
            this.newVelocity.set(this.velocity.x * this.game.time.physicsElapsed, this.velocity.y * this.game.time.physicsElapsed),
            this.position.x += this.newVelocity.x,
            this.position.y += this.newVelocity.y,
            this.position.x === this.prev.x && this.position.y === this.prev.y || (this.angle = Math.atan2(this.velocity.y, this.velocity.x)),
            this.speed = Math.sqrt(this.velocity.x * this.velocity.x + this.velocity.y * this.velocity.y),
            this.collideWorldBounds && this.checkWorldBounds() && this.onWorldBounds && this.onWorldBounds.dispatch(this.sprite, this.blocked.up, this.blocked.down, this.blocked.left, this.blocked.right)),
            this._dx = this.deltaX(),
            this._dy = this.deltaY(),
            this._reset = !1)
        },
        updateMovement: function() {
            var t = 0
              , e = 0 !== this.overlapX || 0 !== this.overlapY;
            if (t = 0 < this.moveDuration ? (this.moveTimer += this.game.time.elapsedMS,
            this.moveTimer / this.moveDuration) : (this.moveTarget.end.set(this.position.x, this.position.y),
            this.moveTarget.length / this.moveDistance),
            this.movementCallback)
                var i = this.movementCallback.call(this.movementCallbackContext, this, this.velocity, t);
            return !(e || 1 <= t || void 0 !== i && !0 !== i) || (this.stopMovement(1 <= t || this.stopVelocityOnCollide && e),
            !1)
        },
        stopMovement: function(t) {
            this.isMoving && (this.isMoving = !1,
            t && this.velocity.set(0),
            this.onMoveComplete.dispatch(this.sprite, 0 !== this.overlapX || 0 !== this.overlapY))
        },
        postUpdate: function() {
            this.enable && this.dirty && (this.isMoving && this.updateMovement(),
            this.dirty = !1,
            this.deltaX() < 0 ? this.facing = H.LEFT : 0 < this.deltaX() && (this.facing = H.RIGHT),
            this.deltaY() < 0 ? this.facing = H.UP : 0 < this.deltaY() && (this.facing = H.DOWN),
            this.moves && (this._dx = this.deltaX(),
            this._dy = this.deltaY(),
            0 !== this.deltaMax.x && 0 !== this._dx && (this._dx < 0 && this._dx < -this.deltaMax.x ? this._dx = -this.deltaMax.x : 0 < this._dx && this._dx > this.deltaMax.x && (this._dx = this.deltaMax.x)),
            0 !== this.deltaMax.y && 0 !== this._dy && (this._dy < 0 && this._dy < -this.deltaMax.y ? this._dy = -this.deltaMax.y : 0 < this._dy && this._dy > this.deltaMax.y && (this._dy = this.deltaMax.y)),
            this.sprite.position.x += this._dx,
            this.sprite.position.y += this._dy,
            this._reset = !0),
            this.center.setTo(this.position.x + this.halfWidth, this.position.y + this.halfHeight),
            this.allowRotation && (this.sprite.angle += this.deltaZ()),
            this.prev.x = this.position.x,
            this.prev.y = this.position.y)
        },
        checkWorldBounds: function() {
            var t = this.position
              , e = this.game.physics.arcade.bounds
              , i = this.game.physics.arcade.checkCollision
              , s = this.worldBounce ? -this.worldBounce.x : -this.bounce.x
              , n = this.worldBounce ? -this.worldBounce.y : -this.bounce.y;
            if (this.isCircle) {
                var r = this.center.x - this.radius
                  , o = this.center.y - this.radius
                  , a = this.center.x + this.radius
                  , h = this.center.y + this.radius;
                r < e.x && i.left ? (t.x = e.x - this.halfWidth + this.radius,
                this.velocity.x *= s,
                this.blocked.left = !0) : a > e.right && i.right && (t.x = e.right - this.halfWidth - this.radius,
                this.velocity.x *= s,
                this.blocked.right = !0),
                o < e.y && i.up ? (t.y = e.y - this.halfHeight + this.radius,
                this.velocity.y *= n,
                this.blocked.up = !0) : h > e.bottom && i.down && (t.y = e.bottom - this.halfHeight - this.radius,
                this.velocity.y *= n,
                this.blocked.down = !0)
            } else
                t.x < e.x && i.left ? (t.x = e.x,
                this.velocity.x *= s,
                this.blocked.left = !0) : this.right > e.right && i.right && (t.x = e.right - this.width,
                this.velocity.x *= s,
                this.blocked.right = !0),
                t.y < e.y && i.up ? (t.y = e.y,
                this.velocity.y *= n,
                this.blocked.up = !0) : this.bottom > e.bottom && i.down && (t.y = e.bottom - this.height,
                this.velocity.y *= n,
                this.blocked.down = !0);
            return this.blocked.up || this.blocked.down || this.blocked.left || this.blocked.right
        },
        moveFrom: function(t, e, i) {
            return void 0 === e && (e = this.speed),
            0 !== e && (void 0 === i ? (s = this.angle,
            i = this.game.math.radToDeg(s)) : s = this.game.math.degToRad(i),
            this.moveTimer = 0,
            this.moveDuration = t,
            0 === i || 180 === i ? this.velocity.set(Math.cos(s) * e, 0) : 90 === i || 270 === i ? this.velocity.set(0, Math.sin(s) * e) : this.velocity.set(Math.cos(s) * e, Math.sin(s) * e),
            this.isMoving = !0);
            var s
        },
        moveTo: function(t, e, i) {
            var s, n = e / (t / 1e3);
            return 0 !== n && (void 0 === i ? (s = this.angle,
            i = this.game.math.radToDeg(s)) : s = this.game.math.degToRad(i),
            e = Math.abs(e),
            this.moveDuration = 0,
            this.moveDistance = e,
            null === this.moveTarget && (this.moveTarget = new H.Line,
            this.moveEnd = new H.Point),
            this.moveTarget.fromAngle(this.x, this.y, s, e),
            this.moveEnd.set(this.moveTarget.end.x, this.moveTarget.end.y),
            this.moveTarget.setTo(this.x, this.y, this.x, this.y),
            0 === i || 180 === i ? this.velocity.set(Math.cos(s) * n, 0) : 90 === i || 270 === i ? this.velocity.set(0, Math.sin(s) * n) : this.velocity.set(Math.cos(s) * n, Math.sin(s) * n),
            this.isMoving = !0)
        },
        setSize: function(t, e, i, s) {
            void 0 === i && (i = this.offset.x),
            void 0 === s && (s = this.offset.y),
            this.sourceWidth = t,
            this.sourceHeight = e,
            this.width = this.sourceWidth * this._sx,
            this.height = this.sourceHeight * this._sy,
            this.halfWidth = Math.floor(this.width / 2),
            this.halfHeight = Math.floor(this.height / 2),
            this.offset.setTo(i, s),
            this.center.setTo(this.position.x + this.halfWidth, this.position.y + this.halfHeight),
            this.isCircle = !1,
            this.radius = 0
        },
        setCircle: function(t, e, i) {
            void 0 === e && (e = this.offset.x),
            void 0 === i && (i = this.offset.y),
            0 < t ? (this.isCircle = !0,
            this.radius = t,
            this.sourceWidth = 2 * t,
            this.sourceHeight = 2 * t,
            this.width = this.sourceWidth * this._sx,
            this.height = this.sourceHeight * this._sy,
            this.halfWidth = Math.floor(this.width / 2),
            this.halfHeight = Math.floor(this.height / 2),
            this.offset.setTo(e, i),
            this.center.setTo(this.position.x + this.halfWidth, this.position.y + this.halfHeight)) : this.isCircle = !1
        },
        reset: function(t, e) {
            this.velocity.set(0),
            this.acceleration.set(0),
            this.speed = 0,
            this.angularVelocity = 0,
            this.angularAcceleration = 0,
            this.position.x = t - this.sprite.anchor.x * this.sprite.width + this.sprite.scale.x * this.offset.x,
            this.position.x -= this.sprite.scale.x < 0 ? this.width : 0,
            this.position.y = e - this.sprite.anchor.y * this.sprite.height + this.sprite.scale.y * this.offset.y,
            this.position.y -= this.sprite.scale.y < 0 ? this.height : 0,
            this.prev.x = this.position.x,
            this.prev.y = this.position.y,
            this.rotation = this.sprite.angle,
            this.preRotation = this.rotation,
            this._sx = this.sprite.scale.x,
            this._sy = this.sprite.scale.y,
            this.center.setTo(this.position.x + this.halfWidth, this.position.y + this.halfHeight)
        },
        getBounds: function(t) {
            return this.isCircle ? (t.x = this.center.x - this.radius,
            t.y = this.center.y - this.radius,
            t.right = this.center.x + this.radius,
            t.bottom = this.center.y + this.radius) : (t.x = this.x,
            t.y = this.y,
            t.right = this.right,
            t.bottom = this.bottom),
            t
        },
        hitTest: function(t, e) {
            return this.isCircle ? H.Circle.contains(this, t, e) : H.Rectangle.contains(this, t, e)
        },
        onFloor: function() {
            return this.blocked.down
        },
        onCeiling: function() {
            return this.blocked.up
        },
        onWall: function() {
            return this.blocked.left || this.blocked.right
        },
        deltaAbsX: function() {
            return 0 < this.deltaX() ? this.deltaX() : -this.deltaX()
        },
        deltaAbsY: function() {
            return 0 < this.deltaY() ? this.deltaY() : -this.deltaY()
        },
        deltaX: function() {
            return this.position.x - this.prev.x
        },
        deltaY: function() {
            return this.position.y - this.prev.y
        },
        deltaZ: function() {
            return this.rotation - this.preRotation
        },
        destroy: function() {
            this.sprite.parent && this.sprite.parent instanceof H.Group && this.sprite.parent.removeFromHash(this.sprite),
            this.sprite.body = null,
            this.sprite = null
        }
    },
    Object.defineProperty(H.Physics.Arcade.Body.prototype, "left", {
        get: function() {
            return this.position.x
        }
    }),
    Object.defineProperty(H.Physics.Arcade.Body.prototype, "right", {
        get: function() {
            return this.position.x + this.width
        }
    }),
    Object.defineProperty(H.Physics.Arcade.Body.prototype, "top", {
        get: function() {
            return this.position.y
        }
    }),
    Object.defineProperty(H.Physics.Arcade.Body.prototype, "bottom", {
        get: function() {
            return this.position.y + this.height
        }
    }),
    Object.defineProperty(H.Physics.Arcade.Body.prototype, "x", {
        get: function() {
            return this.position.x
        },
        set: function(t) {
            this.position.x = t
        }
    }),
    Object.defineProperty(H.Physics.Arcade.Body.prototype, "y", {
        get: function() {
            return this.position.y
        },
        set: function(t) {
            this.position.y = t
        }
    }),
    H.Physics.Arcade.Body.render = function(t, e, i, s) {
        void 0 === s && (s = !0),
        i = i || "rgba(0,255,0,0.4)",
        t.fillStyle = i,
        t.strokeStyle = i,
        e.isCircle ? (t.beginPath(),
        t.arc(e.center.x - e.game.camera.x, e.center.y - e.game.camera.y, e.radius, 0, 2 * Math.PI),
        s ? t.fill() : t.stroke()) : s ? t.fillRect(e.position.x - e.game.camera.x, e.position.y - e.game.camera.y, e.width, e.height) : t.strokeRect(e.position.x - e.game.camera.x, e.position.y - e.game.camera.y, e.width, e.height)
    }
    ,
    H.Physics.Arcade.Body.renderBodyInfo = function(t, e) {
        t.line("x: " + e.x.toFixed(2), "y: " + e.y.toFixed(2), "width: " + e.width, "height: " + e.height),
        t.line("velocity x: " + e.velocity.x.toFixed(2), "y: " + e.velocity.y.toFixed(2), "deltaX: " + e._dx.toFixed(2), "deltaY: " + e._dy.toFixed(2)),
        t.line("acceleration x: " + e.acceleration.x.toFixed(2), "y: " + e.acceleration.y.toFixed(2), "speed: " + e.speed.toFixed(2), "angle: " + e.angle.toFixed(2)),
        t.line("gravity x: " + e.gravity.x, "y: " + e.gravity.y, "bounce x: " + e.bounce.x.toFixed(2), "y: " + e.bounce.y.toFixed(2)),
        t.line("touching left: " + e.touching.left, "right: " + e.touching.right, "up: " + e.touching.up, "down: " + e.touching.down),
        t.line("blocked left: " + e.blocked.left, "right: " + e.blocked.right, "up: " + e.blocked.up, "down: " + e.blocked.down)
    }
    ,
    H.Physics.Arcade.Body.prototype.constructor = H.Physics.Arcade.Body,
    H.Physics.Arcade.TilemapCollision = function() {}
    ,
    H.Physics.Arcade.TilemapCollision.prototype = {
        TILE_BIAS: 16,
        collideSpriteVsTilemapLayer: function(t, e, i, s, n, r) {
            if (t.body) {
                var o = e.getTiles(t.body.position.x - t.body.tilePadding.x, t.body.position.y - t.body.tilePadding.y, t.body.width + t.body.tilePadding.x, t.body.height + t.body.tilePadding.y, !1, !1);
                if (0 !== o.length)
                    for (var a = 0; a < o.length; a++)
                        s ? s.call(n, t, o[a]) && this.separateTile(a, t.body, o[a], e, r) && (this._total++,
                        i && i.call(n, t, o[a])) : this.separateTile(a, t.body, o[a], e, r) && (this._total++,
                        i && i.call(n, t, o[a]))
            }
        },
        collideGroupVsTilemapLayer: function(t, e, i, s, n, r) {
            if (0 !== t.length)
                for (var o = 0; o < t.children.length; o++)
                    t.children[o].exists && this.collideSpriteVsTilemapLayer(t.children[o], e, i, s, n, r)
        },
        separateTile: function(t, e, i, s, n) {
            if (!e.enable)
                return !1;
            var r = s.fixedToCamera ? 0 : s.position.x
              , o = s.fixedToCamera ? 0 : s.position.y;
            if (!i.intersects(e.position.x - r, e.position.y - o, e.right - r, e.bottom - o))
                return !1;
            if (n)
                return !0;
            if (i.collisionCallback && !i.collisionCallback.call(i.collisionCallbackContext, e.sprite, i))
                return !1;
            if (void 0 !== i.layer.callbacks && i.layer.callbacks[i.index] && !i.layer.callbacks[i.index].callback.call(i.layer.callbacks[i.index].callbackContext, e.sprite, i))
                return !1;
            if (!(i.faceLeft || i.faceRight || i.faceTop || i.faceBottom))
                return !1;
            var a = 0
              , h = 0
              , l = 0
              , c = 1;
            if (e.deltaAbsX() > e.deltaAbsY() ? l = -1 : e.deltaAbsX() < e.deltaAbsY() && (c = -1),
            0 !== e.deltaX() && 0 !== e.deltaY() && (i.faceLeft || i.faceRight) && (i.faceTop || i.faceBottom) && (l = Math.min(Math.abs(e.position.x - r - i.right), Math.abs(e.right - r - i.left)),
            c = Math.min(Math.abs(e.position.y - o - i.bottom), Math.abs(e.bottom - o - i.top))),
            l < c) {
                if ((i.faceLeft || i.faceRight) && 0 !== (a = this.tileCheckX(e, i, s)) && !i.intersects(e.position.x - r, e.position.y - o, e.right - r, e.bottom - o))
                    return !0;
                (i.faceTop || i.faceBottom) && (h = this.tileCheckY(e, i, s))
            } else {
                if ((i.faceTop || i.faceBottom) && 0 !== (h = this.tileCheckY(e, i, s)) && !i.intersects(e.position.x - r, e.position.y - o, e.right - r, e.bottom - o))
                    return !0;
                (i.faceLeft || i.faceRight) && (a = this.tileCheckX(e, i, s))
            }
            return 0 !== a || 0 !== h
        },
        tileCheckX: function(t, e, i) {
            var s = 0
              , n = i.fixedToCamera ? 0 : i.position.x;
            return t.deltaX() < 0 && !t.blocked.left && e.collideRight && t.checkCollision.left ? e.faceRight && t.x - n < e.right && (s = t.x - n - e.right) < -this.TILE_BIAS && (s = 0) : 0 < t.deltaX() && !t.blocked.right && e.collideLeft && t.checkCollision.right && e.faceLeft && t.right - n > e.left && (s = t.right - n - e.left) > this.TILE_BIAS && (s = 0),
            0 !== s && (t.customSeparateX ? t.overlapX = s : this.processTileSeparationX(t, s)),
            s
        },
        tileCheckY: function(t, e, i) {
            var s = 0
              , n = i.fixedToCamera ? 0 : i.position.y;
            return t.deltaY() < 0 && !t.blocked.up && e.collideDown && t.checkCollision.up ? e.faceBottom && t.y - n < e.bottom && (s = t.y - n - e.bottom) < -this.TILE_BIAS && (s = 0) : 0 < t.deltaY() && !t.blocked.down && e.collideUp && t.checkCollision.down && e.faceTop && t.bottom - n > e.top && (s = t.bottom - n - e.top) > this.TILE_BIAS && (s = 0),
            0 !== s && (t.customSeparateY ? t.overlapY = s : this.processTileSeparationY(t, s)),
            s
        },
        processTileSeparationX: function(t, e) {
            e < 0 ? t.blocked.left = !0 : 0 < e && (t.blocked.right = !0),
            t.position.x -= e,
            0 === t.bounce.x ? t.velocity.x = 0 : t.velocity.x = -t.velocity.x * t.bounce.x
        },
        processTileSeparationY: function(t, e) {
            e < 0 ? t.blocked.up = !0 : 0 < e && (t.blocked.down = !0),
            t.position.y -= e,
            0 === t.bounce.y ? t.velocity.y = 0 : t.velocity.y = -t.velocity.y * t.bounce.y
        }
    },
    H.Utils.mixinPrototype(H.Physics.Arcade.prototype, H.Physics.Arcade.TilemapCollision.prototype),
    p2.Body.prototype.parent = null,
    p2.Spring.prototype.parent = null,
    H.Physics.P2 = function(t, e) {
        this.game = t,
        void 0 === e ? e = {
            gravity: [0, 0],
            broadphase: new p2.SAPBroadphase
        } : (e.hasOwnProperty("gravity") || (e.gravity = [0, 0]),
        e.hasOwnProperty("broadphase") || (e.broadphase = new p2.SAPBroadphase)),
        this.config = e,
        this.world = new p2.World(this.config),
        this.frameRate = 1 / 60,
        this.useElapsedTime = !1,
        this.paused = !1,
        this.materials = [],
        this.gravity = new H.Physics.P2.InversePointProxy(this,this.world.gravity),
        this.walls = {
            left: null,
            right: null,
            top: null,
            bottom: null
        },
        this.onBodyAdded = new H.Signal,
        this.onBodyRemoved = new H.Signal,
        this.onSpringAdded = new H.Signal,
        this.onSpringRemoved = new H.Signal,
        this.onConstraintAdded = new H.Signal,
        this.onConstraintRemoved = new H.Signal,
        this.onContactMaterialAdded = new H.Signal,
        this.onContactMaterialRemoved = new H.Signal,
        this.postBroadphaseCallback = null,
        this.callbackContext = null,
        this.onBeginContact = new H.Signal,
        this.onEndContact = new H.Signal,
        e.hasOwnProperty("mpx") && e.hasOwnProperty("pxm") && e.hasOwnProperty("mpxi") && e.hasOwnProperty("pxmi") && (this.mpx = e.mpx,
        this.mpxi = e.mpxi,
        this.pxm = e.pxm,
        this.pxmi = e.pxmi),
        this.world.on("beginContact", this.beginContactHandler, this),
        this.world.on("endContact", this.endContactHandler, this),
        this.collisionGroups = [],
        this.nothingCollisionGroup = new H.Physics.P2.CollisionGroup(1),
        this.boundsCollisionGroup = new H.Physics.P2.CollisionGroup(2),
        this.everythingCollisionGroup = new H.Physics.P2.CollisionGroup(2147483648),
        this.boundsCollidesWith = [],
        this._toRemove = [],
        this._collisionGroupID = 2,
        this._boundsLeft = !0,
        this._boundsRight = !0,
        this._boundsTop = !0,
        this._boundsBottom = !0,
        this._boundsOwnGroup = !1,
        this.setBoundsToWorld(!0, !0, !0, !0, !1)
    }
    ,
    H.Physics.P2.prototype = {
        removeBodyNextStep: function(t) {
            this._toRemove.push(t)
        },
        preUpdate: function() {
            for (var t = this._toRemove.length; t--; )
                this.removeBody(this._toRemove[t]);
            this._toRemove.length = 0
        },
        enable: function(t, e, i) {
            void 0 === e && (e = !1),
            void 0 === i && (i = !0);
            var s = 1;
            if (Array.isArray(t))
                for (s = t.length; s--; )
                    t[s]instanceof H.Group ? this.enable(t[s].children, e, i) : (this.enableBody(t[s], e),
                    i && t[s].hasOwnProperty("children") && 0 < t[s].children.length && this.enable(t[s], e, !0));
            else
                t instanceof H.Group ? this.enable(t.children, e, i) : (this.enableBody(t, e),
                i && t.hasOwnProperty("children") && 0 < t.children.length && this.enable(t.children, e, !0))
        },
        enableBody: function(t, e) {
            t.hasOwnProperty("body") && null === t.body && (t.body = new H.Physics.P2.Body(this.game,t,t.x,t.y,1),
            t.body.debug = e,
            void 0 !== t.anchor && t.anchor.set(.5))
        },
        setImpactEvents: function(t) {
            t ? this.world.on("impact", this.impactHandler, this) : this.world.off("impact", this.impactHandler, this)
        },
        setPostBroadphaseCallback: function(t, e) {
            this.postBroadphaseCallback = t,
            this.callbackContext = e,
            null !== t ? this.world.on("postBroadphase", this.postBroadphaseHandler, this) : this.world.off("postBroadphase", this.postBroadphaseHandler, this)
        },
        postBroadphaseHandler: function(t) {
            if (this.postBroadphaseCallback && 0 !== t.pairs.length)
                for (var e = t.pairs.length - 2; 0 <= e; e -= 2)
                    t.pairs[e].parent && t.pairs[e + 1].parent && !this.postBroadphaseCallback.call(this.callbackContext, t.pairs[e].parent, t.pairs[e + 1].parent) && t.pairs.splice(e, 2)
        },
        impactHandler: function(t) {
            if (t.bodyA.parent && t.bodyB.parent) {
                var e = t.bodyA.parent
                  , i = t.bodyB.parent;
                e._bodyCallbacks[t.bodyB.id] && e._bodyCallbacks[t.bodyB.id].call(e._bodyCallbackContext[t.bodyB.id], e, i, t.shapeA, t.shapeB),
                i._bodyCallbacks[t.bodyA.id] && i._bodyCallbacks[t.bodyA.id].call(i._bodyCallbackContext[t.bodyA.id], i, e, t.shapeB, t.shapeA),
                e._groupCallbacks[t.shapeB.collisionGroup] && e._groupCallbacks[t.shapeB.collisionGroup].call(e._groupCallbackContext[t.shapeB.collisionGroup], e, i, t.shapeA, t.shapeB),
                i._groupCallbacks[t.shapeA.collisionGroup] && i._groupCallbacks[t.shapeA.collisionGroup].call(i._groupCallbackContext[t.shapeA.collisionGroup], i, e, t.shapeB, t.shapeA)
            }
        },
        beginContactHandler: function(t) {
            t.bodyA && t.bodyB && (this.onBeginContact.dispatch(t.bodyA, t.bodyB, t.shapeA, t.shapeB, t.contactEquations),
            t.bodyA.parent && t.bodyA.parent.onBeginContact.dispatch(t.bodyB.parent, t.bodyB, t.shapeA, t.shapeB, t.contactEquations),
            t.bodyB.parent && t.bodyB.parent.onBeginContact.dispatch(t.bodyA.parent, t.bodyA, t.shapeB, t.shapeA, t.contactEquations))
        },
        endContactHandler: function(t) {
            t.bodyA && t.bodyB && (this.onEndContact.dispatch(t.bodyA, t.bodyB, t.shapeA, t.shapeB),
            t.bodyA.parent && t.bodyA.parent.onEndContact.dispatch(t.bodyB.parent, t.bodyB, t.shapeA, t.shapeB),
            t.bodyB.parent && t.bodyB.parent.onEndContact.dispatch(t.bodyA.parent, t.bodyA, t.shapeB, t.shapeA))
        },
        setBoundsToWorld: function(t, e, i, s, n) {
            this.setBounds(this.game.world.bounds.x, this.game.world.bounds.y, this.game.world.bounds.width, this.game.world.bounds.height, t, e, i, s, n)
        },
        setWorldMaterial: function(t, e, i, s, n) {
            void 0 === e && (e = !0),
            void 0 === i && (i = !0),
            void 0 === s && (s = !0),
            void 0 === n && (n = !0),
            e && this.walls.left && (this.walls.left.shapes[0].material = t),
            i && this.walls.right && (this.walls.right.shapes[0].material = t),
            s && this.walls.top && (this.walls.top.shapes[0].material = t),
            n && this.walls.bottom && (this.walls.bottom.shapes[0].material = t)
        },
        updateBoundsCollisionGroup: function(t) {
            void 0 === t && (t = !0);
            var e = t ? this.boundsCollisionGroup.mask : this.everythingCollisionGroup.mask;
            this.walls.left && (this.walls.left.shapes[0].collisionGroup = e),
            this.walls.right && (this.walls.right.shapes[0].collisionGroup = e),
            this.walls.top && (this.walls.top.shapes[0].collisionGroup = e),
            this.walls.bottom && (this.walls.bottom.shapes[0].collisionGroup = e),
            this._boundsOwnGroup = t
        },
        setBounds: function(t, e, i, s, n, r, o, a, h) {
            void 0 === n && (n = this._boundsLeft),
            void 0 === r && (r = this._boundsRight),
            void 0 === o && (o = this._boundsTop),
            void 0 === a && (a = this._boundsBottom),
            void 0 === h && (h = this._boundsOwnGroup),
            this.setupWall(n, "left", t, e, 1.5707963267948966, h),
            this.setupWall(r, "right", t + i, e, -1.5707963267948966, h),
            this.setupWall(o, "top", t, e, -3.141592653589793, h),
            this.setupWall(a, "bottom", t, e + s, 0, h),
            this._boundsLeft = n,
            this._boundsRight = r,
            this._boundsTop = o,
            this._boundsBottom = a,
            this._boundsOwnGroup = h
        },
        setupWall: function(t, e, i, s, n, r) {
            t ? (this.walls[e] ? this.walls[e].position = [this.pxmi(i), this.pxmi(s)] : (this.walls[e] = new p2.Body({
                mass: 0,
                position: [this.pxmi(i), this.pxmi(s)],
                angle: n
            }),
            this.walls[e].addShape(new p2.Plane),
            this.world.addBody(this.walls[e])),
            r && (this.walls[e].shapes[0].collisionGroup = this.boundsCollisionGroup.mask)) : this.walls[e] && (this.world.removeBody(this.walls[e]),
            this.walls[e] = null)
        },
        pause: function() {
            this.paused = !0
        },
        resume: function() {
            this.paused = !1
        },
        update: function() {
            this.paused || (this.useElapsedTime ? this.world.step(this.game.time.physicsElapsed) : this.world.step(this.frameRate))
        },
        reset: function() {
            this.world.on("beginContact", this.beginContactHandler, this),
            this.world.on("endContact", this.endContactHandler, this),
            this.nothingCollisionGroup = new H.Physics.P2.CollisionGroup(1),
            this.boundsCollisionGroup = new H.Physics.P2.CollisionGroup(2),
            this.everythingCollisionGroup = new H.Physics.P2.CollisionGroup(2147483648),
            this._collisionGroupID = 2,
            this.setBoundsToWorld(!0, !0, !0, !0, !1)
        },
        clear: function() {
            this.world.time = 0,
            this.world.fixedStepTime = 0,
            this.world.solver && this.world.solver.equations.length && this.world.solver.removeAllEquations();
            for (var t = this.world.constraints, e = t.length - 1; 0 <= e; e--)
                this.world.removeConstraint(t[e]);
            var i = this.world.bodies;
            for (e = i.length - 1; 0 <= e; e--)
                this.world.removeBody(i[e]);
            var s = this.world.springs;
            for (e = s.length - 1; 0 <= e; e--)
                this.world.removeSpring(s[e]);
            var n = this.world.contactMaterials;
            for (e = n.length - 1; 0 <= e; e--)
                this.world.removeContactMaterial(n[e]);
            this.world.off("beginContact", this.beginContactHandler, this),
            this.world.off("endContact", this.endContactHandler, this),
            this.postBroadphaseCallback = null,
            this.callbackContext = null,
            this.impactCallback = null,
            this.collisionGroups = [],
            this._toRemove = [],
            this.boundsCollidesWith = [],
            this.walls = {
                left: null,
                right: null,
                top: null,
                bottom: null
            }
        },
        destroy: function() {
            this.clear(),
            this.game = null
        },
        addBody: function(t) {
            return !t.data.world && (this.world.addBody(t.data),
            this.onBodyAdded.dispatch(t),
            !0)
        },
        removeBody: function(t) {
            return t.data.world === this.world && (this.world.removeBody(t.data),
            this.onBodyRemoved.dispatch(t)),
            t
        },
        addSpring: function(t) {
            return t instanceof H.Physics.P2.Spring || t instanceof H.Physics.P2.RotationalSpring ? this.world.addSpring(t.data) : this.world.addSpring(t),
            this.onSpringAdded.dispatch(t),
            t
        },
        removeSpring: function(t) {
            return t instanceof H.Physics.P2.Spring || t instanceof H.Physics.P2.RotationalSpring ? this.world.removeSpring(t.data) : this.world.removeSpring(t),
            this.onSpringRemoved.dispatch(t),
            t
        },
        createDistanceConstraint: function(t, e, i, s, n, r) {
            if (t = this.getBody(t),
            e = this.getBody(e),
            t && e)
                return this.addConstraint(new H.Physics.P2.DistanceConstraint(this,t,e,i,s,n,r))
        },
        createGearConstraint: function(t, e, i, s) {
            if (t = this.getBody(t),
            e = this.getBody(e),
            t && e)
                return this.addConstraint(new H.Physics.P2.GearConstraint(this,t,e,i,s))
        },
        createRevoluteConstraint: function(t, e, i, s, n, r) {
            if (t = this.getBody(t),
            i = this.getBody(i),
            t && i)
                return this.addConstraint(new H.Physics.P2.RevoluteConstraint(this,t,e,i,s,n,r))
        },
        createLockConstraint: function(t, e, i, s, n) {
            if (t = this.getBody(t),
            e = this.getBody(e),
            t && e)
                return this.addConstraint(new H.Physics.P2.LockConstraint(this,t,e,i,s,n))
        },
        createPrismaticConstraint: function(t, e, i, s, n, r, o) {
            if (t = this.getBody(t),
            e = this.getBody(e),
            t && e)
                return this.addConstraint(new H.Physics.P2.PrismaticConstraint(this,t,e,i,s,n,r,o))
        },
        addConstraint: function(t) {
            return this.world.addConstraint(t),
            this.onConstraintAdded.dispatch(t),
            t
        },
        removeConstraint: function(t) {
            return this.world.removeConstraint(t),
            this.onConstraintRemoved.dispatch(t),
            t
        },
        addContactMaterial: function(t) {
            return this.world.addContactMaterial(t),
            this.onContactMaterialAdded.dispatch(t),
            t
        },
        removeContactMaterial: function(t) {
            return this.world.removeContactMaterial(t),
            this.onContactMaterialRemoved.dispatch(t),
            t
        },
        getContactMaterial: function(t, e) {
            return this.world.getContactMaterial(t, e)
        },
        setMaterial: function(t, e) {
            for (var i = e.length; i--; )
                e[i].setMaterial(t)
        },
        createMaterial: function(t, e) {
            t = t || "";
            var i = new H.Physics.P2.Material(t);
            return this.materials.push(i),
            void 0 !== e && e.setMaterial(i),
            i
        },
        createContactMaterial: function(t, e, i) {
            void 0 === t && (t = this.createMaterial()),
            void 0 === e && (e = this.createMaterial());
            var s = new H.Physics.P2.ContactMaterial(t,e,i);
            return this.addContactMaterial(s)
        },
        getBodies: function() {
            for (var t = [], e = this.world.bodies.length; e--; )
                t.push(this.world.bodies[e].parent);
            return t
        },
        getBody: function(t) {
            return t instanceof p2.Body ? t : t instanceof H.Physics.P2.Body ? t.data : t.body && t.body.type === H.Physics.P2JS ? t.body.data : null
        },
        getSprings: function() {
            for (var t = [], e = this.world.springs.length; e--; )
                t.push(this.world.springs[e].parent);
            return t
        },
        getConstraints: function() {
            for (var t = [], e = this.world.constraints.length; e--; )
                t.push(this.world.constraints[e]);
            return t
        },
        hitTest: function(t, e, i, s) {
            void 0 === e && (e = this.world.bodies),
            void 0 === i && (i = 5),
            void 0 === s && (s = !1);
            for (var n = [this.pxmi(t.x), this.pxmi(t.y)], r = [], o = e.length; o--; )
                e[o]instanceof H.Physics.P2.Body && (!s || e[o].data.type !== p2.Body.STATIC) ? r.push(e[o].data) : e[o]instanceof p2.Body && e[o].parent && (!s || e[o].type !== p2.Body.STATIC) ? r.push(e[o]) : e[o]instanceof H.Sprite && e[o].hasOwnProperty("body") && (!s || e[o].body.data.type !== p2.Body.STATIC) && r.push(e[o].body.data);
            return this.world.hitTest(n, r, i)
        },
        toJSON: function() {
            return this.world.toJSON()
        },
        createCollisionGroup: function(t) {
            var e = Math.pow(2, this._collisionGroupID);
            this.walls.left && (this.walls.left.shapes[0].collisionMask = this.walls.left.shapes[0].collisionMask | e),
            this.walls.right && (this.walls.right.shapes[0].collisionMask = this.walls.right.shapes[0].collisionMask | e),
            this.walls.top && (this.walls.top.shapes[0].collisionMask = this.walls.top.shapes[0].collisionMask | e),
            this.walls.bottom && (this.walls.bottom.shapes[0].collisionMask = this.walls.bottom.shapes[0].collisionMask | e),
            this._collisionGroupID++;
            var i = new H.Physics.P2.CollisionGroup(e);
            return this.collisionGroups.push(i),
            t && this.setCollisionGroup(t, i),
            i
        },
        setCollisionGroup: function(t, e) {
            if (t instanceof H.Group)
                for (var i = 0; i < t.total; i++)
                    t.children[i].body && t.children[i].body.type === H.Physics.P2JS && t.children[i].body.setCollisionGroup(e);
            else
                t.body.setCollisionGroup(e)
        },
        createSpring: function(t, e, i, s, n, r, o, a, h) {
            if (t = this.getBody(t),
            e = this.getBody(e),
            t && e)
                return this.addSpring(new H.Physics.P2.Spring(this,t,e,i,s,n,r,o,a,h))
        },
        createRotationalSpring: function(t, e, i, s, n) {
            if (t = this.getBody(t),
            e = this.getBody(e),
            t && e)
                return this.addSpring(new H.Physics.P2.RotationalSpring(this,t,e,i,s,n))
        },
        createBody: function(t, e, i, s, n, r) {
            void 0 === s && (s = !1);
            var o = new H.Physics.P2.Body(this.game,null,t,e,i);
            return !(r && !o.addPolygon(n, r)) && (s && this.world.addBody(o.data),
            o)
        },
        createParticle: function(t, e, i, s, n, r) {
            void 0 === s && (s = !1);
            var o = new H.Physics.P2.Body(this.game,null,t,e,i);
            return !(r && !o.addPolygon(n, r)) && (s && this.world.addBody(o.data),
            o)
        },
        convertCollisionObjects: function(t, e, i) {
            void 0 === i && (i = !0);
            for (var s = [], n = 0, r = t.collision[e].length; n < r; n++) {
                var o = t.collision[e][n]
                  , a = this.createBody(o.x, o.y, 0, i, {}, o.polyline);
                a && s.push(a)
            }
            return s
        },
        clearTilemapLayerBodies: function(t, e) {
            e = t.getLayer(e);
            for (var i = t.layers[e].bodies.length; i--; )
                t.layers[e].bodies[i].destroy();
            t.layers[e].bodies.length = 0
        },
        convertTilemap: function(t, e, i, s) {
            e = t.getLayer(e),
            void 0 === i && (i = !0),
            void 0 === s && (s = !0),
            this.clearTilemapLayerBodies(t, e);
            for (var n = 0, r = 0, o = 0, a = 0, h = t.layers[e].height; a < h; a++)
                for (var l = n = 0, c = t.layers[e].width; l < c; l++) {
                    var d = t.layers[e].data[a][l];
                    if (d && -1 < d.index && d.collides)
                        if (s) {
                            var u = t.getTileRight(e, l, a);
                            if (0 === n && (r = d.x * d.width,
                            o = d.y * d.height,
                            n = d.width),
                            u && u.collides)
                                n += d.width;
                            else
                                (p = this.createBody(r, o, 0, !1)).addRectangle(n, d.height, n / 2, d.height / 2, 0),
                                i && this.addBody(p),
                                t.layers[e].bodies.push(p),
                                n = 0
                        } else {
                            var p;
                            (p = this.createBody(d.x * d.width, d.y * d.height, 0, !1)).addRectangle(d.width, d.height, d.width / 2, d.height / 2, 0),
                            i && this.addBody(p),
                            t.layers[e].bodies.push(p)
                        }
                }
            return t.layers[e].bodies
        },
        mpx: function(t) {
            return 20 * t
        },
        pxm: function(t) {
            return .05 * t
        },
        mpxi: function(t) {
            return -20 * t
        },
        pxmi: function(t) {
            return -.05 * t
        }
    },
    Object.defineProperty(H.Physics.P2.prototype, "friction", {
        get: function() {
            return this.world.defaultContactMaterial.friction
        },
        set: function(t) {
            this.world.defaultContactMaterial.friction = t
        }
    }),
    Object.defineProperty(H.Physics.P2.prototype, "restitution", {
        get: function() {
            return this.world.defaultContactMaterial.restitution
        },
        set: function(t) {
            this.world.defaultContactMaterial.restitution = t
        }
    }),
    Object.defineProperty(H.Physics.P2.prototype, "contactMaterial", {
        get: function() {
            return this.world.defaultContactMaterial
        },
        set: function(t) {
            this.world.defaultContactMaterial = t
        }
    }),
    Object.defineProperty(H.Physics.P2.prototype, "applySpringForces", {
        get: function() {
            return this.world.applySpringForces
        },
        set: function(t) {
            this.world.applySpringForces = t
        }
    }),
    Object.defineProperty(H.Physics.P2.prototype, "applyDamping", {
        get: function() {
            return this.world.applyDamping
        },
        set: function(t) {
            this.world.applyDamping = t
        }
    }),
    Object.defineProperty(H.Physics.P2.prototype, "applyGravity", {
        get: function() {
            return this.world.applyGravity
        },
        set: function(t) {
            this.world.applyGravity = t
        }
    }),
    Object.defineProperty(H.Physics.P2.prototype, "solveConstraints", {
        get: function() {
            return this.world.solveConstraints
        },
        set: function(t) {
            this.world.solveConstraints = t
        }
    }),
    Object.defineProperty(H.Physics.P2.prototype, "time", {
        get: function() {
            return this.world.time
        }
    }),
    Object.defineProperty(H.Physics.P2.prototype, "emitImpactEvent", {
        get: function() {
            return this.world.emitImpactEvent
        },
        set: function(t) {
            this.world.emitImpactEvent = t
        }
    }),
    Object.defineProperty(H.Physics.P2.prototype, "sleepMode", {
        get: function() {
            return this.world.sleepMode
        },
        set: function(t) {
            this.world.sleepMode = t
        }
    }),
    Object.defineProperty(H.Physics.P2.prototype, "total", {
        get: function() {
            return this.world.bodies.length
        }
    }),
    H.Physics.P2.FixtureList = function(t) {
        Array.isArray(t) || (t = [t]),
        this.rawList = t,
        this.init(),
        this.parse(this.rawList)
    }
    ,
    H.Physics.P2.FixtureList.prototype = {
        init: function() {
            this.namedFixtures = {},
            this.groupedFixtures = [],
            this.allFixtures = []
        },
        setCategory: function(e, t) {
            this.getFixtures(t).forEach(function(t) {
                t.collisionGroup = e
            })
        },
        setMask: function(e, t) {
            this.getFixtures(t).forEach(function(t) {
                t.collisionMask = e
            })
        },
        setSensor: function(e, t) {
            this.getFixtures(t).forEach(function(t) {
                t.sensor = e
            })
        },
        setMaterial: function(e, t) {
            this.getFixtures(t).forEach(function(t) {
                t.material = e
            })
        },
        getFixtures: function(t) {
            var e = [];
            if (t) {
                t instanceof Array || (t = [t]);
                var i = this;
                return t.forEach(function(t) {
                    i.namedFixtures[t] && e.push(i.namedFixtures[t])
                }),
                this.flatten(e)
            }
            return this.allFixtures
        },
        getFixtureByKey: function(t) {
            return this.namedFixtures[t]
        },
        getGroup: function(t) {
            return this.groupedFixtures[t]
        },
        parse: function() {
            var t, e, i, s;
            for (t in s = [],
            i = this.rawList)
                e = i[t],
                isNaN(t - 0) ? this.namedFixtures[t] = this.flatten(e) : (this.groupedFixtures[t] = this.groupedFixtures[t] || [],
                this.groupedFixtures[t] = this.groupedFixtures[t].concat(e)),
                s.push(this.allFixtures = this.flatten(this.groupedFixtures))
        },
        flatten: function(t) {
            var e, i;
            return e = [],
            i = arguments.callee,
            t.forEach(function(t) {
                return Array.prototype.push.apply(e, Array.isArray(t) ? i(t) : [t])
            }),
            e
        }
    },
    H.Physics.P2.PointProxy = function(t, e) {
        this.world = t,
        this.destination = e
    }
    ,
    H.Physics.P2.PointProxy.prototype.constructor = H.Physics.P2.PointProxy,
    Object.defineProperty(H.Physics.P2.PointProxy.prototype, "x", {
        get: function() {
            return this.world.mpx(this.destination[0])
        },
        set: function(t) {
            this.destination[0] = this.world.pxm(t)
        }
    }),
    Object.defineProperty(H.Physics.P2.PointProxy.prototype, "y", {
        get: function() {
            return this.world.mpx(this.destination[1])
        },
        set: function(t) {
            this.destination[1] = this.world.pxm(t)
        }
    }),
    Object.defineProperty(H.Physics.P2.PointProxy.prototype, "mx", {
        get: function() {
            return this.destination[0]
        },
        set: function(t) {
            this.destination[0] = t
        }
    }),
    Object.defineProperty(H.Physics.P2.PointProxy.prototype, "my", {
        get: function() {
            return this.destination[1]
        },
        set: function(t) {
            this.destination[1] = t
        }
    }),
    H.Physics.P2.InversePointProxy = function(t, e) {
        this.world = t,
        this.destination = e
    }
    ,
    H.Physics.P2.InversePointProxy.prototype.constructor = H.Physics.P2.InversePointProxy,
    Object.defineProperty(H.Physics.P2.InversePointProxy.prototype, "x", {
        get: function() {
            return this.world.mpxi(this.destination[0])
        },
        set: function(t) {
            this.destination[0] = this.world.pxmi(t)
        }
    }),
    Object.defineProperty(H.Physics.P2.InversePointProxy.prototype, "y", {
        get: function() {
            return this.world.mpxi(this.destination[1])
        },
        set: function(t) {
            this.destination[1] = this.world.pxmi(t)
        }
    }),
    Object.defineProperty(H.Physics.P2.InversePointProxy.prototype, "mx", {
        get: function() {
            return this.destination[0]
        },
        set: function(t) {
            this.destination[0] = -t
        }
    }),
    Object.defineProperty(H.Physics.P2.InversePointProxy.prototype, "my", {
        get: function() {
            return this.destination[1]
        },
        set: function(t) {
            this.destination[1] = -t
        }
    }),
    H.Physics.P2.Body = function(t, e, i, s, n) {
        e = e || null,
        i = i || 0,
        s = s || 0,
        void 0 === n && (n = 1),
        this.game = t,
        this.world = t.physics.p2,
        this.sprite = e,
        this.type = H.Physics.P2JS,
        this.offset = new H.Point,
        this.data = new p2.Body({
            position: [this.world.pxmi(i), this.world.pxmi(s)],
            mass: n
        }),
        (this.data.parent = this).velocity = new H.Physics.P2.InversePointProxy(this.world,this.data.velocity),
        this.force = new H.Physics.P2.InversePointProxy(this.world,this.data.force),
        this.gravity = new H.Point,
        this.onBeginContact = new H.Signal,
        this.onEndContact = new H.Signal,
        this.collidesWith = [],
        this.removeNextStep = !1,
        this.debugBody = null,
        this.dirty = !1,
        this._collideWorldBounds = !0,
        this._bodyCallbacks = {},
        this._bodyCallbackContext = {},
        this._groupCallbacks = {},
        this._groupCallbackContext = {},
        this._reset = !1,
        e && (this.setRectangleFromSprite(e),
        e.exists && this.game.physics.p2.addBody(this))
    }
    ,
    H.Physics.P2.Body.prototype = {
        createBodyCallback: function(t, e, i) {
            var s = -1;
            t.id ? s = t.id : t.body && (s = t.body.id),
            -1 < s && (null === e ? (delete this._bodyCallbacks[s],
            delete this._bodyCallbackContext[s]) : (this._bodyCallbacks[s] = e,
            this._bodyCallbackContext[s] = i))
        },
        createGroupCallback: function(t, e, i) {
            null === e ? (delete this._groupCallbacks[t.mask],
            delete this._groupCallbackContext[t.mask]) : (this._groupCallbacks[t.mask] = e,
            this._groupCallbackContext[t.mask] = i)
        },
        getCollisionMask: function() {
            var t = 0;
            this._collideWorldBounds && (t = this.game.physics.p2.boundsCollisionGroup.mask);
            for (var e = 0; e < this.collidesWith.length; e++)
                t |= this.collidesWith[e].mask;
            return t
        },
        updateCollisionMask: function(t) {
            var e = this.getCollisionMask();
            if (void 0 === t)
                for (var i = this.data.shapes.length - 1; 0 <= i; i--)
                    this.data.shapes[i].collisionMask = e;
            else
                t.collisionMask = e
        },
        setCollisionGroup: function(t, e) {
            var i = this.getCollisionMask();
            if (void 0 === e)
                for (var s = this.data.shapes.length - 1; 0 <= s; s--)
                    this.data.shapes[s].collisionGroup = t.mask,
                    this.data.shapes[s].collisionMask = i;
            else
                e.collisionGroup = t.mask,
                e.collisionMask = i
        },
        clearCollision: function(t, e, i) {
            if (void 0 === t && (t = !0),
            void 0 === e && (e = !0),
            void 0 === i)
                for (var s = this.data.shapes.length - 1; 0 <= s; s--)
                    t && (this.data.shapes[s].collisionGroup = null),
                    e && (this.data.shapes[s].collisionMask = null);
            else
                t && (i.collisionGroup = null),
                e && (i.collisionMask = null);
            t && (this.collidesWith.length = 0)
        },
        removeCollisionGroup: function(t, e, i) {
            var s;
            if (void 0 === e && (e = !0),
            Array.isArray(t))
                for (var n = 0; n < t.length; n++)
                    -1 < (s = this.collidesWith.indexOf(t[n])) && (this.collidesWith.splice(s, 1),
                    e && (delete this._groupCallbacks[t.mask],
                    delete this._groupCallbackContext[t.mask]));
            else
                -1 < (s = this.collidesWith.indexOf(t)) && (this.collidesWith.splice(s, 1),
                e && (delete this._groupCallbacks[t.mask],
                delete this._groupCallbackContext[t.mask]));
            var r = this.getCollisionMask();
            if (void 0 === i)
                for (n = this.data.shapes.length - 1; 0 <= n; n--)
                    this.data.shapes[n].collisionMask = r;
            else
                i.collisionMask = r
        },
        collides: function(t, e, i, s) {
            if (Array.isArray(t))
                for (var n = 0; n < t.length; n++)
                    -1 === this.collidesWith.indexOf(t[n]) && (this.collidesWith.push(t[n]),
                    e && this.createGroupCallback(t[n], e, i));
            else
                -1 === this.collidesWith.indexOf(t) && (this.collidesWith.push(t),
                e && this.createGroupCallback(t, e, i));
            var r = this.getCollisionMask();
            if (void 0 === s)
                for (n = this.data.shapes.length - 1; 0 <= n; n--)
                    this.data.shapes[n].collisionMask = r;
            else
                s.collisionMask = r
        },
        adjustCenterOfMass: function() {
            this.data.adjustCenterOfMass(),
            this.shapeChanged()
        },
        getVelocityAtPoint: function(t, e) {
            return this.data.getVelocityAtPoint(t, e)
        },
        applyDamping: function(t) {
            this.data.applyDamping(t)
        },
        applyImpulse: function(t, e, i) {
            this.data.applyImpulse(t, [this.world.pxmi(e), this.world.pxmi(i)])
        },
        applyImpulseLocal: function(t, e, i) {
            this.data.applyImpulseLocal(t, [this.world.pxmi(e), this.world.pxmi(i)])
        },
        applyForce: function(t, e, i) {
            this.data.applyForce(t, [this.world.pxmi(e), this.world.pxmi(i)])
        },
        setZeroForce: function() {
            this.data.setZeroForce()
        },
        setZeroRotation: function() {
            this.data.angularVelocity = 0
        },
        setZeroVelocity: function() {
            this.data.velocity[0] = 0,
            this.data.velocity[1] = 0
        },
        setZeroDamping: function() {
            this.data.damping = 0,
            this.data.angularDamping = 0
        },
        toLocalFrame: function(t, e) {
            return this.data.toLocalFrame(t, e)
        },
        toWorldFrame: function(t, e) {
            return this.data.toWorldFrame(t, e)
        },
        rotateLeft: function(t) {
            this.data.angularVelocity = this.world.pxm(-t)
        },
        rotateRight: function(t) {
            this.data.angularVelocity = this.world.pxm(t)
        },
        moveForward: function(t) {
            var e = this.world.pxmi(-t)
              , i = this.data.angle + Math.PI / 2;
            this.data.velocity[0] = e * Math.cos(i),
            this.data.velocity[1] = e * Math.sin(i)
        },
        moveBackward: function(t) {
            var e = this.world.pxmi(-t)
              , i = this.data.angle + Math.PI / 2;
            this.data.velocity[0] = -e * Math.cos(i),
            this.data.velocity[1] = -e * Math.sin(i)
        },
        thrust: function(t) {
            var e = this.world.pxmi(-t)
              , i = this.data.angle + Math.PI / 2;
            this.data.force[0] += e * Math.cos(i),
            this.data.force[1] += e * Math.sin(i)
        },
        thrustLeft: function(t) {
            var e = this.world.pxmi(-t)
              , i = this.data.angle;
            this.data.force[0] += e * Math.cos(i),
            this.data.force[1] += e * Math.sin(i)
        },
        thrustRight: function(t) {
            var e = this.world.pxmi(-t)
              , i = this.data.angle;
            this.data.force[0] -= e * Math.cos(i),
            this.data.force[1] -= e * Math.sin(i)
        },
        reverse: function(t) {
            var e = this.world.pxmi(-t)
              , i = this.data.angle + Math.PI / 2;
            this.data.force[0] -= e * Math.cos(i),
            this.data.force[1] -= e * Math.sin(i)
        },
        moveLeft: function(t) {
            this.data.velocity[0] = this.world.pxmi(-t)
        },
        moveRight: function(t) {
            this.data.velocity[0] = this.world.pxmi(t)
        },
        moveUp: function(t) {
            this.data.velocity[1] = this.world.pxmi(-t)
        },
        moveDown: function(t) {
            this.data.velocity[1] = this.world.pxmi(t)
        },
        preUpdate: function() {
            this.dirty = !0,
            this.removeNextStep && (this.removeFromWorld(),
            this.removeNextStep = !1)
        },
        postUpdate: function() {
            this.sprite.x = this.world.mpxi(this.data.position[0]) + this.offset.x,
            this.sprite.y = this.world.mpxi(this.data.position[1]) + this.offset.y,
            this.fixedRotation || (this.sprite.rotation = this.data.angle),
            this.debugBody && this.debugBody.updateSpriteTransform(),
            this.dirty = !1
        },
        reset: function(t, e, i, s) {
            void 0 === i && (i = !1),
            void 0 === s && (s = !1),
            this.setZeroForce(),
            this.setZeroVelocity(),
            this.setZeroRotation(),
            i && this.setZeroDamping(),
            s && (this.mass = 1),
            this.x = t,
            this.y = e
        },
        addToWorld: function() {
            if (this.game.physics.p2._toRemove)
                for (var t = 0; t < this.game.physics.p2._toRemove.length; t++)
                    this.game.physics.p2._toRemove[t] === this && this.game.physics.p2._toRemove.splice(t, 1);
            this.data.world !== this.game.physics.p2.world && this.game.physics.p2.addBody(this)
        },
        removeFromWorld: function() {
            this.data.world === this.game.physics.p2.world && this.game.physics.p2.removeBodyNextStep(this)
        },
        destroy: function() {
            this.removeFromWorld(),
            this.clearShapes(),
            this._bodyCallbacks = {},
            this._bodyCallbackContext = {},
            this._groupCallbacks = {},
            this._groupCallbackContext = {},
            this.debugBody && this.debugBody.destroy(!0, !0),
            this.debugBody = null,
            this.sprite && (this.sprite.body = null,
            this.sprite = null)
        },
        clearShapes: function() {
            for (var t = this.data.shapes.length; t--; )
                this.data.removeShape(this.data.shapes[t]);
            this.shapeChanged()
        },
        addShape: function(t, e, i, s) {
            return void 0 === e && (e = 0),
            void 0 === i && (i = 0),
            void 0 === s && (s = 0),
            this.data.addShape(t, [this.world.pxmi(e), this.world.pxmi(i)], s),
            this.shapeChanged(),
            t
        },
        addCircle: function(t, e, i, s) {
            var n = new p2.Circle({
                radius: this.world.pxm(t)
            });
            return this.addShape(n, e, i, s)
        },
        addRectangle: function(t, e, i, s, n) {
            var r = new p2.Box({
                width: this.world.pxm(t),
                height: this.world.pxm(e)
            });
            return this.addShape(r, i, s, n)
        },
        addPlane: function(t, e, i) {
            var s = new p2.Plane;
            return this.addShape(s, t, e, i)
        },
        addParticle: function(t, e, i) {
            var s = new p2.Particle;
            return this.addShape(s, t, e, i)
        },
        addLine: function(t, e, i, s) {
            var n = new p2.Line({
                length: this.world.pxm(t)
            });
            return this.addShape(n, e, i, s)
        },
        addCapsule: function(t, e, i, s, n) {
            var r = new p2.Capsule({
                length: this.world.pxm(t),
                radius: this.world.pxm(e)
            });
            return this.addShape(r, i, s, n)
        },
        addPolygon: function(t, e) {
            t = t || {},
            Array.isArray(e) || (e = Array.prototype.slice.call(arguments, 1));
            var i = [];
            if (1 === e.length && Array.isArray(e[0]))
                i = e[0].slice(0);
            else if (Array.isArray(e[0]))
                i = e.slice();
            else if ("number" == typeof e[0])
                for (var s = 0, n = e.length; s < n; s += 2)
                    i.push([e[s], e[s + 1]]);
            var r = i.length - 1;
            i[r][0] === i[0][0] && i[r][1] === i[0][1] && i.pop();
            for (var o = 0; o < i.length; o++)
                i[o][0] = this.world.pxmi(i[o][0]),
                i[o][1] = this.world.pxmi(i[o][1]);
            var a = this.data.fromPolygon(i, t);
            return this.shapeChanged(),
            a
        },
        removeShape: function(t) {
            var e = this.data.removeShape(t);
            return this.shapeChanged(),
            e
        },
        setCircle: function(t, e, i, s) {
            return this.clearShapes(),
            this.addCircle(t, e, i, s)
        },
        setRectangle: function(t, e, i, s, n) {
            return void 0 === t && (t = 16),
            void 0 === e && (e = 16),
            this.clearShapes(),
            this.addRectangle(t, e, i, s, n)
        },
        setRectangleFromSprite: function(t) {
            return void 0 === t && (t = this.sprite),
            this.clearShapes(),
            this.addRectangle(t.width, t.height, 0, 0, t.rotation)
        },
        setMaterial: function(t, e) {
            if (void 0 === e)
                for (var i = this.data.shapes.length - 1; 0 <= i; i--)
                    this.data.shapes[i].material = t;
            else
                e.material = t
        },
        shapeChanged: function() {
            this.debugBody && this.debugBody.draw()
        },
        addPhaserPolygon: function(t, e) {
            for (var i = this.game.cache.getPhysicsData(t, e), s = [], n = 0; n < i.length; n++) {
                var r = i[n]
                  , o = this.addFixture(r);
                s[r.filter.group] = s[r.filter.group] || [],
                s[r.filter.group] = s[r.filter.group].concat(o),
                r.fixtureKey && (s[r.fixtureKey] = o)
            }
            return this.data.aabbNeedsUpdate = !0,
            this.shapeChanged(),
            s
        },
        addFixture: function(t) {
            var e = [];
            if (t.circle) {
                (l = new p2.Circle({
                    radius: this.world.pxm(t.circle.radius)
                })).collisionGroup = t.filter.categoryBits,
                l.collisionMask = t.filter.maskBits,
                l.sensor = t.isSensor;
                var i = p2.vec2.create();
                i[0] = this.world.pxmi(t.circle.position[0] - this.sprite.width / 2),
                i[1] = this.world.pxmi(t.circle.position[1] - this.sprite.height / 2),
                this.data.addShape(l, i),
                e.push(l)
            } else
                for (var s = t.polygons, n = p2.vec2.create(), r = 0; r < s.length; r++) {
                    for (var o = s[r], a = [], h = 0; h < o.length; h += 2)
                        a.push([this.world.pxmi(o[h]), this.world.pxmi(o[h + 1])]);
                    for (var l = new p2.Convex({
                        vertices: a
                    }), c = 0; c !== l.vertices.length; c++) {
                        var d = l.vertices[c];
                        p2.vec2.sub(d, d, l.centerOfMass)
                    }
                    p2.vec2.scale(n, l.centerOfMass, 1),
                    n[0] -= this.world.pxmi(this.sprite.width / 2),
                    n[1] -= this.world.pxmi(this.sprite.height / 2),
                    l.updateTriangles(),
                    l.updateCenterOfMass(),
                    l.updateBoundingRadius(),
                    l.collisionGroup = t.filter.categoryBits,
                    l.collisionMask = t.filter.maskBits,
                    l.sensor = t.isSensor,
                    this.data.addShape(l, n),
                    e.push(l)
                }
            return e
        },
        loadPolygon: function(t, e) {
            if (null === t)
                var i = e;
            else
                i = this.game.cache.getPhysicsData(t, e);
            for (var s = p2.vec2.create(), n = 0; n < i.length; n++) {
                for (var r = [], o = 0; o < i[n].shape.length; o += 2)
                    r.push([this.world.pxmi(i[n].shape[o]), this.world.pxmi(i[n].shape[o + 1])]);
                for (var a = new p2.Convex({
                    vertices: r
                }), h = 0; h !== a.vertices.length; h++) {
                    var l = a.vertices[h];
                    p2.vec2.sub(l, l, a.centerOfMass)
                }
                p2.vec2.scale(s, a.centerOfMass, 1),
                s[0] -= this.world.pxmi(this.sprite.width / 2),
                s[1] -= this.world.pxmi(this.sprite.height / 2),
                a.updateTriangles(),
                a.updateCenterOfMass(),
                a.updateBoundingRadius(),
                this.data.addShape(a, s)
            }
            return this.data.aabbNeedsUpdate = !0,
            this.shapeChanged(),
            !0
        }
    },
    H.Physics.P2.Body.prototype.constructor = H.Physics.P2.Body,
    H.Physics.P2.Body.DYNAMIC = 1,
    H.Physics.P2.Body.STATIC = 2,
    H.Physics.P2.Body.KINEMATIC = 4,
    Object.defineProperty(H.Physics.P2.Body.prototype, "static", {
        get: function() {
            return this.data.type === H.Physics.P2.Body.STATIC
        },
        set: function(t) {
            t && this.data.type !== H.Physics.P2.Body.STATIC ? (this.data.type = H.Physics.P2.Body.STATIC,
            this.mass = 0) : t || this.data.type !== H.Physics.P2.Body.STATIC || (this.data.type = H.Physics.P2.Body.DYNAMIC,
            this.mass = 1)
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "dynamic", {
        get: function() {
            return this.data.type === H.Physics.P2.Body.DYNAMIC
        },
        set: function(t) {
            t && this.data.type !== H.Physics.P2.Body.DYNAMIC ? (this.data.type = H.Physics.P2.Body.DYNAMIC,
            this.mass = 1) : t || this.data.type !== H.Physics.P2.Body.DYNAMIC || (this.data.type = H.Physics.P2.Body.STATIC,
            this.mass = 0)
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "kinematic", {
        get: function() {
            return this.data.type === H.Physics.P2.Body.KINEMATIC
        },
        set: function(t) {
            t && this.data.type !== H.Physics.P2.Body.KINEMATIC ? (this.data.type = H.Physics.P2.Body.KINEMATIC,
            this.mass = 4) : t || this.data.type !== H.Physics.P2.Body.KINEMATIC || (this.data.type = H.Physics.P2.Body.STATIC,
            this.mass = 0)
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "allowSleep", {
        get: function() {
            return this.data.allowSleep
        },
        set: function(t) {
            t !== this.data.allowSleep && (this.data.allowSleep = t)
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "angle", {
        get: function() {
            return H.Math.wrapAngle(H.Math.radToDeg(this.data.angle))
        },
        set: function(t) {
            this.data.angle = H.Math.degToRad(H.Math.wrapAngle(t))
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "angularDamping", {
        get: function() {
            return this.data.angularDamping
        },
        set: function(t) {
            this.data.angularDamping = t
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "angularForce", {
        get: function() {
            return this.data.angularForce
        },
        set: function(t) {
            this.data.angularForce = t
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "angularVelocity", {
        get: function() {
            return this.data.angularVelocity
        },
        set: function(t) {
            this.data.angularVelocity = t
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "damping", {
        get: function() {
            return this.data.damping
        },
        set: function(t) {
            this.data.damping = t
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "fixedRotation", {
        get: function() {
            return this.data.fixedRotation
        },
        set: function(t) {
            t !== this.data.fixedRotation && (this.data.fixedRotation = t)
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "inertia", {
        get: function() {
            return this.data.inertia
        },
        set: function(t) {
            this.data.inertia = t
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "mass", {
        get: function() {
            return this.data.mass
        },
        set: function(t) {
            t !== this.data.mass && (this.data.mass = t,
            this.data.updateMassProperties())
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "motionState", {
        get: function() {
            return this.data.type
        },
        set: function(t) {
            t !== this.data.type && (this.data.type = t)
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "rotation", {
        get: function() {
            return this.data.angle
        },
        set: function(t) {
            this.data.angle = t
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "sleepSpeedLimit", {
        get: function() {
            return this.data.sleepSpeedLimit
        },
        set: function(t) {
            this.data.sleepSpeedLimit = t
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "x", {
        get: function() {
            return this.world.mpxi(this.data.position[0])
        },
        set: function(t) {
            this.data.position[0] = this.world.pxmi(t)
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "y", {
        get: function() {
            return this.world.mpxi(this.data.position[1])
        },
        set: function(t) {
            this.data.position[1] = this.world.pxmi(t)
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "id", {
        get: function() {
            return this.data.id
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "debug", {
        get: function() {
            return null !== this.debugBody
        },
        set: function(t) {
            t && !this.debugBody ? this.debugBody = new H.Physics.P2.BodyDebug(this.game,this.data) : !t && this.debugBody && (this.debugBody.destroy(),
            this.debugBody = null)
        }
    }),
    Object.defineProperty(H.Physics.P2.Body.prototype, "collideWorldBounds", {
        get: function() {
            return this._collideWorldBounds
        },
        set: function(t) {
            t && !this._collideWorldBounds ? (this._collideWorldBounds = !0,
            this.updateCollisionMask()) : !t && this._collideWorldBounds && (this._collideWorldBounds = !1,
            this.updateCollisionMask())
        }
    }),
    H.Physics.P2.BodyDebug = function(t, e, i) {
        H.Group.call(this, t);
        var s = {
            pixelsPerLengthUnit: t.physics.p2.mpx(1),
            debugPolygons: !1,
            lineWidth: 1,
            alpha: .5
        };
        this.settings = H.Utils.extend(s, i),
        this.ppu = this.settings.pixelsPerLengthUnit,
        this.ppu = -1 * this.ppu,
        this.body = e,
        this.canvas = new H.Graphics(t),
        this.canvas.alpha = this.settings.alpha,
        this.add(this.canvas),
        this.draw(),
        this.updateSpriteTransform()
    }
    ,
    H.Physics.P2.BodyDebug.prototype = Object.create(H.Group.prototype),
    H.Physics.P2.BodyDebug.prototype.constructor = H.Physics.P2.BodyDebug,
    H.Utils.extend(H.Physics.P2.BodyDebug.prototype, {
        updateSpriteTransform: function() {
            this.position.x = this.body.position[0] * this.ppu,
            this.position.y = this.body.position[1] * this.ppu,
            this.rotation = this.body.angle
        },
        draw: function() {
            var t, e, i, s, n, r, o, a, h, l, c, d, u, p, g;
            if (a = this.body,
            (l = this.canvas).clear(),
            i = parseInt(this.randomPastelHex(), 16),
            r = 16711680,
            o = this.lineWidth,
            a instanceof p2.Body && a.shapes.length) {
                var f = a.shapes.length;
                for (s = 0; s !== f; ) {
                    if (h = (e = a.shapes[s]).position || 0,
                    t = e.angle || 0,
                    e instanceof p2.Circle)
                        this.drawCircle(l, h[0] * this.ppu, h[1] * this.ppu, t, e.radius * this.ppu, i, o);
                    else if (e instanceof p2.Capsule)
                        this.drawCapsule(l, h[0] * this.ppu, h[1] * this.ppu, t, e.length * this.ppu, e.radius * this.ppu, r, i, o);
                    else if (e instanceof p2.Plane)
                        this.drawPlane(l, h[0] * this.ppu, -h[1] * this.ppu, i, r, 5 * o, 10 * o, 10 * o, 100 * this.ppu, t);
                    else if (e instanceof p2.Line)
                        this.drawLine(l, e.length * this.ppu, r, o);
                    else if (e instanceof p2.Box)
                        this.drawRectangle(l, h[0] * this.ppu, h[1] * this.ppu, t, e.width * this.ppu, e.height * this.ppu, r, i, o);
                    else if (e instanceof p2.Convex) {
                        for (d = [],
                        u = p2.vec2.create(),
                        n = p = 0,
                        g = e.vertices.length; 0 <= g ? p < g : g < p; n = 0 <= g ? ++p : --p)
                            c = e.vertices[n],
                            p2.vec2.rotate(u, c, t),
                            d.push([(u[0] + h[0]) * this.ppu, -(u[1] + h[1]) * this.ppu]);
                        this.drawConvex(l, d, e.triangles, r, i, o, this.settings.debugPolygons, [h[0] * this.ppu, -h[1] * this.ppu])
                    }
                    s++
                }
            }
        },
        drawRectangle: function(t, e, i, s, n, r, o, a, h) {
            void 0 === h && (h = 1),
            void 0 === o && (o = 0),
            t.lineStyle(h, o, 1),
            t.beginFill(a),
            t.drawRect(e - n / 2, i - r / 2, n, r)
        },
        drawCircle: function(t, e, i, s, n, r, o) {
            void 0 === o && (o = 1),
            void 0 === r && (r = 16777215),
            t.lineStyle(o, 0, 1),
            t.beginFill(r, 1),
            t.drawCircle(e, i, 2 * -n),
            t.endFill(),
            t.moveTo(e, i),
            t.lineTo(e + n * Math.cos(-s), i + n * Math.sin(-s))
        },
        drawLine: function(t, e, i, s) {
            void 0 === s && (s = 1),
            void 0 === i && (i = 0),
            t.lineStyle(5 * s, i, 1),
            t.moveTo(-e / 2, 0),
            t.lineTo(e / 2, 0)
        },
        drawConvex: function(t, e, i, s, n, r, o, a) {
            var h, l, c, d, u, p, g, f, m, y, v;
            if (void 0 === r && (r = 1),
            void 0 === s && (s = 0),
            o) {
                for (h = [16711680, 65280, 255],
                l = 0; l !== e.length + 1; )
                    d = e[l % e.length],
                    u = e[(l + 1) % e.length],
                    g = d[0],
                    y = d[1],
                    f = u[0],
                    v = u[1],
                    t.lineStyle(r, h[l % h.length], 1),
                    t.moveTo(g, -y),
                    t.lineTo(f, -v),
                    t.drawCircle(g, -y, 2 * r),
                    l++;
                return t.lineStyle(r, 0, 1),
                t.drawCircle(a[0], a[1], 2 * r)
            }
            for (t.lineStyle(r, s, 1),
            t.beginFill(n),
            l = 0; l !== e.length; )
                p = (c = e[l])[0],
                m = c[1],
                0 === l ? t.moveTo(p, -m) : t.lineTo(p, -m),
                l++;
            if (t.endFill(),
            2 < e.length)
                return t.moveTo(e[e.length - 1][0], -e[e.length - 1][1]),
                t.lineTo(e[0][0], -e[0][1])
        },
        drawPath: function(t, e, i, s, n) {
            var r, o, a, h, l, c, d, u, p, g, f;
            for (void 0 === n && (n = 1),
            void 0 === i && (i = 0),
            t.lineStyle(n, i, 1),
            "number" == typeof s && t.beginFill(s),
            a = o = null,
            r = 0; r < e.length; )
                g = (p = e[r])[0],
                f = p[1],
                g === o && f === a || (0 === r ? t.moveTo(g, f) : (h = o,
                l = a,
                c = g,
                d = f,
                u = e[(r + 1) % e.length][0],
                0 != (c - h) * (e[(r + 1) % e.length][1] - l) - (u - h) * (d - l) && t.lineTo(g, f)),
                o = g,
                a = f),
                r++;
            "number" == typeof s && t.endFill(),
            2 < e.length && "number" == typeof s && (t.moveTo(e[e.length - 1][0], e[e.length - 1][1]),
            t.lineTo(e[0][0], e[0][1]))
        },
        drawPlane: function(t, e, i, s, n, r, o, a, h, l) {
            var c, d;
            void 0 === r && (r = 1),
            void 0 === s && (s = 16777215),
            t.lineStyle(r, n, 11),
            t.beginFill(s),
            t.moveTo(e, -i),
            c = e + Math.cos(l) * this.game.width,
            d = i + Math.sin(l) * this.game.height,
            t.lineTo(c, -d),
            t.moveTo(e, -i),
            c = e + Math.cos(l) * -this.game.width,
            d = i + Math.sin(l) * -this.game.height,
            t.lineTo(c, -d)
        },
        drawCapsule: function(t, e, i, s, n, r, o, a, h) {
            void 0 === h && (h = 1),
            void 0 === o && (o = 0),
            t.lineStyle(h, o, 1);
            var l = Math.cos(s)
              , c = Math.sin(s);
            t.beginFill(a, 1),
            t.drawCircle(-n / 2 * l + e, -n / 2 * c + i, 2 * -r),
            t.drawCircle(n / 2 * l + e, n / 2 * c + i, 2 * -r),
            t.endFill(),
            t.lineStyle(h, o, 0),
            t.beginFill(a, 1),
            t.moveTo(-n / 2 * l + r * c + e, -n / 2 * c + r * l + i),
            t.lineTo(n / 2 * l + r * c + e, n / 2 * c + r * l + i),
            t.lineTo(n / 2 * l - r * c + e, n / 2 * c - r * l + i),
            t.lineTo(-n / 2 * l - r * c + e, -n / 2 * c - r * l + i),
            t.endFill(),
            t.lineStyle(h, o, 1),
            t.moveTo(-n / 2 * l + r * c + e, -n / 2 * c + r * l + i),
            t.lineTo(n / 2 * l + r * c + e, n / 2 * c + r * l + i),
            t.moveTo(-n / 2 * l - r * c + e, -n / 2 * c - r * l + i),
            t.lineTo(n / 2 * l - r * c + e, n / 2 * c - r * l + i)
        },
        randomPastelHex: function() {
            var t, e, i, s;
            return i = [255, 255, 255],
            s = Math.floor(256 * Math.random()),
            e = Math.floor(256 * Math.random()),
            t = Math.floor(256 * Math.random()),
            s = Math.floor((s + 3 * i[0]) / 4),
            e = Math.floor((e + 3 * i[1]) / 4),
            t = Math.floor((t + 3 * i[2]) / 4),
            this.rgbToHex(s, e, t)
        },
        rgbToHex: function(t, e, i) {
            return this.componentToHex(t) + this.componentToHex(e) + this.componentToHex(i)
        },
        componentToHex: function(t) {
            var e;
            return 2 === (e = t.toString(16)).length ? e : e + "0"
        }
    }),
    H.Physics.P2.Spring = function(t, e, i, s, n, r, o, a, h, l) {
        this.game = t.game,
        void 0 === s && (s = 1),
        void 0 === n && (n = 100),
        void 0 === r && (r = 1);
        var c = {
            restLength: s = (this.world = t).pxm(s),
            stiffness: n,
            damping: r
        };
        null != o && (c.worldAnchorA = [t.pxm(o[0]), t.pxm(o[1])]),
        null != a && (c.worldAnchorB = [t.pxm(a[0]), t.pxm(a[1])]),
        null != h && (c.localAnchorA = [t.pxm(h[0]), t.pxm(h[1])]),
        null != l && (c.localAnchorB = [t.pxm(l[0]), t.pxm(l[1])]),
        this.data = new p2.LinearSpring(e,i,c),
        this.data.parent = this
    }
    ,
    H.Physics.P2.Spring.prototype.constructor = H.Physics.P2.Spring,
    H.Physics.P2.RotationalSpring = function(t, e, i, s, n, r) {
        this.game = t.game,
        this.world = t,
        void 0 === s && (s = null),
        void 0 === n && (n = 100),
        void 0 === r && (r = 1),
        s && (s = t.pxm(s));
        var o = {
            restAngle: s,
            stiffness: n,
            damping: r
        };
        this.data = new p2.RotationalSpring(e,i,o),
        this.data.parent = this
    }
    ,
    H.Physics.P2.Spring.prototype.constructor = H.Physics.P2.Spring,
    H.Physics.P2.Material = function(t) {
        this.name = t,
        p2.Material.call(this)
    }
    ,
    H.Physics.P2.Material.prototype = Object.create(p2.Material.prototype),
    H.Physics.P2.Material.prototype.constructor = H.Physics.P2.Material,
    H.Physics.P2.ContactMaterial = function(t, e, i) {
        p2.ContactMaterial.call(this, t, e, i)
    }
    ,
    H.Physics.P2.ContactMaterial.prototype = Object.create(p2.ContactMaterial.prototype),
    H.Physics.P2.ContactMaterial.prototype.constructor = H.Physics.P2.ContactMaterial,
    H.Physics.P2.CollisionGroup = function(t) {
        this.mask = t
    }
    ,
    H.Physics.P2.DistanceConstraint = function(t, e, i, s, n, r, o) {
        void 0 === s && (s = 100),
        void 0 === n && (n = [0, 0]),
        void 0 === r && (r = [0, 0]),
        void 0 === o && (o = Number.MAX_VALUE),
        this.game = t.game;
        var a = {
            distance: s = (this.world = t).pxm(s),
            localAnchorA: n = [t.pxmi(n[0]), t.pxmi(n[1])],
            localAnchorB: r = [t.pxmi(r[0]), t.pxmi(r[1])],
            maxForce: o
        };
        p2.DistanceConstraint.call(this, e, i, a)
    }
    ,
    H.Physics.P2.DistanceConstraint.prototype = Object.create(p2.DistanceConstraint.prototype),
    H.Physics.P2.DistanceConstraint.prototype.constructor = H.Physics.P2.DistanceConstraint,
    H.Physics.P2.GearConstraint = function(t, e, i, s, n) {
        void 0 === s && (s = 0),
        void 0 === n && (n = 1),
        this.game = t.game,
        this.world = t;
        var r = {
            angle: s,
            ratio: n
        };
        p2.GearConstraint.call(this, e, i, r)
    }
    ,
    H.Physics.P2.GearConstraint.prototype = Object.create(p2.GearConstraint.prototype),
    H.Physics.P2.GearConstraint.prototype.constructor = H.Physics.P2.GearConstraint,
    H.Physics.P2.LockConstraint = function(t, e, i, s, n, r) {
        void 0 === s && (s = [0, 0]),
        void 0 === n && (n = 0),
        void 0 === r && (r = Number.MAX_VALUE),
        this.game = t.game;
        var o = {
            localOffsetB: s = [(this.world = t).pxm(s[0]), t.pxm(s[1])],
            localAngleB: n,
            maxForce: r
        };
        p2.LockConstraint.call(this, e, i, o)
    }
    ,
    H.Physics.P2.LockConstraint.prototype = Object.create(p2.LockConstraint.prototype),
    H.Physics.P2.LockConstraint.prototype.constructor = H.Physics.P2.LockConstraint,
    H.Physics.P2.PrismaticConstraint = function(t, e, i, s, n, r, o, a) {
        void 0 === s && (s = !0),
        void 0 === n && (n = [0, 0]),
        void 0 === r && (r = [0, 0]),
        void 0 === o && (o = [0, 0]),
        void 0 === a && (a = Number.MAX_VALUE),
        this.game = t.game;
        var h = {
            localAnchorA: n = [(this.world = t).pxmi(n[0]), t.pxmi(n[1])],
            localAnchorB: r = [t.pxmi(r[0]), t.pxmi(r[1])],
            localAxisA: o,
            maxForce: a,
            disableRotationalLock: !s
        };
        p2.PrismaticConstraint.call(this, e, i, h)
    }
    ,
    H.Physics.P2.PrismaticConstraint.prototype = Object.create(p2.PrismaticConstraint.prototype),
    H.Physics.P2.PrismaticConstraint.prototype.constructor = H.Physics.P2.PrismaticConstraint,
    H.Physics.P2.RevoluteConstraint = function(t, e, i, s, n, r, o) {
        void 0 === r && (r = Number.MAX_VALUE),
        void 0 === o && (o = null),
        this.game = t.game,
        i = [(this.world = t).pxmi(i[0]), t.pxmi(i[1])],
        n = [t.pxmi(n[0]), t.pxmi(n[1])],
        o && (o = [t.pxmi(o[0]), t.pxmi(o[1])]);
        var a = {
            worldPivot: o,
            localPivotA: i,
            localPivotB: n,
            maxForce: r
        };
        p2.RevoluteConstraint.call(this, e, s, a)
    }
    ,
    H.Physics.P2.RevoluteConstraint.prototype = Object.create(p2.RevoluteConstraint.prototype),
    H.Physics.P2.RevoluteConstraint.prototype.constructor = H.Physics.P2.RevoluteConstraint,
    H.ImageCollection = function(t, e, i, s, n, r, o) {
        (void 0 === i || i <= 0) && (i = 32),
        (void 0 === s || s <= 0) && (s = 32),
        void 0 === n && (n = 0),
        void 0 === r && (r = 0),
        this.name = t,
        this.firstgid = 0 | e,
        this.imageWidth = 0 | i,
        this.imageHeight = 0 | s,
        this.imageMargin = 0 | n,
        this.imageSpacing = 0 | r,
        this.properties = o || {},
        this.images = [],
        this.total = 0
    }
    ,
    H.ImageCollection.prototype = {
        containsImageIndex: function(t) {
            return t >= this.firstgid && t < this.firstgid + this.total
        },
        addImage: function(t, e) {
            this.images.push({
                gid: t,
                image: e
            }),
            this.total++
        }
    },
    H.ImageCollection.prototype.constructor = H.ImageCollection,
    H.Tile = function(t, e, i, s, n, r) {
        this.layer = t,
        this.index = e,
        this.x = i,
        this.y = s,
        this.rotation = 0,
        this.flipped = !1,
        this.worldX = i * n,
        this.worldY = s * r,
        this.width = n,
        this.height = r,
        this.centerX = Math.abs(n / 2),
        this.centerY = Math.abs(r / 2),
        this.alpha = 1,
        this.properties = {},
        this.scanned = !1,
        this.faceTop = !1,
        this.faceBottom = !1,
        this.faceLeft = !1,
        this.faceRight = !1,
        this.collideLeft = !1,
        this.collideRight = !1,
        this.collideUp = !1,
        this.collideDown = !1,
        this.collisionCallback = null,
        this.collisionCallbackContext = this
    }
    ,
    H.Tile.prototype = {
        containsPoint: function(t, e) {
            return !(t < this.worldX || e < this.worldY || t > this.right || e > this.bottom)
        },
        intersects: function(t, e, i, s) {
            return !(i <= this.worldX || s <= this.worldY || t >= this.worldX + this.width || e >= this.worldY + this.height)
        },
        setCollisionCallback: function(t, e) {
            this.collisionCallback = t,
            this.collisionCallbackContext = e
        },
        destroy: function() {
            this.collisionCallback = null,
            this.collisionCallbackContext = null,
            this.properties = null
        },
        setCollision: function(t, e, i, s) {
            this.collideLeft = t,
            this.collideRight = e,
            this.collideUp = i,
            this.collideDown = s,
            this.faceLeft = t,
            this.faceRight = e,
            this.faceTop = i,
            this.faceBottom = s
        },
        resetCollision: function() {
            this.collideLeft = !1,
            this.collideRight = !1,
            this.collideUp = !1,
            this.collideDown = !1,
            this.faceTop = !1,
            this.faceBottom = !1,
            this.faceLeft = !1,
            this.faceRight = !1
        },
        isInteresting: function(t, e) {
            return t && e ? this.collideLeft || this.collideRight || this.collideUp || this.collideDown || this.faceTop || this.faceBottom || this.faceLeft || this.faceRight || this.collisionCallback : t ? this.collideLeft || this.collideRight || this.collideUp || this.collideDown : !!e && (this.faceTop || this.faceBottom || this.faceLeft || this.faceRight)
        },
        copy: function(t) {
            this.index = t.index,
            this.alpha = t.alpha,
            this.properties = t.properties,
            this.collideUp = t.collideUp,
            this.collideDown = t.collideDown,
            this.collideLeft = t.collideLeft,
            this.collideRight = t.collideRight,
            this.collisionCallback = t.collisionCallback,
            this.collisionCallbackContext = t.collisionCallbackContext
        }
    },
    H.Tile.prototype.constructor = H.Tile,
    Object.defineProperty(H.Tile.prototype, "collides", {
        get: function() {
            return this.collideLeft || this.collideRight || this.collideUp || this.collideDown
        }
    }),
    Object.defineProperty(H.Tile.prototype, "canCollide", {
        get: function() {
            return this.collideLeft || this.collideRight || this.collideUp || this.collideDown || this.collisionCallback
        }
    }),
    Object.defineProperty(H.Tile.prototype, "left", {
        get: function() {
            return this.worldX
        }
    }),
    Object.defineProperty(H.Tile.prototype, "right", {
        get: function() {
            return this.worldX + this.width
        }
    }),
    Object.defineProperty(H.Tile.prototype, "top", {
        get: function() {
            return this.worldY
        }
    }),
    Object.defineProperty(H.Tile.prototype, "bottom", {
        get: function() {
            return this.worldY + this.height
        }
    }),
    H.Tilemap = function(t, e, i, s, n, r) {
        this.game = t,
        this.key = e;
        var o = H.TilemapParser.parse(this.game, e, i, s, n, r);
        null !== o && (this.width = o.width,
        this.height = o.height,
        this.tileWidth = o.tileWidth,
        this.tileHeight = o.tileHeight,
        this.orientation = o.orientation,
        this.format = o.format,
        this.version = o.version,
        this.properties = o.properties,
        this.widthInPixels = o.widthInPixels,
        this.heightInPixels = o.heightInPixels,
        this.layers = o.layers,
        this.tilesets = o.tilesets,
        this.imagecollections = o.imagecollections,
        this.tiles = o.tiles,
        this.objects = o.objects,
        this.collideIndexes = [],
        this.collision = o.collision,
        this.images = o.images,
        this.enableDebug = !1,
        this.currentLayer = 0,
        this.debugMap = [],
        this._results = [],
        this._tempA = 0,
        this._tempB = 0)
    }
    ,
    H.Tilemap.CSV = 0,
    H.Tilemap.TILED_JSON = 1,
    H.Tilemap.NORTH = 0,
    H.Tilemap.EAST = 1,
    H.Tilemap.SOUTH = 2,
    H.Tilemap.WEST = 3,
    H.Tilemap.prototype = {
        create: function(t, e, i, s, n, r) {
            return void 0 === r && (r = this.game.world),
            this.width = e,
            this.height = i,
            this.setTileSize(s, n),
            this.layers.length = 0,
            this.createBlankLayer(t, e, i, s, n, r)
        },
        setTileSize: function(t, e) {
            this.tileWidth = t,
            this.tileHeight = e,
            this.widthInPixels = this.width * t,
            this.heightInPixels = this.height * e
        },
        addTilesetImage: function(t, e, i, s, n, r, o) {
            if (void 0 === t)
                return null;
            void 0 === i && (i = this.tileWidth),
            void 0 === s && (s = this.tileHeight),
            void 0 === n && (n = 0),
            void 0 === r && (r = 0),
            void 0 === o && (o = 0),
            0 === i && (i = 32),
            0 === s && (s = 32);
            var a = null;
            if (null != e || (e = t),
            e instanceof H.BitmapData)
                a = e.canvas;
            else {
                if (!this.game.cache.checkImageKey(e))
                    return null;
                a = this.game.cache.getImage(e)
            }
            var h = this.getTilesetIndex(t);
            if (null === h && this.format === H.Tilemap.TILED_JSON)
                return null;
            if (this.tilesets[h])
                return this.tilesets[h].setImage(a),
                this.tilesets[h];
            var l = new H.Tileset(t,o,i,s,n,r,{});
            l.setImage(a),
            this.tilesets.push(l);
            for (var c = this.tilesets.length - 1, d = n, u = n, p = 0, g = 0, f = 0, m = o; m < o + l.total && (this.tiles[m] = [d, u, c],
            d += i + r,
            ++p !== l.total) && (++g !== l.columns || (d = n,
            u += s + r,
            g = 0,
            ++f !== l.rows)); m++)
                ;
            return l
        },
        createFromObjects: function(t, e, i, s, n, r, o, a, h) {
            if (void 0 === n && (n = !0),
            void 0 === r && (r = !1),
            void 0 === o && (o = this.game.world),
            void 0 === a && (a = H.Sprite),
            void 0 === h && (h = !0),
            this.objects[t])
                for (var l = 0; l < this.objects[t].length; l++) {
                    var c = !1
                      , d = this.objects[t][l];
                    if (void 0 !== d.gid && "number" == typeof e && d.gid === e ? c = !0 : void 0 !== d.id && "number" == typeof e && d.id === e ? c = !0 : void 0 !== d.name && "string" == typeof e && d.name === e && (c = !0),
                    c) {
                        var u = new a(this.game,parseFloat(d.x, 10),parseFloat(d.y, 10),i,s);
                        for (var p in u.name = d.name,
                        u.visible = d.visible,
                        u.autoCull = r,
                        u.exists = n,
                        d.width && (u.width = d.width),
                        d.height && (u.height = d.height),
                        d.rotation && (u.angle = d.rotation),
                        h && (u.y -= u.height),
                        o.add(u),
                        d.properties)
                            o.set(u, p, d.properties[p], !1, !1, 0, !0)
                    }
                }
        },
        createFromTiles: function(t, e, i, s, n, r) {
            "number" == typeof t && (t = [t]),
            null == e ? e = [] : "number" == typeof e && (e = [e]),
            s = this.getLayer(s),
            void 0 === n && (n = this.game.world),
            void 0 === r && (r = {}),
            void 0 === r.customClass && (r.customClass = H.Sprite),
            void 0 === r.adjustY && (r.adjustY = !0);
            var o = this.layers[s].width
              , a = this.layers[s].height;
            if (this.copy(0, 0, o, a, s),
            this._results.length < 2)
                return 0;
            for (var h, l = 0, c = 1, d = this._results.length; c < d; c++)
                if (-1 !== t.indexOf(this._results[c].index)) {
                    for (var u in h = new r.customClass(this.game,this._results[c].worldX,this._results[c].worldY,i),
                    r)
                        h[u] = r[u];
                    n.add(h),
                    l++
                }
            if (1 === e.length)
                for (c = 0; c < t.length; c++)
                    this.replace(t[c], e[0], 0, 0, o, a, s);
            else if (1 < e.length)
                for (c = 0; c < t.length; c++)
                    this.replace(t[c], e[c], 0, 0, o, a, s);
            return l
        },
        createLayer: function(t, e, i, s) {
            void 0 === e && (e = this.game.width),
            void 0 === i && (i = this.game.height),
            void 0 === s && (s = this.game.world);
            var n = t;
            if ("string" == typeof t && (n = this.getLayerIndex(t)),
            !(null === n || n > this.layers.length)) {
                void 0 === e || e <= 0 ? e = Math.min(this.game.width, this.layers[n].widthInPixels) : e > this.game.width && (e = this.game.width),
                void 0 === i || i <= 0 ? i = Math.min(this.game.height, this.layers[n].heightInPixels) : i > this.game.height && (i = this.game.height),
                this.enableDebug;
                var r = s.add(new H.TilemapLayer(this.game,this,n,e,i));
                return this.enableDebug,
                r
            }
        },
        createBlankLayer: function(t, e, i, s, n, r) {
            if (void 0 === r && (r = this.game.world),
            null === this.getLayerIndex(t)) {
                for (var o, a = {
                    name: t,
                    x: 0,
                    y: 0,
                    width: e,
                    height: i,
                    widthInPixels: e * s,
                    heightInPixels: i * n,
                    alpha: 1,
                    visible: !0,
                    properties: {},
                    indexes: [],
                    callbacks: [],
                    bodies: [],
                    data: null
                }, h = [], l = 0; l < i; l++) {
                    o = [];
                    for (var c = 0; c < e; c++)
                        o.push(new H.Tile(a,-1,c,l,s,n));
                    h.push(o)
                }
                a.data = h,
                this.layers.push(a),
                this.currentLayer = this.layers.length - 1;
                var d = a.widthInPixels
                  , u = a.heightInPixels;
                return d > this.game.width && (d = this.game.width),
                u > this.game.height && (u = this.game.height),
                (h = new H.TilemapLayer(this.game,this,this.layers.length - 1,d,u)).name = t,
                r.add(h)
            }
        },
        getIndex: function(t, e) {
            for (var i = 0; i < t.length; i++)
                if (t[i].name === e)
                    return i;
            return null
        },
        getLayerIndex: function(t) {
            return this.getIndex(this.layers, t)
        },
        getTilesetIndex: function(t) {
            return this.getIndex(this.tilesets, t)
        },
        getImageIndex: function(t) {
            return this.getIndex(this.images, t)
        },
        setTileIndexCallback: function(t, e, i, s) {
            if (s = this.getLayer(s),
            "number" == typeof t)
                this.layers[s].callbacks[t] = {
                    callback: e,
                    callbackContext: i
                };
            else
                for (var n = 0, r = t.length; n < r; n++)
                    this.layers[s].callbacks[t[n]] = {
                        callback: e,
                        callbackContext: i
                    }
        },
        setTileLocationCallback: function(t, e, i, s, n, r, o) {
            if (o = this.getLayer(o),
            this.copy(t, e, i, s, o),
            !(this._results.length < 2))
                for (var a = 1; a < this._results.length; a++)
                    this._results[a].setCollisionCallback(n, r)
        },
        setCollision: function(t, e, i, s) {
            if (void 0 === e && (e = !0),
            void 0 === s && (s = !0),
            i = this.getLayer(i),
            "number" == typeof t)
                return this.setCollisionByIndex(t, e, i, !0);
            if (Array.isArray(t)) {
                for (var n = 0; n < t.length; n++)
                    this.setCollisionByIndex(t[n], e, i, !1);
                s && this.calculateFaces(i)
            }
        },
        setCollisionBetween: function(t, e, i, s, n) {
            if (void 0 === i && (i = !0),
            void 0 === n && (n = !0),
            s = this.getLayer(s),
            !(e < t)) {
                for (var r = t; r <= e; r++)
                    this.setCollisionByIndex(r, i, s, !1);
                n && this.calculateFaces(s)
            }
        },
        setCollisionByExclusion: function(t, e, i, s) {
            void 0 === e && (e = !0),
            void 0 === s && (s = !0),
            i = this.getLayer(i);
            for (var n = 0, r = this.tiles.length; n < r; n++)
                -1 === t.indexOf(n) && this.setCollisionByIndex(n, e, i, !1);
            s && this.calculateFaces(i)
        },
        setCollisionByIndex: function(t, e, i, s) {
            if (void 0 === e && (e = !0),
            void 0 === i && (i = this.currentLayer),
            void 0 === s && (s = !0),
            e)
                this.collideIndexes.push(t);
            else {
                var n = this.collideIndexes.indexOf(t);
                -1 < n && this.collideIndexes.splice(n, 1)
            }
            for (var r = 0; r < this.layers[i].height; r++)
                for (var o = 0; o < this.layers[i].width; o++) {
                    var a = this.layers[i].data[r][o];
                    a && a.index === t && (e ? a.setCollision(!0, !0, !0, !0) : a.resetCollision(),
                    a.faceTop = e,
                    a.faceBottom = e,
                    a.faceLeft = e,
                    a.faceRight = e)
                }
            return s && this.calculateFaces(i),
            i
        },
        getLayer: function(t) {
            return void 0 === t ? t = this.currentLayer : "string" == typeof t ? t = this.getLayerIndex(t) : t instanceof H.TilemapLayer && (t = t.index),
            t
        },
        setPreventRecalculate: function(t) {
            if (!0 === t && !0 !== this.preventingRecalculate && (this.preventingRecalculate = !0,
            this.needToRecalculate = {}),
            !1 === t && !0 === this.preventingRecalculate) {
                for (var e in this.preventingRecalculate = !1,
                this.needToRecalculate)
                    this.calculateFaces(e);
                this.needToRecalculate = !1
            }
        },
        calculateFaces: function(t) {
            if (this.preventingRecalculate)
                this.needToRecalculate[t] = !0;
            else
                for (var e = null, i = null, s = null, n = null, r = 0, o = this.layers[t].height; r < o; r++)
                    for (var a = 0, h = this.layers[t].width; a < h; a++) {
                        var l = this.layers[t].data[r][a];
                        l && (e = this.getTileAbove(t, a, r),
                        i = this.getTileBelow(t, a, r),
                        s = this.getTileLeft(t, a, r),
                        n = this.getTileRight(t, a, r),
                        l.collides && (l.faceTop = !0,
                        l.faceBottom = !0,
                        l.faceLeft = !0,
                        l.faceRight = !0),
                        e && e.collides && (l.faceTop = !1),
                        i && i.collides && (l.faceBottom = !1),
                        s && s.collides && (l.faceLeft = !1),
                        n && n.collides && (l.faceRight = !1))
                    }
        },
        getTileAbove: function(t, e, i) {
            return 0 < i ? this.layers[t].data[i - 1][e] : null
        },
        getTileBelow: function(t, e, i) {
            return i < this.layers[t].height - 1 ? this.layers[t].data[i + 1][e] : null
        },
        getTileLeft: function(t, e, i) {
            return 0 < e ? this.layers[t].data[i][e - 1] : null
        },
        getTileRight: function(t, e, i) {
            return e < this.layers[t].width - 1 ? this.layers[t].data[i][e + 1] : null
        },
        setLayer: function(t) {
            t = this.getLayer(t),
            this.layers[t] && (this.currentLayer = t)
        },
        hasTile: function(t, e, i) {
            return i = this.getLayer(i),
            void 0 !== this.layers[i].data[e] && void 0 !== this.layers[i].data[e][t] && -1 < this.layers[i].data[e][t].index
        },
        removeTile: function(t, e, i) {
            if (i = this.getLayer(i),
            0 <= t && t < this.layers[i].width && 0 <= e && e < this.layers[i].height && this.hasTile(t, e, i)) {
                var s = this.layers[i].data[e][t];
                return this.layers[i].data[e][t] = new H.Tile(this.layers[i],-1,t,e,this.tileWidth,this.tileHeight),
                this.layers[i].dirty = !0,
                this.calculateFaces(i),
                s
            }
        },
        removeTileWorldXY: function(t, e, i, s, n) {
            return n = this.getLayer(n),
            t = this.game.math.snapToFloor(t, i) / i,
            e = this.game.math.snapToFloor(e, s) / s,
            this.removeTile(t, e, n)
        },
        putTile: function(t, e, i, s) {
            return null === t ? this.removeTile(e, i, s) : (s = this.getLayer(s),
            0 <= e && e < this.layers[s].width && 0 <= i && i < this.layers[s].height ? (t instanceof H.Tile ? (n = t.index,
            this.hasTile(e, i, s) ? this.layers[s].data[i][e].copy(t) : this.layers[s].data[i][e] = new H.Tile(s,n,e,i,t.width,t.height)) : (n = t,
            this.hasTile(e, i, s) ? this.layers[s].data[i][e].index = n : this.layers[s].data[i][e] = new H.Tile(this.layers[s],n,e,i,this.tileWidth,this.tileHeight)),
            -1 < this.collideIndexes.indexOf(n) ? this.layers[s].data[i][e].setCollision(!0, !0, !0, !0) : this.layers[s].data[i][e].resetCollision(),
            this.layers[s].dirty = !0,
            this.calculateFaces(s),
            this.layers[s].data[i][e]) : null);
            var n
        },
        putTileWorldXY: function(t, e, i, s, n, r) {
            return r = this.getLayer(r),
            e = this.game.math.snapToFloor(e, s) / s,
            i = this.game.math.snapToFloor(i, n) / n,
            this.putTile(t, e, i, r)
        },
        searchTileIndex: function(t, e, i, s) {
            void 0 === e && (e = 0),
            void 0 === i && (i = !1),
            s = this.getLayer(s);
            var n = 0;
            if (i) {
                for (var r = this.layers[s].height - 1; 0 <= r; r--)
                    for (var o = this.layers[s].width - 1; 0 <= o; o--)
                        if (this.layers[s].data[r][o].index === t) {
                            if (n === e)
                                return this.layers[s].data[r][o];
                            n++
                        }
            } else
                for (r = 0; r < this.layers[s].height; r++)
                    for (o = 0; o < this.layers[s].width; o++)
                        if (this.layers[s].data[r][o].index === t) {
                            if (n === e)
                                return this.layers[s].data[r][o];
                            n++
                        }
            return null
        },
        getTile: function(t, e, i, s) {
            return void 0 === s && (s = !1),
            i = this.getLayer(i),
            0 <= t && t < this.layers[i].width && 0 <= e && e < this.layers[i].height ? -1 === this.layers[i].data[e][t].index ? s ? this.layers[i].data[e][t] : null : this.layers[i].data[e][t] : null
        },
        getTileWorldXY: function(t, e, i, s, n, r) {
            return void 0 === i && (i = this.tileWidth),
            void 0 === s && (s = this.tileHeight),
            n = this.getLayer(n),
            t = this.game.math.snapToFloor(t, i) / i,
            e = this.game.math.snapToFloor(e, s) / s,
            this.getTile(t, e, n, r)
        },
        copy: function(t, e, i, s, n) {
            if (n = this.getLayer(n),
            this.layers[n]) {
                void 0 === t && (t = 0),
                void 0 === e && (e = 0),
                void 0 === i && (i = this.layers[n].width),
                void 0 === s && (s = this.layers[n].height),
                t < 0 && (t = 0),
                e < 0 && (e = 0),
                i > this.layers[n].width && (i = this.layers[n].width),
                s > this.layers[n].height && (s = this.layers[n].height),
                this._results.length = 0,
                this._results.push({
                    x: t,
                    y: e,
                    width: i,
                    height: s,
                    layer: n
                });
                for (var r = e; r < e + s; r++)
                    for (var o = t; o < t + i; o++)
                        this._results.push(this.layers[n].data[r][o]);
                return this._results
            }
            this._results.length = 0
        },
        paste: function(t, e, i, s) {
            if (void 0 === t && (t = 0),
            void 0 === e && (e = 0),
            s = this.getLayer(s),
            i && !(i.length < 2)) {
                for (var n = t - i[1].x, r = e - i[1].y, o = 1; o < i.length; o++)
                    this.layers[s].data[r + i[o].y][n + i[o].x].copy(i[o]);
                this.layers[s].dirty = !0,
                this.calculateFaces(s)
            }
        },
        swap: function(t, e, i, s, n, r, o) {
            o = this.getLayer(o),
            this.copy(i, s, n, r, o),
            this._results.length < 2 || (this._tempA = t,
            this._tempB = e,
            this._results.forEach(this.swapHandler, this),
            this.paste(i, s, this._results, o))
        },
        swapHandler: function(t) {
            t.index === this._tempA ? t.index = this._tempB : t.index === this._tempB && (t.index = this._tempA)
        },
        forEach: function(t, e, i, s, n, r, o) {
            o = this.getLayer(o),
            this.copy(i, s, n, r, o),
            this._results.length < 2 || (this._results.forEach(t, e),
            this.paste(i, s, this._results, o))
        },
        replace: function(t, e, i, s, n, r, o) {
            if (o = this.getLayer(o),
            this.copy(i, s, n, r, o),
            !(this._results.length < 2)) {
                for (var a = 1; a < this._results.length; a++)
                    this._results[a].index === t && (this._results[a].index = e);
                this.paste(i, s, this._results, o)
            }
        },
        random: function(t, e, i, s, n) {
            if (n = this.getLayer(n),
            this.copy(t, e, i, s, n),
            !(this._results.length < 2)) {
                for (var r = [], o = 1; o < this._results.length; o++)
                    if (this._results[o].index) {
                        var a = this._results[o].index;
                        -1 === r.indexOf(a) && r.push(a)
                    }
                for (var h = 1; h < this._results.length; h++)
                    this._results[h].index = this.game.rnd.pick(r);
                this.paste(t, e, this._results, n)
            }
        },
        shuffle: function(t, e, i, s, n) {
            if (n = this.getLayer(n),
            this.copy(t, e, i, s, n),
            !(this._results.length < 2)) {
                for (var r = [], o = 1; o < this._results.length; o++)
                    this._results[o].index && r.push(this._results[o].index);
                H.ArrayUtils.shuffle(r);
                for (var a = 1; a < this._results.length; a++)
                    this._results[a].index = r[a - 1];
                this.paste(t, e, this._results, n)
            }
        },
        fill: function(t, e, i, s, n, r) {
            if (r = this.getLayer(r),
            this.copy(e, i, s, n, r),
            !(this._results.length < 2)) {
                for (var o = 1; o < this._results.length; o++)
                    this._results[o].index = t;
                this.paste(e, i, this._results, r)
            }
        },
        removeAllLayers: function() {
            this.layers.length = 0,
            this.currentLayer = 0
        },
        dump: function() {
            for (var t = "", e = [""], i = 0; i < this.layers[this.currentLayer].height; i++) {
                for (var s = 0; s < this.layers[this.currentLayer].width; s++)
                    t += "%c  ",
                    1 < this.layers[this.currentLayer].data[i][s] ? this.debugMap[this.layers[this.currentLayer].data[i][s]] ? e.push("background: " + this.debugMap[this.layers[this.currentLayer].data[i][s]]) : e.push("background: #ffffff") : e.push("background: rgb(0, 0, 0)");
                t += "\n"
            }
            e[0] = t
        },
        destroy: function() {
            this.removeAllLayers(),
            this.data = [],
            this.game = null
        }
    },
    H.Tilemap.prototype.constructor = H.Tilemap,
    Object.defineProperty(H.Tilemap.prototype, "layer", {
        get: function() {
            return this.layers[this.currentLayer]
        },
        set: function(t) {
            t !== this.currentLayer && this.setLayer(t)
        }
    }),
    H.TilemapLayer = function(t, e, i, s, n) {
        s |= 0,
        n |= 0,
        H.Sprite.call(this, t, 0, 0),
        this.map = e,
        this.index = i,
        this.layer = e.layers[i],
        this.canvas = PIXI.CanvasPool.create(this, s, n),
        this.context = this.canvas.getContext("2d"),
        this.setTexture(new PIXI.Texture(new PIXI.BaseTexture(this.canvas))),
        this.type = H.TILEMAPLAYER,
        this.physicsType = H.TILEMAPLAYER,
        this.renderSettings = {
            enableScrollDelta: !1,
            overdrawRatio: .2,
            copyCanvas: null
        },
        this.debug = !1,
        this.exists = !0,
        this.debugSettings = {
            missingImageFill: "rgb(255,255,255)",
            debuggedTileOverfill: "rgba(0,255,0,0.4)",
            forceFullRedraw: !0,
            debugAlpha: .5,
            facingEdgeStroke: "rgba(0,255,0,1)",
            collidingTileOverfill: "rgba(0,255,0,0.2)"
        },
        this.scrollFactorX = 1,
        this.scrollFactorY = 1,
        this.dirty = !0,
        this.rayStepRate = 4,
        this._wrap = !1,
        this._mc = {
            scrollX: 0,
            scrollY: 0,
            renderWidth: 0,
            renderHeight: 0,
            tileWidth: e.tileWidth,
            tileHeight: e.tileHeight,
            cw: e.tileWidth,
            ch: e.tileHeight,
            tilesets: []
        },
        this._scrollX = 0,
        this._scrollY = 0,
        this._results = [],
        t.device.canvasBitBltShift || (this.renderSettings.copyCanvas = H.TilemapLayer.ensureSharedCopyCanvas()),
        this.fixedToCamera = !0
    }
    ,
    H.TilemapLayer.prototype = Object.create(H.Sprite.prototype),
    H.TilemapLayer.prototype.constructor = H.TilemapLayer,
    H.TilemapLayer.prototype.preUpdateCore = H.Component.Core.preUpdate,
    H.TilemapLayer.sharedCopyCanvas = null,
    H.TilemapLayer.ensureSharedCopyCanvas = function() {
        return this.sharedCopyCanvas || (this.sharedCopyCanvas = PIXI.CanvasPool.create(this, 2, 2)),
        this.sharedCopyCanvas
    }
    ,
    H.TilemapLayer.prototype.preUpdate = function() {
        return this.preUpdateCore()
    }
    ,
    H.TilemapLayer.prototype.postUpdate = function() {
        this.fixedToCamera && (this.position.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x,
        this.position.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y),
        this._scrollX = this.game.camera.view.x * this.scrollFactorX / this.scale.x,
        this._scrollY = this.game.camera.view.y * this.scrollFactorY / this.scale.y
    }
    ,
    H.TilemapLayer.prototype._renderCanvas = function(t) {
        this.fixedToCamera && (this.position.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x,
        this.position.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y),
        this._scrollX = this.game.camera.view.x * this.scrollFactorX / this.scale.x,
        this._scrollY = this.game.camera.view.y * this.scrollFactorY / this.scale.y,
        this.render(),
        PIXI.Sprite.prototype._renderCanvas.call(this, t)
    }
    ,
    H.TilemapLayer.prototype._renderWebGL = function(t) {
        this.fixedToCamera && (this.position.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x,
        this.position.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y),
        this._scrollX = this.game.camera.view.x * this.scrollFactorX / this.scale.x,
        this._scrollY = this.game.camera.view.y * this.scrollFactorY / this.scale.y,
        this.render(),
        PIXI.Sprite.prototype._renderWebGL.call(this, t)
    }
    ,
    H.TilemapLayer.prototype.destroy = function() {
        PIXI.CanvasPool.remove(this),
        H.Component.Destroy.prototype.destroy.call(this)
    }
    ,
    H.TilemapLayer.prototype.resize = function(t, e) {
        this.canvas.width = t,
        this.canvas.height = e,
        this.texture.frame.resize(t, e),
        this.texture.width = t,
        this.texture.height = e,
        this.texture.crop.width = t,
        this.texture.crop.height = e,
        this.texture.baseTexture.width = t,
        this.texture.baseTexture.height = e,
        this.texture.baseTexture.dirty(),
        this.texture.requiresUpdate = !0,
        this.texture._updateUvs(),
        this.dirty = !0
    }
    ,
    H.TilemapLayer.prototype.resizeWorld = function() {
        this.game.world.setBounds(0, 0, this.layer.widthInPixels * this.scale.x, this.layer.heightInPixels * this.scale.y)
    }
    ,
    H.TilemapLayer.prototype._fixX = function(t) {
        return 1 === this.scrollFactorX || 0 === this.scrollFactorX && 0 === this.position.x ? t : 0 === this.scrollFactorX && 0 !== this.position.x ? t - this.position.x : this._scrollX + (t - this._scrollX / this.scrollFactorX)
    }
    ,
    H.TilemapLayer.prototype._unfixX = function(t) {
        return 1 === this.scrollFactorX ? t : this._scrollX / this.scrollFactorX + (t - this._scrollX)
    }
    ,
    H.TilemapLayer.prototype._fixY = function(t) {
        return 1 === this.scrollFactorY || 0 === this.scrollFactorY && 0 === this.position.y ? t : 0 === this.scrollFactorY && 0 !== this.position.y ? t - this.position.y : this._scrollY + (t - this._scrollY / this.scrollFactorY)
    }
    ,
    H.TilemapLayer.prototype._unfixY = function(t) {
        return 1 === this.scrollFactorY ? t : this._scrollY / this.scrollFactorY + (t - this._scrollY)
    }
    ,
    H.TilemapLayer.prototype.getTileX = function(t) {
        return Math.floor(this._fixX(t) / this._mc.tileWidth)
    }
    ,
    H.TilemapLayer.prototype.getTileY = function(t) {
        return Math.floor(this._fixY(t) / this._mc.tileHeight)
    }
    ,
    H.TilemapLayer.prototype.getTileXY = function(t, e, i) {
        return i.x = this.getTileX(t),
        i.y = this.getTileY(e),
        i
    }
    ,
    H.TilemapLayer.prototype.getRayCastTiles = function(t, e, i, s) {
        e || (e = this.rayStepRate),
        void 0 === i && (i = !1),
        void 0 === s && (s = !1);
        var n = this.getTiles(t.x, t.y, t.width, t.height, i, s);
        if (0 === n.length)
            return [];
        for (var r = t.coordinatesOnLine(e), o = [], a = 0; a < n.length; a++)
            for (var h = 0; h < r.length; h++) {
                var l = n[a]
                  , c = r[h];
                if (l.containsPoint(c[0], c[1])) {
                    o.push(l);
                    break
                }
            }
        return o
    }
    ,
    H.TilemapLayer.prototype.getTiles = function(t, e, i, s, n, r) {
        void 0 === n && (n = !1),
        void 0 === r && (r = !1);
        var o = !(n || r);
        t = this._fixX(t),
        e = this._fixY(e);
        for (var a = Math.floor(t / (this._mc.cw * this.scale.x)), h = Math.floor(e / (this._mc.ch * this.scale.y)), l = Math.ceil((t + i) / (this._mc.cw * this.scale.x)) - a, c = Math.ceil((e + s) / (this._mc.ch * this.scale.y)) - h; this._results.length; )
            this._results.pop();
        for (var d = h; d < h + c; d++)
            for (var u = a; u < a + l; u++) {
                var p = this.layer.data[d];
                p && p[u] && (o || p[u].isInteresting(n, r)) && this._results.push(p[u])
            }
        return this._results.slice()
    }
    ,
    H.TilemapLayer.prototype.resolveTileset = function(t) {
        var e = this._mc.tilesets;
        if (t < 2e3)
            for (; e.length < t; )
                e.push(void 0);
        var i = this.map.tiles[t] && this.map.tiles[t][2];
        if (null !== i) {
            var s = this.map.tilesets[i];
            if (s && s.containsTileIndex(t))
                return e[t] = s
        }
        return e[t] = null
    }
    ,
    H.TilemapLayer.prototype.resetTilesetCache = function() {
        for (var t = this._mc.tilesets; t.length; )
            t.pop()
    }
    ,
    H.TilemapLayer.prototype.setScale = function(t, e) {
        t = t || 1,
        e = e || t;
        for (var i = 0; i < this.layer.data.length; i++)
            for (var s = this.layer.data[i], n = 0; n < s.length; n++) {
                var r = s[n];
                r.width = this.map.tileWidth * t,
                r.height = this.map.tileHeight * e,
                r.worldX = r.x * r.width,
                r.worldY = r.y * r.height
            }
        this.scale.setTo(t, e)
    }
    ,
    H.TilemapLayer.prototype.shiftCanvas = function(t, e, i) {
        var s = t.canvas
          , n = s.width - Math.abs(e)
          , r = s.height - Math.abs(i)
          , o = 0
          , a = 0
          , h = e
          , l = i;
        e < 0 && (o = -e,
        h = 0),
        i < 0 && (a = -i,
        l = 0);
        var c = this.renderSettings.copyCanvas;
        if (c) {
            (c.width < n || c.height < r) && (c.width = n,
            c.height = r);
            var d = c.getContext("2d");
            d.clearRect(0, 0, n, r),
            d.drawImage(s, o, a, n, r, 0, 0, n, r),
            t.clearRect(h, l, n, r),
            t.drawImage(c, 0, 0, n, r, h, l, n, r)
        } else
            t.save(),
            t.globalCompositeOperation = "copy",
            t.drawImage(s, o, a, n, r, h, l, n, r),
            t.restore()
    }
    ,
    H.TilemapLayer.prototype.renderRegion = function(t, e, i, s, n, r) {
        var o = this.context
          , a = this.layer.width
          , h = this.layer.height
          , l = this._mc.tileWidth
          , c = this._mc.tileHeight
          , d = this._mc.tilesets
          , u = NaN;
        this._wrap || (i <= n && (i = Math.max(0, i),
        n = Math.min(a - 1, n)),
        s <= r && (s = Math.max(0, s),
        r = Math.min(h - 1, r)));
        var p, g, f, m, y, v, _ = i * l - t, b = (i + (1 << 20) * a) % a;
        for (m = (s + (1 << 20) * h) % h,
        v = r - s,
        g = s * c - e; 0 <= v; m++,
        v--,
        g += c) {
            h <= m && (m -= h);
            var w = this.layer.data[m];
            for (f = b,
            y = n - i,
            p = _; 0 <= y; f++,
            y--,
            p += l) {
                a <= f && (f -= a);
                var x = w[f];
                if (x && !(x.index < 0)) {
                    var S = x.index
                      , T = d[S];
                    void 0 === T && (T = this.resolveTileset(S)),
                    x.alpha === u || this.debug || (o.globalAlpha = x.alpha,
                    u = x.alpha),
                    T ? x.rotation || x.flipped ? (o.save(),
                    o.translate(p + x.centerX, g + x.centerY),
                    o.rotate(x.rotation),
                    x.flipped && o.scale(-1, 1),
                    T.draw(o, -x.centerX, -x.centerY, S),
                    o.restore()) : T.draw(o, p, g, S) : this.debugSettings.missingImageFill && (o.fillStyle = this.debugSettings.missingImageFill,
                    o.fillRect(p, g, l, c)),
                    x.debug && this.debugSettings.debuggedTileOverfill && (o.fillStyle = this.debugSettings.debuggedTileOverfill,
                    o.fillRect(p, g, l, c))
                }
            }
        }
    }
    ,
    H.TilemapLayer.prototype.renderDeltaScroll = function(t, e) {
        var i = this._mc.scrollX
          , s = this._mc.scrollY
          , n = this.canvas.width
          , r = this.canvas.height
          , o = this._mc.tileWidth
          , a = this._mc.tileHeight
          , h = 0
          , l = -o
          , c = 0
          , d = -a;
        if (t < 0 ? (h = n + t,
        l = n - 1) : 0 < t && (l = t),
        e < 0 ? (c = r + e,
        d = r - 1) : 0 < e && (d = e),
        this.shiftCanvas(this.context, t, e),
        h = Math.floor((h + i) / o),
        l = Math.floor((l + i) / o),
        c = Math.floor((c + s) / a),
        d = Math.floor((d + s) / a),
        h <= l) {
            this.context.clearRect(h * o - i, 0, (l - h + 1) * o, r);
            var u = Math.floor((0 + s) / a)
              , p = Math.floor((r - 1 + s) / a);
            this.renderRegion(i, s, h, u, l, p)
        }
        if (c <= d) {
            this.context.clearRect(0, c * a - s, n, (d - c + 1) * a);
            var g = Math.floor((0 + i) / o)
              , f = Math.floor((n - 1 + i) / o);
            this.renderRegion(i, s, g, c, f, d)
        }
    }
    ,
    H.TilemapLayer.prototype.renderFull = function() {
        var t = this._mc.scrollX
          , e = this._mc.scrollY
          , i = this.canvas.width
          , s = this.canvas.height
          , n = this._mc.tileWidth
          , r = this._mc.tileHeight
          , o = Math.floor(t / n)
          , a = Math.floor((i - 1 + t) / n)
          , h = Math.floor(e / r)
          , l = Math.floor((s - 1 + e) / r);
        this.context.clearRect(0, 0, i, s),
        this.renderRegion(t, e, o, h, a, l)
    }
    ,
    H.TilemapLayer.prototype.render = function() {
        var t = !1;
        if (this.visible) {
            (this.dirty || this.layer.dirty) && (t = !(this.layer.dirty = !1));
            var e = this.canvas.width
              , i = this.canvas.height
              , s = 0 | this._scrollX
              , n = 0 | this._scrollY
              , r = this._mc
              , o = r.scrollX - s
              , a = r.scrollY - n;
            if (t || 0 !== o || 0 !== a || r.renderWidth !== e || r.renderHeight !== i)
                return this.context.save(),
                r.scrollX = s,
                r.scrollY = n,
                r.renderWidth === e && r.renderHeight === i || (r.renderWidth = e,
                r.renderHeight = i),
                this.debug && (this.context.globalAlpha = this.debugSettings.debugAlpha,
                this.debugSettings.forceFullRedraw && (t = !0)),
                !t && this.renderSettings.enableScrollDelta && Math.abs(o) + Math.abs(a) < Math.min(e, i) ? this.renderDeltaScroll(o, a) : this.renderFull(),
                this.debug && (this.context.globalAlpha = 1,
                this.renderDebug()),
                this.texture.baseTexture.dirty(),
                this.dirty = !1,
                this.context.restore(),
                !0
        }
    }
    ,
    H.TilemapLayer.prototype.renderDebug = function() {
        var t, e, i, s, n, r, o = this._mc.scrollX, a = this._mc.scrollY, h = this.context, l = this.canvas.width, c = this.canvas.height, d = this.layer.width, u = this.layer.height, p = this._mc.tileWidth, g = this._mc.tileHeight, f = Math.floor(o / p), m = Math.floor((l - 1 + o) / p), y = Math.floor(a / g), v = Math.floor((c - 1 + a) / g), _ = f * p - o, b = y * g - a, w = (f + (1 << 20) * d) % d, x = (y + (1 << 20) * u) % u;
        for (h.strokeStyle = this.debugSettings.facingEdgeStroke,
        s = x,
        r = v - y,
        e = b; 0 <= r; s++,
        r--,
        e += g) {
            u <= s && (s -= u);
            var S = this.layer.data[s];
            for (i = w,
            n = m - f,
            t = _; 0 <= n; i++,
            n--,
            t += p) {
                d <= i && (i -= d);
                var T = S[i];
                !T || T.index < 0 || !T.collides || (this.debugSettings.collidingTileOverfill && (h.fillStyle = this.debugSettings.collidingTileOverfill,
                h.fillRect(t, e, this._mc.cw, this._mc.ch)),
                this.debugSettings.facingEdgeStroke && (h.beginPath(),
                T.faceTop && (h.moveTo(t, e),
                h.lineTo(t + this._mc.cw, e)),
                T.faceBottom && (h.moveTo(t, e + this._mc.ch),
                h.lineTo(t + this._mc.cw, e + this._mc.ch)),
                T.faceLeft && (h.moveTo(t, e),
                h.lineTo(t, e + this._mc.ch)),
                T.faceRight && (h.moveTo(t + this._mc.cw, e),
                h.lineTo(t + this._mc.cw, e + this._mc.ch)),
                h.closePath(),
                h.stroke()))
            }
        }
    }
    ,
    Object.defineProperty(H.TilemapLayer.prototype, "wrap", {
        get: function() {
            return this._wrap
        },
        set: function(t) {
            this._wrap = t,
            this.dirty = !0
        }
    }),
    Object.defineProperty(H.TilemapLayer.prototype, "scrollX", {
        get: function() {
            return this._scrollX
        },
        set: function(t) {
            this._scrollX = t
        }
    }),
    Object.defineProperty(H.TilemapLayer.prototype, "scrollY", {
        get: function() {
            return this._scrollY
        },
        set: function(t) {
            this._scrollY = t
        }
    }),
    Object.defineProperty(H.TilemapLayer.prototype, "collisionWidth", {
        get: function() {
            return this._mc.cw
        },
        set: function(t) {
            this._mc.cw = 0 | t,
            this.dirty = !0
        }
    }),
    Object.defineProperty(H.TilemapLayer.prototype, "collisionHeight", {
        get: function() {
            return this._mc.ch
        },
        set: function(t) {
            this._mc.ch = 0 | t,
            this.dirty = !0
        }
    }),
    H.TilemapParser = {
        INSERT_NULL: !1,
        parse: function(t, e, i, s, n, r) {
            if (void 0 === i && (i = 32),
            void 0 === s && (s = 32),
            void 0 === n && (n = 10),
            void 0 === r && (r = 10),
            void 0 === e)
                return this.getEmptyData();
            if (null === e)
                return this.getEmptyData(i, s, n, r);
            var o = t.cache.getTilemapData(e);
            if (o) {
                if (o.format === H.Tilemap.CSV)
                    return this.parseCSV(e, o.data, i, s);
                if (!o.format || o.format === H.Tilemap.TILED_JSON)
                    return this.parseTiledJSON(o.data)
            }
        },
        parseCSV: function(t, e, i, s) {
            for (var n = this.getEmptyData(), r = [], o = (e = e.trim()).split("\n"), a = o.length, h = 0, l = 0; l < o.length; l++) {
                r[l] = [];
                for (var c = o[l].split(","), d = 0; d < c.length; d++)
                    r[l][d] = new H.Tile(n.layers[0],parseInt(c[d], 10),d,l,i,s);
                0 === h && (h = c.length)
            }
            return n.format = H.Tilemap.CSV,
            n.name = t,
            n.width = h,
            n.height = a,
            n.tileWidth = i,
            n.tileHeight = s,
            n.widthInPixels = h * i,
            n.heightInPixels = a * s,
            n.layers[0].width = h,
            n.layers[0].height = a,
            n.layers[0].widthInPixels = n.widthInPixels,
            n.layers[0].heightInPixels = n.heightInPixels,
            n.layers[0].data = r,
            n
        },
        getEmptyData: function(t, e, i, s) {
            return {
                width: null != i ? i : 0,
                height: null != s ? s : 0,
                tileWidth: null != t ? t : 0,
                tileHeight: null != e ? e : 0,
                orientation: "orthogonal",
                version: "1",
                properties: {},
                widthInPixels: 0,
                heightInPixels: 0,
                layers: [{
                    name: "layer",
                    x: 0,
                    y: 0,
                    width: 0,
                    height: 0,
                    widthInPixels: 0,
                    heightInPixels: 0,
                    alpha: 1,
                    visible: !0,
                    properties: {},
                    indexes: [],
                    callbacks: [],
                    bodies: [],
                    data: []
                }],
                images: [],
                objects: {},
                collision: {},
                tilesets: [],
                tiles: []
            }
        },
        parseTiledJSON: function(t) {
            function e(t, e) {
                var i = {};
                for (var s in e) {
                    var n = e[s];
                    void 0 !== t[n] && (i[n] = t[n])
                }
                return i
            }
            if ("orthogonal" !== t.orientation)
                return null;
            for (var i = {
                width: t.width,
                height: t.height,
                tileWidth: t.tilewidth,
                tileHeight: t.tileheight,
                orientation: t.orientation,
                format: H.Tilemap.TILED_JSON,
                version: t.version,
                properties: t.properties,
                widthInPixels: t.width * t.tilewidth,
                heightInPixels: t.height * t.tileheight
            }, s = [], n = 0; n < t.layers.length; n++)
                if ("tilelayer" === t.layers[n].type) {
                    var r = t.layers[n];
                    if (!r.compression && r.encoding && "base64" === r.encoding) {
                        for (var o = window.atob(r.data), a = o.length, h = new Array(a), l = 0; l < a; l += 4)
                            h[l / 4] = (o.charCodeAt(l) | o.charCodeAt(l + 1) << 8 | o.charCodeAt(l + 2) << 16 | o.charCodeAt(l + 3) << 24) >>> 0;
                        r.data = h,
                        delete r.encoding
                    } else if (r.compression)
                        continue;
                    var c = {
                        name: r.name,
                        x: r.x,
                        y: r.y,
                        width: r.width,
                        height: r.height,
                        widthInPixels: r.width * t.tilewidth,
                        heightInPixels: r.height * t.tileheight,
                        alpha: r.opacity,
                        visible: r.visible,
                        properties: {},
                        indexes: [],
                        callbacks: [],
                        bodies: []
                    };
                    r.properties && (c.properties = r.properties);
                    var d, u, p, g = 0, f = [], m = [], y = 0;
                    for (a = r.data.length; y < a; y++) {
                        if (u = !1,
                        p = d = 0,
                        536870912 < (P = r.data[y]))
                            switch (2147483648 < P && (P -= 2147483648,
                            p += 4),
                            1073741824 < P && (P -= 1073741824,
                            p += 2),
                            536870912 < P && (P -= 536870912,
                            p += 1),
                            p) {
                            case 5:
                                d = Math.PI / 2;
                                break;
                            case 6:
                                d = Math.PI;
                                break;
                            case 3:
                                d = 3 * Math.PI / 2;
                                break;
                            case 4:
                                u = !(d = 0);
                                break;
                            case 7:
                                d = Math.PI / 2,
                                u = !0;
                                break;
                            case 2:
                                d = Math.PI,
                                u = !0;
                                break;
                            case 1:
                                d = 3 * Math.PI / 2,
                                u = !0
                            }
                        if (0 < P)
                            (F = new H.Tile(c,P,g,m.length,t.tilewidth,t.tileheight)).rotation = d,
                            F.flipped = u,
                            0 !== p && (F.flippedVal = p),
                            f.push(F);
                        else
                            H.TilemapParser.INSERT_NULL ? f.push(null) : f.push(new H.Tile(c,-1,g,m.length,t.tilewidth,t.tileheight));
                        ++g === r.width && (m.push(f),
                        g = 0,
                        f = [])
                    }
                    c.data = m,
                    s.push(c)
                }
            i.layers = s;
            var v = [];
            for (n = 0; n < t.layers.length; n++)
                if ("imagelayer" === t.layers[n].type) {
                    var _ = t.layers[n]
                      , b = {
                        name: _.name,
                        image: _.image,
                        x: _.x,
                        y: _.y,
                        alpha: _.opacity,
                        visible: _.visible,
                        properties: {}
                    };
                    _.properties && (b.properties = _.properties),
                    v.push(b)
                }
            i.images = v;
            var w = []
              , x = []
              , S = null;
            for (n = 0; n < t.tilesets.length; n++) {
                if ((N = t.tilesets[n]).image) {
                    var T = new H.Tileset(N.name,N.firstgid,N.tilewidth,N.tileheight,N.margin,N.spacing,N.properties);
                    N.tileproperties && (T.tileProperties = N.tileproperties),
                    T.updateTileData(N.imagewidth, N.imageheight),
                    w.push(T)
                } else {
                    var A = new H.ImageCollection(N.name,N.firstgid,N.tilewidth,N.tileheight,N.margin,N.spacing,N.properties);
                    for (var C in N.tiles) {
                        b = N.tiles[C].image;
                        var P = N.firstgid + parseInt(C, 10);
                        A.addImage(P, b)
                    }
                    x.push(A)
                }
                S && (S.lastgid = N.firstgid - 1),
                S = N
            }
            i.tilesets = w,
            i.imagecollections = x;
            var E = {}
              , I = {};
            for (n = 0; n < t.layers.length; n++)
                if ("objectgroup" === t.layers[n].type) {
                    var k = t.layers[n];
                    E[k.name] = [],
                    I[k.name] = [];
                    var M = 0;
                    for (a = k.objects.length; M < a; M++)
                        if (k.objects[M].gid) {
                            var R = {
                                gid: k.objects[M].gid,
                                name: k.objects[M].name,
                                type: k.objects[M].hasOwnProperty("type") ? k.objects[M].type : "",
                                x: k.objects[M].x,
                                y: k.objects[M].y,
                                visible: k.objects[M].visible,
                                properties: k.objects[M].properties
                            };
                            k.objects[M].rotation && (R.rotation = k.objects[M].rotation),
                            E[k.name].push(R)
                        } else if (k.objects[M].polyline) {
                            R = {
                                name: k.objects[M].name,
                                type: k.objects[M].type,
                                x: k.objects[M].x,
                                y: k.objects[M].y,
                                width: k.objects[M].width,
                                height: k.objects[M].height,
                                visible: k.objects[M].visible,
                                properties: k.objects[M].properties
                            };
                            k.objects[M].rotation && (R.rotation = k.objects[M].rotation),
                            R.polyline = [];
                            for (var B = 0; B < k.objects[M].polyline.length; B++)
                                R.polyline.push([k.objects[M].polyline[B].x, k.objects[M].polyline[B].y]);
                            I[k.name].push(R),
                            E[k.name].push(R)
                        } else if (k.objects[M].polygon) {
                            (R = e(k.objects[M], ["name", "type", "x", "y", "visible", "rotation", "properties"])).polygon = [];
                            for (B = 0; B < k.objects[M].polygon.length; B++)
                                R.polygon.push([k.objects[M].polygon[B].x, k.objects[M].polygon[B].y]);
                            E[k.name].push(R)
                        } else if (k.objects[M].ellipse) {
                            R = e(k.objects[M], ["name", "type", "ellipse", "x", "y", "width", "height", "visible", "rotation", "properties"]);
                            E[k.name].push(R)
                        } else {
                            (R = e(k.objects[M], ["name", "type", "x", "y", "width", "height", "visible", "rotation", "properties"])).rectangle = !0,
                            E[k.name].push(R)
                        }
                }
            i.objects = E,
            i.collision = I,
            i.tiles = [];
            for (n = 0; n < i.tilesets.length; n++) {
                g = (N = i.tilesets[n]).tileMargin;
                var O = N.tileMargin
                  , L = 0
                  , G = 0
                  , D = 0;
                for (y = N.firstgid; y < N.firstgid + N.total && (i.tiles[y] = [g, O, n],
                g += N.tileWidth + N.tileSpacing,
                ++L !== N.total) && (++G !== N.columns || (g = N.tileMargin,
                O += N.tileHeight + N.tileSpacing,
                G = 0,
                ++D !== N.rows)); y++)
                    ;
            }
            var F, U, N;
            for (n = 0; n < i.layers.length; n++) {
                c = i.layers[n],
                N = null;
                for (l = 0; l < c.data.length; l++) {
                    f = c.data[l];
                    for (var W = 0; W < f.length; W++)
                        null === (F = f[W]) || F.index < 0 || (U = i.tiles[F.index][2],
                        (N = i.tilesets[U]).tileProperties && N.tileProperties[F.index - N.firstgid] && (F.properties = H.Utils.mixin(N.tileProperties[F.index - N.firstgid], F.properties)))
                }
            }
            return i
        }
    },
    H.Tileset = function(t, e, i, s, n, r, o) {
        (void 0 === i || i <= 0) && (i = 32),
        (void 0 === s || s <= 0) && (s = 32),
        void 0 === n && (n = 0),
        void 0 === r && (r = 0),
        this.name = t,
        this.firstgid = 0 | e,
        this.tileWidth = 0 | i,
        this.tileHeight = 0 | s,
        this.tileMargin = 0 | n,
        this.tileSpacing = 0 | r,
        this.properties = o || {},
        this.image = null,
        this.rows = 0,
        this.columns = 0,
        this.total = 0,
        this.drawCoords = []
    }
    ,
    H.Tileset.prototype = {
        draw: function(t, e, i, s) {
            var n = s - this.firstgid << 1;
            0 <= n && n + 1 < this.drawCoords.length && t.drawImage(this.image, this.drawCoords[n], this.drawCoords[n + 1], this.tileWidth, this.tileHeight, e, i, this.tileWidth, this.tileHeight)
        },
        containsTileIndex: function(t) {
            return t >= this.firstgid && t < this.firstgid + this.total
        },
        setImage: function(t) {
            this.image = t,
            this.updateTileData(t.width, t.height)
        },
        setSpacing: function(t, e) {
            this.tileMargin = 0 | t,
            this.tileSpacing = 0 | e,
            this.image && this.updateTileData(this.image.width, this.image.height)
        },
        updateTileData: function(t, e) {
            var i = (e - 2 * this.tileMargin + this.tileSpacing) / (this.tileHeight + this.tileSpacing)
              , s = (t - 2 * this.tileMargin + this.tileSpacing) / (this.tileWidth + this.tileSpacing);
            i = Math.floor(i),
            s = Math.floor(s),
            this.rows && this.rows !== i || this.columns && this.columns,
            this.rows = i,
            this.columns = s,
            this.total = i * s,
            this.drawCoords.length = 0;
            for (var n = this.tileMargin, r = this.tileMargin, o = 0; o < this.rows; o++) {
                for (var a = 0; a < this.columns; a++)
                    this.drawCoords.push(n),
                    this.drawCoords.push(r),
                    n += this.tileWidth + this.tileSpacing;
                n = this.tileMargin,
                r += this.tileHeight + this.tileSpacing
            }
        }
    },
    H.Tileset.prototype.constructor = H.Tileset,
    H.Particle = function(t, e, i, s, n) {
        H.Sprite.call(this, t, e, i, s, n),
        this.autoScale = !1,
        this.scaleData = null,
        this._s = 0,
        this.autoAlpha = !1,
        this.alphaData = null,
        this._a = 0
    }
    ,
    H.Particle.prototype = Object.create(H.Sprite.prototype),
    H.Particle.prototype.constructor = H.Particle,
    H.Particle.prototype.update = function() {
        this.autoScale && (this._s--,
        this._s ? this.scale.set(this.scaleData[this._s].x, this.scaleData[this._s].y) : this.autoScale = !1),
        this.autoAlpha && (this._a--,
        this._a ? this.alpha = this.alphaData[this._a].v : this.autoAlpha = !1)
    }
    ,
    H.Particle.prototype.onEmit = function() {}
    ,
    H.Particle.prototype.setAlphaData = function(t) {
        this.alphaData = t,
        this._a = t.length - 1,
        this.alpha = this.alphaData[this._a].v,
        this.autoAlpha = !0
    }
    ,
    H.Particle.prototype.setScaleData = function(t) {
        this.scaleData = t,
        this._s = t.length - 1,
        this.scale.set(this.scaleData[this._s].x, this.scaleData[this._s].y),
        this.autoScale = !0
    }
    ,
    H.Particle.prototype.reset = function(t, e, i) {
        return H.Component.Reset.prototype.reset.call(this, t, e, i),
        this.alpha = 1,
        this.scale.set(1),
        this.autoScale = !1,
        this.autoAlpha = !1,
        this
    }
    ,
    H.Particles = function(t) {
        this.game = t,
        this.emitters = {},
        this.ID = 0
    }
    ,
    H.Particles.prototype = {
        add: function(t) {
            return this.emitters[t.name] = t
        },
        remove: function(t) {
            delete this.emitters[t.name]
        },
        update: function() {
            for (var t in this.emitters)
                this.emitters[t].exists && this.emitters[t].update()
        }
    },
    H.Particles.prototype.constructor = H.Particles,
    H.Particles.Arcade = {},
    H.Particles.Arcade.Emitter = function(t, e, i, s) {
        this.maxParticles = s || 50,
        H.Group.call(this, t),
        this.name = "emitter" + this.game.particles.ID++,
        this.type = H.EMITTER,
        this.physicsType = H.GROUP,
        this.area = new H.Rectangle(e,i,1,1),
        this.minParticleSpeed = new H.Point(-100,-100),
        this.maxParticleSpeed = new H.Point(100,100),
        this.minParticleScale = 1,
        this.maxParticleScale = 1,
        this.scaleData = null,
        this.minRotation = -360,
        this.maxRotation = 360,
        this.minParticleAlpha = 1,
        this.maxParticleAlpha = 1,
        this.alphaData = null,
        this.gravity = 100,
        this.particleClass = H.Particle,
        this.particleDrag = new H.Point,
        this.angularDrag = 0,
        this.frequency = 100,
        this.lifespan = 2e3,
        this.bounce = new H.Point,
        this.on = !1,
        this.particleAnchor = new H.Point(.5,.5),
        this.blendMode = H.blendModes.NORMAL,
        this.emitX = e,
        this.emitY = i,
        this.autoScale = !1,
        this.autoAlpha = !1,
        this.particleBringToTop = !1,
        this.particleSendToBack = !1,
        this._minParticleScale = new H.Point(1,1),
        this._maxParticleScale = new H.Point(1,1),
        this._quantity = 0,
        this._timer = 0,
        this._counter = 0,
        this._flowQuantity = 0,
        this._flowTotal = 0,
        this._explode = !0,
        this._frames = null
    }
    ,
    H.Particles.Arcade.Emitter.prototype = Object.create(H.Group.prototype),
    H.Particles.Arcade.Emitter.prototype.constructor = H.Particles.Arcade.Emitter,
    H.Particles.Arcade.Emitter.prototype.update = function() {
        if (this.on && this.game.time.time >= this._timer)
            if (this._timer = this.game.time.time + this.frequency * this.game.time.slowMotion,
            0 !== this._flowTotal)
                if (0 < this._flowQuantity) {
                    for (var t = 0; t < this._flowQuantity; t++)
                        if (this.emitParticle() && (this._counter++,
                        -1 !== this._flowTotal && this._counter >= this._flowTotal)) {
                            this.on = !1;
                            break
                        }
                } else
                    this.emitParticle() && (this._counter++,
                    -1 !== this._flowTotal && this._counter >= this._flowTotal && (this.on = !1));
            else
                this.emitParticle() && (this._counter++,
                0 < this._quantity && this._counter >= this._quantity && (this.on = !1));
        for (t = this.children.length; t--; )
            this.children[t].exists && this.children[t].update()
    }
    ,
    H.Particles.Arcade.Emitter.prototype.makeParticles = function(t, e, i, s, n) {
        void 0 === e && (e = 0),
        void 0 === i && (i = this.maxParticles),
        void 0 === s && (s = !1),
        void 0 === n && (n = !1);
        var r, o = 0, a = t, h = e;
        for (this._frames = e,
        i > this.maxParticles && (this.maxParticles = i); o < i; )
            Array.isArray(t) && (a = this.game.rnd.pick(t)),
            Array.isArray(e) && (h = this.game.rnd.pick(e)),
            r = new this.particleClass(this.game,0,0,a,h),
            this.game.physics.arcade.enable(r, !1),
            s ? (r.body.checkCollision.any = !0,
            r.body.checkCollision.none = !1) : r.body.checkCollision.none = !0,
            r.body.collideWorldBounds = n,
            r.body.skipQuadTree = !0,
            r.exists = !1,
            r.visible = !1,
            r.anchor.copyFrom(this.particleAnchor),
            this.add(r),
            o++;
        return this
    }
    ,
    H.Particles.Arcade.Emitter.prototype.kill = function() {
        return this.on = !1,
        this.alive = !1,
        this.exists = !1,
        this
    }
    ,
    H.Particles.Arcade.Emitter.prototype.revive = function() {
        return this.alive = !0,
        this.exists = !0,
        this
    }
    ,
    H.Particles.Arcade.Emitter.prototype.explode = function(t, e) {
        return this._flowTotal = 0,
        this.start(!0, t, 0, e, !1),
        this
    }
    ,
    H.Particles.Arcade.Emitter.prototype.flow = function(t, e, i, s, n) {
        return void 0 !== i && 0 !== i || (i = 1),
        void 0 === s && (s = -1),
        void 0 === n && (n = !0),
        i > this.maxParticles && (i = this.maxParticles),
        this._counter = 0,
        this._flowQuantity = i,
        this._flowTotal = s,
        n ? (this.start(!0, t, e, i),
        this._counter += i,
        this.on = !0,
        this._timer = this.game.time.time + e * this.game.time.slowMotion) : this.start(!1, t, e, i),
        this
    }
    ,
    H.Particles.Arcade.Emitter.prototype.start = function(t, e, i, s, n) {
        if (void 0 === t && (t = !0),
        void 0 === e && (e = 0),
        null != i || (i = 250),
        void 0 === s && (s = 0),
        void 0 === n && (n = !1),
        s > this.maxParticles && (s = this.maxParticles),
        this.revive(),
        this.visible = !0,
        this.lifespan = e,
        this.frequency = i,
        t || n)
            for (var r = 0; r < s; r++)
                this.emitParticle();
        else
            this.on = !0,
            this._quantity = s,
            this._counter = 0,
            this._timer = this.game.time.time + i * this.game.time.slowMotion;
        return this
    }
    ,
    H.Particles.Arcade.Emitter.prototype.emitParticle = function(t, e, i, s) {
        void 0 === t && (t = null),
        void 0 === e && (e = null);
        var n = this.getFirstExists(!1);
        if (null === n)
            return !1;
        var r = this.game.rnd;
        void 0 !== i && void 0 !== s ? n.loadTexture(i, s) : void 0 !== i && n.loadTexture(i);
        var o = this.emitX
          , a = this.emitY;
        null !== t ? o = t : 1 < this.width && (o = r.between(this.left, this.right)),
        null !== e ? a = e : 1 < this.height && (a = r.between(this.top, this.bottom)),
        n.reset(o, a),
        n.angle = 0,
        n.lifespan = this.lifespan,
        this.particleBringToTop ? this.bringToTop(n) : this.particleSendToBack && this.sendToBack(n),
        this.autoScale ? n.setScaleData(this.scaleData) : 1 !== this.minParticleScale || 1 !== this.maxParticleScale ? n.scale.set(r.realInRange(this.minParticleScale, this.maxParticleScale)) : this._minParticleScale.x === this._maxParticleScale.x && this._minParticleScale.y === this._maxParticleScale.y || n.scale.set(r.realInRange(this._minParticleScale.x, this._maxParticleScale.x), r.realInRange(this._minParticleScale.y, this._maxParticleScale.y)),
        void 0 === s && (Array.isArray(this._frames) ? n.frame = this.game.rnd.pick(this._frames) : n.frame = this._frames),
        this.autoAlpha ? n.setAlphaData(this.alphaData) : n.alpha = r.realInRange(this.minParticleAlpha, this.maxParticleAlpha),
        n.blendMode = this.blendMode;
        var h = n.body;
        return h.updateBounds(),
        h.bounce.copyFrom(this.bounce),
        h.drag.copyFrom(this.particleDrag),
        h.velocity.x = r.between(this.minParticleSpeed.x, this.maxParticleSpeed.x),
        h.velocity.y = r.between(this.minParticleSpeed.y, this.maxParticleSpeed.y),
        h.angularVelocity = r.between(this.minRotation, this.maxRotation),
        h.gravity.y = this.gravity,
        h.angularDrag = this.angularDrag,
        n.onEmit(),
        !0
    }
    ,
    H.Particles.Arcade.Emitter.prototype.destroy = function() {
        this.game.particles.remove(this),
        H.Group.prototype.destroy.call(this, !0, !1)
    }
    ,
    H.Particles.Arcade.Emitter.prototype.setSize = function(t, e) {
        return this.area.width = t,
        this.area.height = e,
        this
    }
    ,
    H.Particles.Arcade.Emitter.prototype.setXSpeed = function(t, e) {
        return t = t || 0,
        e = e || 0,
        this.minParticleSpeed.x = t,
        this.maxParticleSpeed.x = e,
        this
    }
    ,
    H.Particles.Arcade.Emitter.prototype.setYSpeed = function(t, e) {
        return t = t || 0,
        e = e || 0,
        this.minParticleSpeed.y = t,
        this.maxParticleSpeed.y = e,
        this
    }
    ,
    H.Particles.Arcade.Emitter.prototype.setRotation = function(t, e) {
        return t = t || 0,
        e = e || 0,
        this.minRotation = t,
        this.maxRotation = e,
        this
    }
    ,
    H.Particles.Arcade.Emitter.prototype.setAlpha = function(t, e, i, s, n) {
        if (void 0 === t && (t = 1),
        void 0 === e && (e = 1),
        void 0 === i && (i = 0),
        void 0 === s && (s = H.Easing.Linear.None),
        void 0 === n && (n = !1),
        this.minParticleAlpha = t,
        this.maxParticleAlpha = e,
        this.autoAlpha = !1,
        0 < i && t !== e) {
            var r = {
                v: t
            }
              , o = this.game.make.tween(r).to({
                v: e
            }, i, s);
            o.yoyo(n),
            this.alphaData = o.generateData(60),
            this.alphaData.reverse(),
            this.autoAlpha = !0
        }
        return this
    }
    ,
    H.Particles.Arcade.Emitter.prototype.setScale = function(t, e, i, s, n, r, o) {
        if (void 0 === t && (t = 1),
        void 0 === e && (e = 1),
        void 0 === i && (i = 1),
        void 0 === s && (s = 1),
        void 0 === n && (n = 0),
        void 0 === r && (r = H.Easing.Linear.None),
        void 0 === o && (o = !1),
        this.minParticleScale = 1,
        this.maxParticleScale = 1,
        this._minParticleScale.set(t, i),
        this._maxParticleScale.set(e, s),
        this.autoScale = !1,
        0 < n && (t !== e || i !== s)) {
            var a = {
                x: t,
                y: i
            }
              , h = this.game.make.tween(a).to({
                x: e,
                y: s
            }, n, r);
            h.yoyo(o),
            this.scaleData = h.generateData(60),
            this.scaleData.reverse(),
            this.autoScale = !0
        }
        return this
    }
    ,
    H.Particles.Arcade.Emitter.prototype.at = function(t) {
        return t.center ? (this.emitX = t.center.x,
        this.emitY = t.center.y) : (this.emitX = t.world.x + t.anchor.x * t.width,
        this.emitY = t.world.y + t.anchor.y * t.height),
        this
    }
    ,
    Object.defineProperty(H.Particles.Arcade.Emitter.prototype, "width", {
        get: function() {
            return this.area.width
        },
        set: function(t) {
            this.area.width = t
        }
    }),
    Object.defineProperty(H.Particles.Arcade.Emitter.prototype, "height", {
        get: function() {
            return this.area.height
        },
        set: function(t) {
            this.area.height = t
        }
    }),
    Object.defineProperty(H.Particles.Arcade.Emitter.prototype, "x", {
        get: function() {
            return this.emitX
        },
        set: function(t) {
            this.emitX = t
        }
    }),
    Object.defineProperty(H.Particles.Arcade.Emitter.prototype, "y", {
        get: function() {
            return this.emitY
        },
        set: function(t) {
            this.emitY = t
        }
    }),
    Object.defineProperty(H.Particles.Arcade.Emitter.prototype, "left", {
        get: function() {
            return Math.floor(this.x - this.area.width / 2)
        }
    }),
    Object.defineProperty(H.Particles.Arcade.Emitter.prototype, "right", {
        get: function() {
            return Math.floor(this.x + this.area.width / 2)
        }
    }),
    Object.defineProperty(H.Particles.Arcade.Emitter.prototype, "top", {
        get: function() {
            return Math.floor(this.y - this.area.height / 2)
        }
    }),
    Object.defineProperty(H.Particles.Arcade.Emitter.prototype, "bottom", {
        get: function() {
            return Math.floor(this.y + this.area.height / 2)
        }
    }),
    H.Weapon = function(t, e) {
        H.Plugin.call(this, t, e),
        this.bullets = null,
        this.autoExpandBulletsGroup = !1,
        this.autofire = !1,
        this.shots = 0,
        this.fireLimit = 0,
        this.fireRate = 100,
        this.fireRateVariance = 0,
        this.fireFrom = new H.Rectangle(0,0,1,1),
        this.fireAngle = H.ANGLE_UP,
        this.bulletInheritSpriteSpeed = !1,
        this.bulletAnimation = "",
        this.bulletFrameRandom = !1,
        this.bulletFrameCycle = !1,
        this.bulletWorldWrap = !1,
        this.bulletWorldWrapPadding = 0,
        this.bulletAngleOffset = 0,
        this.bulletAngleVariance = 0,
        this.bulletSpeed = 200,
        this.bulletSpeedVariance = 0,
        this.bulletLifespan = 0,
        this.bulletKillDistance = 0,
        this.bulletGravity = new H.Point(0,0),
        this.bulletRotateToVelocity = !1,
        this.bulletKey = "",
        this.bulletFrame = "",
        this._bulletClass = H.Bullet,
        this._bulletCollideWorldBounds = !1,
        this._bulletKillType = H.Weapon.KILL_WORLD_BOUNDS,
        this._data = {
            customBody: !1,
            width: 0,
            height: 0,
            offsetX: 0,
            offsetY: 0
        },
        this.bounds = new H.Rectangle,
        this.bulletBounds = t.world.bounds,
        this.bulletFrames = [],
        this.bulletFrameIndex = 0,
        this.anims = {},
        this.onFire = new H.Signal,
        this.onKill = new H.Signal,
        this.onFireLimit = new H.Signal,
        this.trackedSprite = null,
        this.trackedPointer = null,
        this.trackRotation = !1,
        this.trackOffset = new H.Point,
        this._nextFire = 0,
        this._rotatedPoint = new H.Point
    }
    ,
    H.Weapon.prototype = Object.create(H.Plugin.prototype),
    H.Weapon.prototype.constructor = H.Weapon,
    H.Weapon.KILL_NEVER = 0,
    H.Weapon.KILL_LIFESPAN = 1,
    H.Weapon.KILL_DISTANCE = 2,
    H.Weapon.KILL_WEAPON_BOUNDS = 3,
    H.Weapon.KILL_CAMERA_BOUNDS = 4,
    H.Weapon.KILL_WORLD_BOUNDS = 5,
    H.Weapon.KILL_STATIC_BOUNDS = 6,
    H.Weapon.prototype.createBullets = function(t, e, i, s) {
        return void 0 === t && (t = 1),
        void 0 === s && (s = this.game.world),
        this.bullets || (this.bullets = this.game.add.physicsGroup(H.Physics.ARCADE, s),
        this.bullets.classType = this._bulletClass),
        0 !== t && (-1 === t && (this.autoExpandBulletsGroup = !0,
        t = 1),
        this.bullets.createMultiple(t, e, i),
        this.bullets.setAll("data.bulletManager", this),
        this.bulletKey = e,
        this.bulletFrame = i),
        this
    }
    ,
    H.Weapon.prototype.forEach = function(t, e) {
        return this.bullets.forEachExists(t, e, arguments),
        this
    }
    ,
    H.Weapon.prototype.pauseAll = function() {
        return this.bullets.setAll("body.enable", !1),
        this
    }
    ,
    H.Weapon.prototype.resumeAll = function() {
        return this.bullets.setAll("body.enable", !0),
        this
    }
    ,
    H.Weapon.prototype.killAll = function() {
        return this.bullets.callAllExists("kill", !0),
        this.bullets.setAll("body.enable", !0),
        this
    }
    ,
    H.Weapon.prototype.resetShots = function(t) {
        return void (this.shots = 0) !== t && (this.fireLimit = t),
        this
    }
    ,
    H.Weapon.prototype.destroy = function() {
        this.parent.remove(this, !1),
        this.bullets.destroy(),
        this.game = null,
        this.parent = null,
        this.active = !1,
        this.visible = !1
    }
    ,
    H.Weapon.prototype.update = function() {
        this._bulletKillType === H.Weapon.KILL_WEAPON_BOUNDS && (this.trackedSprite ? (this.trackedSprite.updateTransform(),
        this.bounds.centerOn(this.trackedSprite.worldPosition.x, this.trackedSprite.worldPosition.y)) : this.trackedPointer && this.bounds.centerOn(this.trackedPointer.worldX, this.trackedPointer.worldY)),
        this.autofire && this.fire()
    }
    ,
    H.Weapon.prototype.trackSprite = function(t, e, i, s) {
        return void 0 === e && (e = 0),
        void 0 === i && (i = 0),
        void 0 === s && (s = !1),
        this.trackedPointer = null,
        this.trackedSprite = t,
        this.trackRotation = s,
        this.trackOffset.set(e, i),
        this
    }
    ,
    H.Weapon.prototype.trackPointer = function(t, e, i) {
        return void 0 === t && (t = this.game.input.activePointer),
        void 0 === e && (e = 0),
        void 0 === i && (i = 0),
        this.trackedPointer = t,
        this.trackedSprite = null,
        this.trackRotation = !1,
        this.trackOffset.set(e, i),
        this
    }
    ,
    H.Weapon.prototype.fire = function(t, e, i) {
        if (this.game.time.now < this._nextFire || 0 < this.fireLimit && this.shots === this.fireLimit)
            return !1;
        var s = this.bulletSpeed;
        0 !== this.bulletSpeedVariance && (s += H.Math.between(-this.bulletSpeedVariance, this.bulletSpeedVariance)),
        t ? 1 < this.fireFrom.width ? this.fireFrom.centerOn(t.x, t.y) : (this.fireFrom.x = t.x,
        this.fireFrom.y = t.y) : this.trackedSprite ? (this.trackRotation ? (this._rotatedPoint.set(this.trackedSprite.world.x + this.trackOffset.x, this.trackedSprite.world.y + this.trackOffset.y),
        this._rotatedPoint.rotate(this.trackedSprite.world.x, this.trackedSprite.world.y, this.trackedSprite.rotation),
        1 < this.fireFrom.width ? this.fireFrom.centerOn(this._rotatedPoint.x, this._rotatedPoint.y) : (this.fireFrom.x = this._rotatedPoint.x,
        this.fireFrom.y = this._rotatedPoint.y)) : 1 < this.fireFrom.width ? this.fireFrom.centerOn(this.trackedSprite.world.x + this.trackOffset.x, this.trackedSprite.world.y + this.trackOffset.y) : (this.fireFrom.x = this.trackedSprite.world.x + this.trackOffset.x,
        this.fireFrom.y = this.trackedSprite.world.y + this.trackOffset.y),
        this.bulletInheritSpriteSpeed && (s += this.trackedSprite.body.speed)) : this.trackedPointer && (1 < this.fireFrom.width ? this.fireFrom.centerOn(this.trackedPointer.world.x + this.trackOffset.x, this.trackedPointer.world.y + this.trackOffset.y) : (this.fireFrom.x = this.trackedPointer.world.x + this.trackOffset.x,
        this.fireFrom.y = this.trackedPointer.world.y + this.trackOffset.y));
        var n = 1 < this.fireFrom.width ? this.fireFrom.randomX : this.fireFrom.x
          , r = 1 < this.fireFrom.height ? this.fireFrom.randomY : this.fireFrom.y
          , o = this.trackRotation ? this.trackedSprite.angle : this.fireAngle;
        void 0 !== e && void 0 !== i && (o = this.game.math.radToDeg(Math.atan2(i - r, e - n))),
        0 !== this.bulletAngleVariance && (o += H.Math.between(-this.bulletAngleVariance, this.bulletAngleVariance));
        var a = 0
          , h = 0;
        0 === o || 180 === o ? a = Math.cos(this.game.math.degToRad(o)) * s : h = (90 === o || 270 === o || (a = Math.cos(this.game.math.degToRad(o)) * s),
        Math.sin(this.game.math.degToRad(o)) * s);
        var l = null;
        if (this.autoExpandBulletsGroup ? (l = this.bullets.getFirstExists(!1, !0, n, r, this.bulletKey, this.bulletFrame)).data.bulletManager = this : l = this.bullets.getFirstExists(!1),
        l) {
            if (l.reset(n, r),
            l.data.fromX = n,
            l.data.fromY = r,
            l.data.killType = this.bulletKillType,
            l.data.killDistance = this.bulletKillDistance,
            l.data.rotateToVelocity = this.bulletRotateToVelocity,
            this.bulletKillType === H.Weapon.KILL_LIFESPAN && (l.lifespan = this.bulletLifespan),
            l.angle = o + this.bulletAngleOffset,
            "" !== this.bulletAnimation) {
                if (null === l.animations.getAnimation(this.bulletAnimation)) {
                    var c = this.anims[this.bulletAnimation];
                    l.animations.add(c.name, c.frames, c.frameRate, c.loop, c.useNumericIndex)
                }
                l.animations.play(this.bulletAnimation)
            } else
                this.bulletFrameCycle ? (l.frame = this.bulletFrames[this.bulletFrameIndex],
                ++this.bulletFrameIndex >= this.bulletFrames.length && (this.bulletFrameIndex = 0)) : this.bulletFrameRandom && (l.frame = this.bulletFrames[Math.floor(Math.random() * this.bulletFrames.length)]);
            if (l.data.bodyDirty && (this._data.customBody && l.body.setSize(this._data.width, this._data.height, this._data.offsetX, this._data.offsetY),
            l.body.collideWorldBounds = this.bulletCollideWorldBounds,
            l.data.bodyDirty = !1),
            l.body.velocity.set(a, h),
            l.body.gravity.set(this.bulletGravity.x, this.bulletGravity.y),
            0 !== this.bulletSpeedVariance) {
                var d = this.fireRate;
                (d += H.Math.between(-this.fireRateVariance, this.fireRateVariance)) < 0 && (d = 0),
                this._nextFire = this.game.time.now + d
            } else
                this._nextFire = this.game.time.now + this.fireRate;
            this.shots++,
            this.onFire.dispatch(l, this, s),
            0 < this.fireLimit && this.shots === this.fireLimit && this.onFireLimit.dispatch(this, this.fireLimit)
        }
        return l
    }
    ,
    H.Weapon.prototype.fireAtPointer = function(t) {
        return void 0 === t && (t = this.game.input.activePointer),
        this.fire(null, t.worldX, t.worldY)
    }
    ,
    H.Weapon.prototype.fireAtSprite = function(t) {
        return this.fire(null, t.world.x, t.world.y)
    }
    ,
    H.Weapon.prototype.fireAtXY = function(t, e) {
        return this.fire(null, t, e)
    }
    ,
    H.Weapon.prototype.setBulletBodyOffset = function(t, e, i, s) {
        return void 0 === i && (i = 0),
        void 0 === s && (s = 0),
        this._data.customBody = !0,
        this._data.width = t,
        this._data.height = e,
        this._data.offsetX = i,
        this._data.offsetY = s,
        this.bullets.callAll("body.setSize", "body", t, e, i, s),
        this.bullets.setAll("data.bodyDirty", !1),
        this
    }
    ,
    H.Weapon.prototype.setBulletFrames = function(t, e, i, s) {
        return void 0 === i && (i = !0),
        void 0 === s && (s = !1),
        this.bulletFrames = H.ArrayUtils.numberArray(t, e),
        this.bulletFrameIndex = 0,
        this.bulletFrameCycle = i,
        this.bulletFrameRandom = s,
        this
    }
    ,
    H.Weapon.prototype.addBulletAnimation = function(t, e, i, s, n) {
        return this.anims[t] = {
            name: t,
            frames: e,
            frameRate: i,
            loop: s,
            useNumericIndex: n
        },
        this.bullets.callAll("animations.add", "animations", t, e, i, s, n),
        this.bulletAnimation = t,
        this
    }
    ,
    H.Weapon.prototype.debug = function(t, e, i) {
        void 0 === t && (t = 16),
        void 0 === e && (e = 32),
        void 0 === i && (i = !1),
        this.game.debug.text("Weapon Plugin", t, e),
        this.game.debug.text("Bullets Alive: " + this.bullets.total + " - Total: " + this.bullets.length, t, e + 24),
        i && this.bullets.forEachExists(this.game.debug.body, this.game.debug, "rgba(255, 0, 255, 0.8)")
    }
    ,
    Object.defineProperty(H.Weapon.prototype, "bulletClass", {
        get: function() {
            return this._bulletClass
        },
        set: function(t) {
            this._bulletClass = t,
            this.bullets.classType = this._bulletClass
        }
    }),
    Object.defineProperty(H.Weapon.prototype, "bulletKillType", {
        get: function() {
            return this._bulletKillType
        },
        set: function(t) {
            switch (t) {
            case H.Weapon.KILL_STATIC_BOUNDS:
            case H.Weapon.KILL_WEAPON_BOUNDS:
                this.bulletBounds = this.bounds;
                break;
            case H.Weapon.KILL_CAMERA_BOUNDS:
                this.bulletBounds = this.game.camera.view;
                break;
            case H.Weapon.KILL_WORLD_BOUNDS:
                this.bulletBounds = this.game.world.bounds
            }
            this._bulletKillType = t
        }
    }),
    Object.defineProperty(H.Weapon.prototype, "bulletCollideWorldBounds", {
        get: function() {
            return this._bulletCollideWorldBounds
        },
        set: function(t) {
            this._bulletCollideWorldBounds = t,
            this.bullets.setAll("body.collideWorldBounds", t),
            this.bullets.setAll("data.bodyDirty", !1)
        }
    }),
    Object.defineProperty(H.Weapon.prototype, "x", {
        get: function() {
            return this.fireFrom.x
        },
        set: function(t) {
            this.fireFrom.x = t
        }
    }),
    Object.defineProperty(H.Weapon.prototype, "y", {
        get: function() {
            return this.fireFrom.y
        },
        set: function(t) {
            this.fireFrom.y = t
        }
    }),
    H.Bullet = function(t, e, i, s, n) {
        H.Sprite.call(this, t, e, i, s, n),
        this.anchor.set(.5),
        this.data = {
            bulletManager: null,
            fromX: 0,
            fromY: 0,
            bodyDirty: !0,
            rotateToVelocity: !1,
            killType: 0,
            killDistance: 0
        }
    }
    ,
    H.Bullet.prototype = Object.create(H.Sprite.prototype),
    H.Bullet.prototype.constructor = H.Bullet,
    H.Bullet.prototype.kill = function() {
        return this.alive = !1,
        this.exists = !1,
        this.visible = !1,
        this.data.bulletManager.onKill.dispatch(this),
        this
    }
    ,
    H.Bullet.prototype.update = function() {
        this.exists && (this.data.killType > H.Weapon.KILL_LIFESPAN && (this.data.killType === H.Weapon.KILL_DISTANCE ? this.game.physics.arcade.distanceToXY(this, this.data.fromX, this.data.fromY, !0) > this.data.killDistance && this.kill() : this.data.bulletManager.bulletBounds.intersects(this) || this.kill()),
        this.data.rotateToVelocity && (this.rotation = Math.atan2(this.body.velocity.y, this.body.velocity.x)),
        this.data.bulletManager.bulletWorldWrap && this.game.world.wrap(this, this.data.bulletManager.bulletWorldWrapPadding))
    }
    ,
    H.Video = function(t, e, i) {
        if (void 0 === e && (e = null),
        void 0 === i && (i = null),
        this.game = t,
        this.key = e,
        this.width = 0,
        this.height = 0,
        this.type = H.VIDEO,
        this.disableTextureUpload = !1,
        this.touchLocked = !1,
        this.onPlay = new H.Signal,
        this.onChangeSource = new H.Signal,
        this.onComplete = new H.Signal,
        this.onAccess = new H.Signal,
        this.onError = new H.Signal,
        this.onTimeout = new H.Signal,
        this.timeout = 15e3,
        this._timeOutID = null,
        this.video = null,
        this.videoStream = null,
        this.isStreaming = !1,
        this.retryLimit = 20,
        this.retry = 0,
        this.retryInterval = 500,
        this._retryID = null,
        this._codeMuted = !1,
        this._muted = !1,
        this._codePaused = !1,
        this._paused = !1,
        this._pending = !1,
        this._autoplay = !1,
        this._endCallback = null,
        this._playCallback = null,
        e && this.game.cache.checkVideoKey(e)) {
            var s = this.game.cache.getVideo(e);
            s.isBlob ? this.createVideoFromBlob(s.data) : this.video = s.data,
            this.width = this.video.videoWidth,
            this.height = this.video.videoHeight
        } else
            i && this.createVideoFromURL(i, !1);
        this.video && !i ? this.baseTexture = new PIXI.BaseTexture(this.video) : this.baseTexture = new PIXI.BaseTexture(H.Cache.DEFAULT.baseTexture.source),
        this.baseTexture.forceLoaded(this.width, this.height),
        this.texture = new PIXI.Texture(this.baseTexture),
        this.textureFrame = new H.Frame(0,0,0,this.width,this.height,"video"),
        this.texture.setFrame(this.textureFrame),
        this.texture.valid = !1,
        null !== e && this.video && (this.texture.valid = this.video.canplay),
        this.snapshot = null,
        H.BitmapData && (this.snapshot = new H.BitmapData(this.game,"",this.width,this.height)),
        !this.game.device.cocoonJS && (this.game.device.iOS || this.game.device.chrome) || window.PhaserGlobal && window.PhaserGlobal.fakeiOSTouchLock ? this.setTouchLock() : s && (s.locked = !1)
    }
    ,
    H.Video.prototype = {
        connectToMediaStream: function(t, e) {
            return t && e && (this.video = t,
            this.videoStream = e,
            this.isStreaming = !0,
            this.baseTexture.source = this.video,
            this.updateTexture(null, this.video.videoWidth, this.video.videoHeight),
            this.onAccess.dispatch(this)),
            this
        },
        startMediaStream: function(t, e, i) {
            if (void 0 === t && (t = !1),
            void 0 === e && (e = null),
            void 0 === i && (i = null),
            !this.game.device.getUserMedia)
                return this.onError.dispatch(this, "No getUserMedia"),
                !1;
            null !== this.videoStream && (this.videoStream.active ? this.videoStream.active = !1 : this.videoStream.stop()),
            this.removeVideoElement(),
            this.video = document.createElement("video"),
            this.video.setAttribute("autoplay", "autoplay"),
            null !== e && (this.video.width = e),
            null !== i && (this.video.height = i),
            this._timeOutID = window.setTimeout(this.getUserMediaTimeout.bind(this), this.timeout);
            try {
                navigator.getUserMedia({
                    audio: t,
                    video: !0
                }, this.getUserMediaSuccess.bind(this), this.getUserMediaError.bind(this))
            } catch (t) {
                this.getUserMediaError(t)
            }
            return this
        },
        getUserMediaTimeout: function() {
            clearTimeout(this._timeOutID),
            this.onTimeout.dispatch(this)
        },
        getUserMediaError: function(t) {
            clearTimeout(this._timeOutID),
            this.onError.dispatch(this, t)
        },
        getUserMediaSuccess: function(t) {
            clearTimeout(this._timeOutID),
            this.videoStream = t,
            void 0 !== this.video.mozSrcObject ? this.video.mozSrcObject = t : this.video.src = window.URL && window.URL.createObjectURL(t) || t;
            var n = this;
            this.video.onloadeddata = function() {
                var s = 10;
                !function t() {
                    if (0 < s)
                        if (0 < n.video.videoWidth) {
                            var e = n.video.videoWidth
                              , i = n.video.videoHeight;
                            isNaN(n.video.videoHeight) && (i = e / (4 / 3)),
                            n.video.play(),
                            n.isStreaming = !0,
                            n.baseTexture.source = n.video,
                            n.updateTexture(null, e, i),
                            n.onAccess.dispatch(n)
                        } else
                            window.setTimeout(t, 500);
                    s--
                }()
            }
        },
        createVideoFromBlob: function(t) {
            var e = this;
            return this.video = document.createElement("video"),
            this.video.controls = !1,
            this.video.setAttribute("autoplay", "autoplay"),
            this.video.addEventListener("loadeddata", function(t) {
                e.updateTexture(t)
            }, !0),
            this.video.src = window.URL.createObjectURL(t),
            this.video.canplay = !0,
            this
        },
        createVideoFromURL: function(t, e) {
            return void 0 === e && (e = !1),
            this.texture && (this.texture.valid = !1),
            this.video = document.createElement("video"),
            this.video.controls = !1,
            e && this.video.setAttribute("autoplay", "autoplay"),
            this.video.src = t,
            this.video.canplay = !0,
            this.video.load(),
            this.retry = this.retryLimit,
            this._retryID = window.setTimeout(this.checkVideoProgress.bind(this), this.retryInterval),
            this.key = t,
            this
        },
        updateTexture: function(t, e, i) {
            var s = !1;
            null != e || (e = this.video.videoWidth,
            s = !0),
            null != i || (i = this.video.videoHeight),
            this.width = e,
            this.height = i,
            this.baseTexture.source !== this.video && (this.baseTexture.source = this.video),
            this.baseTexture.forceLoaded(e, i),
            this.texture.frame.resize(e, i),
            this.texture.width = e,
            this.texture.height = i,
            this.texture.valid = !0,
            this.snapshot && this.snapshot.resize(e, i),
            s && null !== this.key && (this.onChangeSource.dispatch(this, e, i),
            this._autoplay && (this.video.play(),
            this.onPlay.dispatch(this, this.loop, this.playbackRate)))
        },
        complete: function() {
            this.onComplete.dispatch(this)
        },
        play: function(t, e) {
            return void 0 === t && (t = !1),
            void 0 === e && (e = 1),
            this.game.sound.onMute && (this.game.sound.onMute.add(this.setMute, this),
            this.game.sound.onUnMute.add(this.unsetMute, this),
            this.game.sound.mute && this.setMute()),
            this.game.onPause.add(this.setPause, this),
            this.game.onResume.add(this.setResume, this),
            this._endCallback = this.complete.bind(this),
            this.video.addEventListener("ended", this._endCallback, !0),
            this.video.addEventListener("webkitendfullscreen", this._endCallback, !0),
            this.video.loop = t ? "loop" : "",
            this.video.playbackRate = e,
            this.touchLocked ? this._pending = !0 : (this._pending = !1,
            null !== this.key && (4 !== this.video.readyState ? (this.retry = this.retryLimit,
            this._retryID = window.setTimeout(this.checkVideoProgress.bind(this), this.retryInterval)) : (this._playCallback = this.playHandler.bind(this),
            this.video.addEventListener("playing", this._playCallback, !0))),
            this.video.play(),
            this.onPlay.dispatch(this, t, e)),
            this
        },
        playHandler: function() {
            this.video.removeEventListener("playing", this._playCallback, !0),
            this.updateTexture()
        },
        stop: function() {
            return this.game.sound.onMute && (this.game.sound.onMute.remove(this.setMute, this),
            this.game.sound.onUnMute.remove(this.unsetMute, this)),
            this.game.onPause.remove(this.setPause, this),
            this.game.onResume.remove(this.setResume, this),
            this.isStreaming ? (this.video.mozSrcObject ? (this.video.mozSrcObject.stop(),
            this.video.src = null) : (this.video.src = "",
            this.videoStream.active ? this.videoStream.active = !1 : this.videoStream.getTracks ? this.videoStream.getTracks().forEach(function(t) {
                t.stop()
            }) : this.videoStream.stop()),
            this.videoStream = null,
            this.isStreaming = !1) : (this.video.removeEventListener("ended", this._endCallback, !0),
            this.video.removeEventListener("webkitendfullscreen", this._endCallback, !0),
            this.video.removeEventListener("playing", this._playCallback, !0),
            this.touchLocked ? this._pending = !1 : this.video.pause()),
            this
        },
        add: function(t) {
            if (Array.isArray(t))
                for (var e = 0; e < t.length; e++)
                    t[e].loadTexture && t[e].loadTexture(this);
            else
                t.loadTexture(this);
            return this
        },
        addToWorld: function(t, e, i, s, n, r) {
            n = n || 1,
            r = r || 1;
            var o = this.game.add.image(t, e, this);
            return o.anchor.set(i, s),
            o.scale.set(n, r),
            o
        },
        render: function() {
            !this.disableTextureUpload && this.playing && this.baseTexture.dirty()
        },
        setMute: function() {
            this._muted || (this._muted = !0,
            this.video.muted = !0)
        },
        unsetMute: function() {
            this._muted && !this._codeMuted && (this._muted = !1,
            this.video.muted = !1)
        },
        setPause: function() {
            this._paused || this.touchLocked || (this._paused = !0,
            this.video.pause())
        },
        setResume: function() {
            !this._paused || this._codePaused || this.touchLocked || (this._paused = !1,
            this.video.ended || this.video.play())
        },
        changeSource: function(t, e) {
            return void 0 === e && (e = !0),
            this.texture.valid = !1,
            this.video.pause(),
            this.retry = this.retryLimit,
            this._retryID = window.setTimeout(this.checkVideoProgress.bind(this), this.retryInterval),
            this.video.src = t,
            this.video.load(),
            (this._autoplay = e) || (this.paused = !0),
            this
        },
        checkVideoProgress: function() {
            4 === this.video.readyState ? this.updateTexture() : (this.retry--,
            0 < this.retry && (this._retryID = window.setTimeout(this.checkVideoProgress.bind(this), this.retryInterval)))
        },
        setTouchLock: function() {
            this.game.input.touch.addTouchLockCallback(this.unlock, this),
            this.touchLocked = !0
        },
        unlock: function() {
            if (this.touchLocked = !1,
            this.video.play(),
            this.onPlay.dispatch(this, this.loop, this.playbackRate),
            this.key) {
                var t = this.game.cache.getVideo(this.key);
                t && !t.isBlob && (t.locked = !1)
            }
            return !0
        },
        grab: function(t, e, i) {
            return void 0 === t && (t = !1),
            void 0 === e && (e = 1),
            void 0 === i && (i = null),
            null === this.snapshot ? void 0 : (t && this.snapshot.cls(),
            this.snapshot.copy(this.video, 0, 0, this.width, this.height, 0, 0, this.width, this.height, 0, 0, 0, 1, 1, e, i),
            this.snapshot)
        },
        removeVideoElement: function() {
            if (this.video) {
                for (this.video.parentNode && this.video.parentNode.removeChild(this.video); this.video.hasChildNodes(); )
                    this.video.removeChild(this.video.firstChild);
                this.video.removeAttribute("autoplay"),
                this.video.removeAttribute("src"),
                this.video = null
            }
        },
        destroy: function() {
            this.stop(),
            this.removeVideoElement(),
            this.touchLocked && this.game.input.touch.removeTouchLockCallback(this.unlock, this),
            this._retryID && window.clearTimeout(this._retryID)
        }
    },
    Object.defineProperty(H.Video.prototype, "currentTime", {
        get: function() {
            return this.video ? this.video.currentTime : 0
        },
        set: function(t) {
            this.video.currentTime = t
        }
    }),
    Object.defineProperty(H.Video.prototype, "duration", {
        get: function() {
            return this.video ? this.video.duration : 0
        }
    }),
    Object.defineProperty(H.Video.prototype, "progress", {
        get: function() {
            return this.video ? this.video.currentTime / this.video.duration : 0
        }
    }),
    Object.defineProperty(H.Video.prototype, "mute", {
        get: function() {
            return this._muted
        },
        set: function(t) {
            if (t = t || null) {
                if (this._muted)
                    return;
                this._codeMuted = !0,
                this.setMute()
            } else {
                if (!this._muted)
                    return;
                this._codeMuted = !1,
                this.unsetMute()
            }
        }
    }),
    Object.defineProperty(H.Video.prototype, "paused", {
        get: function() {
            return this._paused
        },
        set: function(t) {
            if (t = t || null,
            !this.touchLocked)
                if (t) {
                    if (this._paused)
                        return;
                    this._codePaused = !0,
                    this.setPause()
                } else {
                    if (!this._paused)
                        return;
                    this._codePaused = !1,
                    this.setResume()
                }
        }
    }),
    Object.defineProperty(H.Video.prototype, "volume", {
        get: function() {
            return this.video ? this.video.volume : 1
        },
        set: function(t) {
            t < 0 ? t = 0 : 1 < t && (t = 1),
            this.video && (this.video.volume = t)
        }
    }),
    Object.defineProperty(H.Video.prototype, "playbackRate", {
        get: function() {
            return this.video ? this.video.playbackRate : 1
        },
        set: function(t) {
            this.video && (this.video.playbackRate = t)
        }
    }),
    Object.defineProperty(H.Video.prototype, "loop", {
        get: function() {
            return !!this.video && this.video.loop
        },
        set: function(t) {
            t && this.video ? this.video.loop = "loop" : this.video && (this.video.loop = "")
        }
    }),
    Object.defineProperty(H.Video.prototype, "playing", {
        get: function() {
            return !(this.video.paused && this.video.ended)
        }
    }),
    H.Video.prototype.constructor = H.Video,
    void 0 === PIXI.blendModes && (PIXI.blendModes = H.blendModes),
    void 0 === PIXI.scaleModes && (PIXI.scaleModes = H.scaleModes),
    void 0 === PIXI.Texture.emptyTexture && (PIXI.Texture.emptyTexture = new PIXI.Texture(new PIXI.BaseTexture)),
    void 0 === PIXI.DisplayObject._tempMatrix && (PIXI.DisplayObject._tempMatrix = new PIXI.Matrix),
    void 0 === PIXI.RenderTexture.tempMatrix && (PIXI.RenderTexture.tempMatrix = new PIXI.Matrix),
    PIXI.Graphics && void 0 === PIXI.Graphics.POLY && (PIXI.Graphics.POLY = H.POLYGON,
    PIXI.Graphics.RECT = H.RECTANGLE,
    PIXI.Graphics.CIRC = H.CIRCLE,
    PIXI.Graphics.ELIP = H.ELLIPSE,
    PIXI.Graphics.RREC = H.ROUNDEDRECTANGLE),
    PIXI.TextureSilentFail = !0,
    "undefined" != typeof exports ? ("undefined" != typeof module && module.exports && (exports = module.exports = H),
    exports.Phaser = H) : "undefined" != typeof define && define.amd ? define("Phaser", t.Phaser = H) : t.Phaser = H,
    H
}
.call(this),
function(t, e) {
    "object" == typeof exports && "undefined" != typeof module ? e(exports) : "function" == typeof define && define.amd ? define(["exports"], e) : e(t.h5branding = t.h5branding || {})
}(this, function(h) {
    "use strict";
    var U = "undefined" != typeof globalThis ? globalThis : "undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : {};
    function d() {
        throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")
    }
    function t(t, e) {
        return t(e = {
            exports: {}
        }, e.exports),
        e.exports
    }
    var e, n;
    t(function(t, e) {
        t.exports = function() {
            function h(t) {
                return "function" == typeof t
            }
            var i = Array.isArray ? Array.isArray : function(t) {
                return "[object Array]" === Object.prototype.toString.call(t)
            }
              , s = 0
              , e = void 0
              , n = void 0
              , a = function(t, e) {
                u[s] = t,
                u[s + 1] = e,
                2 === (s += 2) && (n ? n(p) : v())
            }
              , t = "undefined" != typeof window ? window : void 0
              , r = t || {}
              , o = r.MutationObserver || r.WebKitMutationObserver
              , l = "undefined" == typeof self && "undefined" != typeof process && "[object process]" === {}.toString.call(process)
              , c = "undefined" != typeof Uint8ClampedArray && "undefined" != typeof importScripts && "undefined" != typeof MessageChannel;
            function d() {
                var t = setTimeout;
                return function() {
                    return t(p, 1)
                }
            }
            var u = new Array(1e3);
            function p() {
                for (var t = 0; t < s; t += 2) {
                    var e = u[t]
                      , i = u[t + 1];
                    e(i),
                    u[t] = void 0,
                    u[t + 1] = void 0
                }
                s = 0
            }
            var g, f, m, y, v = void 0;
            function _(t, e) {
                var i = this
                  , s = new this.constructor(x);
                void 0 === s[w] && G(s);
                var n = i._state;
                if (n) {
                    var r = arguments[n - 1];
                    a(function() {
                        return O(n, s, r, i._result)
                    })
                } else
                    R(i, s, t, e);
                return s
            }
            function b(t) {
                if (t && "object" == typeof t && t.constructor === this)
                    return t;
                var e = new this(x);
                return E(e, t),
                e
            }
            v = l ? function() {
                return process.nextTick(p)
            }
            : o ? (f = 0,
            m = new o(p),
            y = document.createTextNode(""),
            m.observe(y, {
                characterData: !0
            }),
            function() {
                y.data = f = ++f % 2
            }
            ) : c ? ((g = new MessageChannel).port1.onmessage = p,
            function() {
                return g.port2.postMessage(0)
            }
            ) : void 0 === t ? function() {
                try {
                    var t = Function("return this")().require("vertx");
                    return void 0 === (e = t.runOnLoop || t.runOnContext) ? d() : function() {
                        e(p)
                    }
                } catch (t) {
                    return d()
                }
            }() : d();
            var w = Math.random().toString(36).substring(2);
            function x() {}
            var S = void 0
              , T = 1
              , A = 2;
            function C(t, e, i, s) {
                try {
                    t.call(e, i, s)
                } catch (t) {
                    return t
                }
            }
            function P(t, e, i) {
                var s, n, r, o;
                e.constructor === t.constructor && i === _ && e.constructor.resolve === b ? (r = t,
                (o = e)._state === T ? k(r, o._result) : o._state === A ? M(r, o._result) : R(o, void 0, function(t) {
                    return E(r, t)
                }, function(t) {
                    return M(r, t)
                })) : void 0 === i ? k(t, e) : h(i) ? (s = e,
                n = i,
                a(function(e) {
                    var i = !1
                      , t = C(n, s, function(t) {
                        i || (i = !0,
                        s !== t ? E(e, t) : k(e, t))
                    }, function(t) {
                        i || (i = !0,
                        M(e, t))
                    }, e._label);
                    !i && t && (i = !0,
                    M(e, t))
                }, t)) : k(t, e)
            }
            function E(e, t) {
                if (e === t)
                    M(e, new TypeError("You cannot resolve a promise with itself"));
                else if (n = typeof (s = t),
                null === s || "object" !== n && "function" !== n)
                    k(e, t);
                else {
                    var i = void 0;
                    try {
                        i = t.then
                    } catch (t) {
                        return void M(e, t)
                    }
                    P(e, t, i)
                }
                var s, n
            }
            function I(t) {
                t._onerror && t._onerror(t._result),
                B(t)
            }
            function k(t, e) {
                t._state === S && (t._result = e,
                t._state = T,
                0 !== t._subscribers.length && a(B, t))
            }
            function M(t, e) {
                t._state === S && (t._state = A,
                t._result = e,
                a(I, t))
            }
            function R(t, e, i, s) {
                var n = t._subscribers
                  , r = n.length;
                t._onerror = null,
                n[r] = e,
                n[r + T] = i,
                n[r + A] = s,
                0 === r && t._state && a(B, t)
            }
            function B(t) {
                var e = t._subscribers
                  , i = t._state;
                if (0 !== e.length) {
                    for (var s = void 0, n = void 0, r = t._result, o = 0; o < e.length; o += 3)
                        s = e[o],
                        n = e[o + i],
                        s ? O(i, s, n, r) : n(r);
                    t._subscribers.length = 0
                }
            }
            function O(t, e, i, s) {
                var n = h(i)
                  , r = void 0
                  , o = void 0
                  , a = !0;
                if (n) {
                    try {
                        r = i(s)
                    } catch (t) {
                        a = !1,
                        o = t
                    }
                    if (e === r)
                        return void M(e, new TypeError("A promises callback cannot return that same promise."))
                } else
                    r = s;
                e._state !== S || (n && a ? E(e, r) : !1 === a ? M(e, o) : t === T ? k(e, r) : t === A && M(e, r))
            }
            var L = 0;
            function G(t) {
                t[w] = L++,
                t._state = void 0,
                t._result = void 0,
                t._subscribers = []
            }
            var D = function() {
                function t(t, e) {
                    this._instanceConstructor = t,
                    this.promise = new t(x),
                    this.promise[w] || G(this.promise),
                    i(e) ? (this.length = e.length,
                    this._remaining = e.length,
                    this._result = new Array(this.length),
                    0 === this.length ? k(this.promise, this._result) : (this.length = this.length || 0,
                    this._enumerate(e),
                    0 === this._remaining && k(this.promise, this._result))) : M(this.promise, new Error("Array Methods must be provided an Array"))
                }
                return t.prototype._enumerate = function(t) {
                    for (var e = 0; this._state === S && e < t.length; e++)
                        this._eachEntry(t[e], e)
                }
                ,
                t.prototype._eachEntry = function(e, t) {
                    var i = this._instanceConstructor
                      , s = i.resolve;
                    if (s === b) {
                        var n = void 0
                          , r = void 0
                          , o = !1;
                        try {
                            n = e.then
                        } catch (t) {
                            o = !0,
                            r = t
                        }
                        if (n === _ && e._state !== S)
                            this._settledAt(e._state, t, e._result);
                        else if ("function" != typeof n)
                            this._remaining--,
                            this._result[t] = e;
                        else if (i === F) {
                            var a = new i(x);
                            o ? M(a, r) : P(a, e, n),
                            this._willSettleAt(a, t)
                        } else
                            this._willSettleAt(new i(function(t) {
                                return t(e)
                            }
                            ), t)
                    } else
                        this._willSettleAt(s(e), t)
                }
                ,
                t.prototype._settledAt = function(t, e, i) {
                    var s = this.promise;
                    s._state === S && (this._remaining--,
                    t === A ? M(s, i) : this._result[e] = i),
                    0 === this._remaining && k(s, this._result)
                }
                ,
                t.prototype._willSettleAt = function(t, e) {
                    var i = this;
                    R(t, void 0, function(t) {
                        return i._settledAt(T, e, t)
                    }, function(t) {
                        return i._settledAt(A, e, t)
                    })
                }
                ,
                t
            }()
              , F = function() {
                function e(t) {
                    this[w] = L++,
                    this._result = this._state = void 0,
                    this._subscribers = [],
                    x !== t && ("function" != typeof t && function() {
                        throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")
                    }(),
                    this instanceof e ? function(e, t) {
                        try {
                            t(function(t) {
                                E(e, t)
                            }, function(t) {
                                M(e, t)
                            })
                        } catch (t) {
                            M(e, t)
                        }
                    }(this, t) : function() {
                        throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")
                    }())
                }
                return e.prototype.catch = function(t) {
                    return this.then(null, t)
                }
                ,
                e.prototype.finally = function(e) {
                    var i = this.constructor;
                    return h(e) ? this.then(function(t) {
                        return i.resolve(e()).then(function() {
                            return t
                        })
                    }, function(t) {
                        return i.resolve(e()).then(function() {
                            throw t
                        })
                    }) : this.then(e, e)
                }
                ,
                e
            }();
            return F.prototype.then = _,
            F.all = function(t) {
                return new D(this,t).promise
            }
            ,
            F.race = function(n) {
                var r = this;
                return i(n) ? new r(function(t, e) {
                    for (var i = n.length, s = 0; s < i; s++)
                        r.resolve(n[s]).then(t, e)
                }
                ) : new r(function(t, e) {
                    return e(new TypeError("You must pass an array to race."))
                }
                )
            }
            ,
            F.resolve = b,
            F.reject = function(t) {
                var e = new this(x);
                return M(e, t),
                e
            }
            ,
            F._setScheduler = function(t) {
                n = t
            }
            ,
            F._setAsap = function(t) {
                a = t
            }
            ,
            F._asap = a,
            F.polyfill = function() {
                var t = void 0;
                if (void 0 !== U)
                    t = U;
                else if ("undefined" != typeof self)
                    t = self;
                else
                    try {
                        t = Function("return this")()
                    } catch (t) {
                        throw new Error("polyfill failed because global object is unavailable in this environment")
                    }
                var e = t.Promise;
                if (e) {
                    var i = null;
                    try {
                        i = Object.prototype.toString.call(e.resolve())
                    } catch (t) {}
                    if ("[object Promise]" === i && !e.cast)
                        return
                }
                t.Promise = F
            }
            ,
            F.Promise = F
        }()
    }).polyfill();
    (e = h.BrandingDomain || (h.BrandingDomain = {}))[e.Neutral = 0] = "Neutral",
    e[e.Yepi = 1] = "Yepi",
    e[e.Spele = 2] = "Spele",
    e[e.Funnygames = 3] = "Funnygames",
    e[e.Kizi = 4] = "Kizi",
    e[e.PlayCell = 5] = "PlayCell",
    e[e.GameCell = 6] = "GameCell",
    e[e.Bild = 7] = "Bild",
    e[e.Spil = 8] = "Spil",
    e[e.Admeen = 9] = "Admeen";
    var i, s = function() {
        function t() {}
        return t.has = function(t) {
            var e = t.lastIndexOf(".");
            if (e <= 0 || e >= t.length - 1)
                return !1;
            var i = t.lastIndexOf(".", e - 1);
            if (i <= 0 || e - 1 <= i)
                return !1;
            var s = n[t.slice(e + 1)];
            return !!s && 0 <= s.indexOf(" " + t.slice(i + 1, e) + " ")
        }
        ,
        t.is = function(t) {
            var e = t.lastIndexOf(".");
            if (e <= 0 || e >= t.length - 1)
                return !1;
            if (0 <= t.lastIndexOf(".", e - 1))
                return !1;
            var i = n[t.slice(e + 1)];
            return !!i && 0 <= i.indexOf(" " + t.slice(0, e) + " ")
        }
        ,
        t.get = function(t) {
            var e = t.lastIndexOf(".");
            if (e <= 0 || e >= t.length - 1)
                return null;
            var i = t.lastIndexOf(".", e - 1);
            if (i <= 0 || e - 1 <= i)
                return null;
            var s = n[t.slice(e + 1)];
            return s ? s.indexOf(" " + t.slice(i + 1, e) + " ") < 0 ? null : t.slice(i + 1) : null
        }
        ,
        t
    }(), r = function() {
        function t() {}
        return t.setList = function(t) {
            n = t || {}
        }
        ,
        t.getDomain = function(t) {
            if (!n)
                return null;
            var e = t.match(/\./g);
            if (e && e.length < 2)
                return t;
            var i = this.getTld(t);
            if (!i)
                return null;
            var s = t.length - i.length - 1;
            return s = t.lastIndexOf(".", s - 1) + 1,
            t.substring(s) || ""
        }
        ,
        t.getTld = function(t) {
            if (!n)
                return "";
            var e = t.lastIndexOf(".")
              , i = t.substring(e + 1);
            return n[i.toLowerCase()] && s.get(t) || i
        }
        ,
        t.KEY = "Domains",
        t
    }(), o = function() {
        function t() {
            this.cache = {}
        }
        return Object.defineProperty(t, "instance", {
            get: function() {
                return void 0 === t.classInstance && (t.classInstance = new t),
                t.classInstance
            },
            enumerable: !0,
            configurable: !0
        }),
        t.prototype.load = function(e, t, i) {
            var s = this;
            return this.contains(e) ? Promise.reject("Already in cache.") : (this.cache[e] = {
                url: t,
                data: null
            },
            this.requestXhr(t, i).then(function(t) {
                return s.loadComplete(e, t)
            }).catch(function(t) {
                return s.remove(e),
                Promise.reject(t)
            }))
        }
        ,
        t.prototype.loadComplete = function(t, e) {
            if (!this.contains(t))
                return Promise.reject("Item was removed from cache before loading was complete.");
            try {
                var i = JSON.parse(e);
                return this.cache[t].data = i,
                Promise.resolve(i)
            } catch (t) {
                return Promise.reject("There was an error parsing JSON file.")
            }
        }
        ,
        t.prototype.remove = function(t) {
            this.contains(t) && delete this.cache[t]
        }
        ,
        t.prototype.get = function(t) {
            return this.contains(t) ? this.cache[t].data : null
        }
        ,
        t.prototype.contains = function(t) {
            return this.cache.hasOwnProperty(t)
        }
        ,
        t.prototype.isLoading = function(t) {
            return this.contains(t) && null === this.cache[t].data
        }
        ,
        t.prototype.isLoaded = function(t) {
            return this.contains(t) && null !== this.cache[t].data
        }
        ,
        t.prototype.loadScript = function(s, t, n) {
            return void 0 === t && (t = !0),
            new Promise(function(t, e) {
                var i = document.createElement("script");
                i.src = s,
                i.async = !1,
                i.onload = function() {
                    "function" == typeof n && n(),
                    t()
                }
                ,
                document.head.appendChild(i)
            }
            )
        }
        ,
        t.prototype.requestXhr = function(i, s) {
            var n;
            return void 0 === s && (s = "application/json"),
            window.XMLHttpRequest ? (n = new XMLHttpRequest,
            new Promise(function(t, e) {
                n.onreadystatechange = function() {
                    4 === n.readyState && (200 === n.status ? (t(n.responseText),
                    n.onreadystatechange = null) : 0 < n.status && (e("There was a problem with the request: status " + n.status),
                    n.onreadystatechange = null))
                }
                ;
                try {
                    n.open("GET", i, !0),
                    n.setRequestHeader("Content-Type", s),
                    n.send()
                } catch (t) {
                    e("Error: Unable to send request, CORS not allowed.")
                }
            }
            )) : Promise.reject("Unable to send request, XMLHttpRequest not supported.")
        }
        ,
        t
    }();
    function a(t, e, i) {
        var s = document.createElement("script");
        s.setAttribute("src", t + "?v=" + e),
        "function" == typeof i && (s.onload = i),
        document.body.appendChild(s)
    }
    (i = h.UtmTargets || (h.UtmTargets = {}))[i.splashscreen = 0] = "splashscreen",
    i[i.logo = 1] = "logo",
    i[i.facebook = 2] = "facebook",
    i[i.twitter = 3] = "twitter",
    i[i.playstore = 4] = "playstore",
    i[i.appstore = 5] = "appstore",
    i[i.more_games = 6] = "more_games",
    i[i.download_game = 7] = "download_game",
    i[i.walkthrough = 8] = "walkthrough",
    i[i.disclaimer = 9] = "disclaimer",
    i[i.highscores = 10] = "highscores";
    var l = function() {
        function t() {}
        return t.loadPortalScript = function(t) {
            t && t.hasOwnProperty("minijuegos") && -1 !== t.minijuegos.indexOf(c.getSourceSite()) && (void 0 !== window.mpConfig ? window.mpConfig.partner = "orange-games" : window.mpConfig = {
                partner: "orange-games"
            },
            a("https://ext.minijuegosgratis.com/external-host/main.js", Date.now() / 1e3)),
            t && t.hasOwnProperty("kongregate") && -1 !== t.kongregate.indexOf(c.getSourceSite()) && a("https://cdn1.kongregate.com/javascripts/kongregate_api.js", Date.now() / 1e3, function() {
                "undefined" != typeof kongregateAPI && kongregateAPI.loadAPI(function() {
                    window.kongregate = kongregateAPI.getAPI()
                })
            }),
            t && t.hasOwnProperty("newgrounds") && -1 !== t.newgrounds.indexOf(c.getSourceSite()) && a("https://cdn.fbrq.io/@azerion/splash/assets/scripts/newgroundsio.min.js", Date.now() / 1e3)
        }
        ,
        t
    }()
      , u = function() {
        function a() {}
        return a.preload = function(t) {
            var e = Promise.all([o.instance.load(r.KEY, c.ASSET_LOCATION + "json/domains.json?v=" + t, "text/plain"), o.instance.load(a.SITELOCK_PORTALS, c.ASSET_LOCATION + "json/sitelock.json?v=" + t, "text/plain")]);
            return false,
            e.then(function(t) {
                var e = t[0]
                  , i = t[1];
                r.setList(e),
                l.loadPortalScript(i),
                a.setSiteLock(i)
            }).catch(function() {})
        }
        ,
        a.setSiteLock = function(t) {
            a.siteLocks = t
        }
        ,
        Object.defineProperty(a, "brandingLogoUrl", {
            get: function() {
                var t;
                switch (c.isOnDevice() || a.isAirfi() ? c.ASSET_LOCATION = "assets/" : "fbrq.io" === c.getSourceSite(!0) && (c.ASSET_LOCATION = "https://" + window.location.host + "/@azerion/splash/assets/"),
                c.getBrandingDomain()) {
                case h.BrandingDomain.Spele:
                    t = "spele";
                    break;
                case h.BrandingDomain.PlayCell:
                    t = "playcell";
                    break;
                case h.BrandingDomain.GameCell:
                    t = "gamecell";
                    break;
                case h.BrandingDomain.Yepi:
                    t = "yepi";
                    break;
                case h.BrandingDomain.Spil:
                    t = "spil";
                    break;
                case h.BrandingDomain.Admeen:
                    t = "admeen";
                    break;
                case h.BrandingDomain.Bild:
                    t = "bild";
                    break;
                default:
                case h.BrandingDomain.Kizi:
                    t = "kizi";
                    break;
                case h.BrandingDomain.Funnygames:
                    t = "funnygames"
                }
                return c.ASSET_LOCATION + "images/branding_logo_" + t + "_small.png"
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(a, "brandingBackgroundColor", {
            get: function() {
                var t;
                switch (c.getBrandingDomain()) {
                case h.BrandingDomain.Spele:
                    t = "#4a72ad";
                    break;
                case h.BrandingDomain.PlayCell:
                    t = "#52a1e1";
                    break;
                case h.BrandingDomain.GameCell:
                    t = "#c600b2";
                    break;
                case h.BrandingDomain.Yepi:
                    t = "#0573a7";
                    break;
                case h.BrandingDomain.Spil:
                    t = "#0C486C";
                    break;
                case h.BrandingDomain.Admeen:
                    t = "#4267B2";
                    break;
                case h.BrandingDomain.Bild:
                    t = "#de0000";
                    break;
                default:
                case h.BrandingDomain.Kizi:
                    t = "#012f50";
                    break;
                case h.BrandingDomain.Funnygames:
                    t = "#33b0ff"
                }
                return t
            },
            enumerable: !0,
            configurable: !0
        }),
        a.openCampaignLink = function(t, e) {
            if (!c.isOnDevice() && !a.isSpecial() && a.outGoingLinksAllowed()) {
                var i, s, n = c.getSourceSite(), r = c.isOnDevice() ? "https://" : "//";
                switch (c.getBrandingDomain()) {
                case h.BrandingDomain.Spele:
                    i = r + "www.spele.nl";
                    break;
                case h.BrandingDomain.Yepi:
                    i = r + "www.yepi.com";
                    break;
                case h.BrandingDomain.Admeen:
                    return i = "https://media.admeen.com/branding/link.php",
                    void ((s = window.open(i, "_blank")) && s.focus && s.focus());
                case h.BrandingDomain.PlayCell:
                    i = r + "www.playcell.com";
                    break;
                case h.BrandingDomain.GameCell:
                    i = r + "www.gamecell.com";
                    break;
                default:
                case h.BrandingDomain.Kizi:
                    i = "http://www.kizi.com";
                    break;
                case h.BrandingDomain.Bild:
                    return void ((s = window.open(r + "www.bildspielt.de", "_blank")) && s.focus && s.focus());
                case h.BrandingDomain.Funnygames:
                    i = r + "www.funnygames.nu"
                }
                var o = "string" == typeof e ? e : h.UtmTargets[e];
                (s = window.open(i + "/?utm_source=" + n + "&utm_medium=html5&utm_term=" + t + "&utm_content=" + o + "&utm_campaign=Gamedistribution", "_blank")) && s.focus && s.focus()
            }
        }
        ,
        a.isInternal = function() {
            return a.hostMatchesList(o.instance.get(a.INTERNAL_PORTALS_KEY))
        }
        ,
        a.isContracted = function() {
            return a.hostMatchesList(o.instance.get(a.CONTRACTED_PORTALS_KEY))
        }
        ,
        a.isSpecial = function() {
            return a.hostMatchesList(o.instance.get(a.SPECIAL_PORTALS_KEY))
        }
        ,
        a.isAdmeen = function() {
            if (!a.siteLocks || !a.siteLocks.hasOwnProperty("admeen"))
                return !1;
            var t = a.siteLocks.admeen;
            return a.hostMatchesList(t)
        }
        ,
        a.isKongregate = function() {
            if (!a.siteLocks || !a.siteLocks.hasOwnProperty("kongregate"))
                return !1;
            var t = a.siteLocks.kongregate;
            return a.hostMatchesList(t)
        }
        ,
        a.isNewgrounds = function() {
            if (!a.siteLocks || !a.siteLocks.hasOwnProperty("newgrounds"))
                return !1;
            var t = a.siteLocks.newgrounds;
            return a.hostMatchesList(t)
        }
        ,
        a.isBild = function() {
            return "bild.fbrq.io" === window.location.host || -1 !== window.location.host.indexOf("contentfleet.com")
        }
        ,
        a.isBip = function() {
            return -1 !== window.location.search.indexOf("bipgaming") || "bip.fbrq.io" === window.location.host
        }
        ,
        a.isPlaycellApp = function() {
            return -1 !== window.location.search.indexOf("playcellApp")
        }
        ,
        a.isSpil = function() {
            return -1 !== document.referrer.indexOf("gameplayer.io")
        }
        ,
        a.isAirfi = function() {
            return !!window.hasOwnProperty("airfi") && window.airfi
        }
        ,
        a.outGoingLinksAllowed = function() {
            return !(a.isAirfi() || a.isSpecial() || a.isContracted()) && (!window.hasOwnProperty("fbrqLA") || window.fbrqLA)
        }
        ,
        a.hostMatchesList = function(t) {
            t = t || [];
            for (var e = c.getSourceSite(), i = 0; i < t.length; i++)
                if (e === t[i])
                    return !0;
            return !1
        }
        ,
        a.LOGO_KEY = "branding_logo",
        a.INTERNAL_PORTALS_KEY = "branding_portals",
        a.CONTRACTED_PORTALS_KEY = "branding_contracted",
        a.SPECIAL_PORTALS_KEY = "branding_special",
        a.SITELOCK_PORTALS = "sitelock_portals",
        a.GAME_ICONS_KEY = "more_games",
        a.DOMAIN_OVERWRITE = null,
        a
    }()
      , c = function() {
        function s() {}
        return s.getSourceSite = function(t) {
            void 0 === t && (t = !1);
            var e = document.referrer || window.location.host;
            if (t && (e = window.location.host),
            -1 !== e.indexOf("embed.gamedistribution.com") && -1 !== window.location.search.indexOf("gd_sdk_referrer_url") && (e = s.getUrlParameter("gd_sdk_referrer_url") || e),
            e = decodeURIComponent(e),
            u.isBild())
                return "bildspielt.de";
            if (u.isBip())
                return "bipgaming.com";
            u.isSpil() && (e = s.getReferrer(e)),
            e = (e = -1 < e.indexOf("://") ? e.split("/")[2] : e.split("/")[0]).split(":")[0];
            var i = r.getDomain(e);
            return null !== i ? i : (3 === e.split(".").length && (e = e.substr(e.indexOf(".") + 1)),
            e)
        }
        ,
        s.getBrandingDomain = function() {
            if (window.hasOwnProperty("fbrqBD") && window.fbrqBD in h.BrandingDomain)
                return window.fbrqBD;
            if (u.DOMAIN_OVERWRITE)
                return u.DOMAIN_OVERWRITE;
            var t = s.getSourceSite();
            if (u.isAdmeen())
                return h.BrandingDomain.Admeen;
            if (u.isPlaycellApp() || u.isBip())
                return h.BrandingDomain.PlayCell;
            switch (t) {
            case "spele.nl":
                return h.BrandingDomain.Spele;
            case "yepi.com":
                return h.BrandingDomain.Yepi;
            case "oyunskor.com":
            case "barbioyunu.com.tr":
            case "bebekoyunu.com.tr":
            case "oyunkolu.com":
            case "oyungemisi.com":
            case "oyunlar1.com":
            case "oyunkuzusu.com":
            case "kraloyun.com":
            case "rekoroyun.com":
            case "oyundedem.com":
            case "oyunoyna.com":
            case "pastaoyunu.com.tr":
            case "playcell.com":
                return h.BrandingDomain.PlayCell;
            case "gamecell.com":
                return h.BrandingDomain.GameCell;
            case "playxl.com":
                return h.BrandingDomain.Admeen;
            default:
            case "kizi.com":
                return h.BrandingDomain.Kizi;
            case "bildspielt.de":
                return h.BrandingDomain.Bild;
            case "funnygames.nl":
                return h.BrandingDomain.Funnygames
            }
        }
        ,
        s.getReferrer = function(t) {
            return -1 !== t.indexOf("?ref=") ? t.substr(t.indexOf("?ref=") + 5) : t
        }
        ,
        s.inIframe = function() {
            try {
                return window.self !== window.top
            } catch (t) {
                return !0
            }
        }
        ,
        s.getDomain = function(t) {
            var e = document.createElement("a");
            return e.href = t,
            e.origin
        }
        ,
        s.isOnDevice = function() {
            return void 0 !== window.cordova && !/(gamedistribution\.com)/.test(window.location.hostname)
        }
        ,
        s.isTc = function() {
            return /(teamcity\.azerdev\.com)/.test(window.location.host)
        }
        ,
        s.getRandomRange = function(t, e) {
            return Math.random() * (e - t) + t | 0
        }
        ,
        s.getUrlParameter = function(t) {
            t = t.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
            var e = new RegExp("[\\?&]" + t + "=([^&#]*)").exec(location.search);
            return null === e ? "" : decodeURIComponent(e[1].replace(/\+/g, " "))
        }
        ,
        s.intTimeToString = function(t) {
            var e = Math.floor(t / 3600)
              , i = Math.floor(t % 3600 / 60)
              , s = t % 60;
            return (e < 10 ? "0" + e : e.toString()) + ":" + (i < 10 ? "0" + i : i.toString()) + ":" + (s < 10 ? "0" + s : s.toString())
        }
        ,
        s.ASSET_LOCATION = window.hasOwnProperty("fbrqSA") && !0 === window.fbrqSA ? "assets/" : "https://cdn.fbrq.io/@azerion/splash/assets/",
        s
    }()
      , p = function() {
        function t() {
            var t, e, i, s, n, r = c.isOnDevice() ? "https://" : "//";
            t = window,
            e = document,
            i = r + "www.google-analytics.com/analytics.js",
            t.GoogleAnalyticsObject = "ga",
            t.ga = t.ga ? t.ga : function() {
                (t.ga.q = t.ga.q || []).push(arguments)
            }
            ,
            t.ga.l = Date.now(),
            s = e.createElement("script"),
            n = e.getElementsByTagName("script")[0],
            s.async = 1,
            s.src = i,
            n.parentNode.insertBefore(s, n)
        }
        return t.prototype.setup = function(t, e, i, s, n) {
            if (void 0 === s && (s = "auto"),
            void 0 === n && (n = 100),
            ga("create", t, s, {
                sampleRate: n
            }),
            c.isOnDevice() && ga("set", "checkProtocolTask", null),
            void 0 !== e && ga("set", "appName", e),
            void 0 !== e && ga("set", "appVersion", i),
            ga("send", "pageview"),
            "auto" !== s) {
                var r = {
                    name: "fbrq",
                    sampleRate: 1
                };
                for (var o in s)
                    s.hasOwnProperty(o) && (r[o] = s[o]);
                ga("create", "UA-60359297-50", r)
            } else
                ga("create", "UA-60359297-50", s, "fbrq", {
                    sampleRate: 1
                });
            if (u.isSpil()) {
                var a = c.getReferrer(decodeURIComponent(document.referrer));
                ga("fbrq.set", "referrer", a),
                ga("set", "referrer", a)
            }
            return c.isOnDevice() && ga("fbrq.set", "checkProtocolTask", null),
            ga("fbrq.set", "appName", "All"),
            ga("fbrq.send", "pageview"),
            ga
        }
        ,
        t.prototype.sendScreenView = function(e) {
            ["send", "fbrq.send"].forEach(function(t) {
                ga(t, "screenview", {
                    screenName: e
                })
            })
        }
        ,
        t.prototype.sendGenericEvent = function(e, i, s) {
            ["send", "fbrq.send"].forEach(function(t) {
                ga(t, "event", e, i, s)
            })
        }
        ,
        t
    }()
      , g = t(function(t, e) {
        t.exports = function r(o, a, h) {
            function l(i, t) {
                if (!a[i]) {
                    if (!o[i]) {
                        var e = d;
                        if (!t && e)
                            return e(i, !0);
                        if (c)
                            return c(i, !0);
                        var s = new Error("Cannot find module '" + i + "'");
                        throw s.code = "MODULE_NOT_FOUND",
                        s
                    }
                    var n = a[i] = {
                        exports: {}
                    };
                    o[i][0].call(n.exports, function(t) {
                        var e = o[i][1][t];
                        return l(e || t)
                    }, n, n.exports, r, o, a, h)
                }
                return a[i].exports
            }
            for (var c = d, t = 0; t < h.length; t++)
                l(h[t]);
            return l
        }({
            1: [function(t, s, b) {
                (function() {
                    var m, e = this || Function("return this")(), y = function() {
                        var d, i, u, p, g, f, t = Date.now ? Date.now : function() {
                            return +new Date
                        }
                        , m = "undefined" != typeof SHIFTY_DEBUG_NOW ? SHIFTY_DEBUG_NOW : t;
                        function n() {}
                        function r(t, e) {
                            var i;
                            for (i in t)
                                Object.hasOwnProperty.call(t, i) && e(i)
                        }
                        function o(e, i) {
                            return r(i, function(t) {
                                e[t] = i[t]
                            }),
                            e
                        }
                        function a(e, i) {
                            r(i, function(t) {
                                void 0 === e[t] && (e[t] = i[t])
                            })
                        }
                        function y(t, e, i, s, n, r, o) {
                            var a, h, l, c = t < r ? 0 : (t - r) / n;
                            for (a in e)
                                e.hasOwnProperty(a) && (h = o[a],
                                l = "function" == typeof h ? h : d[h],
                                e[a] = v(i[a], s[a], l, c));
                            return e
                        }
                        function v(t, e, i, s) {
                            return t + (e - t) * i(s)
                        }
                        function _(e, i) {
                            var s = c.prototype.filter
                              , n = e._filterArgs;
                            r(s, function(t) {
                                void 0 !== s[t][i] && s[t][i].apply(e, n)
                            })
                        }
                        function h(t, e, i, s, n, r, o, a, h, l, c) {
                            u = e + i + s,
                            p = Math.min(c || m(), u),
                            g = u <= p,
                            f = s - (u - p),
                            t.isPlaying() && (g ? (h(o, t._attachment, f),
                            t.stop(!0)) : (t._scheduleId = l(t._timeoutHandler, 1e3 / 60),
                            _(t, "beforeTween"),
                            p < e + i ? y(1, n, r, o, 1, 1, a) : y(p, n, r, o, s, e + i, a),
                            _(t, "afterTween"),
                            h(n, t._attachment, f)))
                        }
                        function l(t, e) {
                            var i = {}
                              , s = typeof e;
                            return r(t, "string" === s || "function" === s ? function(t) {
                                i[t] = e
                            }
                            : function(t) {
                                i[t] || (i[t] = e[t] || "linear")
                            }
                            ),
                            i
                        }
                        function c(t, e) {
                            this._currentState = t || {},
                            this._configured = !1,
                            this._scheduleFunction = i,
                            void 0 !== e && this.setConfig(e)
                        }
                        return i = "undefined" != typeof window && (window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || window.mozCancelRequestAnimationFrame && window.mozRequestAnimationFrame) || setTimeout,
                        c.prototype.tween = function(t) {
                            return this._isTweening ? this : (void 0 === t && this._configured || this.setConfig(t),
                            this._timestamp = m(),
                            this._start(this.get(), this._attachment),
                            this.resume())
                        }
                        ,
                        c.prototype.setConfig = function(t) {
                            t = t || {},
                            this._configured = !0,
                            this._attachment = t.attachment,
                            this._pausedAtTime = null,
                            this._scheduleId = null,
                            this._delay = t.delay || 0,
                            this._start = t.start || n,
                            this._step = t.step || n,
                            this._finish = t.finish || n,
                            this._duration = t.duration || 500,
                            this._currentState = o({}, t.from || this.get()),
                            this._originalState = this.get(),
                            this._targetState = o({}, t.to || this.get());
                            var e = this;
                            this._timeoutHandler = function() {
                                h(e, e._timestamp, e._delay, e._duration, e._currentState, e._originalState, e._targetState, e._easing, e._step, e._scheduleFunction)
                            }
                            ;
                            var i = this._currentState
                              , s = this._targetState;
                            return a(s, i),
                            this._easing = l(i, t.easing || "linear"),
                            this._filterArgs = [i, this._originalState, s, this._easing],
                            _(this, "tweenCreated"),
                            this
                        }
                        ,
                        c.prototype.get = function() {
                            return o({}, this._currentState)
                        }
                        ,
                        c.prototype.set = function(t) {
                            this._currentState = t
                        }
                        ,
                        c.prototype.pause = function() {
                            return this._pausedAtTime = m(),
                            this._isPaused = !0,
                            this
                        }
                        ,
                        c.prototype.resume = function() {
                            return this._isPaused && (this._timestamp += m() - this._pausedAtTime),
                            this._isPaused = !1,
                            this._isTweening = !0,
                            this._timeoutHandler(),
                            this
                        }
                        ,
                        c.prototype.seek = function(t) {
                            t = Math.max(t, 0);
                            var e = m();
                            return this._timestamp + t === 0 || (this._timestamp = e - t,
                            this.isPlaying() || (this._isTweening = !0,
                            this._isPaused = !1,
                            h(this, this._timestamp, this._delay, this._duration, this._currentState, this._originalState, this._targetState, this._easing, this._step, this._scheduleFunction, e),
                            this.pause())),
                            this
                        }
                        ,
                        c.prototype.stop = function(t) {
                            return this._isTweening = !1,
                            this._isPaused = !1,
                            this._timeoutHandler = n,
                            (e.cancelAnimationFrame || e.webkitCancelAnimationFrame || e.oCancelAnimationFrame || e.msCancelAnimationFrame || e.mozCancelRequestAnimationFrame || e.clearTimeout)(this._scheduleId),
                            t && (_(this, "beforeTween"),
                            y(1, this._currentState, this._originalState, this._targetState, 1, 0, this._easing),
                            _(this, "afterTween"),
                            _(this, "afterTweenEnd"),
                            this._finish.call(this, this._currentState, this._attachment)),
                            this
                        }
                        ,
                        c.prototype.isPlaying = function() {
                            return this._isTweening && !this._isPaused
                        }
                        ,
                        c.prototype.setScheduleFunction = function(t) {
                            this._scheduleFunction = t
                        }
                        ,
                        c.prototype.dispose = function() {
                            var t;
                            for (t in this)
                                this.hasOwnProperty(t) && delete this[t]
                        }
                        ,
                        c.prototype.filter = {},
                        d = c.prototype.formula = {
                            linear: function(t) {
                                return t
                            }
                        },
                        o(c, {
                            now: m,
                            each: r,
                            tweenProps: y,
                            tweenProp: v,
                            applyFilter: _,
                            shallowCopy: o,
                            defaults: a,
                            composeEasingObject: l
                        }),
                        "function" == typeof SHIFTY_DEBUG_NOW && (e.timeoutHandler = h),
                        "object" == typeof b ? s.exports = c : void 0 === e.Tweenable && (e.Tweenable = c),
                        c
                    }();
                    y.shallowCopy(y.prototype.formula, {
                        easeInQuad: function(t) {
                            return Math.pow(t, 2)
                        },
                        easeOutQuad: function(t) {
                            return -(Math.pow(t - 1, 2) - 1)
                        },
                        easeInOutQuad: function(t) {
                            return (t /= .5) < 1 ? .5 * Math.pow(t, 2) : -.5 * ((t -= 2) * t - 2)
                        },
                        easeInCubic: function(t) {
                            return Math.pow(t, 3)
                        },
                        easeOutCubic: function(t) {
                            return Math.pow(t - 1, 3) + 1
                        },
                        easeInOutCubic: function(t) {
                            return (t /= .5) < 1 ? .5 * Math.pow(t, 3) : .5 * (Math.pow(t - 2, 3) + 2)
                        },
                        easeInQuart: function(t) {
                            return Math.pow(t, 4)
                        },
                        easeOutQuart: function(t) {
                            return -(Math.pow(t - 1, 4) - 1)
                        },
                        easeInOutQuart: function(t) {
                            return (t /= .5) < 1 ? .5 * Math.pow(t, 4) : -.5 * ((t -= 2) * Math.pow(t, 3) - 2)
                        },
                        easeInQuint: function(t) {
                            return Math.pow(t, 5)
                        },
                        easeOutQuint: function(t) {
                            return Math.pow(t - 1, 5) + 1
                        },
                        easeInOutQuint: function(t) {
                            return (t /= .5) < 1 ? .5 * Math.pow(t, 5) : .5 * (Math.pow(t - 2, 5) + 2)
                        },
                        easeInSine: function(t) {
                            return 1 - Math.cos(t * (Math.PI / 2))
                        },
                        easeOutSine: function(t) {
                            return Math.sin(t * (Math.PI / 2))
                        },
                        easeInOutSine: function(t) {
                            return -.5 * (Math.cos(Math.PI * t) - 1)
                        },
                        easeInExpo: function(t) {
                            return 0 === t ? 0 : Math.pow(2, 10 * (t - 1))
                        },
                        easeOutExpo: function(t) {
                            return 1 === t ? 1 : 1 - Math.pow(2, -10 * t)
                        },
                        easeInOutExpo: function(t) {
                            return 0 === t ? 0 : 1 === t ? 1 : (t /= .5) < 1 ? .5 * Math.pow(2, 10 * (t - 1)) : .5 * (2 - Math.pow(2, -10 * --t))
                        },
                        easeInCirc: function(t) {
                            return -(Math.sqrt(1 - t * t) - 1)
                        },
                        easeOutCirc: function(t) {
                            return Math.sqrt(1 - Math.pow(t - 1, 2))
                        },
                        easeInOutCirc: function(t) {
                            return (t /= .5) < 1 ? -.5 * (Math.sqrt(1 - t * t) - 1) : .5 * (Math.sqrt(1 - (t -= 2) * t) + 1)
                        },
                        easeOutBounce: function(t) {
                            return t < 1 / 2.75 ? 7.5625 * t * t : t < 2 / 2.75 ? 7.5625 * (t -= 1.5 / 2.75) * t + .75 : t < 2.5 / 2.75 ? 7.5625 * (t -= 2.25 / 2.75) * t + .9375 : 7.5625 * (t -= 2.625 / 2.75) * t + .984375
                        },
                        easeInBack: function(t) {
                            return t * t * (2.70158 * t - 1.70158)
                        },
                        easeOutBack: function(t) {
                            return (t -= 1) * t * (2.70158 * t + 1.70158) + 1
                        },
                        easeInOutBack: function(t) {
                            var e = 1.70158;
                            return (t /= .5) < 1 ? t * t * ((1 + (e *= 1.525)) * t - e) * .5 : .5 * ((t -= 2) * t * ((1 + (e *= 1.525)) * t + e) + 2)
                        },
                        elastic: function(t) {
                            return -1 * Math.pow(4, -8 * t) * Math.sin((6 * t - 1) * (2 * Math.PI) / 2) + 1
                        },
                        swingFromTo: function(t) {
                            var e = 1.70158;
                            return (t /= .5) < 1 ? t * t * ((1 + (e *= 1.525)) * t - e) * .5 : .5 * ((t -= 2) * t * ((1 + (e *= 1.525)) * t + e) + 2)
                        },
                        swingFrom: function(t) {
                            return t * t * (2.70158 * t - 1.70158)
                        },
                        swingTo: function(t) {
                            return (t -= 1) * t * (2.70158 * t + 1.70158) + 1
                        },
                        bounce: function(t) {
                            return t < 1 / 2.75 ? 7.5625 * t * t : t < 2 / 2.75 ? 7.5625 * (t -= 1.5 / 2.75) * t + .75 : t < 2.5 / 2.75 ? 7.5625 * (t -= 2.25 / 2.75) * t + .9375 : 7.5625 * (t -= 2.625 / 2.75) * t + .984375
                        },
                        bouncePast: function(t) {
                            return t < 1 / 2.75 ? 7.5625 * t * t : t < 2 / 2.75 ? 2 - (7.5625 * (t -= 1.5 / 2.75) * t + .75) : t < 2.5 / 2.75 ? 2 - (7.5625 * (t -= 2.25 / 2.75) * t + .9375) : 2 - (7.5625 * (t -= 2.625 / 2.75) * t + .984375)
                        },
                        easeFromTo: function(t) {
                            return (t /= .5) < 1 ? .5 * Math.pow(t, 4) : -.5 * ((t -= 2) * Math.pow(t, 3) - 2)
                        },
                        easeFrom: function(t) {
                            return Math.pow(t, 4)
                        },
                        easeTo: function(t) {
                            return Math.pow(t, .25)
                        }
                    }),
                    function() {
                        function c(t, e, i, s, n, r) {
                            var o, l = 0, c = 0, d = 0, a = 0, h = 0, u = 0;
                            function p(t) {
                                return ((l * t + c) * t + d) * t
                            }
                            function g(t) {
                                return 0 <= t ? t : 0 - t
                            }
                            function f(t, e) {
                                var i, s, n, r, o, a, h;
                                for (n = t,
                                a = 0; a < 8; a++) {
                                    if (g(r = p(n) - t) < e)
                                        return n;
                                    if (g(o = (3 * l * (h = n) + 2 * c) * h + d) < 1e-6)
                                        break;
                                    n -= r / o
                                }
                                if (s = 1,
                                (n = t) < (i = 0))
                                    return i;
                                if (s < n)
                                    return s;
                                for (; i < s; ) {
                                    if (g((r = p(n)) - t) < e)
                                        return n;
                                    r < t ? i = n : s = n,
                                    n = .5 * (s - i) + i
                                }
                                return n
                            }
                            return l = 1 - (d = 3 * e) - (c = 3 * (s - e) - d),
                            a = 1 - (u = 3 * i) - (h = 3 * (n - i) - u),
                            o = f(t, 1 / (200 * r)),
                            ((a * o + h) * o + u) * o
                        }
                        y.setBezierFunction = function(t, e, i, s, n) {
                            var r, o, a, h, l = (r = e,
                            o = i,
                            a = s,
                            h = n,
                            function(t) {
                                return c(t, r, o, a, h, 1)
                            }
                            );
                            return l.displayName = t,
                            l.x1 = e,
                            l.y1 = i,
                            l.x2 = s,
                            l.y2 = n,
                            y.prototype.formula[t] = l
                        }
                        ,
                        y.unsetBezierFunction = function(t) {
                            delete y.prototype.formula[t]
                        }
                    }(),
                    (m = new y)._filterArgs = [],
                    y.interpolate = function(t, e, i, s, n) {
                        var r = y.shallowCopy({}, t)
                          , o = n || 0
                          , a = y.composeEasingObject(t, s || "linear");
                        m.set({});
                        var h = m._filterArgs;
                        h.length = 0,
                        h[0] = r,
                        h[1] = t,
                        h[2] = e,
                        h[3] = a,
                        y.applyFilter(m, "tweenCreated"),
                        y.applyFilter(m, "beforeTween");
                        var l, c, d, u, p, g, f = (l = t,
                        c = r,
                        d = e,
                        u = i,
                        p = a,
                        g = o,
                        y.tweenProps(u, c, l, d, 1, g, p));
                        return y.applyFilter(m, "afterTween"),
                        f
                    }
                    ,
                    function(a) {
                        var h = /(\d|\-|\.)/
                          , l = /([^\-0-9\.]+)/g
                          , r = /[0-9.\-]+/g
                          , o = new RegExp("rgb\\(" + r.source + /,\s*/.source + r.source + /,\s*/.source + r.source + "\\)","g")
                          , c = /^.*\(/
                          , s = /#([0-9]|[a-f]){3,6}/gi
                          , d = "VAL";
                        function n(i) {
                            a.each(i, function(t) {
                                var e = i[t];
                                "string" == typeof e && e.match(s) && (i[t] = f(s, e, u))
                            })
                        }
                        function u(t) {
                            var e, i = (3 === (e = (e = t).replace(/#/, "")).length && (e = (e = e.split(""))[0] + e[0] + e[1] + e[1] + e[2] + e[2]),
                            p[0] = g(e.substr(0, 2)),
                            p[1] = g(e.substr(2, 2)),
                            p[2] = g(e.substr(4, 2)),
                            p);
                            return "rgb(" + i[0] + "," + i[1] + "," + i[2] + ")"
                        }
                        var p = [];
                        function g(t) {
                            return parseInt(t, 16)
                        }
                        function f(t, e, i) {
                            var s = e.match(t)
                              , n = e.replace(t, d);
                            if (s)
                                for (var r, o = s.length, a = 0; a < o; a++)
                                    r = s.shift(),
                                    n = n.replace(d, i(r));
                            return n
                        }
                        function m(t) {
                            for (var e = t.match(r), i = e.length, s = t.match(c)[0], n = 0; n < i; n++)
                                s += parseInt(e[n], 10) + ",";
                            return s = s.slice(0, -1) + ")"
                        }
                        function y(r) {
                            var o = {};
                            return a.each(r, function(t) {
                                var e, i, s = r[t];
                                if ("string" == typeof s) {
                                    var n = w(s);
                                    o[t] = {
                                        formatString: (e = s,
                                        i = e.match(l),
                                        i ? (1 === i.length || e.charAt(0).match(h)) && i.unshift("") : i = ["", ""],
                                        i.join(d)),
                                        chunkNames: function(t, e) {
                                            var i, s = [], n = t.length;
                                            for (i = 0; i < n; i++)
                                                s.push("_" + e + "_" + i);
                                            return s
                                        }(n, t)
                                    }
                                }
                            }),
                            o
                        }
                        function v(r, o) {
                            a.each(o, function(t) {
                                for (var e = r[t], i = w(e), s = i.length, n = 0; n < s; n++)
                                    r[o[t].chunkNames[n]] = +i[n];
                                delete r[t]
                            })
                        }
                        function _(n, r) {
                            a.each(r, function(t) {
                                var e = n[t]
                                  , i = function(t, e) {
                                    for (var i, s = {}, n = e.length, r = 0; r < n; r++)
                                        i = e[r],
                                        s[i] = t[i],
                                        delete t[i];
                                    return s
                                }(n, r[t].chunkNames)
                                  , s = function(t, e) {
                                    b.length = 0;
                                    for (var i = e.length, s = 0; s < i; s++)
                                        b.push(t[e[s]]);
                                    return b
                                }(i, r[t].chunkNames);
                                e = function(t, e) {
                                    for (var i = t, s = e.length, n = 0; n < s; n++)
                                        i = i.replace(d, +e[n].toFixed(4));
                                    return i
                                }(r[t].formatString, s),
                                n[t] = f(o, e, m)
                            })
                        }
                        var b = [];
                        function w(t) {
                            return t.match(r)
                        }
                        a.prototype.filter.token = {
                            tweenCreated: function(t, e, i, s) {
                                n(t),
                                n(e),
                                n(i),
                                this._tokenData = y(t)
                            },
                            beforeTween: function(t, e, i, s) {
                                var h, l;
                                h = s,
                                l = this._tokenData,
                                a.each(l, function(t) {
                                    var e, i = l[t], s = i.chunkNames, n = s.length, r = h[t];
                                    if ("string" == typeof r) {
                                        var o = r.split(" ")
                                          , a = o[o.length - 1];
                                        for (e = 0; e < n; e++)
                                            h[s[e]] = o[e] || a
                                    } else
                                        for (e = 0; e < n; e++)
                                            h[s[e]] = r;
                                    delete h[t]
                                }),
                                v(t, this._tokenData),
                                v(e, this._tokenData),
                                v(i, this._tokenData)
                            },
                            afterTween: function(t, e, i, s) {
                                var h, l;
                                _(t, this._tokenData),
                                _(e, this._tokenData),
                                _(i, this._tokenData),
                                h = s,
                                l = this._tokenData,
                                a.each(l, function(t) {
                                    var e = l[t]
                                      , i = e.chunkNames
                                      , s = i.length
                                      , n = h[i[0]]
                                      , r = typeof n;
                                    if ("string" === r) {
                                        for (var o = "", a = 0; a < s; a++)
                                            o += " " + h[i[a]],
                                            delete h[i[a]];
                                        h[t] = o.substr(1)
                                    } else
                                        h[t] = n
                                })
                            }
                        }
                    }(y)
                }
                ).call(null)
            }
            , {}],
            2: [function(t, e, i) {
                var s = t("./shape")
                  , n = t("./utils")
                  , r = function(t, e) {
                    this._pathTemplate = "M 50,50 m 0,-{radius} a {radius},{radius} 0 1 1 0,{2radius} a {radius},{radius} 0 1 1 0,-{2radius}",
                    this.containerAspectRatio = 1,
                    s.apply(this, arguments)
                };
                ((r.prototype = new s).constructor = r).prototype._pathString = function(t) {
                    var e = t.strokeWidth;
                    t.trailWidth && t.trailWidth > t.strokeWidth && (e = t.trailWidth);
                    var i = 50 - e / 2;
                    return n.render(this._pathTemplate, {
                        radius: i,
                        "2radius": 2 * i
                    })
                }
                ,
                r.prototype._trailString = function(t) {
                    return this._pathString(t)
                }
                ,
                e.exports = r
            }
            , {
                "./shape": 7,
                "./utils": 9
            }],
            3: [function(t, e, i) {
                var s = t("./shape")
                  , n = t("./utils")
                  , r = function(t, e) {
                    this._pathTemplate = "M 0,{center} L 100,{center}",
                    s.apply(this, arguments)
                };
                ((r.prototype = new s).constructor = r).prototype._initializeSvg = function(t, e) {
                    t.setAttribute("viewBox", "0 0 100 " + e.strokeWidth),
                    t.setAttribute("preserveAspectRatio", "none")
                }
                ,
                r.prototype._pathString = function(t) {
                    return n.render(this._pathTemplate, {
                        center: t.strokeWidth / 2
                    })
                }
                ,
                r.prototype._trailString = function(t) {
                    return this._pathString(t)
                }
                ,
                e.exports = r
            }
            , {
                "./shape": 7,
                "./utils": 9
            }],
            4: [function(t, e, i) {
                e.exports = {
                    Line: t("./line"),
                    Circle: t("./circle"),
                    SemiCircle: t("./semicircle"),
                    Square: t("./square"),
                    Path: t("./path"),
                    Shape: t("./shape"),
                    utils: t("./utils")
                }
            }
            , {
                "./circle": 2,
                "./line": 3,
                "./path": 5,
                "./semicircle": 6,
                "./shape": 7,
                "./square": 8,
                "./utils": 9
            }],
            5: [function(t, e, i) {
                var c = t("shifty")
                  , d = t("./utils")
                  , s = {
                    easeIn: "easeInCubic",
                    easeOut: "easeOutCubic",
                    easeInOut: "easeInOutCubic"
                }
                  , n = function t(e, i) {
                    if (!(this instanceof t))
                        throw new Error("Constructor was called without new keyword");
                    var s;
                    i = d.extend({
                        duration: 800,
                        easing: "linear",
                        from: {},
                        to: {},
                        step: function() {}
                    }, i),
                    s = d.isString(e) ? document.querySelector(e) : e,
                    this.path = s,
                    this._opts = i,
                    this._tweenable = null;
                    var n = this.path.getTotalLength();
                    this.path.style.strokeDasharray = n + " " + n,
                    this.set(0)
                };
                n.prototype.value = function() {
                    var t = this._getComputedDashOffset()
                      , e = this.path.getTotalLength()
                      , i = 1 - t / e;
                    return parseFloat(i.toFixed(6), 10)
                }
                ,
                n.prototype.set = function(t) {
                    this.stop(),
                    this.path.style.strokeDashoffset = this._progressToOffset(t);
                    var e = this._opts.step;
                    if (d.isFunction(e)) {
                        var i = this._easing(this._opts.easing)
                          , s = this._calculateTo(t, i)
                          , n = this._opts.shape || this;
                        e(s, n, this._opts.attachment)
                    }
                }
                ,
                n.prototype.stop = function() {
                    this._stopTween(),
                    this.path.style.strokeDashoffset = this._getComputedDashOffset()
                }
                ,
                n.prototype.animate = function(t, i, e) {
                    i = i || {},
                    d.isFunction(i) && (e = i,
                    i = {});
                    var s = d.extend({}, i)
                      , n = d.extend({}, this._opts);
                    i = d.extend(n, i);
                    var r = this._easing(i.easing)
                      , o = this._resolveFromAndTo(t, r, s);
                    this.stop(),
                    this.path.getBoundingClientRect();
                    var a = this._getComputedDashOffset()
                      , h = this._progressToOffset(t)
                      , l = this;
                    this._tweenable = new c,
                    this._tweenable.tween({
                        from: d.extend({
                            offset: a
                        }, o.from),
                        to: d.extend({
                            offset: h
                        }, o.to),
                        duration: i.duration,
                        easing: r,
                        step: function(t) {
                            l.path.style.strokeDashoffset = t.offset;
                            var e = i.shape || l;
                            i.step(t, e, i.attachment)
                        },
                        finish: function(t) {
                            d.isFunction(e) && e()
                        }
                    })
                }
                ,
                n.prototype._getComputedDashOffset = function() {
                    var t = window.getComputedStyle(this.path, null);
                    return parseFloat(t.getPropertyValue("stroke-dashoffset"), 10)
                }
                ,
                n.prototype._progressToOffset = function(t) {
                    var e = this.path.getTotalLength();
                    return e - t * e
                }
                ,
                n.prototype._resolveFromAndTo = function(t, e, i) {
                    return i.from && i.to ? {
                        from: i.from,
                        to: i.to
                    } : {
                        from: this._calculateFrom(e),
                        to: this._calculateTo(t, e)
                    }
                }
                ,
                n.prototype._calculateFrom = function(t) {
                    return c.interpolate(this._opts.from, this._opts.to, this.value(), t)
                }
                ,
                n.prototype._calculateTo = function(t, e) {
                    return c.interpolate(this._opts.from, this._opts.to, t, e)
                }
                ,
                n.prototype._stopTween = function() {
                    null !== this._tweenable && (this._tweenable.stop(),
                    this._tweenable = null)
                }
                ,
                n.prototype._easing = function(t) {
                    return s.hasOwnProperty(t) ? s[t] : t
                }
                ,
                e.exports = n
            }
            , {
                "./utils": 9,
                shifty: 1
            }],
            6: [function(t, e, i) {
                var s = t("./shape")
                  , n = t("./circle")
                  , r = t("./utils")
                  , o = function(t, e) {
                    this._pathTemplate = "M 50,50 m -{radius},0 a {radius},{radius} 0 1 1 {2radius},0",
                    this.containerAspectRatio = 2,
                    s.apply(this, arguments)
                };
                ((o.prototype = new s).constructor = o).prototype._initializeSvg = function(t, e) {
                    t.setAttribute("viewBox", "0 0 100 50")
                }
                ,
                o.prototype._initializeTextContainer = function(t, e, i) {
                    t.text.style && (i.style.top = "auto",
                    i.style.bottom = "0",
                    t.text.alignToBottom ? r.setStyle(i, "transform", "translate(-50%, 0)") : r.setStyle(i, "transform", "translate(-50%, 50%)"))
                }
                ,
                o.prototype._pathString = n.prototype._pathString,
                o.prototype._trailString = n.prototype._trailString,
                e.exports = o
            }
            , {
                "./circle": 2,
                "./shape": 7,
                "./utils": 9
            }],
            7: [function(t, e, i) {
                var o = t("./path")
                  , a = t("./utils")
                  , s = "Object is destroyed"
                  , n = function t(e, i) {
                    if (!(this instanceof t))
                        throw new Error("Constructor was called without new keyword");
                    if (0 !== arguments.length) {
                        this._opts = a.extend({
                            color: "#555",
                            strokeWidth: 1,
                            trailColor: null,
                            trailWidth: null,
                            fill: null,
                            text: {
                                style: {
                                    color: null,
                                    position: "absolute",
                                    left: "50%",
                                    top: "50%",
                                    padding: 0,
                                    margin: 0,
                                    transform: {
                                        prefix: !0,
                                        value: "translate(-50%, -50%)"
                                    }
                                },
                                autoStyleContainer: !0,
                                alignToBottom: !0,
                                value: null,
                                className: "progressbar-text"
                            },
                            svgStyle: {
                                display: "block",
                                width: "100%"
                            },
                            warnings: !1
                        }, i, !0),
                        a.isObject(i) && void 0 !== i.svgStyle && (this._opts.svgStyle = i.svgStyle),
                        a.isObject(i) && a.isObject(i.text) && void 0 !== i.text.style && (this._opts.text.style = i.text.style);
                        var s, n = this._createSvgView(this._opts);
                        if (!(s = a.isString(e) ? document.querySelector(e) : e))
                            throw new Error("Container does not exist: " + e);
                        this._container = s,
                        this._container.appendChild(n.svg),
                        this._opts.warnings && this._warnContainerAspectRatio(this._container),
                        this._opts.svgStyle && a.setStyles(n.svg, this._opts.svgStyle),
                        this.svg = n.svg,
                        this.path = n.path,
                        this.trail = n.trail,
                        this.text = null;
                        var r = a.extend({
                            attachment: void 0,
                            shape: this
                        }, this._opts);
                        this._progressPath = new o(n.path,r),
                        a.isObject(this._opts.text) && null !== this._opts.text.value && this.setText(this._opts.text.value)
                    }
                };
                n.prototype.animate = function(t, e, i) {
                    if (null === this._progressPath)
                        throw new Error(s);
                    this._progressPath.animate(t, e, i)
                }
                ,
                n.prototype.stop = function() {
                    if (null === this._progressPath)
                        throw new Error(s);
                    void 0 !== this._progressPath && this._progressPath.stop()
                }
                ,
                n.prototype.destroy = function() {
                    if (null === this._progressPath)
                        throw new Error(s);
                    this.stop(),
                    this.svg.parentNode.removeChild(this.svg),
                    this.svg = null,
                    this.path = null,
                    this.trail = null,
                    (this._progressPath = null) !== this.text && (this.text.parentNode.removeChild(this.text),
                    this.text = null)
                }
                ,
                n.prototype.set = function(t) {
                    if (null === this._progressPath)
                        throw new Error(s);
                    this._progressPath.set(t)
                }
                ,
                n.prototype.value = function() {
                    if (null === this._progressPath)
                        throw new Error(s);
                    return void 0 === this._progressPath ? 0 : this._progressPath.value()
                }
                ,
                n.prototype.setText = function(t) {
                    if (null === this._progressPath)
                        throw new Error(s);
                    null === this.text && (this.text = this._createTextContainer(this._opts, this._container),
                    this._container.appendChild(this.text)),
                    a.isObject(t) ? (a.removeChildren(this.text),
                    this.text.appendChild(t)) : this.text.innerHTML = t
                }
                ,
                n.prototype._createSvgView = function(t) {
                    var e = document.createElementNS("http://www.w3.org/2000/svg", "svg");
                    this._initializeSvg(e, t);
                    var i = null;
                    (t.trailColor || t.trailWidth) && (i = this._createTrail(t),
                    e.appendChild(i));
                    var s = this._createPath(t);
                    return e.appendChild(s),
                    {
                        svg: e,
                        path: s,
                        trail: i
                    }
                }
                ,
                n.prototype._initializeSvg = function(t, e) {
                    t.setAttribute("viewBox", "0 0 100 100")
                }
                ,
                n.prototype._createPath = function(t) {
                    var e = this._pathString(t);
                    return this._createPathElement(e, t)
                }
                ,
                n.prototype._createTrail = function(t) {
                    var e = this._trailString(t)
                      , i = a.extend({}, t);
                    return i.trailColor || (i.trailColor = "#eee"),
                    i.trailWidth || (i.trailWidth = i.strokeWidth),
                    i.color = i.trailColor,
                    i.strokeWidth = i.trailWidth,
                    i.fill = null,
                    this._createPathElement(e, i)
                }
                ,
                n.prototype._createPathElement = function(t, e) {
                    var i = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    return i.setAttribute("d", t),
                    i.setAttribute("stroke", e.color),
                    i.setAttribute("stroke-width", e.strokeWidth),
                    e.fill ? i.setAttribute("fill", e.fill) : i.setAttribute("fill-opacity", "0"),
                    i
                }
                ,
                n.prototype._createTextContainer = function(t, e) {
                    var i = document.createElement("div");
                    i.className = t.text.className;
                    var s = t.text.style;
                    return s && (t.text.autoStyleContainer && (e.style.position = "relative"),
                    a.setStyles(i, s),
                    s.color || (i.style.color = t.color)),
                    this._initializeTextContainer(t, e, i),
                    i
                }
                ,
                n.prototype._initializeTextContainer = function(t, e, i) {}
                ,
                n.prototype._pathString = function(t) {
                    throw new Error("Override this function for each progress bar")
                }
                ,
                n.prototype._trailString = function(t) {
                    throw new Error("Override this function for each progress bar")
                }
                ,
                n.prototype._warnContainerAspectRatio = function(t) {
                    if (this.containerAspectRatio) {
                        var e = window.getComputedStyle(t, null)
                          , i = parseFloat(e.getPropertyValue("width"), 10)
                          , s = parseFloat(e.getPropertyValue("height"), 10);
                        a.floatEquals(this.containerAspectRatio, i / s)
                    }
                }
                ,
                e.exports = n
            }
            , {
                "./path": 5,
                "./utils": 9
            }],
            8: [function(t, e, i) {
                var s = t("./shape")
                  , n = t("./utils")
                  , r = function(t, e) {
                    this._pathTemplate = "M 0,{halfOfStrokeWidth} L {width},{halfOfStrokeWidth} L {width},{width} L {halfOfStrokeWidth},{width} L {halfOfStrokeWidth},{strokeWidth}",
                    this._trailTemplate = "M {startMargin},{halfOfStrokeWidth} L {width},{halfOfStrokeWidth} L {width},{width} L {halfOfStrokeWidth},{width} L {halfOfStrokeWidth},{halfOfStrokeWidth}",
                    s.apply(this, arguments)
                };
                ((r.prototype = new s).constructor = r).prototype._pathString = function(t) {
                    var e = 100 - t.strokeWidth / 2;
                    return n.render(this._pathTemplate, {
                        width: e,
                        strokeWidth: t.strokeWidth,
                        halfOfStrokeWidth: t.strokeWidth / 2
                    })
                }
                ,
                r.prototype._trailString = function(t) {
                    var e = 100 - t.strokeWidth / 2;
                    return n.render(this._trailTemplate, {
                        width: e,
                        strokeWidth: t.strokeWidth,
                        halfOfStrokeWidth: t.strokeWidth / 2,
                        startMargin: t.strokeWidth / 2 - t.trailWidth / 2
                    })
                }
                ,
                e.exports = r
            }
            , {
                "./shape": 7,
                "./utils": 9
            }],
            9: [function(t, e, i) {
                var o = "Webkit Moz O ms".split(" ");
                function s(t, e, i) {
                    for (var s = t.style, n = 0; n < o.length; ++n) {
                        var r = o[n];
                        s[r + a(e)] = i
                    }
                    s[e] = i
                }
                function a(t) {
                    return t.charAt(0).toUpperCase() + t.slice(1)
                }
                function h(t) {
                    if (e = t,
                    "[object Array]" === Object.prototype.toString.call(e))
                        return !1;
                    var e, i = typeof t;
                    return "object" === i && !!t
                }
                function n(t, e) {
                    for (var i in t)
                        if (t.hasOwnProperty(i)) {
                            var s = t[i];
                            e(s, i)
                        }
                }
                e.exports = {
                    extend: function t(e, i, s) {
                        for (var n in e = e || {},
                        s = s || !1,
                        i = i || {})
                            if (i.hasOwnProperty(n)) {
                                var r = e[n]
                                  , o = i[n];
                                s && h(r) && h(o) ? e[n] = t(r, o, s) : e[n] = o
                            }
                        return e
                    },
                    render: function(t, e) {
                        var i = t;
                        for (var s in e)
                            if (e.hasOwnProperty(s)) {
                                var n = e[s]
                                  , r = "\\{" + s + "\\}"
                                  , o = new RegExp(r,"g");
                                i = i.replace(o, n)
                            }
                        return i
                    },
                    setStyle: s,
                    setStyles: function(i, t) {
                        n(t, function(t, e) {
                            null != t && (h(t) && !0 === t.prefix ? s(i, e, t.value) : i.style[e] = t)
                        })
                    },
                    capitalize: a,
                    isString: function(t) {
                        return "string" == typeof t || t instanceof String
                    },
                    isFunction: function(t) {
                        return "function" == typeof t
                    },
                    isObject: h,
                    forEachObject: n,
                    floatEquals: function(t, e) {
                        return Math.abs(t - e) < .001
                    },
                    removeChildren: function(t) {
                        for (; t.firstChild; )
                            t.removeChild(t.firstChild)
                    }
                }
            }
            , {}]
        }, {}, [4])(4)
    });
    var f = function() {
        function e(t) {
            this.circleLoader = null,
            this.loaded = !1,
            this.showPlayButton = "undefined" == typeof playBtn || playBtn,
            this.options = {
                gameId: "12346",
                gameTitle: "Place Holder",
                gameName: "place-holder",
                libs: [],
                version: "dev",
                barColor: "white"
            },
            this.options.gameId = t.gameId,
            this.options.gameTitle = t.gameTitle,
            this.options.version = t.version,
            this.options.barColor = t.barColor ? t.barColor : this.options.barColor,
            this.options.libs = t.libs
        }
        return e.getInstance = function(t) {
            if (!e.instance) {
                if (!t)
                    throw new Error("Can not create new SplashLoader instance without options!");
                e.instance = new e(t)
            }
            return e.instance
        }
        ,
        e.prototype.create = function() {
            var c = this;
            return u.preload(Date.now().toString()).then(function() {
                var t, e, i, s, n = (t = u.brandingBackgroundColor,
                "\n        #h5branding-wrapper {\n            position: relative;\n            z-index: 665;\n            width: 150px;\n            height: 150px;\n            margin: 0 auto;\n            top: 50%;\n            -ms-transform: translateY(-50%);\n            transform: translateY(-50%);\n        }\n\n        #h5branding-wrapper > #h5branding-bar, #h5branding-wrapper > img {\n            box-shadow: inset 10px 10px 20px 5px rgba(0, 0, 0, 0.5);\n            border-radius: 50%;\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n        }\n\n        #h5branding-wrapper > img {\n            /* Needs appropriate vendor prefixes */\n            box-sizing: border-box;\n\n            /* This needs to be equal to strokeWidth */\n            padding: 4%;\n        }\n\n        #h5branding-wrapper > img {\n            border-radius: 50%;\n            box-shadow: inset 0 5px 5px rgba(0, 0, 0, 0.5), 5px 5px 7px rgba(0, 0, 0, 0.3);\n        }\n\n        #h5branding-container {\n            box-sizing: border-box;\n            position: absolute;\n            z-index: 664;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background-color: #000;\n            overflow: hidden;\n        }\n        #h5branding-background {\n            position: absolute;\n            top: -25%;\n            left: -25%;\n            width: 150%;\n            height: 150%;\n            background-image: url(" + c.getGameLogoUrl(c.options.gameId) + ");\n            background-color: " + t + ";\n            background-blend-mode: multiply;\n            background-size: cover;\n            filter: blur(40px) brightness(1.5);\n        }\n        \n        @media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {\n             /* IE10+ CSS styles go here */\n             #h5branding-background {\n                background-image: none;\n             }\n        }\n\n        #h5branding-logo {\n            position: absolute;\n            margin: 0 auto;\n            left: 0;\n            right: 0;\n            text-align: center;\n            top: 10%;\n        }\n\n        #h5branding-logo > img {\n            height: 150px;\n        }\n\n        #h5branding-title {\n            position: absolute;\n            width: 100%;\n            background: linear-gradient(90deg, transparent, rgba(0, 0, 0, 0.5) 50%, transparent);\n            color: #fff;\n            text-shadow: 0 0 1px rgba(0, 0, 0, 0.7);\n            bottom:10%;\n            padding: 15px 0;\n            text-align: center;\n            font-size: 18px;\n            font-family: Helvetica, Arial, sans-serif;\n            font-weight: bold;\n            line-height: 100%;\n        }\n        \n        #h5branding-button {\n            /* border: 0; */\n            padding: 10px 22px;\n            border-radius: 5px;\n            border: 3px solid white;\n            background: linear-gradient(0deg, #dddddd, #ffffff);\n            color: #222;\n            text-transform: uppercase;\n            text-shadow: 0 0 1px #fff;\n            font-family: Helvetica, Arial, sans-serif;\n            font-weight: bold;\n            font-size: 18px;\n            cursor: pointer;\n            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);\n            display: none;\n            width: 150px;\n            position: absolute;\n            top: 170px;\n            margin: 0 auto;\n            left: 0;\n            right: 0;\n        }\n        \n        @media (orientation: portrait) and (max-width: 1080px) {\n            #h5branding-logo > img {\n                height: initial;\n                width:100%;\n            }\n        }\n        \n        @media (orientation: landscape) and (max-height: 580px) {\n            #h5branding-title {\n                display: none;\n            }\n            \n            #h5branding-logo > img {\n                height: 100px;\n            }\n        }\n        \n        @media (orientation: landscape) and (max-height: 460px) {\n            #h5branding-title {\n                display: none;\n            }\n            \n            #h5branding-wrapper {\n                width: 110px;\n                height: 110px;\n            }\n            \n            #h5branding-logo {\n                top: 0;\n                transform: scale(0.7, 0.7);\n            }\n       \n             #h5branding-button {\n                top: initial;\n                width: 110px;\n                font-size: 14px;\n                position: absolute;\n                top: 140px;\n                left: 0;\n                right: 0;\n            }\n        }\n        \n        @media (orientation: portrait) and (max-width: 250px) {\n            #h5branding-logo {\n                top: 2%;\n            }\n        }\n        \n        @media (orientation: landscape) and (max-width: 330px) {\n             #h5branding-button {\n                top: 120px;\n            }\n            \n            #h5branding-logo > img {\n                height: 70px;\n            }\n        }\n        "), r = (e = u.brandingLogoUrl.replace("_small", ""),
                i = c.getGameLogoUrl(c.options.gameId),
                s = c.options.gameTitle,
                '\n        <div id="h5branding-background"></div>\n        <div id="h5branding-logo">\n            <img src="' + e + '">\n        </div>\n        <div id="h5branding-wrapper">\n            <img src="' + i + '" />\n            <div id="h5branding-bar"></div>\n            <button id="h5branding-button" onclick="h5branding.SplashLoader.getInstance().onPlayButtonClick();">Play</button>\n        </div>\n        <div id="h5branding-title">' + "Grindcraft Unblocked</div>\n    "), o = document.head || document.getElementsByTagName("head")[0], a = document.createElement("style");
                a.type = "text/css",
                a.styleSheet ? a.styleSheet.cssText = n : a.appendChild(document.createTextNode(n)),
                o.appendChild(a);
                var h = document.createElement("div");
                h.innerHTML = r,
                h.id = "h5branding-container";
                var l = document.body || document.getElementsByTagName("body")[0];
                l.insertBefore(h, l.firstChild),
                c.circleLoader = new g.Circle("#h5branding-bar",{
                    strokeWidth: 3,
                    color: c.options.barColor
                }),
                c.loaded = !0
            }).then(function() {
                var i = c.options.libs.map(function(t, e) {
                    return o.instance.loadScript(t, !0, function() {
                        c.setScriptloadProgress(i.length, e + 1)
                    })
                });
                return Promise.all(i)
            })
        }
        ,
        e.prototype.setScriptloadProgress = function(t, e) {
            var i = .3 * e / t;
            this.circleLoader.animate(i, null, function() {})
        }
        ,
        e.prototype.setLoadProgress = function(t) {
            var e = this;
            if (this.loaded)
                if (100 === (t = 30 + .7 * t)) {
                    var i = document.querySelector("#h5branding-button");
                    this.circleLoader.animate(1, null, function() {
                        i && !0 === e.showPlayButton ? i.style.display = "block" : !1 === e.showPlayButton && e.onPlayButtonClick()
                    })
                } else
                    this.circleLoader.animate(t / 100, null, function() {})
        }
        ,
        e.prototype.setButtonCallback = function(t) {
            this.buttonCallback = t
        }
        ,
        e.prototype.onPlayButtonClick = function() {
            this.buttonCallback && this.buttonCallback()
        }
        ,
        e.prototype.destroy = function() {
            var t = document.querySelector("#h5branding-container");
            null !== t && null !== t.parentNode && t.parentNode.removeChild(t)
        }
        ,
        e.prototype.getGameLogoUrl = function(t) {
            var e = t + "-512x512.jpeg";
            return window.hasOwnProperty("fbrqSA") && !0 === window.fbrqSA ? "assets/" + e : "https://img.gamedistribution.com/" + e
        }
        ,
        e
    }()
      , m = new p;
    h.google = m,
    h.Utils = c,
    h.Domain = r,
    h.Branding = u,
    h.SplashLoader = f,
    Object.defineProperty(h, "__esModule", {
        value: !0
    })
}),
function(t, e) {
    "object" == typeof exports && "undefined" != typeof module ? e(exports) : "function" == typeof define && define.amd ? define(["exports"], e) : e(t.h5ads = t.h5ads || {})
}(this, function(s) {
    "use strict";
    var n = function(t, e) {
        return (n = Object.setPrototypeOf || {
            __proto__: []
        }instanceof Array && function(t, e) {
            t.__proto__ = e
        }
        || function(t, e) {
            for (var i in e)
                e.hasOwnProperty(i) && (t[i] = e[i])
        }
        )(t, e)
    };
    function i(t, e) {
        function i() {
            this.constructor = t
        }
        n(t, e),
        t.prototype = null === e ? Object.create(e) : (i.prototype = e.prototype,
        new i)
    }
    var t, r, e, o, a, h = (function(t) {
        var s = Object.prototype.hasOwnProperty
          , p = "~";
        function i() {}
        function a(t, e, i) {
            this.fn = t,
            this.context = e,
            this.once = i || !1
        }
        function n(t, e, i, s, n) {
            if ("function" != typeof i)
                throw new TypeError("The listener must be a function");
            var r = new a(i,s || t,n)
              , o = p ? p + e : e;
            return t._events[o] ? t._events[o].fn ? t._events[o] = [t._events[o], r] : t._events[o].push(r) : (t._events[o] = r,
            t._eventsCount++),
            t
        }
        function l(t, e) {
            0 == --t._eventsCount ? t._events = new i : delete t._events[e]
        }
        function e() {
            this._events = new i,
            this._eventsCount = 0
        }
        Object.create && (i.prototype = Object.create(null),
        (new i).__proto__ || (p = !1)),
        e.prototype.eventNames = function() {
            var t, e, i = [];
            if (0 === this._eventsCount)
                return i;
            for (e in t = this._events)
                s.call(t, e) && i.push(p ? e.slice(1) : e);
            return Object.getOwnPropertySymbols ? i.concat(Object.getOwnPropertySymbols(t)) : i
        }
        ,
        e.prototype.listeners = function(t) {
            var e = p ? p + t : t
              , i = this._events[e];
            if (!i)
                return [];
            if (i.fn)
                return [i.fn];
            for (var s = 0, n = i.length, r = new Array(n); s < n; s++)
                r[s] = i[s].fn;
            return r
        }
        ,
        e.prototype.listenerCount = function(t) {
            var e = p ? p + t : t
              , i = this._events[e];
            return i ? i.fn ? 1 : i.length : 0
        }
        ,
        e.prototype.emit = function(t, e, i, s, n, r) {
            var o = p ? p + t : t;
            if (!this._events[o])
                return !1;
            var a, h, l = this._events[o], c = arguments.length;
            if (l.fn) {
                switch (l.once && this.removeListener(t, l.fn, void 0, !0),
                c) {
                case 1:
                    return l.fn.call(l.context),
                    !0;
                case 2:
                    return l.fn.call(l.context, e),
                    !0;
                case 3:
                    return l.fn.call(l.context, e, i),
                    !0;
                case 4:
                    return l.fn.call(l.context, e, i, s),
                    !0;
                case 5:
                    return l.fn.call(l.context, e, i, s, n),
                    !0;
                case 6:
                    return l.fn.call(l.context, e, i, s, n, r),
                    !0
                }
                for (h = 1,
                a = new Array(c - 1); h < c; h++)
                    a[h - 1] = arguments[h];
                l.fn.apply(l.context, a)
            } else {
                var d, u = l.length;
                for (h = 0; h < u; h++)
                    switch (l[h].once && this.removeListener(t, l[h].fn, void 0, !0),
                    c) {
                    case 1:
                        l[h].fn.call(l[h].context);
                        break;
                    case 2:
                        l[h].fn.call(l[h].context, e);
                        break;
                    case 3:
                        l[h].fn.call(l[h].context, e, i);
                        break;
                    case 4:
                        l[h].fn.call(l[h].context, e, i, s);
                        break;
                    default:
                        if (!a)
                            for (d = 1,
                            a = new Array(c - 1); d < c; d++)
                                a[d - 1] = arguments[d];
                        l[h].fn.apply(l[h].context, a)
                    }
            }
            return !0
        }
        ,
        e.prototype.on = function(t, e, i) {
            return n(this, t, e, i, !1)
        }
        ,
        e.prototype.once = function(t, e, i) {
            return n(this, t, e, i, !0)
        }
        ,
        e.prototype.removeListener = function(t, e, i, s) {
            var n = p ? p + t : t;
            if (!this._events[n])
                return this;
            if (!e)
                return l(this, n),
                this;
            var r = this._events[n];
            if (r.fn)
                r.fn !== e || s && !r.once || i && r.context !== i || l(this, n);
            else {
                for (var o = 0, a = [], h = r.length; o < h; o++)
                    (r[o].fn !== e || s && !r[o].once || i && r[o].context !== i) && a.push(r[o]);
                a.length ? this._events[n] = 1 === a.length ? a[0] : a : l(this, n)
            }
            return this
        }
        ,
        e.prototype.removeAllListeners = function(t) {
            var e;
            return t ? (e = p ? p + t : t,
            this._events[e] && l(this, e)) : (this._events = new i,
            this._eventsCount = 0),
            this
        }
        ,
        e.prototype.off = e.prototype.removeListener,
        e.prototype.addListener = e.prototype.on,
        e.prefixed = p,
        e.EventEmitter = e,
        t.exports = e
    }(t = {
        exports: {}
    }, t.exports),
    t.exports), l = function() {
        function t(t, e, i) {
            void 0 === i && (i = !1),
            this.adsEnabled = !1,
            void 0 === cordova.plugins || void 0 !== cordova.plugins && void 0 === cordova.plugins.gdApi || (i && cordova.plugins.gdApi.enableTestAds(),
            this.setAdListeners(),
            cordova.plugins.gdApi.init([t, e], function(t) {}, function(t) {}))
        }
        return t.prototype.setAdListeners = function() {
            var e = this;
            cordova.plugins.gdApi.setAdListener(function(t) {
                switch (t.event) {
                case "BANNER_STARTED":
                    e.adManager.emit(m.CONTENT_PAUSED);
                    break;
                case "API_IS_READY":
                    e.adsEnabled = !0;
                    break;
                case "API_ALREADY_INITIALIZED":
                    break;
                case "BANNER_CLOSED":
                case "API_NOT_READY":
                case "BANNER_FAILED":
                    e.adManager.emit(m.CONTENT_RESUMED)
                }
            }, function(t) {
                e.adsEnabled = !1
            })
        }
        ,
        t.prototype.setManager = function(t) {
            this.adManager = t
        }
        ,
        t.prototype.showAd = function(t) {
            var e = this;
            this.adsEnabled ? cordova.plugins.gdApi.showBanner(function(t) {}, function(t) {
                e.adManager.emit(m.CONTENT_RESUMED)
            }) : this.adManager.emit(m.CONTENT_RESUMED)
        }
        ,
        t.prototype.adAvailable = function(t) {
            return !0
        }
        ,
        t.prototype.preloadAd = function(t) {}
        ,
        t.prototype.destroyAd = function(t) {}
        ,
        t.prototype.hideAd = function(t) {}
        ,
        t
    }(), c = function() {
        function t(t) {
            var e = this;
            this.adsEnabled = !1,
            this.adsEnabled = !0,
            HeyzapAds.start(t).then(function() {}, function(t) {
                e.adsEnabled = !1
            })
        }
        return t.prototype.setManager = function(t) {
            this.adManager = t
        }
        ,
        t.prototype.showAd = function(t, e) {
            var i = this;
            switch (this.adsEnabled || this.adManager.emit(m.CONTENT_RESUMED),
            t) {
            case v.interstitial:
                HeyzapAds.InterstitialAd.addEventListener(HeyzapAds.InterstitialAd.Events.HIDE, function() {
                    i.adManager.emit(m.CONTENT_RESUMED, HeyzapAds.InterstitialAd.Events.HIDE)
                }),
                HeyzapAds.InterstitialAd.addEventListener(HeyzapAds.InterstitialAd.Events.SHOW_FAILED, function() {
                    i.adManager.emit(m.CONTENT_RESUMED, HeyzapAds.InterstitialAd.Events.SHOW_FAILED)
                }),
                HeyzapAds.InterstitialAd.addEventListener(HeyzapAds.InterstitialAd.Events.CLICKED, function() {
                    i.adManager.emit(m.AD_CLICKED, HeyzapAds.InterstitialAd.Events.CLICKED)
                }),
                HeyzapAds.InterstitialAd.show().then(function() {
                    i.adManager.emit(m.CONTENT_PAUSED)
                }, function(t) {
                    i.adManager.emit(m.CONTENT_RESUMED)
                });
                break;
            case v.interstitial:
                HeyzapAds.VideoAd.addEventListener(HeyzapAds.VideoAd.Events.HIDE, function() {
                    i.adManager.emit(m.CONTENT_RESUMED, HeyzapAds.VideoAd.Events.HIDE)
                }),
                HeyzapAds.VideoAd.addEventListener(HeyzapAds.VideoAd.Events.SHOW_FAILED, function() {
                    i.adManager.emit(m.CONTENT_RESUMED, HeyzapAds.VideoAd.Events.SHOW_FAILED)
                }),
                HeyzapAds.VideoAd.addEventListener(HeyzapAds.VideoAd.Events.CLICKED, function() {
                    i.adManager.emit(m.AD_CLICKED, HeyzapAds.VideoAd.Events.CLICKED)
                }),
                HeyzapAds.VideoAd.show().then(function() {
                    i.adManager.emit(m.CONTENT_PAUSED)
                }, function(t) {
                    i.adManager.emit(m.CONTENT_RESUMED)
                });
                break;
            case v.rewarded:
                HeyzapAds.IncentivizedAd.addEventListener(HeyzapAds.IncentivizedAd.Events.HIDE, function() {
                    i.adManager.emit(m.CONTENT_RESUMED, HeyzapAds.IncentivizedAd.Events.HIDE)
                }),
                HeyzapAds.IncentivizedAd.addEventListener(HeyzapAds.IncentivizedAd.Events.SHOW_FAILED, function() {
                    i.adManager.emit(m.CONTENT_RESUMED, HeyzapAds.IncentivizedAd.Events.SHOW_FAILED)
                }),
                HeyzapAds.IncentivizedAd.addEventListener(HeyzapAds.IncentivizedAd.Events.CLICKED, function() {
                    i.adManager.emit(m.AD_CLICKED, HeyzapAds.IncentivizedAd.Events.CLICKED)
                }),
                HeyzapAds.IncentivizedAd.show().then(function() {
                    i.adManager.emit(m.CONTENT_PAUSED)
                }, function(t) {
                    i.adManager.emit(m.CONTENT_RESUMED)
                });
                break;
            case v.banner:
                if (void 0 === e)
                    return;
                HeyzapAds.BannerAd.show(e).then(function() {}, function(t) {})
            }
        }
        ,
        t.prototype.adAvailable = function(t) {
            return !0
        }
        ,
        t.prototype.preloadAd = function(t) {
            this.adsEnabled && t === v.rewarded && HeyzapAds.IncentivizedAd.fetch().then(function() {}, function(t) {})
        }
        ,
        t.prototype.destroyAd = function(t) {
            this.adsEnabled && t === v.banner && HeyzapAds.BannerAd.destroy().then(function() {}, function(t) {})
        }
        ,
        t.prototype.hideAd = function(t) {
            this.adsEnabled && t === v.banner && HeyzapAds.BannerAd.hide().then(function() {}, function(t) {})
        }
        ,
        t
    }(), d = function() {
        function t(t) {
            var e = this;
            if (this.adsEnabled = !1,
            this.interstitialLoaded = !1,
            this.rewardedLoaded = !1,
            "undefined" != typeof IronSourceAds) {
                IronSourceAds.init({
                    appKey: t
                });
                var i = function() {
                    return e.resumeGameplay()
                };
                window.addEventListener("interstitialClosed", i),
                window.addEventListener("interstitialShowFailed", i),
                window.addEventListener("interstitialLoaded", function() {
                    return e.interstitialChanged(!0)
                }),
                window.addEventListener("rewardedVideoClosed", i),
                window.addEventListener("rewardedVideoFailed", i),
                IronSourceAds.hasRewardedVideo({
                    onSuccess: this.rewardedChanged.bind(this)
                }),
                window.addEventListener("rewardedVideoAvailabilityChanged", function(t) {
                    return e.rewardedChanged(t.available)
                })
            }
        }
        return t.prototype.setManager = function(t) {
            this.adManager = t
        }
        ,
        t.prototype.showAd = function(t) {
            switch (void 0 === t && (t = v.interstitial),
            t) {
            case v.interstitial:
                if (!this.interstitialLoaded) {
                    this.resumeGameplay();
                    break
                }
                this.interstitialChanged(!1),
                this.adManager.emit(m.CONTENT_PAUSED),
                IronSourceAds.showInterstitial();
                break;
            case v.rewarded:
                if (!this.rewardedLoaded) {
                    this.resumeGameplay();
                    break
                }
                this.adManager.emit(m.CONTENT_PAUSED),
                IronSourceAds.showRewardedVideo();
                break;
            default:
                this.resumeGameplay()
            }
        }
        ,
        t.prototype.resumeGameplay = function() {
            this.adManager.emit(m.CONTENT_RESUMED)
        }
        ,
        t.prototype.preloadAd = function(t) {
            void 0 === t && (t = v.interstitial),
            t === v.interstitial && IronSourceAds.loadInterstitial()
        }
        ,
        t.prototype.destroyAd = function() {}
        ,
        t.prototype.hideAd = function() {}
        ,
        t.prototype.adAvailable = function(t) {
            switch (t) {
            case v.interstitial:
                return this.interstitialLoaded;
            case v.rewarded:
                return this.rewardedLoaded
            }
            return !1
        }
        ,
        t.prototype.interstitialChanged = function(t) {
            this.interstitialLoaded = t
        }
        ,
        t.prototype.rewardedChanged = function(t) {
            this.rewardedLoaded = t
        }
        ,
        t
    }();
    (e = r || (r = {})).interstitial = "interstitial",
    e.rewarded = "rewarded",
    e.display = "display",
    (o = s.GameDistributionBannerSize || (s.GameDistributionBannerSize = {}))[o.LargeRectangle = 0] = "LargeRectangle",
    o[o.MediumRectangle = 1] = "MediumRectangle",
    o[o.Billboard = 2] = "Billboard",
    o[o.Leaderboard = 3] = "Leaderboard",
    o[o.Skyscraper = 4] = "Skyscraper",
    o[o.WideSkyscraper = 5] = "WideSkyscraper",
    (a = s.GameDistributionAlignment || (s.GameDistributionAlignment = {}))[a.TopLeft = 0] = "TopLeft",
    a[a.TopCenter = 1] = "TopCenter",
    a[a.TopRight = 2] = "TopRight",
    a[a.CenterLeft = 3] = "CenterLeft",
    a[a.Center = 4] = "Center",
    a[a.CenterRight = 5] = "CenterRight",
    a[a.BottomLeft = 6] = "BottomLeft",
    a[a.BottomCenter = 7] = "BottomCenter",
    a[a.BottomRight = 8] = "BottomRight";
    var u, p, g = function() {
        function t() {
            this.offsetX = 0,
            this.offsetY = 0,
            this.element = document.createElement("div"),
            this.element.style.position = "absolute",
            this.element.style.top = "0px",
            this.element.style.left = "0px",
            this.element.id = "banner-" + Date.now() + (1e7 * Math.random() | 0),
            document.body.appendChild(this.element)
        }
        return t.prototype.loadBanner = function() {
            return "undefined" == typeof gdsdk ? Promise.reject("GD Sdk not available, probably due to adblocker") : gdsdk.showAd(r.display, {
                containerId: this.element.id
            })
        }
        ,
        t.prototype.destroy = function() {
            document.body.removeChild(this.element),
            delete this.element,
            delete this.parent,
            delete this.alignment,
            this.resizeListener && window.removeEventListener("resize", this.resizeListener)
        }
        ,
        t.prototype.alignIn = function(t, e) {
            var i = this;
            this.parent = t,
            this.alignment = e,
            this.resizeListener = function() {
                return i.resize()
            }
            ,
            window.addEventListener("resize", this.resizeListener),
            this.resize()
        }
        ,
        t.prototype.setOffset = function(t, e) {
            void 0 === t && (t = 0),
            void 0 === e && (e = 0),
            this.offsetX = t,
            this.offsetY = e,
            this.resize()
        }
        ,
        t.prototype.resize = function() {
            var t = this.parent.getBoundingClientRect();
            switch (this.alignment) {
            case s.GameDistributionAlignment.TopLeft:
                this.position(t.left, t.top);
                break;
            case s.GameDistributionAlignment.TopCenter:
                this.position(t.left + t.width / 2 - this.width / 2, t.top);
                break;
            case s.GameDistributionAlignment.TopRight:
                this.position(t.left + t.width - this.width, t.top);
                break;
            case s.GameDistributionAlignment.CenterLeft:
                this.position(t.left, t.top + t.height / 2 - this.height / 2);
                break;
            case s.GameDistributionAlignment.Center:
                this.position(t.left + t.width / 2 - this.width / 2, t.top + t.height / 2 - this.height / 2);
                break;
            case s.GameDistributionAlignment.CenterRight:
                this.position(t.left + t.width - this.width, t.top + t.height / 2 - this.height / 2);
                break;
            case s.GameDistributionAlignment.BottomLeft:
                this.position(t.left, t.top + t.height - this.height);
                break;
            case s.GameDistributionAlignment.BottomCenter:
                this.position(t.left + t.width / 2 - this.width / 2, t.top + t.height - this.height);
                break;
            case s.GameDistributionAlignment.BottomRight:
                this.position(t.left + t.width - this.width, t.top + t.height - this.height)
            }
        }
        ,
        t.prototype.setSize = function(t) {
            var e, i;
            switch (t) {
            default:
            case s.GameDistributionBannerSize.LargeRectangle:
                e = 336,
                i = 280;
                break;
            case s.GameDistributionBannerSize.MediumRectangle:
                e = 300,
                i = 250;
                break;
            case s.GameDistributionBannerSize.Billboard:
                e = 970,
                i = 250;
                break;
            case s.GameDistributionBannerSize.Leaderboard:
                e = 728,
                i = 90;
                break;
            case s.GameDistributionBannerSize.Skyscraper:
                e = 120,
                i = 600;
                break;
            case s.GameDistributionBannerSize.WideSkyscraper:
                e = 160,
                i = 600
            }
            this.width = e,
            this.height = i,
            this.element.style.width = e + "px",
            this.element.style.height = i + "px"
        }
        ,
        t.prototype.position = function(t, e) {
            this.element.style.left = t + this.offsetX + "px",
            this.element.style.top = e + this.offsetY + "px"
        }
        ,
        t
    }(), f = function() {
        function t(t) {
            var e, i, s, n, r = this;
            this.adsEnabled = !1,
            this.hasRewarded = !1,
            this.adShowing = !1,
            this.areAdsEnabled(),
            window.GD_OPTIONS = {
                gameId: t,
                advertisementSettings: {
                    autoplay: !1
                },
                onEvent: function(t) {
                    switch (t.name) {
                    case "SDK_GAME_PAUSE":
                        r.adManager.emit(m.CONTENT_PAUSED);
                        break;
                    case "SDK_READY":
                        r.sdkLoaded()
                    }
                }
            },
            e = document,
            i = "gamedistribution-jssdk",
            n = e.getElementsByTagName("script")[0],
            e.getElementById(i) || ((s = e.createElement("script")).id = i,
            s.src = "",
            n.parentNode && n.parentNode.insertBefore(s, n))
        }
        return t.prototype.setManager = function(t) {
            this.adManager = t
        }
        ,
        t.prototype.sdkLoaded = function() {
            var e = this;
            this.areAdsEnabled().then(function(t) {
                t && (e.adsEnabled = !0,
                e.adManager.emit(m.AD_PROVIDER_LOADED))
            })
        }
        ,
        t.prototype.showAd = function(t) {
            var e = this;
            if (this.adsEnabled) {
                if ("undefined" == typeof gdsdk || gdsdk && void 0 === gdsdk.showAd)
                    return this.adsEnabled = !1,
                    void this.adManager.emit(m.CONTENT_RESUMED);
                gdsdk.showAd(t === v.rewarded ? r.rewarded : r.interstitial).then(function() {
                    t === v.rewarded && (e.adManager.emit(m.AD_REWARDED),
                    e.hasRewarded = !1),
                    e.adManager.emit(m.CONTENT_RESUMED)
                }).catch(function() {
                    t === v.rewarded && e.hasRewarded && (e.hasRewarded = !1),
                    e.adManager.emit(m.CONTENT_RESUMED)
                })
            } else
                this.adManager.emit(m.CONTENT_RESUMED)
        }
        ,
        t.prototype.createBanner = function(t) {
            if (this.adsEnabled) {
                var e = new g;
                return e.setSize(t),
                e
            }
        }
        ,
        t.prototype.loadBanner = function(t) {
            if (this.adsEnabled) {
                var e = new g;
                return e.setSize(t),
                e.loadBanner(),
                e
            }
        }
        ,
        t.prototype.preloadAd = function(t) {
            var e = this;
            !this.hasRewarded && this.adsEnabled && t === v.rewarded && gdsdk.preloadAd(r.rewarded).then(function() {
                e.hasRewarded = !0,
                e.adManager.emit(m.AD_LOADED, t)
            })
        }
        ,
        t.prototype.adAvailable = function(t) {
            return t !== v.rewarded || this.hasRewarded
        }
        ,
        t.prototype.destroyAd = function() {}
        ,
        t.prototype.hideAd = function() {}
        ,
        t.prototype.areAdsEnabled = function() {
            var i = document.createElement("div");
            i.innerHTML = "&nbsp;",
            i.className = "adsbox",
            i.style.position = "absolute",
            i.style.fontSize = "10px",
            document.body.appendChild(i);
            return new Promise(function(e) {
                window.setTimeout(function() {
                    var t;
                    e((t = !0,
                    0 === i.offsetHeight && (t = !1),
                    i.parentNode && i.parentNode.removeChild(i),
                    t))
                }, 100)
            }
            )
        }
        ,
        t
    }();
    (p = u || (u = {}))[p.start = 0] = "start",
    p[p.firstQuartile = 1] = "firstQuartile",
    p[p.midPoint = 2] = "midPoint",
    p[p.thirdQuartile = 3] = "thirdQuartile",
    p[p.complete = 4] = "complete";
    var m, y, v, _, b = function() {
        function t(t, e) {
            this.googleEnabled = !1,
            this.adsEnabled = !0,
            this.adTagUrl = "",
            this.adRequested = !1,
            this.areAdsEnabled(),
            "undefined" != typeof google && (this.googleEnabled = !0,
            this.gameContent = "string" == typeof t.parentElement ? document.getElementById(t.parentElement) : t.parentElement,
            this.gameContent.style.position = "absolute",
            this.gameContent.style.width = "100%",
            this.adContent = this.gameContent.parentNode.appendChild(document.createElement("div")),
            this.adContent.id = "phaser-ad-container",
            this.adContent.style.position = "absolute",
            this.adContent.style.zIndex = "9999",
            this.adContent.style.display = "none",
            this.adContent.style.top = "0",
            this.adContent.style.left = "0",
            this.adContent.style.width = "100%",
            this.adContent.style.height = "100%",
            this.adContent.style.overflow = "hidden",
            this.adTagUrl = e,
            this.adDisplay = new google.ima.AdDisplayContainer(this.adContent),
            google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),
            google.ima.settings.setLocale("nl"),
            this.adLoader = new google.ima.AdsLoader(this.adDisplay),
            this.adLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED, this.onAdManagerLoader, !1, this),
            this.adLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR, this.onAdError, !1, this))
        }
        return t.prototype.setManager = function(t) {
            this.adManager = t
        }
        ,
        t.prototype.showAd = function(t, e) {
            if (!this.adRequested)
                if (this.adsEnabled || this.adManager.emit(m.AD_DISABLED, !0),
                this.googleEnabled) {
                    this.adDisplay.initialize();
                    var i = new google.ima.AdsRequest;
                    i.adTagUrl = this.adTagUrl + this.parseCustomParams(e);
                    var s = window.innerWidth
                      , n = window.innerHeight;
                    document.body.clientHeight < window.innerHeight && (n = document.body.clientHeight,
                    s = document.body.clientWidth),
                    i.linearAdSlotWidth = s,
                    i.linearAdSlotHeight = n,
                    i.nonLinearAdSlotWidth = s,
                    i.nonLinearAdSlotHeight = n,
                    i.forceNonLinearFullSlot = !0;
                    try {
                        this.adRequested = !0,
                        this.adLoader.requestAds(i)
                    } catch (t) {
                        this.onContentResumeRequested()
                    }
                } else
                    this.onContentResumeRequested()
        }
        ,
        t.prototype.adAvailable = function(t) {
            return !0
        }
        ,
        t.prototype.preloadAd = function() {}
        ,
        t.prototype.destroyAd = function() {}
        ,
        t.prototype.hideAd = function() {}
        ,
        t.prototype.onAdManagerLoader = function(t) {
            var e = this
              , i = new google.ima.AdsRenderingSettings;
            i.restoreCustomPlaybackStateOnAdBreakComplete = !0;
            var s = t.getAdsManager(this.gameContent, i);
            (this.adsManager = s).addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED, this.onContentPauseRequested, !1, this),
            s.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED, this.onContentResumeRequested, !1, this),
            s.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR, this.onAdError, !1, this),
            [google.ima.AdEvent.Type.ALL_ADS_COMPLETED, google.ima.AdEvent.Type.CLICK, google.ima.AdEvent.Type.COMPLETE, google.ima.AdEvent.Type.FIRST_QUARTILE, google.ima.AdEvent.Type.LOADED, google.ima.AdEvent.Type.MIDPOINT, google.ima.AdEvent.Type.PAUSED, google.ima.AdEvent.Type.STARTED, google.ima.AdEvent.Type.THIRD_QUARTILE].forEach(function(t) {
                s.addEventListener(t, e.onAdEvent, !1, e)
            });
            try {
                this.adContent.style.display = "block";
                var n = window.innerWidth
                  , r = window.innerHeight;
                this.adsManager.init(n, r, google.ima.ViewMode.NORMAL),
                this.adsManager.start(),
                this.resizeListener = function() {
                    null !== e.adsManager && e.adsManager.resize(window.innerWidth, window.innerHeight, google.ima.ViewMode.NORMAL)
                }
                ,
                window.addEventListener("resize", this.resizeListener)
            } catch (t) {
                this.onAdError(t)
            }
        }
        ,
        t.prototype.onAdEvent = function(t) {
            switch (t.type) {
            case google.ima.AdEvent.Type.CLICK:
                this.adManager.emit(m.AD_CLICKED);
                break;
            case google.ima.AdEvent.Type.LOADED:
                this.adRequested = !1;
                var e = t.getAd();
                e.isLinear() || this.onContentResumeRequested();
                break;
            case google.ima.AdEvent.Type.STARTED:
                this.adManager.emit(m.AD_PROGRESSION, u.start);
                break;
            case google.ima.AdEvent.Type.FIRST_QUARTILE:
                this.adManager.emit(m.AD_PROGRESSION, u.firstQuartile);
                break;
            case google.ima.AdEvent.Type.MIDPOINT:
                this.adManager.emit(m.AD_PROGRESSION, u.midPoint);
                break;
            case google.ima.AdEvent.Type.THIRD_QUARTILE:
                this.adManager.emit(m.AD_PROGRESSION, u.thirdQuartile);
                break;
            case google.ima.AdEvent.Type.COMPLETE:
                this.adManager.emit(m.AD_PROGRESSION, u.complete);
                break;
            case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:
                this.onContentResumeRequested()
            }
        }
        ,
        t.prototype.onAdError = function(t) {
            null !== this.adsManager && (this.adsManager.destroy(),
            null !== this.resizeListener && window.removeEventListener("resize", this.resizeListener)),
            this.adRequested && (this.adRequested = !1),
            this.onContentResumeRequested()
        }
        ,
        t.prototype.onContentPauseRequested = function() {
            this.adManager.emit(m.CONTENT_PAUSED)
        }
        ,
        t.prototype.onContentResumeRequested = function() {
            "undefined" != typeof google && (this.adContent.style.display = "none"),
            this.adManager.emit(m.CONTENT_RESUMED)
        }
        ,
        t.prototype.parseCustomParams = function(t) {
            if (void 0 === t)
                return "";
            var e = "";
            for (var i in t) {
                if (t.hasOwnProperty(i))
                    0 < e.length && (e += "&"),
                    e += i + "=" + (Array.isArray(t[i]) ? t[i].join(",") : t[i])
            }
            return "&cust_params=" + encodeURIComponent(e)
        }
        ,
        t.prototype.areAdsEnabled = function() {
            var e = this
              , i = document.createElement("div");
            i.innerHTML = "&nbsp;",
            i.className = "adsbox",
            i.style.position = "absolute",
            i.style.fontSize = "10px",
            document.body.appendChild(i);
            window.setTimeout(function() {
                var t;
                e.adsEnabled = (t = !0,
                0 === i.offsetHeight && (t = !1),
                i.parentNode && i.parentNode.removeChild(i),
                t)
            }, 100)
        }
        ,
        t
    }();
    (y = m || (m = {})).CONTENT_PAUSED = "onContentPaused",
    y.CONTENT_RESUMED = "onContentResumed",
    y.AD_PROGRESSION = "onAdProgression",
    y.AD_DISABLED = "onAdsDisabled",
    y.AD_CLICKED = "onAdClicked",
    y.AD_REWARDED = "onAdRewardGranted",
    y.BANNER_SHOWN = "onBannerShown",
    y.BANNER_HIDDEN = "onBannerHidden",
    y.AD_LOADED = "onAdLoaded",
    y.AD_PROVIDER_LOADED = "onAdProviderLoaded",
    (_ = v || (v = {}))[_.interstitial = 0] = "interstitial",
    _[_.rewarded = 1] = "rewarded",
    _[_.banner = 2] = "banner";
    var w, x;
    new (function(e) {
        function t() {
            var t = null !== e && e.apply(this, arguments) || this;
            return t.bannerActive = !1,
            t.provider = null,
            t
        }
        return i(t, e),
        t.prototype.setAdProvider = function(t) {
            this.provider = t,
            this.provider.setManager(this)
        }
        ,
        t.prototype.showAd = function(t) {
            for (var e = [], i = 1; i < arguments.length; i++)
                e[i - 1] = arguments[i];
            if (null === this.provider)
                throw new Error("Can not request an ad without an provider, please attach an ad provider!");
            e.unshift(t),
            this.provider.showAd.apply(this.provider, e)
        }
        ,
        t.prototype.createBanner = function() {
            for (var t = [], e = 0; e < arguments.length; e++)
                t[e] = arguments[e];
            return this.provider.loadBanner.apply(this.provider, t)
        }
        ,
        t.prototype.loadBanner = function() {
            for (var t = [], e = 0; e < arguments.length; e++)
                t[e] = arguments[e];
            return this.provider.loadBanner.apply(this.provider, t)
        }
        ,
        t.prototype.preloadAd = function(t) {
            for (var e = [], i = 1; i < arguments.length; i++)
                e[i - 1] = arguments[i];
            if (null === this.provider)
                throw new Error("Can not preload an ad without an provider, please attach an ad provider!");
            e.unshift(t),
            this.provider.preloadAd.apply(this.provider, e)
        }
        ,
        t.prototype.destroyAd = function(t) {
            for (var e = [], i = 1; i < arguments.length; i++)
                e[i - 1] = arguments[i];
            if (null === this.provider)
                throw new Error("Can not destroy an ad without an provider, please attach an ad provider!");
            e.unshift(t),
            this.provider.destroyAd.apply(this.provider, e)
        }
        ,
        t.prototype.hideAd = function(t) {
            for (var e = [], i = 1; i < arguments.length; i++)
                e[i - 1] = arguments[i];
            if (null === this.provider)
                throw new Error("Can not hide an ad without an provider, please attach an ad provider!");
            e.unshift(t),
            this.provider.hideAd.apply(this.provider, e)
        }
        ,
        t.prototype.adsEnabled = function() {
            if (null === this.provider)
                throw new Error("Can not hide an ad without an provider, please attach an ad provider!");
            return this.provider.adsEnabled
        }
        ,
        t.prototype.adAvailable = function(t) {
            for (var e = [], i = 1; i < arguments.length; i++)
                e[i - 1] = arguments[i];
            if (null === this.provider)
                throw new Error("Can not hide an ad without an provider, please attach an ad provider!");
            return e.unshift(t),
            this.provider.adAvailable.apply(this.provider, e)
        }
        ,
        t
    }(h));
    (x = w || (w = {}))[x.AdMob = 0] = "AdMob",
    x[x.MoPub = 1] = "MoPub",
    x[x.Chartboost = 2] = "Chartboost",
    x[x.Heyzap = 3] = "Heyzap";
    var S, T, A = function() {
        function t(t, e) {
            if (this.adsEnabled = !1,
            this.bannerShowable = !1,
            this.interstitialShowable = !1,
            this.insentiveShowable = !1,
            Cocoon && Cocoon.Ad) {
                switch (this.adsEnabled = !0,
                t) {
                default:
                case w.AdMob:
                    this.cocoonProvider = Cocoon.Ad.AdMob;
                    break;
                case w.Chartboost:
                    this.cocoonProvider = Cocoon.Ad.Chartboost;
                    break;
                case w.Heyzap:
                    this.cocoonProvider = Cocoon.Ad.Heyzap;
                    break;
                case w.MoPub:
                    this.cocoonProvider = Cocoon.Ad.MoPub
                }
                this.cocoonProvider.configure(e)
            }
        }
        return t.prototype.setManager = function(t) {
            this.adManager = t
        }
        ,
        t.prototype.showAd = function(t) {
            if (this.adsEnabled) {
                if (t === v.banner) {
                    if (!this.bannerShowable || null === this.banner)
                        return;
                    this.adManager.emit(m.BANNER_SHOWN, this.banner.width, this.banner.height),
                    this.adManager.bannerActive = !0,
                    this.banner.show()
                }
                if (t === v.interstitial) {
                    if (!this.interstitialShowable || null === this.interstitial)
                        return void this.adManager.emit(m.CONTENT_RESUMED, v.interstitial);
                    this.interstitial.show()
                }
                if (t === v.rewarded) {
                    if (!this.insentiveShowable || null === this.insentive)
                        return void this.adManager.emit(m.CONTENT_RESUMED, v.rewarded);
                    this.insentive.show()
                }
            } else
                t !== v.banner && this.adManager.emit(m.CONTENT_RESUMED)
        }
        ,
        t.prototype.adAvailable = function(t) {
            return !0
        }
        ,
        t.prototype.preloadAd = function(t, e, i) {
            var s = this;
            this.adsEnabled && (this.destroyAd(t),
            t === v.banner && (this.banner = this.cocoonProvider.createBanner(e),
            i && this.banner.setLayout(i),
            this.banner.on("load", function() {
                s.bannerShowable = !0
            }),
            this.banner.on("fail", function() {
                s.bannerShowable = !1,
                s.banner = null
            }),
            this.banner.on("click", function() {
                s.adManager.emit(m.AD_CLICKED, v.banner)
            }),
            this.banner.on("show", function() {}),
            this.banner.on("dismiss", function() {}),
            this.banner.load()),
            t === v.interstitial && (this.interstitial = this.cocoonProvider.createInterstitial(e),
            this.interstitial.on("load", function() {
                s.interstitialShowable = !0
            }),
            this.interstitial.on("fail", function() {
                s.interstitialShowable = !1,
                s.interstitial = null
            }),
            this.interstitial.on("click", function() {
                s.adManager.emit(m.AD_CLICKED, v.interstitial)
            }),
            this.interstitial.on("show", function() {
                s.adManager.emit(m.CONTENT_PAUSED, v.interstitial)
            }),
            this.interstitial.on("dismiss", function() {
                s.adManager.emit(m.CONTENT_RESUMED, v.interstitial),
                s.interstitialShowable = !1,
                s.interstitial = null
            }),
            this.interstitial.load()),
            t === v.rewarded && (this.insentive = this.cocoonProvider.createRewardedVideo(e),
            this.insentive.on("load", function() {
                s.insentiveShowable = !0
            }),
            this.insentive.on("fail", function() {
                s.insentiveShowable = !1,
                s.insentive = null
            }),
            this.insentive.on("click", function() {
                s.adManager.emit(m.AD_CLICKED, v.rewarded)
            }),
            this.insentive.on("show", function() {
                s.adManager.emit(m.CONTENT_PAUSED, v.rewarded)
            }),
            this.insentive.on("dismiss", function() {
                s.adManager.emit(m.CONTENT_RESUMED, v.rewarded),
                s.insentiveShowable = !1,
                s.insentive = null
            }),
            this.insentive.on("reward", function() {
                s.adManager.emit(m.AD_REWARDED, v.rewarded),
                s.insentiveShowable = !1,
                s.insentive = null
            }),
            this.insentive.load()))
        }
        ,
        t.prototype.destroyAd = function(t) {
            if (this.adsEnabled) {
                if (t === v.banner && null !== this.banner) {
                    try {
                        this.cocoonProvider.releaseBanner(this.banner)
                    } catch (t) {}
                    this.banner = null,
                    this.bannerShowable = !1
                }
                t === v.interstitial && null !== this.interstitial && (this.cocoonProvider.releaseInterstitial(this.interstitial),
                this.interstitial = null,
                this.interstitialShowable = !1)
            }
        }
        ,
        t.prototype.hideAd = function(t) {
            this.adsEnabled && (t === v.interstitial && null !== this.interstitial && this.interstitial.hide(),
            t === v.banner && null !== this.banner && (this.adManager.bannerActive && (this.adManager.bannerActive = !1,
            this.adManager.emit(m.BANNER_HIDDEN, this.banner.width, this.banner.height)),
            this.banner.hide()),
            t === v.rewarded && null !== this.insentive && this.insentive.hide())
        }
        ,
        t
    }();
    (S = s.AdEvents || (s.AdEvents = {})).CONTENT_PAUSED = "onContentPaused",
    S.CONTENT_RESUMED = "onContentResumed",
    S.AD_PROGRESSION = "onAdProgression",
    S.AD_DISABLED = "onAdsDisabled",
    S.AD_CLICKED = "onAdClicked",
    S.AD_REWARDED = "onAdRewardGranted",
    S.BANNER_SHOWN = "onBannerShown",
    S.BANNER_HIDDEN = "onBannerHidden",
    S.AD_LOADED = "onAdLoaded",
    S.AD_PROVIDER_LOADED = "onAdProviderLoaded",
    (T = s.AdType || (s.AdType = {}))[T.interstitial = 0] = "interstitial",
    T[T.rewarded = 1] = "rewarded",
    T[T.banner = 2] = "banner";
    var C = function(e) {
        function t() {
            var t = null !== e && e.apply(this, arguments) || this;
            return t.bannerActive = !1,
            t.provider = null,
            t
        }
        return i(t, e),
        t.prototype.setAdProvider = function(t) {
            this.provider = t,
            this.provider.setManager(this)
        }
        ,
        t.prototype.showAd = function(t) {
            for (var e = [], i = 1; i < arguments.length; i++)
                e[i - 1] = arguments[i];
            if (null === this.provider)
                throw new Error("Can not request an ad without an provider, please attach an ad provider!");
            e.unshift(t),
            this.provider.showAd.apply(this.provider, e)
        }
        ,
        t.prototype.createBanner = function() {
            for (var t = [], e = 0; e < arguments.length; e++)
                t[e] = arguments[e];
            return this.provider.loadBanner.apply(this.provider, t)
        }
        ,
        t.prototype.loadBanner = function() {
            for (var t = [], e = 0; e < arguments.length; e++)
                t[e] = arguments[e];
            return this.provider.loadBanner.apply(this.provider, t)
        }
        ,
        t.prototype.preloadAd = function(t) {
            for (var e = [], i = 1; i < arguments.length; i++)
                e[i - 1] = arguments[i];
            if (null === this.provider)
                throw new Error("Can not preload an ad without an provider, please attach an ad provider!");
            e.unshift(t),
            this.provider.preloadAd.apply(this.provider, e)
        }
        ,
        t.prototype.destroyAd = function(t) {
            for (var e = [], i = 1; i < arguments.length; i++)
                e[i - 1] = arguments[i];
            if (null === this.provider)
                throw new Error("Can not destroy an ad without an provider, please attach an ad provider!");
            e.unshift(t),
            this.provider.destroyAd.apply(this.provider, e)
        }
        ,
        t.prototype.hideAd = function(t) {
            for (var e = [], i = 1; i < arguments.length; i++)
                e[i - 1] = arguments[i];
            if (null === this.provider)
                throw new Error("Can not hide an ad without an provider, please attach an ad provider!");
            e.unshift(t),
            this.provider.hideAd.apply(this.provider, e)
        }
        ,
        t.prototype.adsEnabled = function() {
            if (null === this.provider)
                throw new Error("Can not hide an ad without an provider, please attach an ad provider!");
            return this.provider.adsEnabled
        }
        ,
        t.prototype.adAvailable = function(t) {
            for (var e = [], i = 1; i < arguments.length; i++)
                e[i - 1] = arguments[i];
            if (null === this.provider)
                throw new Error("Can not hide an ad without an provider, please attach an ad provider!");
            return e.unshift(t),
            this.provider.adAvailable.apply(this.provider, e)
        }
        ,
        t
    }(h)
      , P = new C;
    s.H5AdWrapper = C,
    s.adWrapper = P,
    s.CocoonAds = A,
    s.CordovaGamedistribution = l,
    s.CordovaHeyzap = c,
    s.CordovaIronSource = d,
    s.GameDistribution = f,
    s.GameDistributionBanner = g,
    s.Ima3 = b,
    Object.defineProperty(s, "__esModule", {
        value: !0
    })
}),
function(t) {
    var e, h, i, l, s, n, r, o, a, c, d, u, p = p || function(a, t) {
        var e = {}
          , i = e.lib = {}
          , s = function() {}
          , n = i.Base = {
            extend: function(t) {
                s.prototype = this;
                var e = new s;
                return t && e.mixIn(t),
                e.hasOwnProperty("init") || (e.init = function() {
                    e.$super.init.apply(this, arguments)
                }
                ),
                (e.init.prototype = e).$super = this,
                e
            },
            create: function() {
                var t = this.extend();
                return t.init.apply(t, arguments),
                t
            },
            init: function() {},
            mixIn: function(t) {
                for (var e in t)
                    t.hasOwnProperty(e) && (this[e] = t[e]);
                t.hasOwnProperty("toString") && (this.toString = t.toString)
            },
            clone: function() {
                return this.init.prototype.extend(this)
            }
        }
          , h = i.WordArray = n.extend({
            init: function(t, e) {
                t = this.words = t || [],
                this.sigBytes = null != e ? e : 4 * t.length
            },
            toString: function(t) {
                return (t || o).stringify(this)
            },
            concat: function(t) {
                var e = this.words
                  , i = t.words
                  , s = this.sigBytes;
                if (t = t.sigBytes,
                this.clamp(),
                s % 4)
                    for (var n = 0; n < t; n++)
                        e[s + n >>> 2] |= (i[n >>> 2] >>> 24 - n % 4 * 8 & 255) << 24 - (s + n) % 4 * 8;
                else if (65535 < i.length)
                    for (n = 0; n < t; n += 4)
                        e[s + n >>> 2] = i[n >>> 2];
                else
                    e.push.apply(e, i);
                return this.sigBytes += t,
                this
            },
            clamp: function() {
                var t = this.words
                  , e = this.sigBytes;
                t[e >>> 2] &= 4294967295 << 32 - e % 4 * 8,
                t.length = a.ceil(e / 4)
            },
            clone: function() {
                var t = n.clone.call(this);
                return t.words = this.words.slice(0),
                t
            },
            random: function(t) {
                for (var e = [], i = 0; i < t; i += 4)
                    e.push(4294967296 * a.random() | 0);
                return new h.init(e,t)
            }
        })
          , r = e.enc = {}
          , o = r.Hex = {
            stringify: function(t) {
                var e = t.words;
                t = t.sigBytes;
                for (var i = [], s = 0; s < t; s++) {
                    var n = e[s >>> 2] >>> 24 - s % 4 * 8 & 255;
                    i.push((n >>> 4).toString(16)),
                    i.push((15 & n).toString(16))
                }
                return i.join("")
            },
            parse: function(t) {
                for (var e = t.length, i = [], s = 0; s < e; s += 2)
                    i[s >>> 3] |= parseInt(t.substr(s, 2), 16) << 24 - s % 8 * 4;
                return new h.init(i,e / 2)
            }
        }
          , l = r.Latin1 = {
            stringify: function(t) {
                var e = t.words;
                t = t.sigBytes;
                for (var i = [], s = 0; s < t; s++)
                    i.push(String.fromCharCode(e[s >>> 2] >>> 24 - s % 4 * 8 & 255));
                return i.join("")
            },
            parse: function(t) {
                for (var e = t.length, i = [], s = 0; s < e; s++)
                    i[s >>> 2] |= (255 & t.charCodeAt(s)) << 24 - s % 4 * 8;
                return new h.init(i,e)
            }
        }
          , c = r.Utf8 = {
            stringify: function(t) {
                try {
                    return decodeURIComponent(escape(l.stringify(t)))
                } catch (t) {
                    throw Error("Malformed UTF-8 data")
                }
            },
            parse: function(t) {
                return l.parse(unescape(encodeURIComponent(t)))
            }
        }
          , d = i.BufferedBlockAlgorithm = n.extend({
            reset: function() {
                this._data = new h.init,
                this._nDataBytes = 0
            },
            _append: function(t) {
                "string" == typeof t && (t = c.parse(t)),
                this._data.concat(t),
                this._nDataBytes += t.sigBytes
            },
            _process: function(t) {
                var e = this._data
                  , i = e.words
                  , s = e.sigBytes
                  , n = this.blockSize
                  , r = s / (4 * n);
                if (t = (r = t ? a.ceil(r) : a.max((0 | r) - this._minBufferSize, 0)) * n,
                s = a.min(4 * t, s),
                t) {
                    for (var o = 0; o < t; o += n)
                        this._doProcessBlock(i, o);
                    o = i.splice(0, t),
                    e.sigBytes -= s
                }
                return new h.init(o,s)
            },
            clone: function() {
                var t = n.clone.call(this);
                return t._data = this._data.clone(),
                t
            },
            _minBufferSize: 0
        });
        i.Hasher = d.extend({
            cfg: n.extend(),
            init: function(t) {
                this.cfg = this.cfg.extend(t),
                this.reset()
            },
            reset: function() {
                d.reset.call(this),
                this._doReset()
            },
            update: function(t) {
                return this._append(t),
                this._process(),
                this
            },
            finalize: function(t) {
                return t && this._append(t),
                this._doFinalize()
            },
            blockSize: 16,
            _createHelper: function(i) {
                return function(t, e) {
                    return new i.init(e).finalize(t)
                }
            },
            _createHmacHelper: function(i) {
                return function(t, e) {
                    return new u.HMAC.init(i,e).finalize(t)
                }
            }
        });
        var u = e.algo = {};
        return e
    }(Math);
    !function(n) {
        for (var t = p, e = (s = t.lib).WordArray, i = s.Hasher, s = t.algo, r = [], g = [], o = function(t) {
            return 4294967296 * (t - (0 | t)) | 0
        }, a = 2, h = 0; h < 64; ) {
            var l;
            t: {
                l = a;
                for (var c = n.sqrt(l), d = 2; d <= c; d++)
                    if (!(l % d)) {
                        l = !1;
                        break t
                    }
                l = !0
            }
            l && (h < 8 && (r[h] = o(n.pow(a, .5))),
            g[h] = o(n.pow(a, 1 / 3)),
            h++),
            a++
        }
        var f = [];
        s = s.SHA256 = i.extend({
            _doReset: function() {
                this._hash = new e.init(r.slice(0))
            },
            _doProcessBlock: function(t, e) {
                for (var i = this._hash.words, s = i[0], n = i[1], r = i[2], o = i[3], a = i[4], h = i[5], l = i[6], c = i[7], d = 0; d < 64; d++) {
                    if (d < 16)
                        f[d] = 0 | t[e + d];
                    else {
                        var u = f[d - 15]
                          , p = f[d - 2];
                        f[d] = ((u << 25 | u >>> 7) ^ (u << 14 | u >>> 18) ^ u >>> 3) + f[d - 7] + ((p << 15 | p >>> 17) ^ (p << 13 | p >>> 19) ^ p >>> 10) + f[d - 16]
                    }
                    u = c + ((a << 26 | a >>> 6) ^ (a << 21 | a >>> 11) ^ (a << 7 | a >>> 25)) + (a & h ^ ~a & l) + g[d] + f[d],
                    p = ((s << 30 | s >>> 2) ^ (s << 19 | s >>> 13) ^ (s << 10 | s >>> 22)) + (s & n ^ s & r ^ n & r),
                    c = l,
                    l = h,
                    h = a,
                    a = o + u | 0,
                    o = r,
                    r = n,
                    n = s,
                    s = u + p | 0
                }
                i[0] = i[0] + s | 0,
                i[1] = i[1] + n | 0,
                i[2] = i[2] + r | 0,
                i[3] = i[3] + o | 0,
                i[4] = i[4] + a | 0,
                i[5] = i[5] + h | 0,
                i[6] = i[6] + l | 0,
                i[7] = i[7] + c | 0
            },
            _doFinalize: function() {
                var t = this._data
                  , e = t.words
                  , i = 8 * this._nDataBytes
                  , s = 8 * t.sigBytes;
                return e[s >>> 5] |= 128 << 24 - s % 32,
                e[14 + (s + 64 >>> 9 << 4)] = n.floor(i / 4294967296),
                e[15 + (s + 64 >>> 9 << 4)] = i,
                t.sigBytes = 4 * e.length,
                this._process(),
                this._hash
            },
            clone: function() {
                var t = i.clone.call(this);
                return t._hash = this._hash.clone(),
                t
            }
        });
        t.SHA256 = i._createHelper(s),
        t.HmacSHA256 = i._createHmacHelper(s)
    }(Math),
    l = (i = p).enc.Utf8,
    i.algo.HMAC = i.lib.Base.extend({
        init: function(t, e) {
            t = this._hasher = new t.init,
            "string" == typeof e && (e = l.parse(e));
            var i = t.blockSize
              , s = 4 * i;
            e.sigBytes > s && (e = t.finalize(e)),
            e.clamp();
            for (var n = this._oKey = e.clone(), r = this._iKey = e.clone(), o = n.words, a = r.words, h = 0; h < i; h++)
                o[h] ^= 1549556828,
                a[h] ^= 909522486;
            n.sigBytes = r.sigBytes = s,
            this.reset()
        },
        reset: function() {
            var t = this._hasher;
            t.reset(),
            t.update(this._iKey)
        },
        update: function(t) {
            return this._hasher.update(t),
            this
        },
        finalize: function(t) {
            var e = this._hasher;
            return t = e.finalize(t),
            e.reset(),
            e.finalize(this._oKey.clone().concat(t))
        }
    }),
    h = (e = p).lib.WordArray,
    e.enc.Base64 = {
        stringify: function(t) {
            var e = t.words
              , i = t.sigBytes
              , s = this._map;
            t.clamp(),
            t = [];
            for (var n = 0; n < i; n += 3)
                for (var r = (e[n >>> 2] >>> 24 - n % 4 * 8 & 255) << 16 | (e[n + 1 >>> 2] >>> 24 - (n + 1) % 4 * 8 & 255) << 8 | e[n + 2 >>> 2] >>> 24 - (n + 2) % 4 * 8 & 255, o = 0; o < 4 && n + .75 * o < i; o++)
                    t.push(s.charAt(r >>> 6 * (3 - o) & 63));
            if (e = s.charAt(64))
                for (; t.length % 4; )
                    t.push(e);
            return t.join("")
        },
        parse: function(t) {
            var e = t.length
              , i = this._map;
            (s = i.charAt(64)) && -1 != (s = t.indexOf(s)) && (e = s);
            for (var s = [], n = 0, r = 0; r < e; r++)
                if (r % 4) {
                    var o = i.indexOf(t.charAt(r - 1)) << r % 4 * 2
                      , a = i.indexOf(t.charAt(r)) >>> 6 - r % 4 * 2;
                    s[n >>> 2] |= (o | a) << 24 - n % 4 * 8,
                    n++
                }
            return h.create(s, n)
        },
        _map: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="
    },
    s = wt || (wt = {}),
    (n = s.EGAErrorSeverity || (s.EGAErrorSeverity = {}))[n.Undefined = 0] = "Undefined",
    n[n.Debug = 1] = "Debug",
    n[n.Info = 2] = "Info",
    n[n.Warning = 3] = "Warning",
    n[n.Error = 4] = "Error",
    n[n.Critical = 5] = "Critical",
    (r = s.EGAGender || (s.EGAGender = {}))[r.Undefined = 0] = "Undefined",
    r[r.Male = 1] = "Male",
    r[r.Female = 2] = "Female",
    (o = s.EGAProgressionStatus || (s.EGAProgressionStatus = {}))[o.Undefined = 0] = "Undefined",
    o[o.Start = 1] = "Start",
    o[o.Complete = 2] = "Complete",
    o[o.Fail = 3] = "Fail",
    (a = s.EGAResourceFlowType || (s.EGAResourceFlowType = {}))[a.Undefined = 0] = "Undefined",
    a[a.Source = 1] = "Source",
    a[a.Sink = 2] = "Sink",
    c = s.http || (s.http = {}),
    (d = c.EGASdkErrorType || (c.EGASdkErrorType = {}))[d.Undefined = 0] = "Undefined",
    d[d.Rejected = 1] = "Rejected",
    (u = c.EGAHTTPApiResponse || (c.EGAHTTPApiResponse = {}))[u.NoResponse = 0] = "NoResponse",
    u[u.BadResponse = 1] = "BadResponse",
    u[u.RequestTimeout = 2] = "RequestTimeout",
    u[u.JsonEncodeFailed = 3] = "JsonEncodeFailed",
    u[u.JsonDecodeFailed = 4] = "JsonDecodeFailed",
    u[u.InternalServerError = 5] = "InternalServerError",
    u[u.BadRequest = 6] = "BadRequest",
    u[u.Unauthorized = 7] = "Unauthorized",
    u[u.UnknownResponseCode = 8] = "UnknownResponseCode",
    u[u.Ok = 9] = "Ok";
    var g, f, m, y, v, _, b, w, x, S, T, A, C, P, E, I, k, M, R, B, O, L, G, D, F, U, N, W, H, X, j, q, V, z, Y, K, J, Q, Z, $, tt, et, it, st, nt, rt, ot, at, ht, lt, ct, dt, ut, pt, gt, ft, mt, yt, vt, _t, bt, wt, xt, St, Tt, At, Ct, Pt, Et, It, kt, Mt, Rt, Bt;
    wt.EGAErrorSeverity,
    wt.EGAGender,
    wt.EGAProgressionStatus,
    wt.EGAResourceFlowType;
    (function(t) {
        var s, e;
        (e = s || (s = {}))[e.Error = 0] = "Error",
        e[e.Warning = 1] = "Warning",
        e[e.Info = 2] = "Info",
        e[e.Debug = 3] = "Debug";
        var i = function() {
            function i() {
                i.debugEnabled = !1
            }
            return i.setInfoLog = function(t) {
                i.instance.infoLogEnabled = t
            }
            ,
            i.setVerboseLog = function(t) {
                i.instance.infoLogVerboseEnabled = t
            }
            ,
            i.i = function(t) {
                if (i.instance.infoLogEnabled) {
                    var e = "Info/" + i.Tag + ": " + t;
                    i.instance.sendNotificationMessage(e, s.Info)
                }
            }
            ,
            i.w = function(t) {
                var e = "Warning/" + i.Tag + ": " + t;
                i.instance.sendNotificationMessage(e, s.Warning)
            }
            ,
            i.e = function(t) {
                var e = "Error/" + i.Tag + ": " + t;
                i.instance.sendNotificationMessage(e, s.Error)
            }
            ,
            i.ii = function(t) {
                if (i.instance.infoLogVerboseEnabled) {
                    var e = "Verbose/" + i.Tag + ": " + t;
                    i.instance.sendNotificationMessage(e, s.Info)
                }
            }
            ,
            i.d = function(t) {
                if (i.debugEnabled) {
                    var e = "Debug/" + i.Tag + ": " + t;
                    i.instance.sendNotificationMessage(e, s.Debug)
                }
            }
            ,
            i.prototype.sendNotificationMessage = function(t, e) {
                switch (e) {
                case s.Error:
                case s.Warning:
                    break;
                case s.Debug:
                    console.debug;
                    break;
                case s.Info:
                }
            }
            ,
            i.instance = new i,
            i.Tag = "GameAnalytics",
            i
        }();
        t.GALogger = i
    }
    )((g = wt || (wt = {})).logging || (g.logging = {})),
    f = wt || (wt = {}),
    m = f.utilities || (f.utilities = {}),
    y = f.logging.GALogger,
    v = function() {
        function c() {}
        return c.getHmac = function(t, e) {
            var i = p.HmacSHA256(e, t);
            return p.enc.Base64.stringify(i)
        }
        ,
        c.stringMatch = function(t, e) {
            return !(!t || !e) && e.test(t)
        }
        ,
        c.joinStringArray = function(t, e) {
            for (var i = "", s = 0, n = t.length; s < n; s++)
                0 < s && (i += e),
                i += t[s];
            return i
        }
        ,
        c.stringArrayContainsString = function(t, e) {
            if (0 === t.length)
                return !1;
            for (var i in t)
                if (t[i] === e)
                    return !0;
            return !1
        }
        ,
        c.encode64 = function(t) {
            t = encodeURI(t);
            for (var e, i, s, n, r, o = "", a = 0, h = 0, l = 0; s = (e = t.charCodeAt(l++)) >> 2,
            n = (3 & e) << 4 | (i = t.charCodeAt(l++)) >> 4,
            r = (15 & i) << 2 | (a = t.charCodeAt(l++)) >> 6,
            h = 63 & a,
            isNaN(i) ? r = h = 64 : isNaN(a) && (h = 64),
            o = o + c.keyStr.charAt(s) + c.keyStr.charAt(n) + c.keyStr.charAt(r) + c.keyStr.charAt(h),
            e = i = a = 0,
            s = n = r = h = 0,
            l < t.length; )
                ;
            return o
        }
        ,
        c.decode64 = function(t) {
            var e, i, s, n, r = "", o = 0, a = 0, h = 0;
            for (/[^A-Za-z0-9\+\/\=]/g.exec(t) && y.w("There were invalid base64 characters in the input text. Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='. Expect errors in decoding."),
            t = t.replace(/[^A-Za-z0-9\+\/\=]/g, ""); e = c.keyStr.indexOf(t.charAt(h++)) << 2 | (s = c.keyStr.indexOf(t.charAt(h++))) >> 4,
            i = (15 & s) << 4 | (n = c.keyStr.indexOf(t.charAt(h++))) >> 2,
            o = (3 & n) << 6 | (a = c.keyStr.indexOf(t.charAt(h++))),
            r += String.fromCharCode(e),
            64 != n && (r += String.fromCharCode(i)),
            64 != a && (r += String.fromCharCode(o)),
            e = i = o = 0,
            s = n = a = 0,
            h < t.length; )
                ;
            return decodeURI(r)
        }
        ,
        c.timeIntervalSince1970 = function() {
            var t = new Date;
            return Math.round(t.getTime() / 1e3)
        }
        ,
        c.createGuid = function() {
            return (c.s4() + c.s4() + "-" + c.s4() + "-4" + c.s4().substr(0, 3) + "-" + c.s4() + "-" + c.s4() + c.s4() + c.s4()).toLowerCase()
        }
        ,
        c.s4 = function() {
            return (65536 * (1 + Math.random()) | 0).toString(16).substring(1)
        }
        ,
        c.keyStr = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",
        c
    }(),
    m.GAUtilities = v,
    _ = wt || (wt = {}),
    b = _.validators || (_.validators = {}),
    w = _.logging.GALogger,
    x = _.http.EGASdkErrorType,
    S = _.utilities.GAUtilities,
    T = function() {
        function a() {}
        return a.validateBusinessEvent = function(t, e, i, s, n) {
            return a.validateCurrency(t) ? e < 0 ? (w.w("Validation fail - business event - amount. Cannot be less than 0. Failed amount: " + e),
            !1) : a.validateShortString(i, !0) ? a.validateEventPartLength(s, !1) ? a.validateEventPartCharacters(s) ? a.validateEventPartLength(n, !1) ? !!a.validateEventPartCharacters(n) || (w.w("Validation fail - business event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: " + n),
            !1) : (w.w("Validation fail - business event - itemId. Cannot be (null), empty or above 64 characters. String: " + n),
            !1) : (w.w("Validation fail - business event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: " + s),
            !1) : (w.w("Validation fail - business event - itemType: Cannot be (null), empty or above 64 characters. String: " + s),
            !1) : (w.w("Validation fail - business event - cartType. Cannot be above 32 length. String: " + i),
            !1) : (w.w("Validation fail - business event - currency: Cannot be (null) and need to be A-Z, 3 characters and in the standard at openexchangerates.org. Failed currency: " + t),
            !1)
        }
        ,
        a.validateResourceEvent = function(t, e, i, s, n, r, o) {
            return t == _.EGAResourceFlowType.Undefined ? (w.w("Validation fail - resource event - flowType: Invalid flow type."),
            !1) : e ? S.stringArrayContainsString(r, e) ? 0 < i ? s ? a.validateEventPartLength(s, !1) ? a.validateEventPartCharacters(s) ? S.stringArrayContainsString(o, s) ? a.validateEventPartLength(n, !1) ? !!a.validateEventPartCharacters(n) || (w.w("Validation fail - resource event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: " + n),
            !1) : (w.w("Validation fail - resource event - itemId: Cannot be (null), empty or above 64 characters. String: " + n),
            !1) : (w.w("Validation fail - resource event - itemType: Not found in list of pre-defined available resource itemTypes. String: " + s),
            !1) : (w.w("Validation fail - resource event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: " + s),
            !1) : (w.w("Validation fail - resource event - itemType: Cannot be (null), empty or above 64 characters. String: " + s),
            !1) : (w.w("Validation fail - resource event - itemType: Cannot be (null)"),
            !1) : (w.w("Validation fail - resource event - amount: Float amount cannot be 0 or negative. Value: " + i),
            !1) : (w.w("Validation fail - resource event - currency: Not found in list of pre-defined available resource currencies. String: " + e),
            !1) : (w.w("Validation fail - resource event - currency: Cannot be (null)"),
            !1)
        }
        ,
        a.validateProgressionEvent = function(t, e, i, s) {
            if (t == _.EGAProgressionStatus.Undefined)
                return w.w("Validation fail - progression event: Invalid progression status."),
                !1;
            if (s && !i && e)
                return w.w("Validation fail - progression event: 03 found but 01+02 are invalid. Progression must be set as either 01, 01+02 or 01+02+03."),
                !1;
            if (i && !e)
                return w.w("Validation fail - progression event: 02 found but not 01. Progression must be set as either 01, 01+02 or 01+02+03"),
                !1;
            if (!e)
                return w.w("Validation fail - progression event: progression01 not valid. Progressions must be set as either 01, 01+02 or 01+02+03"),
                !1;
            if (!a.validateEventPartLength(e, !1))
                return w.w("Validation fail - progression event - progression01: Cannot be (null), empty or above 64 characters. String: " + e),
                !1;
            if (!a.validateEventPartCharacters(e))
                return w.w("Validation fail - progression event - progression01: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: " + e),
                !1;
            if (i) {
                if (!a.validateEventPartLength(i, !0))
                    return w.w("Validation fail - progression event - progression02: Cannot be empty or above 64 characters. String: " + i),
                    !1;
                if (!a.validateEventPartCharacters(i))
                    return w.w("Validation fail - progression event - progression02: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: " + i),
                    !1
            }
            if (s) {
                if (!a.validateEventPartLength(s, !0))
                    return w.w("Validation fail - progression event - progression03: Cannot be empty or above 64 characters. String: " + s),
                    !1;
                if (!a.validateEventPartCharacters(s))
                    return w.w("Validation fail - progression event - progression03: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: " + s),
                    !1
            }
            return !0
        }
        ,
        a.validateDesignEvent = function(t, e) {
            return a.validateEventIdLength(t) ? !!a.validateEventIdCharacters(t) || (w.w("Validation fail - design event - eventId: Non valid characters. Only allowed A-z, 0-9, -_., ()!?. String: " + t),
            !1) : (w.w("Validation fail - design event - eventId: Cannot be (null) or empty. Only 5 event parts allowed seperated by :. Each part need to be 32 characters or less. String: " + t),
            !1)
        }
        ,
        a.validateErrorEvent = function(t, e) {
            return t == _.EGAErrorSeverity.Undefined ? (w.w("Validation fail - error event - severity: Severity was unsupported value."),
            !1) : !!a.validateLongString(e, !0) || (w.w("Validation fail - error event - message: Message cannot be above 8192 characters."),
            !1)
        }
        ,
        a.validateSdkErrorEvent = function(t, e, i) {
            return !(!a.validateKeys(t, e) || i === x.Undefined && (w.w("Validation fail - sdk error event - type: Type was unsupported value."),
            1))
        }
        ,
        a.validateKeys = function(t, e) {
            return !(!S.stringMatch(t, /^[A-z0-9]{32}$/) || !S.stringMatch(e, /^[A-z0-9]{40}$/))
        }
        ,
        a.validateCurrency = function(t) {
            return !!t && !!S.stringMatch(t, /^[A-Z]{3}$/)
        }
        ,
        a.validateEventPartLength = function(t, e) {
            return !(!e || t) || !!t && !(64 < t.length)
        }
        ,
        a.validateEventPartCharacters = function(t) {
            return !!S.stringMatch(t, /^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}$/)
        }
        ,
        a.validateEventIdLength = function(t) {
            return !!t && !!S.stringMatch(t, /^[^:]{1,64}(?::[^:]{1,64}){0,4}$/)
        }
        ,
        a.validateEventIdCharacters = function(t) {
            return !!t && !!S.stringMatch(t, /^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}(:[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}){0,4}$/)
        }
        ,
        a.validateAndCleanInitRequestResponse = function(t) {
            if (null == t)
                return w.w("validateInitRequestResponse failed - no response dictionary."),
                null;
            var e = {};
            try {
                e.enabled = t.enabled
            } catch (t) {
                return w.w("validateInitRequestResponse failed - invalid type in 'enabled' field."),
                null
            }
            try {
                var i = t.server_ts;
                if (!(0 < i))
                    return w.w("validateInitRequestResponse failed - invalid value in 'server_ts' field."),
                    null;
                e.server_ts = i
            } catch (e) {
                return w.w("validateInitRequestResponse failed - invalid type in 'server_ts' field. type=" + typeof t.server_ts + ", value=" + t.server_ts + ", " + e),
                null
            }
            try {
                var s = t.configurations;
                e.configurations = s
            } catch (e) {
                return w.w("validateInitRequestResponse failed - invalid type in 'configurations' field. type=" + typeof t.configurations + ", value=" + t.configurations + ", " + e),
                null
            }
            return e
        }
        ,
        a.validateBuild = function(t) {
            return !!a.validateShortString(t, !1)
        }
        ,
        a.validateSdkWrapperVersion = function(t) {
            return !!S.stringMatch(t, /^(unity|unreal|gamemaker|cocos2d|construct|defold) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/)
        }
        ,
        a.validateEngineVersion = function(t) {
            return !(!t || !S.stringMatch(t, /^(unity|unreal|gamemaker|cocos2d|construct|defold) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/))
        }
        ,
        a.validateUserId = function(t) {
            return !!a.validateString(t, !1) || (w.w("Validation fail - user id: id cannot be (null), empty or above 64 characters."),
            !1)
        }
        ,
        a.validateShortString = function(t, e) {
            return !(!e || t) || !(!t || 32 < t.length)
        }
        ,
        a.validateString = function(t, e) {
            return !(!e || t) || !(!t || 64 < t.length)
        }
        ,
        a.validateLongString = function(t, e) {
            return !(!e || t) || !(!t || 8192 < t.length)
        }
        ,
        a.validateConnectionType = function(t) {
            return S.stringMatch(t, /^(wwan|wifi|lan|offline)$/)
        }
        ,
        a.validateCustomDimensions = function(t) {
            return a.validateArrayOfStrings(20, 32, !1, "custom dimensions", t)
        }
        ,
        a.validateResourceCurrencies = function(t) {
            if (!a.validateArrayOfStrings(20, 64, !1, "resource currencies", t))
                return !1;
            for (var e = 0; e < t.length; ++e)
                if (!S.stringMatch(t[e], /^[A-Za-z]+$/))
                    return w.w("resource currencies validation failed: a resource currency can only be A-Z, a-z. String was: " + t[e]),
                    !1;
            return !0
        }
        ,
        a.validateResourceItemTypes = function(t) {
            if (!a.validateArrayOfStrings(20, 32, !1, "resource item types", t))
                return !1;
            for (var e = 0; e < t.length; ++e)
                if (!a.validateEventPartCharacters(t[e]))
                    return w.w("resource item types validation failed: a resource item type cannot contain other characters than A-z, 0-9, -_., ()!?. String was: " + t[e]),
                    !1;
            return !0
        }
        ,
        a.validateDimension01 = function(t, e) {
            return !t || !!S.stringArrayContainsString(e, t)
        }
        ,
        a.validateDimension02 = function(t, e) {
            return !t || !!S.stringArrayContainsString(e, t)
        }
        ,
        a.validateDimension03 = function(t, e) {
            return !t || !!S.stringArrayContainsString(e, t)
        }
        ,
        a.validateArrayOfStrings = function(t, e, i, s, n) {
            var r = s;
            if (r || (r = "Array"),
            !n)
                return w.w(r + " validation failed: array cannot be null. "),
                !1;
            if (0 == i && 0 == n.length)
                return w.w(r + " validation failed: array cannot be empty. "),
                !1;
            if (0 < t && n.length > t)
                return w.w(r + " validation failed: array cannot exceed " + t + " values. It has " + n.length + " values."),
                !1;
            for (var o = 0; o < n.length; ++o) {
                var a = n[o] ? n[o].length : 0;
                if (0 === a)
                    return w.w(r + " validation failed: contained an empty string. Array=" + JSON.stringify(n)),
                    !1;
                if (0 < e && e < a)
                    return w.w(r + " validation failed: a string exceeded max allowed length (which is: " + e + "). String was: " + n[o]),
                    !1
            }
            return !0
        }
        ,
        a.validateFacebookId = function(t) {
            return !!a.validateString(t, !1) || (w.w("Validation fail - facebook id: id cannot be (null), empty or above 64 characters."),
            !1)
        }
        ,
        a.validateGender = function(t) {
            if (isNaN(Number(_.EGAGender[t]))) {
                if (t == _.EGAGender.Undefined || t != _.EGAGender.Male && t != _.EGAGender.Female)
                    return w.w("Validation fail - gender: Has to be 'male' or 'female'. Was: " + t),
                    !1
            } else if (t == _.EGAGender[_.EGAGender.Undefined] || t != _.EGAGender[_.EGAGender.Male] && t != _.EGAGender[_.EGAGender.Female])
                return w.w("Validation fail - gender: Has to be 'male' or 'female'. Was: " + t),
                !1;
            return !0
        }
        ,
        a.validateBirthyear = function(t) {
            return !(t < 0 || 9999 < t) || (w.w("Validation fail - birthYear: Cannot be (null) or invalid range."),
            !1)
        }
        ,
        a.validateClientTs = function(t) {
            return !(t < -4294967294 || 4294967294 < t)
        }
        ,
        a
    }(),
    b.GAValidator = T,
    function(t) {
        var e = function(t, e, i) {
            this.name = t,
            this.value = e,
            this.version = i
        };
        t.NameValueVersion = e;
        var c = function(t, e) {
            this.name = t,
            this.version = e
        };
        t.NameVersion = c;
        var i = function() {
            function n() {}
            return n.touch = function() {}
            ,
            n.getRelevantSdkVersion = function() {
                return n.sdkGameEngineVersion ? n.sdkGameEngineVersion : n.sdkWrapperVersion
            }
            ,
            n.getConnectionType = function() {
                return n.connectionType
            }
            ,
            n.updateConnectionType = function() {
                n.connectionType = navigator.onLine ? "ios" === n.buildPlatform || "android" === n.buildPlatform ? "wwan" : "lan" : "offline"
            }
            ,
            n.getOSVersionString = function() {
                return n.buildPlatform + " " + n.osVersionPair.version
            }
            ,
            n.runtimePlatformToString = function() {
                return n.osVersionPair.name
            }
            ,
            n.getBrowserVersionString = function() {
                var t, e = navigator.userAgent, i = e.match(/(opera|chrome|safari|firefox|ubrowser|msie|trident|fbav(?=\/))\/?\s*(\d+)/i) || [];
                if (0 == i.length && "ios" === n.buildPlatform)
                    return "webkit_" + n.osVersion;
                if (/trident/i.test(i[1]))
                    return "IE " + ((t = /\brv[ :]+(\d+)/g.exec(e) || [])[1] || "");
                if ("Chrome" === i[1] && null != (t = e.match(/\b(OPR|Edge|UBrowser)\/(\d+)/)))
                    return t.slice(1).join(" ").replace("OPR", "Opera").replace("UBrowser", "UC").toLowerCase();
                if (i[1] && "fbav" === i[1].toLowerCase() && (i[1] = "facebook",
                i[2]))
                    return "facebook " + i[2];
                var s = i[2] ? [i[1], i[2]] : [navigator.appName, navigator.appVersion, "-?"];
                return null != (t = e.match(/version\/(\d+)/i)) && s.splice(1, 1, t[1]),
                s.join(" ").toLowerCase()
            }
            ,
            n.getDeviceModel = function() {
                return "unknown"
            }
            ,
            n.getDeviceManufacturer = function() {
                return "unknown"
            }
            ,
            n.matchItem = function(t, e) {
                var i, s, n, r, o = new c("unknown","0.0.0"), a = 0, h = 0;
                for (a = 0; a < e.length; a += 1)
                    if (new RegExp(e[a].value,"i").test(t)) {
                        if (i = new RegExp(e[a].version + "[- /:;]([\\d._]+)","i"),
                        r = "",
                        (s = t.match(i)) && s[1] && (n = s[1]),
                        n) {
                            var l = n.split(/[._]+/);
                            for (h = 0; h < Math.min(l.length, 3); h += 1)
                                r += l[h] + (h < Math.min(l.length, 3) - 1 ? "." : "")
                        } else
                            r = "0.0.0";
                        return o.name = e[a].name,
                        o.version = r,
                        o
                    }
                return o
            }
            ,
            n.sdkWrapperVersion = "javascript 3.1.2",
            n.osVersionPair = n.matchItem([navigator.platform, navigator.userAgent, navigator.appVersion, navigator.vendor].join(" "), [new e("windows_phone","Windows Phone","OS"), new e("windows","Win","NT"), new e("ios","iPhone","OS"), new e("ios","iPad","OS"), new e("ios","iPod","OS"), new e("android","Android","Android"), new e("blackBerry","BlackBerry","/"), new e("mac_osx","Mac","OS X"), new e("tizen","Tizen","Tizen"), new e("linux","Linux","rv")]),
            n.buildPlatform = n.runtimePlatformToString(),
            n.deviceModel = n.getDeviceModel(),
            n.deviceManufacturer = n.getDeviceManufacturer(),
            n.osVersion = n.getOSVersionString(),
            n.browserVersion = n.getBrowserVersionString(),
            n.maxSafeInteger = Math.pow(2, 53) - 1,
            n
        }();
        t.GADevice = i
    }((A = wt || (wt = {})).device || (A.device = {})),
    C = wt || (wt = {}),
    P = C.threading || (C.threading = {}),
    E = function() {
        function e(t) {
            this.deadline = t,
            this.ignore = !1,
            this.async = !1,
            this.running = !1,
            this.id = ++e.idCounter
        }
        return e.idCounter = 0,
        e
    }(),
    P.TimedBlock = E,
    I = wt || (wt = {}),
    k = I.threading || (I.threading = {}),
    M = function() {
        function t(t) {
            this.comparer = t,
            this._subQueues = {},
            this._sortedKeys = []
        }
        return t.prototype.enqueue = function(t, e) {
            -1 === this._sortedKeys.indexOf(t) && this.addQueueOfPriority(t),
            this._subQueues[t].push(e)
        }
        ,
        t.prototype.addQueueOfPriority = function(t) {
            var i = this;
            this._sortedKeys.push(t),
            this._sortedKeys.sort(function(t, e) {
                return i.comparer.compare(t, e)
            }),
            this._subQueues[t] = []
        }
        ,
        t.prototype.peek = function() {
            if (this.hasItems())
                return this._subQueues[this._sortedKeys[0]][0];
            throw new Error("The queue is empty")
        }
        ,
        t.prototype.hasItems = function() {
            return 0 < this._sortedKeys.length
        }
        ,
        t.prototype.dequeue = function() {
            if (this.hasItems())
                return this.dequeueFromHighPriorityQueue();
            throw new Error("The queue is empty")
        }
        ,
        t.prototype.dequeueFromHighPriorityQueue = function() {
            var t = this._sortedKeys[0]
              , e = this._subQueues[t].shift();
            return 0 === this._subQueues[t].length && (this._sortedKeys.shift(),
            delete this._subQueues[t]),
            e
        }
        ,
        t
    }(),
    k.PriorityQueue = M,
    function(t) {
        var u, e, i, s, n = R.logging.GALogger;
        (e = u = t.EGAStoreArgsOperator || (t.EGAStoreArgsOperator = {}))[e.Equal = 0] = "Equal",
        e[e.LessOrEqual = 1] = "LessOrEqual",
        e[e.NotEqual = 2] = "NotEqual",
        (s = i = t.EGAStore || (t.EGAStore = {}))[s.Events = 0] = "Events",
        s[s.Sessions = 1] = "Sessions",
        s[s.Progression = 2] = "Progression";
        var r = function() {
            function d() {
                this.eventsStore = [],
                this.sessionsStore = [],
                this.progressionStore = [],
                this.storeItems = {};
                try {
                    d.storageAvailable = "object" == typeof localStorage && (localStorage.setItem("testingLocalStorage", "yes"),
                    localStorage.removeItem("testingLocalStorage"),
                    !0)
                } catch (t) {}
            }
            return d.isStorageAvailable = function() {
                return d.storageAvailable
            }
            ,
            d.isStoreTooLargeForEvents = function() {
                return d.instance.eventsStore.length + d.instance.sessionsStore.length > d.MaxNumberOfEntries
            }
            ,
            d.select = function(t, e, i, s) {
                void 0 === e && (e = []),
                void 0 === i && (i = !1),
                void 0 === s && (s = 0);
                var n = d.getStore(t);
                if (!n)
                    return null;
                for (var r = [], o = 0; o < n.length; ++o) {
                    for (var a = n[o], h = !0, l = 0; l < e.length; ++l) {
                        var c = e[l];
                        if (a[c[0]])
                            switch (c[1]) {
                            case u.Equal:
                                h = a[c[0]] == c[2];
                                break;
                            case u.LessOrEqual:
                                h = a[c[0]] <= c[2];
                                break;
                            case u.NotEqual:
                                h = a[c[0]] != c[2];
                                break;
                            default:
                                h = !1
                            }
                        else
                            h = !1;
                        if (!h)
                            break
                    }
                    h && r.push(a)
                }
                return i && r.sort(function(t, e) {
                    return t.client_ts - e.client_ts
                }),
                0 < s && r.length > s && (r = r.slice(0, s + 1)),
                r
            }
            ,
            d.update = function(t, e, i) {
                void 0 === i && (i = []);
                var s = d.getStore(t);
                if (!s)
                    return !1;
                for (var n = 0; n < s.length; ++n) {
                    for (var r = s[n], o = !0, a = 0; a < i.length; ++a) {
                        var h = i[a];
                        if (r[h[0]])
                            switch (h[1]) {
                            case u.Equal:
                                o = r[h[0]] == h[2];
                                break;
                            case u.LessOrEqual:
                                o = r[h[0]] <= h[2];
                                break;
                            case u.NotEqual:
                                o = r[h[0]] != h[2];
                                break;
                            default:
                                o = !1
                            }
                        else
                            o = !1;
                        if (!o)
                            break
                    }
                    if (o)
                        for (a = 0; a < e.length; ++a) {
                            var l = e[a];
                            r[l[0]] = l[1]
                        }
                }
                return !0
            }
            ,
            d.delete = function(t, e) {
                var i = d.getStore(t);
                if (i)
                    for (var s = 0; s < i.length; ++s) {
                        for (var n = i[s], r = !0, o = 0; o < e.length; ++o) {
                            var a = e[o];
                            if (n[a[0]])
                                switch (a[1]) {
                                case u.Equal:
                                    r = n[a[0]] == a[2];
                                    break;
                                case u.LessOrEqual:
                                    r = n[a[0]] <= a[2];
                                    break;
                                case u.NotEqual:
                                    r = n[a[0]] != a[2];
                                    break;
                                default:
                                    r = !1
                                }
                            else
                                r = !1;
                            if (!r)
                                break
                        }
                        r && (i.splice(s, 1),
                        --s)
                    }
            }
            ,
            d.insert = function(t, e, i, s) {
                void 0 === i && (i = !1),
                void 0 === s && (s = null);
                var n = d.getStore(t);
                if (n)
                    if (i) {
                        if (!s)
                            return;
                        for (var r = !1, o = 0; o < n.length; ++o) {
                            var a = n[o];
                            if (a[s] == e[s]) {
                                for (var h in e)
                                    a[h] = e[h];
                                r = !0;
                                break
                            }
                        }
                        r || n.push(e)
                    } else
                        n.push(e)
            }
            ,
            d.save = function() {
                d.isStorageAvailable() ? (localStorage.setItem(d.KeyPrefix + d.EventsStoreKey, JSON.stringify(d.instance.eventsStore)),
                localStorage.setItem(d.KeyPrefix + d.SessionsStoreKey, JSON.stringify(d.instance.sessionsStore)),
                localStorage.setItem(d.KeyPrefix + d.ProgressionStoreKey, JSON.stringify(d.instance.progressionStore)),
                localStorage.setItem(d.KeyPrefix + d.ItemsStoreKey, JSON.stringify(d.instance.storeItems))) : n.w("Storage is not available, cannot save.")
            }
            ,
            d.load = function() {
                if (d.isStorageAvailable()) {
                    try {
                        d.instance.eventsStore = JSON.parse(localStorage.getItem(d.KeyPrefix + d.EventsStoreKey)),
                        d.instance.eventsStore || (d.instance.eventsStore = [])
                    } catch (t) {
                        n.w("Load failed for 'events' store. Using empty store."),
                        d.instance.eventsStore = []
                    }
                    try {
                        d.instance.sessionsStore = JSON.parse(localStorage.getItem(d.KeyPrefix + d.SessionsStoreKey)),
                        d.instance.sessionsStore || (d.instance.sessionsStore = [])
                    } catch (t) {
                        n.w("Load failed for 'sessions' store. Using empty store."),
                        d.instance.sessionsStore = []
                    }
                    try {
                        d.instance.progressionStore = JSON.parse(localStorage.getItem(d.KeyPrefix + d.ProgressionStoreKey)),
                        d.instance.progressionStore || (d.instance.progressionStore = [])
                    } catch (t) {
                        n.w("Load failed for 'progression' store. Using empty store."),
                        d.instance.progressionStore = []
                    }
                    try {
                        d.instance.storeItems = JSON.parse(localStorage.getItem(d.KeyPrefix + d.ItemsStoreKey)),
                        d.instance.storeItems || (d.instance.storeItems = {})
                    } catch (t) {
                        n.w("Load failed for 'items' store. Using empty store."),
                        d.instance.progressionStore = []
                    }
                } else
                    n.w("Storage is not available, cannot load.")
            }
            ,
            d.setItem = function(t, e) {
                var i = d.KeyPrefix + t;
                e ? d.instance.storeItems[i] = e : i in d.instance.storeItems && delete d.instance.storeItems[i]
            }
            ,
            d.getItem = function(t) {
                var e = d.KeyPrefix + t;
                return e in d.instance.storeItems ? d.instance.storeItems[e] : null
            }
            ,
            d.getStore = function(t) {
                switch (t) {
                case i.Events:
                    return d.instance.eventsStore;
                case i.Sessions:
                    return d.instance.sessionsStore;
                case i.Progression:
                    return d.instance.progressionStore;
                default:
                    return n.w("GAStore.getStore(): Cannot find store: " + t),
                    null
                }
            }
            ,
            d.instance = new d,
            d.MaxNumberOfEntries = 2e3,
            d.KeyPrefix = "GA::",
            d.EventsStoreKey = "ga_event",
            d.SessionsStoreKey = "ga_session",
            d.ProgressionStoreKey = "ga_progression",
            d.ItemsStoreKey = "ga_items",
            d
        }();
        t.GAStore = r
    }((R = wt || (wt = {})).store || (R.store = {})),
    B = wt || (wt = {}),
    O = B.state || (B.state = {}),
    L = B.validators.GAValidator,
    G = B.utilities.GAUtilities,
    D = B.logging.GALogger,
    F = B.store.GAStore,
    U = B.device.GADevice,
    N = B.store.EGAStore,
    W = B.store.EGAStoreArgsOperator,
    H = function() {
        function c() {
            this.availableCustomDimensions01 = [],
            this.availableCustomDimensions02 = [],
            this.availableCustomDimensions03 = [],
            this.availableResourceCurrencies = [],
            this.availableResourceItemTypes = [],
            this.configurations = {},
            this.commandCenterListeners = [],
            this.sdkConfigDefault = {},
            this.sdkConfig = {},
            this.progressionTries = {},
            this._isEventSubmissionEnabled = !0
        }
        return c.setUserId = function(t) {
            c.instance.userId = t,
            c.cacheIdentifier()
        }
        ,
        c.getIdentifier = function() {
            return c.instance.identifier
        }
        ,
        c.isInitialized = function() {
            return c.instance.initialized
        }
        ,
        c.setInitialized = function(t) {
            c.instance.initialized = t
        }
        ,
        c.getSessionStart = function() {
            return c.instance.sessionStart
        }
        ,
        c.getSessionNum = function() {
            return c.instance.sessionNum
        }
        ,
        c.getTransactionNum = function() {
            return c.instance.transactionNum
        }
        ,
        c.getSessionId = function() {
            return c.instance.sessionId
        }
        ,
        c.getCurrentCustomDimension01 = function() {
            return c.instance.currentCustomDimension01
        }
        ,
        c.getCurrentCustomDimension02 = function() {
            return c.instance.currentCustomDimension02
        }
        ,
        c.getCurrentCustomDimension03 = function() {
            return c.instance.currentCustomDimension03
        }
        ,
        c.getGameKey = function() {
            return c.instance.gameKey
        }
        ,
        c.getGameSecret = function() {
            return c.instance.gameSecret
        }
        ,
        c.getAvailableCustomDimensions01 = function() {
            return c.instance.availableCustomDimensions01
        }
        ,
        c.setAvailableCustomDimensions01 = function(t) {
            L.validateCustomDimensions(t) && (c.instance.availableCustomDimensions01 = t,
            c.validateAndFixCurrentDimensions(),
            D.i("Set available custom01 dimension values: (" + G.joinStringArray(t, ", ") + ")"))
        }
        ,
        c.getAvailableCustomDimensions02 = function() {
            return c.instance.availableCustomDimensions02
        }
        ,
        c.setAvailableCustomDimensions02 = function(t) {
            L.validateCustomDimensions(t) && (c.instance.availableCustomDimensions02 = t,
            c.validateAndFixCurrentDimensions(),
            D.i("Set available custom02 dimension values: (" + G.joinStringArray(t, ", ") + ")"))
        }
        ,
        c.getAvailableCustomDimensions03 = function() {
            return c.instance.availableCustomDimensions03
        }
        ,
        c.setAvailableCustomDimensions03 = function(t) {
            L.validateCustomDimensions(t) && (c.instance.availableCustomDimensions03 = t,
            c.validateAndFixCurrentDimensions(),
            D.i("Set available custom03 dimension values: (" + G.joinStringArray(t, ", ") + ")"))
        }
        ,
        c.getAvailableResourceCurrencies = function() {
            return c.instance.availableResourceCurrencies
        }
        ,
        c.setAvailableResourceCurrencies = function(t) {
            L.validateResourceCurrencies(t) && (c.instance.availableResourceCurrencies = t,
            D.i("Set available resource currencies: (" + G.joinStringArray(t, ", ") + ")"))
        }
        ,
        c.getAvailableResourceItemTypes = function() {
            return c.instance.availableResourceItemTypes
        }
        ,
        c.setAvailableResourceItemTypes = function(t) {
            L.validateResourceItemTypes(t) && (c.instance.availableResourceItemTypes = t,
            D.i("Set available resource item types: (" + G.joinStringArray(t, ", ") + ")"))
        }
        ,
        c.getBuild = function() {
            return c.instance.build
        }
        ,
        c.setBuild = function(t) {
            c.instance.build = t,
            D.i("Set build version: " + t)
        }
        ,
        c.getUseManualSessionHandling = function() {
            return c.instance.useManualSessionHandling
        }
        ,
        c.isEventSubmissionEnabled = function() {
            return c.instance._isEventSubmissionEnabled
        }
        ,
        c.prototype.setDefaultId = function(t) {
            this.defaultUserId = t || "",
            c.cacheIdentifier()
        }
        ,
        c.getDefaultId = function() {
            return c.instance.defaultUserId
        }
        ,
        c.getSdkConfig = function() {
            var t, e = 0;
            for (var i in c.instance.sdkConfig)
                0 === e && (t = i),
                ++e;
            if (t && 0 < e)
                return c.instance.sdkConfig;
            for (var i in e = 0,
            c.instance.sdkConfigCached)
                0 === e && (t = i),
                ++e;
            return t && 0 < e ? c.instance.sdkConfigCached : c.instance.sdkConfigDefault
        }
        ,
        c.isEnabled = function() {
            var t = c.getSdkConfig();
            return !(t.enabled && "false" == t.enabled || !c.instance.initAuthorized)
        }
        ,
        c.setCustomDimension01 = function(t) {
            c.instance.currentCustomDimension01 = t,
            F.setItem(c.Dimension01Key, t),
            D.i("Set custom01 dimension value: " + t)
        }
        ,
        c.setCustomDimension02 = function(t) {
            c.instance.currentCustomDimension02 = t,
            F.setItem(c.Dimension02Key, t),
            D.i("Set custom02 dimension value: " + t)
        }
        ,
        c.setCustomDimension03 = function(t) {
            c.instance.currentCustomDimension03 = t,
            F.setItem(c.Dimension03Key, t),
            D.i("Set custom03 dimension value: " + t)
        }
        ,
        c.setFacebookId = function(t) {
            c.instance.facebookId = t,
            F.setItem(c.FacebookIdKey, t),
            D.i("Set facebook id: " + t)
        }
        ,
        c.setGender = function(t) {
            c.instance.gender = isNaN(Number(B.EGAGender[t])) ? B.EGAGender[t].toString().toLowerCase() : B.EGAGender[B.EGAGender[t]].toString().toLowerCase(),
            F.setItem(c.GenderKey, c.instance.gender),
            D.i("Set gender: " + c.instance.gender)
        }
        ,
        c.setBirthYear = function(t) {
            c.instance.birthYear = t,
            F.setItem(c.BirthYearKey, t.toString()),
            D.i("Set birth year: " + t)
        }
        ,
        c.incrementSessionNum = function() {
            var t = c.getSessionNum() + 1;
            c.instance.sessionNum = t
        }
        ,
        c.incrementTransactionNum = function() {
            var t = c.getTransactionNum() + 1;
            c.instance.transactionNum = t
        }
        ,
        c.incrementProgressionTries = function(t) {
            var e = c.getProgressionTries(t) + 1;
            c.instance.progressionTries[t] = e;
            var i = {};
            i.progression = t,
            i.tries = e,
            F.insert(N.Progression, i, !0, "progression")
        }
        ,
        c.getProgressionTries = function(t) {
            return t in c.instance.progressionTries ? c.instance.progressionTries[t] : 0
        }
        ,
        c.clearProgressionTries = function(t) {
            t in c.instance.progressionTries && delete c.instance.progressionTries[t];
            var e = [];
            e.push(["progression", W.Equal, t]),
            F.delete(N.Progression, e)
        }
        ,
        c.setKeys = function(t, e) {
            c.instance.gameKey = t,
            c.instance.gameSecret = e
        }
        ,
        c.setManualSessionHandling = function(t) {
            c.instance.useManualSessionHandling = t,
            D.i("Use manual session handling: " + t)
        }
        ,
        c.setEnabledEventSubmission = function(t) {
            c.instance._isEventSubmissionEnabled = t
        }
        ,
        c.getEventAnnotations = function() {
            var t = {
                v: 2
            };
            t.user_id = c.instance.identifier,
            t.client_ts = c.getClientTsAdjusted(),
            t.sdk_version = U.getRelevantSdkVersion(),
            t.os_version = U.osVersion,
            t.manufacturer = U.deviceManufacturer,
            t.device = U.deviceModel,
            t.browser_version = U.browserVersion,
            t.platform = U.buildPlatform,
            t.session_id = c.instance.sessionId,
            t[c.SessionNumKey] = c.instance.sessionNum;
            var e = U.getConnectionType();
            return L.validateConnectionType(e) && (t.connection_type = e),
            U.gameEngineVersion && (t.engine_version = U.gameEngineVersion),
            c.instance.build && (t.build = c.instance.build),
            c.instance.facebookId && (t[c.FacebookIdKey] = c.instance.facebookId),
            c.instance.gender && (t[c.GenderKey] = c.instance.gender),
            0 != c.instance.birthYear && (t[c.BirthYearKey] = c.instance.birthYear),
            t
        }
        ,
        c.getSdkErrorEventAnnotations = function() {
            var t = {
                v: 2
            };
            t.category = c.CategorySdkError,
            t.sdk_version = U.getRelevantSdkVersion(),
            t.os_version = U.osVersion,
            t.manufacturer = U.deviceManufacturer,
            t.device = U.deviceModel,
            t.platform = U.buildPlatform;
            var e = U.getConnectionType();
            return L.validateConnectionType(e) && (t.connection_type = e),
            U.gameEngineVersion && (t.engine_version = U.gameEngineVersion),
            t
        }
        ,
        c.getInitAnnotations = function() {
            var t = {};
            return t.user_id = c.getIdentifier(),
            t.sdk_version = U.getRelevantSdkVersion(),
            t.os_version = U.osVersion,
            t.platform = U.buildPlatform,
            t
        }
        ,
        c.getClientTsAdjusted = function() {
            var t = G.timeIntervalSince1970()
              , e = t + c.instance.clientServerTimeOffset;
            return L.validateClientTs(e) ? e : t
        }
        ,
        c.sessionIsStarted = function() {
            return 0 != c.instance.sessionStart
        }
        ,
        c.cacheIdentifier = function() {
            c.instance.userId ? c.instance.identifier = c.instance.userId : c.instance.defaultUserId && (c.instance.identifier = c.instance.defaultUserId)
        }
        ,
        c.ensurePersistedStates = function() {
            F.isStorageAvailable() && F.load();
            var t = c.instance;
            t.setDefaultId(null != F.getItem(c.DefaultUserIdKey) ? F.getItem(c.DefaultUserIdKey) : G.createGuid()),
            t.sessionNum = null != F.getItem(c.SessionNumKey) ? Number(F.getItem(c.SessionNumKey)) : 0,
            t.transactionNum = null != F.getItem(c.TransactionNumKey) ? Number(F.getItem(c.TransactionNumKey)) : 0,
            t.facebookId ? F.setItem(c.FacebookIdKey, t.facebookId) : (t.facebookId = null != F.getItem(c.FacebookIdKey) ? F.getItem(c.FacebookIdKey) : "",
            t.facebookId),
            t.gender ? F.setItem(c.GenderKey, t.gender) : (t.gender = null != F.getItem(c.GenderKey) ? F.getItem(c.GenderKey) : "",
            t.gender),
            t.birthYear && 0 != t.birthYear ? F.setItem(c.BirthYearKey, t.birthYear.toString()) : (t.birthYear = null != F.getItem(c.BirthYearKey) ? Number(F.getItem(c.BirthYearKey)) : 0,
            t.birthYear),
            t.currentCustomDimension01 ? F.setItem(c.Dimension01Key, t.currentCustomDimension01) : (t.currentCustomDimension01 = null != F.getItem(c.Dimension01Key) ? F.getItem(c.Dimension01Key) : "",
            t.currentCustomDimension01),
            t.currentCustomDimension02 ? F.setItem(c.Dimension02Key, t.currentCustomDimension02) : (t.currentCustomDimension02 = null != F.getItem(c.Dimension02Key) ? F.getItem(c.Dimension02Key) : "",
            t.currentCustomDimension02),
            t.currentCustomDimension03 ? F.setItem(c.Dimension03Key, t.currentCustomDimension03) : (t.currentCustomDimension03 = null != F.getItem(c.Dimension03Key) ? F.getItem(c.Dimension03Key) : "",
            t.currentCustomDimension03);
            var e = null != F.getItem(c.SdkConfigCachedKey) ? F.getItem(c.SdkConfigCachedKey) : "";
            if (e) {
                var i = JSON.parse(G.decode64(e));
                i && (t.sdkConfigCached = i)
            }
            var s = F.select(N.Progression);
            if (s)
                for (var n = 0; n < s.length; ++n) {
                    var r = s[n];
                    r && (t.progressionTries[r.progression] = r.tries)
                }
        }
        ,
        c.calculateServerTimeOffset = function(t) {
            return t - G.timeIntervalSince1970()
        }
        ,
        c.validateAndCleanCustomFields = function(t) {
            var e = {};
            if (t) {
                var i = 0;
                for (var s in t) {
                    var n = t[s];
                    if (s && n)
                        if (i < c.MAX_CUSTOM_FIELDS_COUNT) {
                            var r = new RegExp("^[a-zA-Z0-9_]{1," + c.MAX_CUSTOM_FIELDS_KEY_LENGTH + "}$");
                            if (G.stringMatch(s, r)) {
                                var o = typeof n;
                                if ("string" === o || n instanceof String) {
                                    var a = n;
                                    a.length <= c.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH && 0 < a.length ? (e[s] = a,
                                    ++i) : D.w("validateAndCleanCustomFields: entry with key=" + s + ", value=" + n + " has been omitted because its value is an empty string or exceeds the max number of characters (" + c.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH + ")")
                                } else if ("number" === o || n instanceof Number) {
                                    var h = n;
                                    e[s] = h,
                                    ++i
                                } else
                                    D.w("validateAndCleanCustomFields: entry with key=" + s + ", value=" + n + " has been omitted because its value is not a string or number")
                            } else
                                D.w("validateAndCleanCustomFields: entry with key=" + s + ", value=" + n + " has been omitted because its key contains illegal character, is empty or exceeds the max number of characters (" + c.MAX_CUSTOM_FIELDS_KEY_LENGTH + ")")
                        } else
                            D.w("validateAndCleanCustomFields: entry with key=" + s + ", value=" + n + " has been omitted because it exceeds the max number of custom fields (" + c.MAX_CUSTOM_FIELDS_COUNT + ")");
                    else
                        D.w("validateAndCleanCustomFields: entry with key=" + s + ", value=" + n + " has been omitted because its key or value is null")
                }
            }
            return e
        }
        ,
        c.validateAndFixCurrentDimensions = function() {
            L.validateDimension01(c.getCurrentCustomDimension01(), c.getAvailableCustomDimensions01()) || c.setCustomDimension01(""),
            L.validateDimension02(c.getCurrentCustomDimension02(), c.getAvailableCustomDimensions02()) || c.setCustomDimension02(""),
            L.validateDimension03(c.getCurrentCustomDimension03(), c.getAvailableCustomDimensions03()) || c.setCustomDimension03("")
        }
        ,
        c.getConfigurationStringValue = function(t, e) {
            return c.instance.configurations[t] ? c.instance.configurations[t].toString() : e
        }
        ,
        c.isCommandCenterReady = function() {
            return c.instance.commandCenterIsReady
        }
        ,
        c.addCommandCenterListener = function(t) {
            c.instance.commandCenterListeners.indexOf(t) < 0 && c.instance.commandCenterListeners.push(t)
        }
        ,
        c.removeCommandCenterListener = function(t) {
            var e = c.instance.commandCenterListeners.indexOf(t);
            -1 < e && c.instance.commandCenterListeners.splice(e, 1)
        }
        ,
        c.getConfigurationsContentAsString = function() {
            return JSON.stringify(c.instance.configurations)
        }
        ,
        c.populateConfigurations = function(t) {
            var e = t.configurations;
            if (e)
                for (var i = 0; i < e.length; ++i) {
                    var s = e[i];
                    if (s) {
                        var n = s.key
                          , r = s.value
                          , o = s.start ? s.start : Number.MIN_VALUE
                          , a = s.end ? s.end : Number.MAX_VALUE
                          , h = c.getClientTsAdjusted();
                        n && r && o < h && h < a && (c.instance.configurations[n] = r)
                    }
                }
            c.instance.commandCenterIsReady = !0;
            var l = c.instance.commandCenterListeners;
            for (i = 0; i < l.length; ++i)
                l[i] && l[i].onCommandCenterUpdated()
        }
        ,
        c.CategorySdkError = "sdk_error",
        c.MAX_CUSTOM_FIELDS_COUNT = 50,
        c.MAX_CUSTOM_FIELDS_KEY_LENGTH = 64,
        c.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH = 256,
        c.instance = new c,
        c.DefaultUserIdKey = "default_user_id",
        c.SessionNumKey = "session_num",
        c.TransactionNumKey = "transaction_num",
        c.FacebookIdKey = "facebook_id",
        c.GenderKey = "gender",
        c.BirthYearKey = "birth_year",
        c.Dimension01Key = "dimension01",
        c.Dimension02Key = "dimension02",
        c.Dimension03Key = "dimension03",
        c.SdkConfigCachedKey = "sdk_config_cached",
        c
    }(),
    O.GAState = H,
    X = wt || (wt = {}),
    j = X.tasks || (X.tasks = {}),
    q = X.utilities.GAUtilities,
    V = X.logging.GALogger,
    z = function() {
        function o() {}
        return o.execute = function(t, e, i, s) {
            if (o.countMap[e] || (o.countMap[e] = 0),
            !(o.countMap[e] >= o.MaxCount)) {
                var n = q.getHmac(s, i)
                  , r = new XMLHttpRequest;
                r.onreadystatechange = function() {
                    if (4 === r.readyState) {
                        if (!r.responseText)
                            return;
                        if (200 != r.status)
                            return void V.w("sdk error failed. response code not 200. status code: " + r.status + ", description: " + r.statusText + ", body: " + r.responseText);
                        o.countMap[e] = o.countMap[e] + 1
                    }
                }
                ,
                r.open("POST", t, !0),
                r.setRequestHeader("Content-Type", "application/json"),
                r.setRequestHeader("Authorization", n);
                try {
                    r.send(i)
                } catch (t) {}
            }
        }
        ,
        o.MaxCount = 10,
        o.countMap = {},
        o
    }(),
    j.SdkErrorTask = z,
    Y = wt || (wt = {}),
    K = Y.http || (Y.http = {}),
    J = Y.state.GAState,
    Q = Y.logging.GALogger,
    Z = Y.utilities.GAUtilities,
    $ = Y.validators.GAValidator,
    tt = Y.tasks.SdkErrorTask,
    et = function() {
        function c() {
            this.protocol = "https",
            this.hostName = "api.gameanalytics.com",
            this.version = "v2",
            this.baseUrl = this.protocol + "://" + this.hostName + "/" + this.version,
            this.initializeUrlPath = "init",
            this.eventsUrlPath = "events",
            this.useGzip = !1
        }
        return c.prototype.requestInit = function(t) {
            var e = J.getGameKey()
              , i = (this.baseUrl,
            this.initializeUrlPath);
            i = "https://rubick.gameanalytics.com/v2/command_center?game_key=" + e + "&interval_seconds=1000000";
            var s = J.getInitAnnotations()
              , n = JSON.stringify(s);
            if (n) {
                var r = this.createPayloadData(n, this.useGzip)
                  , o = [];
                o.push(n),
                c.sendRequest(i, r, o, this.useGzip, c.initRequestCallback, t)
            } else
                t(K.EGAHTTPApiResponse.JsonEncodeFailed, null)
        }
        ,
        c.prototype.sendEventsInArray = function(t, e, i) {
            if (0 != t.length) {
                var s = J.getGameKey()
                  , n = this.baseUrl + "/" + s + "/" + this.eventsUrlPath
                  , r = JSON.stringify(t);
                if (!r)
                    return void i(K.EGAHTTPApiResponse.JsonEncodeFailed, null, e, t.length);
                var o = this.createPayloadData(r, this.useGzip)
                  , a = [];
                a.push(r),
                a.push(e),
                a.push(t.length.toString()),
                c.sendRequest(n, o, a, this.useGzip, c.sendEventInArrayRequestCallback, i)
            }
        }
        ,
        c.prototype.sendSdkErrorEvent = function(t) {
            if (J.isEventSubmissionEnabled()) {
                var e = J.getGameKey()
                  , i = J.getGameSecret();
                if ($.validateSdkErrorEvent(e, i, t)) {
                    var s, n = this.baseUrl + "/" + e + "/" + this.eventsUrlPath, r = J.getSdkErrorEventAnnotations(), o = c.sdkErrorTypeToString(t);
                    r.type = o;
                    var a = [];
                    if (a.push(r),
                    !(s = JSON.stringify(a)))
                        return void Q.w("sendSdkErrorEvent: JSON encoding failed.");
                    tt.execute(n, t, s, i)
                }
            }
        }
        ,
        c.sendEventInArrayRequestCallback = function(t, e, i, s) {
            void 0 === s && (s = null);
            var n, r, o = (s[0],
            s[1],
            s[2]), a = parseInt(s[3]);
            n = t.responseText,
            r = t.status;
            var h = c.instance.processRequestResponse(r, t.statusText, n, "Events");
            if (h == K.EGAHTTPApiResponse.Ok || h == K.EGAHTTPApiResponse.BadRequest) {
                var l = n ? JSON.parse(n) : {};
                null != l ? (K.EGAHTTPApiResponse.BadRequest,
                i(h, l, o, a)) : i(K.EGAHTTPApiResponse.JsonDecodeFailed, null, o, a)
            } else
                i(h, null, o, a)
        }
        ,
        c.sendRequest = function(t, e, i, s, n, r) {
            var o = new XMLHttpRequest
              , a = J.getGameSecret()
              , h = Z.getHmac(a, e)
              , l = [];
            for (var c in l.push(h),
            i)
                l.push(i[c]);
            if (o.onreadystatechange = function() {
                4 === o.readyState && n(o, t, r, l)
            }
            ,
            o.open("POST", t, !0),
            o.setRequestHeader("Content-Type", "text/plain"),
            o.setRequestHeader("Authorization", h),
            s)
                throw new Error("gzip not supported");
            try {
                // o.send(e)
            } catch (t) {}
        }
        ,
        c.initRequestCallback = function(t, e, i, s) {
            void 0 === s && (s = null);
            var n, r = (s[0],
            s[1]);
            r = t.responseText,
            n = t.status;
            var o = r ? JSON.parse(r) : {}
              , a = c.instance.processRequestResponse(n, t.statusText, r, "Init");
            if (a == K.EGAHTTPApiResponse.Ok || a == K.EGAHTTPApiResponse.BadRequest)
                if (null != o)
                    if (a !== K.EGAHTTPApiResponse.BadRequest) {
                        var h = $.validateAndCleanInitRequestResponse(o);
                        h ? i(K.EGAHTTPApiResponse.Ok, h, "", 0) : i(K.EGAHTTPApiResponse.BadResponse, null, "", 0)
                    } else
                        i(a, null, "", 0);
                else
                    i(K.EGAHTTPApiResponse.JsonDecodeFailed, null, "", 0);
            else
                i(a, null, "", 0)
        }
        ,
        c.prototype.createPayloadData = function(t, e) {
            if (e)
                throw new Error("gzip not supported");
            return t
        }
        ,
        c.prototype.processRequestResponse = function(t, e, i, s) {
            return i ? 200 === t ? K.EGAHTTPApiResponse.Ok : 0 === t || 401 === t ? K.EGAHTTPApiResponse.Unauthorized : 400 === t ? K.EGAHTTPApiResponse.BadRequest : 500 === t ? K.EGAHTTPApiResponse.InternalServerError : K.EGAHTTPApiResponse.UnknownResponseCode : K.EGAHTTPApiResponse.NoResponse
        }
        ,
        c.sdkErrorTypeToString = function(t) {
            switch (t) {
            case K.EGASdkErrorType.Rejected:
                return "rejected";
            default:
                return ""
            }
        }
        ,
        c.instance = new c,
        c
    }(),
    K.GAHTTPApi = et,
    it = wt || (wt = {}),
    st = it.events || (it.events = {}),
    nt = it.store.GAStore,
    rt = it.store.EGAStore,
    ot = it.store.EGAStoreArgsOperator,
    at = it.state.GAState,
    ht = it.logging.GALogger,
    lt = it.utilities.GAUtilities,
    ct = it.http.EGAHTTPApiResponse,
    dt = it.http.GAHTTPApi,
    ut = it.validators.GAValidator,
    pt = it.http.EGASdkErrorType,
    gt = function() {
        function u() {}
        return u.addSessionStartEvent = function() {
            if (at.isEventSubmissionEnabled()) {
                var t = {};
                t.category = u.CategorySessionStart,
                at.incrementSessionNum(),
                nt.setItem(at.SessionNumKey, at.getSessionNum().toString()),
                u.addDimensionsToEvent(t),
                u.addEventToStore(t),
                ht.i("Add SESSION START event"),
                u.processEvents(u.CategorySessionStart, !1)
            }
        }
        ,
        u.addSessionEndEvent = function() {
            if (at.isEventSubmissionEnabled()) {
                var t = at.getSessionStart()
                  , e = at.getClientTsAdjusted() - t;
                e < 0 && (ht.w("Session length was calculated to be less then 0. Should not be possible. Resetting to 0."),
                e = 0);
                var i = {};
                i.category = u.CategorySessionEnd,
                i.length = e,
                u.addDimensionsToEvent(i),
                u.addEventToStore(i),
                ht.i("Add SESSION END event."),
                u.processEvents("", !1)
            }
        }
        ,
        u.addBusinessEvent = function(t, e, i, s, n, r) {
            if (void 0 === n && (n = null),
            at.isEventSubmissionEnabled()) {
                if (!ut.validateBusinessEvent(t, e, n, i, s))
                    return void dt.instance.sendSdkErrorEvent(pt.Rejected);
                var o = {};
                at.incrementTransactionNum(),
                nt.setItem(at.TransactionNumKey, at.getTransactionNum().toString()),
                o.event_id = i + ":" + s,
                o.category = u.CategoryBusiness,
                o.currency = t,
                o.amount = e,
                o[at.TransactionNumKey] = at.getTransactionNum(),
                n && (o.cart_type = n),
                u.addDimensionsToEvent(o),
                u.addFieldsToEvent(o, at.validateAndCleanCustomFields(r)),
                ht.i("Add BUSINESS event: {currency:" + t + ", amount:" + e + ", itemType:" + i + ", itemId:" + s + ", cartType:" + n + "}"),
                u.addEventToStore(o)
            }
        }
        ,
        u.addResourceEvent = function(t, e, i, s, n, r) {
            if (at.isEventSubmissionEnabled()) {
                if (!ut.validateResourceEvent(t, e, i, s, n, at.getAvailableResourceCurrencies(), at.getAvailableResourceItemTypes()))
                    return void dt.instance.sendSdkErrorEvent(pt.Rejected);
                t === it.EGAResourceFlowType.Sink && (i *= -1);
                var o = {}
                  , a = u.resourceFlowTypeToString(t);
                o.event_id = a + ":" + e + ":" + s + ":" + n,
                o.category = u.CategoryResource,
                o.amount = i,
                u.addDimensionsToEvent(o),
                u.addFieldsToEvent(o, at.validateAndCleanCustomFields(r)),
                ht.i("Add RESOURCE event: {currency:" + e + ", amount:" + i + ", itemType:" + s + ", itemId:" + n + "}"),
                u.addEventToStore(o)
            }
        }
        ,
        u.addProgressionEvent = function(t, e, i, s, n, r, o) {
            if (at.isEventSubmissionEnabled()) {
                var a = u.progressionStatusToString(t);
                if (!ut.validateProgressionEvent(t, e, i, s))
                    return void dt.instance.sendSdkErrorEvent(pt.Rejected);
                var h, l = {};
                h = i ? s ? e + ":" + i + ":" + s : e + ":" + i : e,
                l.category = u.CategoryProgression,
                l.event_id = a + ":" + h;
                var c = 0;
                r && t != it.EGAProgressionStatus.Start && (l.score = n),
                t === it.EGAProgressionStatus.Fail && at.incrementProgressionTries(h),
                t === it.EGAProgressionStatus.Complete && (at.incrementProgressionTries(h),
                c = at.getProgressionTries(h),
                l.attempt_num = c,
                at.clearProgressionTries(h)),
                u.addDimensionsToEvent(l),
                u.addFieldsToEvent(l, at.validateAndCleanCustomFields(o)),
                ht.i("Add PROGRESSION event: {status:" + a + ", progression01:" + e + ", progression02:" + i + ", progression03:" + s + ", score:" + n + ", attempt:" + c + "}"),
                u.addEventToStore(l)
            }
        }
        ,
        u.addDesignEvent = function(t, e, i, s) {
            if (at.isEventSubmissionEnabled()) {
                if (!ut.validateDesignEvent(t, e))
                    return void dt.instance.sendSdkErrorEvent(pt.Rejected);
                var n = {};
                n.category = u.CategoryDesign,
                n.event_id = t,
                i && (n.value = e),
                u.addDimensionsToEvent(n),
                u.addFieldsToEvent(n, at.validateAndCleanCustomFields(s)),
                ht.i("Add DESIGN event: {eventId:" + t + ", value:" + e + "}"),
                u.addEventToStore(n)
            }
        }
        ,
        u.addErrorEvent = function(t, e, i) {
            if (at.isEventSubmissionEnabled()) {
                var s = u.errorSeverityToString(t);
                if (!ut.validateErrorEvent(t, e))
                    return void dt.instance.sendSdkErrorEvent(pt.Rejected);
                var n = {};
                n.category = u.CategoryError,
                n.severity = s,
                n.message = e,
                u.addDimensionsToEvent(n),
                u.addFieldsToEvent(n, at.validateAndCleanCustomFields(i)),
                ht.i("Add ERROR event: {severity:" + s + ", message:" + e + "}"),
                u.addEventToStore(n)
            }
        }
        ,
        u.processEvents = function(t, e) {
            if (at.isEventSubmissionEnabled())
                try {
                    var i = lt.createGuid();
                    e && (u.cleanupEvents(),
                    u.fixMissingSessionEndEvents());
                    var s = [];
                    s.push(["status", ot.Equal, "new"]);
                    var n = [];
                    n.push(["status", ot.Equal, "new"]),
                    t && (s.push(["category", ot.Equal, t]),
                    n.push(["category", ot.Equal, t]));
                    var r = [];
                    r.push(["status", i]);
                    var o = nt.select(rt.Events, s);
                    if (!o || 0 == o.length)
                        return ht.i("Event queue: No events to send"),
                        void u.updateSessionStore();
                    if (o.length > u.MaxEventCount) {
                        if (!(o = nt.select(rt.Events, s, !0, u.MaxEventCount)))
                            return;
                        var a = o[o.length - 1].client_ts;
                        if (s.push(["client_ts", ot.LessOrEqual, a]),
                        !(o = nt.select(rt.Events, s)))
                            return;
                        n.push(["client_ts", ot.LessOrEqual, a])
                    }
                    if (ht.i("Event queue: Sending " + o.length + " events."),
                    !nt.update(rt.Events, r, n))
                        return;
                    for (var h = [], l = 0; l < o.length; ++l) {
                        var c = o[l]
                          , d = JSON.parse(lt.decode64(c.event));
                        0 != d.length && h.push(d)
                    }
                    dt.instance.sendEventsInArray(h, i, u.processEventsCallback)
                } catch (t) {
                    ht.e("Error during ProcessEvents(): " + t.stack)
                }
        }
        ,
        u.processEventsCallback = function(t, e, i, s) {
            var n = [];
            if (n.push(["status", ot.Equal, i]),
            t === ct.Ok)
                nt.delete(rt.Events, n),
                ht.i("Event queue: " + s + " events sent.");
            else if (t === ct.NoResponse) {
                var r = [];
                r.push(["status", "new"]),
                ht.w("Event queue: Failed to send events to collector - Retrying next time"),
                nt.update(rt.Events, r, n)
            } else {
                if (e) {
                    var o, a = 0;
                    for (var h in e)
                        0 == a && (o = e[h]),
                        ++a;
                    t === ct.BadRequest && o.constructor === Array ? ht.w("Event queue: " + s + " events sent. " + a + " events failed GA server validation.") : ht.w("Event queue: Failed to send events.")
                } else
                    ht.w("Event queue: Failed to send events.");
                nt.delete(rt.Events, n)
            }
        }
        ,
        u.cleanupEvents = function() {
            nt.update(rt.Events, [["status", "new"]])
        }
        ,
        u.fixMissingSessionEndEvents = function() {
            if (at.isEventSubmissionEnabled()) {
                var t = [];
                t.push(["session_id", ot.NotEqual, at.getSessionId()]);
                var e = nt.select(rt.Sessions, t);
                if (e && 0 != e.length) {
                    ht.i(e.length + " session(s) located with missing session_end event.");
                    for (var i = 0; i < e.length; ++i) {
                        var s = JSON.parse(lt.decode64(e[i].event))
                          , n = s.client_ts - e[i].timestamp;
                        n = Math.max(0, n),
                        s.category = u.CategorySessionEnd,
                        s.length = n,
                        u.addEventToStore(s)
                    }
                }
            }
        }
        ,
        u.addEventToStore = function(t) {
            if (at.isEventSubmissionEnabled()) {
                if (!at.isInitialized())
                    return void ht.w("Could not add event: SDK is not initialized");
                try {
                    if (nt.isStoreTooLargeForEvents() && !lt.stringMatch(t.category, /^(user|session_end|business)$/))
                        return void ht.w("Database too large. Event has been blocked.");
                    var e = at.getEventAnnotations()
                      , i = lt.encode64(JSON.stringify(e));
                    for (var s in t)
                        e[s] = t[s];
                    var n = JSON.stringify(e);
                    ht.ii("Event added to queue: " + n);
                    var r = {
                        status: "new"
                    };
                    r.category = e.category,
                    r.session_id = e.session_id,
                    r.client_ts = e.client_ts,
                    r.event = lt.encode64(JSON.stringify(e)),
                    nt.insert(rt.Events, r),
                    t.category == u.CategorySessionEnd ? nt.delete(rt.Sessions, [["session_id", ot.Equal, e.session_id]]) : ((r = {}).session_id = e.session_id,
                    r.timestamp = at.getSessionStart(),
                    r.event = i,
                    nt.insert(rt.Sessions, r, !0, "session_id")),
                    nt.isStorageAvailable() && nt.save()
                } catch (s) {
                    ht.e("addEventToStore: error"),
                    ht.e(s.stack)
                }
            }
        }
        ,
        u.updateSessionStore = function() {
            if (at.sessionIsStarted()) {
                var t = {};
                t.session_id = at.instance.sessionId,
                t.timestamp = at.getSessionStart(),
                t.event = lt.encode64(JSON.stringify(at.getEventAnnotations())),
                nt.insert(rt.Sessions, t, !0, "session_id"),
                nt.isStorageAvailable() && nt.save()
            }
        }
        ,
        u.addDimensionsToEvent = function(t) {
            t && (at.getCurrentCustomDimension01() && (t.custom_01 = at.getCurrentCustomDimension01()),
            at.getCurrentCustomDimension02() && (t.custom_02 = at.getCurrentCustomDimension02()),
            at.getCurrentCustomDimension03() && (t.custom_03 = at.getCurrentCustomDimension03()))
        }
        ,
        u.addFieldsToEvent = function(t, e) {
            t && e && 0 < Object.keys(e).length && (t.custom_fields = e)
        }
        ,
        u.resourceFlowTypeToString = function(t) {
            return t == it.EGAResourceFlowType.Source || t == it.EGAResourceFlowType[it.EGAResourceFlowType.Source] ? "Source" : t == it.EGAResourceFlowType.Sink || t == it.EGAResourceFlowType[it.EGAResourceFlowType.Sink] ? "Sink" : ""
        }
        ,
        u.progressionStatusToString = function(t) {
            return t == it.EGAProgressionStatus.Start || t == it.EGAProgressionStatus[it.EGAProgressionStatus.Start] ? "Start" : t == it.EGAProgressionStatus.Complete || t == it.EGAProgressionStatus[it.EGAProgressionStatus.Complete] ? "Complete" : t == it.EGAProgressionStatus.Fail || t == it.EGAProgressionStatus[it.EGAProgressionStatus.Fail] ? "Fail" : ""
        }
        ,
        u.errorSeverityToString = function(t) {
            return t == it.EGAErrorSeverity.Debug || t == it.EGAErrorSeverity[it.EGAErrorSeverity.Debug] ? "debug" : t == it.EGAErrorSeverity.Info || t == it.EGAErrorSeverity[it.EGAErrorSeverity.Info] ? "info" : t == it.EGAErrorSeverity.Warning || t == it.EGAErrorSeverity[it.EGAErrorSeverity.Warning] ? "warning" : t == it.EGAErrorSeverity.Error || t == it.EGAErrorSeverity[it.EGAErrorSeverity.Error] ? "error" : t == it.EGAErrorSeverity.Critical || t == it.EGAErrorSeverity[it.EGAErrorSeverity.Critical] ? "critical" : ""
        }
        ,
        u.instance = new u,
        u.CategorySessionStart = "user",
        u.CategorySessionEnd = "session_end",
        u.CategoryDesign = "design",
        u.CategoryBusiness = "business",
        u.CategoryProgression = "progression",
        u.CategoryResource = "resource",
        u.CategoryError = "error",
        u.MaxEventCount = 500,
        u
    }(),
    st.GAEvents = gt,
    ft = wt || (wt = {}),
    mt = ft.threading || (ft.threading = {}),
    yt = ft.logging.GALogger,
    vt = ft.state.GAState,
    _t = ft.events.GAEvents,
    bt = function() {
        function n() {
            this.blocks = new mt.PriorityQueue({
                compare: function(t, e) {
                    return t - e
                }
            }),
            this.id2TimedBlockMap = {},
            n.startThread()
        }
        return n.createTimedBlock = function(t) {
            void 0 === t && (t = 0);
            var e = new Date;
            return e.setSeconds(e.getSeconds() + t),
            new mt.TimedBlock(e)
        }
        ,
        n.performTaskOnGAThread = function(t, e) {
            void 0 === e && (e = 0);
            var i = new Date;
            i.setSeconds(i.getSeconds() + e);
            var s = new mt.TimedBlock(i);
            s.block = t,
            n.instance.id2TimedBlockMap[s.id] = s,
            n.instance.addTimedBlock(s)
        }
        ,
        n.performTimedBlockOnGAThread = function(t) {
            n.instance.id2TimedBlockMap[t.id] = t,
            n.instance.addTimedBlock(t)
        }
        ,
        n.scheduleTimer = function(t, e) {
            var i = new Date;
            i.setSeconds(i.getSeconds() + t);
            var s = new mt.TimedBlock(i);
            return s.block = e,
            n.instance.id2TimedBlockMap[s.id] = s,
            n.instance.addTimedBlock(s),
            s.id
        }
        ,
        n.getTimedBlockById = function(t) {
            return t in n.instance.id2TimedBlockMap ? n.instance.id2TimedBlockMap[t] : null
        }
        ,
        n.ensureEventQueueIsRunning = function() {
            n.instance.keepRunning = !0,
            n.instance.isRunning || (n.instance.isRunning = !0,
            n.scheduleTimer(n.ProcessEventsIntervalInSeconds, n.processEventQueue))
        }
        ,
        n.endSessionAndStopQueue = function() {
            vt.isInitialized() && (yt.i("Ending session."),
            n.stopEventQueue(),
            vt.isEnabled() && vt.sessionIsStarted() && (_t.addSessionEndEvent(),
            vt.instance.sessionStart = 0))
        }
        ,
        n.stopEventQueue = function() {
            n.instance.keepRunning = !1
        }
        ,
        n.ignoreTimer = function(t) {
            t in n.instance.id2TimedBlockMap && (n.instance.id2TimedBlockMap[t].ignore = !0)
        }
        ,
        n.setEventProcessInterval = function(t) {
            0 < t && (n.ProcessEventsIntervalInSeconds = t)
        }
        ,
        n.prototype.addTimedBlock = function(t) {
            this.blocks.enqueue(t.deadline.getTime(), t)
        }
        ,
        n.run = function() {
            clearTimeout(n.runTimeoutId);
            try {
                for (var t; t = n.getNextBlock(); )
                    if (!t.ignore)
                        if (t.async) {
                            if (!t.running) {
                                t.running = !0,
                                t.block();
                                break
                            }
                        } else
                            t.block();
                return void (n.runTimeoutId = setTimeout(n.run, n.ThreadWaitTimeInMs))
            } catch (t) {
                yt.e("Error on GA thread"),
                yt.e(t.stack)
            }
        }
        ,
        n.startThread = function() {
            n.runTimeoutId = setTimeout(n.run, 0)
        }
        ,
        n.getNextBlock = function() {
            var t = new Date;
            return n.instance.blocks.hasItems() && n.instance.blocks.peek().deadline.getTime() <= t.getTime() ? n.instance.blocks.peek().async && n.instance.blocks.peek().running ? n.instance.blocks.peek() : n.instance.blocks.dequeue() : null
        }
        ,
        n.processEventQueue = function() {
            _t.processEvents("", !0),
            n.instance.keepRunning ? n.scheduleTimer(n.ProcessEventsIntervalInSeconds, n.processEventQueue) : n.instance.isRunning = !1
        }
        ,
        n.instance = new n,
        n.ThreadWaitTimeInMs = 1e3,
        n.ProcessEventsIntervalInSeconds = 8,
        n
    }(),
    mt.GAThreading = bt,
    xt = wt || (wt = {}),
    St = xt.threading.GAThreading,
    Tt = xt.logging.GALogger,
    At = xt.store.GAStore,
    Ct = xt.state.GAState,
    Pt = xt.http.GAHTTPApi,
    Et = xt.device.GADevice,
    It = xt.validators.GAValidator,
    kt = xt.http.EGAHTTPApiResponse,
    Mt = xt.utilities.GAUtilities,
    Rt = xt.events.GAEvents,
    Bt = function() {
        function o() {}
        return o.init = function() {
            if (Et.touch(),
            o.methodMap.configureAvailableCustomDimensions01 = o.configureAvailableCustomDimensions01,
            o.methodMap.configureAvailableCustomDimensions02 = o.configureAvailableCustomDimensions02,
            o.methodMap.configureAvailableCustomDimensions03 = o.configureAvailableCustomDimensions03,
            o.methodMap.configureAvailableResourceCurrencies = o.configureAvailableResourceCurrencies,
            o.methodMap.configureAvailableResourceItemTypes = o.configureAvailableResourceItemTypes,
            o.methodMap.configureBuild = o.configureBuild,
            o.methodMap.configureSdkGameEngineVersion = o.configureSdkGameEngineVersion,
            o.methodMap.configureGameEngineVersion = o.configureGameEngineVersion,
            o.methodMap.configureUserId = o.configureUserId,
            o.methodMap.initialize = o.initialize,
            o.methodMap.addBusinessEvent = o.addBusinessEvent,
            o.methodMap.addResourceEvent = o.addResourceEvent,
            o.methodMap.addProgressionEvent = o.addProgressionEvent,
            o.methodMap.addDesignEvent = o.addDesignEvent,
            o.methodMap.addErrorEvent = o.addErrorEvent,
            o.methodMap.addErrorEvent = o.addErrorEvent,
            o.methodMap.setEnabledInfoLog = o.setEnabledInfoLog,
            o.methodMap.setEnabledVerboseLog = o.setEnabledVerboseLog,
            o.methodMap.setEnabledManualSessionHandling = o.setEnabledManualSessionHandling,
            o.methodMap.setEnabledEventSubmission = o.setEnabledEventSubmission,
            o.methodMap.setCustomDimension01 = o.setCustomDimension01,
            o.methodMap.setCustomDimension02 = o.setCustomDimension02,
            o.methodMap.setCustomDimension03 = o.setCustomDimension03,
            o.methodMap.setFacebookId = o.setFacebookId,
            o.methodMap.setGender = o.setGender,
            o.methodMap.setBirthYear = o.setBirthYear,
            o.methodMap.setEventProcessInterval = o.setEventProcessInterval,
            o.methodMap.startSession = o.startSession,
            o.methodMap.endSession = o.endSession,
            o.methodMap.onStop = o.onStop,
            o.methodMap.onResume = o.onResume,
            o.methodMap.addCommandCenterListener = o.addCommandCenterListener,
            o.methodMap.removeCommandCenterListener = o.removeCommandCenterListener,
            o.methodMap.getCommandCenterValueAsString = o.getCommandCenterValueAsString,
            o.methodMap.isCommandCenterReady = o.isCommandCenterReady,
            o.methodMap.getConfigurationsContentAsString = o.getConfigurationsContentAsString,
            "undefined" != typeof window && void 0 !== window.GameAnalytics && void 0 !== window.GameAnalytics.q) {
                var t = window.GameAnalytics.q;
                for (var e in t)
                    o.gaCommand.apply(null, t[e])
            }
        }
        ,
        o.gaCommand = function() {
            for (var t = [], e = 0; e < arguments.length; e++)
                t[e] = arguments[e];
            0 < t.length && t[0]in xt.GameAnalytics.methodMap && (1 < t.length ? xt.GameAnalytics.methodMap[t[0]].apply(null, Array.prototype.slice.call(t, 1)) : xt.GameAnalytics.methodMap[t[0]]())
        }
        ,
        o.configureAvailableCustomDimensions01 = function(t) {
            void 0 === t && (t = []),
            St.performTaskOnGAThread(function() {
                o.isSdkReady(!0, !1) ? Tt.w("Available custom dimensions must be set before SDK is initialized") : Ct.setAvailableCustomDimensions01(t)
            })
        }
        ,
        o.configureAvailableCustomDimensions02 = function(t) {
            void 0 === t && (t = []),
            St.performTaskOnGAThread(function() {
                o.isSdkReady(!0, !1) ? Tt.w("Available custom dimensions must be set before SDK is initialized") : Ct.setAvailableCustomDimensions02(t)
            })
        }
        ,
        o.configureAvailableCustomDimensions03 = function(t) {
            void 0 === t && (t = []),
            St.performTaskOnGAThread(function() {
                o.isSdkReady(!0, !1) ? Tt.w("Available custom dimensions must be set before SDK is initialized") : Ct.setAvailableCustomDimensions03(t)
            })
        }
        ,
        o.configureAvailableResourceCurrencies = function(t) {
            void 0 === t && (t = []),
            St.performTaskOnGAThread(function() {
                o.isSdkReady(!0, !1) ? Tt.w("Available resource currencies must be set before SDK is initialized") : Ct.setAvailableResourceCurrencies(t)
            })
        }
        ,
        o.configureAvailableResourceItemTypes = function(t) {
            void 0 === t && (t = []),
            St.performTaskOnGAThread(function() {
                o.isSdkReady(!0, !1) ? Tt.w("Available resource item types must be set before SDK is initialized") : Ct.setAvailableResourceItemTypes(t)
            })
        }
        ,
        o.configureBuild = function(t) {
            void 0 === t && (t = ""),
            St.performTaskOnGAThread(function() {
                return o.isSdkReady(!0, !1) ? void Tt.w("Build version must be set before SDK is initialized.") : It.validateBuild(t) ? void Ct.setBuild(t) : void Tt.i("Validation fail - configure build: Cannot be null, empty or above 32 length. String: " + t)
            })
        }
        ,
        o.configureSdkGameEngineVersion = function(t) {
            void 0 === t && (t = ""),
            St.performTaskOnGAThread(function() {
                if (!o.isSdkReady(!0, !1))
                    return It.validateSdkWrapperVersion(t) ? void (Et.sdkGameEngineVersion = t) : void Tt.i("Validation fail - configure sdk version: Sdk version not supported. String: " + t)
            })
        }
        ,
        o.configureGameEngineVersion = function(t) {
            void 0 === t && (t = ""),
            St.performTaskOnGAThread(function() {
                if (!o.isSdkReady(!0, !1))
                    return It.validateEngineVersion(t) ? void (Et.gameEngineVersion = t) : void Tt.i("Validation fail - configure game engine version: Game engine version not supported. String: " + t)
            })
        }
        ,
        o.configureUserId = function(t) {
            void 0 === t && (t = ""),
            St.performTaskOnGAThread(function() {
                return o.isSdkReady(!0, !1) ? void Tt.w("A custom user id must be set before SDK is initialized.") : It.validateUserId(t) ? void Ct.setUserId(t) : void Tt.i("Validation fail - configure user_id: Cannot be null, empty or above 64 length. Will use default user_id method. Used string: " + t)
            })
        }
        ,
        o.initialize = function(t, e) {
            void 0 === t && (t = ""),
            void 0 === e && (e = ""),
            Et.updateConnectionType();
            var i = St.createTimedBlock();
            i.async = !0,
            o.initTimedBlockId = i.id,
            i.block = function() {
                return o.isSdkReady(!0, !1) ? void Tt.w("SDK already initialized. Can only be called once.") : It.validateKeys(t, e) ? (Ct.setKeys(t, e),
                void o.internalInitialize()) : void Tt.w("SDK failed initialize. Game key or secret key is invalid. Can only contain characters A-z 0-9, gameKey is 32 length, gameSecret is 40 length. Failed keys - gameKey: " + t + ", secretKey: " + e)
            }
            ,
            St.performTimedBlockOnGAThread(i)
        }
        ,
        o.addBusinessEvent = function(t, e, i, s, n) {
            void 0 === t && (t = ""),
            void 0 === e && (e = 0),
            void 0 === i && (i = ""),
            void 0 === s && (s = ""),
            void 0 === n && (n = ""),
            Et.updateConnectionType(),
            St.performTaskOnGAThread(function() {
                o.isSdkReady(!0, !0, "Could not add business event") && Rt.addBusinessEvent(t, e, i, s, n, {})
            })
        }
        ,
        o.addResourceEvent = function(t, e, i, s, n) {
            void 0 === t && (t = xt.EGAResourceFlowType.Undefined),
            void 0 === e && (e = ""),
            void 0 === i && (i = 0),
            void 0 === s && (s = ""),
            void 0 === n && (n = ""),
            Et.updateConnectionType(),
            St.performTaskOnGAThread(function() {
                o.isSdkReady(!0, !0, "Could not add resource event") && Rt.addResourceEvent(t, e, i, s, n, {})
            })
        }
        ,
        o.addProgressionEvent = function(e, i, s, n, r) {
            void 0 === e && (e = xt.EGAProgressionStatus.Undefined),
            void 0 === i && (i = ""),
            void 0 === s && (s = ""),
            void 0 === n && (n = ""),
            Et.updateConnectionType(),
            St.performTaskOnGAThread(function() {
                if (o.isSdkReady(!0, !0, "Could not add progression event")) {
                    var t = "number" == typeof r;
                    Rt.addProgressionEvent(e, i, s, n, t ? r : 0, t, {})
                }
            })
        }
        ,
        o.addDesignEvent = function(e, i) {
            Et.updateConnectionType(),
            St.performTaskOnGAThread(function() {
                if (o.isSdkReady(!0, !0, "Could not add design event")) {
                    var t = "number" == typeof i;
                    Rt.addDesignEvent(e, t ? i : 0, t, {})
                }
            })
        }
        ,
        o.addErrorEvent = function(t, e) {
            void 0 === t && (t = xt.EGAErrorSeverity.Undefined),
            void 0 === e && (e = ""),
            Et.updateConnectionType(),
            St.performTaskOnGAThread(function() {
                o.isSdkReady(!0, !0, "Could not add error event") && Rt.addErrorEvent(t, e, {})
            })
        }
        ,
        o.setEnabledInfoLog = function(t) {
            void 0 === t && (t = !1),
            St.performTaskOnGAThread(function() {
                t ? (Tt.setInfoLog(t),
                Tt.i("Info logging enabled")) : (Tt.i("Info logging disabled"),
                Tt.setInfoLog(t))
            })
        }
        ,
        o.setEnabledVerboseLog = function(t) {
            void 0 === t && (t = !1),
            St.performTaskOnGAThread(function() {
                t ? (Tt.setVerboseLog(t),
                Tt.i("Verbose logging enabled")) : (Tt.i("Verbose logging disabled"),
                Tt.setVerboseLog(t))
            })
        }
        ,
        o.setEnabledManualSessionHandling = function(t) {
            void 0 === t && (t = !1),
            St.performTaskOnGAThread(function() {
                Ct.setManualSessionHandling(t)
            })
        }
        ,
        o.setEnabledEventSubmission = function(t) {
            void 0 === t && (t = !1),
            St.performTaskOnGAThread(function() {
                t ? (Ct.setEnabledEventSubmission(t),
                Tt.i("Event submission enabled")) : (Tt.i("Event submission disabled"),
                Ct.setEnabledEventSubmission(t))
            })
        }
        ,
        o.setCustomDimension01 = function(t) {
            void 0 === t && (t = ""),
            St.performTaskOnGAThread(function() {
                It.validateDimension01(t, Ct.getAvailableCustomDimensions01()) ? Ct.setCustomDimension01(t) : Tt.w("Could not set custom01 dimension value to '" + t + "'. Value not found in available custom01 dimension values")
            })
        }
        ,
        o.setCustomDimension02 = function(t) {
            void 0 === t && (t = ""),
            St.performTaskOnGAThread(function() {
                It.validateDimension02(t, Ct.getAvailableCustomDimensions02()) ? Ct.setCustomDimension02(t) : Tt.w("Could not set custom02 dimension value to '" + t + "'. Value not found in available custom02 dimension values")
            })
        }
        ,
        o.setCustomDimension03 = function(t) {
            void 0 === t && (t = ""),
            St.performTaskOnGAThread(function() {
                It.validateDimension03(t, Ct.getAvailableCustomDimensions03()) ? Ct.setCustomDimension03(t) : Tt.w("Could not set custom03 dimension value to '" + t + "'. Value not found in available custom03 dimension values")
            })
        }
        ,
        o.setFacebookId = function(t) {
            void 0 === t && (t = ""),
            St.performTaskOnGAThread(function() {
                It.validateFacebookId(t) && Ct.setFacebookId(t)
            })
        }
        ,
        o.setGender = function(t) {
            void 0 === t && (t = xt.EGAGender.Undefined),
            St.performTaskOnGAThread(function() {
                It.validateGender(t) && Ct.setGender(t)
            })
        }
        ,
        o.setBirthYear = function(t) {
            void 0 === t && (t = 0),
            St.performTaskOnGAThread(function() {
                It.validateBirthyear(t) && Ct.setBirthYear(t)
            })
        }
        ,
        o.setEventProcessInterval = function(t) {
            St.performTaskOnGAThread(function() {
                St.setEventProcessInterval(t)
            })
        }
        ,
        o.startSession = function() {
            if (Ct.isInitialized()) {
                var t = St.createTimedBlock();
                t.async = !0,
                o.initTimedBlockId = t.id,
                t.block = function() {
                    Ct.isEnabled() && Ct.sessionIsStarted() && St.endSessionAndStopQueue(),
                    o.resumeSessionAndStartQueue()
                }
                ,
                St.performTimedBlockOnGAThread(t)
            }
        }
        ,
        o.endSession = function() {
            o.onStop()
        }
        ,
        o.onStop = function() {
            St.performTaskOnGAThread(function() {
                try {
                    St.endSessionAndStopQueue()
                } catch (t) {}
            })
        }
        ,
        o.onResume = function() {
            var t = St.createTimedBlock();
            t.async = !0,
            o.initTimedBlockId = t.id,
            t.block = function() {
                o.resumeSessionAndStartQueue()
            }
            ,
            St.performTimedBlockOnGAThread(t)
        }
        ,
        o.getCommandCenterValueAsString = function(t, e) {
            return void 0 === e && (e = null),
            Ct.getConfigurationStringValue(t, e)
        }
        ,
        o.isCommandCenterReady = function() {
            return Ct.isCommandCenterReady()
        }
        ,
        o.addCommandCenterListener = function(t) {
            Ct.addCommandCenterListener(t)
        }
        ,
        o.removeCommandCenterListener = function(t) {
            Ct.removeCommandCenterListener(t)
        }
        ,
        o.getConfigurationsContentAsString = function() {
            return Ct.getConfigurationsContentAsString()
        }
        ,
        o.internalInitialize = function() {
            Ct.ensurePersistedStates(),
            At.setItem(Ct.DefaultUserIdKey, Ct.getDefaultId()),
            Ct.setInitialized(!0),
            o.newSession(),
            Ct.isEnabled() && St.ensureEventQueueIsRunning()
        }
        ,
        o.newSession = function() {
            Tt.i("Starting a new session."),
            Ct.validateAndFixCurrentDimensions(),
            Pt.instance.requestInit(o.startNewSessionCallback)
        }
        ,
        o.startNewSessionCallback = function(t, e) {
            if (t === kt.Ok && e) {
                var i = 0;
                if (e.server_ts) {
                    var s = e.server_ts;
                    i = Ct.calculateServerTimeOffset(s)
                }
                e.time_offset = i,
                At.setItem(Ct.SdkConfigCachedKey, Mt.encode64(JSON.stringify(e))),
                Ct.instance.sdkConfigCached = e,
                Ct.instance.sdkConfig = e,
                Ct.instance.initAuthorized = !0
            } else
                t == kt.Unauthorized ? (Tt.w("Initialize SDK failed - Unauthorized"),
                Ct.instance.initAuthorized = !1) : (t === kt.NoResponse || t === kt.RequestTimeout ? Tt.i("Init call (session start) failed - no response. Could be offline or timeout.") : t === kt.BadResponse || t === kt.JsonEncodeFailed || t === kt.JsonDecodeFailed ? Tt.i("Init call (session start) failed - bad response. Could be bad response from proxy or GA servers.") : t !== kt.BadRequest && t !== kt.UnknownResponseCode || Tt.i("Init call (session start) failed - bad request or unknown response."),
                null == Ct.instance.sdkConfig ? null != Ct.instance.sdkConfigCached ? (Tt.i("Init call (session start) failed - using cached init values."),
                Ct.instance.sdkConfig = Ct.instance.sdkConfigCached) : (Tt.i("Init call (session start) failed - using default init values."),
                Ct.instance.sdkConfig = Ct.instance.sdkConfigDefault) : Tt.i("Init call (session start) failed - using cached init values."),
                Ct.instance.initAuthorized = !0);
            if (Ct.instance.clientServerTimeOffset = Ct.getSdkConfig().time_offset ? Ct.getSdkConfig().time_offset : 0,
            Ct.populateConfigurations(Ct.getSdkConfig()),
            !Ct.isEnabled())
                return Tt.w("Could not start session: SDK is disabled."),
                void St.stopEventQueue();
            St.ensureEventQueueIsRunning();
            var n = Mt.createGuid();
            Ct.instance.sessionId = n,
            Ct.instance.sessionStart = Ct.getClientTsAdjusted(),
            Rt.addSessionStartEvent();
            var r = St.getTimedBlockById(o.initTimedBlockId);
            null != r && (r.running = !1),
            o.initTimedBlockId = -1
        }
        ,
        o.resumeSessionAndStartQueue = function() {
            Ct.isInitialized() && (Tt.i("Resuming session."),
            Ct.sessionIsStarted() || o.newSession())
        }
        ,
        o.isSdkReady = function(t, e, i) {
            return void 0 === e && (e = !0),
            void 0 === i && (i = ""),
            i && (i += ": "),
            t && !Ct.isInitialized() ? (e && Tt.w(i + "SDK is not initialized"),
            !1) : t && !Ct.isEnabled() ? (e && Tt.w(i + "SDK is disabled"),
            !1) : !(t && !Ct.sessionIsStarted() && (e && Tt.w(i + "Session has not started yet"),
            1))
        }
        ,
        o.initTimedBlockId = -1,
        o.methodMap = {},
        o
    }(),
    xt.GameAnalytics = Bt,
    wt.GameAnalytics.init();
    var Ot = wt.GameAnalytics.gaCommand;
    t.gameanalytics = wt,
    t.GameAnalytics = Ot
}(this);
var Framework, Components, __extends = this && this.__extends || function() {
    var s = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(t, e) {
        function i() {
            this.constructor = t
        }
        s(t, e),
        t.prototype = null === e ? Object.create(e) : (i.prototype = e.prototype,
        new i)
    }
}(), GameConfig = function() {
    function t() {}
    return t.DEVICE_MODE_DESKTOP = 1,
    t.DEVICE_MODE_MOBILE = 2,
    t.DEVICE_MODE_AUTO = 3,
    t.DEVICE_ORIENTATION_PORTRAIT = 1,
    t.DEVICE_ORIENTATION_LANDSCAPE = 2,
    t.DEVICE_ORIENTATION_AUTO = 3,
    t.buildVersion = "1.03.58",
    t.deviceMode = t.DEVICE_MODE_AUTO,
    t.deviceOrientation = t.DEVICE_ORIENTATION_AUTO,
    t.isCheatsEnabled = !1,
    t.isCheatsLevelEnabled = !1,
    t.isCityStateLevelPassed = !1,
    t.isChasmMineLevelPassed = !1,
    t.debugLevelKey = "GrindcraftReDataDebugA",
    t.cityStateLevelData = '{"countItem":[{"name":"wood","count":22420,"isAchievement":false,"ability":false},{"name":"wood_pick","count":3,"isAchievement":true,"ability":false},{"name":"wood_shovel","count":3,"isAchievement":true,"ability":false},{"name":"wood_sword","count":3,"isAchievement":true,"ability":false},{"name":"wood_axe","count":3,"isAchievement":true,"ability":false},{"name":"wood_hoe","count":3,"isAchievement":true,"ability":false},{"name":"cobblestone","count":25907,"isAchievement":false,"ability":false},{"name":"stone_shovel","count":3,"isAchievement":true,"ability":false},{"name":"stone_sword","count":4,"isAchievement":true,"ability":false},{"name":"stone_axe","count":6,"isAchievement":true,"ability":false},{"name":"stone_hoe","count":1,"isAchievement":true,"ability":false},{"name":"stone_pick","count":1,"isAchievement":true,"ability":false},{"name":"furnace","count":1,"isAchievement":true,"ability":false},{"name":"bucket","count":3,"isAchievement":true,"ability":false},{"name":"coal","count":2652,"isAchievement":false,"ability":false},{"name":"iron_ore","count":0,"isAchievement":false,"ability":false},{"name":"iron_ingot","count":1135,"isAchievement":true,"ability":false},{"name":"dirt","count":49907,"isAchievement":false,"ability":false},{"name":"soil","count":3,"isAchievement":false,"ability":false},{"name":"water","count":3377,"isAchievement":false,"ability":false},{"name":"plot","count":0,"isAchievement":false,"ability":false},{"name":"seeds","count":16795.819999998013,"isAchievement":false,"ability":false},{"name":"wheat_field","count":0,"isAchievement":true,"ability":false},{"name":"planks","count":70,"isAchievement":false,"ability":false},{"name":"crafting_table","count":6,"isAchievement":true,"ability":false},{"name":"stick","count":1133,"isAchievement":false,"ability":false},{"name":"door","count":11,"isAchievement":false,"ability":false},{"name":"wall","count":4,"isAchievement":true,"ability":false},{"name":"hut","count":15,"isAchievement":true,"ability":false},{"name":"villager","count":50,"isAchievement":false,"ability":false},{"name":"woodsman","count":2,"isAchievement":true,"ability":true},{"name":"miner","count":2,"isAchievement":true,"ability":true},{"name":"gardener","count":3,"isAchievement":true,"ability":true},{"name":"hunter","count":3,"isAchievement":true,"ability":true},{"name":"fence","count":32,"isAchievement":true,"ability":false},{"name":"pen","count":3,"isAchievement":true,"ability":false},{"name":"butcher","count":2,"isAchievement":true,"ability":true},{"name":"stairs","count":393,"isAchievement":true,"ability":false},{"name":"rafter","count":1,"isAchievement":true,"ability":false},{"name":"truss","count":1,"isAchievement":false,"ability":false},{"name":"roof","count":8,"isAchievement":true,"ability":false},{"name":"village_building","count":0,"isAchievement":true,"ability":false},{"name":"sugar_cane_field","count":1,"isAchievement":true,"ability":false},{"name":"sugar_cane","count":41304,"isAchievement":false,"ability":false},{"name":"paper","count":17,"isAchievement":true,"ability":false},{"name":"book","count":0,"isAchievement":true,"ability":false},{"name":"bookshelf","count":1,"isAchievement":true,"ability":false},{"name":"bookcase","count":2,"isAchievement":false,"ability":false},{"name":"library","count":1,"isAchievement":false,"ability":false},{"name":"crafter","count":0,"isAchievement":true,"ability":false},{"name":"mason","count":1,"isAchievement":true,"ability":false},{"name":"lava","count":1781,"isAchievement":false,"ability":false},{"name":"lava_pool","count":4,"isAchievement":true,"ability":false},{"name":"forge","count":1,"isAchievement":true,"ability":false},{"name":"smelter","count":1,"isAchievement":true,"ability":true},{"name":"pitch_fork","count":0,"isAchievement":true,"ability":false},{"name":"farmer","count":1,"isAchievement":true,"ability":false},{"name":"saw","count":1,"isAchievement":true,"ability":false},{"name":"carpenter","count":1,"isAchievement":true,"ability":false},{"name":"desk","count":1,"isAchievement":false,"ability":false},{"name":"mayor","count":1,"isAchievement":true,"ability":false},{"name":"iron_pick","count":4,"isAchievement":true,"ability":false},{"name":"iron_shovel","count":6,"isAchievement":true,"ability":false},{"name":"iron_axe","count":5,"isAchievement":true,"ability":false},{"name":"iron_hoe","count":5,"isAchievement":true,"ability":false},{"name":"iron_sword","count":1,"isAchievement":true,"ability":false},{"name":"leather_worker","count":1,"isAchievement":true,"ability":false},{"name":"leather","count":2634,"isAchievement":false,"ability":false},{"name":"leather_helmet","count":6,"isAchievement":true,"ability":false},{"name":"leather_breastplate","count":3,"isAchievement":true,"ability":false},{"name":"leather_leggings","count":7,"isAchievement":true,"ability":false},{"name":"leather_boots","count":4,"isAchievement":true,"ability":false},{"name":"leather_armor","count":1,"isAchievement":true,"ability":false},{"name":"sergeant","count":1,"isAchievement":true,"ability":false},{"name":"soldier","count":19,"isAchievement":true,"ability":false},{"name":"leather_soldier","count":0,"isAchievement":true,"ability":false},{"name":"barracks","count":0,"isAchievement":true,"ability":false},{"name":"iron_block","count":2,"isAchievement":true,"ability":false},{"name":"anvil","count":0,"isAchievement":true,"ability":false},{"name":"blacksmith","count":1,"isAchievement":true,"ability":false},{"name":"iron_helmet","count":6,"isAchievement":true,"ability":false},{"name":"iron_breastplate","count":4,"isAchievement":true,"ability":false},{"name":"iron_leggings","count":1,"isAchievement":true,"ability":false},{"name":"iron_boots","count":2,"isAchievement":true,"ability":false},{"name":"iron_armor","count":0,"isAchievement":true,"ability":false},{"name":"iron_soldier","count":0,"isAchievement":true,"ability":false},{"name":"fletcher","count":1,"isAchievement":true,"ability":false},{"name":"wool","count":312,"isAchievement":false,"ability":false},{"name":"string","count":38.5,"isAchievement":false,"ability":false},{"name":"bow","count":1,"isAchievement":true,"ability":false},{"name":"feather","count":955,"isAchievement":false,"ability":false},{"name":"flint","count":357.1999999999885,"isAchievement":false,"ability":false},{"name":"arrow","count":13,"isAchievement":true,"ability":false},{"name":"archer","count":0,"isAchievement":true,"ability":false},{"name":"fire_team","count":0,"isAchievement":true,"ability":false},{"name":"ladder","count":9,"isAchievement":true,"ability":false},{"name":"tower","count":7,"isAchievement":false,"ability":false},{"name":"scout_tower","count":0,"isAchievement":true,"ability":false},{"name":"outpost","count":0,"isAchievement":true,"ability":false},{"name":"outpost_exporter","count":0,"isAchievement":false,"ability":false},{"name":"station","count":0,"isAchievement":true,"ability":false},{"name":"governor","count":1,"isAchievement":true,"ability":false},{"name":"gold_ore","count":0,"isAchievement":false,"ability":false},{"name":"gold_ingot","count":193,"isAchievement":true,"ability":false},{"name":"gold_pick","count":11,"isAchievement":true,"ability":false},{"name":"gold_shovel","count":10,"isAchievement":true,"ability":false},{"name":"gold_sword","count":11,"isAchievement":true,"ability":false},{"name":"gold_axe","count":10,"isAchievement":true,"ability":false},{"name":"gold_hoe","count":9,"isAchievement":true,"ability":false},{"name":"gold_smith","count":1,"isAchievement":true,"ability":true},{"name":"contractor","count":1,"isAchievement":true,"ability":false},{"name":"commander","count":1,"isAchievement":true,"ability":false},{"name":"gold_helmet","count":3,"isAchievement":true,"ability":false},{"name":"gold_breastplate","count":6,"isAchievement":true,"ability":false},{"name":"gold_leggings","count":9,"isAchievement":true,"ability":false},{"name":"gold_boots","count":9,"isAchievement":true,"ability":false},{"name":"gold_armor","count":0,"isAchievement":true,"ability":false},{"name":"gold_soldier","count":0,"isAchievement":true,"ability":false},{"name":"outer_wall","count":1,"isAchievement":false,"ability":false},{"name":"rampart","count":0,"isAchievement":true,"ability":false},{"name":"fort","count":0,"isAchievement":true,"ability":false},{"name":"fort_exporter","count":0,"isAchievement":false,"ability":false},{"name":"wheat","count":26498.63999999498,"isAchievement":false,"ability":false},{"name":"hay_bale","count":3,"isAchievement":true,"ability":false},{"name":"stall","count":4,"isAchievement":false,"ability":false},{"name":"stable","count":1,"isAchievement":true,"ability":false},{"name":"horse trainer","count":16,"isAchievement":true,"ability":false},{"name":"slime ball","count":284,"isAchievement":false,"ability":false},{"name":"lead","count":2,"isAchievement":true,"ability":false},{"name":"stirrup","count":1,"isAchievement":true,"ability":false},{"name":"saddle","count":2,"isAchievement":true,"ability":false},{"name":"horse","count":298,"isAchievement":false,"ability":false},{"name":"tamed_horse","count":2,"isAchievement":true,"ability":false},{"name":"gold_block","count":1,"isAchievement":true,"ability":false},{"name":"war_horse","count":0,"isAchievement":true,"ability":false},{"name":"gold_knight","count":0,"isAchievement":true,"ability":false},{"name":"keep","count":1,"isAchievement":true,"ability":false},{"name":"castle","count":1,"isAchievement":true,"ability":false},{"name":"castle_exporter","count":0,"isAchievement":false,"ability":false},{"name":"pressure_plate","count":48,"isAchievement":true,"ability":false},{"name":"sugar","count":32,"isAchievement":true,"ability":false},{"name":"trap","count":10,"isAchievement":true,"ability":false},{"name":"church","count":1,"isAchievement":true,"ability":false},{"name":"priest","count":1,"isAchievement":true,"ability":false},{"name":"zombie_villager","count":1416,"isAchievement":false,"ability":false},{"name":"diamond","count":17,"isAchievement":false,"ability":false},{"name":"diamond_scepter","count":2,"isAchievement":true,"ability":false},{"name":"king","count":1,"isAchievement":true,"ability":false},{"name":"diamond_smith","count":1,"isAchievement":false,"ability":false},{"name":"diamond_pick","count":1,"isAchievement":true,"ability":false},{"name":"diamond_shovel","count":2,"isAchievement":true,"ability":false},{"name":"diamond_sword","count":1,"isAchievement":true,"ability":false},{"name":"diamond_axe","count":1,"isAchievement":true,"ability":false},{"name":"diamond_hoe","count":1,"isAchievement":true,"ability":false},{"name":"diamond_armor","count":2,"isAchievement":true,"ability":false},{"name":"diamond_soldier","count":3,"isAchievement":true,"ability":false},{"name":"nest","count":2,"isAchievement":false,"ability":false},{"name":"roost","count":0,"isAchievement":true,"ability":false},{"name":"aviary","count":1,"isAchievement":true,"ability":false},{"name":"witch","count":1226,"isAchievement":false,"ability":false},{"name":"redstone","count":33,"isAchievement":true,"ability":false},{"name":"wizard","count":38,"isAchievement":true,"ability":false},{"name":"flying_horse","count":2,"isAchievement":true,"ability":false},{"name":"tamed flying_horse","count":0,"isAchievement":false,"ability":false},{"name":"diamond_block","count":0,"isAchievement":true,"ability":false},{"name":"flying_war_horse","count":0,"isAchievement":true,"ability":false},{"name":"flying_knight","count":0,"isAchievement":true,"ability":false},{"name":"city_state","count":1,"isAchievement":true,"ability":false},{"name":"city_state_exporter","count":0,"isAchievement":false,"ability":false},{"name":"compass","count":0,"isAchievement":true,"ability":false},{"name":"map","count":1,"isAchievement":true,"ability":false},{"name":"fill_dirt","count":1,"isAchievement":true,"ability":false},{"name":"sea_wall","count":2,"isAchievement":true,"ability":false},{"name":"wood_slab","count":141,"isAchievement":false,"ability":false},{"name":"deck","count":25,"isAchievement":true,"ability":false},{"name":"raised_deck","count":13,"isAchievement":false,"ability":false},{"name":"warf","count":0,"isAchievement":true,"ability":false},{"name":"post","count":3,"isAchievement":false,"ability":false},{"name":"platform","count":0,"isAchievement":false,"ability":false},{"name":"pier","count":10,"isAchievement":true,"ability":false},{"name":"dock","count":1,"isAchievement":true,"ability":false},{"name":"shipyard","count":1,"isAchievement":true,"ability":false},{"name":"rib","count":50,"isAchievement":false,"ability":false},{"name":"beam","count":12,"isAchievement":false,"ability":false},{"name":"shell","count":1,"isAchievement":true,"ability":false},{"name":"ship_bow","count":0,"isAchievement":false,"ability":false},{"name":"stern","count":0,"isAchievement":false,"ability":false},{"name":"hull","count":1,"isAchievement":true,"ability":false},{"name":"forecastle","count":7,"isAchievement":false,"ability":false},{"name":"cabin_truss","count":9,"isAchievement":false,"ability":false},{"name":"cabin_roof","count":6,"isAchievement":true,"ability":false},{"name":"cabin_door","count":23,"isAchievement":false,"ability":false},{"name":"cabin","count":0,"isAchievement":false,"ability":false},{"name":"deckhouse","count":0,"isAchievement":false,"ability":false},{"name":"barge","count":0,"isAchievement":true,"ability":false},{"name":"upper_sail","count":28,"isAchievement":true,"ability":false},{"name":"main_sail","count":9,"isAchievement":true,"ability":false},{"name":"mast","count":3,"isAchievement":true,"ability":false},{"name":"lookout","count":1,"isAchievement":false,"ability":false},{"name":"ship","count":3,"isAchievement":true,"ability":false},{"name":"port","count":0,"isAchievement":false,"ability":false},{"name":"port_exporter","count":0,"isAchievement":false,"ability":false},{"name":"scaffold","count":0,"isAchievement":false,"ability":false},{"name":"bridge","count":0,"isAchievement":false,"ability":false},{"name":"scaffolding","count":0,"isAchievement":false,"ability":false},{"name":"rail","count":0,"isAchievement":false,"ability":false},{"name":"spike_maul","count":0,"isAchievement":false,"ability":false},{"name":"line_bar","count":0,"isAchievement":false,"ability":false},{"name":"rail_worker","count":0,"isAchievement":false,"ability":false},{"name":"rail_bridge","count":0,"isAchievement":false,"ability":false},{"name":"railway","count":0,"isAchievement":false,"ability":false},{"name":"railway_exporter","count":0,"isAchievement":false,"ability":false},{"name":"minecart","count":0,"isAchievement":false,"ability":false},{"name":"obsidian","count":0,"isAchievement":false,"ability":false},{"name":"flint_and_steel","count":0,"isAchievement":false,"ability":false},{"name":"portal","count":0,"isAchievement":false,"ability":false},{"name":"iron_door","count":0,"isAchievement":false,"ability":false},{"name":"iron_trap","count":0,"isAchievement":false,"ability":false},{"name":"zombie_pigman","count":0,"isAchievement":false,"ability":false},{"name":"pigman","count":0,"isAchievement":false,"ability":false},{"name":"pigman_worker","count":0,"isAchievement":false,"ability":false},{"name":"worker_pork","count":0,"isAchievement":false,"ability":false},{"name":"netherrack","count":0,"isAchievement":false,"ability":false},{"name":"nether_brick","count":0,"isAchievement":false,"ability":false},{"name":"nether_block","count":0,"isAchievement":false,"ability":false},{"name":"nether_section","count":0,"isAchievement":false,"ability":false},{"name":"pigman_smelter","count":0,"isAchievement":false,"ability":false},{"name":"pigman_mason","count":0,"isAchievement":false,"ability":false},{"name":"pigman_builder","count":0,"isAchievement":false,"ability":false},{"name":"nether_pillar","count":0,"isAchievement":false,"ability":false},{"name":"nether_bridge","count":0,"isAchievement":false,"ability":false},{"name":"nether_bridgeways","count":0,"isAchievement":false,"ability":false},{"name":"smelter_pork","count":0,"isAchievement":false,"ability":false},{"name":"mason_pork","count":0,"isAchievement":false,"ability":false},{"name":"builder_pork","count":0,"isAchievement":false,"ability":false},{"name":"nether_fence","count":0,"isAchievement":false,"ability":false},{"name":"nether_stairs","count":0,"isAchievement":false,"ability":false},{"name":"nether_staircase","count":0,"isAchievement":false,"ability":false},{"name":"nether_spawn","count":0,"isAchievement":false,"ability":false},{"name":"nether_wall","count":0,"isAchievement":false,"ability":false},{"name":"nether_room","count":0,"isAchievement":false,"ability":false},{"name":"nether_well","count":0,"isAchievement":false,"ability":false},{"name":"nether_well_room","count":0,"isAchievement":false,"ability":false},{"name":"nether_fortress_exterior","count":0,"isAchievement":false,"ability":false},{"name":"nether_stair_room","count":0,"isAchievement":false,"ability":false},{"name":"nether_wart_room","count":0,"isAchievement":false,"ability":false},{"name":"nether_hall_section","count":0,"isAchievement":false,"ability":false},{"name":"nether_hallway","count":0,"isAchievement":false,"ability":false},{"name":"nether_stairwell","count":0,"isAchievement":false,"ability":false},{"name":"nether_balcony","count":0,"isAchievement":false,"ability":false},{"name":"nether_fortress_interior","count":0,"isAchievement":false,"ability":false},{"name":"nether_fortress","count":0,"isAchievement":false,"ability":false},{"name":"nether_fortress_exporter","count":0,"isAchievement":false,"ability":false},{"name":"ghast_catcher","count":0,"isAchievement":false,"ability":false},{"name":"ghast_trap","count":0,"isAchievement":false,"ability":false},{"name":"ghast","count":0,"isAchievement":false,"ability":false},{"name":"gunpowder","count":0,"isAchievement":false,"ability":false},{"name":"tamed_ghast","count":0,"isAchievement":false,"ability":false},{"name":"nether_slab","count":0,"isAchievement":false,"ability":false},{"name":"nether_rib","count":0,"isAchievement":false,"ability":false},{"name":"nether_ski","count":0,"isAchievement":false,"ability":false},{"name":"nether_sled","count":0,"isAchievement":false,"ability":false},{"name":"nether_sleigh","count":0,"isAchievement":false,"ability":false},{"name":"nether_sleigh_exporter","count":0,"isAchievement":false,"ability":false},{"name":"blaze_rod","count":0,"isAchievement":false,"ability":false}],"grind":"wood,nothing,stone,coal ore,grass,zombie,skeleton,spider,slime,chicken,cow,pig,sheep,sugar cane,wheat,dirt,gravel,iron_ore,water,lava,gold ore,diamond ore,witch,zombie_villager,horse,","level":"City State","achievementGrind":",wood.png,craftingTable.png,woodHoe.png,woodPick.png,stone.png,coalOre.png,woodAxe.png,woodSword.png,stoneSword.png,woodShovel.png,grass.png,stoneShovel.png,stonePick.png,stoneHoe.png,paper.png,book.png,furnace.png,stoneAxe.png,ironIngot.png,wall.png,hut.png,fence.png,ironShovel.png,bucket.png,wheatField.png,villager.png,woodsman.png,miner.png,gardener.png,goldOre.png,hunter.png,pen.png,butcher.png,pitchFork.png,stairs.png,rafter.png,roof.png,villageBuilding.png,bookshelf.png,crafter.png,mason.png,lavaPool.png,saw.png,forge.png,smelter.png,goldIngot.png,ironBlock.png,ironPick.png,ironAxe.png,ironHoe.png,ironSword.png,sugarCaneField.png,farmer.png,mayor.png,carpenter.png,leatherWorker.png,leatherHelmet.png,leatherBreastplate.png,leatherLeggings.png,leatherBoots.png,leatherArmor.png,sergeant.png,soldier.png,leatherSoldier.png,anvil.png,blacksmith.png,barracks.png,ironHelmet.png,ironBreastplate.png,fletcher.png,arrow.png,goldPick.png,goldSword.png,goldShovel.png,goldAxe.png,goldHoe.png,ladder.png,tower.png,ironLeggings.png,diamondScepter.png,ironBoots.png,ironArmor.png,ironSoldier.png,bow.png,archer.png,fireTeam.png,scoutTower.png,sugar.png,pressurePlate.png,trap.png,diamondPick.png,diamondShovel.png,diamondSword.png,diamondAxe.png,diamondHoe.png,diamondBlock.png,fillDirt.png,redstone.png,compass.png,goldBlock.png,seaWall.png,deck.png,warf.png,pier.png,dock.png,outpost.png,station.png,governor.png,goldSmith.png,contractor.png,commander.png,goldHelmet.png,goldBreastplate.png,goldLeggings.png,goldBoots.png,goldArmor.png,goldSoldier.png,rampart.png,fort.png,keep.png,horseTrainer.png,lead.png,stirrup.png,saddle.png,tamedHorse.png,warHorse.png,hayBale.png,stable.png,goldKnight.png,castle.png,king.png,diamondArmor.png,diamondSoldier.png,church.png,priest.png,wizard.png,flyingHorse.png,roost.png,aviary.png,flyingWarHorse.png,flyingKnight.png,map.png,cityState.png,shipyard.png,upperSail.png,mainSail.png,shell.png,mast.png,hull.png,barge.png,ship.png,","particleCount":50,"soundCount":50,"musicCount":50,"mapVisible":true,"isMerge":true,"isOpenNextLevel":false,"isAutomated":false,"inventoryItem":[{"name":"wood","path":"wood.png","count":22420},{"name":"wood_hoe","path":"woodHoe.png","count":3},{"name":"wood_pick","path":"woodPick.png","count":3},{"name":"coal","path":"coal.png","count":2652},{"name":"wood_axe","path":"woodAxe.png","count":3},{"name":"wood_sword","path":"woodSword.png","count":3},{"name":"wood_shovel","path":"woodShovel.png","count":3},{"name":"seeds","path":"seeds.png","count":16795.819999998013},{"name":"stone_shovel","path":"stoneShovel.png","count":3},{"name":"dirt","path":"dirt.png","count":49907},{"name":"stone_pick","path":"stonePick.png","count":1},{"name":"stone_hoe","path":"stoneHoe.png","count":1},{"name":"wheat","path":"wheat.png","count":26498.63999999498},{"name":"furnace","path":"furnace.png","count":1},{"name":"stone_axe","path":"stoneAxe.png","count":6},{"name":"iron_shovel","path":"ironShovel.png","count":6},{"name":"flint","path":"flint.png","count":357.1999999999885},{"name":"sugar_cane","path":"sugarCane.png","count":41304},{"name":"wool","path":"wool.png","count":312},{"name":"bucket","path":"bucket.png","count":3},{"name":"water","path":"water.png","count":3377},{"name":"woodsman","path":"woodsman.png","count":2},{"name":"miner","path":"miner.png","count":2},{"name":"lava","path":"lava.png","count":1781},{"name":"gardener","path":"gardener.png","count":3},{"name":"cobblestone","path":"cobblestone.png","count":25907},{"name":"feather","path":"feather.png","count":955},{"name":"arrow","path":"arrow.png","count":13},{"name":"leather","path":"leather.png","count":2634},{"name":"butcher","path":"butcher.png","count":2},{"name":"slime ball","path":"slimeBall.png","count":284},{"name":"planks","path":"planks.png","count":70},{"name":"hunter","path":"hunter.png","count":3},{"name":"wall","path":"wall.png","count":4},{"name":"stairs","path":"stairs.png","count":393},{"name":"paper","path":"paper.png","count":17},{"name":"door","path":"door.png","count":11},{"name":"rafter","path":"rafter.png","count":1},{"name":"library","path":"library.png","count":1},{"name":"mason","path":"mason.png","count":1},{"name":"lava_pool","path":"lavaPool.png","count":4},{"name":"saw","path":"saw.png","count":1},{"name":"stone_sword","path":"stoneSword.png","count":4},{"name":"bookcase","path":"bookcase.png","count":2},{"name":"forge","path":"forge.png","count":1},{"name":"smelter","path":"smelter.png","count":1},{"name":"gold_ingot","path":"goldIngot.png","count":193},{"name":"iron_block","path":"ironBlock.png","count":2},{"name":"iron_pick","path":"ironPick.png","count":4},{"name":"iron_axe","path":"ironAxe.png","count":5},{"name":"iron_hoe","path":"ironHoe.png","count":5},{"name":"iron_sword","path":"ironSword.png","count":1},{"name":"bookshelf","path":"bookshelf.png","count":1},{"name":"sugar_cane_field","path":"sugarCaneField.png","count":1},{"name":"soil","path":"soil.png","count":3},{"name":"farmer","path":"farmer.png","count":1},{"name":"truss","path":"truss.png","count":1},{"name":"crafting_table","path":"craftingTable.png","count":6},{"name":"desk","path":"desk.png","count":1},{"name":"mayor","path":"mayor.png","count":1},{"name":"carpenter","path":"carpenter.png","count":1},{"name":"leather_worker","path":"leatherWorker.png","count":1},{"name":"sergeant","path":"sergeant.png","count":1},{"name":"blacksmith","path":"blacksmith.png","count":1},{"name":"fletcher","path":"fletcher.png","count":1},{"name":"gold_pick","path":"goldPick.png","count":11},{"name":"gold_sword","path":"goldSword.png","count":11},{"name":"gold_shovel","path":"goldShovel.png","count":10},{"name":"gold_axe","path":"goldAxe.png","count":10},{"name":"gold_hoe","path":"goldHoe.png","count":9},{"name":"pen","path":"pen.png","count":3},{"name":"roof","path":"roof.png","count":8},{"name":"trap","path":"trap.png","count":10},{"name":"diamond_pick","path":"diamondPick.png","count":1},{"name":"diamond_shovel","path":"diamondShovel.png","count":2},{"name":"zombie_villager","path":"zombieVillager.png","count":1416},{"name":"diamond_sword","path":"diamondSword.png","count":1},{"name":"diamond_axe","path":"diamondAxe.png","count":1},{"name":"diamond_hoe","path":"diamondHoe.png","count":1},{"name":"post","path":"post.png","count":3},{"name":"redstone","path":"redstone.png","count":33},{"name":"witch","path":"witch.png","count":1226},{"name":"sea_wall","path":"seaWall.png","count":2},{"name":"fill_dirt","path":"fillDirt.png","count":1},{"name":"raised_deck","path":"raisedDeck.png","count":13},{"name":"dock","path":"dock.png","count":1},{"name":"deck","path":"deck.png","count":25},{"name":"fence","path":"fence.png","count":32},{"name":"pier","path":"pier.png","count":10},{"name":"ladder","path":"ladder.png","count":9},{"name":"tower","path":"tower.png","count":7},{"name":"iron_helmet","path":"ironHelmet.png","count":6},{"name":"iron_breastplate","path":"ironBreastplate.png","count":4},{"name":"leather_breastplate","path":"leatherBreastplate.png","count":3},{"name":"leather_boots","path":"leatherBoots.png","count":4},{"name":"iron_boots","path":"ironBoots.png","count":2},{"name":"bow","path":"bow.png","count":1},{"name":"iron_leggings","path":"ironLeggings.png","count":1},{"name":"iron_ingot","path":"ironIngot.png","count":1135},{"name":"leather_leggings","path":"leatherLeggings.png","count":7},{"name":"leather_helmet","path":"leatherHelmet.png","count":6},{"name":"leather_armor","path":"leatherArmor.png","count":1},{"name":"hut","path":"hut.png","count":15},{"name":"governor","path":"governor.png","count":1},{"name":"gold_smith","path":"goldSmith.png","count":1},{"name":"contractor","path":"contractor.png","count":1},{"name":"commander","path":"commander.png","count":1},{"name":"wood_slab","path":"woodSlab.png","count":141},{"name":"gold_breastplate","path":"goldBreastplate.png","count":6},{"name":"soldier","path":"soldier.png","count":19},{"name":"gold_helmet","path":"goldHelmet.png","count":3},{"name":"gold_leggings","path":"goldLeggings.png","count":9},{"name":"gold_boots","path":"goldBoots.png","count":9},{"name":"villager","path":"villager.png","count":50},{"name":"outer_wall","path":"outerWall.png","count":1},{"name":"keep","path":"keep.png","count":1},{"name":"horse trainer","path":"horseTrainer.png","count":16},{"name":"lead","path":"lead.png","count":2},{"name":"horse","path":"horse.png","count":298},{"name":"hay_bale","path":"hayBale.png","count":3},{"name":"stable","path":"stable.png","count":1},{"name":"string","path":"string.png","count":38.5},{"name":"tamed_horse","path":"tamedHorse.png","count":2},{"name":"gold_block","path":"goldBlock.png","count":1},{"name":"castle","path":"castle.png","count":1},{"name":"king","path":"king.png","count":1},{"name":"diamond_smith","path":"diamondSmith.png","count":1},{"name":"church","path":"church.png","count":1},{"name":"priest","path":"priest.png","count":1},{"name":"wizard","path":"wizard.png","count":38},{"name":"nest","path":"nest.png","count":2},{"name":"aviary","path":"aviary.png","count":1},{"name":"diamond_armor","path":"diamondArmor.png","count":2},{"name":"diamond_soldier","path":"diamondSoldier.png","count":3},{"name":"flying_horse","path":"flyingHorse.png","count":2},{"name":"saddle","path":"saddle.png","count":2},{"name":"stirrup","path":"stirrup.png","count":1},{"name":"diamond_scepter","path":"diamondScepter.png","count":2},{"name":"stick","path":"stick.png","count":1133},{"name":"map","path":"map.png","count":1},{"name":"diamond","path":"diamond.png","count":17},{"name":"stall","path":"stall.png","count":4},{"name":"sugar","path":"sugar.png","count":32},{"name":"pressure_plate","path":"pressurePlate.png","count":48},{"name":"city_state","path":"cityState.png","count":1},{"name":"shipyard","path":"shipyard.png","count":1},{"name":"rib","path":"rib.png","count":50},{"name":"cabin_door","path":"door.png","count":23},{"name":"lookout","path":"lookout.png","count":1},{"name":"forecastle","path":"forecastle.png","count":7},{"name":"cabin_truss","path":"truss.png","count":9},{"name":"cabin_roof","path":"roof.png","count":6},{"name":"upper_sail","path":"upperSail.png","count":28},{"name":"main_sail","path":"mainSail.png","count":9},{"name":"beam","path":"beam.png","count":12},{"name":"ship","path":"ship.png","count":3},{"name":"mast","path":"mast.png","count":3},{"name":"shell","path":"shell.png","count":1},{"name":"hull","path":"hull.png","count":1}],"achievement":[{"text":"ach_tree_punched","sprite":"wood.png"},{"text":"ach_crafting_table","sprite":"craftingTable.png"},{"text":"ach_wooden_tool","sprite":"woodHoe.png"},{"text":"ach_wooden_tool","sprite":"woodPick.png"},{"text":"ach_stone_begot","sprite":"stone.png"},{"text":"ach_coal_mine","sprite":"coalOre.png"},{"text":"ach_wooden_tool","sprite":"woodAxe.png"},{"text":"ach_wooden_tool","sprite":"woodSword.png"},{"text":"ach_stone_tool","sprite":"stoneSword.png"},{"text":"ach_wooden_tool","sprite":"woodShovel.png"},{"text":"ach_grass_mowed","sprite":"grass.png"},{"text":"ach_stone_tool","sprite":"stoneShovel.png"},{"text":"ach_stone_tool","sprite":"stonePick.png"},{"text":"ach_stone_tool","sprite":"stoneHoe.png"},{"text":"ach_paper_pulped","sprite":"paper.png"},{"text":"ach_book","sprite":"book.png"},{"text":"ach_furnace","sprite":"furnace.png"},{"text":"ach_stone_tool","sprite":"stoneAxe.png"},{"text":"ach_iron_smelted","sprite":"ironIngot.png"},{"text":"ach_wall_built","sprite":"wall.png"},{"text":"ach_hut","sprite":"hut.png"},{"text":"ach_fencing","sprite":"fence.png"},{"text":"ach_iron_tool","sprite":"ironShovel.png"},{"text":"ach_bucket","sprite":"bucket.png"},{"text":"ach_garden_planted","sprite":"wheatField.png"},{"text":"ach_villager","sprite":"villager.png"},{"text":"ach_woodsman","sprite":"woodsman.png"},{"text":"ach_miner","sprite":"miner.png"},{"text":"ach_gardener","sprite":"gardener.png"},{"text":"ach_gold","sprite":"goldOre.png"},{"text":"ach_hunter","sprite":"hunter.png"},{"text":"ach_pen","sprite":"pen.png"},{"text":"ach_butcher","sprite":"butcher.png"},{"text":"ach_iron_crafter","sprite":"pitchFork.png"},{"text":"ach_stairs","sprite":"stairs.png"},{"text":"ach_rafter","sprite":"rafter.png"},{"text":"ach_roof","sprite":"roof.png"},{"text":"ach_village_building","sprite":"villageBuilding.png"},{"text":"ach_bookshelf","sprite":"bookshelf.png"},{"text":"ach_crafter","sprite":"crafter.png"},{"text":"ach_mason","sprite":"mason.png"},{"text":"ach_lava_pool","sprite":"lavaPool.png"},{"text":"ach_saw","sprite":"saw.png"},{"text":"ach_forge","sprite":"forge.png"},{"text":"ach_smelter","sprite":"smelter.png"},{"text":"ach_gold_ingot","sprite":"goldIngot.png"},{"text":"ach_iron_block","sprite":"ironBlock.png"},{"text":"ach_iron_tool","sprite":"ironPick.png"},{"text":"ach_iron_tool","sprite":"ironAxe.png"},{"text":"ach_iron_tool","sprite":"ironHoe.png"},{"text":"ach_iron_tool","sprite":"ironSword.png"},{"text":"ach_sugar_caned","sprite":"sugarCaneField.png"},{"text":"ach_farmer","sprite":"farmer.png"},{"text":"ach_mayor","sprite":"mayor.png"},{"text":"ach_carpenter","sprite":"carpenter.png"},{"text":"ach_leather_worker","sprite":"leatherWorker.png"},{"text":"ach_leather_helmet","sprite":"leatherHelmet.png"},{"text":"ach_leather_breastplate","sprite":"leatherBreastplate.png"},{"text":"ach_leather_leggings","sprite":"leatherLeggings.png"},{"text":"ach_leather_boots","sprite":"leatherBoots.png"},{"text":"ach_leather_armor","sprite":"leatherArmor.png"},{"text":"ach_sergeant","sprite":"sergeant.png"},{"text":"ach_soldier_up","sprite":"soldier.png"},{"text":"ach_leather_soldier","sprite":"leatherSoldier.png"},{"text":"ach_anvil","sprite":"anvil.png"},{"text":"ach_blacksmith","sprite":"blacksmith.png"},{"text":"ach_barracks","sprite":"barracks.png"},{"text":"ach_iron_helmet","sprite":"ironHelmet.png"},{"text":"ach_iron_breastplate","sprite":"ironBreastplate.png"},{"text":"ach_fletcher_trained","sprite":"fletcher.png"},{"text":"ach_arrows_crafted","sprite":"arrow.png"},{"text":"ach_golden_tool","sprite":"goldPick.png"},{"text":"ach_golden_tool","sprite":"goldSword.png"},{"text":"ach_golden_tool","sprite":"goldShovel.png"},{"text":"ach_golden_tool","sprite":"goldAxe.png"},{"text":"ach_golden_tool","sprite":"goldHoe.png"},{"text":"ach_ladders","sprite":"ladder.png"},{"text":"ach_tower","sprite":"tower.png"},{"text":"ach_iron_leggings","sprite":"ironLeggings.png"},{"text":"ach_scepter","sprite":"diamondScepter.png"},{"text":"ach_iron_boots","sprite":"ironBoots.png"},{"text":"ach_iron_armor","sprite":"ironArmor.png"},{"text":"ach_iron_man","sprite":"ironSoldier.png"},{"text":"ach_bow_crafted","sprite":"bow.png"},{"text":"ach_archer","sprite":"archer.png"},{"text":"ach_fire_team","sprite":"fireTeam.png"},{"text":"ach_scout_tower","sprite":"scoutTower.png"},{"text":"ach_sugar_refined","sprite":"sugar.png"},{"text":"ach_pressure_plate","sprite":"pressurePlate.png"},{"text":"ach_trap_built","sprite":"trap.png"},{"text":"ach_diamond_tool","sprite":"diamondPick.png"},{"text":"ach_diamond_tool","sprite":"diamondShovel.png"},{"text":"ach_diamond_tool","sprite":"diamondSword.png"},{"text":"ach_diamond_tool","sprite":"diamondAxe.png"},{"text":"ach_diamond_tool","sprite":"diamondHoe.png"},{"text":"ach_diamond_block","sprite":"diamondBlock.png"},{"text":"ach_fill_dirt","sprite":"fillDirt.png"},{"text":"ach_ding_dong","sprite":"redstone.png"},{"text":"ach_compass_crafted","sprite":"compass.png"},{"text":"ach_gold_block","sprite":"goldBlock.png"},{"text":"ach_sea_wall","sprite":"seaWall.png"},{"text":"ach_deck","sprite":"deck.png"},{"text":"ach_warf","sprite":"warf.png"},{"text":"ach_pier","sprite":"pier.png"},{"text":"ach_dock","sprite":"dock.png"},{"text":"ach_outpost","sprite":"outpost.png"},{"text":"ach_station","sprite":"station.png"},{"text":"ach_governor","sprite":"governor.png"},{"text":"ach_gold_smith","sprite":"goldSmith.png"},{"text":"ach_contractor","sprite":"contractor.png"},{"text":"ach_commander","sprite":"commander.png"},{"text":"ach_gold_helmet","sprite":"goldHelmet.png"},{"text":"ach_gold_breastplate","sprite":"goldBreastplate.png"},{"text":"ach_gold_leggings","sprite":"goldLeggings.png"},{"text":"ach_gold_boots","sprite":"goldBoots.png"},{"text":"ach_gold_armor","sprite":"goldArmor.png"},{"text":"ach_gold_soldier","sprite":"goldSoldier.png"},{"text":"ach_rampart","sprite":"rampart.png"},{"text":"ach_fort","sprite":"fort.png"},{"text":"ach_keep","sprite":"keep.png"},{"text":"ach_horse_trainer","sprite":"horseTrainer.png"},{"text":"ach_lead","sprite":"lead.png"},{"text":"ach_stirrup","sprite":"stirrup.png"},{"text":"ach_saddle","sprite":"saddle.png"},{"text":"ach_horse_tamed","sprite":"tamedHorse.png"},{"text":"ach_war_horse_tamed","sprite":"warHorse.png"},{"text":"ach_hay","sprite":"hayBale.png"},{"text":"ach_horse_stable","sprite":"stable.png"},{"text":"ach_gold_knight","sprite":"goldKnight.png"},{"text":"ach_castle","sprite":"castle.png"},{"text":"ach_king","sprite":"king.png"},{"text":"ach_diamond_armor","sprite":"diamondArmor.png"},{"text":"ach_diamond_soldier","sprite":"diamondSoldier.png"},{"text":"ach_church","sprite":"church.png"},{"text":"ach_priest","sprite":"priest.png"},{"text":"ach_wizard","sprite":"wizard.png"},{"text":"ach_horse_feathers","sprite":"flyingHorse.png"},{"text":"ach_roost","sprite":"roost.png"},{"text":"ach_aviary","sprite":"aviary.png"},{"text":"ach_flying_war_horse","sprite":"flyingWarHorse.png"},{"text":"ach_flying_knight","sprite":"flyingKnight.png"},{"text":"ach_map","sprite":"map.png"},{"text":"ach_city_state","sprite":"cityState.png"},{"text":"ach_shipyard","sprite":"shipyard.png"},{"text":"ach_sail","sprite":"upperSail.png"},{"text":"ach_sail","sprite":"mainSail.png"},{"text":"ach_boat_shell","sprite":"shell.png"},{"text":"ach_mast","sprite":"mast.png"},{"text":"ach_boat","sprite":"hull.png"},{"text":"ach_barge","sprite":"barge.png"},{"text":"ach_ship","sprite":"ship.png"}]}',
    t.chasmMineLevelData = '{"countItem":[{"name":"wood","count":39770,"isAchievement":false,"ability":false},{"name":"wood_pick","count":3,"isAchievement":true,"ability":false},{"name":"wood_shovel","count":3,"isAchievement":true,"ability":false},{"name":"wood_sword","count":3,"isAchievement":true,"ability":false},{"name":"wood_axe","count":3,"isAchievement":true,"ability":false},{"name":"wood_hoe","count":3,"isAchievement":true,"ability":false},{"name":"cobblestone","count":40521,"isAchievement":false,"ability":false},{"name":"stone_shovel","count":3,"isAchievement":true,"ability":false},{"name":"stone_sword","count":4,"isAchievement":true,"ability":false},{"name":"stone_axe","count":6,"isAchievement":true,"ability":false},{"name":"stone_hoe","count":1,"isAchievement":true,"ability":false},{"name":"stone_pick","count":1,"isAchievement":true,"ability":false},{"name":"furnace","count":6,"isAchievement":true,"ability":false},{"name":"bucket","count":3,"isAchievement":true,"ability":false},{"name":"coal","count":4380,"isAchievement":false,"ability":false},{"name":"iron_ore","count":0,"isAchievement":false,"ability":false},{"name":"iron_ingot","count":1288,"isAchievement":true,"ability":false},{"name":"dirt","count":89825,"isAchievement":false,"ability":false},{"name":"soil","count":3,"isAchievement":false,"ability":false},{"name":"water","count":4027,"isAchievement":false,"ability":false},{"name":"plot","count":0,"isAchievement":false,"ability":false},{"name":"seeds","count":19955.23000000211,"isAchievement":false,"ability":false},{"name":"wheat_field","count":0,"isAchievement":true,"ability":false},{"name":"planks","count":22,"isAchievement":false,"ability":false},{"name":"crafting_table","count":18,"isAchievement":true,"ability":false},{"name":"stick","count":1091,"isAchievement":false,"ability":false},{"name":"door","count":11,"isAchievement":false,"ability":false},{"name":"wall","count":4,"isAchievement":true,"ability":false},{"name":"hut","count":15,"isAchievement":true,"ability":false},{"name":"villager","count":50,"isAchievement":false,"ability":false},{"name":"woodsman","count":2,"isAchievement":true,"ability":true},{"name":"miner","count":2,"isAchievement":true,"ability":true},{"name":"gardener","count":3,"isAchievement":true,"ability":true},{"name":"hunter","count":5,"isAchievement":true,"ability":true},{"name":"fence","count":110,"isAchievement":true,"ability":false},{"name":"pen","count":3,"isAchievement":true,"ability":false},{"name":"butcher","count":2,"isAchievement":true,"ability":true},{"name":"stairs","count":393,"isAchievement":true,"ability":false},{"name":"rafter","count":1,"isAchievement":true,"ability":false},{"name":"truss","count":1,"isAchievement":false,"ability":false},{"name":"roof","count":8,"isAchievement":true,"ability":false},{"name":"village_building","count":0,"isAchievement":true,"ability":false},{"name":"sugar_cane_field","count":1,"isAchievement":true,"ability":false},{"name":"sugar_cane","count":48960,"isAchievement":false,"ability":false},{"name":"paper","count":17,"isAchievement":true,"ability":false},{"name":"book","count":0,"isAchievement":true,"ability":false},{"name":"bookshelf","count":1,"isAchievement":true,"ability":false},{"name":"bookcase","count":2,"isAchievement":false,"ability":false},{"name":"library","count":1,"isAchievement":false,"ability":false},{"name":"crafter","count":0,"isAchievement":true,"ability":false},{"name":"mason","count":1,"isAchievement":true,"ability":false},{"name":"lava","count":2646,"isAchievement":false,"ability":false},{"name":"lava_pool","count":4,"isAchievement":true,"ability":false},{"name":"forge","count":1,"isAchievement":true,"ability":false},{"name":"smelter","count":1,"isAchievement":true,"ability":true},{"name":"pitch_fork","count":0,"isAchievement":true,"ability":false},{"name":"farmer","count":1,"isAchievement":true,"ability":false},{"name":"saw","count":1,"isAchievement":true,"ability":false},{"name":"carpenter","count":1,"isAchievement":true,"ability":false},{"name":"desk","count":1,"isAchievement":false,"ability":false},{"name":"mayor","count":1,"isAchievement":true,"ability":false},{"name":"iron_pick","count":4,"isAchievement":true,"ability":false},{"name":"iron_shovel","count":6,"isAchievement":true,"ability":false},{"name":"iron_axe","count":5,"isAchievement":true,"ability":false},{"name":"iron_hoe","count":5,"isAchievement":true,"ability":false},{"name":"iron_sword","count":10,"isAchievement":true,"ability":false},{"name":"leather_worker","count":1,"isAchievement":true,"ability":false},{"name":"leather","count":3110,"isAchievement":false,"ability":false},{"name":"leather_helmet","count":6,"isAchievement":true,"ability":false},{"name":"leather_breastplate","count":3,"isAchievement":true,"ability":false},{"name":"leather_leggings","count":7,"isAchievement":true,"ability":false},{"name":"leather_boots","count":4,"isAchievement":true,"ability":false},{"name":"leather_armor","count":1,"isAchievement":true,"ability":false},{"name":"sergeant","count":1,"isAchievement":true,"ability":false},{"name":"soldier","count":19,"isAchievement":true,"ability":false},{"name":"leather_soldier","count":0,"isAchievement":true,"ability":false},{"name":"barracks","count":0,"isAchievement":true,"ability":false},{"name":"iron_block","count":2,"isAchievement":true,"ability":false},{"name":"anvil","count":0,"isAchievement":true,"ability":false},{"name":"blacksmith","count":1,"isAchievement":true,"ability":false},{"name":"iron_helmet","count":6,"isAchievement":true,"ability":false},{"name":"iron_breastplate","count":4,"isAchievement":true,"ability":false},{"name":"iron_leggings","count":1,"isAchievement":true,"ability":false},{"name":"iron_boots","count":2,"isAchievement":true,"ability":false},{"name":"iron_armor","count":0,"isAchievement":true,"ability":false},{"name":"iron_soldier","count":0,"isAchievement":true,"ability":false},{"name":"fletcher","count":1,"isAchievement":true,"ability":false},{"name":"wool","count":440,"isAchievement":false,"ability":false},{"name":"string","count":149.5,"isAchievement":false,"ability":false},{"name":"bow","count":1,"isAchievement":true,"ability":false},{"name":"feather","count":1074,"isAchievement":false,"ability":false},{"name":"flint","count":465.19999999998,"isAchievement":false,"ability":false},{"name":"arrow","count":13,"isAchievement":true,"ability":false},{"name":"archer","count":0,"isAchievement":true,"ability":false},{"name":"fire_team","count":0,"isAchievement":true,"ability":false},{"name":"ladder","count":76,"isAchievement":true,"ability":false},{"name":"tower","count":7,"isAchievement":false,"ability":false},{"name":"scout_tower","count":0,"isAchievement":true,"ability":false},{"name":"outpost","count":0,"isAchievement":true,"ability":false},{"name":"outpost_exporter","count":0,"isAchievement":false,"ability":false},{"name":"station","count":0,"isAchievement":true,"ability":false},{"name":"governor","count":1,"isAchievement":true,"ability":false},{"name":"gold_ore","count":0,"isAchievement":false,"ability":false},{"name":"gold_ingot","count":417,"isAchievement":true,"ability":false},{"name":"gold_pick","count":11,"isAchievement":true,"ability":false},{"name":"gold_shovel","count":10,"isAchievement":true,"ability":false},{"name":"gold_sword","count":11,"isAchievement":true,"ability":false},{"name":"gold_axe","count":10,"isAchievement":true,"ability":false},{"name":"gold_hoe","count":9,"isAchievement":true,"ability":false},{"name":"gold_smith","count":1,"isAchievement":true,"ability":true},{"name":"contractor","count":0,"isAchievement":true,"ability":false},{"name":"commander","count":1,"isAchievement":true,"ability":false},{"name":"gold_helmet","count":3,"isAchievement":true,"ability":false},{"name":"gold_breastplate","count":6,"isAchievement":true,"ability":false},{"name":"gold_leggings","count":9,"isAchievement":true,"ability":false},{"name":"gold_boots","count":9,"isAchievement":true,"ability":false},{"name":"gold_armor","count":0,"isAchievement":true,"ability":false},{"name":"gold_soldier","count":0,"isAchievement":true,"ability":false},{"name":"outer_wall","count":1,"isAchievement":false,"ability":false},{"name":"rampart","count":0,"isAchievement":true,"ability":false},{"name":"fort","count":0,"isAchievement":true,"ability":false},{"name":"fort_exporter","count":0,"isAchievement":false,"ability":false},{"name":"wheat","count":31565.459999993862,"isAchievement":false,"ability":false},{"name":"hay_bale","count":3,"isAchievement":true,"ability":false},{"name":"stall","count":4,"isAchievement":false,"ability":false},{"name":"stable","count":1,"isAchievement":true,"ability":false},{"name":"horse trainer","count":16,"isAchievement":true,"ability":false},{"name":"slime ball","count":365,"isAchievement":false,"ability":false},{"name":"lead","count":11,"isAchievement":true,"ability":false},{"name":"stirrup","count":1,"isAchievement":true,"ability":false},{"name":"saddle","count":2,"isAchievement":true,"ability":false},{"name":"horse","count":538,"isAchievement":false,"ability":false},{"name":"tamed_horse","count":2,"isAchievement":true,"ability":false},{"name":"gold_block","count":1,"isAchievement":true,"ability":false},{"name":"war_horse","count":0,"isAchievement":true,"ability":false},{"name":"gold_knight","count":0,"isAchievement":true,"ability":false},{"name":"keep","count":1,"isAchievement":true,"ability":false},{"name":"castle","count":1,"isAchievement":true,"ability":false},{"name":"castle_exporter","count":0,"isAchievement":false,"ability":false},{"name":"pressure_plate","count":47,"isAchievement":true,"ability":false},{"name":"sugar","count":32,"isAchievement":true,"ability":false},{"name":"trap","count":10,"isAchievement":true,"ability":false},{"name":"church","count":1,"isAchievement":true,"ability":false},{"name":"priest","count":1,"isAchievement":true,"ability":false},{"name":"zombie_villager","count":1740,"isAchievement":false,"ability":false},{"name":"diamond","count":177,"isAchievement":false,"ability":false},{"name":"diamond_scepter","count":2,"isAchievement":true,"ability":false},{"name":"king","count":1,"isAchievement":true,"ability":false},{"name":"diamond_smith","count":1,"isAchievement":false,"ability":false},{"name":"diamond_pick","count":1,"isAchievement":true,"ability":false},{"name":"diamond_shovel","count":2,"isAchievement":true,"ability":false},{"name":"diamond_sword","count":1,"isAchievement":true,"ability":false},{"name":"diamond_axe","count":1,"isAchievement":true,"ability":false},{"name":"diamond_hoe","count":1,"isAchievement":true,"ability":false},{"name":"diamond_armor","count":2,"isAchievement":true,"ability":false},{"name":"diamond_soldier","count":3,"isAchievement":true,"ability":false},{"name":"nest","count":2,"isAchievement":false,"ability":false},{"name":"roost","count":0,"isAchievement":true,"ability":false},{"name":"aviary","count":1,"isAchievement":true,"ability":false},{"name":"witch","count":1462,"isAchievement":false,"ability":false},{"name":"redstone","count":33,"isAchievement":true,"ability":false},{"name":"wizard","count":38,"isAchievement":true,"ability":false},{"name":"flying_horse","count":2,"isAchievement":true,"ability":false},{"name":"tamed flying_horse","count":0,"isAchievement":false,"ability":false},{"name":"diamond_block","count":0,"isAchievement":true,"ability":false},{"name":"flying_war_horse","count":0,"isAchievement":true,"ability":false},{"name":"flying_knight","count":0,"isAchievement":true,"ability":false},{"name":"city_state","count":1,"isAchievement":true,"ability":false},{"name":"city_state_exporter","count":0,"isAchievement":false,"ability":false},{"name":"compass","count":0,"isAchievement":true,"ability":false},{"name":"map","count":1,"isAchievement":true,"ability":false},{"name":"fill_dirt","count":1,"isAchievement":true,"ability":false},{"name":"sea_wall","count":2,"isAchievement":true,"ability":false},{"name":"wood_slab","count":126,"isAchievement":false,"ability":false},{"name":"deck","count":91,"isAchievement":true,"ability":false},{"name":"raised_deck","count":13,"isAchievement":false,"ability":false},{"name":"warf","count":0,"isAchievement":true,"ability":false},{"name":"post","count":2,"isAchievement":false,"ability":false},{"name":"platform","count":5,"isAchievement":false,"ability":false},{"name":"pier","count":10,"isAchievement":true,"ability":false},{"name":"dock","count":1,"isAchievement":true,"ability":false},{"name":"shipyard","count":1,"isAchievement":true,"ability":false},{"name":"rib","count":50,"isAchievement":false,"ability":false},{"name":"beam","count":12,"isAchievement":false,"ability":false},{"name":"shell","count":1,"isAchievement":true,"ability":false},{"name":"ship_bow","count":0,"isAchievement":false,"ability":false},{"name":"stern","count":0,"isAchievement":false,"ability":false},{"name":"hull","count":1,"isAchievement":true,"ability":false},{"name":"forecastle","count":7,"isAchievement":false,"ability":false},{"name":"cabin_truss","count":9,"isAchievement":false,"ability":false},{"name":"cabin_roof","count":6,"isAchievement":true,"ability":false},{"name":"cabin_door","count":23,"isAchievement":false,"ability":false},{"name":"cabin","count":0,"isAchievement":false,"ability":false},{"name":"deckhouse","count":0,"isAchievement":false,"ability":false},{"name":"barge","count":0,"isAchievement":true,"ability":false},{"name":"upper_sail","count":28,"isAchievement":true,"ability":false},{"name":"main_sail","count":9,"isAchievement":true,"ability":false},{"name":"mast","count":3,"isAchievement":true,"ability":false},{"name":"lookout","count":1,"isAchievement":false,"ability":false},{"name":"ship","count":0,"isAchievement":true,"ability":false},{"name":"port","count":1,"isAchievement":true,"ability":false},{"name":"port_exporter","count":0,"isAchievement":false,"ability":false},{"name":"scaffold","count":1,"isAchievement":true,"ability":false},{"name":"bridge","count":9,"isAchievement":true,"ability":false},{"name":"scaffolding","count":1,"isAchievement":true,"ability":false},{"name":"rail","count":384,"isAchievement":true,"ability":false},{"name":"spike_maul","count":10,"isAchievement":true,"ability":false},{"name":"line_bar","count":10,"isAchievement":true,"ability":false},{"name":"rail_worker","count":1,"isAchievement":true,"ability":false},{"name":"rail_bridge","count":0,"isAchievement":true,"ability":false},{"name":"railway","count":2,"isAchievement":true,"ability":false},{"name":"railway_exporter","count":0,"isAchievement":false,"ability":false},{"name":"minecart","count":24,"isAchievement":true,"ability":false},{"name":"obsidian","count":142,"isAchievement":false,"ability":false},{"name":"flint_and_steel","count":42,"isAchievement":true,"ability":false},{"name":"portal","count":2,"isAchievement":true,"ability":false},{"name":"iron_door","count":15,"isAchievement":true,"ability":false},{"name":"iron_trap","count":1,"isAchievement":true,"ability":true},{"name":"zombie_pigman","count":612,"isAchievement":false,"ability":false},{"name":"pigman","count":3,"isAchievement":true,"ability":false},{"name":"pigman_worker","count":10,"isAchievement":true,"ability":true},{"name":"worker_pork","count":9,"isAchievement":true,"ability":false},{"name":"netherrack","count":177440,"isAchievement":false,"ability":false},{"name":"nether_brick","count":3160,"isAchievement":true,"ability":false},{"name":"nether_block","count":18,"isAchievement":true,"ability":false},{"name":"nether_section","count":631,"isAchievement":true,"ability":false},{"name":"pigman_smelter","count":5,"isAchievement":true,"ability":true},{"name":"pigman_mason","count":5,"isAchievement":true,"ability":true},{"name":"pigman_builder","count":5,"isAchievement":true,"ability":true},{"name":"nether_pillar","count":0,"isAchievement":true,"ability":false},{"name":"nether_bridge","count":0,"isAchievement":true,"ability":false},{"name":"nether_bridgeways","count":0,"isAchievement":true,"ability":false},{"name":"smelter_pork","count":10,"isAchievement":true,"ability":false},{"name":"mason_pork","count":10,"isAchievement":true,"ability":false},{"name":"builder_pork","count":10,"isAchievement":true,"ability":false},{"name":"nether_fence","count":18,"isAchievement":true,"ability":false},{"name":"nether_stairs","count":31,"isAchievement":true,"ability":false},{"name":"nether_staircase","count":4,"isAchievement":true,"ability":false},{"name":"nether_spawn","count":0,"isAchievement":false,"ability":false},{"name":"nether_wall","count":6,"isAchievement":false,"ability":false},{"name":"nether_room","count":0,"isAchievement":true,"ability":false},{"name":"nether_well","count":9,"isAchievement":true,"ability":false},{"name":"nether_well_room","count":3,"isAchievement":true,"ability":false},{"name":"nether_fortress_exterior","count":1,"isAchievement":true,"ability":false},{"name":"nether_stair_room","count":0,"isAchievement":true,"ability":false},{"name":"nether_wart_room","count":0,"isAchievement":true,"ability":false},{"name":"nether_hall_section","count":1,"isAchievement":false,"ability":false},{"name":"nether_hallway","count":1,"isAchievement":true,"ability":false},{"name":"nether_stairwell","count":0,"isAchievement":true,"ability":false},{"name":"nether_balcony","count":4,"isAchievement":true,"ability":false},{"name":"nether_fortress_interior","count":1,"isAchievement":true,"ability":false},{"name":"nether_fortress","count":0,"isAchievement":false,"ability":false},{"name":"nether_fortress_exporter","count":0,"isAchievement":false,"ability":false},{"name":"ghast_catcher","count":0,"isAchievement":false,"ability":false},{"name":"ghast_trap","count":0,"isAchievement":false,"ability":false},{"name":"ghast","count":0,"isAchievement":false,"ability":false},{"name":"gunpowder","count":0,"isAchievement":false,"ability":false},{"name":"tamed_ghast","count":0,"isAchievement":false,"ability":false},{"name":"nether_slab","count":116,"isAchievement":true,"ability":false},{"name":"nether_rib","count":4,"isAchievement":true,"ability":false},{"name":"nether_ski","count":5,"isAchievement":true,"ability":false},{"name":"nether_sled","count":2,"isAchievement":true,"ability":false},{"name":"nether_sleigh","count":0,"isAchievement":false,"ability":false},{"name":"nether_sleigh_exporter","count":0,"isAchievement":false,"ability":false},{"name":"blaze_rod","count":0,"isAchievement":false,"ability":false}],"grind":"wood,nothing,stone,grass,zombie,skeleton,spider,slime,chicken,cow,pig,sheep,sugar cane,wheat,dirt,gravel,water,gold ore,witch,zombie_villager,horse,coal ore,iron_ore,lava,diamond ore,obsidian,witherSkeleton,zombie_pigman,netherrack,","level":"Chasm Mine","achievementGrind":",wood.png,craftingTable.png,woodHoe.png,woodPick.png,stone.png,coalOre.png,woodAxe.png,woodSword.png,stoneSword.png,woodShovel.png,grass.png,stoneShovel.png,stonePick.png,stoneHoe.png,paper.png,book.png,furnace.png,stoneAxe.png,ironIngot.png,wall.png,hut.png,fence.png,ironShovel.png,bucket.png,wheatField.png,villager.png,woodsman.png,miner.png,gardener.png,goldOre.png,hunter.png,pen.png,butcher.png,pitchFork.png,stairs.png,rafter.png,roof.png,villageBuilding.png,bookshelf.png,crafter.png,mason.png,lavaPool.png,saw.png,forge.png,smelter.png,goldIngot.png,ironBlock.png,ironPick.png,ironAxe.png,ironHoe.png,ironSword.png,sugarCaneField.png,farmer.png,mayor.png,carpenter.png,leatherWorker.png,leatherHelmet.png,leatherBreastplate.png,leatherLeggings.png,leatherBoots.png,leatherArmor.png,sergeant.png,soldier.png,leatherSoldier.png,anvil.png,blacksmith.png,barracks.png,ironHelmet.png,ironBreastplate.png,fletcher.png,arrow.png,goldPick.png,goldSword.png,goldShovel.png,goldAxe.png,goldHoe.png,ladder.png,tower.png,ironLeggings.png,diamondScepter.png,ironBoots.png,ironArmor.png,ironSoldier.png,bow.png,archer.png,fireTeam.png,scoutTower.png,sugar.png,pressurePlate.png,trap.png,diamondPick.png,diamondShovel.png,diamondSword.png,diamondAxe.png,diamondHoe.png,diamondBlock.png,fillDirt.png,redstone.png,compass.png,goldBlock.png,seaWall.png,deck.png,warf.png,pier.png,dock.png,outpost.png,station.png,governor.png,goldSmith.png,contractor.png,commander.png,goldHelmet.png,goldBreastplate.png,goldLeggings.png,goldBoots.png,goldArmor.png,goldSoldier.png,rampart.png,fort.png,keep.png,horseTrainer.png,lead.png,stirrup.png,saddle.png,tamedHorse.png,warHorse.png,hayBale.png,stable.png,goldKnight.png,castle.png,king.png,diamondArmor.png,diamondSoldier.png,church.png,priest.png,wizard.png,flyingHorse.png,roost.png,aviary.png,flyingWarHorse.png,flyingKnight.png,map.png,cityState.png,shipyard.png,upperSail.png,mainSail.png,shell.png,mast.png,hull.png,barge.png,ship.png,port.png,lineBar.png,spikeMaul.png,railWorker.png,bridge.png,scaffold.png,scaffolding.png,rail.png,railBridge.png,flintAndSteel.png,ironDoor.png,railway.png,minecart.png,portal.png,ironTrap.png,pig.png,pigmanWorker.png,netherrack.png,workerPork.png,netherBrick.png,netherblock.png,netherSection.png,pigmanSmelter.png,smelterPork.png,pigmanMason.png,pigmanBuilder.png,netherPillar.png,masonPork.png,builderPork.png,netherFence.png,netherStairs.png,netherStaircase.png,netherWell.png,netherBridge.png,netherHallway.png,netherBalcony.png,netherSlab.png,netherRib.png,netherSki.png,netherSled.png,netherBridgeways.png,netherStairwell.png,netherRoom.png,netherWellRoom.png,netherFortressExterior.png,netherStairRoom.png,netherWartRoom.png,netherFortressInterior.png,","particleCount":50,"soundCount":50,"musicCount":50,"mapVisible":true,"isMerge":true,"isOpenNextLevel":true,"isAutomated":false,"inventoryItem":[{"name":"wood","path":"wood.png","count":39770},{"name":"coal","path":"coal.png","count":4380},{"name":"dirt","path":"dirt.png","count":89825},{"name":"furnace","path":"furnace.png","count":6},{"name":"iron_shovel","path":"ironShovel.png","count":6},{"name":"flint","path":"flint.png","count":465.19999999998},{"name":"woodsman","path":"woodsman.png","count":2},{"name":"miner","path":"miner.png","count":2},{"name":"lava","path":"lava.png","count":2646},{"name":"cobblestone","path":"cobblestone.png","count":40521},{"name":"arrow","path":"arrow.png","count":13},{"name":"slime ball","path":"slimeBall.png","count":365},{"name":"planks","path":"planks.png","count":22},{"name":"hunter","path":"hunter.png","count":3},{"name":"smelter","path":"smelter.png","count":1},{"name":"gold_ingot","path":"goldIngot.png","count":417},{"name":"iron_pick","path":"ironPick.png","count":4},{"name":"iron_axe","path":"ironAxe.png","count":5},{"name":"iron_hoe","path":"ironHoe.png","count":5},{"name":"iron_sword","path":"ironSword.png","count":10},{"name":"crafting_table","path":"craftingTable.png","count":18},{"name":"carpenter","path":"carpenter.png","count":1},{"name":"gold_pick","path":"goldPick.png","count":11},{"name":"gold_sword","path":"goldSword.png","count":11},{"name":"gold_shovel","path":"goldShovel.png","count":10},{"name":"gold_axe","path":"goldAxe.png","count":10},{"name":"gold_hoe","path":"goldHoe.png","count":9},{"name":"diamond_pick","path":"diamondPick.png","count":1},{"name":"diamond_shovel","path":"diamondShovel.png","count":2},{"name":"diamond_sword","path":"diamondSword.png","count":1},{"name":"diamond_axe","path":"diamondAxe.png","count":1},{"name":"diamond_hoe","path":"diamondHoe.png","count":1},{"name":"deck","path":"deck.png","count":91},{"name":"fence","path":"fence.png","count":110},{"name":"ladder","path":"ladder.png","count":76},{"name":"iron_ingot","path":"ironIngot.png","count":1288},{"name":"wood_slab","path":"woodSlab.png","count":126},{"name":"lead","path":"lead.png","count":11},{"name":"string","path":"string.png","count":149.5},{"name":"priest","path":"priest.png","count":1},{"name":"stick","path":"stick.png","count":1091},{"name":"diamond","path":"diamond.png","count":177},{"name":"pressure_plate","path":"pressurePlate.png","count":47},{"name":"city_state","path":"cityState.png","count":1},{"name":"port","path":"port.png","count":1},{"name":"rail_worker","path":"railWorker.png","count":1},{"name":"bridge","path":"bridge.png","count":9},{"name":"line_bar","path":"lineBar.png","count":10},{"name":"spike_maul","path":"spikeMaul.png","count":10},{"name":"scaffolding","path":"scaffolding.png","count":1},{"name":"rail","path":"rail.png","count":384},{"name":"flint_and_steel","path":"flintAndSteel.png","count":42},{"name":"iron_door","path":"ironDoor.png","count":15},{"name":"railway","path":"railway.png","count":2},{"name":"minecart","path":"minecart.png","count":24},{"name":"obsidian","path":"obsidian.png","count":142},{"name":"scaffold","path":"scaffold.png","count":1},{"name":"post","path":"post.png","count":2},{"name":"platform","path":"platform.png","count":5},{"name":"portal","path":"portal.png","count":2},{"name":"iron_trap","path":"ironTrap.png","count":1},{"name":"netherrack","path":"netherrack.png","count":177440},{"name":"worker_pork","path":"workerPork.png","count":9},{"name":"pigman_worker","path":"pigmanWorker.png","count":10},{"name":"smelter_pork","path":"smelterPork.png","count":10},{"name":"pigman_smelter","path":"pigmanSmelter.png","count":5},{"name":"zombie_pigman","path":"zombiePigman.png","count":612},{"name":"mason_pork","path":"masonPork.png","count":10},{"name":"builder_pork","path":"builderPork.png","count":10},{"name":"nether_staircase","path":"netherStaircase.png","count":4},{"name":"nether_well","path":"netherWell.png","count":9},{"name":"pigman_mason","path":"pigmanMason.png","count":5},{"name":"pigman_builder","path":"pigmanBuilder.png","count":5},{"name":"nether_hallway","path":"netherHallway.png","count":1},{"name":"nether_stairs","path":"netherStairs.png","count":31},{"name":"nether_balcony","path":"netherBalcony.png","count":4},{"name":"nether_slab","path":"netherSlab.png","count":116},{"name":"nether_sled","path":"netherSled.png","count":2},{"name":"pigman","path":"pig.png","count":3},{"name":"nether_section","path":"netherSection.png","count":631},{"name":"nether_hall_section","path":"netherHallSection.png","count":1},{"name":"nether_fence","path":"netherFence.png","count":18},{"name":"nether_ski","path":"netherSki.png","count":5},{"name":"nether_rib","path":"netherRib.png","count":4},{"name":"nether_brick","path":"netherBrick.png","count":3160},{"name":"nether_wall","path":"netherWall.png","count":6},{"name":"nether_well_room","path":"netherWellRoom.png","count":3},{"name":"nether_fortress_exterior","path":"netherFortressExterior.png","count":1},{"name":"nether_fortress_interior","path":"netherFortressInterior.png","count":1},{"name":"nether_block","path":"netherblock.png","count":18}],"achievement":[{"text":"ach_tree_punched","sprite":"wood.png"},{"text":"ach_crafting_table","sprite":"craftingTable.png"},{"text":"ach_wooden_tool","sprite":"woodHoe.png"},{"text":"ach_wooden_tool","sprite":"woodPick.png"},{"text":"ach_stone_begot","sprite":"stone.png"},{"text":"ach_coal_mine","sprite":"coalOre.png"},{"text":"ach_wooden_tool","sprite":"woodAxe.png"},{"text":"ach_wooden_tool","sprite":"woodSword.png"},{"text":"ach_stone_tool","sprite":"stoneSword.png"},{"text":"ach_wooden_tool","sprite":"woodShovel.png"},{"text":"ach_grass_mowed","sprite":"grass.png"},{"text":"ach_stone_tool","sprite":"stoneShovel.png"},{"text":"ach_stone_tool","sprite":"stonePick.png"},{"text":"ach_stone_tool","sprite":"stoneHoe.png"},{"text":"ach_paper_pulped","sprite":"paper.png"},{"text":"ach_book","sprite":"book.png"},{"text":"ach_furnace","sprite":"furnace.png"},{"text":"ach_stone_tool","sprite":"stoneAxe.png"},{"text":"ach_iron_smelted","sprite":"ironIngot.png"},{"text":"ach_wall_built","sprite":"wall.png"},{"text":"ach_hut","sprite":"hut.png"},{"text":"ach_fencing","sprite":"fence.png"},{"text":"ach_iron_tool","sprite":"ironShovel.png"},{"text":"ach_bucket","sprite":"bucket.png"},{"text":"ach_garden_planted","sprite":"wheatField.png"},{"text":"ach_villager","sprite":"villager.png"},{"text":"ach_woodsman","sprite":"woodsman.png"},{"text":"ach_miner","sprite":"miner.png"},{"text":"ach_gardener","sprite":"gardener.png"},{"text":"ach_gold","sprite":"goldOre.png"},{"text":"ach_hunter","sprite":"hunter.png"},{"text":"ach_pen","sprite":"pen.png"},{"text":"ach_butcher","sprite":"butcher.png"},{"text":"ach_iron_crafter","sprite":"pitchFork.png"},{"text":"ach_stairs","sprite":"stairs.png"},{"text":"ach_rafter","sprite":"rafter.png"},{"text":"ach_roof","sprite":"roof.png"},{"text":"ach_village_building","sprite":"villageBuilding.png"},{"text":"ach_bookshelf","sprite":"bookshelf.png"},{"text":"ach_crafter","sprite":"crafter.png"},{"text":"ach_mason","sprite":"mason.png"},{"text":"ach_lava_pool","sprite":"lavaPool.png"},{"text":"ach_saw","sprite":"saw.png"},{"text":"ach_forge","sprite":"forge.png"},{"text":"ach_smelter","sprite":"smelter.png"},{"text":"ach_gold_ingot","sprite":"goldIngot.png"},{"text":"ach_iron_block","sprite":"ironBlock.png"},{"text":"ach_iron_tool","sprite":"ironPick.png"},{"text":"ach_iron_tool","sprite":"ironAxe.png"},{"text":"ach_iron_tool","sprite":"ironHoe.png"},{"text":"ach_iron_tool","sprite":"ironSword.png"},{"text":"ach_sugar_caned","sprite":"sugarCaneField.png"},{"text":"ach_farmer","sprite":"farmer.png"},{"text":"ach_mayor","sprite":"mayor.png"},{"text":"ach_carpenter","sprite":"carpenter.png"},{"text":"ach_leather_worker","sprite":"leatherWorker.png"},{"text":"ach_leather_helmet","sprite":"leatherHelmet.png"},{"text":"ach_leather_breastplate","sprite":"leatherBreastplate.png"},{"text":"ach_leather_leggings","sprite":"leatherLeggings.png"},{"text":"ach_leather_boots","sprite":"leatherBoots.png"},{"text":"ach_leather_armor","sprite":"leatherArmor.png"},{"text":"ach_sergeant","sprite":"sergeant.png"},{"text":"ach_soldier_up","sprite":"soldier.png"},{"text":"ach_leather_soldier","sprite":"leatherSoldier.png"},{"text":"ach_anvil","sprite":"anvil.png"},{"text":"ach_blacksmith","sprite":"blacksmith.png"},{"text":"ach_barracks","sprite":"barracks.png"},{"text":"ach_iron_helmet","sprite":"ironHelmet.png"},{"text":"ach_iron_breastplate","sprite":"ironBreastplate.png"},{"text":"ach_fletcher_trained","sprite":"fletcher.png"},{"text":"ach_arrows_crafted","sprite":"arrow.png"},{"text":"ach_golden_tool","sprite":"goldPick.png"},{"text":"ach_golden_tool","sprite":"goldSword.png"},{"text":"ach_golden_tool","sprite":"goldShovel.png"},{"text":"ach_golden_tool","sprite":"goldAxe.png"},{"text":"ach_golden_tool","sprite":"goldHoe.png"},{"text":"ach_ladders","sprite":"ladder.png"},{"text":"ach_tower","sprite":"tower.png"},{"text":"ach_iron_leggings","sprite":"ironLeggings.png"},{"text":"ach_scepter","sprite":"diamondScepter.png"},{"text":"ach_iron_boots","sprite":"ironBoots.png"},{"text":"ach_iron_armor","sprite":"ironArmor.png"},{"text":"ach_iron_man","sprite":"ironSoldier.png"},{"text":"ach_bow_crafted","sprite":"bow.png"},{"text":"ach_archer","sprite":"archer.png"},{"text":"ach_fire_team","sprite":"fireTeam.png"},{"text":"ach_scout_tower","sprite":"scoutTower.png"},{"text":"ach_sugar_refined","sprite":"sugar.png"},{"text":"ach_pressure_plate","sprite":"pressurePlate.png"},{"text":"ach_trap_built","sprite":"trap.png"},{"text":"ach_diamond_tool","sprite":"diamondPick.png"},{"text":"ach_diamond_tool","sprite":"diamondShovel.png"},{"text":"ach_diamond_tool","sprite":"diamondSword.png"},{"text":"ach_diamond_tool","sprite":"diamondAxe.png"},{"text":"ach_diamond_tool","sprite":"diamondHoe.png"},{"text":"ach_diamond_block","sprite":"diamondBlock.png"},{"text":"ach_fill_dirt","sprite":"fillDirt.png"},{"text":"ach_ding_dong","sprite":"redstone.png"},{"text":"ach_compass_crafted","sprite":"compass.png"},{"text":"ach_gold_block","sprite":"goldBlock.png"},{"text":"ach_sea_wall","sprite":"seaWall.png"},{"text":"ach_deck","sprite":"deck.png"},{"text":"ach_warf","sprite":"warf.png"},{"text":"ach_pier","sprite":"pier.png"},{"text":"ach_dock","sprite":"dock.png"},{"text":"ach_outpost","sprite":"outpost.png"},{"text":"ach_station","sprite":"station.png"},{"text":"ach_governor","sprite":"governor.png"},{"text":"ach_gold_smith","sprite":"goldSmith.png"},{"text":"ach_contractor","sprite":"contractor.png"},{"text":"ach_commander","sprite":"commander.png"},{"text":"ach_gold_helmet","sprite":"goldHelmet.png"},{"text":"ach_gold_breastplate","sprite":"goldBreastplate.png"},{"text":"ach_gold_leggings","sprite":"goldLeggings.png"},{"text":"ach_gold_boots","sprite":"goldBoots.png"},{"text":"ach_gold_armor","sprite":"goldArmor.png"},{"text":"ach_gold_soldier","sprite":"goldSoldier.png"},{"text":"ach_rampart","sprite":"rampart.png"},{"text":"ach_fort","sprite":"fort.png"},{"text":"ach_keep","sprite":"keep.png"},{"text":"ach_horse_trainer","sprite":"horseTrainer.png"},{"text":"ach_lead","sprite":"lead.png"},{"text":"ach_stirrup","sprite":"stirrup.png"},{"text":"ach_saddle","sprite":"saddle.png"},{"text":"ach_horse_tamed","sprite":"tamedHorse.png"},{"text":"ach_war_horse_tamed","sprite":"warHorse.png"},{"text":"ach_hay","sprite":"hayBale.png"},{"text":"ach_horse_stable","sprite":"stable.png"},{"text":"ach_gold_knight","sprite":"goldKnight.png"},{"text":"ach_castle","sprite":"castle.png"},{"text":"ach_king","sprite":"king.png"},{"text":"ach_diamond_armor","sprite":"diamondArmor.png"},{"text":"ach_diamond_soldier","sprite":"diamondSoldier.png"},{"text":"ach_church","sprite":"church.png"},{"text":"ach_priest","sprite":"priest.png"},{"text":"ach_wizard","sprite":"wizard.png"},{"text":"ach_horse_feathers","sprite":"flyingHorse.png"},{"text":"ach_roost","sprite":"roost.png"},{"text":"ach_aviary","sprite":"aviary.png"},{"text":"ach_flying_war_horse","sprite":"flyingWarHorse.png"},{"text":"ach_flying_knight","sprite":"flyingKnight.png"},{"text":"ach_map","sprite":"map.png"},{"text":"ach_city_state","sprite":"cityState.png"},{"text":"ach_shipyard","sprite":"shipyard.png"},{"text":"ach_sail","sprite":"upperSail.png"},{"text":"ach_sail","sprite":"mainSail.png"},{"text":"ach_boat_shell","sprite":"shell.png"},{"text":"ach_mast","sprite":"mast.png"},{"text":"ach_boat","sprite":"hull.png"},{"text":"ach_barge","sprite":"barge.png"},{"text":"ach_ship","sprite":"ship.png"},{"text":"ach_port","sprite":"port.png"},{"text":"ach_line_bar","sprite":"lineBar.png"},{"text":"ach_spike_maul","sprite":"spikeMaul.png"},{"text":"ach_rail_worker","sprite":"railWorker.png"},{"text":"ach_bridge","sprite":"bridge.png"},{"text":"ach_scaffold_built","sprite":"scaffold.png"},{"text":"ach_scaffolding","sprite":"scaffolding.png"},{"text":"ach_rail","sprite":"rail.png"},{"text":"ach_rail_bridge","sprite":"railBridge.png"},{"text":"ach_flint_steel","sprite":"flintAndSteel.png"},{"text":"ach_iron_door","sprite":"ironDoor.png"},{"text":"ach_railway","sprite":"railway.png"},{"text":"ach_minecart","sprite":"minecart.png"},{"text":"ach_portal","sprite":"portal.png"},{"text":"ach_iron_trap","sprite":"ironTrap.png"},{"text":"ach_chinny","sprite":"pig.png"},{"text":"ach_pigman","sprite":"pigmanWorker.png"},{"text":"ach_nether","sprite":"netherrack.png"},{"text":"ach_porkified","sprite":"workerPork.png"},{"text":"ach_nether_brick","sprite":"netherBrick.png"},{"text":"ach_nether_block","sprite":"netherblock.png"},{"text":"ach_nether_section","sprite":"netherSection.png"},{"text":"ach_pigman_smelter","sprite":"pigmanSmelter.png"},{"text":"ach_porkified","sprite":"smelterPork.png"},{"text":"ach_pigman_mason","sprite":"pigmanMason.png"},{"text":"ach_pigman_builder","sprite":"pigmanBuilder.png"},{"text":"ach_nether_pillar","sprite":"netherPillar.png"},{"text":"ach_porkified","sprite":"masonPork.png"},{"text":"ach_porkified","sprite":"builderPork.png"},{"text":"ach_nether_fence","sprite":"netherFence.png"},{"text":"ach_nether_stairs","sprite":"netherStairs.png"},{"text":"ach_nether_staircase","sprite":"netherStaircase.png"},{"text":"ach_nether_well","sprite":"netherWell.png"},{"text":"ach_nether_bridge","sprite":"netherBridge.png"},{"text":"ach_nether_hallway","sprite":"netherHallway.png"},{"text":"ach_nether_balcony","sprite":"netherBalcony.png"},{"text":"ach_nether_slab","sprite":"netherSlab.png"},{"text":"ach_nether_rib","sprite":"netherRib.png"},{"text":"ach_nether_ski","sprite":"netherSki.png"},{"text":"ach_nether_sled","sprite":"netherSled.png"},{"text":"ach_nether_bridgeways","sprite":"netherBridgeways.png"},{"text":"ach_nether_stairwell","sprite":"netherStairwell.png"},{"text":"ach_nether_room","sprite":"netherRoom.png"},{"text":"ach_nether_well","sprite":"netherWellRoom.png"},{"text":"ach_fortress_exterior","sprite":"netherFortressExterior.png"},{"text":"ach_nether_stair_room","sprite":"netherStairRoom.png"},{"text":"ach_nether_wart_room","sprite":"netherWartRoom.png"},{"text":"ach_fortress_interior","sprite":"netherFortressInterior.png"}]}',
    t
}(), SaveAPI = function() {
    function i() {}
    return i.isCapable = function() {
        return !(void 0 === window.localStorage)
    }
    ,
    i.getAccess = function(e) {
        if (!this.isCapable())
            return null;
        try {
            return JSON.parse(localStorage.getItem(e))
        } catch (t) {
            return window.localStorage.getItem(e)
        }
    }
    ,
    i.setAccess = function(t, e) {
        if (!this.isCapable())
            return null;
        try {
            var i = window.localStorage.getItem(t);
            (i < e || null == i) && window.localStorage.setItem(t, JSON.stringify(e))
        } catch (t) {
            DOMException.QUOTA_EXCEEDED_ERR
        }
    }
    ,
    i.setForce = function(t, e) {
        if (!this.isCapable())
            return null;
        try {
            window.localStorage.setItem(t, JSON.stringify(e))
        } catch (t) {
            DOMException.QUOTA_EXCEEDED_ERR
        }
    }
    ,
    i.clear = function() {
        if (!this.isCapable())
            return null;
        window.localStorage.clear()
    }
    ,
    i.generateDefaultData = function(t) {
        var e = new GameSave;
        return e.countItem = [],
        i.addField(e, GameAPI.crafters.split(";"), t),
        i.addField(e, GameAPI.chasmMineCrafters.split(";"), t),
        e.grind = "wood,nothing,",
        e.level = "City State",
        e.achievementGrind = ",",
        Services.isDesktop() ? e.particleCount = 50 : e.particleCount = 0,
        e.soundCount = 50,
        e.musicCount = 50,
        e.mapVisible = !1,
        e.isMerge = !0,
        e.isOpenNextLevel = !1,
        e.isAutomated = !1,
        e.inventoryItem = [],
        e.achievement = [],
        e
    }
    ,
    i.initDebug = function() {
        (GameConfig.isCityStateLevelPassed || GameConfig.isChasmMineLevelPassed) && (i.SAVE_DATA = GameConfig.debugLevelKey)
    }
    ,
    i.addField = function(t, e, i) {
        for (var s = !1, n = 0; n < e.length; ++n) {
            s = !1;
            var r = new CountItem
              , o = e[n].split(":");
            r.name = o[2].split("=")[0],
            r.count = i,
            r.isAchievement = !1,
            r.ability = !1,
            t.countItem.forEach(function(t) {
                t.name != r.name || (s = !0)
            }, this),
            s || t.countItem.push(r)
        }
    }
    ,
    i.UNIQ_ID = "UniqId",
    i.SOUND = "isSoundOn",
    i.MUSIC = "isMusicOn",
    i.SAVE_DATA = "GrindcraftReData",
    i
}(), GameSave = function() {}, AchievementInfo = function() {}, CountItem = function() {}, Services = function() {
    function e() {}
    return e.init = function(t) {
        e.game = t
    }
    ,
    e.isDesktop = function() {
        return GameConfig.deviceMode == GameConfig.DEVICE_MODE_AUTO ? e.game.device.desktop : GameConfig.deviceMode != GameConfig.DEVICE_MODE_MOBILE
    }
    ,
    e.isMobile = function() {
        return GameConfig.deviceMode == GameConfig.DEVICE_MODE_AUTO ? !e.game.device.desktop : GameConfig.deviceMode != GameConfig.DEVICE_MODE_DESKTOP
    }
    ,
    e
}(), ScaleManager = function() {
    function r() {}
    return r.init = function(t) {
        r.game = t;
        var e = r.isMobile();
        r.dpr_enabled = e,
        r.orientation = GameConfig.deviceOrientation == GameConfig.DEVICE_ORIENTATION_AUTO ? r.ORIENTATION_LANDSCAPE : GameConfig.deviceOrientation,
        this.onResize = new Phaser.Signal,
        this.onOrientationChange = new Phaser.Signal,
        t.scale.scaleMode = Phaser.ScaleManager.USER_SCALE,
        window.onresize = function() {
            r.SizeCalculation(t)
        }
        ,
        r.SizeCalculation(t)
    }
    ,
    r.SizeCalculation = function(t) {
        r.dpr_enabled && (r.dpr = window.devicePixelRatio);
        var e, i, s = Math.min(window.innerWidth / r.GameWidth, window.innerHeight / r.GameHeight);
        if (document.getElementById("content").style.minHeight = window.innerHeight.toString() + "px",
        e = Math.ceil(window.innerWidth / s + 1),
        i = Math.ceil(window.innerHeight / s + 1),
        t.scale.setUserScale(s, s, 0, 0),
        t.scale.setGameSize(e, i),
        t.world.setBounds(0, 0, e, i),
        t.scale.refresh(),
        this.scale = s,
        GameConfig.deviceOrientation == GameConfig.DEVICE_ORIENTATION_AUTO) {
            var n = r.orientation;
            n != (r.orientation = t.width < t.height ? r.ORIENTATION_PORTRAIT : r.ORIENTATION_LANDSCAPE) && (n = r.orientation,
            this.onOrientationChange.dispatch())
        }
        this.onResize.dispatch()
    }
    ,
    r.bkgX = function() {
        return (r.GameWidth - r.MaxWidth) / 2
    }
    ,
    r.bkgY = function() {
        return (r.GameHeight - r.MaxHeight) / 2
    }
    ,
    r.by = function(t) {
        return r.GameWidth / 2 - (r.GameWidth / 2 - t)
    }
    ,
    r.handleIncorrect = function() {
        Services.isDesktop() || (document.getElementById("turn").style.display = "block",
        r.game.world.isPaused = !0)
    }
    ,
    r.handleCorrect = function() {
        Services.isDesktop() || (document.getElementById("turn").style.display = "none",
        r.game.world.isPaused = !1),
        setTimeout("window.scrollTo(0,0)", 1e3)
    }
    ,
    r.isMobile = function() {
        return GameConfig.deviceMode == GameConfig.DEVICE_MODE_AUTO ? !r.game.device.desktop : GameConfig.deviceMode != GameConfig.DEVICE_MODE_DESKTOP
    }
    ,
    r.GameWidth = 760,
    r.GameHeight = 610,
    r.MaxWidth = 1440,
    r.MaxHeight = 1457,
    r.ORIENTATION_PORTRAIT = 1,
    r.ORIENTATION_LANDSCAPE = 2,
    r.dpr_enabled = !1,
    r.dpr = 1,
    r
}(), Game = function(t) {
    function e() {
        var e = t.call(this, {
            enableDebug: !1,
            width: ScaleManager.GameWidth,
            height: ScaleManager.GameHeight,
            renderer: Phaser.AUTO,
            parent: "content",
            transparent: null,
            antialias: !0,
            preserveDrawingBuffer: !1,
            physicsConfig: null,
            seed: "",
            state: null,
            forceSetTimeOut: !1
        }) || this;
        return e.clearBeforeRender = !1,
        Phaser.Device.whenReady(function() {
            e.stage.disableVisibilityChange = !0;
            var t = e.device.desktop ? "click" : "touchstart";
            document.getElementById("content").addEventListener(t, function(t) {
                e.gameResumed(t)
            })
        }),
        h5branding.SplashLoader.getInstance({
            gameId: "ba9eba4f79f947c9a57921eb06d75cac",
            gameTitle: Constants.GOOGLE_APP_NAME,
            gameName: Constants.GOOGLE_APP_NAME,
            libs: [],
            version: version,
            barColor: ""
        }).create().then(function() {
            Fabrique.RayGun.getInstance(),
            e.state.add("game", {
                create: e.stateCreator.bind(e),
                preload: e.statePreloader.bind(e)
            }, !0)
        }),
        e
    }
    return __extends(e, t),
    e.prototype.statePreloader = function() {
        var e = this;
        libs.forEach(function(t) {
            e.load.script(t, t)
        })
    }
    ,
    e.prototype.stateCreator = function() {
        this.plugins.add(PhaserCachebuster.CacheBuster),
        this.plugins.add(PhaserSpine.SpinePlugin),
        this.plugins.add(PhaserSuperStorage.StoragePlugin),
        this.plugins.add(PhaserI18n.Plugin, {
            fallbackLng: "en",
            load: "languageOnly",
            backend: {
                loadPath: "assets/locales/locale_{{lng}}.json"
            }
        }),
        this.storage.forcePromises = !0,
        this.storage.forcePromises = !1,
        this.storage.setNamespace("grindcraft-remastered"),
        this.state.add(Boot.Name, Boot, !1),
        this.state.add(Gameplay.Name, Gameplay, !1),
        this.state.start(Boot.Name),
        this.state.remove("game")
    }
    ,
    e
}(Phaser.Game), GameAPI = function() {
    function t() {}
    return t.createText = function(t, e, i, s, n, r, o, a) {
        void 0 === o && (o = -1),
        void 0 === a && (a = !1);
        var h = new PhaserI18n.TranslatedBitmapText(t,e,i,s,n,r);
        return h.anchor.setTo(.5, .5),
        h.align = "center",
        -1 != o && (h.tint = o),
        a && (h.cacheAsBitmap = !0),
        h
    }
    ,
    t.addEvent = function(t, e, i, s, n, r, o, a) {
        void 0 === i && (i = null),
        void 0 === s && (s = null),
        void 0 === n && (n = null),
        void 0 === r && (r = null),
        void 0 === o && (o = null),
        void 0 === a && (a = null),
        t.inputEnabled = !0,
        null != i && t.events.onInputUp.add(i, e, 0, s),
        null != n && t.events.onInputOver.add(n, e, 0, r),
        null != o && t.events.onInputOut.add(o, e, 0, a)
    }
    ,
    t.setWidthTextBTM = function(t, e) {
        if (t.width < e)
            return t.text;
        var i = t.text.split(" ");
        t.text = "";
        for (var s = 0; s < i.length; ++s)
            t.text += i[s] + " ",
            t.width > e && (t.text = t.text.substr(0, t.text.length - (i[s].length + 1)),
            t.text += "\n",
            t.text += i[s] + " ");
        return t.text
    }
    ,
    t.getName = function(t) {
        t = t.replace(".png", "");
        for (var e = 0; e < t.length; ++e)
            t.charCodeAt(e) < 91 && 40 < t.charCodeAt(e) && (t = (t = t.replace(t[e], " " + t[e])).toLowerCase());
        return t
    }
    ,
    t.setString = function(t, e) {
        var i = "";
        i += t[0];
        t.length;
        for (var s = 1; s < t.length; ++s)
            i += t[s],
            s % e == 0 && (i += "\n");
        return i
    }
    ,
    t.grinders = "overworld:wood=29,grass=4,dirt=65,water=4:overworld.png;mine:stone=100,gravel=10,coal_ore=14,iron_ore=4,gold_ore=3,diamond ore=1,lava=5:mine.png;food:nothing=remainder,sugar_cane=2,wheat=2:food.png;mobs:nothing=remainder,chicken=1.75,cow=3,pig=1.75,sheep=1.75,horse=1.75,zombie=1.75,skeleton=1.75,witch=1.75,zombie_villager=1.75,spider=1.75,slime=0.5:mobs.png",
    t.grinds = "hand:hand.png:hand=1:none;wood:wood.png:wood=1:hand=3,wood_axe=1.5,stone_axe=0.75,woodsman=0.74,iron_axe=0.5,gold_axe=0.375,diamond_axe=0.1875:ach_tree_punched;grass:grass.png:seeds=1:wood_sword=0.5,stone_sword=0.4,woodsman=0.3,iron_sword=0.2,gold_sword=0.1,diamond_sword=0.05:ach_grass_mowed;seeds:seeds.png;dirt:dirt.png:dirt=1:wood_shovel=0.375,stone_shovel=0.1875,woodsman=0.1874,iron_shovel=0.125,gold_shovel=0.0938,diamond_shovel=0.06;soil:soil.png;water:water.png:water=1:bucket=0.125,woodsman=0.1875;lava:lava.png:lava=1:bucket=0.05,miner=0.05;gravel:gravel.png:flint=.1:wood_shovel=0.45,stone_shovel=0.225,miner=0.224,iron_shovel=0.15,gold_shovel=0.1125,diamond_shovel=0.08;flint:flint.png;stone:stone.png:cobblestone=1:wood_pick=1.125,stone_pick=0.5625,miner=0.5624,iron_pick=0.375,gold_pick=0.2813,diamond_pick=0.19:ach_stone_begot;cobblestone:cobblestone.png;coal_ore:coalOre.png:coal=1:wood_pick=2.25,stone_pick=1.125,miner=1.124,iron_pick=0.75,gold_pick=0.5625,diamond_pick=0.25:ach_coal_mine;coal:coal.png;iron_ore:ironOre.png:iron_ore=1:stone_pick=1.25,miner=1.24,iron_pick=1.125,gold_pick=0.75,diamond_pick=0.4;gold_ore:goldOre.png:gold_ore=1:iron_pick=1.25,miner=1.8,gold_pick=0.75,diamond_pick=0.5:ach_gold;diamond ore:diamondOre.png:diamond=1:gold_pick=0.75,miner=1.8,diamond_pick=0.5;diamond:diamond.png;zombie:zombie.png:nothing=0:wood_sword=2.5,stone_sword=2.49,hunter=2.48,iron_sword=2.08,gold_sword=1.79,diamond_sword=1;skeleton:skeleton.png:arrow=.5:wood_sword=2.2,stone_sword=2.19,hunter=2.18,iron_sword=1.83,gold_sword=1.57,diamond_sword=1;arrow:arrow.png;witch:witch.png:witch=1:trap=3;zombie_villager:zombieVillager.png:zombie_villager=1:trap=1.67;spider:spider.png:string=.5:wood_sword=1.8,stone_sword=1.79,hunter=1.78,iron_sword=1.5,gold_sword=1.29,diamond_sword=1;string:string.png;slime:slime.png:slime_ball=.5:wood_sword=1,stone_sword=0.99,hunter=0.98,butcher=0.97,iron_sword=0.83,gold_sword=0.714,diamond_sword=0.638;slime_ball:slimeBall.png;chicken:chicken.png:feather=.5:wood_sword=0.4,stone_sword=0.39,hunter=0.38,butcher=0.37,iron_sword=0.33,gold_sword=0.286,diamond_sword=0.26;feather:feather.png;cow:cow.png:leather=1:wood_sword=1,stone_sword=0.99,hunter=0.98,butcher=0.97,iron_sword=0.83,gold_sword=0.714,diamond_sword=0.638;leather:leather.png;pig:pig.png:nothing=0:wood_sword=1,stone_sword=0.99,hunter=0.98,butcher=0.97,iron_sword=0.83,gold_sword=0.714,diamond_sword=0.638;sheep:sheep.png:wool=.5:wood_sword=0.8,stone_sword=0.79,hunter=0.78,butcher=0.77,iron_sword=0.667,gold_sword=0.57,diamond_sword=0.5;wool:wool.png;horse:horse.png:horse=1:lead=1;sugar_cane:sugarCane.png:sugar_cane=1:wood_sword=0.38,stone_sword=0.36,gardener=0.34,iron_sword=0.3,gold_sword=0.25,diamond_sword=0.19;wheat:wheat.png:wheat=0.66,seeds=0.33:wood_sword=0.38,stone_sword=0.36,gardener=0.34,iron_sword=0.3,gold_sword=0.25,diamond_sword=0.19",
    t.crafters = "nothing=0:wood_axe,stone_axe,iron_axe,gold_axe,diamond_axe:wood=1:wood.png:wood:grind:nothing:nothing:wood_desc;stick=2,planks=3:crafting_table:wood_pick=1:woodPick.png:wood::ach_wooden_tool:nothing:wood_pick_desc;stick=2,planks=1:crafting_table:wood_shovel=1:woodShovel.png:wood::ach_wooden_tool:nothing:shovel_desc;stick=1,planks=2:crafting_table:wood_sword=1:woodSword.png:wood::ach_wooden_tool:nothing:sword_desc;stick=2,planks=3:crafting_table:wood_axe=1:woodAxe.png:wood::ach_wooden_tool:nothing:axe_desc;stick=2,planks=2:crafting_table:wood_hoe=1:woodHoe.png:wood::ach_wooden_tool:nothing:hoe_desc;nothing=0:wood_pick,stone_pick,iron_pick,gold_pick,diamond_pick:cobblestone=1:cobblestone.png:metal:grind:nothing:nothing:cobblestone_desc;stick=2,cobblestone=1:crafting_table:stone_shovel=1:stoneShovel.png:metal:stone:ach_stone_tool:nothing:shovel_desc;stick=1,cobblestone=2:crafting_table:stone_sword=1:stoneSword.png:metal:stone:ach_stone_tool:nothing:sword_desc;stick=2,cobblestone=3:crafting_table:stone_axe=1:stoneAxe.png:metal:stone:ach_stone_tool:nothing:axe_desc;stick=2,cobblestone=2:crafting_table:stone_hoe=1:stoneHoe.png:metal:stone:ach_stone_tool:nothing:stone_hoe_desc;stick=2,cobblestone=3:crafting_table:stone_pick=1:stonePick.png:metal:stone:ach_stone_tool:nothing:Mines iron_ore.;cobblestone=8:crafting_table:furnace=1:furnace.png:::ach_furnace:nothing:furnace_desc;iron_ingot=3:crafting_table:bucket=1:bucket.png:metal::ach_bucket:nothing:bucket_desc;nothing=0:wood_pick,stone_pick,iron_pick,gold_pick,diamond_pick:coal=1:coal.png:metal:grind:nothing:nothing:coal_desc;nothing=0:stone_pick,iron_pick,gold_pick,diamond_pick:iron_ore=1:ironOre.png:metal:grind:nothing:nothing:iron_ore_desc;coal=1,iron_ore=1:furnace:iron_ingot=1:ironIngot.png:metal:metal:ach_iron_smelted:nothing:iron_ingot_desc;nothing=0:wood_shovel,stone_shovel,iron_shovel,gold_shovel,diamond_shovel:dirt=1:dirt.png:dirt:grind:nothing:nothing:dirt_desc;dirt=1:wood_hoe,stone_hoe,iron_hoe,gold_hoe,diamond_hoe:soil=1:soil.png:dirt:farm:nothing:nothing:soil_desc;nothing=0:bucket:water=1:water.png:wood:grind:nothing:nothing:food_req_desc;soil=8,water=1:nothing:plot=1:plot.png:dirt:farm:nothing:nothing:plot_desc;nothing=0:wood_sword,stone_sword,iron_sword,gold_sword,diamond_sword:seeds=1:seeds.png:whoosh:grind:nothing:nothing:food_req_desc;plot=1,seeds=1:nothing:wheat_field=1:wheatField.png:dirt:farm:ach_garden_planted:increase wheat:villagers_req_desc;wood=1:nothing:planks=4:planks.png:wood:wood:nothing:nothing:wood_items_req_desc;planks=4:nothing:crafting_table=1:craftingTable.png:wood::ach_crafting_table:nothing:crafting_table_desc;planks=2:nothing:stick=4:stick.png:wood:wood:nothing:nothing:wood_items_req_desc;planks=4:crafting_table:door=1:door.png:wood:wood:nothing:nothing:door_desc;cobblestone=9:nothing:wall=1:wall.png:metal:stone:ach_wall_built:nothing:wall_desc;wall=5,door=1:nothing:hut=1:hut.png:metal:stone:ach_hut:nothing:hut_desc;hut=1,wheat_field=1:nothing:villager=1:villager.png:hand:villager:ach_villager:nothing:villager_desc;villager=1,stone_axe=1:nothing:woodsman=1:woodsman.png:hand:villager:ach_woodsman:automate overworld,increase wood,increase grass,increase water:woodsman_desc;villager=1,stone_pick=1:nothing:miner=1:miner.png:hand:villager:ach_miner:automate mine,increase coal ore,increase iron_ore,increase gold_ore,increase diamond ore:miner_desc;villager=1,stone_hoe=1:nothing:gardener=1:gardener.png:hand:villager:ach_gardener:automate food:gardener_desc;villager=1,stone_sword=1:nothing:hunter=1:hunter.png:hand:villager:ach_hunter:automate mobs,increase chicken,increase cow,increase sheep,increase horse,increase skeleton,increase witch,increase zombie_villager,increase spider,increase slime:hunter_desc;planks=4,stick=2:crafting_table:fence=3:fence.png:wood:wood:ach_fencing:nothing:pens_req_desc;fence=9:crafting_table:pen=1:pen.png:wood:wood:ach_pen:nothing:pen_desc;hunter=1,pen=1:nothing:butcher=1:butcher.png:hand:villager:ach_butcher:automate mobs,increase chicken,increase cow,increase sheep,increase horse:butcher_desc;planks=6:crafting_table:stairs=4:stairs.png:wood:wood:ach_stairs:nothing:roof_req_desc;stairs=3:nothing:rafter=1:rafter.png:wood:wood:ach_rafter:nothing:roof_req_desc;rafter=2:nothing:truss=1:truss.png:wood:wood:nothing:nothing:roof_req_desc;truss=4:nothing:roof=1:roof.png:wood:wood:ach_roof:nothing:village_building_req_desc;roof=1,hut=1:nothing:village_building=1:villageBuilding.png:::ach_village_building:nothing:village_building_req_desc;plot=1,sugar_cane=1:nothing:sugar_cane_field=1:sugarCaneField.png:dirt:farm:ach_sugar_caned:increase sugar_cane:sugar_cane_field_desc;nothing=0:wood_sword,stone_sword,iron_sword,gold_sword,diamond_sword:sugar_cane=1:sugarCane.png:whoosh:grind:nothing:nothing:sugar_cane_desc;sugar_cane=3:crafting_table:paper=3:paper.png:whoosh::ach_paper_pulped:nothing:paper_desc;paper=3,leather=1:crafting_table:book=1:book.png:whoosh::ach_book:nothing:bookcases_req_desc;planks=6,book=3:crafting_table:bookshelf=1:bookshelf.png:wood::ach_bookshelf:nothing:bookcases_req_desc;bookshelf=4:nothing:bookcase=1:bookcase.png:wood::nothing:nothing:bookcase_desc;village_building=2,bookcase=2:nothing:library=1:library.png:metal::nothing:nothing:library_desc;villager=1,crafting_table=1:library:crafter=1:crafter.png:hand:villager:ach_crafter:nothing:villager_desc;crafter=1,stone_pick=1:nothing:mason=1:mason.png:hand:villager:ach_mason:nothing:mason_desc;nothing=0:bucket:lava=1:lava.png:wood:grind:nothing:nothing:lava_desc;cobblestone=12,lava=4:mason:lava_pool=1:lavaPool.png:::ach_lava_pool:nothing:lava_pool_desc;village_building=2,lava_pool=1,furnace=1:nothing:forge=1:forge.png:metal::ach_forge:nothing:blacksmiths_req_desc;crafter=1:forge:smelter=1:smelter.png:metal:villager:ach_smelter:autocraft iron_ingot=.5,autocraft gold_ingot:smelter_desc;stick=2,iron_ingot=3:crafting_table:pitch_fork=1:pitchFork.png:metal:metal:ach_iron_crafter:nothing:pitch_fork_desc;crafter=1,pitch_fork=1:nothing:farmer=1:farmer.png:hand:villager:ach_farmer:nothing:farmer_desc;stick=1,iron_ingot=3:crafting_table:saw=1:saw.png:metal:metal:ach_saw:nothing:saw_desc;crafter=1,saw=1:nothing:carpenter=1:carpenter.png:hand:villager:ach_carpenter:nothing:carpenter_desc;stairs=2:nothing:desk=1:desk.png:wood:wood:nothing:nothing:desk_desc;village_building=2,desk=1,crafter=1:nothing:mayor=1:mayor.png:hand:villager:ach_mayor:nothing:mayor_desc;woodsman=1:mayor:villager=1:woodsmanDemote.png:hand::nothing:deautomate overworld:fire_woodsman_desc;miner=1:mayor:villager=1:minerDemote.png:hand::nothing:deautomate mine:fire_butcher_desc;gardener=1:mayor:villager=1:gardenerDemote.png:hand::nothing:deautomate food:fire_gardener_desc;hunter=1:mayor:villager=1:hunterDemote.png:hand::nothing:deautomate mobs:fire_hunter_desc;butcher=1:mayor:villager=1:butcherDemote.png:hand::nothing:deautomate mobs:fire_miner_desc;dirt=8,water=1,seeds=1:farmer:wheat_field=1:weatm.png:whoosh::ach_garden_planted:nothing:villagers_req_desc;cobblestone=45,wood=1:mason:hut=1:hut.m.png:metal::ach_hut:nothing:villagers_req_desc;stick=2,iron_ingot=3:crafting_table:iron_pick=1:ironPick.png:metal:metal:ach_iron_tool:nothing:iron_pick_desc;stick=2,iron_ingot=1:crafting_table:iron_shovel=1:ironShovel.png:metal:metal:ach_iron_tool:nothing:shovel_desc;stick=2,iron_ingot=3:crafting_table:iron_axe=1:ironAxe.png:metal:metal:ach_iron_tool:nothing:axe_desc;stick=2,iron_ingot=2:crafting_table:iron_hoe=1:ironHoe.png:metal:metal:ach_iron_tool:nothing:hoe_desc;stick=1,iron_ingot=2:crafting_table:iron_sword=1:ironSword.png:metal:metal:ach_iron_tool:nothing:sword_desc;wood=1:carpenter:stick=8:stickm.png:wood:wood:nothing:nothing:wood_items_req_desc;hut=1,wheat_field=1,leather=1:mayor:leather_worker=1:leatherWorker.png:hand:villager:ach_leather_worker:nothing:leather_worker_desc;nothing=0:wood_sword,stone_sword,iron_sword,gold_sword,diamond_sword:leather=1:leather.png:metal:grind:nothing:nothing:leather_desc;leather=5:leather_worker:leather_helmet=1:leatherHelmet.png:whoosh:metal:ach_leather_helmet:nothing:leather_soldier_req_desc;leather=8:leather_worker:leather_breastplate=1:leatherBreastplate.png:whoosh:metal:ach_leather_breastplate:nothing:leather_soldier_req_desc;leather=7:leather_worker:leather_leggings=1:leatherLeggings.png:whoosh:metal:ach_leather_leggings:nothing:leather_soldier_req_desc;leather=4:leather_worker:leather_boots=1:leatherBoots.png:whoosh:metal:ach_leather_boots:nothing:leather_soldier_req_desc;leather_helmet=1,leather_breastplate=1,leather_leggings=1,leather_boots=1:nothing:leather_armor=1:leatherArmor.png:whoosh::ach_leather_armor:nothing:leather_soldier_req_desc;hut=1,wheat_field=1,iron_sword=1:mayor:sergeant=1:sergeant.png:hand:villager:ach_sergeant:nothing:sergeant_desc;hut=1,wheat_field=1:sergeant:soldier=1:soldier.png:hand:villager:ach_soldier_up:nothing:soldier_desc;leather_armor=1,soldier=1:nothing:leather_soldier=1:leatherSoldier.png:hand:villager:ach_leather_soldier:nothing:leather_soldier_desc;hut=2,leather_soldier=8:mason:barracks=1:barracks.png:metal::ach_barracks:nothing:outpost_req_desc;iron_ingot=9:crafting_table:iron_block=1:ironBlock.png:metal:metal:ach_iron_block:nothing:iron_block_desc;iron_block=3,iron_ingot=3:crafting_table:anvil=1:anvil.png:metal:metal:ach_anvil:nothing:blacksmiths_req_desc;hut=1,wheat_field=1,anvil=1:mayor:blacksmith=1:blacksmith.png:hand:villager:ach_blacksmith:nothing:blacksmith_desc;iron_ingot=5:blacksmith:iron_helmet=1:ironHelmet.png:metal:metal:ach_iron_helmet:nothing:iron_soldier_desc;iron_ingot=8:blacksmith:iron_breastplate=1:ironBreastplate.png:metal:metal:ach_iron_breastplate:nothing:iron_soldier_desc;iron_ingot=7:blacksmith:iron_leggings=1:ironLeggings.png:metal:metal:ach_iron_leggings:nothing:iron_soldier_desc;iron_ingot=4:blacksmith:iron_boots=1:ironBoots.png:metal:metal:ach_iron_boots:nothing:iron_soldier_desc;iron_helmet=1,iron_breastplate=1,iron_leggings=1,iron_boots=1:nothing:iron_armor=1:ironArmor.png:metal:metal:ach_iron_armor:nothing:iron_soldier_desc;iron_armor=1,soldier=1:nothing:iron_soldier=1:ironSoldier.png:metal:villager:ach_iron_man:nothing:fire_team_part_desc;hut=1,wheat_field=1,arrow=1:mayor:fletcher=1:fletcher.png:hand:villager:ach_fletcher_trained:nothing:fletcher_desc;nothing=0:wood_sword,stone_sword,iron_sword,gold_sword,diamond_sword:wool=1:wool.png:whoosh:grind:nothing:nothing:wool_desc;wool=1:nothing:string=4:string.png:whoosh::nothing:nothing:string_desc;stick=3,string=3:fletcher:bow=1:bow.png:wood::ach_bow_crafted:nothing:bow_desc;nothing=0:wood_sword,stone_sword,iron_sword,gold_sword,diamond_sword:feather=1:feather.png:whoosh:grind:nothing:nothing:feather_desc;nothing=0:wood_shovel,stone_shovel,iron_shovel,gold_shovel,diamond_shovel:flint=1:flint.png:dirt:grind:nothing:nothing:flint_desc;flint=1,stick=1,feather=1:fletcher:arrow=4:arrow.png:whoosh::ach_arrows_crafted:nothing:arrow_desc;leather_soldier=1,bow=1,arrow=8:nothing:archer=1:archer.png:hand:villager:ach_arrows_crafted:nothing:fire_team_part_desc;iron_soldier=2,archer=2:nothing:fire_team=1:fireTeam.png:metal:villager:ach_fire_team:nothing:fire_team_desc;stick=7:crafting_table:ladder=3:ladder.png:wood:wood:ach_ladders:nothing:ladder_desc;hut=2,ladder=6:mason:tower=1:tower.png:metal::ach_tower:nothing:tower_desc;tower=1,fire_team=1:mason:scout_tower=1:scoutTower.png:metal::ach_scout_tower:nothing:outpost_req_desc;barracks=1,scout_tower=2:mason:outpost=1:outpost.png:metal::ach_outpost:nothing:outpost_desc;nothing=0:outpost:outpost_exporter=1:outpost.png:::nothing:navigateToUrl 135Fmh:Download.;outpost=2:mason:station=1:station.png:metal::ach_station:nothing:station_desc;hut=1,wheat_field=1:station:governor=1:governor.png:hand:villager:ach_governor:nothing:governor_desc;nothing=0:iron_pick,gold_pick,diamond_pick:gold_ore=1:goldOre.png:metal:grind:nothing:nothing:gold_ore_desc;coal=1,gold_ore=1:furnace:gold_ingot=1:goldIngot.png:metal:metal:ach_gold_ingot:nothing:gold_ingot_desc;stick=2,gold_ingot=3:crafting_table:gold_pick=1:goldPick.png:metal:metal:ach_golden_tool:nothing:gold_pick_desc;stick=2,gold_ingot=1:crafting_table:gold_shovel=1:goldShovel.png:metal:metal:ach_golden_tool:nothing:shovel_desc;stick=1,gold_ingot=2:crafting_table:gold_sword=1:goldSword.png:metal:metal:ach_golden_tool:nothing:sword_desc;stick=2,gold_ingot=3:crafting_table:gold_axe=1:goldAxe.png:metal:metal:ach_golden_tool:nothing:axe_desc;stick=2,gold_ingot=2:crafting_table:gold_hoe=1:goldHoe.png:metal:metal:ach_golden_tool:nothing:hoe_desc;cobblestone=45,wood=1,dirt=8,water=1,seeds=1:governor:gold_smith=1:goldSmith.png:hand:villager:ach_gold_smith:autocraft gold_ingot=.33:gold_smith_desc;cobblestone=45,wood=1,dirt=8,water=1,seeds=1:governor:contractor=1:contractor.png:hand:villager:ach_contractor:nothing:contractor_desc;cobblestone=45,wood=1,dirt=8,water=1,seeds=1:governor:commander=1:commander.png:hand:villager:ach_commander:nothing:commander_desc;cobblestone=180,wood=4,dirt=32,water=4,seeds=4:contractor:villager=4:villagerm.png:hand:villager:ach_villager:nothing:villager_desc;villager=4,wood=1,gold_ingot=8:commander:soldier=4:soldier.png:hand:villager:ach_soldier_up:nothing:gold_soldier_to_be;gold_ingot=5:gold_smith:gold_helmet=1:goldHelmet.png:metal::ach_gold_helmet:nothing:gold_soldiers_req_desc;gold_ingot=8:gold_smith:gold_breastplate=1:goldBreastplate.png:metal::ach_gold_breastplate:nothing:gold_soldiers_req_desc;gold_ingot=7:gold_smith:gold_leggings=1:goldLeggings.png:metal::ach_gold_leggings:nothing:gold_soldiers_req_desc;gold_ingot=4:gold_smith:gold_boots=1:goldBoots.png:metal::ach_gold_boots:nothing:gold_soldiers_req_desc;gold_helmet=1,gold_breastplate=1,gold_leggings=1,gold_boots=1:nothing:gold_armor=1:goldArmor.png:metal::ach_gold_armor:nothing:gold_soldiers_req_desc;gold_armor=1,soldier=1:nothing:gold_soldier=1:goldSoldier.png:hand:villager:ach_gold_soldier:nothing:knights_req_desc;cobblestone=25,gold_soldier=1:contractor:outer_wall=1:outerWall.png:::nothing:nothing:outer_wall_desc;outer_wall=3:contractor:rampart=1:rampart.png:::ach_rampart:nothing:rampart_desc;station=1,rampart=4:contractor:fort=1:fort.png:::ach_fort:nothing:fort_desc;nothing=0:fort:fort_exporter=1:fort.png:::nothing:navigateToUrl 135FhH:Download.;nothing=0:wood_sword,stone_sword,iron_sword,gold_sword,diamond_sword:wheat=1:wheat.png:whoosh:grind:nothing:nothing:wheat_desc;wheat=9:nothing:hay_bale=1:hayBale.png:whoosh::ach_hay:nothing:hay_bale_desc;wood=2:carpenter:fence=3:fencem.png:wood:wood:ach_fencing:nothing:pens_req_desc;fence=9:carpenter:pen=1:penm.png:wood:wood:ach_pen:nothing:stall_req_desc;wood=3:carpenter:truss=1:trussm.png:wood:wood:nothing:nothing:stall_req_desc;truss=4:nothing:roof=1:roof.png:wood::ach_roof:nothing:stall_req_desc;pen=1,roof=1,hay_bale=1:carpenter:stall=1:stall.png:wood::nothing:nothing:stall_desc;stall=4:carpenter:stable=1:stable.png:wood::ach_horse_stable:nothing:stable_desc;cobblestone=45,wood=1,dirt=8,water=1,seeds=1:governor:horse_trainer=1:horseTrainer.png:hand:villager:ach_horse_trainer:nothing:horse_trainer_desc;nothing=0:wood_sword,stone_sword,iron_sword,gold_sword,diamond_sword:slime_ball=1:slimeBall.png:hand:grind:nothing:nothing:lead_req_desc;string=4,slime_ball=1:horse_trainer:lead=2:lead.png:whoosh::ach_lead:nothing:lead_desc;iron_ingot=1,string=1:blacksmith:stirrup=1:stirrup.png:metal::ach_stirrup:nothing:stirrup_desc;stirrup=2,leather=3:leather_worker:saddle=1:saddle.png:whoosh::ach_saddle:nothing:saddle_desc;nothing=0:lead:horse=1:horse.png:hand:grind:nothing:nothing:horse_desc;horse=1,saddle=1:horse_trainer:tamed_horse=1:tamedHorse.png:::ach_horse_tamed:nothing:tamed_horse_desc;gold_ingot=9:crafting_table,gold_smith:gold_block=1:goldBlock.png:metal::ach_gold_block:nothing:gold_block_desc;tamed_horse=1,gold_block=4:gold_smith:war_horse=1:warHorse.png:::ach_war_horse_tamed:nothing:knights_req_desc;gold_soldier=1,war_horse=1:stable:gold_knight=1:goldKnight.png:hand:villager:ach_gold_knight:nothing:castle_req_desc;cobblestone=45,wood=1,roof=1:contractor:village_building=1:villageBuildingm.png:wood::ach_village_building:nothing:keep_req_desc;village_building=4:contractor:keep=1:keep.png:::ach_keep:nothing:castle_req_desc;fort=1,keep=1,gold_knight=4:contractor:castle=1:castle.png:::ach_castle:nothing:aviary_req_desc;nothing=0:castle:castle_exporter=1:castle.png:::nothing:navigateToUrl 135FIn:Download.;wood=1:carpenter:pressure_plate=1:pressurePlate.png:wood::ach_pressure_plate:nothing:trap_req_desc;sugar_cane=1:crafting_table:sugar=1:sugar.png:whoosh::ach_sugar_refined:nothing:trap_req_desc;wood=4,pressure_plate=1,sugar=1:carpenter:trap=1:trap.png:wood::ach_trap_built:nothing:trap_desc;cobblestone=90,wood=4:contractor:tower=1 :tower.png:metal::ach_tower:nothing:church_req_desc;village_building=2,tower=1,roof=1:contractor:church=1:church.png:metal::ach_church:nothing:church_desc;villager=1,book=1:church:priest=1:priest.png:hand:villager:ach_priest:nothing:priest_desc;nothing=0:trap:zombie_villager=1:zombieVillager.png:wood:grind:nothing:nothing:zombie_villager_desc;zombie_villager=1:priest:villager=1:villagermp.png:hand:villager:ach_zombie_villager:nothing:villager_desc;nothing=0:gold_pick,diamond_pick:diamond=1:diamond.png:metal:grind:nothing:nothing:diamond_desc;wood=2:carpenter:stick=16:stickm.png:wood:wood:nothing:nothing:wood_items_req_desc;stick=2,diamond=1:crafting_table:diamond_scepter=1:diamondScepter.png:metal:metal:ach_scepter:nothing:diamond_scepter_desc;villager=1,diamond_scepter=1:castle:king=1:king.png:hand:villager:ach_king:nothing:city_state_req_desc;villager=1,diamond=1:king:diamond_smith=1:diamondSmith.png:hand:villager:nothing:nothing:diamond_smith_desc;stick=2,diamond=3:crafting_table:diamond_pick=1:diamondPick.png:metal:metal:ach_diamond_tool:nothing:diamond_pick_desc;stick=2,diamond=1:crafting_table:diamond_shovel=1:diamondShovel.png:metal:metal:ach_diamond_tool:nothing:shovel_desc;stick=1,diamond=2:crafting_table:diamond_sword=1:diamondSword.png:metal:metal:ach_diamond_tool:nothing:sword_desc;stick=2,diamond=3:crafting_table:diamond_axe=1:diamondAxe.png:metal:metal:ach_diamond_tool:nothing:axe_desc;stick=2,diamond=2:crafting_table:diamond_hoe=1:diamondHoe.png:metal:metal:ach_diamond_tool:nothing:hoe_desc;diamond=24:diamond_smith:diamond_armor=1:diamondArmor.png:metal::ach_diamond_armor:nothing:diamond_armor_desc;diamond_armor=1,villager=1:king:diamond_soldier=1:diamondSoldier.png:metal:villager:ach_diamond_soldier:nothing:flying_knights_req_desc;hay_bale=8:nothing:nest=1:nest.png:::nothing:nothing:aviary_req_desc;tower=1,nest=1:castle:roost=1:roost.png:::ach_roost:nothing:aviary_req_desc;roost=4:castle:aviary=1:aviary.png:::ach_aviary:nothing:flying_knights_req_desc;nothing=0:trap:witch=1:witch.png:wood:grind:nothing:nothing:witch_desc;witch=1:nothing:redstone=1:redstone.png:hand::ach_ding_dong:nothing:redstone_desc;witch=1:priest:wizard=1:wizard.png:hand:villager:ach_wizard:nothing:wizard_desc;horse=1,feather=6:wizard:flying_horse=1:flyingHorse.png:::ach_horse_feathers:nothing:flying_horse_desc;flying_horse=1,saddle=1:aviary:tamed flying_horse=1:tamedFlyingHorse.png:::nothing:nothing:flying_knights_req_desc;diamond=9:crafting_table:diamond_block=1:diamondBlock.png:metal::ach_diamond_block:nothing:diamond_block_desc;tamed flying_horse=1,diamond_block=4:diamond_smith:flying_war_horse=1:flyingWarHorse.png:::ach_flying_war_horse:nothing:flying_knights_req_desc;diamond_soldier=1,flying_war_horse=1:nothing:flying_knight=1:flyingKnight.png:hand:villager:ach_flying_knight:nothing:city_state_req_desc;flying_knight=4:castle:city_state=1:cityState.png:::ach_city_state:nothing:shipyard_req_desc;nothing=0:city_state:city_state_exporter=1:cityState.png:::nothing:navigateToUrl 135FZo:Download.;redstone=1,iron_ingot=4:crafting_table:compass=1:compass.png:metal::ach_compass_crafted:nothing:compass_desc;sugar_cane=4:crafting_table:paper=4:paper.png:whoosh::ach_paper_pulped:nothing:map_req_desc;compass=1,paper=32:crafting_table:map=1:map.png:whoosh::ach_map:mapActive:map_desc;dirt=216:nothing:fill_dirt=1:fillDirt.png:whoosh::ach_fill_dirt:nothing:fill_dirt_desc;fill_dirt=4:nothing:sea_wall=1:seaWall.png:whoosh::ach_sea_wall:nothing:warf_req_desc;wood=1:carpenter:wood_slab=6:woodSlab.png:wood:wood:nothing:nothing:wood_slab_desc;wood_slab=9:nothing:deck=1:deck.png:wood:wood:ach_deck:nothing:deck_desc;wood=4:carpenter:fence=6:fencem.png:wood:wood:ach_fencing:nothing:pens_req_desc;deck=1,fence=4:nothing:raised_deck=1:raisedDeck.png:wood:wood:nothing:nothing:warf_req_desc;sea_wall=1,raised_deck=3:nothing:warf=1:warf.png:wood:wood:ach_warf:nothing:dock_req_desc;fence=3:nothing:post=1:post.png:wood:wood:nothing:nothing:post_desc;deck=1,post=4:nothing:platform=1:platform.png:wood:wood:nothing:nothing:platform_desc;platform=3:nothing:pier=1:pier.png:wood:wood:ach_pier:nothing:dock_req_desc;warf=1,pier=1:nothing:dock=1:dock.png:wood:wood:ach_dock:nothing:shipyard_req_desc;dock=3,village_building=2:city_state:shipyard=1:shipyard.png:wood:wood:ach_shipyard:nothing:shipyard_desc;wood=6:shipyard:stairs=16:stairsm.png:wood:wood:ach_stairs:nothing:roof_req_desc;stairs=6:shipyard:rib=1:rib.png:wood:wood:nothing:nothing:rib_desc;wood=4:shipyard:beam=1:beam.png:wood:wood:nothing:nothing:beam_desc;rib=6,beam=1:shipyard:shell=1:shell.png:wood:wood:ach_boat_shell:nothing:hull_req_desc;shell=1,stairs=5:shipyard:ship_bow=1:shipBow.png:wood:wood:nothing:nothing:hull_req_desc;shell=1,stairs=4,planks=1:shipyard:stern=1:stern.png:wood:wood:nothing:nothing:hull_req_desc;ship_bow=1,stern=1:shipyard:hull=1:hull.png:wood:wood:ach_boat:nothing:barge_req_desc;wood=1:shipyard:planks=4:planksm.png:wood:wood:nothing:nothing:wood_items_req_desc;planks=24,deck=1:shipyard:forecastle=1:forecastle.png:wood:wood:nothing:nothing:deckhouse_req_desc;wood=3:shipyard:cabin_truss=1:truss.png:wood:wood:nothing:nothing:cabin_req_desc;cabin_truss=6:shipyard:cabin_roof=1:roof.png:wood::ach_roof:nothing:cabin_req_desc;wood=1:shipyard:cabin_door=1:door.png:wood:wood:nothing:nothing:cabin_req_desc;planks=45,cabin_roof=1,cabin_door=1:shipyard:cabin=1:cabin.png:wood:wood:nothing:nothing:deckhouse_req_desc;forecastle=1,cabin=1,deck=1:shipyard:deckhouse=1:deckhouse.png:wood:wood:nothing:nothing:barge_req_desc;hull=1,deckhouse=1:shipyard:barge=1:barge.png:wood:wood:ach_barge:nothing:ship_req_desc;wool=6,beam=1:shipyard:upper_sail=1:upperSail.png:wood:wood:ach_sail:nothing:mast_req_desc;wool=28,beam=2:shipyard:main_sail=1:mainSail.png:wood:wood:ach_sail:nothing:mast_req_desc;beam=4,upper_sail=1,main_sail=1:shipyard:mast=1:mast.png:wood:wood:ach_mast:nothing:ship_req_desc;planks=12,deck=1:shipyard:lookout=1:lookout.png:wood:wood:nothing:nothing:ship_req_desc;barge=1,mast=1,lookout=1:shipyard:ship=1:ship.png:wood:wood:ach_ship:nothing:ship_desc;ship=3:shipyard,map:port=1:port.png:wood:wood:ach_port:markMap Chasm Mine-441-537,beatLocation:port_desc;nothing=0:port:port_exporter=1:port.png:::nothing:navigateToUrl 1ABDd8:Download.",
    t.chasmMineGrinders = "overworld:wood=29,dirt=65:overworld.png;mine:stone=50,gravel=5,coal_ore=14,iron_ore=4,diamond ore=1,obsidian=2,lava=5,spider=1.75,slime=0.5:mine.png;nether_mobs:nothing=remainder,zombie_pigman=3,blaze=1,ghast=1.75:netherMobs.png;nether:nothing=remainder,netherrack=50:nether.png",
    t.chasmMineGrinds = "hand:hand.png:hand=1:none;wood:wood.png:wood=1:hand=3,woodsman=0.74,iron_axe=0.5,gold_axe=0.375,diamond_axe=0.1875:ach_tree_punched;grass:grass.png:seeds=1:woodsman=0.3,iron_sword=0.2,gold_sword=0.1,diamond_sword=0.05:ach_grass_mowed;seeds:seeds.png;dirt:dirt.png:dirt=1:woodsman=0.1874,iron_shovel=0.125,gold_shovel=0.0938,diamond_shovel=0.06;water:water.png:water=1:bucket=0.125,woodsman=0.1875;lava:lava.png:lava=1:minecart=0.05 ;gravel:gravel.png:flint=.1:miner=0.224,iron_shovel=0.15,gold_shovel=0.1125,diamond_shovel=0.08;flint:flint.png;stone:stone.png:cobblestone=1:miner=0.5624,iron_pick=0.375,gold_pick=0.2813,diamond_pick=0.19:ach_stone_begot;cobblestone:cobblestone.png;coal_ore:coalOre.png:coal=1:scaffolding=0.75:;coal:coal.png;iron_ore:ironOre.png:iron_ore=1:scaffolding=1.125:;gold_ore:goldOre.png:gold_ore=1:iron_pick=1.25,miner=1.8,gold_pick=0.75,diamond_pick=0.5:ach_gold;diamond ore:diamondOre.png:diamond=1:minecart=1.8 ;diamond:diamond.png;obsidian:obsidian.png:obsidian=1:minecart=5 ;zombie:zombie.png:nothing=0:hunter=2.48,iron_sword=2.08,gold_sword=1.79,diamond_sword=1;skeleton:skeleton.png:arrow=.5:hunter=2.18,iron_sword=1.83,gold_sword=1.57,diamond_sword=1;arrow:arrow.png;witch:witch.png:witch=1:trap=3;zombie_villager:zombieVillager.png:zombie_villager=1:trap=1.67;spider:spider.png:string=.5:hunter=1.78,iron_sword=1.5,gold_sword=1.29,diamond_sword=1;string:string.png;slime:slime.png:slime_ball=.5:hunter=0.98,iron_sword=0.83,gold_sword=0.714,diamond_sword=0.638;slime_ball:slimeBall.png;chicken:chicken.png:feather=.5:hunter=0.38,iron_sword=0.33,gold_sword=0.286,diamond_sword=0.26;feather:feather.png;cow:cow.png:leather=1:hunter=0.98,iron_sword=0.83,gold_sword=0.714,diamond_sword=0.638;leather:leather.png;pig:pig.png:nothing=0:hunter=0.98,iron_sword=0.83,gold_sword=0.714,diamond_sword=0.638;sheep:sheep.png:wool=.5:hunter=0.78,iron_sword=0.667,gold_sword=0.57,diamond_sword=0.5;wool:wool.png;horse:horse.png:horse=1:lead=1;sugar_cane:sugarCane.png:sugar_cane=1:gardener=0.34,iron_sword=0.3,gold_sword=0.25,diamond_sword=0.19;wheat:wheat.png:wheat=.66,seeds=.33:gardener=0.34,iron_sword=0.3,gold_sword=0.25,diamond_sword=0.19;netherrack:netherrack.png:netherrack=10:pigman_worker=0.5624:ach_nether;zombie_pigman:zombiePigman.png:zombie_pigman=1:iron_trap=2.49;blaze:blaze.png:blaze_rod=.5:nether_fortress=5;blaze_rod:blazeRod.png;ghast:ghast.png:ghast=1:ghast_trap=4.5;spider:spider.png:string=.5:hunter=1.78,iron_sword=1.5,gold_sword=1.29,diamond_sword=1;string:string.png;slime:slime.png:slime_ball=.5:hunter=0.98,iron_sword=0.83,gold_sword=0.714,diamond_sword=0.638;slime_ball:slimeBall.png;witherSkeleton:witherSkeleton.png:coal=.5,bone=.67:hunter=5,iron_sword=4.25,gold_sword=3.67,diamond_sword=3;",
    t.chasmMineCrafters = "wood=1:carpenter:wood_slab=6:woodSlab.png:wood:wood:nothing:nothing:wood_slab_desc;wood_slab=9:carpenter:deck=1:deck.png:wood:wood:nothing:nothing:scaffold_req_desc;wood=6:carpenter:fence=9:fence.png:wood:wood:nothing:nothing:pens_req_desc;fence=3:carpenter:post=1:post.png:wood:wood:nothing:nothing:post_desc;deck=1,post=4:carpenter:platform=1:platform.png:wood:wood:nothing:nothing:scaffold_req_desc;wood=1:carpenter:ladder=3:ladder.png:wood:wood:nothing:nothing:scaffold_req_desc;platform=1,deck=1,wood=1,ladder=5:carpenter:scaffold=1:scaffold.png:wood:wood:ach_scaffold_built:nothing:scaffolding_req_desc;deck=1,fence=6:carpenter:bridge=1:bridge.png:wood:wood:ach_bridge:nothing:scaffolding_req_desc;scaffold=6,bridge=1:nothing:scaffolding=1:scaffolding.png:wood:wood:ach_scaffolding:nothing:scaffolding_desc;cobblestone=8:crafting_table:furnace=1:furnace.png:::ach_furnace:nothing:furnace_desc;nothing=0:iron_pick,gold_pick,diamond_pick:coal=1:coal.png:metal:grind:nothing:nothing:coal_desc;nothing=0:iron_pick,gold_pick,diamond_pick:iron_ore=1:ironOre.png:metal:grind:nothing:nothing:iron_ore_desc;coal=1,iron_ore=1:furnace:iron_ingot=1:ironIngot.png:metal:metal:ach_iron_smelted:nothing:iron_ingot_desc;wood=1,iron_ingot=6:crafting_table:rail=16:rail.png:metal::ach_rail:nothing:rail_bridge_req_desc;stick=3,iron_ingot=2:crafting_table:spike_maul=1:spikeMaul.png:metal::ach_spike_maul:nothing:rail_worker_req_desc;iron_ingot=3:crafting_table:line_bar=1:lineBar.png:metal::ach_line_bar:nothing:rail_worker_req_desc;nothing=0:nothing:contractor=1:contractor.png:hand:villager:ach_contractor:nothing:contractor_desc;contractor=1,spike_maul=1,line_bar=1:nothing:rail_worker=1:railWorker.png:hand::ach_rail_worker:nothing:rail_bridge_req_desc;platform=1,rail=3:rail_worker:rail_bridge=1:railBridge.png:metal::ach_rail_bridge:nothing:rail_bridge_desc;rail_bridge=24:rail_worker:railway=1:railway.png:metal::ach_railway:nothing:cave_depths_req_desc;nothing=0:railway:railway_exporter=1:railway.png:::nothing:navigateToUrl 1ENHZc:Download.;iron_ingot=5:railway:minecart=1:minecart.png:metal::ach_minecart:nothing:cave_depths_req_desc;nothing=0:minecart:obsidian=1:obsidian.png:metal:grind:ach_obsidian:nothing:portal_req_desc;iron_ingot=1,flint=1:crafting_table:flint_and_steel=1:flintAndSteel.png:metal::ach_flint_steel:nothing:portal_req_desc;obsidian=25:flint_and_steel:portal=1:portal.png:metal::ach_portal:showGrinder nether:portal_desc;wood=1:carpenter:pressure_plate=1:pressurePlate.png:wood::nothing:nothing:trap_req_desc;iron_ingot=6:crafting_table:iron_door=1:ironDoor.png:metal::ach_iron_door:nothing:trap_req_desc;iron_door=4,pressure_plate=1:portal:iron_trap=1:ironTrap.png:metal::ach_iron_trap:automate nether_mobs:iron_trap_desc;nothing=0:portal:zombie_pigman=1:zombiePigman.png:hand:grind:ach_zombie_pigman_trapped:nothing:zombie_pigmen_req_desc;nothing=0:nothing:priest=1:priest.png:hand:villager:nothing:autocraft pigman=1:zombie_pigmen_req_desc;zombie_pigman=1:priest:pigman=1:pig.png:::ach_chinny:nothing:pigman_desc;pigman=1:nothing:pigman_worker=1:pigmanWorker.png:hand::ach_pigman:automate nether:pigman_worker_desc;pigman_worker=1:spike_maul:worker_pork=1:workerPork.png:hand::ach_porkified:deautomate nether:worker_pork_desc;nothing=0:pigman_worker:netherrack=10:netherrack.png::grind:ach_nether:nothing:netherrack_desc;netherrack=10:furnace:nether_brick=40:netherBrick.png:::ach_nether_brick:nothing:nether_brick_desc;nether_brick=40:crafting_table:nether_block=10:netherblock.png:::ach_nether_block:nothing:nether_block_desc;nether_block=36:nothing:nether_section=1:netherSection.png:::ach_nether_section:nothing:nether_section_desc;pigman=1:nothing:pigman_smelter=1:pigmanSmelter.png:hand::ach_pigman_smelter:autocraft nether_brick=.5:pigman_smelter_desc;pigman=1:nothing:pigman_mason=1:pigmanMason.png:hand::ach_pigman_mason:autocraft nether_block=.5:pigman_mason_desc;pigman=1:nothing:pigman_builder=1:pigmanBuilder.png:hand::ach_pigman_builder:autocraft nether_section=.5:pigman_builder_desc;nether_section=7:nothing:nether_pillar=1:netherPillar.png:metal::ach_nether_pillar:nothing:nether_pillar_desc;nether_pillar=5:nothing:nether_bridge=1:netherBridge.png:metal::ach_nether_bridge:nothing:nether_bridge_desc;nether_bridge=10:nothing:nether_bridgeways=1:netherBridgeways.png:metal::ach_nether_bridgeways:nothing:neth_fort_ext_req_desc;pigman_smelter=1:spike_maul:smelter_pork=1:smelterPork.png:hand::ach_porkified:deautocraft nether_brick:smelter_pork_desc;pigman_mason=1:spike_maul:mason_pork=1:masonPork.png:hand::ach_porkified:deautocraft nether_block:mason_pork_desc;pigman_builder=1:spike_maul:builder_pork=1:builderPork.png:hand::ach_porkified:deautocraft nether_section:builder_pork_desc;nether_block=6:crafting_table:nether_fence=6:netherFence.png:metal::ach_nether_fence:nothing:nether_rooms_req_desc;nether_block=6:crafting_table:nether_stairs=6:netherStairs.png:metal::ach_nether_stairs:nothing:nether_rooms_req_desc;nether_stairs=9,nether_block=16,nether_fence=2:nothing:nether_staircase=1:netherStaircase.png:metal::ach_nether_staircase:nothing:nether_rooms_req_desc;nether_section=1,nether_staircase=1,nether_fence=27:nothing:nether_spawn=1:netherSpawn.png:metal::nothing:nothing:neth_fort_ext_req_desc;nether_block=81:nothing:nether_wall=1:netherWall.png:metal::nothing:nothing:nether_rooms_req_desc;nether_wall=6,nether_fence=22:nothing:nether_room=1:netherRoom.png:metal::ach_nether_room:nothing:nether_room_desc;nether_block=8,lava=1:nothing:nether_well=1:netherWell.png:metal::ach_nether_well:nothing:nether_well_desc;nether_room=1,nether_well=1:nothing:nether_well_room=1:netherWellRoom.png:metal::ach_nether_well:nothing:neth_fort_ext_req_desc;nether_bridgeways=1,nether_spawn=1,nether_well_room=1:nothing:nether_fortress_exterior=1:netherFortressExterior.png:metal::ach_fortress_exterior:nothing:neth_fort_req_desc;nether_room=1,nether_block=15:nothing:nether_stair_room=1:netherStairRoom.png:metal::ach_nether_stair_room:nothing:neth_fort_int_req_desc;nether_room=1,nether_staircase=2:nothing:nether_wart_room=1:netherWartRoom.png:metal::ach_nether_wart_room:nothing:neth_fort_int_req_desc;nether_section=1,nether_fence=4:nothing:nether_hall_section=1:netherHallSection.png:metal::nothing:nothing:nether_hall_section_desc;nether_hall_section=7:nothing:nether_hallway=1:netherHallway.png:metal::ach_nether_hallway:nothing:neth_fort_int_req_desc;nether_hall_section=4,nether_staircase=2:nothing:nether_stairwell=1:netherStairwell.png:metal::ach_nether_stairwell:nothing:neth_fort_int_req_desc;nether_block=27,nether_fence=13:nothing:nether_balcony=1:netherBalcony.png:metal::ach_nether_balcony:nothing:neth_fort_int_req_desc;nether_hallway=4,nether_stairwell=1,nether_balcony=1,nether_wart_room=1,nether_stair_room=1:nothing:nether_fortress_interior=1:netherFortressInterior.png:metal::ach_fortress_interior:nothing:neth_fort_req_desc;nether_fortress_exterior=1,nether_fortress_interior=1:nothing:nether_fortress=1:netherFortress.png:metal::ach_nether_fortress:beatLocation:nether_fortress_desc;nothing=0:nether_fortress:nether_fortress_exporter=1:netherFortress.png:::nothing:navigateToUrl 1ENHzF:Download.;obsidian=54:nether_fortress:ghast_catcher=1:ghastCatcher.png:metal::ach_ghast_catcher:nothing:ghast_catcher_desc;cobblestone=64:ghast_catcher:ghast_trap=1:ghastTrap.png:metal::ach_ghast_trap:nothing:ghast_trap_desc;nothing=0:nothing:ghast=1:ghast.png:hand::ach_ghast_trapped:nothing:ghast_desc;ghast=1:nothing:gunpowder=1:gunpowder.png:whoosh::ach_gunpowder:nothing:gunpowder_desc;nothing=0:nothing:string=1:string.png:whoosh::nothing:nothing:lead_req_desc;nothing=0:iron_sword,gold_sword,diamond_sword:slime_ball=1:slimeBall.png:hand:grind:nothing:nothing:lead_req_desc;string=4,slime_ball=1:nothing:lead=1:lead.png:whoosh::ach_lead:nothing:ghast_lead_desc;ghast=1,lead=1:nothing:tamed_ghast=1:tamedGhast.png:hand::ach_ghast_tamed:nothing:nether_sleigh_req_desc;nether_block=3:crafting_table:nether_slab=6:netherSlab.png:metal::ach_nether_slab:nothing:nether_slab_desc;nether_stairs=8,nether_slab=4:nothing:nether_rib=1:netherRib.png:metal::ach_nether_rib:nothing:nether_sled_req_desc;nether_rib=2:nothing:nether_ski=1:netherSki.png:metal::ach_nether_ski:nothing:nether_sled_req_desc;nether_rib=6,nether_ski=2:nothing:nether_sled=1:netherSled.png:metal::ach_nether_sled:nothing:nether_sleigh_req_desc;tamed_ghast=8,nether_sled=1:nothing:nether_sleigh=1:netherSleigh.png:metal::ach_nether_sleigh:beatGame:nether_sleigh_desc;nothing=0:nether_sleigh:nether_sleigh_exporter=1:netherSleigh.png:::nothing:navigateToUrl 1ENI60:Download.;nothing=0:nothing:miner=1:miner.png:hand:villager:nothing:automate mine:nether_miner;nothing=0:nothing:hunter=1:hunter.png:hand:villager:nothing:automate mobs:nether_hunter;nothing=0:nothing:woodsman=1:woodsman.png:hand:villager:nothing:automate overworld:nether_gardener;nothing=0:nothing:carpenter=1:carpenter.png:hand:villager:nothing:nothing:carpenter_desc;nothing=0:nothing:smelter=1:smelter.png:metal:villager:ach_smelter:autocraft iron_ingot=.5,autocraft gold_ingot:smelter_desc;nothing=0:nothing:blaze_rod=1:blazeRod.png:metal::ach_blaze_rod:nothing:blaze_rod_desc;nothing=0:nothing:arrow=4:arrow.png:whoosh::ach_arrows_crafted:nothing:arrow_desc;stick=2,iron_ingot=3:crafting_table:iron_pick=1:ironPick.png:metal:metal:nothing:nothing:iron_pick_desc;stick=2,iron_ingot=1:crafting_table:iron_shovel=1:ironShovel.png:metal:metal:nothing:nothing:shovel_desc;stick=2,iron_ingot=3:crafting_table:iron_axe=1:ironAxe.png:metal:metal:nothing:nothing:axe_desc;stick=2,iron_ingot=2:crafting_table:iron_hoe=1:ironHoe.png:metal:metal:nothing:nothing:hoe_desc;stick=1,iron_ingot=2:crafting_table:iron_sword=1:ironSword.png:metal:metal:nothing:nothing:sword_desc;stick=2,gold_ingot=3:crafting_table:gold_pick=1:goldPick.png:metal:metal:nothing:nothing:gold_pick_desc;stick=2,gold_ingot=1:crafting_table:gold_shovel=1:goldShovel.png:metal:metal:nothing:nothing:shovel_desc;stick=1,gold_ingot=2:crafting_table:gold_sword=1:goldSword.png:metal:metal:nothing:nothing:sword_desc;stick=2,gold_ingot=3:crafting_table:gold_axe=1:goldAxe.png:metal:metal:nothing:nothing:axe_desc;stick=2,gold_ingot=2:crafting_table:gold_hoe=1:goldHoe.png:metal:metal:nothing:nothing:hoe_desc;nothing=0:minecart:diamond=1:diamond.png:metal:grind:nothing:nothing:diamond_desc;stick=2,diamond=3:crafting_table:diamond_pick=1:diamondPick.png:metal:metal:nothing:nothing:diamond_pick_desc;stick=2,diamond=1:crafting_table:diamond_shovel=1:diamondShovel.png:metal:metal:nothing:nothing:shovel_desc;stick=1,diamond=2:crafting_table:diamond_sword=1:diamondSword.png:metal:metal:nothing:nothing:sword_desc;stick=2,diamond=3:crafting_table:diamond_axe=1:diamondAxe.png:metal:metal:nothing:nothing:axe_desc;stick=2,diamond=2:crafting_table:diamond_hoe=1:diamondHoe.png:metal:metal:nothing:nothing:hoe_desc;nothing=0:iron_axe,gold_axe,diamond_axe:wood=1:wood.png:wood:grind:nothing:nothing:nether_wood_desc;nothing=0:iron_shovel,gold_shovel,diamond_shovel:dirt=1:dirt.png:dirt:grind:nothing:nothing:dirt_desc;nothing=0:iron_pick,gold_pick,diamond_pick:cobblestone=1:cobblestone.png:metal:grind:nothing:nothing:cobblestone_desc;wood=1:nothing:planks=4:planks.png:wood:wood:nothing:nothing:wood_items_req_desc;planks=4:nothing:crafting_table=1:craftingTable.png:wood::ach_crafting_table:nothing:crafting_table_desc;planks=2:nothing:stick=4:stick.png:wood:wood:nothing:nothing:wood_items_req_desc;nothing=0:minecart:lava=1:lava.png:wood:grind:nothing:nothing:nether_lava_desc;nothing=0:iron_shovel,gold_shovel,diamond_shovel:flint=1:flint.png:dirt:grind:nothing:nothing:flint_desc;nothing=0:iron_pick,gold_pick,diamond_pick:gold_ore=1:goldOre.png:metal:grind:nothing:nothing:gold_ore_desc;coal=1,gold_ore=1:furnace:gold_ingot=1:goldIngot.png:metal:metal:ach_gold_ingot:nothing:gold_ingot_desc;nothing=0:nothing:city_state=1:cityState.png:::ach_city_state:nothing:good_job_desc;nothing=0:nothing:port=1:port.png:wood:wood:ach_port:nothing:port_desc",
    t
}();
!function(t) {
    var e = function() {
        function t(t, e, i, s, n) {
            void 0 === n && (n = null),
            this.KEY = "atlas",
            this.game = t,
            this.x = e,
            this.y = i,
            this.scrollSize_ = s,
            this.viewRect_ = new Phaser.Rectangle(0,0,0,0),
            this.viewRectUser_ = n,
            this.scrollBarGroup = t.add.group(),
            this.updateViewRect(),
            this.createScrollBar(),
            this.resizeScrollBar()
        }
        return Object.defineProperty(t.prototype, "scrollSize", {
            get: function() {
                return this.scrollSize_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "viewRect", {
            get: function() {
                return this.viewRect_
            },
            enumerable: !0,
            configurable: !0
        }),
        t.prototype.reset = function() {}
        ,
        t.prototype.resize = function(t, e, i) {
            void 0 === i && (i = null),
            this.x = t,
            this.y = e,
            this.viewRectUser_ = i,
            this.updateViewRect(),
            this.resizeScrollBar()
        }
        ,
        t.prototype.createScrollBar = function() {
            this.scrollBarBack = this.game.add.sprite(0, 0, this.KEY, "flcontrols.png"),
            this.scrollBarGroup.add(this.scrollBarBack),
            this.scrollBarMove = new Phaser.Sprite(this.game,0,0,GameAPI.scrollbitmapdata.texture),
            this.scrollBarGroup.add(this.scrollBarMove)
        }
        ,
        t.prototype.updateViewRect = function() {
            null !== this.viewRectUser_ ? this.viewRect_.copyFrom(this.viewRectUser_) : (this.viewRect_.x = this.x,
            this.viewRect_.y = this.y,
            this.viewRect_.width = this.scrollSize_,
            this.viewRect_.height = this.game.height - this.y)
        }
        ,
        t.prototype.resizeScrollBar = function() {
            this.scrollBarBack.x = this.viewRect_.x,
            this.scrollBarBack.y = this.viewRect_.y,
            this.scrollBarBack.width = this.viewRect_.width,
            this.scrollBarBack.height = this.viewRect_.height,
            this.scrollBarMove.x = this.viewRect_.x,
            this.scrollBarMove.y = this.viewRect_.y,
            this.scrollBarMove.width = this.viewRect_.width
        }
        ,
        t
    }();
    t.MobileScrollBar = e
}(Components || (Components = {})),
function(t) {
    var e, i;
    e = t.core || (t.core = {}),
    i = function() {
        function t() {
            this.disposed_ = !1,
            this.signal_disposed_ = new Phaser.Signal
        }
        return Object.defineProperty(t.prototype, "disposed", {
            get: function() {
                return this.disposed_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "signalDisposed", {
            get: function() {
                return this.signal_disposed_
            },
            enumerable: !0,
            configurable: !0
        }),
        t.prototype.dispose = function() {
            this.disposed_ || (this.disposed_ = !0,
            this.signal_disposed_.dispatch(this),
            this.signal_disposed_.dispose(),
            this.signal_disposed_ = null,
            this.customDispose())
        }
        ,
        t.prototype.customDispose = function() {}
        ,
        t
    }(),
    e.IsfDisposableObject = i
}(Framework || (Framework = {})),
function(t) {
    var e, r, o, a, i;
    e = t.gui || (t.gui = {}),
    r = function() {}
    ,
    o = function() {}
    ,
    a = function() {}
    ,
    i = function(n) {
        function t(t) {
            var e = n.call(this) || this;
            e.kDoubleClickMaxDelay = .2,
            e.kMaxId = 3,
            e.kDragId = 1,
            e.kDragDiffLength = 10,
            e.downs_ = null,
            e.dbl_click_ = null,
            e.drag_ = !1,
            e.last_pos_ = null,
            e.in_ = !1,
            e.rect_ = null,
            e.changes_ = null,
            e.disabled_ = !1,
            e.sg_click_ = null,
            e.sg_drag_begin_ = null,
            e.sg_dragging_ = null,
            e.sg_drag_end_ = null,
            e.sg_move_ = null,
            e.sg_in_ = null,
            e.sg_out_ = null,
            e.sg_double_click_ = null,
            e.rect_ = t,
            e.downs_ = [];
            var i = 0;
            for (i = 0; i < e.kMaxId; i++) {
                (s = new o).active = !1,
                s.pos = new Phaser.Point,
                e.downs_.push(s)
            }
            for (e.dbl_click_ = [],
            i = 0; i < e.kMaxId; i++) {
                var s;
                (s = new a).active = !1,
                s.pos = new Phaser.Point,
                s.timeout = e.kDoubleClickMaxDelay,
                e.dbl_click_.push(s)
            }
            return e.last_pos_ = new Phaser.Point,
            e.changes_ = [],
            e.sg_click_ = new Phaser.Signal,
            e.sg_drag_begin_ = new Phaser.Signal,
            e.sg_dragging_ = new Phaser.Signal,
            e.sg_drag_end_ = new Phaser.Signal,
            e.sg_move_ = new Phaser.Signal,
            e.sg_in_ = new Phaser.Signal,
            e.sg_out_ = new Phaser.Signal,
            e.sg_double_click_ = new Phaser.Signal,
            e
        }
        return __extends(t, n),
        Object.defineProperty(t.prototype, "isDragging", {
            get: function() {
                return this.drag_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "rectangle", {
            get: function() {
                return this.rect_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "last_pos", {
            get: function() {
                return this.last_pos_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "disabled", {
            get: function() {
                return this.disabled_
            },
            set: function(t) {
                this.disabled_ = t
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "sg_click", {
            get: function() {
                return this.sg_click_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "sg_drag_begin", {
            get: function() {
                return this.sg_drag_begin_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "sg_dragging", {
            get: function() {
                return this.sg_dragging_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "sg_drag_end", {
            get: function() {
                return this.sg_drag_end_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "sg_move", {
            get: function() {
                return this.sg_move_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "sg_out", {
            get: function() {
                return this.sg_out_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "sg_in", {
            get: function() {
                return this.sg_in_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "sg_double_click", {
            get: function() {
                return this.sg_double_click_
            },
            enumerable: !0,
            configurable: !0
        }),
        t.prototype.resize = function(t) {
            this.rect_ = t
        }
        ,
        t.prototype.addChange = function(t, e, i, s) {
            if (!this.disabled_) {
                var n = new r;
                n.x = t,
                n.y = e,
                n.down_id = i,
                n.up_id = s,
                this.changes_.push(n)
            }
        }
        ,
        t.prototype.process = function(t) {
            if (!this.disabled_) {
                var e = new Phaser.Point
                  , i = 0;
                for (i = 0; i < this.changes_.length; i++) {
                    var s = this.changes_[i];
                    if (!(s.down_id > this.kMaxId || s.up_id > this.kMaxId))
                        if (this.rect_.contains(s.x, s.y) ? (this.in_ || (this.sg_in_.dispatch(this),
                        this.in_ = !0),
                        this.sg_move_.dispatch(this, s.x, s.y),
                        this.last_pos_.setTo(s.x, s.y)) : this.in_ && (this.sg_out_.dispatch(this),
                        this.in_ = !1),
                        -1 == s.down_id)
                            if (-1 == s.up_id) {
                                var n = this.downs_[this.kDragId - 1];
                                if (this.drag_)
                                    this.sg_dragging_.dispatch(this, s.x, s.y);
                                else if (n.active) {
                                    e.setTo(s.x, s.y);
                                    var r = e.subtract(n.pos.x, n.pos.x);
                                    Phaser.Math.distance(r.x, r.y, 0, 0) >= this.kDragDiffLength && (this.drag_ = !0,
                                    this.sg_drag_begin_.dispatch(this, n.pos.x, n.pos.y),
                                    this.sg_dragging_.dispatch(this, s.x, s.y))
                                }
                            } else {
                                o = this.downs_[s.up_id - 1];
                                if (this.drag_) {
                                    this.drag_ = !1,
                                    this.sg_drag_end_.dispatch(this, s.x, s.y),
                                    o.active = !1;
                                    continue
                                }
                                o.active && (this.sg_click_.dispatch(this, o.pos.x, o.pos.y),
                                (a = this.dbl_click_[s.up_id - 1]).active ? (a.active = !1,
                                this.sg_double_click_.dispatch(this, a.pos.x, a.pos.y)) : (a.active = !0,
                                a.timeout = this.kDoubleClickMaxDelay,
                                a.pos.setTo(s.x, s.y))),
                                o.active = !1
                            }
                        else {
                            if (!this.rect_.contains(s.x, s.y))
                                continue;
                            var o;
                            (o = this.downs_[s.down_id - 1]).active = !0,
                            o.pos.setTo(s.x, s.y)
                        }
                }
                for (this.changes_.splice(0, this.changes_.length),
                i = 0; i < this.dbl_click_.length; i++) {
                    var a;
                    (a = this.dbl_click_[i]).active && (a.timeout -= t,
                    a.timeout < 0 && (a.active = !1))
                }
            }
        }
        ,
        t.prototype.reset = function() {
            this.drag_ = !1,
            this.last_pos_ = new Phaser.Point,
            this.in_ = !1;
            var t = 0;
            for (t = 0; t < this.kMaxId; t++)
                this.downs_[t].active = !1;
            for (t = 0; t < this.kMaxId; t++)
                this.dbl_click_[t].active = !1,
                this.dbl_click_[t].timeout = this.kDoubleClickMaxDelay;
            this.changes_.splice(0, this.changes_.length)
        }
        ,
        t.prototype.customDispose = function() {
            this.sg_click_.dispose(),
            this.sg_click_ = null,
            this.sg_drag_begin_.dispose(),
            this.sg_drag_begin_ = null,
            this.sg_dragging_.dispose(),
            this.sg_dragging_ = null,
            this.sg_drag_end_.dispose(),
            this.sg_drag_end_ = null,
            this.sg_move_.dispose(),
            this.sg_move_ = null,
            this.sg_in_.dispose(),
            this.sg_in_ = null,
            this.sg_out_.dispose(),
            this.sg_out_ = null,
            this.changes_.splice(0, this.changes_.length),
            this.changes_ = null,
            n.prototype.customDispose.call(this)
        }
        ,
        t
    }(t.core.IsfDisposableObject),
    e.Gestures = i
}(Framework || (Framework = {})),
function(t) {
    var e, i;
    e = t.core || (t.core = {}),
    i = function(e) {
        function t() {
            var t = e.call(this) || this;
            return t.resetLifetime(),
            t.m_paused = !1,
            t.m_processPeriod = 0,
            t.m_accumulator = 0,
            t
        }
        return __extends(t, e),
        Object.defineProperty(t.prototype, "paused", {
            get: function() {
                return this.m_paused
            },
            set: function(t) {
                this.m_paused = t
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "processPeriod", {
            get: function() {
                return this.m_processPeriod
            },
            set: function(t) {
                this.m_processPeriod = t
            },
            enumerable: !0,
            configurable: !0
        }),
        t.prototype.resetLifetime = function() {
            this.m_lifetime = 0
        }
        ,
        t.prototype.resetAccumulator = function() {
            this.m_accumulator = 0
        }
        ,
        t.prototype.process = function(t) {
            if (!this.disposed_ && !this.m_paused) {
                this.m_accumulator += t;
                var e = this.m_processPeriod;
                if (0 == e)
                    this.m_lifetime += this.m_accumulator,
                    this.customProcess(this.m_accumulator),
                    this.m_accumulator = 0;
                else
                    for (; this.m_accumulator >= e && !this.disposed_; )
                        this.m_lifetime += e,
                        this.customProcess(e),
                        this.m_accumulator -= e
            }
        }
        ,
        t.prototype.customProcess = function(t) {}
        ,
        t.prototype.customDispose = function() {
            e.prototype.customDispose.call(this)
        }
        ,
        t
    }(t.core.IsfDisposableObject),
    e.IsfBaseObject = i
}(Framework || (Framework = {})),
function(t) {
    var e, i;
    e = t.tween || (t.tween = {}),
    i = function() {
        function a(t, e, i, s) {
            void 0 === t && (t = null),
            void 0 === e && (e = 0),
            void 0 === i && (i = 0),
            void 0 === s && (s = 0),
            this.m_calc = null != t ? t : this.defCalc,
            this.x0 = e,
            this.dx = i - e,
            this.mscDuration = 1e3 * s
        }
        return a.jump = function(t, e, i, s) {
            return t < s / 2 ? 2 * i * t / s + e : 2 * i * (1 - t / s) + e
        }
        ,
        a.linear = function(t, e, i, s) {
            return i * t / s + e
        }
        ,
        a.sineIn = function(t, e, i, s) {
            return -i * Math.cos(t / s * (Math.PI / 2)) + e + i
        }
        ,
        a.sineOut = function(t, e, i, s) {
            return i * Math.sin(t / s * (Math.PI / 2)) + e
        }
        ,
        a.sineInAndOut = function(t, e, i, s) {
            return -i / 2 * (Math.cos(t / s * Math.PI) - 1) + e
        }
        ,
        a.quadIn = function(t, e, i, s) {
            return i * (t /= s) * t + e
        }
        ,
        a.quadOut = function(t, e, i, s) {
            return -i * (t /= s) * (t - 2) + e
        }
        ,
        a.quadInAndOut = function(t, e, i, s) {
            return (t /= s / 2) < 1 ? i / 2 * t * t + e : -i / 2 * (--t * (t - 2) - 1) + e
        }
        ,
        a.cubicIn = function(t, e, i, s) {
            return i * (t /= s) * t * t + e
        }
        ,
        a.cubicOut = function(t, e, i, s) {
            return i * ((t = t / s - 1) * t * t + 1) + e
        }
        ,
        a.cubicInAndOut = function(t, e, i, s) {
            return (t /= s / 2) < 1 ? i / 2 * t * t * t + e : i / 2 * ((t -= 2) * t * t + 2) + e
        }
        ,
        a.quartIn = function(t, e, i, s) {
            return i * (t /= s) * t * t * t + e
        }
        ,
        a.quartOut = function(t, e, i, s) {
            return -i * ((t = t / s - 1) * t * t * t - 1) + e
        }
        ,
        a.quartInAndOut = function(t, e, i, s) {
            return (t /= s / 2) < 1 ? i / 2 * t * t * t * t + e : -i / 2 * ((t -= 2) * t * t * t - 2) + e
        }
        ,
        a.quintIn = function(t, e, i, s) {
            return i * (t /= s) * t * t * t * t + e
        }
        ,
        a.quintOut = function(t, e, i, s) {
            return i * ((t = t / s - 1) * t * t * t * t + 1) + e
        }
        ,
        a.quintInAndOut = function(t, e, i, s) {
            return (t /= s / 2) < 1 ? i / 2 * t * t * t * t * t + e : i / 2 * ((t -= 2) * t * t * t * t + 2) + e
        }
        ,
        a.expoIn = function(t, e, i, s) {
            return 0 == t ? e : i * Math.pow(2, 10 * (t / s - 1)) + e
        }
        ,
        a.expoOut = function(t, e, i, s) {
            return t == s ? e + i : i * (1 - Math.pow(2, -10 * t / s)) + e
        }
        ,
        a.expoInAndOut = function(t, e, i, s) {
            return 0 == t ? e : t == s ? e + i : (t /= s / 2) < 1 ? i / 2 * Math.pow(2, 10 * (t - 1)) + e : i / 2 * (2 - Math.pow(2, -10 * --t)) + e
        }
        ,
        a.backIn = function(t, e, i, s) {
            return i * (t /= s) * t * (2.70158 * t - 1.70158) + e
        }
        ,
        a.backOut = function(t, e, i, s) {
            return i * ((t = t / s - 1) * t * (2.70158 * t + 1.70158) + 1) + e
        }
        ,
        a.backInAndOut = function(t, e, i, s) {
            var n = 1.70158;
            return (t /= s / 2) < 1 ? i / 2 * (t * t * ((1 + (n *= 1.525)) * t - n)) + e : i / 2 * ((t -= 2) * t * ((1 + (n *= 1.525)) * t + n) + 2) + e
        }
        ,
        a.bounce = function(t, e, i, s) {
            return (t /= s) < 1 / 2.75 ? i * (7.5625 * t * t) + e : t < 2 / 2.75 ? i * (7.5625 * (t -= 1.5 / 2.75) * t + .75) + e : t < 2.5 / 2.75 ? i * (7.5625 * (t -= 2.25 / 2.75) * t + .9375) + e : i * (7.5625 * (t -= 2.625 / 2.75) * t + .984375) + e
        }
        ,
        a.elasticIn = function(t, e, i, s) {
            var n, r = a.ELASTIC_AMPLITUDE, o = a.ELASTIC_PERIOD;
            return 0 == t ? e : 1 == (t /= s) ? e + i : (isNaN(o) && (o = .3 * s),
            n = isNaN(r) || r < Math.abs(i) ? (r = i,
            o / 4) : o / (2 * Math.PI) * Math.asin(i / r),
            -r * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * s - n) * (2 * Math.PI) / o) + e)
        }
        ,
        a.elasticOut = function(t, e, i, s) {
            var n, r = a.ELASTIC_AMPLITUDE, o = a.ELASTIC_PERIOD;
            return 0 == t ? e : 1 == (t /= s) ? e + i : (isNaN(o) && (o = .3 * s),
            n = isNaN(r) || r < Math.abs(i) ? (r = i,
            o / 4) : o / (2 * Math.PI) * Math.asin(i / r),
            r * Math.pow(2, -10 * t) * Math.sin((t * s - n) * (2 * Math.PI) / o) + i + e)
        }
        ,
        a.elasticInAndOut = function(t, e, i, s) {
            var n, r = a.ELASTIC_AMPLITUDE, o = a.ELASTIC_PERIOD;
            return 0 == t ? e : 2 == (t /= s / 2) ? e + i : (isNaN(o) && (o = s * (.3 * 1.5)),
            n = isNaN(r) || r < Math.abs(i) ? (r = i,
            o / 4) : o / (2 * Math.PI) * Math.asin(i / r),
            t < 1 ? r * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * s - n) * (2 * Math.PI) / o) * -.5 + e : r * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * s - n) * (2 * Math.PI) / o) * .5 + i + e)
        }
        ,
        a.prototype.copyTo = function(t) {
            t.x0 = this.x0,
            t.dx = this.dx,
            t.mscDuration = this.mscDuration,
            t.m_calc = this.m_calc
        }
        ,
        a.prototype.copyFrom = function(t) {
            t.copyTo(this)
        }
        ,
        a.prototype.calc = function(t) {
            return this.m_calc(t, this.x0, this.dx, this.mscDuration)
        }
        ,
        a.prototype.defCalc = function(t, e, i, s) {
            return 0
        }
        ,
        a.BACK_OVERSHOOT = 1.70158,
        a.ELASTIC_PERIOD = 400,
        a.ELASTIC_AMPLITUDE = NaN,
        a
    }(),
    e.Transition = i
}(Framework || (Framework = {})),
function(t) {
    var n, e;
    n = t.tween || (t.tween = {}),
    e = function(r) {
        function t(t, e, i, s) {
            void 0 === t && (t = null),
            void 0 === e && (e = 0),
            void 0 === i && (i = !0),
            void 0 === s && (s = 1);
            var n = r.call(this) || this;
            return null != t && n.initTween(t, e, i, s),
            n.m_signalTweenStart = new Phaser.Signal,
            n.m_signalTweenProcess = new Phaser.Signal,
            n.m_signalTweenFinish = new Phaser.Signal,
            n
        }
        return __extends(t, r),
        Object.defineProperty(t.prototype, "repeatCounter", {
            get: function() {
                return this.m_repeatCounter
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "isFinished", {
            get: function() {
                return this.m_isFinished
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "currentValue", {
            get: function() {
                return this.m_currentValue
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "previousValue", {
            get: function() {
                return this.m_previousValue
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "transition", {
            get: function() {
                return this.m_transition
            },
            set: function(t) {
                this.m_transition = t
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "isPlaying", {
            get: function() {
                return this.m_isPlaying
            },
            set: function(t) {
                this.m_isPlaying = t
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "disposeAfterFinish", {
            get: function() {
                return this.m_disposeAfterFinish
            },
            set: function(t) {
                this.m_disposeAfterFinish = t
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "signalTweenStart", {
            get: function() {
                return this.m_signalTweenStart
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "signalTweenProcess", {
            get: function() {
                return this.m_signalTweenProcess
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "signalTweenFinish", {
            get: function() {
                return this.m_signalTweenFinish
            },
            enumerable: !0,
            configurable: !0
        }),
        t.prototype.getCurMscTime = function() {
            return this.m_mscTime
        }
        ,
        t.prototype.initTween = function(t, e, i, s) {
            return void 0 === e && (e = 0),
            void 0 === i && (i = !0),
            void 0 === s && (s = 1),
            this.m_transition = null == t ? new n.Transition(n.Transition.linear,0,0,0) : t,
            this.m_delayBeforeStart = e,
            this.m_disposeAfterFinish = i,
            this.restart(s),
            this
        }
        ,
        t.prototype.setDelayBeforeStart = function(t) {
            this.m_delayBeforeStart = t
        }
        ,
        t.prototype.restart = function(t, e) {
            void 0 === e && (e = 0),
            this.m_repeatCounter = t,
            this.m_lifetime = e,
            this.m_mscTime = 1e3 * this.m_lifetime,
            this.m_isFinished = !1,
            this.m_currentValue = this.m_transition.calc(this.m_mscTime),
            this.m_previousValue = NaN,
            this.m_isPlaying = !0
        }
        ,
        t.prototype.customProcess = function(t) {
            this.m_isPlaying && (!this.m_isFinished && this.m_lifetime >= this.m_delayBeforeStart && (this.m_lifetime - t < this.m_delayBeforeStart && (this.startTween(),
            this.m_signalTweenStart.dispatch(this)),
            this.m_mscTime < this.m_transition.mscDuration + this.m_delayBeforeStart ? (this.processTween(),
            this.m_signalTweenProcess.dispatch(this)) : (this.finishTween(),
            this.m_repeatCounter--,
            0 == this.m_repeatCounter ? (this.m_isFinished = !0,
            this.m_isPlaying = !1,
            this.m_signalTweenFinish.dispatch(this),
            this.m_disposeAfterFinish && this.dispose()) : this.restart(this.m_repeatCounter)),
            this.m_mscTime += 1e3 * t),
            r.prototype.customProcess.call(this, t))
        }
        ,
        t.prototype.customDispose = function() {
            this.m_signalTweenStart.dispose(),
            this.m_signalTweenProcess.dispose(),
            this.m_signalTweenFinish.dispose(),
            r.prototype.customDispose.call(this),
            this.userData = null
        }
        ,
        t.prototype.startTween = function() {}
        ,
        t.prototype.processTween = function() {
            this.m_previousValue = this.m_currentValue,
            this.m_currentValue = this.m_transition.calc(this.m_mscTime)
        }
        ,
        t.prototype.finishTween = function() {
            this.m_currentValue = this.m_transition.x0 + this.m_transition.dx
        }
        ,
        t
    }(t.core.IsfBaseObject),
    n.Tween = e
}(Framework || (Framework = {})),
function(o) {
    var t, e;
    t = o.gui || (o.gui = {}),
    e = function(r) {
        function t(t, e, i) {
            var s = r.call(this) || this;
            s.kMaxOverDistance = 50,
            s.kInertiaTime = .5,
            s.kApplyStepTime = .1,
            s.kElasticTime = .25,
            s.kSpeedCount = 3,
            s.elastic_ = !1,
            s.lock_x_ = !1,
            s.lock_y_ = !1,
            s.time_step_ = 0,
            s.tween_x_ = null,
            s.tween_y_ = null,
            s.inertia_ = !1,
            s.speeds_ = null,
            s.speed_index_ = 0,
            s.speed_count_ = 0,
            s.last_speed_count_ = 0,
            s.step_x_ = 0,
            s.step_y_ = 0,
            s.gestures_ = null,
            s.rect_ = null,
            s.view_width_ = 0,
            s.view_height_ = 0,
            s.begin_drag_pos_ = null,
            s.disabled_ = !1,
            s.is_high_speed_ = !1,
            s.setGestures(t),
            s.view_width_ = e,
            s.view_height_ = i,
            s.rect_ = new Phaser.Rectangle(0,0,0,0),
            s.begin_drag_pos_ = new Phaser.Point,
            s.speeds_ = [];
            var n = 0;
            for (n = 0; n < s.kSpeedCount; n++)
                s.speeds_.push(new Phaser.Point);
            return s
        }
        return __extends(t, r),
        t.prototype.resize = function(t, e) {
            this.view_width_ = t,
            this.view_height_ = e
        }
        ,
        t.prototype.setGestures = function(t) {
            null != this.gestures_ && (this.gestures_.sg_drag_begin.remove(this.onDragBegin, this),
            this.gestures_.sg_dragging.remove(this.onDragging, this),
            this.gestures_.sg_drag_end.remove(this.onDragEnd, this)),
            this.gestures_ = t,
            this.gestures_.sg_drag_begin.add(this.onDragBegin, this),
            this.gestures_.sg_dragging.add(this.onDragging, this),
            this.gestures_.sg_drag_end.add(this.onDragEnd, this)
        }
        ,
        t.prototype.setWidth = function(t) {
            this.rect_.width = t
        }
        ,
        t.prototype.setHeight = function(t) {
            this.rect_.height = t
        }
        ,
        t.prototype.getWidth = function() {
            return this.rect_.width
        }
        ,
        t.prototype.getHeight = function() {
            return this.rect_.height
        }
        ,
        t.prototype.getX = function() {
            return this.rect_.x
        }
        ,
        t.prototype.getY = function() {
            return this.rect_.y
        }
        ,
        t.prototype.setX = function(t) {
            this.rect_.x = t,
            this.updateDrag(0, 0)
        }
        ,
        t.prototype.setY = function(t) {
            this.rect_.y = t,
            this.updateDrag(0, 0)
        }
        ,
        t.prototype.set_elastic = function(t) {
            this.elastic_ = t
        }
        ,
        t.prototype.set_lock_x = function(t) {
            this.lock_x_ = t
        }
        ,
        t.prototype.set_lock_y = function(t) {
            this.lock_y_ = t
        }
        ,
        t.prototype.use_inertia = function(t) {
            this.inertia_ = t
        }
        ,
        t.prototype.set_step_x = function(t) {
            this.step_x_ = t
        }
        ,
        t.prototype.set_step_y = function(t) {
            this.step_y_ = t
        }
        ,
        t.prototype.doDrag = function(t, e) {
            this.gestures_.isDragging || (this.setDstX(this.rect_.x + t, this.kApplyStepTime),
            this.setDstY(this.rect_.y + e, this.kApplyStepTime))
        }
        ,
        t.prototype.disabled = function() {
            return this.disabled_
        }
        ,
        t.prototype.set_disabled = function(t) {
            this.disabled_ != t && (this.disabled_ = t,
            this.disabled_ ? this.resetSpeed() : (this.setDstX(this.rect_.x, this.kApplyStepTime),
            this.setDstY(this.rect_.y, this.kApplyStepTime)))
        }
        ,
        t.prototype.process = function(t) {
            this.time_step_ = t,
            this.disabled_ || (this.gestures_.isDragging ? this.inertia_ && (this.last_speed_count_ != this.speed_count_ && this.addSpeed(0, 0),
            this.last_speed_count_ = this.speed_count_) : this.updateSpeed(t))
        }
        ,
        t.prototype.isSwipeScrolling = function() {
            return null != this.tween_y_ && this.is_high_speed_
        }
        ,
        t.prototype.isHighSpeed = function() {
            return this.is_high_speed_
        }
        ,
        t.prototype.reset = function() {
            this.time_step_ = 0,
            this.resetSpeed(),
            this.resetSpeedAccums(),
            this.rect_.x = 0,
            this.rect_.y = 0,
            this.begin_drag_pos_ = new Phaser.Point
        }
        ,
        t.prototype.customDispose = function() {
            null != this.gestures_ && (this.gestures_.sg_drag_begin.remove(this.onDragBegin, this),
            this.gestures_.sg_dragging.remove(this.onDragging, this),
            this.gestures_.sg_drag_end.remove(this.onDragEnd, this),
            this.gestures_ = null),
            r.prototype.customDispose.call(this)
        }
        ,
        t.prototype.resetSpeed = function() {
            null != this.tween_x_ && (this.tween_x_.dispose(),
            this.tween_x_ = null),
            null != this.tween_y_ && (this.tween_y_.dispose(),
            this.tween_y_ = null),
            this.is_high_speed_ = !1
        }
        ,
        t.prototype.getLeftWrongFactor = function(t) {
            return this.isLeftWrong(t) ? this.isLeftWrong(this.rect_.x) ? 0 : t / Math.abs(this.rect_.x - t) : 0
        }
        ,
        t.prototype.getRightWrongFactor = function(t) {
            if (!this.isRightWrong(t))
                return 0;
            if (this.isRightWrong(this.rect_.x))
                return 0;
            var e = Math.abs(this.rect_.x - t);
            return (this.view_width_ - (t + this.rect_.width)) / e
        }
        ,
        t.prototype.getTopWrongFactor = function(t) {
            return this.isTopWrong(t) ? this.isTopWrong(this.rect_.y) ? 0 : t / Math.abs(this.rect_.y - t) : 0
        }
        ,
        t.prototype.getBottomWrongFactor = function(t) {
            if (!this.isBottomWrong(t))
                return 0;
            if (this.isBottomWrong(this.rect_.y))
                return 0;
            var e = Math.abs(this.rect_.y - t);
            return (this.view_height_ - (t + this.rect_.height)) / e
        }
        ,
        t.prototype.isLeftWrong = function(t) {
            return 0 < t
        }
        ,
        t.prototype.isTopWrong = function(t) {
            return 0 < t
        }
        ,
        t.prototype.isRightWrong = function(t) {
            return t + this.rect_.width < this.view_width_
        }
        ,
        t.prototype.isBottomWrong = function(t) {
            return t + this.rect_.height < this.view_height_
        }
        ,
        t.prototype.setDstX = function(t, e) {
            if (!this.lock_x_) {
                0 < this.step_x_ && (Math.abs(t - this.rect_.x) < 1 && (e = this.kApplyStepTime),
                t = Math.round(t / this.step_x_) * this.step_x_);
                var i = t;
                this.isLeftWrong(t) && (i = 0,
                this.isLeftWrong(this.rect_.x) ? (t = i,
                e = this.kElasticTime) : this.elastic_ && t > this.kMaxOverDistance && (i = this.kMaxOverDistance)),
                this.isRightWrong(t) && (0 < (i = this.view_width_ - this.rect_.width) && (i = 0),
                this.isRightWrong(this.rect_.x) ? (t = i,
                e = this.kElasticTime) : this.elastic_ && t < i - this.kMaxOverDistance && (i -= this.kMaxOverDistance));
                var s = Math.abs(this.rect_.x - t);
                e *= Math.abs(this.rect_.x - i) / s;
                var n = new o.tween.Transition(o.tween.Transition.quadOut,this.rect_.x,i,e);
                this.tween_x_ = new o.tween.Tween(n,0,!1)
            }
        }
        ,
        t.prototype.setDstY = function(t, e) {
            if (!this.lock_y_) {
                0 < this.step_y_ && (Math.abs(t - this.rect_.y) < 1 && (e = this.kApplyStepTime),
                t = Math.round(t / this.step_y_) * this.step_y_);
                var i = t;
                this.isTopWrong(t) ? (i = 0,
                this.isTopWrong(this.rect_.y) ? (t = i,
                e = this.kElasticTime) : this.elastic_ && t > this.kMaxOverDistance && (i = this.kMaxOverDistance)) : this.isBottomWrong(t) && (0 < (i = this.view_height_ - this.rect_.height) && (i = 0),
                this.isBottomWrong(this.rect_.y) ? (t = i,
                e = this.kElasticTime) : this.elastic_ && t < i - this.kMaxOverDistance && (i -= this.kMaxOverDistance));
                var s = Math.abs(this.rect_.y - t);
                e *= Math.abs(this.rect_.y - i) / s;
                var n = new o.tween.Transition(o.tween.Transition.sineOut,this.rect_.y,i,e);
                this.tween_y_ = new o.tween.Tween(n,0,!1)
            }
        }
        ,
        t.prototype.updateSpeed = function(t) {
            var e = !1
              , i = !1
              , s = 0
              , n = 0;
            null != this.tween_x_ && (this.tween_x_.process(t),
            this.rect_.x = this.tween_x_.currentValue,
            this.tween_x_.isFinished && (this.tween_x_ = null,
            this.elastic_ && (this.isLeftWrong(this.rect_.x) ? (e = !0,
            s = 0) : this.isRightWrong(this.rect_.x) && (s = this.view_width_ - this.rect_.width) <= 0 && (e = !0)))),
            null != this.tween_y_ && (this.tween_y_.process(t),
            this.rect_.y = this.tween_y_.currentValue,
            this.tween_y_.isFinished && (this.tween_y_ = null,
            this.elastic_ && (this.isTopWrong(this.rect_.y) ? (i = !0,
            n = 0) : this.isBottomWrong(this.rect_.y) && (n = this.view_height_ - this.rect_.height) <= 0 && (i = !0)))),
            e && this.setDstX(s, this.kElasticTime),
            i && this.setDstY(n, this.kElasticTime)
        }
        ,
        t.prototype.updateDrag = function(t, e) {
            this.lock_x_ && (t = 0),
            this.lock_y_ && (e = 0);
            var i = this.rect_.x + t
              , s = this.rect_.y + e;
            this.elastic_ ? ((this.isRightWrong(i) || this.isRightWrong(this.rect_.x) || this.isLeftWrong(i) || this.isLeftWrong(this.rect_.x)) && (i = this.rect_.x + t / 2),
            (this.isBottomWrong(s) || this.isBottomWrong(this.rect_.y) || this.isTopWrong(s) || this.isTopWrong(this.rect_.y)) && (s = this.rect_.y + e / 2)) : (this.isRightWrong(i) && (i = this.view_width_ - this.rect_.width),
            this.isBottomWrong(s) && (s = this.view_height_ - this.rect_.height),
            this.isLeftWrong(i) && (i = 0),
            this.isTopWrong(s) && (s = 0)),
            this.rect_.x = i,
            this.rect_.y = s
        }
        ,
        t.prototype.applyDragBegin = function(t, e) {
            this.begin_drag_pos_.setTo(t, e),
            this.resetSpeedAccums(),
            this.resetSpeed(),
            this.is_high_speed_ = !1
        }
        ,
        t.prototype.applyDragging = function(t, e) {
            var i = t - this.begin_drag_pos_.x
              , s = e - this.begin_drag_pos_.y;
            this.inertia_ && this.addSpeed(i, s),
            this.updateDrag(i, s),
            this.begin_drag_pos_.setTo(t, e)
        }
        ,
        t.prototype.applyDragEnd = function(t, e) {
            var i = t - this.begin_drag_pos_.x
              , s = e - this.begin_drag_pos_.y;
            this.updateDrag(t - this.begin_drag_pos_.x, e - this.begin_drag_pos_.y),
            this.begin_drag_pos_.setTo(t, e);
            var n = this.rect_.x + i
              , r = this.rect_.y + s;
            if (this.inertia_) {
                var o = new Phaser.Point;
                this.calcSpeed(o),
                this.is_high_speed_ = .6 < Math.abs(o.y),
                n = o.x / this.time_step_ + this.rect_.x,
                r = o.y / this.time_step_ + this.rect_.y
            }
            this.setDstY(r, this.kInertiaTime),
            this.setDstX(n, this.kInertiaTime)
        }
        ,
        t.prototype.calcSpeed = function(t) {
            var e = this.speed_count_;
            e > this.kSpeedCount && (e = this.kSpeedCount),
            t.setTo(0, 0);
            var i = 0;
            for (i = 0; i < e; i++)
                t.x += this.speeds_[i].x,
                t.y += this.speeds_[i].y;
            t.x /= e,
            t.y /= e
        }
        ,
        t.prototype.addSpeed = function(t, e) {
            ++this.speed_count_,
            this.speed_index_ >= this.kSpeedCount && (this.speed_index_ = 0),
            this.speeds_[this.speed_index_].setTo(t, e),
            ++this.speed_index_
        }
        ,
        t.prototype.resetSpeedAccums = function() {
            this.speed_count_ = 0,
            this.speed_index_ = 0;
            var t = this.last_speed_count_ = 0;
            for (t = 0; t < this.kSpeedCount; t++)
                this.speeds_[t].setTo(0, 0)
        }
        ,
        t.prototype.onDragBegin = function(t, e, i) {
            this.applyDragBegin(e, i)
        }
        ,
        t.prototype.onDragging = function(t, e, i) {
            this.applyDragging(e, i)
        }
        ,
        t.prototype.onDragEnd = function(t, e, i) {
            this.applyDragEnd(e, i)
        }
        ,
        t
    }(o.core.IsfDisposableObject),
    t.DragArea = e
}(Framework || (Framework = {})),
function(s) {
    !function(t) {
        var n, e;
        (e = n = t.Position || (t.Position = {}))[e.kHorizontal = 0] = "kHorizontal",
        e[e.kVertical = 1] = "kVertical";
        var i = function(s) {
            function t(t, e) {
                var i = s.call(this) || this;
                return i.kMinSize = 10,
                i.gestures_ = null,
                i.position_ = n.kVertical,
                i.view_rect_ = null,
                i.scroll_rect_ = null,
                i.area_rect_ = null,
                i.area_view_rect_ = null,
                i.drag_pos_ = null,
                i.drag_scroll_rect_pos_ = null,
                i.gestures_ = t,
                null != i.gestures_ && (i.gestures_.sg_drag_begin.add(i.onDragBegin, i),
                i.gestures_.sg_dragging.add(i.onDragging, i),
                i.gestures_.sg_drag_end.add(i.onDragEnd, i)),
                i.position_ = e,
                i.view_rect_ = new Phaser.Rectangle(0,0,0,0),
                i.area_rect_ = new Phaser.Rectangle(0,0,0,0),
                i.area_view_rect_ = new Phaser.Rectangle(0,0,0,0),
                i.scroll_rect_ = new Phaser.Rectangle(0,0,0,0),
                i.drag_pos_ = new Phaser.Point,
                i.drag_scroll_rect_pos_ = new Phaser.Point,
                i
            }
            return __extends(t, s),
            t.prototype.isDragging = function() {
                return null != this.gestures_ && this.gestures_.isDragging
            }
            ,
            t.prototype.isMin = function() {
                return this.position_ == n.kHorizontal ? this.area_rect_.x >= this.area_view_rect_.x : this.position_ != n.kVertical || this.area_rect_.y >= this.area_view_rect_.y
            }
            ,
            t.prototype.isMax = function() {
                return this.position_ == n.kHorizontal ? this.area_rect_.right <= this.area_view_rect_.right : this.position_ != n.kVertical || this.area_rect_.bottom <= this.area_view_rect_.bottom
            }
            ,
            t.prototype.isFull = function() {
                return this.position_ == n.kHorizontal ? this.area_rect_.width <= this.area_view_rect_.width : this.position_ != n.kVertical || this.area_rect_.height <= this.area_view_rect_.height
            }
            ,
            t.prototype.getScrollRectRef = function() {
                return this.scroll_rect_
            }
            ,
            t.prototype.setView = function(t, e, i, s) {
                this.view_rect_.x == t && this.view_rect_.y == e && this.view_rect_.width == i && this.view_rect_.height == s || (this.view_rect_.setTo(t, e, i, s),
                this.calcScrollRect())
            }
            ,
            t.prototype.setArea = function(t, e, i, s) {
                this.area_rect_.x == t && this.area_rect_.y == e && this.area_rect_.width == i && this.area_rect_.height == s || (this.area_rect_.setTo(t, e, i, s),
                this.calcScrollRect())
            }
            ,
            t.prototype.setAreaView = function(t, e, i, s) {
                this.area_view_rect_.x == t && this.area_view_rect_.y == e && this.area_view_rect_.width == i && this.area_view_rect_.height == s || (this.area_view_rect_.setTo(t, e, i, s),
                this.calcScrollRect())
            }
            ,
            t.prototype.setViewFromRect = function(t) {
                this.view_rect_.equals(t) || (this.view_rect_.copyFrom(t),
                this.calcScrollRect())
            }
            ,
            t.prototype.setAreaFromRect = function(t) {
                this.area_rect_.equals(t) || (this.area_rect_.copyFrom(t),
                this.calcScrollRect())
            }
            ,
            t.prototype.setAreaViewFromRect = function(t) {
                this.area_view_rect_.equals(t) || (this.area_view_rect_.copyFrom(t),
                this.calcScrollRect())
            }
            ,
            t.prototype.getAreaRef = function() {
                return this.area_rect_
            }
            ,
            t.prototype.customDispose = function() {
                null != this.gestures_ && (this.gestures_.sg_drag_begin.remove(this.onDragBegin, this),
                this.gestures_.sg_dragging.remove(this.onDragging, this),
                this.gestures_.sg_drag_end.remove(this.onDragEnd, this),
                this.gestures_ = null),
                this.view_rect_ = null,
                this.area_rect_ = null,
                this.area_view_rect_ = null,
                this.scroll_rect_ = null,
                this.drag_pos_ = null,
                this.drag_scroll_rect_pos_ = null,
                s.prototype.customDispose.call(this)
            }
            ,
            t.prototype.calcScrollRect = function() {
                this.position_ == n.kHorizontal && this.calcHorizontalScrollRect(),
                this.position_ == n.kVertical && this.calcVerticalScrollRect(),
                null != this.gestures_ && this.gestures_.rectangle.copyFrom(this.scroll_rect_)
            }
            ,
            t.prototype.calcVerticalScrollRect = function() {
                this.scroll_rect_.setTo(this.view_rect_.x, 0, this.view_rect_.width, 0);
                var t = this.area_view_rect_.height
                  , e = this.area_rect_.height;
                e < t && (e = t),
                this.scroll_rect_.height = this.view_rect_.height * (t / e),
                this.scroll_rect_.y = this.view_rect_.y + this.scroll_rect_.height * ((this.area_view_rect_.y - this.area_rect_.y) / this.area_view_rect_.height),
                this.scroll_rect_.top < this.view_rect_.top && (this.scroll_rect_.top = this.view_rect_.top),
                this.scroll_rect_.bottom > this.view_rect_.bottom && (this.scroll_rect_.bottom = this.view_rect_.bottom),
                this.scroll_rect_.height < this.kMinSize && (this.scroll_rect_.height = this.kMinSize,
                this.scroll_rect_.y < this.view_rect_.y && (this.scroll_rect_.y = this.view_rect_.y),
                this.scroll_rect_.bottom > this.view_rect_.bottom && (this.scroll_rect_.y = this.view_rect_.bottom - this.kMinSize))
            }
            ,
            t.prototype.calcHorizontalScrollRect = function() {
                this.scroll_rect_.setTo(0, this.view_rect_.y, 0, this.view_rect_.height);
                var t = this.area_view_rect_.width
                  , e = this.area_rect_.width;
                e < t && (e = t),
                this.scroll_rect_.width = this.view_rect_.width * (t / e),
                this.scroll_rect_.x = this.view_rect_.x + this.scroll_rect_.width * ((this.area_view_rect_.x - this.area_rect_.x) / this.area_view_rect_.width),
                this.scroll_rect_.left < this.view_rect_.left && (this.scroll_rect_.left = this.view_rect_.left),
                this.scroll_rect_.right > this.view_rect_.right && (this.scroll_rect_.right = this.view_rect_.right),
                this.scroll_rect_.width < this.kMinSize && (this.scroll_rect_.width = this.kMinSize,
                this.scroll_rect_.x < this.view_rect_.x && (this.scroll_rect_.x = this.view_rect_.x),
                this.scroll_rect_.right > this.view_rect_.right && (this.scroll_rect_.x = this.view_rect_.right - this.kMinSize))
            }
            ,
            t.prototype.updateDrag = function(t, e) {
                if (this.position_ == n.kVertical) {
                    this.scroll_rect_.y = this.drag_scroll_rect_pos_.y - (this.drag_pos_.y - e),
                    this.scroll_rect_.y < this.view_rect_.y && (this.scroll_rect_.y = this.view_rect_.y),
                    this.scroll_rect_.bottom > this.view_rect_.bottom && (this.scroll_rect_.y = this.view_rect_.bottom - this.scroll_rect_.height);
                    var i = this.view_rect_.height - this.scroll_rect_.height;
                    0 < i && (this.area_rect_.y = this.area_view_rect_.y - (this.scroll_rect_.y - this.view_rect_.y) / i * (this.area_rect_.height - this.area_view_rect_.height))
                }
                if (this.position_ == n.kHorizontal) {
                    this.scroll_rect_.x = this.drag_scroll_rect_pos_.x - (this.drag_pos_.x - t),
                    this.scroll_rect_.x < this.view_rect_.x && (this.scroll_rect_.x = this.view_rect_.x),
                    this.scroll_rect_.right > this.view_rect_.right && (this.scroll_rect_.x = this.view_rect_.right - this.scroll_rect_.width);
                    var s = this.view_rect_.width - this.scroll_rect_.width;
                    0 < s && (this.area_rect_.x = this.area_view_rect_.x - (this.scroll_rect_.x - this.view_rect_.x) / s * (this.area_rect_.width - this.area_view_rect_.width))
                }
            }
            ,
            t.prototype.onDragBegin = function(t, e, i) {
                this.drag_pos_.setTo(e, i),
                this.drag_scroll_rect_pos_.setTo(this.scroll_rect_.x, this.scroll_rect_.y)
            }
            ,
            t.prototype.onDragging = function(t, e, i) {
                this.updateDrag(e, i)
            }
            ,
            t.prototype.onDragEnd = function(t, e, i) {
                this.updateDrag(e, i),
                this.calcScrollRect()
            }
            ,
            t
        }(s.core.IsfDisposableObject);
        t.ScrollBar = i
    }(s.gui || (s.gui = {}))
}(Framework || (Framework = {})),
function(t) {
    var e = function() {
        function t(t, e, i, s) {
            this.game = null,
            this.mScrollGroup = null,
            this.viewRect = null,
            this.startY = 0,
            this.gestures = null,
            this.scroll_bar_gestures = null,
            this.dragArea = null,
            this.scrollBar = null,
            this.disabled_ = !1,
            this.testGraphics1 = null,
            this.testGraphicsStaticGroup = null,
            this.game = t,
            this.mScrollGroup = e,
            this.mMobileScrollBar = s,
            this.startY = this.mScrollGroup.y,
            this.viewRect = i,
            this.gestures = new Framework.gui.Gestures(this.viewRect),
            this.dragArea = new Framework.gui.DragArea(this.gestures,this.viewRect.width,this.viewRect.height),
            this.dragArea.use_inertia(!0),
            this.dragArea.set_elastic(!0),
            this.dragArea.setWidth(this.mScrollGroup.width),
            this.dragArea.setHeight(this.mScrollGroup.height + 20),
            this.initScrollBar(),
            this.updateScrollBar(0),
            this.game.input.addMoveCallback(this.onTouchMove, this),
            this.game.input.onDown.add(this.onTouchDown, this),
            this.game.input.onUp.add(this.onTouchUp, this)
        }
        return Object.defineProperty(t.prototype, "disabled", {
            get: function() {
                return this.disabled_
            },
            set: function(t) {
                this.disabled_ = t
            },
            enumerable: !0,
            configurable: !0
        }),
        t.prototype.update = function(t) {
            this.disabled_ || (this.updateScrollBar(t),
            this.gestures.process(t),
            this.dragArea.process(t),
            this.mScrollGroup.y = this.startY + this.dragArea.getY())
        }
        ,
        t.prototype.reset = function() {
            this.mScrollGroup.y = this.startY,
            this.gestures.reset(),
            this.scroll_bar_gestures.reset(),
            this.dragArea.reset()
        }
        ,
        t.prototype.resize = function(t) {
            this.viewRect = t,
            this.gestures.resize(this.viewRect),
            this.scrollBar.setViewFromRect(new Phaser.Rectangle(this.mMobileScrollBar.viewRect.x,this.mMobileScrollBar.viewRect.y,this.mMobileScrollBar.viewRect.width,this.mMobileScrollBar.viewRect.height)),
            this.dragArea.resize(this.viewRect.width, this.viewRect.height),
            this.dragArea.setWidth(this.mScrollGroup.width),
            this.dragArea.setHeight(this.mScrollGroup.height + 20)
        }
        ,
        t.prototype.isDragging = function() {
            return this.gestures.isDragging
        }
        ,
        t.prototype.isSwipeScrolling = function() {
            return this.dragArea.isSwipeScrolling()
        }
        ,
        t.prototype.initScrollBar = function() {
            this.scroll_bar_gestures = new Framework.gui.Gestures(new Phaser.Rectangle(this.mMobileScrollBar.viewRect.x,this.mMobileScrollBar.viewRect.y,this.mMobileScrollBar.viewRect.width,this.mMobileScrollBar.viewRect.height)),
            this.scrollBar = new Framework.gui.ScrollBar(this.scroll_bar_gestures,Framework.gui.Position.kVertical),
            this.scrollBar.setViewFromRect(this.mMobileScrollBar.viewRect)
        }
        ,
        t.prototype.updateScrollBar = function(t) {
            this.scroll_bar_gestures.process(t),
            this.scrollBar.isDragging() ? (this.dragArea.set_disabled(!0),
            this.mScrollGroup.y = this.scrollBar.getAreaRef().y,
            this.dragArea.setY(this.scrollBar.getAreaRef().y - this.startY)) : (this.dragArea.disabled() && this.dragArea.set_disabled(!1),
            this.scrollBar.setAreaFromRect(new Phaser.Rectangle(this.mScrollGroup.x,this.mScrollGroup.y,this.mScrollGroup.width,this.mScrollGroup.height + 20)),
            this.scrollBar.setAreaViewFromRect(new Phaser.Rectangle(this.viewRect.x,this.viewRect.y,this.viewRect.width,this.viewRect.height)));
            var e = this.scrollBar.getScrollRectRef();
            this.mMobileScrollBar.scrollBarMove.y = e.y,
            this.mMobileScrollBar.scrollBarMove.height = e.height
        }
        ,
        t.prototype.onTouchDown = function() {
            this.disabled_ || (this.gestures.addChange(this.game.input.worldX, this.game.input.worldY, 1, -1),
            this.scroll_bar_gestures.addChange(this.game.input.worldX, this.game.input.worldY, 1, -1))
        }
        ,
        t.prototype.onTouchUp = function() {
            this.disabled_ || (this.gestures.addChange(this.game.input.worldX, this.game.input.worldY, -1, 1),
            this.scroll_bar_gestures.addChange(this.game.input.worldX, this.game.input.worldY, -1, 1))
        }
        ,
        t.prototype.onTouchMove = function(t, e, i) {
            this.disabled_ || (this.gestures.addChange(this.game.input.worldX, this.game.input.worldY, -1, -1),
            this.scroll_bar_gestures.addChange(this.game.input.worldX, this.game.input.worldY, -1, -1))
        }
        ,
        t.prototype.testCreateGraphicsGroup = function(t) {
            void 0 === t && (t = null);
            var e = this.game.add.group();
            return null != t && t.add(e),
            e
        }
        ,
        t.prototype.testCreateGraphics = function(t) {
            void 0 === t && (t = null);
            var e = this.game.add.graphics(0, 0);
            return null != t && t.add(e),
            e
        }
        ,
        t.prototype.testGraphicsClear = function(t) {
            t.clear()
        }
        ,
        t.prototype.testGraphicsDrawRectangle = function(t, e, i, s) {
            t.beginFill(i, s),
            t.drawRect(e.x, e.y, e.width, e.height),
            t.endFill()
        }
        ,
        t
    }();
    t.MobileScrollManager = e
}(Components || (Components = {})),
function(t) {
    var e = function() {
        function t(t, e) {
            this.KEY = "atlas",
            this.game = t,
            this.viewRect_ = e,
            this.scrollBarGroup = t.add.group(),
            this.createScrollBar(),
            this.resizeScrollBar()
        }
        return Object.defineProperty(t.prototype, "viewRect", {
            get: function() {
                return this.viewRect_
            },
            enumerable: !0,
            configurable: !0
        }),
        t.prototype.reset = function() {}
        ,
        t.prototype.resize = function(t) {
            this.viewRect_ = t,
            this.resizeScrollBar()
        }
        ,
        t.prototype.createScrollBar = function() {
            this.scrollBarBack = this.game.add.sprite(0, 0, this.KEY, "flcontrols.png"),
            this.scrollBarGroup.add(this.scrollBarBack),
            this.scrollBarMove = new Phaser.Sprite(this.game,0,0,GameAPI.scrollbitmapdata.texture),
            this.scrollBarGroup.add(this.scrollBarMove)
        }
        ,
        t.prototype.resizeScrollBar = function() {
            this.scrollBarBack.x = this.viewRect_.x,
            this.scrollBarBack.y = this.viewRect_.y,
            this.scrollBarBack.width = this.viewRect_.width,
            this.scrollBarBack.height = this.viewRect_.height,
            this.scrollBarMove.x = this.viewRect_.x,
            this.scrollBarMove.y = this.viewRect_.y,
            this.scrollBarMove.width = this.viewRect_.width
        }
        ,
        t
    }();
    t.MobileWndScrollBar = e
}(Components || (Components = {})),
function(t) {
    var e = function() {
        function t(t, e, i, s, n) {
            if (this.game = null,
            this.gesturesRect_ = null,
            this.scrollbarGesturesRect_ = null,
            this.scrollRect_ = null,
            this.scrollBarRect_ = null,
            this.gestures = null,
            this.scroll_bar_gestures = null,
            this.dragArea = null,
            this.scrollBar = null,
            this.disabled_ = !1,
            this.isMobileDevice = !1,
            this.testGraphics1 = null,
            this.testGraphics2 = null,
            this.game = t,
            this.gesturesRect_ = e,
            this.scrollbarGesturesRect_ = i,
            this.scrollRect_ = s,
            this.scrollBarRect_ = n,
            this.isMobileDevice = Services.isMobile(),
            this.gestures = new Framework.gui.Gestures(this.gesturesRect_),
            this.gestures.sg_dragging.add(this.onGesturesDragging, this),
            this.dragArea = new Framework.gui.DragArea(this.gestures,this.gesturesRect_.width,this.gesturesRect_.height),
            this.dragArea.use_inertia(this.isMobileDevice),
            this.dragArea.set_elastic(this.isMobileDevice),
            this.dragArea.setWidth(this.scrollRect_.width),
            this.dragArea.setHeight(this.scrollRect_.height),
            this.initScrollBar(),
            this.updateScrollBar(0),
            this.sg_dragging_ = new Phaser.Signal,
            this.game.input.addMoveCallback(this.onTouchMove, this),
            this.game.input.onDown.add(this.onTouchDown, this),
            this.game.input.onUp.add(this.onTouchUp, this),
            !this.isMobileDevice) {
                var r = document.getElementById("content");
                r.addEventListener("mousewheel", this.onMouseWheel.bind(this), !1),
                r.addEventListener("DOMMouseScroll", this.onMouseWheel.bind(this), !1)
            }
        }
        return Object.defineProperty(t.prototype, "disabled", {
            get: function() {
                return this.disabled_
            },
            set: function(t) {
                this.disabled_ = t
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "sg_dragging", {
            get: function() {
                return this.sg_dragging_
            },
            enumerable: !0,
            configurable: !0
        }),
        t.prototype.update = function(t) {
            this.disabled_ || (this.updateScrollBar(t),
            this.isMobileDevice && this.gestures.process(t),
            this.dragArea.process(t),
            this.scrollRect_.y = this.dragArea.getY())
        }
        ,
        t.prototype.updateScrollSize = function() {
            this.dragArea.setWidth(this.scrollRect_.width),
            this.dragArea.setHeight(this.scrollRect_.height)
        }
        ,
        t.prototype.reset = function() {
            this.scrollRect_.y = 0,
            this.gestures.reset(),
            this.scroll_bar_gestures.reset(),
            this.dragArea.reset()
        }
        ,
        t.prototype.resize = function(t, e) {
            this.gesturesRect_ = t,
            this.scrollbarGesturesRect_ = e,
            this.gestures.resize(this.gesturesRect_),
            this.scrollBar.setViewFromRect(new Phaser.Rectangle(this.scrollbarGesturesRect_.x,this.scrollbarGesturesRect_.y,this.scrollbarGesturesRect_.width,this.scrollbarGesturesRect_.height)),
            this.dragArea.resize(this.gesturesRect_.width, this.gesturesRect_.height),
            this.dragArea.setWidth(this.scrollRect_.width),
            this.dragArea.setHeight(this.scrollRect_.height)
        }
        ,
        t.prototype.isDragging = function() {
            return this.gestures.isDragging
        }
        ,
        t.prototype.isSwipeScrolling = function() {
            return this.dragArea.isSwipeScrolling()
        }
        ,
        t.prototype.isHighSpeedScrolling = function() {
            return this.dragArea.isHighSpeed()
        }
        ,
        t.prototype.dispose = function() {
            this.sg_dragging_.dispose(),
            this.dragArea.dispose(),
            this.scrollBar.dispose(),
            this.gestures.dispose(),
            this.scroll_bar_gestures.dispose()
        }
        ,
        t.prototype.initScrollBar = function() {
            this.scroll_bar_gestures = new Framework.gui.Gestures(new Phaser.Rectangle(this.scrollbarGesturesRect_.x,this.scrollbarGesturesRect_.y,this.scrollbarGesturesRect_.width,this.scrollbarGesturesRect_.height)),
            this.scrollBar = new Framework.gui.ScrollBar(this.scroll_bar_gestures,Framework.gui.Position.kVertical),
            this.scrollBar.setViewFromRect(new Phaser.Rectangle(this.scrollbarGesturesRect_.x,this.scrollbarGesturesRect_.y,this.scrollbarGesturesRect_.width,this.scrollbarGesturesRect_.height))
        }
        ,
        t.prototype.updateScrollBar = function(t) {
            this.scroll_bar_gestures.process(t),
            this.scrollBar.isDragging() ? (this.dragArea.set_disabled(!0),
            this.scrollRect_.y = this.scrollBar.getAreaRef().y,
            this.dragArea.setY(this.scrollBar.getAreaRef().y)) : (this.dragArea.disabled() && this.dragArea.set_disabled(!1),
            this.scrollBar.setAreaFromRect(new Phaser.Rectangle(this.scrollRect_.x,this.scrollRect_.y,this.scrollRect_.width,this.scrollRect_.height)),
            this.scrollBar.setAreaViewFromRect(new Phaser.Rectangle(0,0,this.gesturesRect_.width,this.gesturesRect_.height)));
            var e = this.scrollBar.getScrollRectRef();
            this.scrollBarRect_.copyFrom(e)
        }
        ,
        t.prototype.onTouchDown = function() {
            this.disabled_ || (this.isMobileDevice && this.gestures.addChange(this.game.input.worldX, this.game.input.worldY, 1, -1),
            this.scroll_bar_gestures.addChange(this.game.input.worldX, this.game.input.worldY, 1, -1))
        }
        ,
        t.prototype.onTouchUp = function() {
            this.disabled_ || (this.isMobileDevice && this.gestures.addChange(this.game.input.worldX, this.game.input.worldY, -1, 1),
            this.scroll_bar_gestures.addChange(this.game.input.worldX, this.game.input.worldY, -1, 1))
        }
        ,
        t.prototype.onTouchMove = function(t, e, i) {
            this.disabled_ || (this.isMobileDevice && this.gestures.addChange(this.game.input.worldX, this.game.input.worldY, -1, -1),
            this.scroll_bar_gestures.addChange(this.game.input.worldX, this.game.input.worldY, -1, -1))
        }
        ,
        t.prototype.onGesturesDragging = function(t, e, i) {
            this.sg_dragging_.dispatch(this)
        }
        ,
        t.prototype.onMouseWheel = function(t) {
            if (!this.disabled_) {
                var e = this.game.input.worldX
                  , i = this.game.input.worldY
                  , s = t.wheelDelta
                  , n = 1;
                this.gesturesRect_.contains(e, i) && (s < 0 && (n = -1),
                this.dragArea.setY(this.dragArea.getY() + 30 * n))
            }
        }
        ,
        t.prototype.testCreateGraphics = function(t) {
            void 0 === t && (t = null);
            var e = this.game.add.graphics(0, 0);
            return null != t && t.add(e),
            e
        }
        ,
        t.prototype.testGraphicsClear = function(t) {
            t.clear()
        }
        ,
        t.prototype.testGraphicsDrawRectangle = function(t, e, i, s) {
            t.beginFill(i, s),
            t.drawRect(e.x, e.y, e.width, e.height),
            t.endFill()
        }
        ,
        t
    }();
    t.MobileWndScrollManager = e
}(Components || (Components = {}));
var Fabrique, Constants = function() {
    function t() {}
    return t.GAME_SCALE = 1,
    t.CALCULATED_WIDTH = 0,
    t.CALCULATED_HEIGHT = 0,
    t.GAME_WIDTH = 720,
    t.GAME_HEIGHT = 1280,
    t.LANDSCAPE_LOCKED = !1,
    t.PORTRAIT_LOCKED = !0,
    t.GAME_KEY = "5aa52e6bca06302614f89e243a0196f7",
    t.SECRET_KEY = "d71cfa6bab9700886b7d99a8d8819e70d39e7342",
    t.GOOGLE_ID = "UA-122764416-7",
    t.GOOGLE_APP_NAME = "Grindcraft Remastered",
    t.GAME_DISTRIBUTION_ID = "ba9eba4f79f947c9a57921eb06d75cac",
    t.GAME_DISTRIBUTION_USER = "",
    t.SPLASH_BACKGROUND = 11119017,
    t.SPLASH_IMAGE = "",
    t.SPLASH_URL = "",
    t.MORE_GAMES_URL = "",
    t.GAME_TITLE = "grindcraft-remastered",
    t
}();
!function(n) {
    var r, t;
    (t = r || (r = {})).PAUSED = "Paused",
    t.RESUMED = "Resumed";
    var e = function() {
        function t() {
            this.contentStatus = r.RESUMED
        }
        return t.getInstance = function() {
            return t.instance || (t.instance = new t),
            t.instance
        }
        ,
        t.prototype.init = function() {
            var t = new h5ads.GameDistribution("ba9eba4f79f947c9a57921eb06d75cac");
            h5ads.adWrapper.setAdProvider(t),
            window.hasOwnProperty("fbrqSA") && !0 === window.fbrqSA && (h5branding.Utils.ASSET_LOCATION = "assets/")
        }
        ,
        t.prototype.showAd = function(t, e, i) {
            var s = this;
            n.LoaderHelper.show(),
            h5ads.adWrapper.once(h5ads.AdEvents.CONTENT_PAUSED, function() {
                n.LoaderHelper.hide(),
                h5branding.google.sendScreenView("advertisement_" + t),
                i && i.call(s),
                s.contentStatus = r.PAUSED
            }),
            h5ads.adWrapper.once(h5ads.AdEvents.CONTENT_RESUMED, function() {
                n.LoaderHelper.hide(),
                h5ads.adWrapper.removeAllListeners(h5ads.AdEvents.CONTENT_PAUSED),
                h5ads.adWrapper.removeAllListeners(h5ads.AdEvents.CONTENT_RESUMED),
                s.contentStatus = r.RESUMED,
                e && e.call(s)
            }),
            h5ads.adWrapper.showAd(h5ads.AdType.interstitial)
        }
        ,
        t.prototype.isAdPlaying = function() {
            return this.contentStatus === r.PAUSED
        }
        ,
        t
    }();
    n.AdHandler = e
}(Fabrique || (Fabrique = {})),
function(t) {
    var e = function() {
        function t() {}
        return t.show = function() {
            var t = document.getElementById("loader");
            t && (t.style.display = "block")
        }
        ,
        t.hide = function() {
            var t = document.getElementById("loader");
            t && (t.style.display = "none")
        }
        ,
        t
    }();
    t.LoaderHelper = e
}(Fabrique || (Fabrique = {})),
function(t) {
    var e = function() {
        function e(t) {
            this.game = t,
            this.focused = !0
        }
        return e.getInstance = function(t) {
            return e.instance || (e.instance = new e(t)),
            e.instance
        }
        ,
        e.prototype.init = function() {
            var t = this;
            this.game.stage.disableVisibilityChange = !0,
            this.onPauseCallback = new Phaser.Signal,
            h5branding.Utils.isOnDevice() && (document.addEventListener("pause", function() {
                return t.onPause()
            }),
            document.addEventListener("resume", function() {
                return t.onResume()
            })),
            this.game.onBlur.add(this.onBlur, this),
            this.game.onFocus.add(this.onFocus, this),
            this.game.onPause.add(this.onPause, this),
            this.game.onResume.add(this.onResume, this)
        }
        ,
        e.prototype.onBlur = function() {
            this.focused = !1,
            this.game.onPause.dispatch()
        }
        ,
        e.prototype.onFocus = function() {
            this.focused = !0,
            t.AdHandler.getInstance().isAdPlaying() || this.game.onResume.dispatch()
        }
        ,
        e.prototype.onPause = function() {
            this.game.sound.setMute(),
            this.onPauseCallback && this.onPauseCallback.dispatch()
        }
        ,
        e.prototype.onResume = function() {
            this.game.sound.unsetMute()
        }
        ,
        e.prototype.pause = function() {
            this.game.onPause.dispatch()
        }
        ,
        e.prototype.resume = function() {
            this.hasFocus && this.game.onResume.dispatch()
        }
        ,
        Object.defineProperty(e.prototype, "hasFocus", {
            get: function() {
                return this.focused
            },
            enumerable: !0,
            configurable: !0
        }),
        e
    }();
    t.PauseHandler = e
}(Fabrique || (Fabrique = {})),
function(t) {
    var e = function() {
        function t() {
            var r, t, o, e, i, a, s = this;
            this.apiKey = "udScJ4r9ocMJckepQnYkQ",
            this.recurringError = [],
            r = window,
            t = document,
            o = "rg4js",
            r.RaygunObject = o,
            r[o] = r[o] || function() {
                (r[o].o = r[o].o || []).push(arguments)
            }
            ,
            e = t.createElement("script"),
            i = t.getElementsByTagName("script")[0],
            e.async = 1,
            e.src = "",
            i.parentNode.insertBefore(e, i),
            a = r.onerror,
            r.onerror = function(t, e, i, s, n) {
                a && a(t, e, i, s, n),
                n || (n = new Error(t)),
                r[o].q = r[o].q || [],
                r[o].q.push({
                    e: n
                })
            }
            ,
            rg4js("apiKey", this.apiKey),
            rg4js("enableCrashReporting", !0),
            rg4js("setVersion", version),
            rg4js("options", {
                ignore3rdPartyErrors: !0
            }),
            rg4js("onBeforeSend", function(t) {
                return s.filterError(t)
            }),
            rg4js("enablePulse", !1)
        }
        return t.getInstance = function() {
            return null === t.instance && (t.instance = new t),
            t.instance
        }
        ,
        t.prototype.filterError = function(t) {
            if (void 0 !== t && t.Details && t.Details.Error && t.Details.Error.Message) {
                if (-1 !== this.recurringError.indexOf(t.Details.Error.Message))
                    return !1;
                this.recurringError.push(t.Details.Error.Message)
            }
            return t
        }
        ,
        t.instance = null,
        t
    }();
    t.RayGun = e
}(Fabrique || (Fabrique = {}));
var Managers, AchievementsListItem = function() {
    this.text = "",
    this.nameSprite = "",
    this.isSave = !1,
    this.isEffect = !1,
    this.isNew = !1
}, AchievementsList = function() {
    function t(t) {
        this.game = null,
        this.list_ = null,
        this.sg_list_update_ = null,
        this.game = t,
        this.list_ = [],
        this.sg_list_update_ = new Phaser.Signal
    }
    return Object.defineProperty(t.prototype, "list", {
        get: function() {
            return this.list_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_list_update", {
        get: function() {
            return this.sg_list_update_
        },
        enumerable: !0,
        configurable: !0
    }),
    t.prototype.addItem = function(t, e, i, s, n, r) {
        void 0 === r && (r = !0);
        var o = new AchievementsListItem;
        o.text = t,
        o.nameSprite = e,
        o.isSave = i,
        o.isEffect = s,
        o.isNew = n,
        this.list_.push(o),
        r && this.sg_list_update_.dispatch(this, o)
    }
    ,
    t
}(), MobileAchievements = function() {
    function n(t, e, i, s) {
        this.sender = t,
        this.game = t.game,
        this.count = s,
        this.parentGroup = e,
        this.effectsGroup = i,
        this.disabled_ = !1,
        this.wndWidth = 417,
        this.wndHeight = 580,
        this.frameMaskOffsetTop = 63,
        this.frameMaskOffsetBottom = 11,
        this.scrollBarSize = 20,
        this.slidePanelWidth = 215,
        this.slidePanelHeight = 27,
        this.slidingMode = n.SLIDING_HIDE_MODE,
        this.slidingTime = .4,
        this.slidingUpWaitTime = 1,
        this.slidingTween = null,
        this.slideUpWaitTimer = null,
        this.resetNewAchFlag = !1,
        this.mainGroup = this.game.add.group(),
        this.windowGroup = this.game.add.group(),
        this.slidePanelGroup = this.game.add.group(),
        this.effectWndGroup = this.game.add.group(),
        this.viewFrameGroup = this.game.add.group(),
        this.scrollGroup = this.game.add.group(),
        this.frameMaskRect = new Phaser.Rectangle(0,0,0,0),
        this.gesturesRect = new Phaser.Rectangle(0,0,0,0),
        this.scrollBarGesturesRect = new Phaser.Rectangle(0,0,0,0),
        this.scrollRect = new Phaser.Rectangle(0,0,100,100),
        this.scrollBarRect = new Phaser.Rectangle(0,0,100,100),
        this.parentGroup.add(this.mainGroup),
        this.effectsGroup.add(this.effectWndGroup),
        this.ach_list = new AchievementsList(this.game),
        this.sg_hide_ = new Phaser.Signal
    }
    return Object.defineProperty(n.prototype, "sg_hide", {
        get: function() {
            return this.sg_hide_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(n.prototype, "disabled", {
        get: function() {
            return this.disabled_
        },
        set: function(t) {
            this.disabled_ = t
        },
        enumerable: !0,
        configurable: !0
    }),
    n.prototype.createWindow = function() {
        var t = this;
        this.mainGroup.x = -this.wndWidth / 2,
        this.mainGroup.y = -this.wndHeight / 2;
        var e = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgpause.png");
        e.width = this.wndWidth,
        e.height = this.wndHeight,
        e.anchor.setTo(.5, .5),
        e.x = this.wndWidth / 2,
        e.y = this.wndHeight / 2,
        e.inputEnabled = !0,
        this.windowGroup.add(e);
        var i = GameAPI.createText(this.game, this.wndWidth / 2, 26.5, "grincraftstroke25zheltyi", "achievements", 30, 16766720);
        this.windowGroup.add(i),
        this.closeButton = this.sender.createBasicButton(this.wndWidth - 35, 27, "close.png", !0, this.windowGroup, function() {
            t.hide()
        }),
        this.calcFrameMaskRect();
        var s = this.game.make.graphics(0, 0);
        s.beginFill(16777215, .4),
        s.drawRect(this.frameMaskRect.x, this.frameMaskRect.y, this.frameMaskRect.width, this.frameMaskRect.height),
        s.endFill(),
        this.viewFrameGroup.mask = s,
        this.scrollGroup.y = this.frameMaskOffsetTop,
        this.viewFrameGroup.add(this.scrollGroup),
        this.scrollBar = new Components.MobileWndScrollBar(this.game,new Phaser.Rectangle(this.wndWidth - this.scrollBarSize,this.frameMaskOffsetTop,this.scrollBarSize,this.wndHeight - this.frameMaskOffsetTop - this.frameMaskOffsetBottom)),
        this.viewFrameGroup.add(this.scrollBar.scrollBarGroup),
        this.calcGesturesRect(),
        this.calcScrollBarGesturesRect(),
        this.scrollMgr = new Components.MobileWndScrollManager(this.game,this.gesturesRect,this.scrollBarGesturesRect,this.scrollRect,this.scrollBarRect),
        this.slidePanelImg = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "ach_panel.png"),
        this.slidePanelImg.height = 27,
        this.slidePanelGroup.add(this.slidePanelImg),
        this.slidePanelText = GameAPI.createText(this.game, 0, 0, "grincraftstroke25zheltyi", "new_achievement", 18, 16766720),
        this.slidePanelText.x = (this.slidePanelImg.width - 27) / 2 + 25,
        this.slidePanelText.y = this.slidePanelImg.height / 2,
        this.slidePanelGroup.add(this.slidePanelText),
        this.slidePanelGroup.y = -this.slidePanelHeight,
        this.effectWndGroup.add(this.slidePanelGroup),
        this.mainGroup.add(this.windowGroup),
        this.mainGroup.add(this.viewFrameGroup)
    }
    ,
    n.prototype.update = function(t) {
        this.disabled_ || (this.scrollMgr.update(t),
        this.scrollGroup.y = this.frameMaskOffsetTop + this.scrollRect.y,
        this.scrollBar.scrollBarMove.y = this.scrollBarRect.y - (this.parentGroup.y + this.mainGroup.y),
        this.scrollBar.scrollBarMove.height = this.scrollBarRect.height)
    }
    ,
    n.prototype.resize = function() {
        this.effectWndGroup.x = this.game.width / 2 - this.slidePanelWidth / 2,
        this.scrollMgr.reset(),
        this.calcGesturesRect(),
        this.calcScrollBarGesturesRect(),
        this.calcFrameMaskRect();
        var t = this.game.make.graphics(0, 0);
        t.beginFill(16777215, .4),
        t.drawRect(this.frameMaskRect.x, this.frameMaskRect.y, this.frameMaskRect.width, this.frameMaskRect.height),
        t.endFill(),
        this.viewFrameGroup.mask = t,
        this.scrollMgr.resize(this.gesturesRect, this.scrollBarGesturesRect)
    }
    ,
    n.prototype.hide = function(t) {
        void 0 === t && (t = !0),
        this.mainGroup.visible = !1,
        this.scrollMgr.disabled = !0,
        t && this.sg_hide_.dispatch(this)
    }
    ,
    n.prototype.show = function() {
        this.mainGroup.visible = !0,
        this.scrollMgr.disabled = !1,
        this.ach_list.list.forEach(function(t) {
            t.isNew = !1
        }, this)
    }
    ,
    n.prototype.showPanel = function() {
        this.slidingMode == n.SLIDING_SHOW_MODE ? this.startSlideUpWaitTimer() : this.slidePanelDown(this.startSlideUpWaitTimer)
    }
    ,
    n.prototype.isVisible = function() {
        return this.mainGroup.visible
    }
    ,
    n.prototype.setAchievementsList = function(t) {
        this.ach_list = t
    }
    ,
    n.prototype.updateInfo = function() {
        this.scrollGroup.removeAll(!0),
        this.scrollRect.width = 0;
        var t = this.scrollRect.height = 0
          , e = 0;
        for (t = this.ach_list.list.length - 1; 0 <= t; t--) {
            var i = this.ach_list.list[t]
              , s = this.createAchievement(i.text, i.nameSprite, i.isSave, i.isEffect, i.isNew);
            s.y += e,
            this.scrollGroup.add(s),
            e += 96
        }
        this.scrollRect.width = this.scrollGroup.width,
        this.scrollRect.height = this.scrollGroup.height + 30,
        this.scrollMgr.updateScrollSize()
    }
    ,
    n.prototype.addNewAchievement = function(t, e, i, s) {
        if (void 0 === i && (i = !0),
        void 0 === s && (s = !0),
        null != Managers.GameManager.save.achievementGrind && s) {
            var n = Managers.GameManager.save.achievementGrind.split(",")
              , r = 0;
            for (r = 0; r < n.length; ++r)
                if (e == n[r])
                    return
        }
        if (this.sender.menu.showNewAchievementsIcon(),
        this.showPanel(),
        Managers.GameManager.save.achievementGrind += e + ",",
        this.ach_list.addItem(t, e, i, s, !0),
        i) {
            var o = new AchievementInfo;
            o.text = t,
            o.sprite = e,
            Managers.GameManager.save.achievement.push(o),
            -1 !== version.indexOf("cheetah") && h5ads.adWrapper.provider.uploadScore(Managers.GameManager.save.achievement.length)
        }
    }
    ,
    n.prototype.createAchievement = function(t, e, i, s, n) {
        return void 0 === i && (i = !0),
        void 0 === s && (s = !0),
        void 0 === n && (n = !1),
        this.addAchievement(t, e, s, n)
    }
    ,
    n.prototype.slidePanelDown = function(t) {
        void 0 === t && (t = null),
        this.slidingMode = n.SLIDING_SHOW_MODE,
        this.stopPanelSliding(),
        this.slidingTween = this.game.add.tween(this.slidePanelGroup),
        this.slidingTween.to({
            y: 0
        }, Phaser.Timer.SECOND * this.slidingTime),
        null != t && this.slidingTween.onComplete.add(t, this),
        this.slidingTween.start()
    }
    ,
    n.prototype.slidePanelUp = function(t) {
        void 0 === t && (t = null),
        this.slidingMode = n.SLIDING_HIDE_MODE,
        this.stopPanelSliding(),
        this.slidingTween = this.game.add.tween(this.slidePanelGroup),
        this.slidingTween.to({
            y: -this.slidePanelHeight
        }, Phaser.Timer.SECOND * this.slidingTime),
        null != t && this.slidingTween.onComplete.add(t, this),
        this.slidingTween.start()
    }
    ,
    n.prototype.startSlideUpWaitTimer = function() {
        var t = this;
        this.stopSlideUpWaitTimer(),
        this.slideUpWaitTimer = this.game.time.events.add(Phaser.Timer.SECOND * this.slidingUpWaitTime, function() {
            t.slidePanelUp()
        }, this)
    }
    ,
    n.prototype.stopSlideUpWaitTimer = function() {
        null != this.slideUpWaitTimer && (this.slideUpWaitTimer.timer.remove(this.slideUpWaitTimer),
        this.slideUpWaitTimer = null)
    }
    ,
    n.prototype.stopPanelSliding = function() {
        null != this.slidingTween && (this.slidingTween.onComplete.removeAll(),
        this.slidingTween.stop(),
        this.slidingTween = null)
    }
    ,
    n.prototype.calcFrameMaskRect = function() {
        this.frameMaskRect.x = this.parentGroup.x + this.mainGroup.x,
        this.frameMaskRect.y = this.parentGroup.y + this.mainGroup.y + this.frameMaskOffsetTop,
        this.frameMaskRect.width = this.wndWidth,
        this.frameMaskRect.height = this.wndHeight - this.frameMaskOffsetTop - this.frameMaskOffsetBottom
    }
    ,
    n.prototype.calcGesturesRect = function() {
        this.gesturesRect.x = this.parentGroup.x + this.mainGroup.x,
        this.gesturesRect.y = this.parentGroup.y + this.mainGroup.y + this.frameMaskOffsetTop,
        this.gesturesRect.width = this.wndWidth - this.scrollBarSize,
        this.gesturesRect.height = this.wndHeight - this.frameMaskOffsetTop - this.frameMaskOffsetBottom
    }
    ,
    n.prototype.calcScrollBarGesturesRect = function() {
        this.scrollBarGesturesRect.x = this.parentGroup.x + this.mainGroup.x + this.wndWidth - this.scrollBarSize,
        this.scrollBarGesturesRect.y = this.parentGroup.y + this.mainGroup.y + this.frameMaskOffsetTop,
        this.scrollBarGesturesRect.width = this.scrollBarSize,
        this.scrollBarGesturesRect.height = this.wndHeight - this.frameMaskOffsetTop - this.frameMaskOffsetBottom
    }
    ,
    n.prototype.addAchievement = function(t, e, i, s) {
        var n = this.game.add.group();
        n.x = 25,
        n.y = 15;
        var r = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgach.png");
        r.anchor.setTo(.5, .5),
        r.width = 348,
        r.height = 81,
        r.x = 174,
        r.y = 40.5,
        n.add(r);
        var o = GameAPI.createText(this.game, 0, 0, "grincraft25stroke_shadow_white", t, 18, 16766720, !1);
        o.x = 212.5,
        o.y = 40.5,
        n.add(o);
        var a = this.game.add.sprite(0, 0, Managers.GameManager.KEY, e);
        if (a.anchor.setTo(.5, .5),
        a.x = 38,
        a.y = 37,
        n.add(a),
        s) {
            var h = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgach_shine.png");
            h.width = 348,
            h.height = 81,
            n.add(h)
        }
        return n
    }
    ,
    n.SLIDING_HIDE_MODE = 0,
    n.SLIDING_SHOW_MODE = 1,
    n
}(), MobileRoller = function() {
    function t(t, e) {
        this.game = t,
        this.stepsCount_ = e,
        this.pos_ = 0,
        this.rollerGroup = this.game.add.group(),
        this.createRoller(),
        this.pos_dx_ = this.control.width / 2,
        this.bar_width_ = this.bkgControl.width - this.control.width,
        this.step_ = this.bar_width_ / this.stepsCount_,
        this.setControlPosition(this.pos_),
        this.count_ = this.getCountFromPos(this.pos_)
    }
    return Object.defineProperty(t.prototype, "count", {
        get: function() {
            return this.count_
        },
        set: function(t) {
            this.count_ = t,
            this.pos_ = this.getPositionFromCount(this.count_),
            this.setControlPosition(this.pos_)
        },
        enumerable: !0,
        configurable: !0
    }),
    t.prototype.minus = function() {
        this.pos_ -= this.step_,
        this.pos_ <= 0 && (this.pos_ = 0),
        this.setControlPosition(this.pos_),
        this.count_ = this.getCountFromPos(this.pos_)
    }
    ,
    t.prototype.plus = function() {
        this.pos_ += this.step_,
        this.pos_ >= this.bar_width_ && (this.pos_ = this.bar_width_),
        this.setControlPosition(this.pos_),
        this.count_ = this.getCountFromPos(this.pos_)
    }
    ,
    t.prototype.createRoller = function() {
        this.bkgControl = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "slider_bar.png"),
        this.bkgControl.anchor.setTo(.5, .5),
        this.bkgControl.width = 191,
        this.bkgControl.height = 15,
        this.rollerGroup.add(this.bkgControl);
        var t = this.game.add.group();
        t.x = -this.bkgControl.width / 2,
        this.control = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "slider_button.png"),
        this.control.anchor.setTo(.5, 1),
        this.control.width = 38,
        this.control.height = 20,
        this.control.y = 7.5,
        t.add(this.control),
        this.rollerGroup.add(t)
    }
    ,
    t.prototype.setControlPosition = function(t) {
        this.control.x = this.pos_dx_ + t
    }
    ,
    t.prototype.getCountFromPos = function(t) {
        return Math.round(100 * t / this.bar_width_)
    }
    ,
    t.prototype.getPositionFromCount = function(t) {
        return this.bar_width_ * t / 100
    }
    ,
    t
}(), AdTimer = function() {
    function t(t) {
        this.timerLimit = 120,
        this.game = t
    }
    return t.prototype.setDefaultTimer = function() {
        var t = this.getTimer();
        if (null === t || "undefined" === t) {
            this.setTimer({
                storedTime: 0,
                isRunning: !1
            })
        }
    }
    ,
    t.prototype.setTimer = function(t) {
        this.game.storage.setItem("adTimer", JSON.stringify(t))
    }
    ,
    t.prototype.getTimer = function() {
        return this.game.storage.getItem("adTimer")
    }
    ,
    t.prototype.startTimer = function() {
        this.timeThen = Date.now();
        var t = {
            storedTime: this.timeThen,
            isRunning: !0
        };
        this.setTimer(t)
    }
    ,
    t.prototype.calculateElapsedTime = function(t) {
        this.timeNow = Date.now();
        var e = new Date(t.storedTime);
        e.setTime(e.getTime());
        var i = (this.timeNow - e) / 1e3;
        return Math.round(i)
    }
    ,
    t.prototype.isTimerDone = function() {
        var t = this.getTimer();
        if (null === t || "undefined" === t)
            return !0;
        var e = JSON.parse(t)
          , i = this.calculateElapsedTime(e);
        return !!(e.isRunning && i >= this.timerLimit) || !e.isRunning
    }
    ,
    t
}(), CraftInfoRequiredItem = function() {
    this.count = 0,
    this.nameSprite = " "
}, CraftInfoItem = function() {
    function t() {
        this.requiredItems = [],
        this.reset()
    }
    return t.prototype.reset = function() {
        this.name = " ",
        this.message = " ",
        this.resetRequiredItems()
    }
    ,
    t.prototype.addRequiredItem = function(t, e) {
        void 0 === e && (e = 0);
        var i = new CraftInfoRequiredItem;
        i.count = e,
        i.nameSprite = t,
        this.requiredItems.push(i)
    }
    ,
    t.prototype.resetRequiredItems = function() {
        0 < this.requiredItems.length && this.requiredItems.splice(0, this.requiredItems.length)
    }
    ,
    t
}(), MobileCraftItem = function() {
    function t(t, e, i, s, n, r, o, a) {
        this.sender = t,
        this.game = e,
        this.mainGrinds = i,
        this.mainGrinders = s,
        this.mainCrafters = n,
        this.widthItem = r,
        this.heightItem = o,
        this.worldItems = a,
        this.isMerge = !0,
        this.isAchievement = !1,
        this.isCraft = !1,
        this.isHover = !1,
        this._count = 0,
        this.countAutocraft = 0,
        this.timerAutocraft = null,
        this.tapsCounter = 0,
        this.tapsCounterLimit = 1,
        this.contentDragFlag = !1,
        this.infoItem = new CraftInfoItem,
        this.selected_ = !1,
        this.isLightRed_ = !1,
        this.isLightGreen_ = !1,
        this.isTapEnabled_ = !1,
        this.sg_hover_ = new Phaser.Signal,
        this.sg_hover_out_ = new Phaser.Signal,
        this.sg_touch_down_ = new Phaser.Signal,
        this.sg_touch_up_ = new Phaser.Signal,
        this.sg_auto_down_ = new Phaser.Signal,
        this.adTimer = new AdTimer(this.game)
    }
    return Object.defineProperty(t.prototype, "count", {
        get: function() {
            return this._count
        },
        set: function(t) {
            (this._count = t) < 1 ? this.countText.visible = !1 : (t < 1e5 && this.countText.setText(Math.floor(t).toString()),
            1e5 < t && this.countText.setText("99999"),
            this.countText.y = this.bckblack.height / 2 - .2 * this.bckblack.height,
            this.countText.x = this.bckblack.width / 2 - this.countText.width / 2 - this.bckblack.width / 2 * .1,
            this.countText.visible = this.isMerge),
            this.sender.craft.updateCraftItemInfo()
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_hover", {
        get: function() {
            return this.sg_hover_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_hover_out", {
        get: function() {
            return this.sg_hover_out_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_touch_down", {
        get: function() {
            return this.sg_touch_down_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_touch_up", {
        get: function() {
            return this.sg_touch_up_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_auto_down", {
        get: function() {
            return this.sg_auto_down_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "selected", {
        get: function() {
            return this.selected_
        },
        set: function(t) {
            this.selected_ = t,
            this.checkSelectedState()
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "isTapEnabled", {
        get: function() {
            return this.isTapEnabled_
        },
        enumerable: !0,
        configurable: !0
    }),
    t.prototype.createCube = function(t, e, i, s) {
        var n = this.game.add.group();
        this.frameBack = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgcraft.png"),
        this.frameBack.anchor.setTo(.5, .5),
        this.frameBack.width = this.widthItem,
        this.frameBack.height = this.heightItem,
        n.add(this.frameBack),
        this.bckblack = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "btnDown.png"),
        this.bckblack.anchor.setTo(.5, .5),
        this.bckblack.width = this.widthItem - 4,
        this.bckblack.height = this.heightItem - 4,
        n.add(this.bckblack),
        this.bckred = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "red_light.png"),
        this.bckred.anchor.setTo(.5, .5),
        this.bckred.width = this.widthItem - 4,
        this.bckred.height = this.heightItem - 4,
        this.bckred.visible = !1,
        n.add(this.bckred),
        this.bckgreen = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "green_light.png"),
        this.bckgreen.anchor.setTo(.5, .5),
        this.bckgreen.width = this.widthItem - 4,
        this.bckgreen.height = this.heightItem - 4,
        this.bckgreen.visible = !1,
        n.add(this.bckgreen),
        this.bckgray = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "btnUp.png"),
        this.bckgray.anchor.setTo(.5, .5),
        this.bckgray.width = this.widthItem - 4,
        this.bckgray.height = this.heightItem - 4,
        this.bckgray.visible = !1,
        n.add(this.bckgray),
        this.bckredup = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "red_light_up.png"),
        this.bckredup.anchor.setTo(.5, .5),
        this.bckredup.width = this.widthItem - 4,
        this.bckredup.height = this.heightItem - 4,
        this.bckredup.visible = !1,
        n.add(this.bckredup),
        this.bckgreenup = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "green_light_up.png"),
        this.bckgreenup.anchor.setTo(.5, .5),
        this.bckgreenup.width = this.widthItem - 4,
        this.bckgreenup.height = this.heightItem - 4,
        this.bckgreenup.visible = !1,
        n.add(this.bckgreenup),
        this.sprite = this.game.add.sprite(0, 0, Managers.GameManager.KEY, t[3]),
        this.sprite.anchor.setTo(.5, .5),
        this.sprite.smoothed = !1;
        var r = 1;
        if (this.sender.isMobileDevice && (r = .7),
        this.sprite.scale.setTo(r, r),
        n.add(this.sprite),
        this.sender.isMobileDevice ? this.countText = GameAPI.createText(this.game, 0, 0, "grincraftstroke12white", "", 11) : this.countText = GameAPI.createText(this.game, 0, 0, "grincraftstroke12white", "", 12),
        n.add(this.countText),
        this.countadd = +t[2].split("=")[1],
        this.count = i,
        this.spriteFrame = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "shine.png"),
        this.spriteFrame.anchor.setTo(.5, .5),
        this.spriteFrame.width = this.widthItem - 4,
        this.spriteFrame.height = this.heightItem - 4,
        this.spriteFrame.visible = !1,
        n.add(this.spriteFrame),
        this.spriteTouch = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "coub.png"),
        this.spriteTouch.anchor.setTo(.5, .5),
        this.spriteTouch.width = this.widthItem - 4,
        this.spriteTouch.height = this.heightItem - 4,
        this.spriteTouch.alpha = 0,
        this.spriteTouch.inputEnabled = !0,
        this.spriteTouch.events.onInputOver.add(this.onItemHover, this),
        this.spriteTouch.events.onInputOut.add(this.onItemHoverOut, this),
        this.spriteTouch.events.onInputDown.add(this.onItemTouchDown, this),
        this.spriteTouch.events.onInputUp.add(this.onItemTouchUp, this),
        n.add(this.spriteTouch),
        this.name = t[2].split("=")[0],
        this.infoItem.name = this.name,
        this.itemsForCraft = t[0].split(","),
        this.eternalItemsForCraft = t[1].split(","),
        (1 == this.eternalItemsForCraft.length && null == this.eternalItemsForCraft[0] || "nothing" == this.eternalItemsForCraft[0] || "" == this.eternalItemsForCraft[0]) && (this.eternalItemsForCraft = []),
        "nothing" == this.itemsForCraft[0].split("=")[0] && (this.itemsForCraft = [],
        0 < this.eternalItemsForCraft.length && (this.eternalItemsForCraft = [this.eternalItemsForCraft[0]])),
        0 < this.eternalItemsForCraft.length)
            for (var o = this.eternalItemsForCraft[0].split(" ")[1], a = 1; a < this.eternalItemsForCraft.length; ++a)
                if (2 == this.eternalItemsForCraft[a].split(" ").length && this.eternalItemsForCraft[a].split(" ")[1] == o) {
                    this.eternalItemsForCraft = [this.eternalItemsForCraft[0]];
                    break
                }
        return this.hint = t[8],
        this.path = t[3],
        this.ability = t[7].split(","),
        this.tag = t[4],
        this.achievement = t[6],
        this.infoItem.message = this.hint,
        this.isAchievement = s,
        this.group = n,
        "nothing=0" != t[0] || "navigateToUrl " == t[7].substring(0, 14) || this.isMerge || (this.group.visible = !1),
        e.add(n),
        this.worldItems.push(this),
        n
    }
    ,
    t.prototype.resizeCube = function(t, e) {
        this.widthItem = t,
        this.heightItem = e,
        this.group.width = this.widthItem,
        this.group.height = this.heightItem
    }
    ,
    t.prototype.createAbility = function() {
        var r = this;
        if ("nothing" != this.ability[0]) {
            var o = 1
              , t = 0
              , a = 0;
            this.itemsForCraft.forEach(function(t) {
                var e = t.split("=");
                r.worldItems.forEach(function(t) {
                    t.name != e[0] || (o = t.count)
                }, r)
            }, this);
            var e = function() {
                if ("automate " == h.ability[t].substring(0, 9)) {
                    var e = h.ability[0].substring(9);
                    h.sender.grindsLogic.grinds.forEach(function(t) {
                        if (GameAPI.getName(t.type) == e) {
                            if (!t.isAutocraft && 0 != r.count) {
                                for (t.isAutocraft = !0,
                                a = 0; a < r.sender.grindsLogic.grinds.length; ++a)
                                    r.sender.grindsLogic.grinds[a].addItem();
                                t.worker = r,
                                t.onDownGrind(t.material),
                                r.sender.hideGrind()
                            }
                            if (null != t.worker && "hunter" == t.worker.name && "butcher" == r.name) {
                                for (t.isAutocraft = !0,
                                a = 0; a < r.sender.grindsLogic.grinds.length; ++a)
                                    r.sender.grindsLogic.grinds[a].addItem();
                                (t.worker = r).sender.hideGrind()
                            }
                        }
                    }, h),
                    h.changeAbility()
                }
                if ("deautomate " == h.ability[t].substring(0, 11)) {
                    var i = h.ability[0].substring(11);
                    h.sender.grindsLogic.grinds.forEach(function(t) {
                        if (GameAPI.getName(t.type) == i && t.isAutocraft && 0 == o) {
                            if (null != t.worker && "butcher" == t.worker.name && 0 != r.sender.worldItems[33].count)
                                return void (t.worker = r.sender.worldItems[33]);
                            if (null != t.worker && "butcher" == t.worker.name && 0 == r.sender.worldItems[33].count && 0 != r.sender.worldItems[36].count)
                                return;
                            t.isAutocraft = !1,
                            t.worker = null,
                            r.sender.hideGrind()
                        }
                    }, h)
                }
                if ("autocraft " == h.ability[t].substring(0, 10) && 0 != h.count) {
                    var s = h.ability[t].substring(10).split("=");
                    null == s && (s = [h.ability[0].substring(10)]),
                    h.worldItems.forEach(function(t) {
                        if (t.name == s[0]) {
                            var e = void 0;
                            e = 1 != s.length ? +s[1] : .5,
                            t.countAutocraft = r.count,
                            null == t.timerAutocraft && t.startAutocraft(e)
                        }
                    }, h),
                    h.changeAbility()
                }
                if ("deautocraft " == h.ability[t].substring(0, 12)) {
                    var n = h.ability[t].substring(12);
                    h.worldItems.forEach(function(t) {
                        t.name == n && null != t.timerAutocraft && (t.countAutocraft--,
                        t.countAutocraft <= 0 && (r.game.time.events.remove(t.timerAutocraft),
                        t.timerAutocraft = null))
                    }, h)
                }
                "mapActive" != h.ability[t] || h.sender.isMapEnabled || (h.sender.isMapEnabled = !0,
                Managers.GameManager.save.mapVisible = !0),
                "markMap" == h.ability[t].substring(0, 7) && (h.sender.createBeat("check_the_map", "ok", !0, function() {
                    r.sender.createBeat("beat_city_state", "ok", !0)
                }),
                Managers.GameManager.save.isOpenNextLevel = !0,
                h.sender.worldMap.showNextMarker()),
                "beatGame" == h.ability[t].substring(0, 8) && h.sender.createBeat("beat_grindcraft", "ok", !0),
                "beatLocation" == h.ability[t].substring(0, 12) && "Chasm Mine" == h.sender.gameLevel && h.sender.createBeat("beat_chasm_mine", "ok", !0)
            }
              , h = this;
            for (t = 0; t < this.ability.length; ++t)
                e()
        }
    }
    ,
    t.prototype.lightRed = function() {
        this.resetLight(),
        this.isLightRed_ = !0,
        this.checkLightRedState()
    }
    ,
    t.prototype.lightGreen = function() {
        this.resetLight(),
        this.isLightGreen_ = !0,
        this.checkLightGreenState()
    }
    ,
    t.prototype.resetLight = function() {
        this.bckred.visible = !1,
        this.bckredup.visible = !1,
        this.bckgreen.visible = !1,
        this.bckgreenup.visible = !1,
        this.isLightRed_ = !1,
        this.isLightGreen_ = !1
    }
    ,
    t.prototype.setTapEnabled = function(t) {
        this.isTapEnabled_ = t,
        this.checkTapEnabledState(),
        this.checkLightRedState(),
        this.checkLightGreenState()
    }
    ,
    t.prototype.makeTapOnItem = function() {
        this.onDownItem(null, null, null)
    }
    ,
    t.prototype.dispose = function() {
        this.sg_hover_.dispose(),
        this.sg_hover_out_.dispose(),
        this.sg_touch_down_.dispose(),
        this.sg_touch_up_.dispose(),
        this.sg_auto_down_.dispose()
    }
    ,
    t.prototype.checkLightRedState = function() {
        this.isLightRed_ && (this.bckgray.visible ? this.bckredup.visible = !0 : this.bckred.visible = !0)
    }
    ,
    t.prototype.checkLightGreenState = function() {
        this.isLightGreen_ && (this.bckgray.visible ? this.bckgreenup.visible = !0 : this.bckgreen.visible = !0)
    }
    ,
    t.prototype.checkTapEnabledState = function() {
        this.bckblack.visible = !this.isTapEnabled_,
        this.bckgray.visible = this.isTapEnabled_
    }
    ,
    t.prototype.changeAbility = function() {
        var t = 0;
        for (t = 0; t < Managers.GameManager.save.countItem.length; ++t)
            if (this.name == Managers.GameManager.save.countItem[t].name) {
                Managers.GameManager.save.countItem[t].ability = !0;
                break
            }
    }
    ,
    t.prototype.onDownItem = function(t, e, i, s) {
        var n = this;
        if (void 0 === s && (s = !1),
        0 != this.bckgray.visible && !this.sender.isGamePaused && !this.sender.isClick) {
            this.itemsForCraft.forEach(function(t) {
                var i = t.split("=");
                n.worldItems.forEach(function(t) {
                    t.name == i[0] && (t.count -= +i[1],
                    t.count)
                }, n),
                n.sender.inventoryItems.forEach(function(t, e) {
                    if (t.name == i[0])
                        return t.count -= +i[1],
                        void (t.count < 1 && (t.group.destroy(),
                        n.sender.inventoryItems.splice(e, 1),
                        n.sender.resetInventory()))
                }, n)
            }, this),
            this.worldItems.forEach(function(t) {
                n.name == t.name && (t.count += n.countadd)
            }, this),
            this.sender.resetCubes(),
            this.sender.grindsLogic.resetGrids(this);
            var r = !0;
            this.sender.inventoryItems.forEach(function(t) {
                if (n.name == t.name)
                    return t.count += n.countadd,
                    void (r = !1)
            }, this),
            r && 1 <= this.count && (this.sender.createInventoryItem(this.name, this.count, this.path),
            this.sender.resetInventory()),
            this.sender.grindsLogic.addMaterials(this),
            this.createAbility(),
            this.isAchievement || "nothing" == this.achievement || "" == this.achievement || null == this.achievement || (this.isAchievement = !0,
            this.checkAdInterval(),
            this.sender.mobileAchievements.addNewAchievement(this.achievement, this.path)),
            "" != this.tag && "nothing" != this.tag && Managers.GameManager.music.addSound(this.name, this.tag)
        }
    }
    ,
    t.prototype.checkAdInterval = function() {
        this.adTimer.isTimerDone() && (this.adTimer.startTimer(),
        Fabrique.AdHandler.getInstance().showAd("gameplay", function() {
            h5branding.google.sendScreenView("gameplay")
        }))
    }
    ,
    t.prototype.startAutocraft = function(i) {
        var s = this;
        this.timerAutocraft = this.game.time.events.add(i * Phaser.Timer.SECOND, function(t) {
            var e = t[0];
            s.onDownItem(e.sprite, null, null),
            s.sg_auto_down_.dispatch(s),
            s.startAutocraft(i)
        }, this, [this])
    }
    ,
    t.prototype.checkSelectedState = function() {
        this.spriteFrame.visible = this.selected_
    }
    ,
    t.prototype.onItemHover = function(t, e, i) {
        this.sg_hover_.dispatch(this, [e])
    }
    ,
    t.prototype.onItemHoverOut = function(t, e, i) {
        this.sg_hover_out_.dispatch(this, [e])
    }
    ,
    t.prototype.onItemTouchDown = function(t, e, i) {
        this.sg_touch_down_.dispatch(this, [e])
    }
    ,
    t.prototype.onItemTouchUp = function(t, e, i) {
        this.sg_touch_up_.dispatch(this, [e])
    }
    ,
    t
}(), Craft = function() {
    function t(t, e, i, s, n, r, o, a, h) {
        this.sender = t,
        this.game = e,
        this.parentGroup = i,
        this.mainGrinds = s,
        this.mainGrinders = n,
        this.mainCrafters = r,
        this.cubeOriginalWidth = o,
        this.cubeOriginalHeight = a,
        this.worldItems = h,
        this.isMobileDevice = Services.isMobile(),
        this.disabled_ = !1,
        this.selectedCraftItem_ = null,
        this.touchDownCraftItem_ = null,
        this.timerHover = null,
        this.leftOffset = 0,
        this.rightOffset = 0,
        this.topOffset = 0,
        this.bottomOffset = 0,
        this.isTouchDown = !1,
        this.touchMeterFlag = !1,
        this.touchUpEnabledFlag = !0,
        this.touchStartY = 0,
        this.touchDistance = 0,
        this.touchDistanceMax = 0,
        this.touchDistanceLimit = 20,
        this.isMobileDevice ? this.scrollBarOriginalSize = 5 : this.scrollBarOriginalSize = 15,
        this.scrollBarSize = this.scrollBarOriginalSize,
        this.cubeWidth = this.cubeOriginalWidth,
        this.cubeHeight = this.cubeOriginalHeight,
        this.cubeOriginalIndention = 10,
        this.cubeIndention = this.cubeOriginalIndention,
        this.craftFrameRect_ = new Phaser.Rectangle(0,0,0,0),
        this.craftMaskFrameRect = new Phaser.Rectangle(0,0,0,0),
        this.frameScrollBarRect = new Phaser.Rectangle(0,0,0,0),
        this.gesturesRect = new Phaser.Rectangle(0,0,0,0),
        this.scrollBarGesturesRect = new Phaser.Rectangle(0,0,0,0),
        this.scrollRect = new Phaser.Rectangle(0,0,100,100),
        this.scrollBarRect = new Phaser.Rectangle(0,0,100,100),
        this.mainGroup = this.game.add.group(),
        this.windowGroup = this.game.add.group(),
        this.itemsGroup = this.game.add.group(),
        this.scrollGroup = this.game.add.group(),
        this.mainGroup.add(this.windowGroup),
        this.mainGroup.add(this.itemsGroup),
        this.parentGroup.add(this.mainGroup),
        this.game.input.addMoveCallback(this.onTouchMove, this),
        this.game.input.onDown.add(this.onTouchDown, this),
        this.game.input.onUp.add(this.onTouchUp, this),
        this.sg_craft_selected_item_changed_ = new Phaser.Signal
    }
    return Object.defineProperty(t.prototype, "disabled", {
        get: function() {
            return this.disabled_
        },
        set: function(t) {
            this.disabled_ = t,
            this.scrollMgr.disabled = this.disabled_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "selectedCraftItem", {
        get: function() {
            return this.selectedCraftItem_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_craft_selected_item_changed", {
        get: function() {
            return this.sg_craft_selected_item_changed_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "craftFrameRect", {
        get: function() {
            return this.craftFrameRect_
        },
        enumerable: !0,
        configurable: !0
    }),
    t.prototype.create = function() {
        this.createTitle(),
        this.createBack(),
        this.createItems(),
        this.createScroll(),
        this.createCoverLines()
    }
    ,
    t.prototype.update = function(t) {
        this.disabled_ || (this.scrollMgr.update(t),
        this.scrollGroup.y = this.scrollRect.y + 3,
        this.scrollBar.scrollBarMove.y = this.scrollBarRect.y - this.itemsGroup.y,
        this.scrollBar.scrollBarMove.width = this.scrollBarSize,
        this.scrollBar.scrollBarMove.height = this.scrollBarRect.height)
    }
    ,
    t.prototype.resize = function() {
        this.windowGroup.x = 10,
        this.windowGroup.y = 10,
        this.calcCraftFrameOffsets(),
        this.isMobileDevice ? this.resizeCubesMobile() : this.resizeCubesDesktop(),
        this.calcCraftFrameRect(),
        this.replaceCubes(),
        this.resetCubes(),
        ScaleManager.orientation == ScaleManager.ORIENTATION_PORTRAIT ? (this.titleText.x = this.titleText.width / 2 + 2,
        this.itemsGroup.x = this.game.width / 2 - (this.scrollGroup.width + 10 + this.scrollBarSize) / 2) : (this.titleText.x = this.titleText.width / 2 + 2 + this.leftOffset,
        this.itemsGroup.x = (this.game.width - this.leftOffset - this.rightOffset) / 2 + this.leftOffset - (this.scrollGroup.width + 10 + this.scrollBarSize) / 2),
        this.itemsGroup.y = this.topOffset,
        this.bkgCraft.width = this.scrollGroup.width + 10 + this.scrollBarSize,
        this.bkgCraft.height = this.craftFrameRect_.height,
        this.bkgCraftCoverTopLine.width = this.bkgCraft.width + this.scrollBarSize,
        this.bkgCraftCoverBottomLine.y = this.craftFrameRect_.height - this.bkgCraftCoverBottomLine.height,
        this.bkgCraftCoverBottomLine.width = this.bkgCraft.width + this.scrollBarSize,
        this.calcCraftMaskFrameRect(),
        this.calcFrameScrollBarRect(),
        this.calcGesturesRect(),
        this.calcScrollBarGesturesRect(),
        this.updateScrollRectSize(),
        this.applyCraftFrameMask(),
        this.resizeScroll()
    }
    ,
    t.prototype.replaceCubes = function() {
        var t = 0
          , e = 5
          , i = 5
          , s = this.cubeWidth / 2
          , n = this.cubeHeight / 2
          , r = this.game.width - this.leftOffset - this.rightOffset - this.scrollBarSize - 5;
        for (t = 0; t < this.worldItems.length; t++)
            null != this.worldItems[t].itemsForCraft[0] || this.sender.isMerge ? this.worldItems[t].group.visible = !0 : this.worldItems[t].group.visible = !1,
            0 != this.worldItems[t].group.visible && (this.worldItems[t].isMerge = this.sender.isMerge,
            this.worldItems[t].count = this.worldItems[t].count,
            this.worldItems[t].group.x = e + s,
            this.worldItems[t].group.y = i + n,
            (e += this.cubeWidth) + this.cubeWidth > r && (i += this.cubeHeight,
            e = 5))
    }
    ,
    t.prototype.resetCubes = function() {
        var e = this;
        this.worldItems.forEach(function(t) {
            e.resetCube(t)
        }, this)
    }
    ,
    t.prototype.unselectSelectedItem = function() {
        null != this.selectedCraftItem_ && (this.selectedCraftItem_.selected = !1,
        this.selectedCraftItem_ = null,
        this.resetCraftItemsLight())
    }
    ,
    t.prototype.dispose = function() {
        this.worldItems.forEach(function(t) {
            t.dispose()
        }, this),
        this.sg_craft_selected_item_changed_.dispose(),
        this.scrollMgr.dispose()
    }
    ,
    t.prototype.createTitle = function() {
        this.titleText = GameAPI.createText(this.game, 0, 0, "grindcraft", "craft", 15, 16777215),
        this.titleText.x = this.titleText.width / 2 + 2,
        this.titleText.y = this.titleText.height / 2 + 3,
        this.windowGroup.add(this.titleText)
    }
    ,
    t.prototype.createBack = function() {
        this.bkgCraft = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgcraft.png"),
        this.itemsGroup.add(this.bkgCraft)
    }
    ,
    t.prototype.createItems = function() {
        var i = this;
        this.itemsGroup.add(this.scrollGroup);
        var n = 0
          , r = this.mainCrafters.split(";")
          , t = function() {
            var e = r[n].split(":");
            if ("navigateToUrl " == e[7].substring(0, 14))
                return "continue";
            var i = 0
              , s = !1;
            Managers.GameManager.save.countItem.forEach(function(t) {
                if (t.name == e[2].split("=")[0])
                    return i = t.count,
                    void (s = t.isAchievement)
            }, o);
            var t = new MobileCraftItem(o.sender,o.game,o.mainGrinds,o.mainGrinders,o.mainCrafters,o.cubeWidth,o.cubeHeight,o.worldItems);
            t.tapsCounterLimit = o.isMobileDevice ? 2 : 1,
            o.isMobileDevice || (t.sg_hover.add(o.onCraftItemHover, o),
            t.sg_hover_out.add(o.onCraftItemHoverOut, o)),
            t.sg_touch_down.add(o.onCraftItemTouchDown, o),
            t.sg_touch_up.add(o.onCraftItemTouchUp, o),
            t.sg_auto_down.add(o.onCraftItemAutoDown, o),
            t.createCube(e, o.scrollGroup, i, s)
        }
          , o = this;
        for (n = 0; n < r.length; n++)
            t();
        var e = function() {
            var e = !1;
            Managers.GameManager.save.countItem.forEach(function(t) {
                t.name != i.worldItems[n].name || (e = t.ability)
            }, s),
            e && s.worldItems[n].createAbility()
        }
          , s = this;
        for (n = 0; n < this.worldItems.length; ++n)
            e();
        this.resetCubes()
    }
    ,
    t.prototype.createScroll = function() {
        this.scrollBar = new Components.MobileWndScrollBar(this.game,new Phaser.Rectangle(0,0,this.scrollBarSize,100)),
        this.itemsGroup.add(this.scrollBar.scrollBarGroup),
        this.scrollMgr = new Components.MobileWndScrollManager(this.game,this.gesturesRect,this.scrollBarGesturesRect,this.scrollRect,this.scrollBarRect),
        this.scrollMgr.sg_dragging.add(this.onScrollManagerDragging, this)
    }
    ,
    t.prototype.createCoverLines = function() {
        this.bkgCraftCoverTopLine = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgcraft_coverline.png"),
        this.bkgCraftCoverBottomLine = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgcraft_coverline.png"),
        this.itemsGroup.add(this.bkgCraftCoverTopLine),
        this.itemsGroup.add(this.bkgCraftCoverBottomLine)
    }
    ,
    t.prototype.resetCube = function(i) {
        var s = !1
          , n = 0;
        for (n = 0; n < i.eternalItemsForCraft.length; ++n)
            this.worldItems.forEach(function(t) {
                i.eternalItemsForCraft[n] == t.name && 1 <= t.count && (s = !0)
            }, this);
        if (0 == i.eternalItemsForCraft.length && (s = !0),
        s) {
            var t = function() {
                s = !1;
                var e = i.itemsForCraft[n].split("=");
                if (r.worldItems.forEach(function(t) {
                    t.name == e[0] && t.count >= +e[1] && (s = !0)
                }, r),
                0 == s)
                    return "break"
            }
              , r = this;
            for (n = 0; n < i.itemsForCraft.length; ++n) {
                if ("break" === t())
                    break
            }
            0 == i.itemsForCraft.length && (s = !1),
            i.setTapEnabled(s)
        } else
            i.setTapEnabled(!1)
    }
    ,
    t.prototype.resizeCubesDesktop = function() {}
    ,
    t.prototype.resizeCubesMobile = function() {
        var t, e, i = this, s = ScaleManager.dpr, n = window.innerWidth, r = window.innerHeight, o = n * s, a = r * s, h = (ScaleManager.orientation == ScaleManager.ORIENTATION_PORTRAIT ? ScaleManager.GameHeight : ScaleManager.GameWidth,
        ScaleManager.orientation == ScaleManager.ORIENTATION_PORTRAIT ? ScaleManager.GameWidth : ScaleManager.GameHeight), l = ScaleManager.scale, c = this.cubeOriginalWidth, d = c * s, u = 0, p = 0, g = 0;
        this.scrollBarSize = this.scrollBarOriginalSize / l,
        p = ScaleManager.orientation == ScaleManager.ORIENTATION_PORTRAIT ? (u = h,
        g = o - this.scrollBarOriginalSize,
        u - this.leftOffset - this.rightOffset - this.scrollBarSize - 10) : (g = a,
        (u = h) - this.topOffset - this.bottomOffset - 10),
        t = Math.floor(g / d),
        e = Math.floor(p / t),
        this.cubeWidth = e,
        this.cubeHeight = e,
        this.worldItems.forEach(function(t) {
            t.resizeCube(i.cubeWidth, i.cubeHeight)
        }, this)
    }
    ,
    t.prototype.updateCraftItemInfo = function() {
        var s = this;
        if (this.resetCraftItemsLight(),
        null != this.selectedCraftItem_) {
            var n = 0
              , t = function() {
                var e = null;
                i.worldItems.forEach(function(t) {
                    s.selectedCraftItem_.eternalItemsForCraft[n] == t.name && (t.count < 1 ? t.lightRed() : t.lightGreen(),
                    null == e && (e = t.path))
                }, i),
                null != e && null != e && "nothing" != e && i.selectedCraftItem_.infoItem.addRequiredItem(e)
            }
              , i = this;
            for (n = this.selectedCraftItem_.eternalItemsForCraft.length - 1; 0 <= n; --n)
                t();
            var e = function() {
                var e = null
                  , i = null;
                r.worldItems.forEach(function(t) {
                    s.selectedCraftItem_.itemsForCraft[n].split("=")[0] == t.name && (null == e && (e = t.path),
                    i = s.selectedCraftItem_.itemsForCraft[n].split("=")[1],
                    t.count < +i ? t.lightRed() : t.lightGreen())
                }, r),
                null != e && null != e && "nothing" != e && r.selectedCraftItem_.infoItem.addRequiredItem(e, parseInt(i))
            }
              , r = this;
            for (n = this.selectedCraftItem_.itemsForCraft.length - 1; 0 <= n; --n)
                e()
        }
    }
    ,
    t.prototype.resetCraftItemsLight = function() {
        this.worldItems.forEach(function(t) {
            t.infoItem.resetRequiredItems(),
            t.resetLight()
        }, this)
    }
    ,
    t.prototype.calcCraftFrameOffsets = function() {
        if (this.topOffset = this.windowGroup.y + this.titleText.y + this.titleText.height / 2 + 4,
        ScaleManager.orientation == ScaleManager.ORIENTATION_PORTRAIT) {
            if (this.leftOffset = 10,
            this.rightOffset = 10,
            this.bottomOffset = this.sender.getPortraitMaxBottomOffset() + 15,
            !this.sender.isMerge) {
                var t = (this.game.height - this.bottomOffset - this.topOffset - 29) / 2;
                this.bottomOffset = this.game.height - (this.topOffset + t)
            }
        } else if (this.leftOffset = this.sender.getLandscapeMaxLeftOffset() + 10,
        this.rightOffset = this.sender.getLandscapeMaxRightOffset() + 10,
        this.bottomOffset = 20,
        !this.sender.isMerge) {
            var e = (this.game.width - this.rightOffset - this.leftOffset - 10) / 2;
            this.rightOffset = this.game.width - (this.leftOffset + e)
        }
    }
    ,
    t.prototype.calcCraftFrameRect = function() {
        this.craftFrameRect_.x = this.leftOffset,
        this.craftFrameRect_.y = this.topOffset,
        this.craftFrameRect_.width = this.game.width - this.rightOffset - this.leftOffset,
        this.craftFrameRect_.height = this.game.height - this.bottomOffset - this.topOffset
    }
    ,
    t.prototype.calcCraftMaskFrameRect = function() {
        this.craftMaskFrameRect.x = this.itemsGroup.x,
        this.craftMaskFrameRect.y = this.itemsGroup.y,
        this.craftMaskFrameRect.width = this.scrollGroup.width + 10 + this.scrollBarSize,
        this.craftMaskFrameRect.height = this.craftFrameRect_.height
    }
    ,
    t.prototype.calcFrameScrollBarRect = function() {
        this.frameScrollBarRect.x = this.scrollGroup.width + 10,
        this.frameScrollBarRect.y = 10,
        this.frameScrollBarRect.width = this.scrollBarSize,
        this.frameScrollBarRect.height = this.craftFrameRect_.height - 20
    }
    ,
    t.prototype.calcGesturesRect = function() {
        this.gesturesRect.x = Math.round(this.itemsGroup.x),
        this.gesturesRect.y = Math.round(this.itemsGroup.y + 10),
        this.gesturesRect.width = Math.round(this.scrollGroup.width + 10),
        this.gesturesRect.height = Math.round(this.craftFrameRect_.height - 20)
    }
    ,
    t.prototype.calcScrollBarGesturesRect = function() {
        this.scrollBarGesturesRect.x = this.itemsGroup.x + this.scrollGroup.width + 10,
        this.scrollBarGesturesRect.y = this.itemsGroup.y + 10,
        this.scrollBarGesturesRect.width = this.scrollBarSize,
        this.scrollBarGesturesRect.height = this.craftFrameRect_.height - 20
    }
    ,
    t.prototype.updateScrollRectSize = function() {
        this.scrollRect.width = this.scrollGroup.width,
        this.scrollRect.height = this.scrollGroup.height
    }
    ,
    t.prototype.applyCraftFrameMask = function() {
        var t = this.game.make.graphics(0, 0);
        t.beginFill(16777215, .4),
        t.drawRect(this.craftMaskFrameRect.x, this.craftMaskFrameRect.y, this.craftMaskFrameRect.width, this.craftMaskFrameRect.height),
        t.endFill(),
        this.itemsGroup.mask = t
    }
    ,
    t.prototype.resizeScroll = function() {
        this.scrollMgr.reset(),
        this.scrollBar.resize(this.frameScrollBarRect),
        this.scrollMgr.updateScrollSize(),
        this.scrollMgr.resize(this.gesturesRect, this.scrollBarGesturesRect)
    }
    ,
    t.prototype.startTimerHover = function(t, e) {
        this.timerHover = this.game.time.events.add(t, this.onTimerHoverRaised, this, e)
    }
    ,
    t.prototype.stopTimerHover = function() {
        null != this.timerHover && (this.game.time.events.remove(this.timerHover),
        this.timerHover = null)
    }
    ,
    t.prototype.showCraftItemHint = function(t) {
        null != this.selectedCraftItem_ && this.selectedCraftItem_ != t && (this.selectedCraftItem_.selected = !1),
        null != this.selectedCraftItem_ && this.selectedCraftItem_ == t || (this.selectedCraftItem_ = t,
        this.selectedCraftItem_.selected = !0,
        this.updateCraftItemInfo(),
        this.sg_craft_selected_item_changed_.dispatch(this))
    }
    ,
    t.prototype.hideCraftItemHint = function() {
        null != this.selectedCraftItem_ && (this.selectedCraftItem_.selected = !1,
        this.selectedCraftItem_ = null,
        this.updateCraftItemInfo(),
        this.sg_craft_selected_item_changed_.dispatch(this))
    }
    ,
    t.prototype.onTouchDown = function() {
        !this.disabled_ && this.isMobileDevice && (this.isTouchDown = !0,
        this.touchUpEnabledFlag = !0,
        this.touchStartY = this.game.input.worldY)
    }
    ,
    t.prototype.onTouchUp = function() {
        !this.disabled_ && this.isMobileDevice && this.touchMeterFlag && (this.isTouchDown = !1,
        this.touchUpEnabledFlag = this.touchDistanceMax <= this.touchDistanceLimit,
        this.touchDistance = 0,
        this.touchDistanceMax = 0)
    }
    ,
    t.prototype.onTouchMove = function(t, e, i) {
        !this.disabled_ && this.isMobileDevice && this.touchMeterFlag && this.isTouchDown && (this.touchDistance = this.game.input.worldY - this.touchStartY,
        this.touchDistanceMax = Math.max(this.touchDistanceMax, Math.abs(this.touchDistance)))
    }
    ,
    t.prototype.onCraftItemHover = function(t, e) {
        if (!this.sender.isGamePaused) {
            var i = e[0];
            this.gesturesRect.contains(Math.round(i.x), Math.round(i.y)) && (t.isHover = !0,
            this.startTimerHover(.5 * Phaser.Timer.SECOND, [t]))
        }
    }
    ,
    t.prototype.onCraftItemHoverOut = function(t, e) {
        this.sender.isGamePaused || (this.stopTimerHover(),
        t.isHover = !1,
        this.hideCraftItemHint())
    }
    ,
    t.prototype.onTimerHoverRaised = function(t) {
        this.stopTimerHover(),
        this.showCraftItemHint(t[0])
    }
    ,
    t.prototype.onCraftItemTouchDown = function(t, e) {
        if (!this.sender.isGamePaused && !this.scrollMgr.isSwipeScrolling()) {
            var i = e[0];
            this.gesturesRect.contains(i.x, i.y) && this.isMobileDevice && (this.touchDownCraftItem_ = t,
            this.touchMeterFlag = !0)
        }
    }
    ,
    t.prototype.onCraftItemTouchUp = function(t, e) {
        if (!this.sender.isGamePaused && !this.scrollMgr.isSwipeScrolling()) {
            var i = e[0];
            if (this.gesturesRect.contains(i.x, i.y))
                if (this.isMobileDevice) {
                    if (null != this.touchDownCraftItem_) {
                        var s = this.touchDownCraftItem_.contentDragFlag;
                        if (s && (this.touchDownCraftItem_.contentDragFlag = !1),
                        this.touchDownCraftItem_ = null,
                        s && this.scrollMgr.isHighSpeedScrolling())
                            return
                    }
                    if (this.touchMeterFlag = !1,
                    !this.touchUpEnabledFlag)
                        return;
                    null != this.selectedCraftItem_ && (this.selectedCraftItem_.selected = !1,
                    this.selectedCraftItem_ != t && (this.selectedCraftItem_.tapsCounter = 0)),
                    this.selectedCraftItem_ = t,
                    this.selectedCraftItem_.selected = !0,
                    this.selectedCraftItem_.isTapEnabled && (this.selectedCraftItem_.tapsCounter++,
                    this.selectedCraftItem_.tapsCounter >= this.selectedCraftItem_.tapsCounterLimit && (this.selectedCraftItem_.tapsCounter = this.selectedCraftItem_.tapsCounterLimit,
                    this.selectedCraftItem_.makeTapOnItem())),
                    this.updateCraftItemInfo(),
                    this.sg_craft_selected_item_changed_.dispatch(this)
                } else
                    t.makeTapOnItem()
        }
    }
    ,
    t.prototype.onCraftItemAutoDown = function(t) {
        null != this.selectedCraftItem_ && this.updateCraftItemInfo()
    }
    ,
    t.prototype.onScrollManagerDragging = function(t) {
        null == this.touchDownCraftItem_ || this.touchDownCraftItem_.contentDragFlag || (this.touchDownCraftItem_.contentDragFlag = !0)
    }
    ,
    t.prototype.testCreateGraphics = function(t) {
        void 0 === t && (t = null);
        var e = this.game.add.graphics(0, 0);
        return null != t && t.add(e),
        e
    }
    ,
    t.prototype.testClearGraphics = function(t) {
        t.clear()
    }
    ,
    t.prototype.testDrawRectFromRect = function(t, e, i, s) {
        void 0 === i && (i = 16777215),
        void 0 === s && (s = 1),
        this.testDrawRect(t, e.x, e.y, e.width, e.height, i, s)
    }
    ,
    t.prototype.testDrawRect = function(t, e, i, s, n, r, o) {
        void 0 === r && (r = 16777215),
        void 0 === o && (o = 1),
        t.beginFill(r, o),
        t.drawRect(e, i, s, n),
        t.endFill()
    }
    ,
    t.prototype.testDrawCircle = function(t, e, i, s, n, r) {
        void 0 === n && (n = 16777215),
        void 0 === r && (r = 1),
        t.beginFill(n, r),
        t.drawCircle(e, i, 2 * s),
        t.endFill()
    }
    ,
    t
}(), InventoryItem = function() {
    function t(t, e, i, s) {
        this.sender = t,
        this.game = e,
        this.cubeOriginalWidth = i,
        this.cubeOriginalHeight = s,
        this.cubeWidth_ = i,
        this.cubeHeight_ = s
    }
    return Object.defineProperty(t.prototype, "count", {
        get: function() {
            return this.count_
        },
        set: function(t) {
            this.count_ = t,
            null != this.countText && null != this.countText && (t < 1 ? this.countText.visible = !1 : t < 1e5 && (this.countText.setText(Math.floor(t).toString()),
            this.countText.y = this.bckblack.height / 2 - .2 * this.bckblack.height,
            this.countText.x = this.bckblack.width / 2 - this.countText.width / 2 - this.bckblack.width / 2 * .1,
            this.countText.visible = !0))
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "cubeWidth", {
        get: function() {
            return this.cubeWidth_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "cubeHeight", {
        get: function() {
            return this.cubeHeight_
        },
        enumerable: !0,
        configurable: !0
    }),
    t.prototype.createCube = function(t, e, i, s, n) {
        var r = this.game.add.group();
        this.name = i,
        this.path = n,
        this.frameBack = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgcraft.png"),
        this.frameBack.anchor.setTo(.5, .5),
        this.frameBack.width = this.cubeWidth_,
        this.frameBack.height = this.cubeHeight_,
        r.add(this.frameBack),
        this.bckblack = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "btnDown.png"),
        this.bckblack.anchor.setTo(.5, .5),
        this.bckblack.width = this.cubeWidth_ - 5,
        this.bckblack.height = this.cubeHeight_ - 5,
        r.add(this.bckblack),
        this.sprite = this.game.add.sprite(0, 0, Managers.GameManager.KEY, this.path),
        this.sprite.anchor.setTo(.5, .5);
        var o = .7;
        return this.sender.isMobileDevice || (o = .9),
        this.sprite.scale.setTo(o, o),
        r.add(this.sprite),
        this.sender.isMobileDevice ? this.countText = GameAPI.createText(this.game, 0, 0, "grincraftstroke12white", "", 11) : this.countText = GameAPI.createText(this.game, 0, 0, "grincraftstroke12white", "", 12),
        r.add(this.countText),
        this.count = s,
        this.group = r,
        t.add(r),
        e.push(this),
        r
    }
    ,
    t.prototype.resizeCube = function(t, e) {
        this.cubeWidth_ = t,
        this.cubeHeight_ = e,
        this.group.width = this.cubeWidth_,
        this.group.height = this.cubeHeight_
    }
    ,
    t
}(), Inventory = function() {
    function t(t, e, i, s, n, r, o) {
        this.tempImg = null,
        this.sender = t,
        this.game = e,
        this.parentGroup = i,
        this.inventoryItems = s,
        this.worldItems = n,
        this.cubeOriginalWidth = r,
        this.cubeOriginalHeight = o,
        this.cubeWidth = this.cubeOriginalWidth,
        this.cubeHeight = this.cubeOriginalHeight,
        this.sender.isMobileDevice ? this.scrollBarOriginalSize = 5 : this.scrollBarOriginalSize = 15,
        this.scrollBarSize = this.scrollBarOriginalSize,
        this.leftOffset = 0,
        this.rightOffset = 0,
        this.topOffset = 0,
        this.bottomOffset = 0,
        this.inventoryFrameRect = new Phaser.Rectangle(0,0,0,0),
        this.inventoryMaskFrameRect = new Phaser.Rectangle(0,0,0,0),
        this.frameScrollBarRect = new Phaser.Rectangle(0,0,0,0),
        this.gesturesRect = new Phaser.Rectangle(0,0,0,0),
        this.scrollBarGesturesRect = new Phaser.Rectangle(0,0,0,0),
        this.scrollRect = new Phaser.Rectangle(0,0,100,100),
        this.scrollBarRect = new Phaser.Rectangle(0,0,100,100),
        this.visible_ = !0,
        this.mainGroup = this.game.add.group(),
        this.windowGroup = this.game.add.group(),
        this.itemsGroup = this.game.add.group(),
        this.scrollBackGroup = this.game.add.group(),
        this.scrollGroup = this.game.add.group(),
        this.scrollGroup.add(this.scrollBackGroup),
        this.mainGroup.add(this.windowGroup),
        this.mainGroup.add(this.itemsGroup),
        this.parentGroup.add(this.mainGroup)
    }
    return Object.defineProperty(t.prototype, "disabled", {
        get: function() {
            return this.disabled_
        },
        set: function(t) {
            this.disabled_ = t
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "visible", {
        get: function() {
            return this.visible_
        },
        set: function(t) {
            this.visible_ = t,
            this.mainGroup.visible = this.visible_
        },
        enumerable: !0,
        configurable: !0
    }),
    t.prototype.create = function() {
        this.createTitle(),
        this.createBack(),
        this.createItems(),
        this.createScroll(),
        this.createCoverLines()
    }
    ,
    t.prototype.update = function(t) {
        this.disabled_ || (this.scrollMgr.update(t),
        this.scrollGroup.y = this.scrollRect.y + 3,
        this.scrollBar.scrollBarMove.y = this.scrollBarRect.y - this.itemsGroup.y,
        this.scrollBar.scrollBarMove.width = this.scrollBarSize,
        this.scrollBar.scrollBarMove.height = this.scrollBarRect.height)
    }
    ,
    t.prototype.resize = function() {
        this.replaceWindowGroup(),
        this.calcInventoryFrameOffsets(),
        this.sender.isMobileDevice && this.resizeCubes(),
        this.calcInventoryFrameRect(),
        this.replaceCubes(),
        this.titleText.x = this.titleText.width / 2 + 2,
        ScaleManager.orientation == ScaleManager.ORIENTATION_PORTRAIT ? this.itemsGroup.x = this.game.width / 2 - (this.scrollGroup.width + 5 + this.scrollBarSize) / 2 : this.itemsGroup.x = (this.game.width - this.leftOffset - this.rightOffset) / 2 + this.leftOffset - (this.scrollGroup.width + 5 + this.scrollBarSize) / 2,
        this.itemsGroup.y = this.topOffset,
        this.bkgInventory.height = this.inventoryFrameRect.height,
        this.bkgInventoryCoverTopLine.width = this.bkgInventory.width,
        this.bkgInventoryCoverBottomLine.y = this.inventoryFrameRect.height - this.bkgInventoryCoverBottomLine.height,
        this.bkgInventoryCoverBottomLine.width = this.bkgInventory.width,
        this.calcInventoryMaskFrameRect(),
        this.calcFrameScrollBarRect(),
        this.calcGesturesRect(),
        this.calcScrollBarGesturesRect(),
        this.updateScrollRectSize(),
        this.applyInventoryFrameMask(),
        this.resizeScroll()
    }
    ,
    t.prototype.createInventoryItem = function(t, e, i) {
        var s = new InventoryItem(this.sender,this.game,this.cubeOriginalWidth,this.cubeOriginalHeight);
        s.createCube(this.scrollGroup, this.inventoryItems, t, e, i),
        this.sender.isMobileDevice && s.resizeCube(this.cubeWidth, this.cubeHeight)
    }
    ,
    t.prototype.replaceCubes = function() {
        var t = 0
          , e = 5
          , i = 5
          , s = this.cubeWidth / 2
          , n = this.cubeHeight / 2
          , r = 5
          , o = this.game.width - this.leftOffset - this.rightOffset - this.scrollBarSize - 5;
        for (this.leftOffset; !(e + this.cubeWidth > o); )
            e += this.cubeWidth,
            r += this.cubeWidth;
        for (null != this.tempImg && (this.tempImg.destroy(),
        this.tempImg = null),
        this.tempImg = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgcraft.png"),
        this.tempImg.width = r,
        this.scrollBackGroup.add(this.tempImg),
        r += this.scrollBarSize + 5,
        e = 5,
        t = 0; t < this.inventoryItems.length; t++)
            this.inventoryItems[t].group.x = e + s,
            this.inventoryItems[t].group.y = i + n,
            (e += this.cubeWidth) + this.cubeWidth > o && (i += this.cubeHeight,
            e = 5);
        this.bkgInventory.width = r
    }
    ,
    t.prototype.dispose = function() {
        this.scrollMgr.dispose()
    }
    ,
    t.prototype.createTitle = function() {
        this.titleText = GameAPI.createText(this.game, 0, 0, "grindcraft", "Inventory", 15, 16777215),
        this.titleText.x = this.titleText.width / 2 + 2,
        this.titleText.y = this.titleText.height / 2 + 3,
        this.windowGroup.add(this.titleText)
    }
    ,
    t.prototype.createBack = function() {
        this.bkgInventory = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgcraft.png"),
        this.itemsGroup.add(this.bkgInventory)
    }
    ,
    t.prototype.createItems = function() {
        var i = this;
        this.itemsGroup.add(this.scrollGroup),
        Managers.GameManager.save.inventoryItem.forEach(function(t) {
            for (var e = 0; e < i.worldItems.length; ++e)
                if (i.worldItems[e].name == t.name) {
                    i.createInventoryItem(t.name, t.count, t.path);
                    break
                }
        }, this)
    }
    ,
    t.prototype.createScroll = function() {
        this.scrollBar = new Components.MobileWndScrollBar(this.game,new Phaser.Rectangle(0,0,this.scrollBarSize,100)),
        this.itemsGroup.add(this.scrollBar.scrollBarGroup),
        this.scrollMgr = new Components.MobileWndScrollManager(this.game,this.gesturesRect,this.scrollBarGesturesRect,this.scrollRect,this.scrollBarRect)
    }
    ,
    t.prototype.createCoverLines = function() {
        this.bkgInventoryCoverTopLine = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgcraft_coverline.png"),
        this.bkgInventoryCoverBottomLine = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgcraft_coverline.png"),
        this.itemsGroup.add(this.bkgInventoryCoverTopLine),
        this.itemsGroup.add(this.bkgInventoryCoverBottomLine)
    }
    ,
    t.prototype.replaceWindowGroup = function() {
        ScaleManager.orientation == ScaleManager.ORIENTATION_PORTRAIT ? (this.windowGroup.x = 10,
        this.windowGroup.y = this.sender.craft.craftFrameRect.bottom + 10) : (this.windowGroup.x = this.sender.craft.craftFrameRect.right + 10,
        this.windowGroup.y = 10)
    }
    ,
    t.prototype.calcInventoryFrameOffsets = function() {
        ScaleManager.orientation == ScaleManager.ORIENTATION_PORTRAIT ? (this.topOffset = this.windowGroup.y + this.titleText.y + this.titleText.height / 2 + 4,
        this.leftOffset = 10,
        this.rightOffset = 10,
        this.bottomOffset = this.sender.getPortraitMaxBottomOffset() + 15) : (this.topOffset = this.windowGroup.y + 20,
        this.leftOffset = this.sender.craft.craftFrameRect.right + 10,
        this.rightOffset = this.sender.getLandscapeMaxRightOffset() + 10,
        this.bottomOffset = 20)
    }
    ,
    t.prototype.calcInventoryFrameRect = function() {
        this.inventoryFrameRect.x = this.leftOffset,
        this.inventoryFrameRect.y = this.topOffset,
        this.inventoryFrameRect.width = this.game.width - this.rightOffset - this.leftOffset,
        this.inventoryFrameRect.height = this.game.height - this.bottomOffset - this.topOffset
    }
    ,
    t.prototype.calcInventoryMaskFrameRect = function() {
        this.inventoryMaskFrameRect.x = this.itemsGroup.x,
        this.inventoryMaskFrameRect.y = this.itemsGroup.y,
        this.inventoryMaskFrameRect.width = this.scrollGroup.width + 10 + this.scrollBarSize,
        this.inventoryMaskFrameRect.height = this.inventoryFrameRect.height
    }
    ,
    t.prototype.calcFrameScrollBarRect = function() {
        this.frameScrollBarRect.x = this.scrollGroup.width + 5,
        this.frameScrollBarRect.y = 10,
        this.frameScrollBarRect.width = this.scrollBarSize,
        this.frameScrollBarRect.height = this.inventoryFrameRect.height - 20
    }
    ,
    t.prototype.calcGesturesRect = function() {
        this.gesturesRect.x = this.itemsGroup.x,
        this.gesturesRect.y = this.itemsGroup.y + 10,
        this.gesturesRect.width = this.scrollGroup.width + 10,
        this.gesturesRect.height = this.inventoryFrameRect.height - 20
    }
    ,
    t.prototype.calcScrollBarGesturesRect = function() {
        this.scrollBarGesturesRect.x = this.itemsGroup.x + this.scrollGroup.width + 10,
        this.scrollBarGesturesRect.y = this.itemsGroup.y + 10,
        this.scrollBarGesturesRect.width = this.scrollBarSize,
        this.scrollBarGesturesRect.height = this.inventoryFrameRect.height - 20
    }
    ,
    t.prototype.updateScrollRectSize = function() {
        this.scrollRect.width = this.scrollGroup.width,
        this.scrollRect.height = this.scrollGroup.height
    }
    ,
    t.prototype.applyInventoryFrameMask = function() {
        var t = this.game.make.graphics(0, 0);
        t.beginFill(16777215, .4),
        t.drawRect(this.inventoryMaskFrameRect.x, this.inventoryMaskFrameRect.y, this.inventoryMaskFrameRect.width, this.inventoryMaskFrameRect.height),
        t.endFill(),
        this.itemsGroup.mask = t
    }
    ,
    t.prototype.resizeScroll = function() {
        this.scrollMgr.reset(),
        this.scrollBar.resize(this.frameScrollBarRect),
        this.scrollMgr.updateScrollSize(),
        this.scrollMgr.resize(this.gesturesRect, this.scrollBarGesturesRect)
    }
    ,
    t.prototype.resizeCubes = function() {
        var t, e, i = this, s = ScaleManager.dpr, n = window.innerWidth, r = window.innerHeight, o = n * s, a = r * s, h = (ScaleManager.orientation == ScaleManager.ORIENTATION_PORTRAIT ? ScaleManager.GameHeight : ScaleManager.GameWidth,
        ScaleManager.orientation == ScaleManager.ORIENTATION_PORTRAIT ? ScaleManager.GameWidth : ScaleManager.GameHeight), l = ScaleManager.scale, c = this.cubeOriginalWidth, d = c * s, u = 0, p = 0, g = 0;
        this.scrollBarSize = this.scrollBarOriginalSize / l,
        p = ScaleManager.orientation == ScaleManager.ORIENTATION_PORTRAIT ? (u = h,
        g = o - this.scrollBarOriginalSize,
        u - this.leftOffset - this.rightOffset - this.scrollBarSize - 10) : (g = a,
        (u = h) - this.topOffset - this.bottomOffset - 10),
        t = Math.floor(g / d),
        e = Math.floor(p / t),
        this.cubeWidth = e,
        this.cubeHeight = e,
        this.inventoryItems.forEach(function(t) {
            t.resizeCube(i.cubeWidth, i.cubeHeight)
        }, this)
    }
    ,
    t.prototype.testCreateGraphics = function(t) {
        void 0 === t && (t = null);
        var e = this.game.add.graphics(0, 0);
        return null != t && t.add(e),
        e
    }
    ,
    t.prototype.testClearGraphics = function(t) {
        t.clear()
    }
    ,
    t.prototype.testDrawRectFromRect = function(t, e, i, s) {
        void 0 === i && (i = 16777215),
        void 0 === s && (s = 1),
        this.testDrawRect(t, e.x, e.y, e.width, e.height, i, s)
    }
    ,
    t.prototype.testDrawRect = function(t, e, i, s, n, r, o) {
        void 0 === r && (r = 16777215),
        void 0 === o && (o = 1),
        t.beginFill(r, o),
        t.drawRect(e, i, s, n),
        t.endFill()
    }
    ,
    t.prototype.testDrawCircle = function(t, e, i, s, n, r) {
        void 0 === n && (n = 16777215),
        void 0 === r && (r = 1),
        t.beginFill(n, r),
        t.drawCircle(e, i, 2 * s),
        t.endFill()
    }
    ,
    t
}(), Menu = function() {
    function t(t, e, i) {
        this.sender = t,
        this.game = e,
        this.parentGroup = i,
        this.width_ = 46,
        this.topOffset = 0,
        this.bottomOffset = 0,
        this.height_ = this.game.height,
        this.sg_map_button_tap_ = new Phaser.Signal,
        this.sg_achievements_tap_ = new Phaser.Signal,
        this.sg_settings_tap_ = new Phaser.Signal,
        this.menuGroup = this.game.add.group(),
        this.parentGroup.add(this.menuGroup)
    }
    return Object.defineProperty(t.prototype, "sg_map_button_tap", {
        get: function() {
            return this.sg_map_button_tap_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_achievements_tap", {
        get: function() {
            return this.sg_achievements_tap_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_settings_tap", {
        get: function() {
            return this.sg_settings_tap_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "width", {
        get: function() {
            return this.width_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "height", {
        get: function() {
            return this.height_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "mapEnabled", {
        get: function() {
            return this.mapEnabled_
        },
        set: function(t) {
            this.mapEnabled_ = t,
            this.checkMapButtonVisibleState()
        },
        enumerable: !0,
        configurable: !0
    }),
    t.prototype.createWindow = function() {
        var t = this
          , e = 1
          , i = this.game.add.group();
        this.mapButton = this.sender.createBasicButton(0, 0, "map_prew.png", !0, i, function() {
            t.sg_map_button_tap_.dispatch(t)
        }),
        this.mapButton.angle = -90,
        this.mapButtonImg = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "iconExpand.png"),
        i.add(this.mapButtonImg),
        this.achievementsButton = this.sender.createBasicButton(0, 0, "achievments_icon.png", !0, i, function() {
            t.sg_achievements_tap_.dispatch(t)
        }),
        e = Math.min(44 / this.achievementsButton.width, 48 / this.achievementsButton.height),
        this.achievementsButton.scale.setTo(e, e),
        i.add(this.achievementsButton),
        this.newAchievementsImg = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "achievments_new.png"),
        this.newAchievementsImg.anchor.setTo(0, 0),
        this.newAchievementsImg.visible = !1,
        i.add(this.newAchievementsImg),
        this.settingsButton = this.sender.createBasicButton(0, 0, "iconSetting.png", !0, i, function() {
            t.sg_settings_tap_.dispatch(t)
        }),
        e = Math.min(46 / this.settingsButton.width, 48 / this.settingsButton.height),
        this.settingsButton.scale.setTo(e, e),
        this.settingsButton.hitArea = new Phaser.Rectangle(-10,-10,50,50),
        i.add(this.settingsButton),
        this.menuGroup.add(i),
        this.mapEnabled_ = !0,
        this.mapButton.visible = !0
    }
    ,
    t.prototype.resize = function() {
        this.checkMapButtonVisibleState(),
        this.bottomOffset = 20;
        var t = this.width_ / 2;
        ScaleManager.orientation == ScaleManager.ORIENTATION_PORTRAIT ? (this.topOffset = 0,
        this.height_ = this.achievementsButton.height + this.settingsButton.height + 79) : (this.topOffset = 30,
        this.height_ = this.game.height - this.topOffset - this.bottomOffset,
        this.mapButton.x = t,
        this.mapButton.y = this.mapButton.width / 2,
        this.mapButtonImg.x = t - this.mapButtonImg.width / 2,
        this.mapButtonImg.y = this.mapButton.y - this.mapButton.width / 2 + 10),
        this.settingsButton.x = t,
        this.settingsButton.y = this.height_ - this.settingsButton.height / 2,
        this.achievementsButton.x = t,
        this.achievementsButton.y = this.height_ - this.settingsButton.height / 2 - this.achievementsButton.height / 2 - 103,
        this.newAchievementsImg.x = this.achievementsButton.x + this.achievementsButton.width / 2 - this.newAchievementsImg.width,
        this.newAchievementsImg.y = this.achievementsButton.y - this.achievementsButton.height / 2
    }
    ,
    t.prototype.showNewAchievementsIcon = function() {
        this.newAchievementsImg.visible = !0
    }
    ,
    t.prototype.hideNewAchievementsIcon = function() {
        this.newAchievementsImg.visible = !1
    }
    ,
    t.prototype.dispose = function() {
        this.sg_achievements_tap_.dispose(),
        this.sg_settings_tap_.dispose()
    }
    ,
    t.prototype.checkMapButtonVisibleState = function() {
        this.mapButton.visible = ScaleManager.orientation == ScaleManager.ORIENTATION_LANDSCAPE && this.mapEnabled_,
        this.mapButtonImg.visible = this.mapButton.visible
    }
    ,
    t
}(), SettingsWindow = function() {
    function t(t, e, i) {
        this.musicRoller = null,
        this.soundRoller = null,
        this.particlesRoller = null,
        this.cbMarkerGrinds = null,
        this.cbMarkerInventory = null,
        this.sender = t,
        this.game = e,
        this.parentGroup = i,
        this.wndWidth = 417,
        this.wndHeight = 580,
        this.musicCount_ = 0,
        this.soundCount_ = 0,
        this.particlesCount_ = 0,
        this.sg_close_ = new Phaser.Signal,
        this.sg_music_minus_tap_ = new Phaser.Signal,
        this.sg_music_plus_tap_ = new Phaser.Signal,
        this.sg_sound_minus_tap_ = new Phaser.Signal,
        this.sg_sound_plus_tap_ = new Phaser.Signal,
        this.sg_particles_minus_tap_ = new Phaser.Signal,
        this.sg_particles_plus_tap_ = new Phaser.Signal,
        this.sg_delete_progress_tap_ = new Phaser.Signal,
        this.sg_is_automated_changed_tap_ = new Phaser.Signal,
        this.sg_is_merge_changed_tap_ = new Phaser.Signal,
        this.settingsGroup = this.game.add.group(),
        this.parentGroup.add(this.settingsGroup)
    }
    return Object.defineProperty(t.prototype, "sg_close", {
        get: function() {
            return this.sg_close_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_music_minus_tap", {
        get: function() {
            return this.sg_music_minus_tap_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_music_plus_tap", {
        get: function() {
            return this.sg_music_plus_tap_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_sound_minus_tap", {
        get: function() {
            return this.sg_sound_minus_tap_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_sound_plus_tap", {
        get: function() {
            return this.sg_sound_plus_tap_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_particles_minus_tap", {
        get: function() {
            return this.sg_particles_minus_tap_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_particles_plus_tap", {
        get: function() {
            return this.sg_particles_plus_tap_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_delete_progress_tap", {
        get: function() {
            return this.sg_delete_progress_tap_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_is_automated_changed_tap", {
        get: function() {
            return this.sg_is_automated_changed_tap_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_is_merge_changed_tap", {
        get: function() {
            return this.sg_is_merge_changed_tap_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "visible", {
        get: function() {
            return this.settingsGroup.visible
        },
        set: function(t) {
            this.settingsGroup.visible = t
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "musicCount", {
        get: function() {
            return this.musicCount_
        },
        set: function(t) {
            this.musicCount_ = t,
            null != this.musicRoller && (this.musicRoller.count = this.musicCount_)
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "soundCount", {
        get: function() {
            return this.soundCount_
        },
        set: function(t) {
            this.soundCount_ = t,
            null != this.soundRoller && (this.soundRoller.count = this.soundCount_)
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "particlesCount", {
        get: function() {
            return this.particlesCount_
        },
        set: function(t) {
            this.particlesCount_ = t,
            null != this.particlesRoller && (this.particlesRoller.count = this.particlesCount_)
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "isAutomated", {
        get: function() {
            return this.isAutomated_
        },
        set: function(t) {
            this.isAutomated_ = t,
            null != this.cbMarkerGrinds && (this.cbMarkerGrinds.visible = this.isAutomated_)
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "isMerge", {
        get: function() {
            return this.isMerge_
        },
        set: function(t) {
            this.isMerge_ = t,
            null != this.cbMarkerInventory && (this.cbMarkerInventory.visible = this.isMerge_)
        },
        enumerable: !0,
        configurable: !0
    }),
    t.prototype.createWindow = function() {
        var e = this
          , t = this.game.add.group()
          , i = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgpause.png");
        i.anchor.setTo(.5, .5),
        i.width = this.wndWidth,
        i.height = this.wndHeight,
        i.x = this.wndWidth / 2,
        i.y = this.wndHeight / 2,
        i.inputEnabled = !0,
        t.add(i);
        var s = GameAPI.createText(this.game, 0, 0, "grincraftstroke25zheltyi", "settings", 30, 16766720);
        s.x = this.wndWidth / 2,
        s.y = 26.5,
        t.add(s);
        var n = this.sender.createBasicButton(0, 0, "close.png", !0, t, function() {
            e.sg_close_.dispatch(e)
        });
        n.x = this.wndWidth - n.width / 2 - 15,
        n.y = n.height / 2 + 8;
        var r = this.game.add.sprite(46, 113, Managers.GameManager.KEY, "iconSound.png");
        r.anchor.setTo(.5, .5),
        r.width = 61,
        r.height = 61,
        t.add(r);
        this.sender.createBasicButton(129, 113, "iconMinus.png", !0, t, function() {
            e.musicRoller.minus(),
            e.soundCount_ = e.musicRoller.count,
            e.sg_sound_minus_tap_.dispatch(e)
        });
        this.musicRoller = new MobileRoller(this.game,10),
        this.musicRoller.rollerGroup.x = 255,
        this.musicRoller.rollerGroup.y = 113,
        this.musicRoller.count = this.soundCount_,
        t.add(this.musicRoller.rollerGroup);
        this.sender.createBasicButton(382, 113, "iconPlus.png", !0, t, function() {
            e.musicRoller.plus(),
            e.soundCount_ = e.musicRoller.count,
            e.sg_sound_plus_tap_.dispatch(e)
        });
        var o = this.game.add.sprite(208, 162, Managers.GameManager.KEY, "crossline.png");
        o.anchor.setTo(.5, .5),
        o.width = this.wndWidth,
        o.height = 4,
        t.add(o);
        var a = this.game.add.sprite(46, 208, Managers.GameManager.KEY, "iconMusic.png");
        a.anchor.setTo(.5, .5),
        a.width = 61,
        a.height = 61,
        t.add(a);
        this.sender.createBasicButton(129, 208, "iconMinus.png", !0, t, function() {
            e.soundRoller.minus(),
            e.musicCount_ = e.soundRoller.count,
            e.sg_music_minus_tap_.dispatch(e)
        });
        this.soundRoller = new MobileRoller(this.game,10),
        this.soundRoller.rollerGroup.x = 255,
        this.soundRoller.rollerGroup.y = 208,
        this.soundRoller.count = this.musicCount_,
        t.add(this.soundRoller.rollerGroup);
        this.sender.createBasicButton(382, 208, "iconPlus.png", !0, t, function() {
            e.soundRoller.plus(),
            e.musicCount_ = e.soundRoller.count,
            e.sg_music_plus_tap_.dispatch(e)
        });
        (o = this.game.add.sprite(208, 255, Managers.GameManager.KEY, "crossline.png")).anchor.setTo(.5, .5),
        o.width = this.wndWidth,
        o.height = 4,
        t.add(o);
        var h = this.game.add.sprite(46, 302, Managers.GameManager.KEY, "iconParticles.png");
        h.anchor.setTo(.5, .5),
        h.width = 61,
        h.height = 61,
        t.add(h);
        this.sender.createBasicButton(129, 302, "iconMinus.png", !0, t, function() {
            e.particlesRoller.minus(),
            e.particlesCount_ = e.particlesRoller.count,
            e.sg_particles_minus_tap_.dispatch(e)
        });
        this.particlesRoller = new MobileRoller(this.game,10),
        this.particlesRoller.rollerGroup.x = 255,
        this.particlesRoller.rollerGroup.y = 302,
        this.particlesRoller.count = this.particlesCount_,
        t.add(this.particlesRoller.rollerGroup);
        this.sender.createBasicButton(382, 302, "iconPlus.png", !0, t, function() {
            e.particlesRoller.plus(),
            e.particlesCount_ = e.particlesRoller.count,
            e.sg_particles_plus_tap_.dispatch(e)
        });
        (o = this.game.add.sprite(208, 349, Managers.GameManager.KEY, "crossline.png")).anchor.setTo(.5, .5),
        o.width = this.wndWidth,
        o.height = 4,
        t.add(o);
        var l = this.game.add.sprite(46, 396, Managers.GameManager.KEY, "iconTrash.png");
        l.anchor.setTo(.5, .5),
        l.width = 61,
        l.height = 61,
        t.add(l);
        this.sender.createBasicButton(255, 396, "delete_progress_btn.png", !0, t, function() {
            e.sg_delete_progress_tap_.dispatch(e)
        });
        var c = GameAPI.createText(this.game, 255, 396, "grincraftstroke25zheltyi", "delete_progress", 20);
        t.add(c),
        (o = this.game.add.sprite(208, 444, Managers.GameManager.KEY, "crossline.png")).anchor.setTo(.5, .5),
        o.width = this.wndWidth,
        o.height = 4,
        t.add(o);
        var d = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "checkbox.png");
        d.anchor.setTo(.5, .5),
        d.width = 30,
        d.height = 34,
        d.x = 46,
        d.y = 500,
        t.add(d),
        this.cbMarkerInventory = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "checkbox_ready.png"),
        this.cbMarkerInventory.anchor.setTo(.5, .5),
        this.cbMarkerInventory.width = 30,
        this.cbMarkerInventory.height = 34,
        this.cbMarkerInventory.x = 46,
        this.cbMarkerInventory.y = 500,
        this.cbMarkerInventory.visible = this.isMerge,
        t.add(this.cbMarkerInventory),
        d.inputEnabled = !0,
        d.events.onInputUp.add(function(t) {
            e.isMerge_ = !e.isMerge_,
            e.cbMarkerInventory.visible = e.isMerge_,
            e.sg_is_merge_changed_tap_.dispatch(e)
        }, this);
        var u = GameAPI.createText(this.game, 76, 500, "grincraft12fioletovy", "merge_inventory", 20);
        u.anchor.setTo(0, .5),
        t.add(u);
        var p = GameAPI.createText(this.game, 0, 0, "grincraft12fioletovy", "game_saved", 20);
        p.anchor.setTo(0, .5),
        p.x = this.wndWidth - p.width - 15,
        p.y = this.wndHeight - p.height / 2 - 15,
        t.add(p),
        this.settingsGroup.x = -this.wndWidth / 2,
        this.settingsGroup.y = -this.wndHeight / 2,
        this.settingsGroup.add(t)
    }
    ,
    t.prototype.dispose = function() {
        this.sg_close_.dispose(),
        this.sg_music_minus_tap_.dispose(),
        this.sg_music_plus_tap_.dispose(),
        this.sg_sound_minus_tap_.dispose(),
        this.sg_sound_plus_tap_.dispose(),
        this.sg_particles_minus_tap_.dispose(),
        this.sg_particles_plus_tap_.dispose(),
        this.sg_delete_progress_tap_.dispose(),
        this.sg_is_automated_changed_tap_.dispose(),
        this.sg_is_merge_changed_tap_.dispose()
    }
    ,
    t
}(), MobileGrind = function() {
    function t(t, e, i, s) {
        this.sender = t,
        this.game = e,
        this.type = i,
        this.grinds = s,
        this.isGrid = !1,
        this.isAutocraft = !1,
        this.worker = null,
        this.selected_ = !1,
        this.visible_ = !0,
        this.grindWidth_ = 225,
        this.grindHeight_ = 80,
        this.emitter = null,
        this.hintPath_ = null,
        this.sg_grind_hover_ = new Phaser.Signal,
        this.sg_grind_hover_out_ = new Phaser.Signal,
        this.sg_grind_touch_up_ = new Phaser.Signal,
        this.sg_grind_touch_down_ = new Phaser.Signal,
        this.sg_grind_info_hover_ = new Phaser.Signal,
        this.sg_grind_info_hover_out_ = new Phaser.Signal,
        this.sg_grind_info_touch_down_ = new Phaser.Signal,
        this.sg_grind_info_touch_up_ = new Phaser.Signal
    }
    return Object.defineProperty(t.prototype, "selected", {
        get: function() {
            return this.selected_
        },
        set: function(t) {
            this.selected_ = t,
            this.checkSelectedState()
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "visible", {
        get: function() {
            return this.visible_
        },
        set: function(t) {
            this.visible_ = t,
            this.checkVisibleState()
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "grindWidth", {
        get: function() {
            return this.grindWidth_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "grindHeight", {
        get: function() {
            return this.grindHeight_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_grind_hover", {
        get: function() {
            return this.sg_grind_hover_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_grind_hover_out", {
        get: function() {
            return this.sg_grind_hover_out_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_grind_touch_up", {
        get: function() {
            return this.sg_grind_touch_up_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_grind_touch_down", {
        get: function() {
            return this.sg_grind_touch_down_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_grind_info_hover", {
        get: function() {
            return this.sg_grind_info_hover_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_grind_info_hover_out", {
        get: function() {
            return this.sg_grind_info_hover_out_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_grind_info_touch_up", {
        get: function() {
            return this.sg_grind_info_touch_up_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_grind_info_touch_down", {
        get: function() {
            return this.sg_grind_info_touch_down_
        },
        enumerable: !0,
        configurable: !0
    }),
    t.prototype.stopGrindTimer = function() {
        null != this.timerEmitter && this.timerEmitter.timer.pause(),
        null != this.timerGrind && this.timerGrind.timer.pause(),
        null != this.timerLine && this.timerLine.timer.pause()
    }
    ,
    t.prototype.startGrindTimer = function() {
        null != this.timerEmitter && (this.timerEmitter.timer.paused = !1),
        null != this.timerGrind && (this.timerGrind.timer.paused = !1),
        null != this.timerLine && (this.timerLine.timer.paused = !1)
    }
    ,
    t.prototype.createRectangleGrid = function(t, e) {
        this.group = this.game.add.group(),
        this.name = t,
        "City State" == this.sender.sender.gameLevel ? "overworld" == t ? this.hintPath_ = "hint_city_overworld.png" : "mine" == t ? this.hintPath_ = "hint_city_mine.png" : "food" == t ? this.hintPath_ = "hint_city_food.png" : "mobs" == t && (this.hintPath_ = "hint_city_mobs.png") : "Chasm Mine" == this.sender.sender.gameLevel && ("overworld" == t ? this.hintPath_ = "hint_chasm_overworld.png" : "mine" == t ? this.hintPath_ = "hint_chasm_mine.png" : "nether_mobs" == t ? this.hintPath_ = "hint_chasm_nether_mobs.png" : "nether" == t && (this.hintPath_ = "hint_chasm_nether.png")),
        this.placeGroup = this.game.add.group();
        var i = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgGrind_place.png");
        i.anchor.setTo(0, 0),
        this.placeGroup.add(i),
        this.group.add(this.placeGroup),
        this.grindGroup = this.game.add.group();
        var s = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgGrind.png");
        s.anchor.setTo(0, 0),
        s.inputEnabled = !0,
        s.events.onInputOver.add(this.onGrindItemHover, this),
        s.events.onInputOut.add(this.onGrindItemHoverOut, this),
        s.events.onInputDown.add(this.onGrindItemTouchDown, this),
        s.events.onInputUp.add(this.onGrindItemTouchUp, this),
        this.grindGroup.add(s);
        var n = this.game.add.sprite(0, 0, Managers.GameManager.KEY, this.type);
        n.anchor.setTo(0, 0),
        this.grindGroup.add(n);
        var r = GameAPI.createText(this.game, 0, 0, "grincraft25stroke_shadow_white", GameAPI.getName(this.type), 15);
        r.x = r.width / 2 + 20,
        r.y = r.height / 2 + 10,
        this.grindGroup.add(r);
        var o = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "grind.png");
        o.anchor.setTo(0, 0),
        o.width = 66,
        o.height = 66,
        o.x = s.width - o.width - 5,
        o.y = 5,
        this.grindGroup.add(o),
        this.grindIconX = o.x + o.width / 2,
        this.grindIconY = o.y + o.height / 2,
        this.grinderGroup = this.game.add.group(),
        this.grindGroup.add(this.grinderGroup),
        this.grinderX = o.x,
        this.grinderY = (s.height - 11) / 2,
        this.spriteGroup = this.game.add.group(),
        this.grindGroup.add(this.spriteGroup);
        var a = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "Info_btn.png");
        a.anchor.setTo(0, 0),
        a.x = 10,
        a.y = s.height - a.height - 5,
        a.inputEnabled = !0,
        a.events.onInputOver.add(this.onGrindInfoHover, this),
        a.events.onInputOut.add(this.onGrindInfoHoverOut, this),
        a.events.onInputDown.add(this.onGrindInfoTouchDown, this),
        a.events.onInputUp.add(this.onGrindInfoTouchUp, this),
        this.grindGroup.add(a),
        this.itemText = GameAPI.createText(this.game, 0, 0, "grincraft25stroke_shadow_white", "test", 10),
        this.itemText.x = o.x + o.width / 2,
        this.itemText.y = o.y + this.itemText.height / 2 + 8,
        this.itemText.visible = !1,
        this.grindGroup.add(this.itemText),
        this.redLineGroup = this.game.add.group(),
        this.grindGroup.add(this.redLineGroup),
        this.redLineX = o.x,
        this.redLineY = o.y + o.height - 5,
        this.greenLineGroup = this.game.add.group(),
        this.grindGroup.add(this.greenLineGroup),
        this.emitterGroup = this.game.add.group(),
        this.grindGroup.add(this.emitterGroup),
        this.emitterX = o.x + o.width / 2,
        this.emitterY = o.y + o.height / 2,
        this.frameGroup = this.game.add.group();
        var h = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgGrind_shine.png");
        return h.anchor.setTo(0, 0),
        h.width = s.width + 12,
        h.height = s.height + 12,
        h.x = -6,
        h.y = -6,
        this.frameGroup.add(h),
        this.grindGroup.add(this.frameGroup),
        this.frameGroup.visible = !1,
        this.group.add(this.grindGroup),
        this.startGrid(e),
        this.group.name = t,
        "overworld" != this.group.name && (this.visible = !1),
        this.group
    }
    ,
    t.prototype.createVisibleGrind = function() {
        var t = []
          , e = this.grinds
          , i = 0
          , s = 0;
        for (i = 0; i < e.length; ++i) {
            var n = e[i].split("=");
            if (!this.isAutocraft || "nothing=30" != e[i]) {
                var r = this.sender.materials.split(",");
                for (s = 0; s < r.length; ++s)
                    if (n[0] == r[s]) {
                        if (null != this.worker && "butcher" == this.worker.name && 0 < this.worker.count && "mobs.png" == this.type && ("zombie" == n[0] || "skeleton" == n[0] || "spider" == n[0]))
                            continue;
                        t.push(e[i])
                    }
            }
        }
        return 0 != t.length && (this.visible = !0),
        1 == t.length && "nothing=30" == t[0] && (this.visible = !1),
        t
    }
    ,
    t.prototype.startGrid = function(t) {
        var e = t.split(";");
        this.item = this.getRandomItem();
        var i = 0;
        for (i = 0; i < e.length; ++i) {
            var s = e[i].split(":");
            if ("" != this.item && "" != s[0] && (this.item == s[0] || "nothing" == this.item)) {
                "nothing" == this.item ? this.addMaterial(this.item) : this.addMaterial(s[1]);
                break
            }
        }
    }
    ,
    t.prototype.getRandomItem = function() {
        var t = this.createVisibleGrind()
          , e = 0
          , i = 0;
        for (i = 0; i < t.length; ++i) {
            e += +(n = t[i].split("="))[1]
        }
        var s = this.getRandomInt(0, e);
        for (i = e = 0; i < t.length; ++i) {
            var n;
            if (s <= (e += +(n = t[i].split("="))[1]))
                return n[0]
        }
        return ""
    }
    ,
    t.prototype.addMaterial = function(t) {
        this.spriteGroup.removeAll(!0, !0);
        var e = null;
        "nothing" == t ? ((e = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "coub.png")).visible = !1,
        this.itemText.setText(" ")) : ((e = this.game.add.sprite(0, 0, Managers.GameManager.KEY, t)).visible = !0,
        this.itemText.setText(this.item)),
        this.itemText.visible = !0,
        GameAPI.setWidthTextBTM(this.itemText, 59),
        e.anchor.setTo(.5, .5),
        e.x = this.grindIconX,
        e.y = this.grindIconY,
        this.spriteGroup.add(e),
        this.path = t,
        this.material = e
    }
    ,
    t.prototype.onDownGrind = function(t) {
        if (!this.sender.sender.isGamePaused && !this.isGrid) {
            var e = this.sender.mainGrinds.split(";")
              , i = "hand.png"
              , s = "hand"
              , n = "hand"
              , r = 0
              , o = 0
              , a = null;
            for (this.material = t,
            r = 1; r < e.length; ++r) {
                var h = e[r].split(":");
                if (null != h[3] && h[0] == this.item) {
                    for (o = 0; o < h[3].split(",").length; ++o)
                        a = h[3].split(",")[o].split("="),
                        this.sender.sender.worldItems.forEach(function(t) {
                            a[0] == t.name && 0 < t.count && (i = t.path,
                            s = t.name,
                            n = t.tag)
                        }, this);
                    for (o = 0; o < h[3].split(",").length; ++o)
                        if (a = h[3].split(",")[o].split("="),
                        s == a[0]) {
                            var l = this.game.add.sprite(0, 0, Managers.GameManager.KEY, i);
                            l.anchor.setTo(.5, .5),
                            l.x = this.grinderX - l.width / 2 - 5,
                            l.y = this.grinderY,
                            this.grinderGroup.add(l),
                            this.isGrid = !0,
                            this.redline = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "redgrinder.png"),
                            this.redline.width = 64,
                            this.redline.height = 5,
                            this.redline.x = this.redLineX + 1,
                            this.redline.y = this.redLineY - 1,
                            this.redLineGroup.add(this.redline),
                            this.line = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "greengrinder.png"),
                            this.line.height = 5,
                            this.line.x = this.redLineX + 1,
                            this.line.y = this.redLineY - 1,
                            this.greenLineGroup.add(this.line);
                            var c = +a[1]
                              , d = 1;
                            c < 2 && (d = 3),
                            c <= 1.5 && (d = 5),
                            c <= 1 && (d = 6),
                            c <= .5 && (d = 8);
                            var u = 100 * (this.line.width = d) / 64 * c / 100;
                            if (null != this.emitter && (this.emitter.destroy(!0),
                            this.emitter = null),
                            0 < this.sender.sender.particleCount && (this.emitter = this.game.add.emitter(0, 0, 100),
                            this.emitter.makeParticles(Managers.GameManager.KEY, this.material.frameName),
                            this.emitter.gravity = 200,
                            this.emitterGroup.add(this.emitter),
                            this.emitter.x = this.emitterX,
                            this.emitter.y = this.emitterY,
                            this.emitter.maxParticleScale = .1,
                            this.emitter.minParticleScale = .05,
                            this.emitter.start(!0, 300, 100, this.sender.sender.particleCount)),
                            Managers.GameManager.music.addSound(h[0], n),
                            this.timerLine = this.game.time.events.add(Phaser.Timer.SECOND * u, this.setLineTimer, this, [this.redline, this.line, u, d]),
                            this.timerGrind = this.game.time.events.add(Phaser.Timer.SECOND * +a[1], this.setGrindTimer, this, [l, t]),
                            .5 <= +a[1] && 0 < this.sender.sender.particleCount) {
                                var p = +a[1];
                                p -= .5,
                                this.timerEmitter = this.game.time.events.add(.5 * Phaser.Timer.SECOND, this.setEmitterTimer, this, [l, t, p, h[0], n])
                            }
                            break
                        }
                    break
                }
            }
        }
    }
    ,
    t.prototype.addItem = function() {
        var t = this.sender.mainGrinds.split(";")
          , e = 0;
        if (this.visible_ && (null == this.material || null == this.material || null != this.material && !this.material.visible)) {
            if (this.item = this.getRandomItem(),
            "nothing" == this.item)
                return;
            for (e = 0; e < t.length; ++e) {
                var i = t[e].split(":");
                if (this.item == i[0])
                    return this.itemText.setText(this.item),
                    GameAPI.setWidthTextBTM(this.itemText, 59),
                    this.material.frameName = i[1],
                    void (this.material.visible = !0)
            }
        }
    }
    ,
    t.prototype.getHintPath = function() {
        return this.hintPath_
    }
    ,
    t.prototype.dispose = function() {
        this.sg_grind_hover_.dispose(),
        this.sg_grind_hover_out_.dispose(),
        this.sg_grind_touch_up_.dispose(),
        this.sg_grind_touch_down_.dispose(),
        this.sg_grind_info_hover_.dispose(),
        this.sg_grind_info_hover_out_.dispose(),
        this.sg_grind_info_touch_down_.dispose(),
        this.sg_grind_info_touch_up_.dispose()
    }
    ,
    t.prototype.checkSelectedState = function() {
        this.frameGroup.visible = this.selected_
    }
    ,
    t.prototype.checkVisibleState = function() {
        this.grindGroup.visible = this.visible_
    }
    ,
    t.prototype.getRandomInt = function(t, e) {
        return Math.random() * (e - t) + t
    }
    ,
    t.prototype.setLineTimer = function(t) {
        if (null != this.line && null != this.line) {
            var e = t[2]
              , i = t[3];
            this.line.width += i,
            this.timerLine.timer.remove(this.timerLine),
            57 <= this.line.width ? (this.redline.destroy(),
            this.line.destroy(),
            this.redline = null,
            this.line = null) : this.timerLine = this.game.time.events.add(Phaser.Timer.SECOND * e, this.setLineTimer, this, [this.redline, this.line, e, i])
        }
    }
    ,
    t.prototype.setGrindTimer = function(t) {
        var n = this
          , e = this.sender.mainGrinds.split(";")
          , i = t[0]
          , s = t[1]
          , r = ""
          , o = 0
          , a = 0;
        for (this.timerGrind.timer.remove(this.timerGrind),
        o = 0; o < e.length; ++o) {
            var h = e[o].split(":");
            if (this.item == h[0]) {
                r = h[4];
                var l = h[2].split(",")
                  , c = function() {
                    var e, i = l[a].split("=");
                    d.sender.sender.worldItems.forEach(function(t) {
                        if (t.name == i[0])
                            return e = t,
                            null != n.worker ? t.count += +i[1] * n.worker.count : t.count += +i[1],
                            void n.sender.sender.resetCubes()
                    }, d);
                    var s = !0;
                    d.sender.sender.inventoryItems.forEach(function(t) {
                        if (t.name == i[0])
                            return null != n.worker ? t.count += +i[1] * n.worker.count : t.count += +i[1],
                            void (s = !1)
                    }, d),
                    s && null != e && 1 <= e.count && (d.sender.sender.createInventoryItem(e.name, e.count, e.path),
                    d.sender.sender.resetInventory())
                }
                  , d = this;
                for (a = 0; a < l.length; ++a)
                    c();
                break
            }
        }
        if ("nothing" != r && "" != r && null != r && (this.sender.sender.mobileAchievements.addNewAchievement(r, s.frameName),
        this.sender.mainGrinds = this.sender.mainGrinds.replace(r, "")),
        this.item = this.getRandomItem(),
        "nothing" == this.item)
            s.visible = !1,
            this.itemText.setText(" ");
        else
            for (o = 0; o < e.length; ++o) {
                var u = e[o].split(":");
                if (this.item == u[0]) {
                    this.itemText.setText(this.item),
                    GameAPI.setWidthTextBTM(this.itemText, 59),
                    s.frameName = u[1];
                    break
                }
            }
        for (i.destroy(),
        this.isGrid = !1,
        o = 0; o < this.sender.grinds.length; ++o)
            this.sender.grinds[o].addItem();
        null != this.line && null != this.line && (this.line.destroy(),
        this.redline.destroy()),
        this.isAutocraft && this.onDownGrind(this.material)
    }
    ,
    t.prototype.setEmitterTimer = function(t) {
        var e = t[0]
          , i = t[1]
          , s = t[2];
        Managers.GameManager.music.addSound(t[3], t[4]),
        null != this.emitter && null != this.emitter && (this.emitter.destroy(!0),
        this.emitter = null),
        this.timerEmitter.timer.remove(this.timerEmitter),
        0 < this.sender.sender.particleCount && (this.emitter = this.game.add.emitter(0, 0, 100),
        this.emitter.makeParticles(Managers.GameManager.KEY, this.material.frameName),
        this.emitter.gravity = 200,
        this.emitterGroup.add(this.emitter),
        this.emitter.x = this.emitterX,
        this.emitter.y = this.emitterY,
        this.emitter.maxParticleScale = .1,
        this.emitter.minParticleScale = .05,
        this.emitter.start(!0, 300, 100, this.sender.sender.particleCount),
        .5 <= s && (s -= .5,
        this.timerEmitter = this.game.time.events.add(.5 * Phaser.Timer.SECOND, this.setEmitterTimer, this, [e, i, s, t[3], t[4]])))
    }
    ,
    t.prototype.onGrindItemHover = function() {
        this.sender.sender.isGamePaused || this.sg_grind_hover_.dispatch(this)
    }
    ,
    t.prototype.onGrindItemHoverOut = function() {
        this.sender.sender.isGamePaused || this.sg_grind_hover_out_.dispatch(this)
    }
    ,
    t.prototype.onGrindItemTouchUp = function(t) {
        this.sender.sender.isGamePaused || this.sg_grind_touch_up_.dispatch(this)
    }
    ,
    t.prototype.onGrindItemTouchDown = function(t) {
        this.sender.sender.isGamePaused || (this.onDownGrind(this.material),
        this.sg_grind_touch_down_.dispatch(this))
    }
    ,
    t.prototype.onGrindInfoHover = function() {
        this.sender.sender.isGamePaused || this.sg_grind_info_hover_.dispatch(this)
    }
    ,
    t.prototype.onGrindInfoHoverOut = function() {
        this.sender.sender.isGamePaused || this.sg_grind_info_hover_out_.dispatch(this)
    }
    ,
    t.prototype.onGrindInfoTouchUp = function(t) {
        this.sender.sender.isGamePaused || this.sg_grind_info_touch_up_.dispatch(this)
    }
    ,
    t.prototype.onGrindInfoTouchDown = function(t) {
        this.sender.sender.isGamePaused || (this.onDownGrind(this.material),
        this.sg_grind_info_touch_down_.dispatch(this))
    }
    ,
    t
}(), MobileGrinds = function() {
    function t(t, e, i, s, n) {
        this.sender = t,
        this.game = e,
        this.parentGroup = i,
        this.mainGrinds = s,
        this.mainGrinders = n,
        this.grinds = [],
        this.grindsGroupList = [],
        this.width_ = 100,
        this.height_ = 100,
        this.selectedGrindItem_ = null,
        this.isTouchDown = !1,
        this.isHover = !1,
        this.timerHint = null,
        this.isHintShown = !1,
        this.grindHint = null,
        this.isMobileDevice = Services.isMobile(),
        this.grindsGroup = this.game.add.group(),
        this.grindsWindowGroup = this.game.add.group(),
        this.grindHintGroup = this.game.add.group(),
        this.parentGroup.add(this.grindsGroup),
        this.parentGroup.add(this.grindHintGroup),
        this.materials = Managers.GameManager.save.grind,
        this.sg_selected_grind_item_changed_ = new Phaser.Signal
    }
    return Object.defineProperty(t.prototype, "width", {
        get: function() {
            return this.width_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "height", {
        get: function() {
            return this.height_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "selectedGrindItem", {
        get: function() {
            return this.selectedGrindItem_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_selected_grind_item_changed", {
        get: function() {
            return this.sg_selected_grind_item_changed_
        },
        enumerable: !0,
        configurable: !0
    }),
    t.prototype.createGrind = function() {
        var t = this.game.add.group()
          , e = GameAPI.createText(this.game, 0, 0, "grindcraft", "grind", 15);
        e.x = e.width / 2 + 2,
        e.y = e.height / 2 + 3,
        t.add(e),
        this.grindsWindowGroup.x = 0,
        this.grindsWindowGroup.y = e.y + e.height / 2 + 4;
        var i = this.mainGrinders.split(";")
          , s = 0;
        for (s = 0; s < i.length; s++) {
            var n = i[s].split(":")
              , r = new MobileGrind(this,this.game,n[2],n[1].replace("nothing=remainder,", "nothing=30,").split(","));
            this.isMobileDevice || (r.sg_grind_hover.add(this.onGrindHover, this),
            r.sg_grind_hover_out.add(this.onGrindHoverOut, this),
            r.sg_grind_info_hover.add(this.onGrindInfoHover, this),
            r.sg_grind_info_hover_out.add(this.onGrindInfoHoverOut, this)),
            r.sg_grind_touch_up.add(this.onGrindTouchUp, this),
            r.sg_grind_touch_down.add(this.onGrindTouchDown, this),
            r.sg_grind_info_touch_up.add(this.onGrindInfoTouchUp, this),
            r.sg_grind_info_touch_down.add(this.onGrindInfoTouchDown, this);
            var o = r.createRectangleGrid(n[0], this.mainGrinds);
            this.grinds.push(r),
            this.grindsWindowGroup.add(o),
            this.grindsGroupList.push(o)
        }
        for (s = 0; s < this.grinds.length; ++s)
            this.grinds[s].createVisibleGrind();
        t.add(this.grindsWindowGroup),
        this.grindsGroup.add(t)
    }
    ,
    t.prototype.resetGrids = function(r) {
        var o = this;
        this.mainGrinds.split(";").forEach(function(t) {
            var n = t.split(":");
            null != n[3] && n[3].split(",").forEach(function(t) {
                var e = t.split("=");
                if (r.name == e[0] && 0 < r.count) {
                    var i = !1
                      , s = 0;
                    for (s = 0; s < o.materials.split(",").length; ++s)
                        if (o.materials.split(",")[s] == n[0]) {
                            i = !0;
                            break
                        }
                    i || (o.materials += n[0] + ",")
                }
            }, o)
        }, this)
    }
    ,
    t.prototype.resize = function() {
        var t = 0
          , e = 0
          , i = 0;
        if (ScaleManager.orientation == ScaleManager.ORIENTATION_PORTRAIT) {
            this.width_ = 455,
            this.height_ = 195;
            var s = 0;
            for (i = 0; i < this.grinds.length; i++) {
                s++;
                var n = (r = this.grinds[i]).group;
                2 < s && (t = s = 0,
                e += r.grindHeight + 15),
                n.x = t,
                n.y = e,
                t += r.grindWidth + 5
            }
        } else
            for (i = 0; i < this.grinds.length; i++) {
                var r;
                (n = (r = this.grinds[i]).group).x = t,
                n.y = e,
                e += r.grindHeight + 10
            }
    }
    ,
    t.prototype.resizeHint = function() {
        if (this.isHintShown)
            if (ScaleManager.orientation == ScaleManager.ORIENTATION_PORTRAIT) {
                this.grindHintGroup.x = this.grindHint.group.x,
                this.grindHintGroup.y = -(this.grindHintGroup.height + 10);
                var t = -(this.game.height - this.height_ - 30);
                this.grindHintGroup.y < t && (this.grindHintGroup.y = t)
            } else
                this.grindHintGroup.x = this.grindHint.grindWidth + 20,
                this.grindHintGroup.y = this.grindsWindowGroup.y + this.grindHint.group.y,
                this.grindHintGroup.y + this.grindHintGroup.height > this.game.height - 30 && (this.grindHintGroup.y = this.game.height - 30 - this.grindHintGroup.height)
    }
    ,
    t.prototype.unselectSelectedItem = function() {
        null != this.selectedGrindItem_ && (this.selectedGrindItem_.selected = !1,
        this.selectedGrindItem_ = null)
    }
    ,
    t.prototype.selectItem = function(t) {
        this.selectedGrindItem_ = t,
        this.selectedGrindItem_.selected = !0
    }
    ,
    t.prototype.addMaterials = function(t) {
        var i = 0
          , e = function() {
            var e = s.grinds[i].getRandomItem();
            if ((null == s.grinds[i].material || null == s.grinds[i].material) && 1 == s.grinds[i].visible) {
                s.grinds[i].item = e;
                s.mainGrinds.split(";").forEach(function(t) {
                    t.split(":")[0] != e || (e = t.split(":")[1])
                }, s),
                s.grinds[i].addMaterial(e)
            }
        }
          , s = this;
        for (i = 0; i < this.grinds.length; ++i)
            e()
    }
    ,
    t.prototype.stopGrindTimers = function() {
        null != this.grinds && this.grinds.forEach(function(t) {
            t.stopGrindTimer()
        }, this)
    }
    ,
    t.prototype.startGrindTimers = function() {
        null != this.grinds && this.grinds.forEach(function(t) {
            t.startGrindTimer()
        }, this)
    }
    ,
    t.prototype.dispose = function() {
        this.grinds.forEach(function(t) {
            t.dispose()
        }, this),
        this.sg_selected_grind_item_changed_.dispose()
    }
    ,
    t.prototype.showHint = function(t) {
        this.grindHint = t,
        this.isHintShown = !0;
        var e = this.game.add.sprite(0, 0, Managers.GameManager.KEY, this.grindHint.getHintPath());
        this.grindHintGroup.add(e),
        this.resizeHint()
    }
    ,
    t.prototype.hideHint = function() {
        this.grindHintGroup.removeAll(!0, !0),
        this.isHintShown = !1,
        this.grindHint = null
    }
    ,
    t.prototype.startTimerHint = function(t, e) {
        this.timerHint = this.game.time.events.add(t, this.onTimerHintRaised, this, e)
    }
    ,
    t.prototype.stopTimerHint = function() {
        null != this.timerHint && (this.game.time.events.remove(this.timerHint),
        this.timerHint = null)
    }
    ,
    t.prototype.onGrindHover = function(t) {
        this.isHover = !0,
        null != this.selectedGrindItem_ && this.selectedGrindItem_ != t && (this.selectedGrindItem_.selected = !1),
        null != this.selectedGrindItem_ && this.selectedGrindItem_ == t || (this.selectedGrindItem_ = t,
        this.selectedGrindItem_.selected = !0,
        this.sg_selected_grind_item_changed_.dispatch(this))
    }
    ,
    t.prototype.onGrindHoverOut = function(t) {
        this.isHover = !1,
        null != this.selectedGrindItem_ && (this.selectedGrindItem_.selected = !1,
        this.selectedGrindItem_ = null,
        this.sg_selected_grind_item_changed_.dispatch(this))
    }
    ,
    t.prototype.onGrindTouchUp = function(t) {
        this.isTouchDown = !1,
        this.isMobileDevice
    }
    ,
    t.prototype.onGrindTouchDown = function(t) {
        this.isTouchDown = !0,
        this.isMobileDevice && (null != this.selectedGrindItem_ && this.selectedGrindItem_ != t && (this.selectedGrindItem_.selected = !1),
        null != this.selectedGrindItem_ && this.selectedGrindItem_ == t || (this.selectedGrindItem_ = t,
        this.selectedGrindItem_.selected = !0,
        this.sg_selected_grind_item_changed_.dispatch(this)))
    }
    ,
    t.prototype.onGrindInfoHover = function(t) {
        this.isHover = !0,
        null != this.selectedGrindItem_ && this.selectedGrindItem_ != t && (this.selectedGrindItem_.selected = !1),
        null != this.selectedGrindItem_ && this.selectedGrindItem_ == t || (this.selectedGrindItem_ = t,
        this.selectedGrindItem_.selected = !0,
        this.sg_selected_grind_item_changed_.dispatch(this)),
        this.startTimerHint(.5 * Phaser.Timer.SECOND, [t])
    }
    ,
    t.prototype.onGrindInfoHoverOut = function(t) {
        this.isHover = !1,
        null != this.selectedGrindItem_ && (this.selectedGrindItem_.selected = !1,
        this.selectedGrindItem_ = null,
        this.sg_selected_grind_item_changed_.dispatch(this)),
        this.stopTimerHint(),
        this.hideHint()
    }
    ,
    t.prototype.onGrindInfoTouchUp = function(t) {
        this.isTouchDown = !1,
        this.isMobileDevice && (this.stopTimerHint(),
        this.hideHint())
    }
    ,
    t.prototype.onGrindInfoTouchDown = function(t) {
        this.isTouchDown = !0,
        this.isMobileDevice && (null != this.selectedGrindItem_ && this.selectedGrindItem_ != t && (this.selectedGrindItem_.selected = !1),
        null != this.selectedGrindItem_ && this.selectedGrindItem_ == t || (this.selectedGrindItem_ = t,
        this.selectedGrindItem_.selected = !0,
        this.sg_selected_grind_item_changed_.dispatch(this)),
        this.startTimerHint(.5 * Phaser.Timer.SECOND, [t]))
    }
    ,
    t.prototype.onTimerHintRaised = function(t) {
        this.stopTimerHint(),
        this.isMobileDevice && !this.isTouchDown || !this.isMobileDevice && !this.isHover || this.showHint(t[0])
    }
    ,
    t
}(), WorldMapMarker = function() {
    function t(t, e, i, s) {
        this.sender = t,
        this.game = e,
        this.name = s,
        this.parentGroup = i,
        this.visible_ = !0,
        this.selected_ = !1,
        this.checked_ = !1,
        this.markerGroup = this.game.add.group(),
        this.parentGroup.add(this.markerGroup),
        this.sg_touch_down_ = new Phaser.Signal,
        this.sg_touch_up_ = new Phaser.Signal,
        this.sg_hover_ = new Phaser.Signal,
        this.sg_hover_out_ = new Phaser.Signal
    }
    return Object.defineProperty(t.prototype, "visible", {
        get: function() {
            return this.visible_
        },
        set: function(t) {
            this.visible_ = t,
            this.checkVisibleState()
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "selected", {
        get: function() {
            return this.selected_
        },
        set: function(t) {
            this.selected_ = t,
            this.checkSelectedState()
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "checked", {
        get: function() {
            return this.checked_
        },
        set: function(t) {
            this.checked_ = t,
            this.checkCheckedState()
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_touch_down", {
        get: function() {
            return this.sg_touch_down_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_touch_up", {
        get: function() {
            return this.sg_touch_up_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_hover", {
        get: function() {
            return this.sg_hover_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_hover_out", {
        get: function() {
            return this.sg_hover_out_
        },
        enumerable: !0,
        configurable: !0
    }),
    t.prototype.create = function() {
        this.marker = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "marker.png"),
        this.marker.anchor.setTo(.5, 1),
        this.marker.inputEnabled = !0,
        this.marker.events.onInputOver.add(this.onHover, this),
        this.marker.events.onInputOut.add(this.onHoverOut, this),
        this.marker.events.onInputDown.add(this.onTouchDown, this),
        this.marker.events.onInputUp.add(this.onTouchUp, this),
        this.markerGroup.add(this.marker),
        this.markerSelected = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "marker_c.png"),
        this.markerSelected.anchor.setTo(.5, 1),
        this.markerGroup.add(this.markerSelected),
        this.markerSelected.visible = !1,
        this.markerCheck = this.game.add.sprite(5, -20, Managers.GameManager.KEY, "marker_ch.png"),
        this.markerCheck.anchor.setTo(.5, .5),
        this.markerCheck.scale.setTo(.5, .5),
        this.markerGroup.add(this.markerCheck),
        this.markerCheck.visible = !1;
        var t = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgGrind.png");
        t.anchor.setTo(.5, .5),
        t.width = 160,
        t.height = 40,
        t.x = -10,
        t.y = -110,
        this.markerGroup.add(t);
        var e = GameAPI.createText(this.game, 0, 0, "grindcraft", this.name, 18, 0);
        e.x = t.x,
        e.y = t.y,
        this.markerGroup.add(e)
    }
    ,
    t.prototype.dispose = function() {
        this.sg_touch_down_.dispose(),
        this.sg_touch_up_.dispose(),
        this.sg_hover_.dispose(),
        this.sg_hover_out_.dispose()
    }
    ,
    t.prototype.checkVisibleState = function() {
        this.markerGroup.visible = this.visible_
    }
    ,
    t.prototype.checkSelectedState = function() {
        this.markerSelected.visible = this.selected_
    }
    ,
    t.prototype.checkCheckedState = function() {
        this.markerCheck.visible = this.checked_
    }
    ,
    t.prototype.onTouchDown = function() {
        this.sg_touch_down_.dispatch(this)
    }
    ,
    t.prototype.onTouchUp = function() {
        this.sg_touch_up_.dispatch(this)
    }
    ,
    t.prototype.onHover = function() {
        this.sg_hover_.dispatch(this)
    }
    ,
    t.prototype.onHoverOut = function() {
        this.sg_hover_out_.dispatch(this)
    }
    ,
    t
}(), WorldMap = function() {
    function t(t, e, i) {
        this.sender = t,
        this.game = e,
        this.parentGroup = i,
        this.cityMarker = null,
        this.chasmMarker = null,
        this.msgCurtain = null,
        this.isMobileDevice = Services.isMobile(),
        this.visible_ = !0,
        this.sg_close_ = new Phaser.Signal,
        this.mapGroup = this.game.add.group(),
        this.mapImgGroup = this.game.add.group(),
        this.mapGroup.add(this.mapImgGroup),
        this.parentGroup.add(this.mapGroup)
    }
    return Object.defineProperty(t.prototype, "visible", {
        get: function() {
            return this.visible_
        },
        set: function(t) {
            this.visible_ = t,
            this.mapGroup.visible = this.visible_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_close", {
        get: function() {
            return this.sg_close_
        },
        enumerable: !0,
        configurable: !0
    }),
    t.prototype.create = function() {
        this.createBack(),
        this.createMarkers(),
        this.createButtons(),
        this.createCoverLines()
    }
    ,
    t.prototype.resize = function() {
        this.mapImgGroup.x = this.game.width / 2,
        this.mapImgGroup.y = this.game.height / 2,
        this.closeButton.x = this.mapImg.width / 2 - this.closeButton.width / 2 - 30,
        this.closeButton.y = -this.mapImg.height / 2 + this.closeButton.height / 2 + 30,
        this.resizeMsgCurtain()
    }
    ,
    t.prototype.showNextMarker = function() {
        this.chasmMarker.visible = !0
    }
    ,
    t.prototype.dispose = function() {
        this.sg_close_.dispose(),
        this.cityMarker.dispose(),
        this.chasmMarker.dispose()
    }
    ,
    t.prototype.createBack = function() {
        this.mapImg = this.game.add.sprite(0, 0, "earth"),
        this.mapImg.anchor.setTo(.5, .5),
        this.mapImg.inputEnabled = !0,
        this.mapImgGroup.add(this.mapImg)
    }
    ,
    t.prototype.createMarkers = function() {
        this.cityMarker = this.createMarker(107, 65, "city_state_name"),
        this.isMobileDevice || (this.cityMarker.sg_hover.add(this.onCityMarkerHover, this),
        this.cityMarker.sg_hover_out.add(this.onCityMarkerHoverOut, this)),
        this.cityMarker.sg_touch_down.add(this.onCityMarkerTouchDown, this),
        this.cityMarker.sg_touch_up.add(this.onCityMarkerTouchUp, this),
        this.chasmMarker = this.createMarker(-128, -13, "chasm_mine_name"),
        this.isMobileDevice || (this.chasmMarker.sg_hover.add(this.onChasmMarkerHover, this),
        this.chasmMarker.sg_hover_out.add(this.onChasmMarkerHoverOut, this)),
        this.chasmMarker.sg_touch_down.add(this.onChasmMarkerTouchDown, this),
        this.chasmMarker.sg_touch_up.add(this.onChasmMarkerTouchUp, this),
        this.cityMarker.visible = !0,
        this.chasmMarker.visible = !1,
        "Chasm Mine" == this.sender.gameLevel && (this.chasmMarker.visible = !0,
        this.cityMarker.checked = !0)
    }
    ,
    t.prototype.createMarker = function(t, e, i) {
        var s = this.game.add.group();
        s.x = t,
        s.y = e,
        this.mapImgGroup.add(s);
        var n = new WorldMapMarker(this,this.game,s,i);
        return n.create(),
        n
    }
    ,
    t.prototype.createButtons = function() {
        var t = this;
        this.closeButton = this.sender.createBasicButton(0, 0, "iconContract.png", !0, this.mapImgGroup, function() {
            t.sg_close_.dispatch(t)
        }),
        this.closeButton.hitArea = new Phaser.Rectangle(-this.closeButton.width / 2,-this.closeButton.height / 2,this.closeButton.width,this.closeButton.height)
    }
    ,
    t.prototype.createCoverLines = function() {
        this.bkgCoverTopLine = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "map_line_1.png"),
        this.bkgCoverTopLine.height = 5,
        this.bkgCoverTopLine.width = this.mapImg.width,
        this.bkgCoverTopLine.x = -this.mapImg.width / 2,
        this.bkgCoverTopLine.y = -this.mapImg.height / 2,
        this.mapImgGroup.add(this.bkgCoverTopLine),
        this.bkgCoverBottomLine = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "map_line_1.png"),
        this.bkgCoverBottomLine.height = 5,
        this.bkgCoverBottomLine.width = this.mapImg.width,
        this.bkgCoverBottomLine.x = -this.mapImg.width / 2,
        this.bkgCoverBottomLine.y = this.mapImg.height / 2,
        this.mapImgGroup.add(this.bkgCoverBottomLine),
        this.bkgCoverLeftLine = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "map_line_2.png"),
        this.bkgCoverLeftLine.height = 5,
        this.bkgCoverLeftLine.width = this.mapImg.height,
        this.bkgCoverLeftLine.angle = 90,
        this.bkgCoverLeftLine.x = -this.mapImg.width / 2 + this.bkgCoverLeftLine.height,
        this.bkgCoverLeftLine.y = -this.mapImg.height / 2,
        this.mapImgGroup.add(this.bkgCoverLeftLine),
        this.bkgCoverRightLine = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "map_line_2.png"),
        this.bkgCoverRightLine.height = 5,
        this.bkgCoverRightLine.width = this.mapImg.height,
        this.bkgCoverRightLine.angle = 90,
        this.bkgCoverRightLine.x = this.mapImg.width / 2,
        this.bkgCoverRightLine.y = -this.mapImg.height / 2,
        this.mapImgGroup.add(this.bkgCoverRightLine)
    }
    ,
    t.prototype.createMsgCurtain = function() {
        this.msgCurtain = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "coub.png"),
        this.msgCurtain.alpha = .6,
        this.msgCurtain.inputEnabled = !0,
        this.mapGroup.add(this.msgCurtain)
    }
    ,
    t.prototype.resizeMsgCurtain = function() {
        null != this.msgCurtain && (this.msgCurtain.x = -100,
        this.msgCurtain.y = -100,
        this.msgCurtain.width = this.game.width + 200,
        this.msgCurtain.height = this.game.height + 200)
    }
    ,
    t.prototype.startNextLevel = function() {
        this.sender.grindsLogic.materials = this.sender.grindsLogic.materials.replace("diamond ore,", ""),
        this.sender.grindsLogic.materials = this.sender.grindsLogic.materials.replace("iron ore,", ""),
        this.sender.grindsLogic.materials = this.sender.grindsLogic.materials.replace("coal ore,", ""),
        this.sender.grindsLogic.materials = this.sender.grindsLogic.materials.replace("lava,", ""),
        0 < this.sender.worldItems[36].count && (this.sender.worldItems[33].count += this.sender.worldItems[36].count),
        0 == this.sender.worldItems[33].count && (this.sender.grindsLogic.materials = this.sender.grindsLogic.materials.replace("spider,", ""),
        this.sender.grindsLogic.materials = this.sender.grindsLogic.materials.replace("slime,", "")),
        0 == this.sender.worldItems[30].count && (this.sender.grindsLogic.materials = this.sender.grindsLogic.materials.replace("dirt,", "")),
        0 == this.sender.worldItems[31].count && (this.sender.grindsLogic.materials = this.sender.grindsLogic.materials.replace("stone,", ""),
        this.sender.grindsLogic.materials = this.sender.grindsLogic.materials.replace("gravel,", "")),
        Managers.GameManager.music.music.stop(),
        Managers.GameManager.save.level = "Chasm Mine",
        this.sender.saveGame(),
        this.game.state.start(Gameplay.Name)
    }
    ,
    t.prototype.onCityMarkerHover = function(t) {
        this.cityMarker.selected = !0
    }
    ,
    t.prototype.onCityMarkerHoverOut = function(t) {
        this.cityMarker.selected = !1
    }
    ,
    t.prototype.onCityMarkerTouchDown = function(t) {
        this.isMobileDevice && (this.cityMarker.selected = !0)
    }
    ,
    t.prototype.onCityMarkerTouchUp = function(t) {
        this.isMobileDevice && (this.cityMarker.selected = !1),
        "Chasm Mine" == this.sender.gameLevel && this.sender.saveGame()
    }
    ,
    t.prototype.onChasmMarkerHover = function(t) {
        this.chasmMarker.selected = !0
    }
    ,
    t.prototype.onChasmMarkerHoverOut = function(t) {
        this.chasmMarker.selected = !1
    }
    ,
    t.prototype.onChasmMarkerTouchDown = function(t) {
        this.isMobileDevice && (this.chasmMarker.selected = !0)
    }
    ,
    t.prototype.onChasmMarkerTouchUp = function(t) {
        var e = this;
        this.isMobileDevice && (this.chasmMarker.selected = !1),
        "Chasm Mine" != this.sender.gameLevel && (this.createMsgCurtain(),
        this.resizeMsgCurtain(),
        this.sender.createBeat("go_to_mine", "yes", !1, function() {
            e.msgCurtain.destroy(!0),
            e.startNextLevel()
        }, "no", function() {
            e.msgCurtain.destroy(!0)
        }))
    }
    ,
    t
}(), CraftInfo = function() {
    function t(t, e, i) {
        this.sender = t,
        this.game = e,
        this.parentGroup = i,
        this.width_ = 225,
        this.height_ = 195,
        this.wndWidth = 225,
        this.wndHeight = 175,
        this.mapEnabled_ = !1,
        this.grindInfo = "Overworld",
        this.isMobileDevice = Services.isMobile(),
        this.craftInfoItem = new CraftInfoItem,
        this.sg_map_button_tap_ = new Phaser.Signal,
        this.infoGroup = this.game.add.group(),
        this.parentGroup.add(this.infoGroup)
    }
    return Object.defineProperty(t.prototype, "width", {
        get: function() {
            return this.width_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "height", {
        get: function() {
            return this.height_
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "mapEnabled", {
        get: function() {
            return this.mapEnabled_
        },
        set: function(t) {
            this.mapEnabled_ = t,
            this.checkMapButtonVisibleState()
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t.prototype, "sg_map_button_tap", {
        get: function() {
            return this.sg_map_button_tap_
        },
        enumerable: !0,
        configurable: !0
    }),
    t.prototype.createWindow = function() {
        var t = this
          , e = this.game.add.group();
        this.titleText = GameAPI.createText(this.game, 0, 0, "grindcraft", "info", 15, 16777215),
        this.titleText.x = this.titleText.width / 2 + 2,
        this.titleText.y = this.titleText.height / 2 + 3,
        e.add(this.titleText),
        this.windowGroup = this.game.add.group(),
        this.windowGroup.y = 20,
        e.add(this.windowGroup),
        this.craftTapMsgWndGroup = this.game.add.group();
        var i = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "info_win.png");
        this.craftTapMsgWndGroup.add(i),
        this.tapToShowCraftInfoText = GameAPI.createText(this.game, 0, 0, "grindcraft", "tap_for_info", 18, 16777215),
        this.tapToShowCraftInfoText.x = this.wndWidth / 2,
        this.tapToShowCraftInfoText.y = (this.wndHeight - 42) / 2,
        this.tapToShowCraftInfoText.setText(GameAPI.setWidthTextBTM(this.tapToShowCraftInfoText, this.wndWidth - 10)),
        this.craftTapMsgWndGroup.add(this.tapToShowCraftInfoText),
        this.tapToShowCraftInfoText.visible = this.isMobileDevice,
        this.hoverToShowCraftInfoText = GameAPI.createText(this.game, 0, 0, "grindcraft", "hover_for_info", 18, 16777215),
        this.hoverToShowCraftInfoText.x = this.wndWidth / 2,
        this.hoverToShowCraftInfoText.y = (this.wndHeight - 42) / 2,
        this.hoverToShowCraftInfoText.setText(GameAPI.setWidthTextBTM(this.hoverToShowCraftInfoText, this.wndWidth - 10)),
        this.craftTapMsgWndGroup.add(this.hoverToShowCraftInfoText),
        this.hoverToShowCraftInfoText.visible = !this.isMobileDevice,
        this.windowGroup.add(this.craftTapMsgWndGroup),
        this.grindHoldMsgWndGroup = this.game.add.group();
        var s = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "info_win.png");
        this.grindHoldMsgWndGroup.add(s),
        this.holdToShowGrindInfoText = GameAPI.createText(this.game, 0, 0, "grindcraft", "hold_for_info", 18, 16777215),
        this.holdToShowGrindInfoText.x = this.wndWidth / 2,
        this.holdToShowGrindInfoText.y = (this.wndHeight - 42) / 2 + 10,
        this.holdToShowGrindInfoText.setText(GameAPI.setWidthTextBTM(this.holdToShowGrindInfoText, this.wndWidth - 10)),
        this.grindHoldMsgWndGroup.add(this.holdToShowGrindInfoText),
        this.holdToShowGrindInfoText.visible = this.isMobileDevice,
        this.grindNameText = GameAPI.createText(this.game, 0, 0, "grindcraft", "OVERWORLD", 18, 16777215),
        this.grindNameText.x = this.wndWidth / 2,
        this.grindNameText.y = 25,
        this.grindHoldMsgWndGroup.add(this.grindNameText),
        this.grindNameText.visible = this.isMobileDevice,
        this.grindTapToBuildText = GameAPI.createText(this.game, 0, 0, "grindcraft", "tap_to_grind", 18, 16777215),
        this.grindTapToBuildText.anchor.setTo(.5, .5),
        this.grindTapToBuildText.setText(GameAPI.setWidthTextBTM(this.grindTapToBuildText, this.wndWidth - 10)),
        this.grindTapToBuildText.x = this.wndWidth / 2,
        this.grindTapToBuildText.y = 156,
        this.grindHoldMsgWndGroup.add(this.grindTapToBuildText),
        this.grindTapToBuildText.visible = this.isMobileDevice,
        this.grindInfoText = GameAPI.createText(this.game, 0, 0, "grindcraft", this.grindInfo, 18, 16777215),
        this.grindInfoText.x = this.wndWidth / 2,
        this.grindInfoText.y = (this.wndHeight - 42) / 2,
        this.grindInfoText.setText(GameAPI.setWidthTextBTM(this.grindInfoText, this.wndWidth - 10)),
        this.grindHoldMsgWndGroup.add(this.grindInfoText),
        this.grindInfoText.visible = !this.isMobileDevice,
        this.clickToGrindText = GameAPI.createText(this.game, 0, 0, "grindcraft", "click_to_grind", 18, 16777215),
        this.clickToGrindText.anchor.setTo(.5, .5),
        this.clickToGrindText.setText(GameAPI.setWidthTextBTM(this.clickToGrindText, this.wndWidth - 10)),
        this.clickToGrindText.x = this.wndWidth / 2,
        this.clickToGrindText.y = 156,
        this.grindHoldMsgWndGroup.add(this.clickToGrindText),
        this.clickToGrindText.visible = !this.isMobileDevice,
        this.windowGroup.add(this.grindHoldMsgWndGroup),
        this.craftInfoWndGroup = this.game.add.group();
        var n = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "info_win.png");
        this.craftInfoWndGroup.add(n),
        this.craftInfoBack2Img = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgcraft.png"),
        this.craftInfoBack2Img.width = n.width,
        this.craftInfoBack2Img.height = n.height,
        this.craftInfoWndGroup.add(this.craftInfoBack2Img),
        this.craftInfoBack2Img.visible = !1,
        this.craftItemNameText = GameAPI.createText(this.game, 0, 0, "grincraftstroke12white", "netherFortressInterior", 14),
        this.craftItemNameText.anchor.setTo(0, .5),
        this.craftItemNameText.x = 5,
        this.craftItemNameText.y = this.craftItemNameText.height / 2 + 5,
        this.craftInfoWndGroup.add(this.craftItemNameText),
        this.requiredCraftItemsGroup = this.game.add.group(),
        this.requiredCraftItemsGroup.x = 5,
        this.requiredCraftItemsGroup.y = 24,
        this.craftInfoWndGroup.add(this.requiredCraftItemsGroup);
        this.requiredCraftItemMessageText = GameAPI.createText(this.game, 0, 0, "grincraft12323232", "Required to build a barge. Required to build a barge. Required to build a barge.", 13),
        this.requiredCraftItemMessageText.anchor.setTo(0, .5),
        this.requiredCraftItemMessageText.setText(GameAPI.setWidthTextBTM(this.requiredCraftItemMessageText, this.wndWidth - 10)),
        this.requiredCraftItemMessageText.x = 5,
        this.requiredCraftItemMessageText.y = this.requiredCraftItemMessageText.height / 2 + 84,
        this.craftInfoWndGroup.add(this.requiredCraftItemMessageText);
        var r = this.isMobileDevice ? "tap_to_craft" : "click_to_craft";
        this.buildCraftItemMessageText = GameAPI.createText(this.game, 0, 0, "grindcraft", r, 18, 16777215),
        this.buildCraftItemMessageText.anchor.setTo(.5, .5),
        this.buildCraftItemMessageText.setText(GameAPI.setWidthTextBTM(this.buildCraftItemMessageText, this.wndWidth - 10)),
        this.buildCraftItemMessageText.x = this.wndWidth / 2,
        this.buildCraftItemMessageText.y = 156,
        this.craftInfoWndGroup.add(this.buildCraftItemMessageText),
        this.windowGroup.add(this.craftInfoWndGroup),
        this.mapButtonGroup = this.game.add.group(),
        this.mapButtonGroup.y = 133,
        this.mapButton = this.sender.createBasicButton(0, 0, "map_prew.png", !0, this.mapButtonGroup, function() {
            t.sg_map_button_tap_.dispatch(t)
        }),
        this.mapButton.width = this.wndWidth,
        this.mapButton.x = this.wndWidth / 2,
        this.mapButton.y = 21;
        var o = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "iconExpand.png");
        o.x = this.mapButton.x + this.mapButton.width / 2 - o.width - 10,
        o.y = 3,
        this.mapButtonGroup.add(o),
        this.windowGroup.add(this.mapButtonGroup),
        this.infoGroup.add(e),
        this.checkMapButtonVisibleState()
    }
    ,
    t.prototype.resize = function() {
        this.checkMapButtonVisibleState()
    }
    ,
    t.prototype.reset = function() {
        this.craftItemNameText.setText(" "),
        this.requiredCraftItemsGroup.removeAll(!0, !0),
        this.requiredCraftItemMessageText.setText(" "),
        this.craftInfoWndGroup.visible = !1,
        this.grindHoldMsgWndGroup.visible = !1,
        this.craftTapMsgWndGroup.visible = !1
    }
    ,
    t.prototype.showGrindMessage = function(t) {
        void 0 === t && (t = null),
        this.reset(),
        null != t && (this.isMobileDevice ? this.grindNameText.setText(t.toUpperCase()) : this.grindInfoText.setText(t.toUpperCase())),
        this.grindHoldMsgWndGroup.visible = !0
    }
    ,
    t.prototype.showCraftInfo = function(t) {
        this.reset(),
        this.craftInfoItem = t,
        null == this.craftInfoItem ? (this.craftTapMsgWndGroup.visible = !0,
        this.craftInfoBack2Img.visible = !1,
        this.checkMapButtonVisibleState()) : (this.updateInfo(),
        this.craftInfoWndGroup.visible = !0)
    }
    ,
    t.prototype.dispose = function() {
        this.sg_map_button_tap_.dispose()
    }
    ,
    t.prototype.createRequiredCraftItem = function(t, e, i, s) {
        var n = this.game.add.group()
          , r = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "bkgrey.png");
        r.anchor.setTo(0, 0),
        r.width = 50,
        r.height = 50,
        n.add(r);
        var o = this.game.add.sprite(25, 25, Managers.GameManager.KEY, i);
        o.anchor.setTo(.5, .5);
        if (o.scale.setTo(.8, .8),
        n.add(o),
        0 < s) {
            var a = GameAPI.createText(this.game, 0, 0, "grincraftstroke12white", s.toString(), 14);
            a.x = 50 - a.width / 2,
            a.y = 50 - a.height / 2,
            n.add(a)
        }
        return n.x = t,
        n.y = e,
        n
    }
    ,
    t.prototype.checkMapButtonVisibleState = function() {
        this.mapButtonGroup.visible = ScaleManager.orientation == ScaleManager.ORIENTATION_PORTRAIT && this.mapEnabled_ && !this.craftInfoBack2Img.visible
    }
    ,
    t.prototype.updateInfo = function() {
        var t = 0
          , e = 0
          , i = 0
          , s = 84
          , n = 1;
        for (this.craftItemNameText.setText(this.craftInfoItem.name),
        this.buildCraftItemMessageText.visible || (this.buildCraftItemMessageText.visible = !0),
        this.craftInfoBack2Img.visible && (this.craftInfoBack2Img.visible = !1),
        this.requiredCraftItemsGroup.removeAll(!0, !0),
        t = 0; t < this.craftInfoItem.requiredItems.length; t++) {
            4 < n && (e = n = 0,
            i += 54,
            s += 54,
            this.buildCraftItemMessageText.visible && (this.buildCraftItemMessageText.visible = !1),
            this.craftInfoBack2Img.visible || (this.craftInfoBack2Img.visible = !0));
            var r = this.craftInfoItem.requiredItems[t]
              , o = this.createRequiredCraftItem(e, i, r.nameSprite, r.count);
            this.requiredCraftItemsGroup.add(o),
            e += 54,
            n++
        }
        this.requiredCraftItemMessageText.setText(this.craftInfoItem.message),
        this.requiredCraftItemMessageText.setText(GameAPI.setWidthTextBTM(this.requiredCraftItemMessageText, this.wndWidth - 10)),
        this.requiredCraftItemMessageText.y = this.requiredCraftItemMessageText.height / 2 + s,
        this.checkMapButtonVisibleState()
    }
    ,
    t.prototype.testUpdateInfo = function(t) {
        var e = 0
          , i = 0;
        for (this.requiredCraftItemsGroup.removeAll(!0, !0),
        e = 0; e < t.length; e++) {
            var s = t[e]
              , n = this.createRequiredCraftItem(i, 0, s.nameSprite, s.count);
            this.requiredCraftItemsGroup.add(n),
            i += n.width + 5
        }
    }
    ,
    t
}(), NineImage = function() {
    function c() {}
    return c.create = function(t, e, i, s, n, r, o, a, h, l) {
        return void 0 === r && (r = 0),
        void 0 === o && (o = 0),
        void 0 === a && (a = 0),
        void 0 === h && (h = 0),
        void 0 === l && (l = !1),
        c._image = t.cache.getImage(s),
        c._frame = "string" == typeof n ? t.cache.getFrameByName(s, n) : t.cache.getFrameByIndex(s, n),
        c.calculateNineImage(e, i, r, o, a, h, l),
        c._nineImage = new Phaser.BitmapData(t,"NineImage" + c._textureKey++,c._width,c._height),
        c.renderNineImage(),
        c._nineImage
    }
    ,
    c.calculateNineImage = function(t, e, i, s, n, r, o) {
        var a = c._frame;
        if (c._centralWidth = a.width - s - r,
        c._centralHeight = a.height - i - n,
        o)
            c._horizontalRepeats = t,
            c._verticalRepeats = e,
            c._width = s + r + c._centralWidth * t,
            c._height = i + n + c._centralHeight * e,
            c._lastWidth = 0,
            c._lastHeight = 0;
        else {
            var h = t - s - r;
            c._horizontalRepeats = Math.floor(h / c._centralWidth),
            c._lastWidth = h % c._centralWidth;
            var l = e - i - n;
            c._verticalRepeats = Math.floor(l / c._centralHeight),
            c._lastHeight = l % c._centralHeight,
            c._width = t,
            c._height = e
        }
        c._leftWidth = s,
        c._rightWidth = r,
        c._topHeight = i,
        c._bottomHeight = n
    }
    ,
    c.renderNineImage = function() {
        var t = c._frame.y
          , e = 0;
        0 < c._topHeight && (c.renderNineImageRow(c._image, t, e, c._topHeight),
        t += c._topHeight,
        e += c._topHeight);
        for (var i = 0; i < c._verticalRepeats; i++)
            c.renderNineImageRow(c._image, t, e, c._centralHeight),
            e += c._centralHeight;
        0 < c._lastHeight && (c.renderNineImageRow(c._image, t, e, c._lastHeight),
        e += c._lastHeight),
        t += c._centralHeight,
        0 < c._bottomHeight && c.renderNineImageRow(c._image, t, e, c._bottomHeight)
    }
    ,
    c.renderNineImageRow = function(t, e, i, s) {
        var n = c._frame.x
          , r = 0;
        0 < c._leftWidth && (c._nineImage.copy(t, n, e, c._leftWidth, s, r, i),
        r += c._leftWidth,
        n += c._leftWidth);
        for (var o = 0; o < c._horizontalRepeats; o++)
            c._nineImage.copy(t, n, e, c._centralWidth, s, r, i),
            r += c._centralWidth;
        0 < c._lastWidth && (c._nineImage.copy(t, n, e, c._lastWidth, s, r, i),
        r += c._lastWidth),
        n += c._centralWidth,
        0 < c._rightWidth && c._nineImage.copy(t, n, e, c._rightWidth, s, r, i)
    }
    ,
    c._textureKey = 0,
    c
}(), FadeInOut = function() {
    function e(t) {
        this.fadeColor = 0,
        this.game = t
    }
    return e.init = function(t) {
        e.instance = new e(t)
    }
    ,
    e.prototype.fadeTo = function(t) {
        if (this.game.renderType != Phaser.CANVAS) {
            this.createBkg(),
            this.spr_bg.alpha = 0,
            this.nextState = t,
            this.game.add.existing(this.spr_bg);
            var e = this.game.add.tween(this.spr_bg);
            e.to({
                alpha: 1
            }, 500, null),
            e.onComplete.add(this.changeState, this),
            e.start()
        } else
            this.game.state.start(t)
    }
    ,
    e.prototype.createBkg = function() {
        this.spr_bg = this.game.make.graphics(0, 0),
        this.spr_bg.beginFill(this.fadeColor, 1),
        this.spr_bg.drawRect(ScaleManager.bkgX(), ScaleManager.bkgY(), ScaleManager.MaxWidth, ScaleManager.MaxHeight),
        this.spr_bg.endFill()
    }
    ,
    e.prototype.changeState = function() {
        this.game.state.start(this.nextState)
    }
    ,
    e.prototype.fadeOut = function() {
        this.createBkg(),
        this.spr_bg.alpha = 1,
        this.game.add.existing(this.spr_bg);
        var t = this.game.add.tween(this.spr_bg);
        t.to({
            alpha: 0
        }, 500, null),
        t.start()
    }
    ,
    e
}(), MessageWindow = function() {
    function t(t, e, i, s, n, r) {
        this.game = t,
        this.parentGroup = e,
        this.title = i,
        this.message = s,
        this.buttonsData = n,
        this.showIcon = r,
        this.mainGroup = this.game.add.group(),
        this.parentGroup.add(this.mainGroup)
    }
    return t.prototype.create = function() {
        var t = this
          , e = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "message_win.png");
        e.anchor.setTo(.5, .5),
        e.width = 335,
        e.height = 412,
        this.mainGroup.add(e);
        var i = GameAPI.createText(this.game, 0, 0, "grincraftstroke25zheltyi", this.title, 25, 16766720);
        i.y = -e.height / 2 + 30,
        this.mainGroup.add(i);
        var s = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "message_win_map_pic.png");
        s.anchor.setTo(.5, .5),
        s.y = -e.height / 2 + 131,
        this.mainGroup.add(s),
        s.visible = this.showIcon;
        var n = GameAPI.createText(this.game, 0, 0, "grincraft12fioletovy", this.message, 18);
        GameAPI.setWidthTextBTM(n, e.width - 10),
        n.y = n.height / 2 + 15,
        this.mainGroup.add(n);
        var r = this.buttonsData.length
          , o = 2 == r ? 95 : 190
          , a = this.createTextButton(this.buttonsData[0].name, function() {
            t.buttonsData[0].fn(t)
        }, o, 60);
        if (a.y = e.height / 2 - a.height / 2 - 23,
        this.mainGroup.add(a),
        2 == r) {
            var h = this.createTextButton(this.buttonsData[1].name, function() {
                t.buttonsData[1].fn(t)
            }, o, 60);
            h.y = e.height / 2 - h.height / 2 - 23,
            this.mainGroup.add(h),
            a.x = -o,
            h.x = o
        }
    }
    ,
    t.prototype.close = function() {
        this.mainGroup.destroy(!0)
    }
    ,
    t.prototype.createTextButton = function(t, e, i, s) {
        void 0 === i && (i = 100),
        void 0 === s && (s = 34);
        var n = this.game.add.group()
          , r = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "menubutton1.png");
        r.anchor.setTo(.5, .5),
        r.width = i,
        r.height = s,
        r.inputEnabled = !0,
        r.events.onInputUp.add(function(t) {
            null != e && e()
        }, this),
        n.add(r);
        var o = GameAPI.createText(this.game, 0, 0, "grincraft12fioletovy", t, 18);
        return n.add(o),
        n
    }
    ,
    t
}(), Gameplay = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this
    }
    return __extends(e, t),
    Object.defineProperty(e.prototype, "isGamePaused", {
        get: function() {
            return this._isGamePaused
        },
        set: function(t) {
            this._isGamePaused = t,
            this._isGamePaused && this.stopTimer(),
            this._isGamePaused || this.startTimer()
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(e.prototype, "isMusicPaused", {
        get: function() {
            return this._isMusicPaused
        },
        set: function(t) {
            this._isMusicPaused = t,
            this._isMusicPaused && Managers.GameManager.music.music.pause(),
            this._isMusicPaused || Managers.GameManager.music.music.resume()
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(e.prototype, "isMapEnabled", {
        get: function() {
            return this.isMapEnabled_
        },
        set: function(t) {
            this.isMapEnabled_ = t,
            this.checkMapEnabledState()
        },
        enumerable: !0,
        configurable: !0
    }),
    e.prototype.preload = function() {
        GameAPI.scrollbitmapdata = NineImage.create(this.game, 15, 170, "atlas", "scrollbar.png", 2, 2, 2, 2, !1),
        Services.init(this.game),
        FadeInOut.init(this.game),
        GameConfig.isCheatsLevelEnabled && SaveAPI.initDebug(),
        Managers.GameManager.save = JSON.parse(SaveAPI.getAccess(SaveAPI.SAVE_DATA)),
        null == Managers.GameManager.save && (Managers.GameManager.save = SaveAPI.generateDefaultData(0)),
        Managers.GameManager.music = new Music(this.game),
        this.isMobileDevice = Services.isMobile(),
        this.msgCurtain = null,
        this.game.stage.backgroundColor = 0,
        this.isGamePaused = !1,
        this.isMusicPaused = !1,
        this.isClick = !1,
        this.particleCount = Managers.GameManager.save.particleCount,
        this.isMerge = Managers.GameManager.save.isMerge,
        this.isAutomated = !1,
        this.isMapEnabled_ = !1,
        this.isAchievementsWindowOpened = !1,
        this.isSettingsWindowOpened = !1,
        this.isMessageWindowOpened = !1,
        this.isWorldMapWindowOpened = !1,
        this.game.physics.startSystem(Phaser.Physics.ARCADE),
        this.primeGroup = this.game.add.group(),
        this.bkgGroup = this.game.add.group(),
        this.menuGroup = this.game.add.group(),
        this.craftInfoGroup = this.game.add.group(),
        this.grindsGroup = this.game.add.group(),
        this.craftGroup = this.game.add.group(),
        this.inventoryGroup = this.game.add.group(),
        this.curtainGroup = this.game.add.group(),
        this.worldMapGroup = this.game.add.group(),
        this.achievementsGroup = this.game.add.group(),
        this.achievementsEffectsGroup = this.game.add.group(),
        this.settingsGroup = this.game.add.group(),
        this.messageCurtainGroup = this.game.add.group(),
        this.messageGroup = this.game.add.group(),
        this.gameLevel = Managers.GameManager.save.level,
        this.soundCount = 0,
        this.worldItems = [],
        this.inventoryItems = [],
        this.isCheatsEnabled = !1,
        "City State" == this.gameLevel && (this.mainGrinds = GameAPI.grinds,
        this.mainGrinders = GameAPI.grinders,
        this.mainCrafters = GameAPI.crafters),
        "Chasm Mine" == this.gameLevel && (this.mainGrinds = GameAPI.chasmMineGrinds,
        this.mainGrinders = GameAPI.chasmMineGrinders,
        this.mainCrafters = GameAPI.chasmMineCrafters),
        this.isMobileDevice ? (this.widthItem = 50,
        this.heightItem = 50) : (this.widthItem = 65,
        this.heightItem = 65),
        this.menu = new Menu(this,this.game,this.menuGroup),
        this.settingsWindow = new SettingsWindow(this,this.game,this.settingsGroup),
        this.grindsLogic = new MobileGrinds(this,this.game,this.grindsGroup,this.mainGrinds,this.mainGrinders),
        this.achievementsList = new AchievementsList(this.game),
        this.mobileAchievements = new MobileAchievements(this,this.achievementsGroup,this.achievementsEffectsGroup,100),
        this.mobileAchievements.setAchievementsList(this.achievementsList),
        this.craftInfo = new CraftInfo(this,this.game,this.craftInfoGroup),
        this.worldMap = new WorldMap(this,this.game,this.worldMapGroup),
        this.primeGroup.add(this.bkgGroup),
        this.primeGroup.add(this.craftGroup),
        this.primeGroup.add(this.inventoryGroup),
        this.primeGroup.add(this.menuGroup),
        this.primeGroup.add(this.grindsGroup),
        this.primeGroup.add(this.craftInfoGroup),
        this.primeGroup.add(this.curtainGroup),
        this.primeGroup.add(this.worldMapGroup),
        this.primeGroup.add(this.achievementsGroup),
        this.primeGroup.add(this.achievementsEffectsGroup),
        this.primeGroup.add(this.settingsGroup),
        this.primeGroup.add(this.messageCurtainGroup),
        this.primeGroup.add(this.messageGroup)
    }
    ,
    e.prototype.create = function() {
        var i = this;
        h5branding.google.sendScreenView("gameplay"),
        Fabrique.PauseHandler.getInstance().onPauseCallback.add(function() {}, this),
        this.isFirstUpdate = !1,
        this.timeMsToSFactor = 1e3,
        this.prevTimeMs = 0,
        this.currTimeMs = 0,
        this.deltaTime = 0,
        this.createBackground(),
        this.createCurtain(),
        this.grindsLogic.sg_selected_grind_item_changed.add(function(t) {
            i.craft.unselectSelectedItem();
            var e = t.selectedGrindItem;
            null != e ? i.craftInfo.showGrindMessage(e.name) : i.craftInfo.showCraftInfo(null)
        }, this),
        this.grindsLogic.createGrind();
        var t = 0;
        for (t = 0; t < Managers.GameManager.save.achievement.length; ++t) {
            var e = Managers.GameManager.save.achievement[t];
            this.achievementsList.addItem(e.text, e.sprite, !1, !1, !1)
        }
        this.achievementsList.sg_list_update.add(function(t, e) {
            i.mobileAchievements.updateInfo()
        }, this),
        this.createMenu(),
        this.createCraftInfo(),
        this.createCraft(),
        this.createInventory(),
        this.createWorldMap(),
        document.addEventListener("visibilitychange", this.handleVisibilityChange, !1),
        window.onbeforeunload = this.saveGame.bind(this),
        ScaleManager.onResize.add(this.rescale, this),
        ScaleManager.SizeCalculation(this.game),
        this.isMapEnabled = Managers.GameManager.save.mapVisible;
        var s = null
          , n = null
          , r = null
          , o = null
          , a = null;
        if (GameConfig.isCheatsEnabled && ((s = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "iconExpand.png")).inputEnabled = !0,
        s.events.onInputUp.add(function() {
            i.isCheatsEnabled = !i.isCheatsEnabled,
            i.isCheatsEnabled ? (s.frameName = "iconContract.png",
            i.worldItems.forEach(function(t) {
                "compass" == t.name && 0 == t.count && (t.count = 10),
                "paper" == t.name && 0 == t.count && (t.count = 50),
                "crafting table" == t.name && 0 == t.count && (t.count = 10),
                "ship" == t.name && 0 == t.count && (t.count = 10),
                "shipyard" == t.name && 0 == t.count && (t.count = 10)
            }, i),
            i.resetCubes()) : s.frameName = "iconExpand.png"
        }, this),
        this.primeGroup.add(s)),
        GameConfig.isCheatsLevelEnabled && ((n = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "iconExpand.png")).inputEnabled = !0,
        n.events.onInputUp.add(function() {
            if (GameConfig.isCityStateLevelPassed && 0 < GameConfig.cityStateLevelData.length)
                try {
                    var t = JSON.parse(GameConfig.cityStateLevelData);
                    null != t && null != t && (Managers.GameManager.save = t,
                    SaveAPI.GAME_SAVE = Managers.GameManager.save,
                    SaveAPI.setForce(SaveAPI.SAVE_DATA, JSON.stringify(SaveAPI.GAME_SAVE)),
                    i.game.state.start("Game"))
                } catch (t) {}
        }, this),
        this.primeGroup.add(n),
        null != s && (n.x = s.x + s.width + 10),
        (r = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "iconExpand.png")).inputEnabled = !0,
        r.events.onInputUp.add(function() {
            if (GameConfig.isChasmMineLevelPassed && 0 < GameConfig.chasmMineLevelData.length)
                try {
                    var t = JSON.parse(GameConfig.chasmMineLevelData);
                    null != t && null != t && (Managers.GameManager.save = t,
                    SaveAPI.GAME_SAVE = Managers.GameManager.save,
                    SaveAPI.setForce(SaveAPI.SAVE_DATA, JSON.stringify(SaveAPI.GAME_SAVE)),
                    i.game.state.start("Game"))
                } catch (t) {}
        }, this),
        this.primeGroup.add(r),
        r.x = n.x + n.width + 10,
        (o = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "iconExpand.png")).inputEnabled = !0,
        o.events.onInputUp.add(function() {
            i.saveGame();
            var t = Managers.GameManager.save;
            JSON.stringify(t)
        }, this),
        this.primeGroup.add(o),
        o.x = r.x + r.width + 10),
        GameConfig.isCheatsEnabled) {
            (a = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "iconExpand.png")).inputEnabled = !0,
            a.events.onInputUp.add(function() {
                i.mobileAchievements.showPanel()
            }, this),
            this.primeGroup.add(a);
            var h = null;
            null != o ? h = o : null != r ? h = r : null != n ? h = n : null != s && (h = s),
            null != h && (a.x = h.x + h.width + 10)
        }
        this.game.time.events.loop(60 * Phaser.Timer.SECOND, function() {
            i.saveGame()
        }, this)
    }
    ,
    e.prototype.update = function() {
        if (this.isFirstUpdate)
            return this.isFirstUpdate = !1,
            void (this.prevTimeMs = Date.now());
        this.currTimeMs = Date.now(),
        this.deltaTime = (this.currTimeMs - this.prevTimeMs) / this.timeMsToSFactor,
        this.prevTimeMs = this.currTimeMs,
        this.craft.update(this.deltaTime),
        this.inventory.update(this.deltaTime),
        this.mobileAchievements.update(this.deltaTime)
    }
    ,
    e.prototype.shutdown = function() {
        Fabrique.PauseHandler.getInstance().onPauseCallback.remove(function() {}, this),
        ScaleManager.onResize.remove(this.rescale, this),
        this.menu.dispose(),
        this.settingsWindow.dispose(),
        this.mobileAchievements.sg_hide.removeAll(),
        this.worldMap.dispose(),
        this.craftInfo.dispose(),
        this.craft.dispose(),
        this.inventory.dispose(),
        this.grindsLogic.dispose()
    }
    ,
    e.prototype.isOneOfWindowsOpened = function(t) {
        var e = t != Managers.GameManager.WND_ACHIEVEMENTS_ID && this.isAchievementsWindowOpened;
        return e = (e = (e = e || t != Managers.GameManager.WND_SETTINGS_ID && this.isSettingsWindowOpened) || t != Managers.GameManager.WND_MESSAGE_ID && this.isMessageWindowOpened) || t != Managers.GameManager.WND_MAP_ID && this.isWorldMapWindowOpened
    }
    ,
    e.prototype.closeOpenedWindow = function() {
        (this.isAchievementsWindowOpened || this.isSettingsWindowOpened || this.isWorldMapWindowOpened) && (this.isGamePaused = !1,
        this.isClick = !1,
        this.craft.disabled = !1,
        this.inventory.disabled = !1,
        this.curtainGroup.visible = !1),
        this.isAchievementsWindowOpened && (this.isAchievementsWindowOpened = !1,
        this.mobileAchievements.hide(!1)),
        this.isSettingsWindowOpened && (this.isSettingsWindowOpened = !1,
        this.settingsWindow.visible = !1),
        this.isWorldMapWindowOpened && (this.isWorldMapWindowOpened = !1,
        this.worldMap.visible = !1)
    }
    ,
    e.prototype.createBasicButton = function(t, e, i, s, n, r) {
        var o = this.game.add.group()
          , a = this.game.add.sprite(0, 0, Managers.GameManager.KEY, i);
        return a.anchor.setTo(.5, .5),
        a.inputEnabled = !0,
        null != r && a.events.onInputUp.add(r, this),
        o.add(a),
        o.x = t,
        o.y = e,
        o.visible = s,
        n.add(o),
        o
    }
    ,
    e.prototype.getPortraitMaxBottomOffset = function() {
        var t = this.getPortraitBottomOffsetForGroup(this.menuGroup)
          , e = this.getPortraitBottomOffsetForGroup(this.craftInfoGroup)
          , i = this.getPortraitBottomOffsetForGroup(this.grindsGroup);
        return Math.max(t, e, i)
    }
    ,
    e.prototype.getLandscapeMaxLeftOffset = function() {
        var t = this.grindsGroup.x + this.grindsGroup.width
          , e = this.craftInfoGroup.x + this.craftInfo.width;
        return Math.max(t, e)
    }
    ,
    e.prototype.getLandscapeMaxRightOffset = function() {
        return this.game.width - this.menuGroup.x
    }
    ,
    e.prototype.resetCubes = function() {
        this.craft.resetCubes()
    }
    ,
    e.prototype.createBeat = function(t, e, i, s, n, r, o, a) {
        var h = this;
        void 0 === n && (n = null),
        void 0 === o && (o = "congratulations"),
        void 0 === a && (a = !0),
        i && (this.isGamePaused = !0,
        this.isClick = !0,
        this.craft.disabled = !0,
        this.curtainGroup.visible = !0);
        var l = [];
        l[0] = {
            name: e,
            fn: function(t) {
                t.close(),
                i && (h.isGamePaused = !1,
                h.isClick = !1,
                h.craft.disabled = !1,
                h.curtainGroup.visible = !1),
                null != s && s()
            }
        },
        null != n && (l[1] = {
            name: n,
            fn: function(t) {
                t.close(),
                i && (h.isGamePaused = !1,
                h.isClick = !1,
                h.craft.disabled = !1,
                h.curtainGroup.visible = !1),
                null != r && r()
            }
        }),
        new MessageWindow(this.game,this.messageGroup,o,t,l,a).create()
    }
    ,
    e.prototype.hideGrind = function() {
        if (this.isAutomated) {
            this.grindsLogic.grinds.forEach(function(t) {
                t.isAutocraft || !1
            }, this)
        }
    }
    ,
    e.prototype.saveGame = function() {
        var e = this
          , i = 0;
        for (i = 0; i < this.worldItems.length; ++i)
            Managers.GameManager.save.countItem.forEach(function(t) {
                if (t.name == e.worldItems[i].name)
                    return t.isAchievement = e.worldItems[i].isAchievement,
                    void (t.count = e.worldItems[i].count)
            }, this);
        Managers.GameManager.save.inventoryItem = [],
        this.inventoryItems.forEach(function(t) {
            var e = new CountItem;
            e.name = t.name,
            e.path = t.path,
            e.count = t.count,
            Managers.GameManager.save.inventoryItem.push(e)
        }, this),
        Managers.GameManager.save.isMerge = this.isMerge,
        Managers.GameManager.save.isAutomated = this.isAutomated,
        Managers.GameManager.save.grind = this.grindsLogic.materials,
        Managers.GameManager.save.mapVisible = this.isMapEnabled_,
        Managers.GameManager.save.musicCount = Managers.GameManager.music.musicCount,
        Managers.GameManager.save.soundCount = Managers.GameManager.music.soundCount,
        Managers.GameManager.save.particleCount = this.particleCount,
        SaveAPI.GAME_SAVE = Managers.GameManager.save,
        SaveAPI.setForce(SaveAPI.SAVE_DATA, JSON.stringify(SaveAPI.GAME_SAVE))
    }
    ,
    e.prototype.createInventoryItem = function(t, e, i) {
        this.inventory.createInventoryItem(t, e, i)
    }
    ,
    e.prototype.resetInventory = function() {
        this.isMerge || this.inventory.replaceCubes()
    }
    ,
    e.prototype.testCreateDebugInfo = function() {
        this.testDebugLabels = [];
        var t = 0
          , e = this.game.add.group()
          , i = ScaleManager.GameWidth
          , s = ScaleManager.GameHeight
          , n = this.game.width
          , r = this.game.height
          , o = ScaleManager.GameWidth
          , a = ScaleManager.GameHeight
          , h = Math.min(window.innerWidth / ScaleManager.GameWidth, window.innerHeight / ScaleManager.GameHeight);
        o = Math.ceil(window.innerWidth / h + 1),
        a = Math.ceil(window.innerHeight / h + 1);
        var l = window.innerWidth
          , c = window.innerHeight
          , d = window.devicePixelRatio;
        t = this.testDebugInfoReportLine("Game design size: " + i + " x " + s, t, 16, e),
        t = this.testDebugInfoReportLine("Game world size: " + n + " x " + r, t, 16, e),
        t = this.testDebugInfoReportLine("Game scaled size: " + o + " x " + a, t, 16, e),
        t = this.testDebugInfoReportLine("Window size (orig): " + l + " x " + c, t, 16, e),
        t = this.testDebugInfoReportLine("Game scale: " + h, t, 16, e),
        t = this.testDebugInfoReportLine("DPR: " + d, t, 16, e)
    }
    ,
    e.prototype.testDebugInfoReportLine = function(t, e, i, s) {
        var n = GameAPI.createText(this.game, 0, e, "grincraftstroke25zheltyi", t, i);
        return n.anchor.setTo(0, 0),
        n.align = "left",
        s.add(n),
        this.testDebugLabels.push(n),
        e + i + 5
    }
    ,
    e.prototype.testCalcDebugInfo = function() {
        var t = {}
          , e = ScaleManager.GameWidth
          , i = ScaleManager.GameHeight
          , s = this.game.width
          , n = this.game.height
          , r = ScaleManager.GameWidth
          , o = ScaleManager.GameHeight
          , a = Math.min(window.innerWidth / ScaleManager.GameWidth, window.innerHeight / ScaleManager.GameHeight);
        r = Math.ceil(window.innerWidth / a + 1),
        o = Math.ceil(window.innerHeight / a + 1);
        var h = window.innerWidth
          , l = window.innerHeight
          , c = window.devicePixelRatio;
        return ScaleManager.orientation == ScaleManager.ORIENTATION_PORTRAIT ? (t.gameDesignWidth = i,
        t.gameDesignHeight = e) : (t.gameDesignWidth = e,
        t.gameDesignHeight = i),
        t.gameWidth = s,
        t.gameHeight = n,
        t.gameScaledWidth = r,
        t.gameScaledHeight = o,
        t.windowWidth = h,
        t.windowHeight = l,
        t.gameScale = a,
        t.dpr = c,
        t
    }
    ,
    e.prototype.testUpdateDebugInfo = function() {
        if (null != this.testDebugLabels && null != this.testDebugLabels) {
            var t = this.testCalcDebugInfo();
            this.testDebugLabels[0].setText("Game design size: " + t.gameDesignWidth + " x " + t.gameDesignHeight),
            this.testDebugLabels[1].setText("Game world size: " + t.gameWidth + " x " + t.gameHeight),
            this.testDebugLabels[2].setText("Game scaled size: " + t.gameScaledWidth + " x " + t.gameScaledHeight),
            this.testDebugLabels[3].setText("Window size (orig): " + t.windowWidth + " x " + t.windowHeight),
            this.testDebugLabels[4].setText("Game scale: " + t.gameScale),
            this.testDebugLabels[5].setText("DPR: " + t.dpr)
        }
    }
    ,
    e.prototype.getPortraitBottomOffsetForGroup = function(t) {
        return this.game.height - t.y
    }
    ,
    e.prototype.stopTimer = function() {
        null != this.grindsLogic && this.grindsLogic.stopGrindTimers(),
        null != this.worldItems && this.worldItems.forEach(function(t) {
            null != t.timerAutocraft && t.timerAutocraft.timer.pause()
        }, this)
    }
    ,
    e.prototype.startTimer = function() {
        null != this.grindsLogic && this.grindsLogic.startGrindTimers(),
        null != this.worldItems && this.worldItems.forEach(function(t) {
            null != t.timerAutocraft && (t.timerAutocraft.timer.paused = !1)
        }, this)
    }
    ,
    e.prototype.createTextButton = function(t, e, i, s, n, r, o, a) {
        var h = this;
        void 0 === o && (o = 99),
        void 0 === a && (a = 33);
        var l = this.game.add.group()
          , c = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "menubutton1.png");
        c.width = o,
        c.height = a,
        c.anchor.setTo(.5, .5),
        c.inputEnabled = !0,
        c.events.onInputOver.add(function(t) {
            t.frameName = "menubutton2.png"
        }, this),
        c.events.onInputOut.add(function(t) {
            t.frameName = "menubutton1.png"
        }, this),
        n && c.events.onInputUp.add(function(t) {
            t.parent.parent.destroy(!0)
        }, this),
        s && c.events.onInputUp.add(function(t) {
            h.isGamePaused = !1
        }, this, 1),
        null != r && c.events.onInputUp.add(r, this, 2),
        l.add(c);
        var d = GameAPI.createText(this.game, 0, 0, "grincraft12fioletovy", i, 12);
        return l.add(d),
        l.x = t,
        l.y = e,
        l.add(c),
        l
    }
    ,
    e.prototype.createBasicTextButton = function(t, e, i, s, n) {
        void 0 === s && (s = 100),
        void 0 === n && (n = 34);
        var r = this.game.add.group()
          , o = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "menubutton1.png");
        o.anchor.setTo(.5, .5),
        o.width = s,
        o.height = n,
        o.inputEnabled = !0,
        o.events.onInputUp.add(function(t) {
            null != i && i()
        }, this),
        r.add(o);
        var a = GameAPI.createText(this.game, 0, 0, "grincraft12fioletovy", t, e);
        return r.add(a),
        r
    }
    ,
    e.prototype.createBackground = function() {
        this.background = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "background_main.png"),
        this.bkgGroup.add(this.background)
    }
    ,
    e.prototype.createMenu = function() {
        var i = this;
        this.menu.sg_achievements_tap.add(function(t) {
            if (!i.isOneOfWindowsOpened(Managers.GameManager.WND_ACHIEVEMENTS_ID)) {
                var e = i.mobileAchievements.isVisible();
                e || (e = !0,
                i.menu.hideNewAchievementsIcon(),
                i.isGamePaused = e,
                i.isClick = e,
                i.isAchievementsWindowOpened = e,
                i.craft.disabled = e,
                i.inventory.disabled = e,
                i.curtainGroup.visible = e,
                i.mobileAchievements.updateInfo(),
                i.mobileAchievements.show())
            }
        }, this),
        this.menu.sg_settings_tap.add(function(t) {
            if (!i.isOneOfWindowsOpened(Managers.GameManager.WND_SETTINGS_ID)) {
                var e = i.settingsWindow.visible;
                e || (e = !0,
                i.saveGame(),
                i.settingsWindow.visible = e,
                i.isSettingsWindowOpened = e,
                i.isClick = e,
                i.isGamePaused = e,
                i.craft.disabled = e,
                i.inventory.disabled = e,
                i.curtainGroup.visible = e)
            }
        }, this),
        this.menu.sg_map_button_tap.add(function(t) {
            if (!i.isOneOfWindowsOpened(Managers.GameManager.WND_MAP_ID)) {
                var e = i.worldMap.visible;
                e || (e = !0,
                i.worldMap.visible = e,
                i.isWorldMapWindowOpened = e,
                i.isClick = e,
                i.isGamePaused = e,
                i.craft.disabled = e,
                i.inventory.disabled = e,
                i.curtainGroup.visible = e)
            }
        }, this),
        this.menu.createWindow(),
        this.settingsWindow.sg_close.add(function(t) {
            i.settingsWindow.visible = !1,
            i.isClick = !1,
            i.isSettingsWindowOpened = !1,
            i.craft.disabled = !1,
            i.inventory.disabled = !1,
            i.isGamePaused = !1,
            i.curtainGroup.visible = !1
        }, this),
        this.settingsWindow.sg_music_minus_tap.add(function(t) {
            Managers.GameManager.music.musicCount = i.settingsWindow.musicCount,
            Managers.GameManager.music.musicVolume()
        }, this),
        this.settingsWindow.sg_music_plus_tap.add(function(t) {
            Managers.GameManager.music.musicCount = i.settingsWindow.musicCount,
            Managers.GameManager.music.musicVolume()
        }, this),
        this.settingsWindow.sg_sound_minus_tap.add(function(t) {
            Managers.GameManager.music.soundCount = i.settingsWindow.soundCount
        }, this),
        this.settingsWindow.sg_sound_plus_tap.add(function(t) {
            Managers.GameManager.music.soundCount = i.settingsWindow.soundCount
        }, this),
        this.settingsWindow.sg_particles_minus_tap.add(function(t) {
            i.particleCount = i.settingsWindow.particlesCount
        }, this),
        this.settingsWindow.sg_particles_plus_tap.add(function(t) {
            i.particleCount = i.settingsWindow.particlesCount
        }, this),
        this.settingsWindow.sg_delete_progress_tap.add(this.onSettingsWndDeleteProgress, this),
        this.settingsWindow.sg_is_automated_changed_tap.add(function(t) {
            i.isAutomated = i.settingsWindow.isAutomated
        }, this),
        this.settingsWindow.sg_is_merge_changed_tap.add(function(t) {
            i.isMerge = i.settingsWindow.isMerge,
            i.saveGame(),
            i.inventory.visible = !i.isMerge,
            null != i.craft.selectedCraftItem && (i.craft.unselectSelectedItem(),
            i.craftInfo.showCraftInfo(null)),
            i.rescale()
        }, this),
        this.settingsWindow.musicCount = Managers.GameManager.music.musicCount,
        this.settingsWindow.soundCount = Managers.GameManager.music.soundCount,
        this.settingsWindow.particlesCount = this.particleCount,
        this.settingsWindow.isAutomated = this.isAutomated,
        this.settingsWindow.isMerge = this.isMerge,
        this.settingsWindow.createWindow(),
        this.settingsWindow.visible = !1,
        this.mobileAchievements.createWindow(),
        this.mobileAchievements.resize(),
        this.mobileAchievements.hide(),
        this.mobileAchievements.sg_hide.add(function(t) {
            i.isGamePaused = !1,
            i.isClick = !1,
            i.isAchievementsWindowOpened = !1,
            i.craft.disabled = !1,
            i.inventory.disabled = !1,
            i.curtainGroup.visible = !1
        }, this)
    }
    ,
    e.prototype.createCraftInfo = function() {
        var i = this;
        this.craftInfo.createWindow(),
        this.craftInfo.sg_map_button_tap.add(function(t) {
            if (!i.isOneOfWindowsOpened(Managers.GameManager.WND_MAP_ID)) {
                var e = i.worldMap.visible;
                e || (e = !0,
                i.worldMap.visible = e,
                i.isWorldMapWindowOpened = e,
                i.isClick = e,
                i.isGamePaused = e,
                i.craft.disabled = e,
                i.inventory.disabled = e,
                i.curtainGroup.visible = e)
            }
        }, this),
        this.craftInfo.showCraftInfo(null)
    }
    ,
    e.prototype.createCraft = function() {
        var i = this;
        this.craft = new Craft(this,this.game,this.craftGroup,this.mainGrinds,this.mainGrinders,this.mainCrafters,this.widthItem,this.heightItem,this.worldItems),
        this.craft.sg_craft_selected_item_changed.add(function(t) {
            i.grindsLogic.unselectSelectedItem();
            var e = t.selectedCraftItem;
            null != e ? i.craftInfo.showCraftInfo(e.infoItem) : i.craftInfo.showCraftInfo(null)
        }, this),
        this.craft.create()
    }
    ,
    e.prototype.createInventory = function() {
        this.inventory = new Inventory(this,this.game,this.inventoryGroup,this.inventoryItems,this.worldItems,this.widthItem,this.heightItem),
        this.inventory.create(),
        this.inventory.visible = !this.isMerge
    }
    ,
    e.prototype.createCurtain = function() {
        var t = this;
        this.curtain = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "coub.png"),
        this.curtain.alpha = .6,
        this.curtainGroup.add(this.curtain),
        this.curtain.inputEnabled = !0,
        this.curtain.events.onInputUp.add(function() {
            t.closeOpenedWindow()
        }, this),
        this.curtainGroup.visible = !1
    }
    ,
    e.prototype.createMsgCurtain = function() {
        this.msgCurtain = this.game.add.sprite(0, 0, Managers.GameManager.KEY, "coub.png"),
        this.msgCurtain.alpha = .6,
        this.msgCurtain.inputEnabled = !0,
        this.messageCurtainGroup.add(this.msgCurtain)
    }
    ,
    e.prototype.createWorldMap = function() {
        var e = this;
        this.worldMap.create(),
        this.worldMap.sg_close.add(function(t) {
            e.isWorldMapWindowOpened = !1,
            e.worldMap.visible = !1,
            e.isClick = !1,
            e.isGamePaused = !1,
            e.craft.disabled = !1,
            e.inventory.disabled = !1,
            e.curtainGroup.visible = !1
        }, this),
        this.worldMap.visible = !1
    }
    ,
    e.prototype.rescale = function() {
        this.background.x = -100,
        this.background.y = -100,
        this.background.width = this.game.width + 100,
        this.background.height = this.game.height + 100,
        this.curtain.x = -100,
        this.curtain.y = -100,
        this.curtain.width = this.game.width + 100,
        this.curtain.height = this.game.height + 100,
        this.resizeMsgCurtain(),
        this.menu.resize(),
        this.craftInfo.resize(),
        this.grindsLogic.resize(),
        this.worldMap.resize(),
        this.menuGroup.x = this.game.width - this.menu.width - 10,
        this.menuGroup.y = this.game.height - this.menu.height - 20,
        ScaleManager.orientation == ScaleManager.ORIENTATION_PORTRAIT ? this.rescalePortrait() : this.rescaleLandscape(),
        this.grindsLogic.resizeHint(),
        this.settingsGroup.x = this.game.width / 2,
        this.settingsGroup.y = this.game.height / 2,
        this.achievementsGroup.x = this.game.width / 2,
        this.achievementsGroup.y = this.game.height / 2,
        this.messageGroup.x = this.game.width / 2,
        this.messageGroup.y = this.game.height / 2,
        this.mobileAchievements.resize(),
        this.craft.resize(),
        this.inventory.resize()
    }
    ,
    e.prototype.rescalePortrait = function() {
        this.craftInfoGroup.x = this.menuGroup.x - this.craftInfo.width - 10,
        this.craftInfoGroup.y = this.game.height - this.craftInfo.height - 20,
        this.grindsGroup.x = 10,
        this.grindsGroup.y = this.game.height - this.grindsLogic.height - 20
    }
    ,
    e.prototype.rescaleLandscape = function() {
        this.craftInfoGroup.x = 10,
        this.craftInfoGroup.y = this.game.height - this.craftInfo.height - 20,
        this.grindsGroup.x = 10,
        this.grindsGroup.y = 10
    }
    ,
    e.prototype.resizeMsgCurtain = function() {
        null != this.msgCurtain && (this.msgCurtain.x = -100,
        this.msgCurtain.y = -100,
        this.msgCurtain.width = this.game.width + 200,
        this.msgCurtain.height = this.game.height + 200)
    }
    ,
    e.prototype.deleteProgress = function() {
        var t = this;
        Managers.GameManager.music.music.stop(),
        Managers.GameManager.save = SaveAPI.generateDefaultData(0),
        SaveAPI.GAME_SAVE = Managers.GameManager.save,
        SaveAPI.setForce(SaveAPI.SAVE_DATA, JSON.stringify(SaveAPI.GAME_SAVE)),
        Fabrique.AdHandler.getInstance().showAd("resetGame", function() {
            t.game.state.start(e.Name, !0, !1),
            h5branding.google.sendScreenView("gameplay")
        })
    }
    ,
    e.prototype.handleVisibilityChange = function() {
        document.hidden || document.msHidden ? (this.soundCount = Managers.GameManager.music.soundCount,
        Managers.GameManager.music.soundCount = 0,
        Managers.GameManager.music.music.stop()) : (Managers.GameManager.music.soundCount = this.soundCount,
        Managers.GameManager.music.music.play())
    }
    ,
    e.prototype.checkMapEnabledState = function() {
        this.craftInfo.mapEnabled = this.isMapEnabled_,
        this.menu.mapEnabled = this.isMapEnabled_
    }
    ,
    e.prototype.onSettingsWndDeleteProgress = function(t) {
        var e = this;
        this.createMsgCurtain(),
        this.resizeMsgCurtain(),
        this.createBeat("erase_progress", "yes", !1, function() {
            e.msgCurtain.destroy(!0),
            e.deleteProgress()
        }, "no", function() {
            e.msgCurtain.destroy(!0)
        }, "confirmation", !1)
    }
    ,
    e.Name = "gameplay",
    e
}(Phaser.State), Music = function() {
    function t(t) {
        this.game = t,
        this.soundCount = Managers.GameManager.save.soundCount,
        this.musicCount = Managers.GameManager.save.musicCount,
        this.music = this.game.make.audio("track13", this.musicCount / 100);
        var e = SaveAPI.getAccess(SaveAPI.SOUND);
        null == e && (e = !0),
        this.SoundActive = e;
        var i = SaveAPI.getAccess(SaveAPI.MUSIC);
        null == i && (i = !0),
        this.MusicActive = i,
        this.playMusic()
    }
    return t.prototype.playMusic = function() {
        this.music.isPlaying || (this.music.loop = !0,
        null != this.musicCount && (this.music.volume = this.musicCount / 100),
        this.music.play())
    }
    ,
    t.prototype.startAudioGrind = function(t) {
        this.game.make.audio(t, this.soundCount / 100).play()
    }
    ,
    t.prototype.musicVolume = function() {
        this.game.add.tween(this.music).to({
            volume: this.musicCount / 100
        }, 500, Phaser.Easing.Linear.None, !0)
    }
    ,
    t.prototype.getNameObject = function(t) {
        if ("music" == t) {
            if (this.MusicActive)
                return "musicOn.png";
            if (!this.MusicActive)
                return "musicOff.png"
        }
        if ("sound" == t) {
            if (this.SoundActive)
                return "soundOn.png";
            if (!this.SoundActive)
                return "soundOff.png"
        }
    }
    ,
    t.prototype.statusSound = function(t, e, i, s) {
        void 0 === s && (s = "sound"),
        "sound" == s && (this.SoundActive = !this.SoundActive,
        SaveAPI.setForce(SaveAPI.SOUND, this.SoundActive),
        t.frameName = this.getNameObject(s)),
        "music" == s && (this.MusicActive = !this.MusicActive,
        SaveAPI.setForce(SaveAPI.MUSIC, this.MusicActive),
        t.frameName = this.getNameObject(s),
        this.MusicActive || this.musicVolume(),
        this.MusicActive && (this.music.isPlaying ? this.game.add.tween(this.music).to({
            volume: 1
        }, 500, Phaser.Easing.Linear.None, !0) : this.playMusic()))
    }
    ,
    t.prototype.audioEffects = function(t) {
        this.SoundActive && (t.isPlaying || t.play())
    }
    ,
    t.prototype.startMusic = function(t) {
        this.MusicActive && (t.isPlaying || t.play())
    }
    ,
    t.prototype.addSound = function(t, e) {
        var i = e;
        "wood" == t && (i = "wood"),
        "dirt" != t && "gravel" != t || (i = "dirt"),
        "grass" != t && "pumpkin" != t && "wheat" != t && "sugar_cane" != t || (i = "whoosh"),
        "hand" == e && (i = "hand"),
        "metal" == t && (i = "metal"),
        i += Math.round(this.getRandomInt(1, 6)),
        Managers.GameManager.music.startAudioGrind(i)
    }
    ,
    t.prototype.getRandomInt = function(t, e) {
        return Math.random() * (e - t) + t
    }
    ,
    t.prototype.playAudio = function(t) {
        this.SoundActive && t.play()
    }
    ,
    t.prototype.stopAudio = function(t) {
        this.SoundActive && t.isPlaying && t.stop()
    }
    ,
    t
}();
!function(t) {
    var e = function() {
        function t() {}
        return t.KEY = "atlas",
        t.WND_ACHIEVEMENTS_ID = 1,
        t.WND_SETTINGS_ID = 2,
        t.WND_MESSAGE_ID = 3,
        t.WND_MAP_ID = 4,
        t
    }();
    t.GameManager = e
}(Managers || (Managers = {}));
var ExternalLinks = function() {
    function t() {}
    return t.goToSponsorPageMoreGames = function() {
        window.open("http://www.funnygames.nu/?utm_source=" + window.location.host + "&utm_medium=html5&utm_term=" + t.GAMEID + "&utm_content=moregames&utm_campaign=sponsored_games", "_blank")
    }
    ,
    t.goToSponsorPage = function() {
        window.open("http://www.funnygames.nu/?utm_source=" + window.location.host + "&utm_medium=html5&utm_term=" + t.GAMEID + "&utm_content=splashscreen&utm_campaign=sponsored_games", "_blank")
    }
    ,
    t.goToSponsorPageLogo = function() {
        window.open("http://www.funnygames.nu/?utm_source=" + window.location.host + "&utm_medium=html5&utm_term=" + t.GAMEID + "&utm_content=logo&utm_campaign=sponsored_games", "_blank")
    }
    ,
    t.GAMEID = "",
    t
}()
  , InventoryOld = function() {}
  , Roller = function() {}
  , ScrollBar = function() {
    function t(t, e, i, s, n, r, o) {
        if (this.KEY = "atlas",
        this.enabled = !0,
        this.game = t,
        this.mScrollGroup = e,
        this.callbacks = [],
        this.scrollBarGroup = t.add.group(),
        this.x = i,
        this.y = s,
        this.isTouch = !1,
        this.isMove = !1,
        this.isPause = !1,
        this.yScroll = 0,
        this.scrollStep = 7,
        this.startY = e.y,
        this.xEnd = null == n ? -10 : n,
        this.scrollWidth = null == r ? 15 : r,
        this.scrollHeight = null == o ? 14 : o,
        this.scrollBar(),
        this.game.input.addMoveCallback(this.mouseDrag, this),
        this.game.device.desktop) {
            var a = document.getElementById("content");
            a.addEventListener("mousewheel", this.mouseWheel.bind(this), !1),
            a.addEventListener("DOMMouseScroll", this.mouseWheel.bind(this), !1),
            document.onmousewheel = function(t) {
                t.preventDefault()
            }
        } else
            this.game.input.addMoveCallback(this.onTouchMove, this),
            this.game.input.onDown.add(this.onTouchDown, this),
            this.game.input.onUp.add(this.onTouchUp, this)
    }
    return t.prototype.onTouchDown = function() {
        this.enabled && (this.isTouch = !0,
        this.touchY = this.game.input.worldY)
    }
    ,
    t.prototype.onTouchUp = function() {
        this.enabled && (this.isTouch = !1)
    }
    ,
    t.prototype.onTouchMove = function(t, e, i) {
        !this.enabled || this.isMove || this.isPause || this.isTouch && this.x + this.mScrollGroup.width > this.game.input.worldX && this.x < this.game.input.worldX && this.y + this.mScrollGroup.height > this.game.input.worldY && this.y < this.game.input.worldY && (this.touchY < this.game.input.worldY && this.upScroll(4 * this.scrollStep),
        this.touchY > this.game.input.worldY && this.downScroll(4 * this.scrollStep),
        this.touchY = this.game.input.worldY)
    }
    ,
    t.prototype.mouseWheel = function(t) {
        this.enabled && !this.isPause && this.x + this.mScrollGroup.width + 2 * this.scrollWidth > this.game.input.worldX && this.x < this.game.input.worldX && this.y + this.mScrollGroup.height > this.game.input.worldY && this.y < this.game.input.worldY && (this.game.input.mouse.wheelDelta < 0 && this.downScroll(2 * this.scrollStep),
        0 < this.game.input.mouse.wheelDelta && this.upScroll(2 * this.scrollStep))
    }
    ,
    t.prototype.mouseDrag = function(t, e, i, s) {
        if (this.enabled && !this.isPause) {
            if (this.isMove) {
                if (this.yScroll < i && this.scrolldown.y - this.scrolldown.height / 2 > this.scrollmove.y + this.scrollmove.height) {
                    var n = i - this.yScroll;
                    if (this.scrollmove.y += n,
                    this.mScrollGroup.y -= n * this.fuctorMove,
                    this.scrolldown.y - this.scrolldown.height / 2 < this.scrollmove.y + this.scrollmove.height) {
                        var r = this.scrollmove.y + this.scrollmove.height - (this.scrolldown.y - this.scrolldown.height / 2);
                        this.scrollmove.y -= r,
                        this.mScrollGroup.y += r * this.fuctorMove
                    }
                }
                if (this.yScroll > i && this.scrollup.y + this.scrollup.height / 2 < this.scrollmove.y) {
                    n = this.yScroll - i;
                    if (this.scrollmove.y -= n,
                    this.mScrollGroup.y += n * this.fuctorMove,
                    this.scrollup.y + this.scrollup.height / 2 > this.scrollmove.y) {
                        r = this.scrollup.y + this.scrollup.height / 2 - this.scrollmove.y;
                        this.scrollmove.y += r,
                        this.mScrollGroup.y -= r * this.fuctorMove
                    }
                }
                this.startMoveCallback()
            }
            this.yScroll = i
        }
    }
    ,
    t.prototype.startMoveCallback = function() {
        var e = this;
        this.callbacks.forEach(function(t) {
            t.call(e.game)
        }, this)
    }
    ,
    t.prototype.addMoveCallback = function(t) {
        this.callbacks.push(t)
    }
    ,
    t.prototype.removeMoveCallback = function(t) {
        this.callbacks.splice(this.callbacks.indexOf(t), 1)
    }
    ,
    t.prototype.IsShowScroll = function() {
        if (0 != this.mScrollGroup.length) {
            if (this.scrollback.height - this.scrolldown.height - this.scrollup.height < this.scrollmove.height)
                return !1;
            if (this.mScrollGroup.height > this.scrollback.height)
                return !0
        }
        return !1
    }
    ,
    t.prototype.scrollBar = function() {
        var t = this;
        this.scrollback = this.game.add.sprite(10, 225, this.KEY, "flcontrols.png"),
        this.scrollback.anchor.setTo(.5, .5),
        this.scrollback.y = this.game.world.height / 2 + this.mScrollGroup.y,
        this.scrollback.x = this.mScrollGroup.x + this.mScrollGroup.width - 20,
        this.scrollback.height = this.game.world.height - this.mScrollGroup.y,
        this.scrollback.width = this.scrollWidth,
        this.scrollBarGroup.add(this.scrollback),
        this.scrollup = this.game.add.button(10, 90, this.KEY, null, null, "flscrollbuttonup2.png", "flscrollbuttonup1.png", "flscrollbuttonup3.png", "flscrollbuttonup1.png"),
        this.scrollup.width = this.scrollWidth,
        this.scrollup.height = this.scrollHeight,
        this.scrollup.anchor.setTo(.5, .5),
        this.scrollup.onInputDown.add(function() {
            t.timerUp = t.game.time.create(!1),
            t.timerUp.loop(50, t.upScroll, t),
            t.timerUp.start()
        }, this),
        this.scrollup.onInputUp.add(function() {
            t.timerUp.stop()
        }, this),
        this.scrollup.y = this.scrollback.y - this.scrollback.height / 2 + this.scrollup.height / 2,
        this.scrollup.x = this.mScrollGroup.x + this.mScrollGroup.width - 20,
        this.scrollBarGroup.add(this.scrollup),
        this.scrolldown = this.game.add.button(10, 90, this.KEY, null, null, "flscrollbuttondown2.png", "flscrollbuttondown1.png", "flscrollbuttondown3.png", "flscrollbuttondown1.png"),
        this.scrolldown.anchor.setTo(.5, .5),
        this.scrolldown.width = this.scrollWidth,
        this.scrolldown.height = this.scrollHeight,
        this.scrolldown.onInputDown.add(function() {
            t.timerDown = t.game.time.create(!1),
            t.timerDown.loop(50, t.downScroll, t),
            t.timerDown.start()
        }, this),
        this.scrolldown.onInputUp.add(function() {
            t.timerDown.stop()
        }, this),
        this.scrolldown.y = this.scrollback.y + this.scrollback.height / 2 - this.scrolldown.height / 2,
        this.scrolldown.x = this.mScrollGroup.x + this.mScrollGroup.width - 20,
        this.scrollBarGroup.add(this.scrolldown),
        this.scrollmove = new Phaser.Sprite(this.game,10,this.scrollback.y - this.scrollback.height / 2 + this.scrollup.height,GameAPI.scrollbitmapdata.texture),
        this.scrollmove.inputEnabled = !0,
        this.scrollmove.events.onInputUp.add(function() {
            t.isMove = !1
        }, this),
        this.scrollmove.events.onInputDown.add(function() {
            t.isMove = !0
        }, this),
        this.scrollmove.anchor.setTo(.5, 0),
        this.scrollmove.width = this.scrollWidth,
        this.scrollmove.x = this.mScrollGroup.x + this.mScrollGroup.width - 20,
        this.scrollBarGroup.add(this.scrollmove),
        this.resetSize()
    }
    ,
    t.prototype.upScroll = function(t) {
        if (this.scrollback.y - this.scrollback.height / 2 + this.scrollup.height < this.scrollmove.y) {
            if (this.scrollmove.y - (this.scrollback.y - this.scrollback.height / 2 + this.scrollup.height) < this.scrollStep || null != t && this.scrollmove.y - (this.scrollback.y - this.scrollback.height / 2 + this.scrollup.height) < t) {
                var e = this.scrollmove.y - (this.scrollback.y - this.scrollback.height / 2 + this.scrollup.height);
                this.scrollmove.y -= e,
                this.mScrollGroup.y += e * this.fuctorMove
            } else
                null == t ? (this.scrollmove.y -= this.scrollStep,
                this.mScrollGroup.y += this.scrollStep * this.fuctorMove) : (this.scrollmove.y -= t,
                this.mScrollGroup.y += t * this.fuctorMove);
            this.startMoveCallback()
        }
    }
    ,
    t.prototype.downScroll = function(t) {
        if (this.scrollback.y + this.scrollback.height / 2 - this.scrolldown.height > this.scrollmove.y + this.scrollmove.height) {
            if (this.scrollback.y + this.scrollback.height / 2 - this.scrolldown.height - (this.scrollmove.y + this.scrollmove.height) < this.scrollStep || null != t && this.scrollback.y + this.scrollback.height / 2 - this.scrolldown.height - (this.scrollmove.y + this.scrollmove.height) < t) {
                var e = this.scrollback.y + this.scrollback.height / 2 - this.scrolldown.height - (this.scrollmove.y + this.scrollmove.height);
                this.scrollmove.y += e,
                this.mScrollGroup.y -= e * this.fuctorMove
            } else
                null == t ? (this.scrollmove.y += this.scrollStep,
                this.mScrollGroup.y -= this.scrollStep * this.fuctorMove) : (this.scrollmove.y += t,
                this.mScrollGroup.y -= t * this.fuctorMove);
            this.startMoveCallback()
        }
    }
    ,
    t.prototype.resizeScroll = function() {
        if (null != this.scrollback && null != this.scrolldown && null != this.scrollmove && null != this.scrollup) {
            var t = (this.scrollback.height - this.scrollup.height - this.scrolldown.height) / this.mScrollGroup.height
              , e = this.scrollback.height - this.scrollup.height - this.scrolldown.height;
            this.scrollmove.height = e * t,
            this.scrollmove.y = this.scrollback.y - this.scrollback.height / 2 + this.scrollup.height,
            this.fuctorMove = (this.mScrollGroup.x + this.mScrollGroup.height - this.mScrollGroup.x) / (this.scrollback.height - this.scrollup.height - this.scrolldown.height),
            this.IsShowScroll() ? this.scrollBarGroup.visible = !0 : this.scrollBarGroup.visible = !1
        }
    }
    ,
    t.prototype.resetSize = function() {
        0 == this.mScrollGroup.height && (this.scrollBarGroup.visible = !1),
        this.mScrollGroup.y = this.startY,
        null != this.scrollback && (this.scrollback.height = this.game.world.height - this.mScrollGroup.y,
        this.scrollback.x = this.mScrollGroup.x + this.mScrollGroup.width + this.xEnd,
        this.scrollback.y = this.mScrollGroup.y + this.scrollback.height / 2),
        null != this.scrollup && (this.scrollup.y = this.scrollback.y - this.scrollback.height / 2 + this.scrollup.height / 2,
        this.scrollup.x = this.mScrollGroup.x + this.mScrollGroup.width + this.xEnd),
        null != this.scrolldown && (this.scrolldown.x = this.mScrollGroup.x + this.mScrollGroup.width + this.xEnd,
        this.scrolldown.y = this.scrollback.y + this.scrollback.height / 2 - this.scrolldown.height / 2),
        0 != this.mScrollGroup.length && this.resizeScroll(),
        null != this.scrollmove && (this.scrollmove.x = this.mScrollGroup.x + this.mScrollGroup.width + this.xEnd)
    }
    ,
    t
}()
  , SponsorLogo = function(n) {
    function r(t, e, i) {
        var s = n.call(this, t, e, i, r.KEY, r.LOGO_FRAME) || this;
        return s.inputEnabled = !0,
        s.input.useHandCursor = !0,
        s.events.onInputUp.add(ExternalLinks.goToSponsorPageLogo, s),
        s
    }
    return __extends(r, n),
    r.KEY = "atlas",
    r.LOGO_FRAME = "fgLogo.png",
    r
}(Phaser.Sprite)
  , Boot = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this
    }
    return __extends(e, t),
    e.prototype.init = function() {
        ScaleManager.init(this.game),
        this.game.load.cacheBuster = "undefined" == typeof version ? null : version,
        Fabrique.AdHandler.getInstance().init(),
        Fabrique.PauseHandler.getInstance(this.game).init(),
        gameanalytics.GameAnalytics.initialize(Constants.GAME_KEY, Constants.SECRET_KEY),
        gameanalytics.GameAnalytics.configureBuild(version),
        gameanalytics.GameAnalytics.startSession(),
        window.addEventListener("beforeunload", function() {
            gameanalytics.GameAnalytics.endSession()
        }),
        h5branding.google.setup(Constants.GOOGLE_ID, Constants.GOOGLE_APP_NAME, version),
        h5branding.google.sendScreenView("splash"),
        this.game.stage.backgroundColor = 0,
        this.game.canvas.oncontextmenu = function(t) {
            t.preventDefault()
        }
        ,
        this.game.input.maxPointers = 1,
        this.game.scale.fullScreenScaleMode = Phaser.ScaleManager.USER_SCALE,
        this.game.scale.pageAlignHorizontally = !0,
        this.game.scale.pageAlignVertically = !0,
        this.game.scale.windowConstraints.right = "layout",
        this.game.scale.windowConstraints.bottom = "visual"
    }
    ,
    e.prototype.preload = function() {
        var t = this;
        new AdTimer(this.game).setDefaultTimer();
        var e = Gameplay.Name;
        Fabrique.LoaderHelper.hide(),
        this.game.load.onFileComplete.add(function(t) {
            h5branding.SplashLoader.getInstance().setLoadProgress(t)
        }),
        this.game.load.onLoadComplete.add(function() {
            h5branding.SplashLoader.getInstance().setLoadProgress(100)
        }),
        h5ads.adWrapper.preloadAd(h5ads.AdType.interstitial),
        h5branding.SplashLoader.getInstance().setButtonCallback(function() {
            h5branding.SplashLoader.getInstance().destroy(),
            Fabrique.AdHandler.getInstance().showAd("splash", function() {
                t.game.state.start(e)
            })
        }),
        this.game.load.atlasXML("atlas", "assets/grindcraft_new.png", "assets/grindcraft_new.xml"),
        this.game.load.image("earth", "assets/img/image5.png"),
        this.game.load.bitmapFont("grindcraft", "assets/font/grindcraft.png", "assets/font/grindcraft.fnt"),
        this.game.load.bitmapFont("grincraftstroke25white", "assets/font/grincraftstroke25white.png", "assets/font/grincraftstroke25white.fnt"),
        this.game.load.bitmapFont("grincraft25stroke_shadow_white", "assets/font/grincraft25stroke_shadow_white.png", "assets/font/grincraft25stroke_shadow_white.fnt"),
        this.game.load.bitmapFont("grincraft12fioletovy", "assets/font/grincraft12fioletovy.png", "assets/font/grincraft12fioletovy.fnt"),
        this.game.load.bitmapFont("grincraft12323232", "assets/font/grincraft12323232.png", "assets/font/grincraft12323232.fnt"),
        this.game.load.bitmapFont("grincraftstroke12white", "assets/font/grincraftstroke12white.png", "assets/font/grincraftstroke12white.fnt"),
        this.game.load.bitmapFont("grincraftstroke25zheltyi", "assets/font/grincraftstroke25zheltyi.png", "assets/font/grincraftstroke25zheltyi.fnt"),
        this.game.load.bitmapFont("grincraftstroke12zheltyi", "assets/font/grincraftstroke12zheltyi.png", "assets/font/grincraftstroke12zheltyi.fnt"),
        this.game.load.audio("achieve1", ["assets/audio/achieve1.ogg", "assets/audio/achieve1.mp3"]),
        this.game.load.audio("achieve2", ["assets/audio/achieve2.ogg", "assets/audio/achieve2.mp3"]),
        this.game.load.audio("achieve3", ["assets/audio/achieve3.ogg", "assets/audio/achieve3.mp3"]),
        this.game.load.audio("achieve4", ["assets/audio/achieve4.ogg", "assets/audio/achieve4.mp3"]),
        this.game.load.audio("achieve5", ["assets/audio/achieve5.ogg", "assets/audio/achieve5.mp3"]),
        this.game.load.audio("achieve6", ["assets/audio/achieve6.ogg", "assets/audio/achieve6.mp3"]),
        this.game.load.audio("dirt1", ["assets/audio/dirt1.ogg", "assets/audio/dirt1.mp3"]),
        this.game.load.audio("dirt2", ["assets/audio/dirt2.ogg", "assets/audio/dirt2.mp3"]),
        this.game.load.audio("dirt3", ["assets/audio/dirt3.ogg", "assets/audio/dirt3.mp3"]),
        this.game.load.audio("dirt4", ["assets/audio/dirt4.ogg", "assets/audio/dirt4.mp3"]),
        this.game.load.audio("dirt5", ["assets/audio/dirt5.ogg", "assets/audio/dirt5.mp3"]),
        this.game.load.audio("dirt6", ["assets/audio/dirt6.ogg", "assets/audio/dirt6.mp3"]),
        this.game.load.audio("dirt6", ["assets/audio/dirt6.ogg", "assets/audio/dirt6.mp3"]),
        this.game.load.audio("hand1", ["assets/audio/hand1.ogg", "assets/audio/hand1.mp3"]),
        this.game.load.audio("hand2", ["assets/audio/hand2.ogg", "assets/audio/hand2.mp3"]),
        this.game.load.audio("hand3", ["assets/audio/hand3.ogg", "assets/audio/hand3.mp3"]),
        this.game.load.audio("hand4", ["assets/audio/hand4.ogg", "assets/audio/hand4.mp3"]),
        this.game.load.audio("hand5", ["assets/audio/hand5.ogg", "assets/audio/hand5.mp3"]),
        this.game.load.audio("hand6", ["assets/audio/hand6.ogg", "assets/audio/hand6.mp3"]),
        this.game.load.audio("metal1", ["assets/audio/metal1.ogg", "assets/audio/metal1.mp3"]),
        this.game.load.audio("metal2", ["assets/audio/metal2.ogg", "assets/audio/metal2.mp3"]),
        this.game.load.audio("metal3", ["assets/audio/metal3.ogg", "assets/audio/metal3.mp3"]),
        this.game.load.audio("metal4", ["assets/audio/metal4.ogg", "assets/audio/metal4.mp3"]),
        this.game.load.audio("metal5", ["assets/audio/metal5.ogg", "assets/audio/metal5.mp3"]),
        this.game.load.audio("metal6", ["assets/audio/metal6.ogg", "assets/audio/metal6.mp3"]),
        this.game.load.audio("track13", ["assets/audio/track13.ogg", "assets/audio/track13.mp3"]),
        this.game.load.audio("whoosh1", ["assets/audio/whoosh1.ogg", "assets/audio/whoosh1.mp3"]),
        this.game.load.audio("whoosh2", ["assets/audio/whoosh2.ogg", "assets/audio/whoosh2.mp3"]),
        this.game.load.audio("whoosh3", ["assets/audio/whoosh3.ogg", "assets/audio/whoosh3.mp3"]),
        this.game.load.audio("whoosh4", ["assets/audio/whoosh4.ogg", "assets/audio/whoosh4.mp3"]),
        this.game.load.audio("whoosh5", ["assets/audio/whoosh5.ogg", "assets/audio/whoosh5.mp3"]),
        this.game.load.audio("whoosh6", ["assets/audio/whoosh6.ogg", "assets/audio/whoosh6.mp3"]),
        this.game.load.audio("wood1", ["assets/audio/wood1.ogg", "assets/audio/wood1.mp3"]),
        this.game.load.audio("wood2", ["assets/audio/wood2.ogg", "assets/audio/wood2.mp3"]),
        this.game.load.audio("wood3", ["assets/audio/wood3.ogg", "assets/audio/wood3.mp3"]),
        this.game.load.audio("wood4", ["assets/audio/wood4.ogg", "assets/audio/wood4.mp3"]),
        this.game.load.audio("wood5", ["assets/audio/wood5.ogg", "assets/audio/wood5.mp3"]),
        this.game.load.audio("wood6", ["assets/audio/wood6.ogg", "assets/audio/wood6.mp3"]),
        this.game.load.image(h5branding.Branding.LOGO_KEY, h5branding.Branding.brandingLogoUrl),
        this.game.load.crossOrigin = !0,
        this.game.load.image(h5branding.Branding.LOGO_KEY, h5branding.Branding.brandingLogoUrl)
    }
    ,
    e.Name = "boot",
    e
}(Phaser.State);
